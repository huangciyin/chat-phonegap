/*!
 * jQuery JavaScript Library v1.6.2
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Thu Jun 30 14:16:56 2011 -0400
 */
(function(bc,N){var au=bc.document,bv=bc.navigator,bm=bc.location;var b=(function(){var bG=function(b1,b2){return new bG.fn.init(b1,b2,bE)},bW=bc.jQuery,bI=bc.$,bE,b0=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,bO=/\S/,bK=/^\s+/,bF=/\s+$/,bJ=/\d/,bB=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,bP=/^[\],:{}\s]*$/,bY=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,bR=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,bL=/(?:^|:|,)(?:\s*\[)+/g,bz=/(webkit)[ \/]([\w.]+)/,bT=/(opera)(?:.*version)?[ \/]([\w.]+)/,bS=/(msie) ([\w.]+)/,bU=/(mozilla)(?:.*? rv:([\w.]+))?/,bC=/-([a-z])/ig,bV=function(b1,b2){return b2.toUpperCase()},bZ=bv.userAgent,bX,bD,e,bN=Object.prototype.toString,bH=Object.prototype.hasOwnProperty,bA=Array.prototype.push,bM=Array.prototype.slice,bQ=String.prototype.trim,bw=Array.prototype.indexOf,by={};bG.fn=bG.prototype={constructor:bG,init:function(b1,b5,b4){var b3,b6,b2,b7;if(!b1){return this}if(b1.nodeType){this.context=this[0]=b1;this.length=1;return this}if(b1==="body"&&!b5&&au.body){this.context=au;this[0]=au.body;this.selector=b1;this.length=1;return this}if(typeof b1==="string"){if(b1.charAt(0)==="<"&&b1.charAt(b1.length-1)===">"&&b1.length>=3){b3=[null,b1,null]}else{b3=b0.exec(b1)}if(b3&&(b3[1]||!b5)){if(b3[1]){b5=b5 instanceof bG?b5[0]:b5;b7=(b5?b5.ownerDocument||b5:au);b2=bB.exec(b1);if(b2){if(bG.isPlainObject(b5)){b1=[au.createElement(b2[1])];bG.fn.attr.call(b1,b5,true)}else{b1=[b7.createElement(b2[1])]}}else{b2=bG.buildFragment([b3[1]],[b7]);b1=(b2.cacheable?bG.clone(b2.fragment):b2.fragment).childNodes}return bG.merge(this,b1)}else{b6=au.getElementById(b3[2]);if(b6&&b6.parentNode){if(b6.id!==b3[2]){return b4.find(b1)}this.length=1;this[0]=b6}this.context=au;this.selector=b1;return this}}else{if(!b5||b5.jquery){return(b5||b4).find(b1)}else{return this.constructor(b5).find(b1)}}}else{if(bG.isFunction(b1)){return b4.ready(b1)}}if(b1.selector!==N){this.selector=b1.selector;this.context=b1.context}return bG.makeArray(b1,this)},selector:"",jquery:"1.6.2",length:0,size:function(){return this.length},toArray:function(){return bM.call(this,0)},get:function(b1){return b1==null?this.toArray():(b1<0?this[this.length+b1]:this[b1])},pushStack:function(b2,b4,b1){var b3=this.constructor();if(bG.isArray(b2)){bA.apply(b3,b2)}else{bG.merge(b3,b2)}b3.prevObject=this;b3.context=this.context;if(b4==="find"){b3.selector=this.selector+(this.selector?" ":"")+b1}else{if(b4){b3.selector=this.selector+"."+b4+"("+b1+")"}}return b3},each:function(b2,b1){return bG.each(this,b2,b1)},ready:function(b1){bG.bindReady();bD.done(b1);return this},eq:function(b1){return b1===-1?this.slice(b1):this.slice(b1,+b1+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(bM.apply(this,arguments),"slice",bM.call(arguments).join(","))},map:function(b1){return this.pushStack(bG.map(this,function(b3,b2){return b1.call(b3,b2,b3)}))},end:function(){return this.prevObject||this.constructor(null)},push:bA,sort:[].sort,splice:[].splice};bG.fn.init.prototype=bG.fn;bG.extend=bG.fn.extend=function(){var ca,b3,b1,b2,b7,b8,b6=arguments[0]||{},b5=1,b4=arguments.length,b9=false;if(typeof b6==="boolean"){b9=b6;b6=arguments[1]||{};b5=2}if(typeof b6!=="object"&&!bG.isFunction(b6)){b6={}}if(b4===b5){b6=this;--b5}for(;b5<b4;b5++){if((ca=arguments[b5])!=null){for(b3 in ca){b1=b6[b3];b2=ca[b3];if(b6===b2){continue}if(b9&&b2&&(bG.isPlainObject(b2)||(b7=bG.isArray(b2)))){if(b7){b7=false;b8=b1&&bG.isArray(b1)?b1:[]}else{b8=b1&&bG.isPlainObject(b1)?b1:{}}b6[b3]=bG.extend(b9,b8,b2)}else{if(b2!==N){b6[b3]=b2}}}}}return b6};bG.extend({noConflict:function(b1){if(bc.$===bG){bc.$=bI}if(b1&&bc.jQuery===bG){bc.jQuery=bW}return bG},isReady:false,readyWait:1,holdReady:function(b1){if(b1){bG.readyWait++}else{bG.ready(true)}},ready:function(b1){if((b1===true&&!--bG.readyWait)||(b1!==true&&!bG.isReady)){if(!au.body){return setTimeout(bG.ready,1)}bG.isReady=true;if(b1!==true&&--bG.readyWait>0){return}bD.resolveWith(au,[bG]);if(bG.fn.trigger){bG(au).trigger("ready").unbind("ready")}}},bindReady:function(){if(bD){return}bD=bG._Deferred();if(au.readyState==="complete"){return setTimeout(bG.ready,1)}if(au.addEventListener){au.addEventListener("DOMContentLoaded",e,false);bc.addEventListener("load",bG.ready,false)}else{if(au.attachEvent){au.attachEvent("onreadystatechange",e);bc.attachEvent("onload",bG.ready);var b1=false;try{b1=bc.frameElement==null}catch(b2){}if(au.documentElement.doScroll&&b1){bx()}}}},isFunction:function(b1){return bG.type(b1)==="function"},isArray:Array.isArray||function(b1){return bG.type(b1)==="array"},isWindow:function(b1){return b1&&typeof b1==="object"&&"setInterval" in b1},isNaN:function(b1){return b1==null||!bJ.test(b1)||isNaN(b1)},type:function(b1){return b1==null?String(b1):by[bN.call(b1)]||"object"},isPlainObject:function(b2){if(!b2||bG.type(b2)!=="object"||b2.nodeType||bG.isWindow(b2)){return false}if(b2.constructor&&!bH.call(b2,"constructor")&&!bH.call(b2.constructor.prototype,"isPrototypeOf")){return false}var b1;for(b1 in b2){}return b1===N||bH.call(b2,b1)},isEmptyObject:function(b2){for(var b1 in b2){return false}return true},error:function(b1){throw b1},parseJSON:function(b1){if(typeof b1!=="string"||!b1){return null}b1=bG.trim(b1);if(bc.JSON&&bc.JSON.parse){return bc.JSON.parse(b1)}if(bP.test(b1.replace(bY,"@").replace(bR,"]").replace(bL,""))){return(new Function("return "+b1))()}bG.error("Invalid JSON: "+b1)},parseXML:function(b3,b1,b2){if(bc.DOMParser){b2=new DOMParser();b1=b2.parseFromString(b3,"text/xml")}else{b1=new ActiveXObject("Microsoft.XMLDOM");b1.async="false";b1.loadXML(b3)}b2=b1.documentElement;if(!b2||!b2.nodeName||b2.nodeName==="parsererror"){bG.error("Invalid XML: "+b3)}return b1},noop:function(){},globalEval:function(b1){if(b1&&bO.test(b1)){(bc.execScript||function(b2){bc["eval"].call(bc,b2)})(b1)}},camelCase:function(b1){return b1.replace(bC,bV)},nodeName:function(b2,b1){return b2.nodeName&&b2.nodeName.toUpperCase()===b1.toUpperCase()},each:function(b4,b7,b3){var b2,b5=0,b6=b4.length,b1=b6===N||bG.isFunction(b4);if(b3){if(b1){for(b2 in b4){if(b7.apply(b4[b2],b3)===false){break}}}else{for(;b5<b6;){if(b7.apply(b4[b5++],b3)===false){break}}}}else{if(b1){for(b2 in b4){if(b7.call(b4[b2],b2,b4[b2])===false){break}}}else{for(;b5<b6;){if(b7.call(b4[b5],b5,b4[b5++])===false){break}}}}return b4},trim:bQ?function(b1){return b1==null?"":bQ.call(b1)}:function(b1){return b1==null?"":b1.toString().replace(bK,"").replace(bF,"")},makeArray:function(b4,b2){var b1=b2||[];if(b4!=null){var b3=bG.type(b4);if(b4.length==null||b3==="string"||b3==="function"||b3==="regexp"||bG.isWindow(b4)){bA.call(b1,b4)}else{bG.merge(b1,b4)}}return b1},inArray:function(b3,b4){if(bw){return bw.call(b4,b3)}for(var b1=0,b2=b4.length;b1<b2;b1++){if(b4[b1]===b3){return b1}}return -1},merge:function(b5,b3){var b4=b5.length,b2=0;if(typeof b3.length==="number"){for(var b1=b3.length;b2<b1;b2++){b5[b4++]=b3[b2]}}else{while(b3[b2]!==N){b5[b4++]=b3[b2++]}}b5.length=b4;return b5},grep:function(b2,b7,b1){var b3=[],b6;b1=!!b1;for(var b4=0,b5=b2.length;b4<b5;b4++){b6=!!b7(b2[b4],b4);if(b1!==b6){b3.push(b2[b4])}}return b3},map:function(b1,b8,b9){var b6,b7,b5=[],b3=0,b2=b1.length,b4=b1 instanceof bG||b2!==N&&typeof b2==="number"&&((b2>0&&b1[0]&&b1[b2-1])||b2===0||bG.isArray(b1));if(b4){for(;b3<b2;b3++){b6=b8(b1[b3],b3,b9);if(b6!=null){b5[b5.length]=b6}}}else{for(b7 in b1){b6=b8(b1[b7],b7,b9);if(b6!=null){b5[b5.length]=b6}}}return b5.concat.apply([],b5)},guid:1,proxy:function(b5,b4){if(typeof b4==="string"){var b3=b5[b4];b4=b5;b5=b3}if(!bG.isFunction(b5)){return N}var b1=bM.call(arguments,2),b2=function(){return b5.apply(b4,b1.concat(bM.call(arguments)))};b2.guid=b5.guid=b5.guid||b2.guid||bG.guid++;return b2},access:function(b1,b9,b7,b3,b6,b8){var b2=b1.length;if(typeof b9==="object"){for(var b4 in b9){bG.access(b1,b4,b9[b4],b3,b6,b7)}return b1}if(b7!==N){b3=!b8&&b3&&bG.isFunction(b7);for(var b5=0;b5<b2;b5++){b6(b1[b5],b9,b3?b7.call(b1[b5],b5,b6(b1[b5],b9)):b7,b8)}return b1}return b2?b6(b1[0],b9):N},now:function(){return(new Date()).getTime()},uaMatch:function(b2){b2=b2.toLowerCase();var b1=bz.exec(b2)||bT.exec(b2)||bS.exec(b2)||b2.indexOf("compatible")<0&&bU.exec(b2)||[];return{browser:b1[1]||"",version:b1[2]||"0"}},sub:function(){function b1(b4,b5){return new b1.fn.init(b4,b5)}bG.extend(true,b1,this);b1.superclass=this;b1.fn=b1.prototype=this();b1.fn.constructor=b1;b1.sub=this.sub;b1.fn.init=function b3(b4,b5){if(b5&&b5 instanceof bG&&!(b5 instanceof b1)){b5=b1(b5)}return bG.fn.init.call(this,b4,b5,b2)};b1.fn.init.prototype=b1.fn;var b2=b1(au);return b1},browser:{}});bG.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b2,b1){by["[object "+b1+"]"]=b1.toLowerCase()});bX=bG.uaMatch(bZ);if(bX.browser){bG.browser[bX.browser]=true;bG.browser.version=bX.version}if(bG.browser.webkit){bG.browser.safari=true}if(bO.test("\xA0")){bK=/^[\s\xA0]+/;bF=/[\s\xA0]+$/}bE=bG(au);if(au.addEventListener){e=function(){au.removeEventListener("DOMContentLoaded",e,false);bG.ready()}}else{if(au.attachEvent){e=function(){if(au.readyState==="complete"){au.detachEvent("onreadystatechange",e);bG.ready()}}}}function bx(){if(bG.isReady){return}try{au.documentElement.doScroll("left")}catch(b1){setTimeout(bx,1);return}bG.ready()}return bG})();var a="done fail isResolved isRejected promise then always pipe".split(" "),aI=[].slice;b.extend({_Deferred:function(){var by=[],bz,bw,bx,e={done:function(){if(!bx){var bB=arguments,bC,bF,bE,bD,bA;if(bz){bA=bz;bz=0}for(bC=0,bF=bB.length;bC<bF;bC++){bE=bB[bC];bD=b.type(bE);if(bD==="array"){e.done.apply(e,bE)}else{if(bD==="function"){by.push(bE)}}}if(bA){e.resolveWith(bA[0],bA[1])}}return this},resolveWith:function(bB,bA){if(!bx&&!bz&&!bw){bA=bA||[];bw=1;try{while(by[0]){by.shift().apply(bB,bA)}}finally{bz=[bB,bA];bw=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return !!(bw||bz)},cancel:function(){bx=1;by=[];return this}};return e},Deferred:function(bw){var e=b._Deferred(),by=b._Deferred(),bx;b.extend(e,{then:function(bA,bz){e.done(bA).fail(bz);return this},always:function(){return e.done.apply(e,arguments).fail.apply(this,arguments)},fail:by.done,rejectWith:by.resolveWith,reject:by.resolve,isRejected:by.isResolved,pipe:function(bA,bz){return b.Deferred(function(bB){b.each({done:[bA,"resolve"],fail:[bz,"reject"]},function(bD,bG){var bC=bG[0],bF=bG[1],bE;if(b.isFunction(bC)){e[bD](function(){bE=bC.apply(this,arguments);if(bE&&b.isFunction(bE.promise)){bE.promise().then(bB.resolve,bB.reject)}else{bB[bF](bE)}})}else{e[bD](bB[bF])}})}).promise()},promise:function(bA){if(bA==null){if(bx){return bx}bx=bA={}}var bz=a.length;while(bz--){bA[a[bz]]=e[a[bz]]}return bA}});e.done(by.cancel).fail(e.cancel);delete e.cancel;if(bw){bw.call(e,e)}return e},when:function(bB){var bw=arguments,bx=0,bA=bw.length,bz=bA,e=bA<=1&&bB&&b.isFunction(bB.promise)?bB:b.Deferred();function by(bC){return function(bD){bw[bC]=arguments.length>1?aI.call(arguments,0):bD;if(!(--bz)){e.resolveWith(e,aI.call(bw,0))}}}if(bA>1){for(;bx<bA;bx++){if(bw[bx]&&b.isFunction(bw[bx].promise)){bw[bx].promise().then(by(bx),e.reject)}else{--bz}}if(!bz){e.resolveWith(e,bw)}}else{if(e!==bB){e.resolveWith(e,bA?[bB]:[])}}return e.promise()}});b.support=(function(){var bG=au.createElement("div"),bN=au.documentElement,bz,bO,bH,bx,bF,bA,bD,bw,bE,bI,bC,bM,bK,by,bB,bJ,bP;bG.setAttribute("className","t");bG.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";bz=bG.getElementsByTagName("*");bO=bG.getElementsByTagName("a")[0];if(!bz||!bz.length||!bO){return{}}bH=au.createElement("select");bx=bH.appendChild(au.createElement("option"));bF=bG.getElementsByTagName("input")[0];bD={leadingWhitespace:(bG.firstChild.nodeType===3),tbody:!bG.getElementsByTagName("tbody").length,htmlSerialize:!!bG.getElementsByTagName("link").length,style:/top/.test(bO.getAttribute("style")),hrefNormalized:(bO.getAttribute("href")==="/a"),opacity:/^0.55$/.test(bO.style.opacity),cssFloat:!!bO.style.cssFloat,checkOn:(bF.value==="on"),optSelected:bx.selected,getSetAttribute:bG.className!=="t",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};bF.checked=true;bD.noCloneChecked=bF.cloneNode(true).checked;bH.disabled=true;bD.optDisabled=!bx.disabled;try{delete bG.test}catch(bL){bD.deleteExpando=false}if(!bG.addEventListener&&bG.attachEvent&&bG.fireEvent){bG.attachEvent("onclick",function(){bD.noCloneEvent=false});bG.cloneNode(true).fireEvent("onclick")}bF=au.createElement("input");bF.value="t";bF.setAttribute("type","radio");bD.radioValue=bF.value==="t";bF.setAttribute("checked","checked");bG.appendChild(bF);bw=au.createDocumentFragment();bw.appendChild(bG.firstChild);bD.checkClone=bw.cloneNode(true).cloneNode(true).lastChild.checked;bG.innerHTML="";bG.style.width=bG.style.paddingLeft="1px";bE=au.getElementsByTagName("body")[0];bC=au.createElement(bE?"div":"body");bM={visibility:"hidden",width:0,height:0,border:0,margin:0};if(bE){b.extend(bM,{position:"absolute",left:-1000,top:-1000})}for(bJ in bM){bC.style[bJ]=bM[bJ]}bC.appendChild(bG);bI=bE||bN;bI.insertBefore(bC,bI.firstChild);bD.appendChecked=bF.checked;bD.boxModel=bG.offsetWidth===2;if("zoom" in bG.style){bG.style.display="inline";bG.style.zoom=1;bD.inlineBlockNeedsLayout=(bG.offsetWidth===2);bG.style.display="";bG.innerHTML="<div style='width:4px;'></div>";bD.shrinkWrapBlocks=(bG.offsetWidth!==2)}bG.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";bK=bG.getElementsByTagName("td");bP=(bK[0].offsetHeight===0);bK[0].style.display="";bK[1].style.display="none";bD.reliableHiddenOffsets=bP&&(bK[0].offsetHeight===0);bG.innerHTML="";if(au.defaultView&&au.defaultView.getComputedStyle){bA=au.createElement("div");bA.style.width="0";bA.style.marginRight="0";bG.appendChild(bA);bD.reliableMarginRight=(parseInt((au.defaultView.getComputedStyle(bA,null)||{marginRight:0}).marginRight,10)||0)===0}bC.innerHTML="";bI.removeChild(bC);if(bG.attachEvent){for(bJ in {submit:1,change:1,focusin:1}){bB="on"+bJ;bP=(bB in bG);if(!bP){bG.setAttribute(bB,"return;");bP=(typeof bG[bB]==="function")}bD[bJ+"Bubbles"]=bP}}bC=bw=bH=bx=bE=bA=bG=bF=null;return bD})();b.boxModel=b.support.boxModel;var aP=/^(?:\{.*\}|\[.*\])$/,az=/([a-z])([A-Z])/g;b.extend({cache:{},uuid:0,expando:"jQuery"+(b.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(e){e=e.nodeType?b.cache[e[b.expando]]:e[b.expando];return !!e&&!W(e)},data:function(by,bw,bA,bz){if(!b.acceptData(by)){return}var bD=b.expando,bC=typeof bw==="string",bB,bE=by.nodeType,e=bE?b.cache:by,bx=bE?by[b.expando]:by[b.expando]&&b.expando;if((!bx||(bz&&bx&&!e[bx][bD]))&&bC&&bA===N){return}if(!bx){if(bE){by[b.expando]=bx=++b.uuid}else{bx=b.expando}}if(!e[bx]){e[bx]={};if(!bE){e[bx].toJSON=b.noop}}if(typeof bw==="object"||typeof bw==="function"){if(bz){e[bx][bD]=b.extend(e[bx][bD],bw)}else{e[bx]=b.extend(e[bx],bw)}}bB=e[bx];if(bz){if(!bB[bD]){bB[bD]={}}bB=bB[bD]}if(bA!==N){bB[b.camelCase(bw)]=bA}if(bw==="events"&&!bB[bw]){return bB[bD]&&bB[bD].events}return bC?bB[b.camelCase(bw)]||bB[bw]:bB},removeData:function(bz,bx,bA){if(!b.acceptData(bz)){return}var bC=b.expando,bD=bz.nodeType,bw=bD?b.cache:bz,by=bD?bz[b.expando]:b.expando;if(!bw[by]){return}if(bx){var bB=bA?bw[by][bC]:bw[by];if(bB){delete bB[bx];if(!W(bB)){return}}}if(bA){delete bw[by][bC];if(!W(bw[by])){return}}var e=bw[by][bC];if(b.support.deleteExpando||bw!=bc){delete bw[by]}else{bw[by]=null}if(e){bw[by]={};if(!bD){bw[by].toJSON=b.noop}bw[by][bC]=e}else{if(bD){if(b.support.deleteExpando){delete bz[b.expando]}else{if(bz.removeAttribute){bz.removeAttribute(b.expando)}else{bz[b.expando]=null}}}}},_data:function(bw,e,bx){return b.data(bw,e,bx,true)},acceptData:function(bw){if(bw.nodeName){var e=b.noData[bw.nodeName.toLowerCase()];if(e){return !(e===true||bw.getAttribute("classid")!==e)}}return true}});b.fn.extend({data:function(bz,bB){var bA=null;if(typeof bz==="undefined"){if(this.length){bA=b.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,bx;for(var by=0,bw=e.length;by<bw;by++){bx=e[by].name;if(bx.indexOf("data-")===0){bx=b.camelCase(bx.substring(5));a5(this[0],bx,bA[bx])}}}}return bA}else{if(typeof bz==="object"){return this.each(function(){b.data(this,bz)})}}var bC=bz.split(".");bC[1]=bC[1]?"."+bC[1]:"";if(bB===N){bA=this.triggerHandler("getData"+bC[1]+"!",[bC[0]]);if(bA===N&&this.length){bA=b.data(this[0],bz);bA=a5(this[0],bz,bA)}return bA===N&&bC[1]?this.data(bC[0]):bA}else{return this.each(function(){var bE=b(this),bD=[bC[0],bB];bE.triggerHandler("setData"+bC[1]+"!",bD);b.data(this,bz,bB);bE.triggerHandler("changeData"+bC[1]+"!",bD)})}},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function a5(by,bx,bz){if(bz===N&&by.nodeType===1){var bw="data-"+bx.replace(az,"$1-$2").toLowerCase();bz=by.getAttribute(bw);if(typeof bz==="string"){try{bz=bz==="true"?true:bz==="false"?false:bz==="null"?null:!b.isNaN(bz)?parseFloat(bz):aP.test(bz)?b.parseJSON(bz):bz}catch(bA){}b.data(by,bx,bz)}else{bz=N}}return bz}function W(bw){for(var e in bw){if(e!=="toJSON"){return false}}return true}function bi(bz,by,bB){var bx=by+"defer",bw=by+"queue",e=by+"mark",bA=b.data(bz,bx,N,true);if(bA&&(bB==="queue"||!b.data(bz,bw,N,true))&&(bB==="mark"||!b.data(bz,e,N,true))){setTimeout(function(){if(!b.data(bz,bw,N,true)&&!b.data(bz,e,N,true)){b.removeData(bz,bx,true);bA.resolve()}},0)}}b.extend({_mark:function(bw,e){if(bw){e=(e||"fx")+"mark";b.data(bw,e,(b.data(bw,e,N,true)||0)+1,true)}},_unmark:function(bz,by,bw){if(bz!==true){bw=by;by=bz;bz=false}if(by){bw=bw||"fx";var e=bw+"mark",bx=bz?0:((b.data(by,e,N,true)||1)-1);if(bx){b.data(by,e,bx,true)}else{b.removeData(by,e,true);bi(by,bw,"mark")}}},queue:function(bw,e,by){if(bw){e=(e||"fx")+"queue";var bx=b.data(bw,e,N,true);if(by){if(!bx||b.isArray(by)){bx=b.data(bw,e,b.makeArray(by),true)}else{bx.push(by)}}return bx||[]}},dequeue:function(by,bx){bx=bx||"fx";var e=b.queue(by,bx),bw=e.shift(),bz;if(bw==="inprogress"){bw=e.shift()}if(bw){if(bx==="fx"){e.unshift("inprogress")}bw.call(by,function(){b.dequeue(by,bx)})}if(!e.length){b.removeData(by,bx+"queue",true);bi(by,bx,"queue")}}});b.fn.extend({queue:function(e,bw){if(typeof e!=="string"){bw=e;e="fx"}if(bw===N){return b.queue(this[0],e)}return this.each(function(){var bx=b.queue(this,e,bw);if(e==="fx"&&bx[0]!=="inprogress"){b.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(bw,e){bw=b.fx?b.fx.speeds[bw]||bw:bw;e=e||"fx";return this.queue(e,function(){var bx=this;setTimeout(function(){b.dequeue(bx,e)},bw)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(bE,bx){if(typeof bE!=="string"){bx=bE;bE=N}bE=bE||"fx";var e=b.Deferred(),bw=this,bz=bw.length,bC=1,bA=bE+"defer",bB=bE+"queue",bD=bE+"mark",by;function bF(){if(!(--bC)){e.resolveWith(bw,[bw])}}while(bz--){if((by=b.data(bw[bz],bA,N,true)||(b.data(bw[bz],bB,N,true)||b.data(bw[bz],bD,N,true))&&b.data(bw[bz],bA,b._Deferred(),true))){bC++;by.done(bF)}}bF();return e.promise()}});var aN=/[\n\t\r]/g,af=/\s+/,aR=/\r/g,g=/^(?:button|input)$/i,G=/^(?:button|input|object|select|textarea)$/i,m=/^a(?:rea)?$/i,an=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,a8=/\:|^on/,a3,aX;b.fn.extend({attr:function(e,bw){return b.access(this,e,bw,true,b.attr)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,bw){return b.access(this,e,bw,true,b.prop)},removeProp:function(e){e=b.propFix[e]||e;return this.each(function(){try{this[e]=N;delete this[e]}catch(bw){}})},addClass:function(bz){var bB,bx,bw,by,bA,bC,e;if(b.isFunction(bz)){return this.each(function(bD){b(this).addClass(bz.call(this,bD,this.className))})}if(bz&&typeof bz==="string"){bB=bz.split(af);for(bx=0,bw=this.length;bx<bw;bx++){by=this[bx];if(by.nodeType===1){if(!by.className&&bB.length===1){by.className=bz}else{bA=" "+by.className+" ";for(bC=0,e=bB.length;bC<e;bC++){if(!~bA.indexOf(" "+bB[bC]+" ")){bA+=bB[bC]+" "}}by.className=b.trim(bA)}}}}return this},removeClass:function(bA){var bB,bx,bw,bz,by,bC,e;if(b.isFunction(bA)){return this.each(function(bD){b(this).removeClass(bA.call(this,bD,this.className))})}if((bA&&typeof bA==="string")||bA===N){bB=(bA||"").split(af);for(bx=0,bw=this.length;bx<bw;bx++){bz=this[bx];if(bz.nodeType===1&&bz.className){if(bA){by=(" "+bz.className+" ").replace(aN," ");for(bC=0,e=bB.length;bC<e;bC++){by=by.replace(" "+bB[bC]+" "," ")}bz.className=b.trim(by)}else{bz.className=""}}}}return this},toggleClass:function(by,bw){var bx=typeof by,e=typeof bw==="boolean";if(b.isFunction(by)){return this.each(function(bz){b(this).toggleClass(by.call(this,bz,this.className,bw),bw)})}return this.each(function(){if(bx==="string"){var bB,bA=0,bz=b(this),bC=bw,bD=by.split(af);while((bB=bD[bA++])){bC=e?bC:!bz.hasClass(bB);bz[bC?"addClass":"removeClass"](bB)}}else{if(bx==="undefined"||bx==="boolean"){if(this.className){b._data(this,"__className__",this.className)}this.className=this.className||by===false?"":b._data(this,"__className__")||""}}})},hasClass:function(e){var by=" "+e+" ";for(var bx=0,bw=this.length;bx<bw;bx++){if((" "+this[bx].className+" ").replace(aN," ").indexOf(by)>-1){return true}}return false},val:function(by){var e,bw,bx=this[0];if(!arguments.length){if(bx){e=b.valHooks[bx.nodeName.toLowerCase()]||b.valHooks[bx.type];if(e&&"get" in e&&(bw=e.get(bx,"value"))!==N){return bw}bw=bx.value;return typeof bw==="string"?bw.replace(aR,""):bw==null?"":bw}return N}var bz=b.isFunction(by);return this.each(function(bB){var bA=b(this),bC;if(this.nodeType!==1){return}if(bz){bC=by.call(this,bB,bA.val())}else{bC=by}if(bC==null){bC=""}else{if(typeof bC==="number"){bC+=""}else{if(b.isArray(bC)){bC=b.map(bC,function(bD){return bD==null?"":bD+""})}}}e=b.valHooks[this.nodeName.toLowerCase()]||b.valHooks[this.type];if(!e||!("set" in e)||e.set(this,bC,"value")===N){this.value=bC}})}});b.extend({valHooks:{option:{get:function(e){var bw=e.attributes.value;return !bw||bw.specified?e.value:e.text}},select:{get:function(e){var bB,bz=e.selectedIndex,bC=[],bD=e.options,by=e.type==="select-one";if(bz<0){return null}for(var bw=by?bz:0,bA=by?bz+1:bD.length;bw<bA;bw++){var bx=bD[bw];if(bx.selected&&(b.support.optDisabled?!bx.disabled:bx.getAttribute("disabled")===null)&&(!bx.parentNode.disabled||!b.nodeName(bx.parentNode,"optgroup"))){bB=b(bx).val();if(by){return bB}bC.push(bB)}}if(by&&!bC.length&&bD.length){return b(bD[bz]).val()}return bC},set:function(bw,bx){var e=b.makeArray(bx);b(bw).find("option").each(function(){this.selected=b.inArray(b(this).val(),e)>=0});if(!e.length){bw.selectedIndex=-1}return e}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attrFix:{tabindex:"tabIndex"},attr:function(bB,by,bC,bA){var bw=bB.nodeType;if(!bB||bw===3||bw===8||bw===2){return N}if(bA&&by in b.attrFn){return b(bB)[by](bC)}if(!("getAttribute" in bB)){return b.prop(bB,by,bC)}var bx,e,bz=bw!==1||!b.isXMLDoc(bB);if(bz){by=b.attrFix[by]||by;e=b.attrHooks[by];if(!e){if(an.test(by)){e=aX}else{if(a3&&by!=="className"&&(b.nodeName(bB,"form")||a8.test(by))){e=a3}}}}if(bC!==N){if(bC===null){b.removeAttr(bB,by);return N}else{if(e&&"set" in e&&bz&&(bx=e.set(bB,bC,by))!==N){return bx}else{bB.setAttribute(by,""+bC);return bC}}}else{if(e&&"get" in e&&bz&&(bx=e.get(bB,by))!==null){return bx}else{bx=bB.getAttribute(by);return bx===null?N:bx}}},removeAttr:function(bw,e){var bx;if(bw.nodeType===1){e=b.attrFix[e]||e;if(b.support.getSetAttribute){bw.removeAttribute(e)}else{b.attr(bw,e,"");bw.removeAttributeNode(bw.getAttributeNode(e))}if(an.test(e)&&(bx=b.propFix[e]||e) in bw){bw[bx]=false}}},attrHooks:{type:{set:function(e,bw){if(g.test(e.nodeName)&&e.parentNode){b.error("type property can't be changed")}else{if(!b.support.radioValue&&bw==="radio"&&b.nodeName(e,"input")){var bx=e.value;e.setAttribute("type",bw);if(bx){e.value=bx}return bw}}}},tabIndex:{get:function(bw){var e=bw.getAttributeNode("tabIndex");return e&&e.specified?parseInt(e.value,10):G.test(bw.nodeName)||m.test(bw.nodeName)&&bw.href?0:N}},value:{get:function(bw,e){if(a3&&b.nodeName(bw,"button")){return a3.get(bw,e)}return e in bw?bw.value:null},set:function(bw,bx,e){if(a3&&b.nodeName(bw,"button")){return a3.set(bw,bx,e)}bw.value=bx}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(bA,by,bB){var bw=bA.nodeType;if(!bA||bw===3||bw===8||bw===2){return N}var bx,e,bz=bw!==1||!b.isXMLDoc(bA);if(bz){by=b.propFix[by]||by;e=b.propHooks[by]}if(bB!==N){if(e&&"set" in e&&(bx=e.set(bA,bB,by))!==N){return bx}else{return(bA[by]=bB)}}else{if(e&&"get" in e&&(bx=e.get(bA,by))!==N){return bx}else{return bA[by]}}},propHooks:{}});aX={get:function(bw,e){return b.prop(bw,e)?e.toLowerCase():N},set:function(bw,by,e){var bx;if(by===false){b.removeAttr(bw,e)}else{bx=b.propFix[e]||e;if(bx in bw){bw[bx]=true}bw.setAttribute(e,e.toLowerCase())}return e}};if(!b.support.getSetAttribute){b.attrFix=b.propFix;a3=b.attrHooks.name=b.attrHooks.title=b.valHooks.button={get:function(bx,bw){var e;e=bx.getAttributeNode(bw);return e&&e.nodeValue!==""?e.nodeValue:N},set:function(bx,by,bw){var e=bx.getAttributeNode(bw);if(e){e.nodeValue=by;return by}}};b.each(["width","height"],function(bw,e){b.attrHooks[e]=b.extend(b.attrHooks[e],{set:function(bx,by){if(by===""){bx.setAttribute(e,"auto");return by}}})})}if(!b.support.hrefNormalized){b.each(["href","src","width","height"],function(bw,e){b.attrHooks[e]=b.extend(b.attrHooks[e],{get:function(by){var bx=by.getAttribute(e,2);return bx===null?N:bx}})})}if(!b.support.style){b.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||N},set:function(e,bw){return(e.style.cssText=""+bw)}}}if(!b.support.optSelected){b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(bw){var e=bw.parentNode;if(e){e.selectedIndex;if(e.parentNode){e.parentNode.selectedIndex}}}})}if(!b.support.checkOn){b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}})}b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,bw){if(b.isArray(bw)){return(e.checked=b.inArray(b(e).val(),bw)>=0)}}})});var aZ=/\.(.*)$/,be=/^(?:textarea|input|select)$/i,Q=/\./g,bj=/ /g,aF=/[^\w\s.|`]/g,J=function(e){return e.replace(aF,"\\$&")};b.event={add:function(by,bC,bH,bA){if(by.nodeType===3||by.nodeType===8){return}if(bH===false){bH=bl}else{if(!bH){return}}var bw,bG;if(bH.handler){bw=bH;bH=bw.handler}if(!bH.guid){bH.guid=b.guid++}var bD=b._data(by);if(!bD){return}var bI=bD.events,bB=bD.handle;if(!bI){bD.events=bI={}}if(!bB){bD.handle=bB=function(bJ){return typeof b!=="undefined"&&(!bJ||b.event.triggered!==bJ.type)?b.event.handle.apply(bB.elem,arguments):N}}bB.elem=by;bC=bC.split(" ");var bF,bz=0,e;while((bF=bC[bz++])){bG=bw?b.extend({},bw):{handler:bH,data:bA};if(bF.indexOf(".")>-1){e=bF.split(".");bF=e.shift();bG.namespace=e.slice(0).sort().join(".")}else{e=[];bG.namespace=""}bG.type=bF;if(!bG.guid){bG.guid=bH.guid}var bx=bI[bF],bE=b.event.special[bF]||{};if(!bx){bx=bI[bF]=[];if(!bE.setup||bE.setup.call(by,bA,e,bB)===false){if(by.addEventListener){by.addEventListener(bF,bB,false)}else{if(by.attachEvent){by.attachEvent("on"+bF,bB)}}}}if(bE.add){bE.add.call(by,bG);if(!bG.handler.guid){bG.handler.guid=bH.guid}}bx.push(bG);b.event.global[bF]=true}by=null},global:{},remove:function(bK,bF,bx,bB){if(bK.nodeType===3||bK.nodeType===8){return}if(bx===false){bx=bl}var bN,bA,bC,bH,bI=0,by,bD,bG,bz,bE,e,bM,bJ=b.hasData(bK)&&b._data(bK),bw=bJ&&bJ.events;if(!bJ||!bw){return}if(bF&&bF.type){bx=bF.handler;bF=bF.type}if(!bF||typeof bF==="string"&&bF.charAt(0)==="."){bF=bF||"";for(bA in bw){b.event.remove(bK,bA+bF)}return}bF=bF.split(" ");while((bA=bF[bI++])){bM=bA;e=null;by=bA.indexOf(".")<0;bD=[];if(!by){bD=bA.split(".");bA=bD.shift();bG=new RegExp("(^|\\.)"+b.map(bD.slice(0).sort(),J).join("\\.(?:.*\\.)?")+"(\\.|$)")}bE=bw[bA];if(!bE){continue}if(!bx){for(bH=0;bH<bE.length;bH++){e=bE[bH];if(by||bG.test(e.namespace)){b.event.remove(bK,bM,e.handler,bH);bE.splice(bH--,1)}}continue}bz=b.event.special[bA]||{};for(bH=bB||0;bH<bE.length;bH++){e=bE[bH];if(bx.guid===e.guid){if(by||bG.test(e.namespace)){if(bB==null){bE.splice(bH--,1)}if(bz.remove){bz.remove.call(bK,e)}}if(bB!=null){break}}}if(bE.length===0||bB!=null&&bE.length===1){if(!bz.teardown||bz.teardown.call(bK,bD)===false){b.removeEvent(bK,bA,bJ.handle)}bN=null;delete bw[bA]}}if(b.isEmptyObject(bw)){var bL=bJ.handle;if(bL){bL.elem=null}delete bJ.events;delete bJ.handle;if(b.isEmptyObject(bJ)){b.removeData(bK,N,true)}}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(e,bC,bA,bH){var bF=e.type||e,bx=[],bw;if(bF.indexOf("!")>=0){bF=bF.slice(0,-1);bw=true}if(bF.indexOf(".")>=0){bx=bF.split(".");bF=bx.shift();bx.sort()}if((!bA||b.event.customEvent[bF])&&!b.event.global[bF]){return}e=typeof e==="object"?e[b.expando]?e:new b.Event(bF,e):new b.Event(bF);e.type=bF;e.exclusive=bw;e.namespace=bx.join(".");e.namespace_re=new RegExp("(^|\\.)"+bx.join("\\.(?:.*\\.)?")+"(\\.|$)");if(bH||!bA){e.preventDefault();e.stopPropagation()}if(!bA){b.each(b.cache,function(){var bJ=b.expando,bI=this[bJ];if(bI&&bI.events&&bI.events[bF]){b.event.trigger(e,bC,bI.handle.elem)}});return}if(bA.nodeType===3||bA.nodeType===8){return}e.result=N;e.target=bA;bC=bC!=null?b.makeArray(bC):[];bC.unshift(e);var bG=bA,by=bF.indexOf(":")<0?"on"+bF:"";do{var bD=b._data(bG,"handle");e.currentTarget=bG;if(bD){bD.apply(bG,bC)}if(by&&b.acceptData(bG)&&bG[by]&&bG[by].apply(bG,bC)===false){e.result=false;e.preventDefault()}bG=bG.parentNode||bG.ownerDocument||bG===e.target.ownerDocument&&bc}while(bG&&!e.isPropagationStopped());if(!e.isDefaultPrevented()){var bz,bE=b.event.special[bF]||{};if((!bE._default||bE._default.call(bA.ownerDocument,e)===false)&&!(bF==="click"&&b.nodeName(bA,"a"))&&b.acceptData(bA)){try{if(by&&bA[bF]){bz=bA[by];if(bz){bA[by]=null}b.event.triggered=bF;bA[bF]()}}catch(bB){}if(bz){bA[by]=bz}b.event.triggered=N}}return e.result},handle:function(bC){bC=b.event.fix(bC||bc.event);var bw=((b._data(this,"events")||{})[bC.type]||[]).slice(0),bB=!bC.exclusive&&!bC.namespace,bz=Array.prototype.slice.call(arguments,0);bz[0]=bC;bC.currentTarget=this;for(var by=0,e=bw.length;by<e;by++){var bA=bw[by];if(bB||bC.namespace_re.test(bA.namespace)){bC.handler=bA.handler;bC.data=bA.data;bC.handleObj=bA;var bx=bA.handler.apply(this,bz);if(bx!==N){bC.result=bx;if(bx===false){bC.preventDefault();bC.stopPropagation()}}if(bC.isImmediatePropagationStopped()){break}}}return bC.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(bz){if(bz[b.expando]){return bz}var bw=bz;bz=b.Event(bw);for(var bx=this.props.length,bB;bx;){bB=this.props[--bx];bz[bB]=bw[bB]}if(!bz.target){bz.target=bz.srcElement||au}if(bz.target.nodeType===3){bz.target=bz.target.parentNode}if(!bz.relatedTarget&&bz.fromElement){bz.relatedTarget=bz.fromElement===bz.target?bz.toElement:bz.fromElement}if(bz.pageX==null&&bz.clientX!=null){var by=bz.target.ownerDocument||au,bA=by.documentElement,e=by.body;bz.pageX=bz.clientX+(bA&&bA.scrollLeft||e&&e.scrollLeft||0)-(bA&&bA.clientLeft||e&&e.clientLeft||0);bz.pageY=bz.clientY+(bA&&bA.scrollTop||e&&e.scrollTop||0)-(bA&&bA.clientTop||e&&e.clientTop||0)}if(bz.which==null&&(bz.charCode!=null||bz.keyCode!=null)){bz.which=bz.charCode!=null?bz.charCode:bz.keyCode}if(!bz.metaKey&&bz.ctrlKey){bz.metaKey=bz.ctrlKey}if(!bz.which&&bz.button!==N){bz.which=(bz.button&1?1:(bz.button&2?3:(bz.button&4?2:0)))}return bz},guid:100000000,proxy:b.proxy,special:{ready:{setup:b.bindReady,teardown:b.noop},live:{add:function(e){b.event.add(this,q(e.origType,e.selector),b.extend({},e,{handler:al,guid:e.handler.guid}))},remove:function(e){b.event.remove(this,q(e.origType,e.selector),e)}},beforeunload:{setup:function(bx,bw,e){if(b.isWindow(this)){this.onbeforeunload=e}},teardown:function(bw,e){if(this.onbeforeunload===e){this.onbeforeunload=null}}}}};b.removeEvent=au.removeEventListener?function(bw,e,bx){if(bw.removeEventListener){bw.removeEventListener(e,bx,false)}}:function(bw,e,bx){if(bw.detachEvent){bw.detachEvent("on"+e,bx)}};b.Event=function(bw,e){if(!this.preventDefault){return new b.Event(bw,e)}if(bw&&bw.type){this.originalEvent=bw;this.type=bw.type;this.isDefaultPrevented=(bw.defaultPrevented||bw.returnValue===false||bw.getPreventDefault&&bw.getPreventDefault())?j:bl}else{this.type=bw}if(e){b.extend(this,e)}this.timeStamp=b.now();this[b.expando]=true};function bl(){return false}function j(){return true}b.Event.prototype={preventDefault:function(){this.isDefaultPrevented=j;var bw=this.originalEvent;if(!bw){return}if(bw.preventDefault){bw.preventDefault()}else{bw.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=j;var bw=this.originalEvent;if(!bw){return}if(bw.stopPropagation){bw.stopPropagation()}bw.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=j;this.stopPropagation()},isDefaultPrevented:bl,isPropagationStopped:bl,isImmediatePropagationStopped:bl};var ae=function(bx){var by=bx.relatedTarget,e=false,bw=bx.type;bx.type=bx.data;if(by!==this){if(by){e=b.contains(this,by)}if(!e){b.event.handle.apply(this,arguments);bx.type=bw}}},aU=function(e){e.type=e.data;b.event.handle.apply(this,arguments)};b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(bw,e){b.event.special[bw]={setup:function(bx){b.event.add(this,e,bx&&bx.selector?aU:ae,bw)},teardown:function(bx){b.event.remove(this,e,bx&&bx.selector?aU:ae)}}});if(!b.support.submitBubbles){b.event.special.submit={setup:function(bw,e){if(!b.nodeName(this,"form")){b.event.add(this,"click.specialSubmit",function(bz){var by=bz.target,bx=by.type;if((bx==="submit"||bx==="image")&&b(by).closest("form").length){aW("submit",this,arguments)}});b.event.add(this,"keypress.specialSubmit",function(bz){var by=bz.target,bx=by.type;if((bx==="text"||bx==="password")&&b(by).closest("form").length&&bz.keyCode===13){aW("submit",this,arguments)}})}else{return false}},teardown:function(e){b.event.remove(this,".specialSubmit")}}}if(!b.support.changeBubbles){var bo,l=function(bw){var e=bw.type,bx=bw.value;if(e==="radio"||e==="checkbox"){bx=bw.checked}else{if(e==="select-multiple"){bx=bw.selectedIndex>-1?b.map(bw.options,function(by){return by.selected}).join("-"):""}else{if(b.nodeName(bw,"select")){bx=bw.selectedIndex}}}return bx},ac=function ac(by){var bw=by.target,bx,bz;if(!be.test(bw.nodeName)||bw.readOnly){return}bx=b._data(bw,"_change_data");bz=l(bw);if(by.type!=="focusout"||bw.type!=="radio"){b._data(bw,"_change_data",bz)}if(bx===N||bz===bx){return}if(bx!=null||bz){by.type="change";by.liveFired=N;b.event.trigger(by,arguments[1],bw)}};b.event.special.change={filters:{focusout:ac,beforedeactivate:ac,click:function(by){var bx=by.target,bw=b.nodeName(bx,"input")?bx.type:"";if(bw==="radio"||bw==="checkbox"||b.nodeName(bx,"select")){ac.call(this,by)}},keydown:function(by){var bx=by.target,bw=b.nodeName(bx,"input")?bx.type:"";if((by.keyCode===13&&!b.nodeName(bx,"textarea"))||(by.keyCode===32&&(bw==="checkbox"||bw==="radio"))||bw==="select-multiple"){ac.call(this,by)}},beforeactivate:function(bx){var bw=bx.target;b._data(bw,"_change_data",l(bw))}},setup:function(bx,bw){if(this.type==="file"){return false}for(var e in bo){b.event.add(this,e+".specialChange",bo[e])}return be.test(this.nodeName)},teardown:function(e){b.event.remove(this,".specialChange");return be.test(this.nodeName)}};bo=b.event.special.change.filters;bo.focus=bo.beforeactivate}function aW(bw,by,e){var bx=b.extend({},e[0]);bx.type=bw;bx.originalEvent={};bx.liveFired=N;b.event.handle.call(by,bx);if(bx.isDefaultPrevented()){e[0].preventDefault()}}if(!b.support.focusinBubbles){b.each({focus:"focusin",blur:"focusout"},function(by,e){var bw=0;b.event.special[e]={setup:function(){if(bw++===0){au.addEventListener(by,bx,true)}},teardown:function(){if(--bw===0){au.removeEventListener(by,bx,true)}}};function bx(bz){var bA=b.event.fix(bz);bA.type=e;bA.originalEvent={};b.event.trigger(bA,null,bA.target);if(bA.isDefaultPrevented()){bz.preventDefault()}}})}b.each(["bind","one"],function(bw,e){b.fn[e]=function(bC,bD,bB){var bA;if(typeof bC==="object"){for(var bz in bC){this[e](bz,bD,bC[bz],bB)}return this}if(arguments.length===2||bD===false){bB=bD;bD=N}if(e==="one"){bA=function(bE){b(this).unbind(bE,bA);return bB.apply(this,arguments)};bA.guid=bB.guid||b.guid++}else{bA=bB}if(bC==="unload"&&e!=="one"){this.one(bC,bD,bB)}else{for(var by=0,bx=this.length;by<bx;by++){b.event.add(this[by],bC,bA,bD)}}return this}});b.fn.extend({unbind:function(bz,by){if(typeof bz==="object"&&!bz.preventDefault){for(var bx in bz){this.unbind(bx,bz[bx])}}else{for(var bw=0,e=this.length;bw<e;bw++){b.event.remove(this[bw],bz,by)}}return this},delegate:function(e,bw,by,bx){return this.live(bw,by,bx,e)},undelegate:function(e,bw,bx){if(arguments.length===0){return this.unbind("live")}else{return this.die(bw,null,bx,e)}},trigger:function(e,bw){return this.each(function(){b.event.trigger(e,bw,this)})},triggerHandler:function(e,bw){if(this[0]){return b.event.trigger(e,bw,this[0],true)}},toggle:function(by){var bw=arguments,e=by.guid||b.guid++,bx=0,bz=function(bA){var bB=(b.data(this,"lastToggle"+by.guid)||0)%bx;b.data(this,"lastToggle"+by.guid,bB+1);bA.preventDefault();return bw[bB].apply(this,arguments)||false};bz.guid=e;while(bx<bw.length){bw[bx++].guid=e}return this.click(bz)},hover:function(e,bw){return this.mouseenter(e).mouseleave(bw||e)}});var aS={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};b.each(["live","die"],function(bw,e){b.fn[e]=function(bG,bD,bI,bz){var bH,bE=0,bF,by,bK,bB=bz||this.selector,bx=bz?this:b(this.context);if(typeof bG==="object"&&!bG.preventDefault){for(var bJ in bG){bx[e](bJ,bD,bG[bJ],bB)}return this}if(e==="die"&&!bG&&bz&&bz.charAt(0)==="."){bx.unbind(bz);return this}if(bD===false||b.isFunction(bD)){bI=bD||bl;bD=N}bG=(bG||"").split(" ");while((bH=bG[bE++])!=null){bF=aZ.exec(bH);by="";if(bF){by=bF[0];bH=bH.replace(aZ,"")}if(bH==="hover"){bG.push("mouseenter"+by,"mouseleave"+by);continue}bK=bH;if(aS[bH]){bG.push(aS[bH]+by);bH=bH+by}else{bH=(aS[bH]||bH)+by}if(e==="live"){for(var bC=0,bA=bx.length;bC<bA;bC++){b.event.add(bx[bC],"live."+q(bH,bB),{data:bD,selector:bB,handler:bI,origType:bH,origHandler:bI,preType:bK})}}else{bx.unbind("live."+q(bH,bB),bI)}}return this}});function al(bG){var bD,by,bM,bA,e,bI,bF,bH,bE,bL,bC,bB,bK,bJ=[],bz=[],bw=b._data(this,"events");if(bG.liveFired===this||!bw||!bw.live||bG.target.disabled||bG.button&&bG.type==="click"){return}if(bG.namespace){bB=new RegExp("(^|\\.)"+bG.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")}bG.liveFired=this;var bx=bw.live.slice(0);for(bF=0;bF<bx.length;bF++){e=bx[bF];if(e.origType.replace(aZ,"")===bG.type){bz.push(e.selector)}else{bx.splice(bF--,1)}}bA=b(bG.target).closest(bz,bG.currentTarget);for(bH=0,bE=bA.length;bH<bE;bH++){bC=bA[bH];for(bF=0;bF<bx.length;bF++){e=bx[bF];if(bC.selector===e.selector&&(!bB||bB.test(e.namespace))&&!bC.elem.disabled){bI=bC.elem;bM=null;if(e.preType==="mouseenter"||e.preType==="mouseleave"){bG.type=e.preType;bM=b(bG.relatedTarget).closest(e.selector)[0];if(bM&&b.contains(bI,bM)){bM=bI}}if(!bM||bM!==bI){bJ.push({elem:bI,handleObj:e,level:bC.level})}}}}for(bH=0,bE=bJ.length;bH<bE;bH++){bA=bJ[bH];if(by&&bA.level>by){break}bG.currentTarget=bA.elem;bG.data=bA.handleObj.data;bG.handleObj=bA.handleObj;bK=bA.handleObj.origHandler.apply(bA.elem,arguments);if(bK===false||bG.isPropagationStopped()){by=bA.level;if(bK===false){bD=false}if(bG.isImmediatePropagationStopped()){break}}}return bD}function q(bw,e){return(bw&&bw!=="*"?bw+".":"")+e.replace(Q,"`").replace(bj,"&")}b.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error").split(" "),function(bw,e){b.fn[e]=function(by,bx){if(bx==null){bx=by;by=null}return arguments.length>0?this.bind(e,by,bx):this.trigger(e)};if(b.attrFn){b.attrFn[e]=true}});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var bG=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,bH=0,bK=Object.prototype.toString,bB=false,bA=true,bI=/\\/g,bO=/\W/;[0,0].sort(function(){bA=false;return 0});var by=function(bT,e,bW,bX){bW=bW||[];e=e||au;var bZ=e;if(e.nodeType!==1&&e.nodeType!==9){return[]}if(!bT||typeof bT!=="string"){return bW}var bQ,b1,b4,bP,b0,b3,b2,bV,bS=true,bR=by.isXML(e),bU=[],bY=bT;do{bG.exec("");bQ=bG.exec(bY);if(bQ){bY=bQ[3];bU.push(bQ[1]);if(bQ[2]){bP=bQ[3];break}}}while(bQ);if(bU.length>1&&bC.exec(bT)){if(bU.length===2&&bD.relative[bU[0]]){b1=bL(bU[0]+bU[1],e)}else{b1=bD.relative[bU[0]]?[e]:by(bU.shift(),e);while(bU.length){bT=bU.shift();if(bD.relative[bT]){bT+=bU.shift()}b1=bL(bT,b1)}}}else{if(!bX&&bU.length>1&&e.nodeType===9&&!bR&&bD.match.ID.test(bU[0])&&!bD.match.ID.test(bU[bU.length-1])){b0=by.find(bU.shift(),e,bR);e=b0.expr?by.filter(b0.expr,b0.set)[0]:b0.set[0]}if(e){b0=bX?{expr:bU.pop(),set:bE(bX)}:by.find(bU.pop(),bU.length===1&&(bU[0]==="~"||bU[0]==="+")&&e.parentNode?e.parentNode:e,bR);b1=b0.expr?by.filter(b0.expr,b0.set):b0.set;if(bU.length>0){b4=bE(b1)}else{bS=false}while(bU.length){b3=bU.pop();b2=b3;if(!bD.relative[b3]){b3=""}else{b2=bU.pop()}if(b2==null){b2=e}bD.relative[b3](b4,b2,bR)}}else{b4=bU=[]}}if(!b4){b4=b1}if(!b4){by.error(b3||bT)}if(bK.call(b4)==="[object Array]"){if(!bS){bW.push.apply(bW,b4)}else{if(e&&e.nodeType===1){for(bV=0;b4[bV]!=null;bV++){if(b4[bV]&&(b4[bV]===true||b4[bV].nodeType===1&&by.contains(e,b4[bV]))){bW.push(b1[bV])}}}else{for(bV=0;b4[bV]!=null;bV++){if(b4[bV]&&b4[bV].nodeType===1){bW.push(b1[bV])}}}}}else{bE(b4,bW)}if(bP){by(bP,bZ,bW,bX);by.uniqueSort(bW)}return bW};by.uniqueSort=function(bP){if(bJ){bB=bA;bP.sort(bJ);if(bB){for(var e=1;e<bP.length;e++){if(bP[e]===bP[e-1]){bP.splice(e--,1)}}}}return bP};by.matches=function(e,bP){return by(e,null,null,bP)};by.matchesSelector=function(e,bP){return by(bP,null,null,[e]).length>0};by.find=function(bV,e,bW){var bU;if(!bV){return[]}for(var bR=0,bQ=bD.order.length;bR<bQ;bR++){var bS,bT=bD.order[bR];if((bS=bD.leftMatch[bT].exec(bV))){var bP=bS[1];bS.splice(1,1);if(bP.substr(bP.length-1)!=="\\"){bS[1]=(bS[1]||"").replace(bI,"");bU=bD.find[bT](bS,e,bW);if(bU!=null){bV=bV.replace(bD.match[bT],"");break}}}}if(!bU){bU=typeof e.getElementsByTagName!=="undefined"?e.getElementsByTagName("*"):[]}return{set:bU,expr:bV}};by.filter=function(bZ,bY,b2,bS){var bU,e,bQ=bZ,b4=[],bW=bY,bV=bY&&bY[0]&&by.isXML(bY[0]);while(bZ&&bY.length){for(var bX in bD.filter){if((bU=bD.leftMatch[bX].exec(bZ))!=null&&bU[2]){var b3,b1,bP=bD.filter[bX],bR=bU[1];e=false;bU.splice(1,1);if(bR.substr(bR.length-1)==="\\"){continue}if(bW===b4){b4=[]}if(bD.preFilter[bX]){bU=bD.preFilter[bX](bU,bW,b2,b4,bS,bV);if(!bU){e=b3=true}else{if(bU===true){continue}}}if(bU){for(var bT=0;(b1=bW[bT])!=null;bT++){if(b1){b3=bP(b1,bU,bT,bW);var b0=bS^!!b3;if(b2&&b3!=null){if(b0){e=true}else{bW[bT]=false}}else{if(b0){b4.push(b1);e=true}}}}}if(b3!==N){if(!b2){bW=b4}bZ=bZ.replace(bD.match[bX],"");if(!e){return[]}break}}}if(bZ===bQ){if(e==null){by.error(bZ)}else{break}}bQ=bZ}return bW};by.error=function(e){throw"Syntax error, unrecognized expression: "+e};var bD=by.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(bU,bP){var bR=typeof bP==="string",bT=bR&&!bO.test(bP),bV=bR&&!bT;if(bT){bP=bP.toLowerCase()}for(var bQ=0,e=bU.length,bS;bQ<e;bQ++){if((bS=bU[bQ])){while((bS=bS.previousSibling)&&bS.nodeType!==1){}bU[bQ]=bV||bS&&bS.nodeName.toLowerCase()===bP?bS||false:bS===bP}}if(bV){by.filter(bP,bU,true)}},">":function(bU,bP){var bT,bS=typeof bP==="string",bQ=0,e=bU.length;if(bS&&!bO.test(bP)){bP=bP.toLowerCase();for(;bQ<e;bQ++){bT=bU[bQ];if(bT){var bR=bT.parentNode;bU[bQ]=bR.nodeName.toLowerCase()===bP?bR:false}}}else{for(;bQ<e;bQ++){bT=bU[bQ];if(bT){bU[bQ]=bS?bT.parentNode:bT.parentNode===bP}}if(bS){by.filter(bP,bU,true)}}},"":function(bR,bP,bT){var bS,bQ=bH++,e=bM;if(typeof bP==="string"&&!bO.test(bP)){bP=bP.toLowerCase();bS=bP;e=bw}e("parentNode",bP,bQ,bR,bS,bT)},"~":function(bR,bP,bT){var bS,bQ=bH++,e=bM;if(typeof bP==="string"&&!bO.test(bP)){bP=bP.toLowerCase();bS=bP;e=bw}e("previousSibling",bP,bQ,bR,bS,bT)}},find:{ID:function(bP,bQ,bR){if(typeof bQ.getElementById!=="undefined"&&!bR){var e=bQ.getElementById(bP[1]);return e&&e.parentNode?[e]:[]}},NAME:function(bQ,bT){if(typeof bT.getElementsByName!=="undefined"){var bP=[],bS=bT.getElementsByName(bQ[1]);for(var bR=0,e=bS.length;bR<e;bR++){if(bS[bR].getAttribute("name")===bQ[1]){bP.push(bS[bR])}}return bP.length===0?null:bP}},TAG:function(e,bP){if(typeof bP.getElementsByTagName!=="undefined"){return bP.getElementsByTagName(e[1])}}},preFilter:{CLASS:function(bR,bP,bQ,e,bU,bV){bR=" "+bR[1].replace(bI,"")+" ";if(bV){return bR}for(var bS=0,bT;(bT=bP[bS])!=null;bS++){if(bT){if(bU^(bT.className&&(" "+bT.className+" ").replace(/[\t\n\r]/g," ").indexOf(bR)>=0)){if(!bQ){e.push(bT)}}else{if(bQ){bP[bS]=false}}}}return false},ID:function(e){return e[1].replace(bI,"")},TAG:function(bP,e){return bP[1].replace(bI,"").toLowerCase()},CHILD:function(e){if(e[1]==="nth"){if(!e[2]){by.error(e[0])}e[2]=e[2].replace(/^\+|\s*/g,"");var bP=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=(bP[1]+(bP[2]||1))-0;e[3]=bP[3]-0}else{if(e[2]){by.error(e[0])}}e[0]=bH++;return e},ATTR:function(bS,bP,bQ,e,bT,bU){var bR=bS[1]=bS[1].replace(bI,"");if(!bU&&bD.attrMap[bR]){bS[1]=bD.attrMap[bR]}bS[4]=(bS[4]||bS[5]||"").replace(bI,"");if(bS[2]==="~="){bS[4]=" "+bS[4]+" "}return bS},PSEUDO:function(bS,bP,bQ,e,bT){if(bS[1]==="not"){if((bG.exec(bS[3])||"").length>1||/^\w/.test(bS[3])){bS[3]=by(bS[3],null,null,bP)}else{var bR=by.filter(bS[3],bP,bQ,true^bT);if(!bQ){e.push.apply(e,bR)}return false}}else{if(bD.match.POS.test(bS[0])||bD.match.CHILD.test(bS[0])){return true}}return bS},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(bQ,bP,e){return !!by(e[3],bQ).length},header:function(e){return(/h\d/i).test(e.nodeName)},text:function(bQ){var e=bQ.getAttribute("type"),bP=bQ.type;return bQ.nodeName.toLowerCase()==="input"&&"text"===bP&&(e===bP||e===null)},radio:function(e){return e.nodeName.toLowerCase()==="input"&&"radio"===e.type},checkbox:function(e){return e.nodeName.toLowerCase()==="input"&&"checkbox"===e.type},file:function(e){return e.nodeName.toLowerCase()==="input"&&"file"===e.type},password:function(e){return e.nodeName.toLowerCase()==="input"&&"password"===e.type},submit:function(bP){var e=bP.nodeName.toLowerCase();return(e==="input"||e==="button")&&"submit"===bP.type},image:function(e){return e.nodeName.toLowerCase()==="input"&&"image"===e.type},reset:function(bP){var e=bP.nodeName.toLowerCase();return(e==="input"||e==="button")&&"reset"===bP.type},button:function(bP){var e=bP.nodeName.toLowerCase();return e==="input"&&"button"===bP.type||e==="button"},input:function(e){return(/input|select|textarea|button/i).test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(bP,e){return e===0},last:function(bQ,bP,e,bR){return bP===bR.length-1},even:function(bP,e){return e%2===0},odd:function(bP,e){return e%2===1},lt:function(bQ,bP,e){return bP<e[3]-0},gt:function(bQ,bP,e){return bP>e[3]-0},nth:function(bQ,bP,e){return e[3]-0===bP},eq:function(bQ,bP,e){return e[3]-0===bP}},filter:{PSEUDO:function(bQ,bV,bU,bW){var e=bV[1],bP=bD.filters[e];if(bP){return bP(bQ,bU,bV,bW)}else{if(e==="contains"){return(bQ.textContent||bQ.innerText||by.getText([bQ])||"").indexOf(bV[3])>=0}else{if(e==="not"){var bR=bV[3];for(var bT=0,bS=bR.length;bT<bS;bT++){if(bR[bT]===bQ){return false}}return true}else{by.error(e)}}}},CHILD:function(e,bR){var bU=bR[1],bP=e;switch(bU){case"only":case"first":while((bP=bP.previousSibling)){if(bP.nodeType===1){return false}}if(bU==="first"){return true}bP=e;case"last":while((bP=bP.nextSibling)){if(bP.nodeType===1){return false}}return true;case"nth":var bQ=bR[2],bX=bR[3];if(bQ===1&&bX===0){return true}var bT=bR[0],bW=e.parentNode;if(bW&&(bW.sizcache!==bT||!e.nodeIndex)){var bS=0;for(bP=bW.firstChild;bP;bP=bP.nextSibling){if(bP.nodeType===1){bP.nodeIndex=++bS}}bW.sizcache=bT}var bV=e.nodeIndex-bX;if(bQ===0){return bV===0}else{return(bV%bQ===0&&bV/bQ>=0)}}},ID:function(bP,e){return bP.nodeType===1&&bP.getAttribute("id")===e},TAG:function(bP,e){return(e==="*"&&bP.nodeType===1)||bP.nodeName.toLowerCase()===e},CLASS:function(bP,e){return(" "+(bP.className||bP.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(bT,bR){var bQ=bR[1],e=bD.attrHandle[bQ]?bD.attrHandle[bQ](bT):bT[bQ]!=null?bT[bQ]:bT.getAttribute(bQ),bU=e+"",bS=bR[2],bP=bR[4];return e==null?bS==="!=":bS==="="?bU===bP:bS==="*="?bU.indexOf(bP)>=0:bS==="~="?(" "+bU+" ").indexOf(bP)>=0:!bP?bU&&e!==false:bS==="!="?bU!==bP:bS==="^="?bU.indexOf(bP)===0:bS==="$="?bU.substr(bU.length-bP.length)===bP:bS==="|="?bU===bP||bU.substr(0,bP.length+1)===bP+"-":false},POS:function(bS,bP,bQ,bT){var e=bP[2],bR=bD.setFilters[e];if(bR){return bR(bS,bQ,bP,bT)}}}};var bC=bD.match.POS,bx=function(bP,e){return"\\"+(e-0+1)};for(var bz in bD.match){bD.match[bz]=new RegExp(bD.match[bz].source+(/(?![^\[]*\])(?![^\(]*\))/.source));bD.leftMatch[bz]=new RegExp(/(^(?:.|\r|\n)*?)/.source+bD.match[bz].source.replace(/\\(\d+)/g,bx))}var bE=function(bP,e){bP=Array.prototype.slice.call(bP,0);if(e){e.push.apply(e,bP);return e}return bP};try{Array.prototype.slice.call(au.documentElement.childNodes,0)[0].nodeType}catch(bN){bE=function(bS,bR){var bQ=0,bP=bR||[];if(bK.call(bS)==="[object Array]"){Array.prototype.push.apply(bP,bS)}else{if(typeof bS.length==="number"){for(var e=bS.length;bQ<e;bQ++){bP.push(bS[bQ])}}else{for(;bS[bQ];bQ++){bP.push(bS[bQ])}}}return bP}}var bJ,bF;if(au.documentElement.compareDocumentPosition){bJ=function(bP,e){if(bP===e){bB=true;return 0}if(!bP.compareDocumentPosition||!e.compareDocumentPosition){return bP.compareDocumentPosition?-1:1}return bP.compareDocumentPosition(e)&4?-1:1}}else{bJ=function(bW,bV){if(bW===bV){bB=true;return 0}else{if(bW.sourceIndex&&bV.sourceIndex){return bW.sourceIndex-bV.sourceIndex}}var bT,bP,bQ=[],e=[],bS=bW.parentNode,bU=bV.parentNode,bX=bS;if(bS===bU){return bF(bW,bV)}else{if(!bS){return -1}else{if(!bU){return 1}}}while(bX){bQ.unshift(bX);bX=bX.parentNode}bX=bU;while(bX){e.unshift(bX);bX=bX.parentNode}bT=bQ.length;bP=e.length;for(var bR=0;bR<bT&&bR<bP;bR++){if(bQ[bR]!==e[bR]){return bF(bQ[bR],e[bR])}}return bR===bT?bF(bW,e[bR],-1):bF(bQ[bR],bV,1)};bF=function(bP,e,bQ){if(bP===e){return bQ}var bR=bP.nextSibling;while(bR){if(bR===e){return -1}bR=bR.nextSibling}return 1}}by.getText=function(e){var bP="",bR;for(var bQ=0;e[bQ];bQ++){bR=e[bQ];if(bR.nodeType===3||bR.nodeType===4){bP+=bR.nodeValue}else{if(bR.nodeType!==8){bP+=by.getText(bR.childNodes)}}}return bP};(function(){var bP=au.createElement("div"),bQ="script"+(new Date()).getTime(),e=au.documentElement;bP.innerHTML="<a name='"+bQ+"'/>";e.insertBefore(bP,e.firstChild);if(au.getElementById(bQ)){bD.find.ID=function(bS,bT,bU){if(typeof bT.getElementById!=="undefined"&&!bU){var bR=bT.getElementById(bS[1]);return bR?bR.id===bS[1]||typeof bR.getAttributeNode!=="undefined"&&bR.getAttributeNode("id").nodeValue===bS[1]?[bR]:N:[]}};bD.filter.ID=function(bT,bR){var bS=typeof bT.getAttributeNode!=="undefined"&&bT.getAttributeNode("id");return bT.nodeType===1&&bS&&bS.nodeValue===bR}}e.removeChild(bP);e=bP=null})();(function(){var e=au.createElement("div");e.appendChild(au.createComment(""));if(e.getElementsByTagName("*").length>0){bD.find.TAG=function(bP,bT){var bS=bT.getElementsByTagName(bP[1]);if(bP[1]==="*"){var bR=[];for(var bQ=0;bS[bQ];bQ++){if(bS[bQ].nodeType===1){bR.push(bS[bQ])}}bS=bR}return bS}}e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){bD.attrHandle.href=function(bP){return bP.getAttribute("href",2)}}e=null})();if(au.querySelectorAll){(function(){var e=by,bR=au.createElement("div"),bQ="__sizzle__";bR.innerHTML="<p class='TEST'></p>";if(bR.querySelectorAll&&bR.querySelectorAll(".TEST").length===0){return}by=function(b2,bT,bX,b1){bT=bT||au;if(!b1&&!by.isXML(bT)){var b0=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b2);if(b0&&(bT.nodeType===1||bT.nodeType===9)){if(b0[1]){return bE(bT.getElementsByTagName(b2),bX)}else{if(b0[2]&&bD.find.CLASS&&bT.getElementsByClassName){return bE(bT.getElementsByClassName(b0[2]),bX)}}}if(bT.nodeType===9){if(b2==="body"&&bT.body){return bE([bT.body],bX)}else{if(b0&&b0[3]){var bW=bT.getElementById(b0[3]);if(bW&&bW.parentNode){if(bW.id===b0[3]){return bE([bW],bX)}}else{return bE([],bX)}}}try{return bE(bT.querySelectorAll(b2),bX)}catch(bY){}}else{if(bT.nodeType===1&&bT.nodeName.toLowerCase()!=="object"){var bU=bT,bV=bT.getAttribute("id"),bS=bV||bQ,b4=bT.parentNode,b3=/^\s*[+~]/.test(b2);if(!bV){bT.setAttribute("id",bS)}else{bS=bS.replace(/'/g,"\\$&")}if(b3&&b4){bT=bT.parentNode}try{if(!b3||b4){return bE(bT.querySelectorAll("[id='"+bS+"'] "+b2),bX)}}catch(bZ){}finally{if(!bV){bU.removeAttribute("id")}}}}}return e(b2,bT,bX,b1)};for(var bP in e){by[bP]=e[bP]}bR=null})()}(function(){var e=au.documentElement,bQ=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(bQ){var bS=!bQ.call(au.createElement("div"),"div"),bP=false;try{bQ.call(au.documentElement,"[test!='']:sizzle")}catch(bR){bP=true}by.matchesSelector=function(bU,bW){bW=bW.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!by.isXML(bU)){try{if(bP||!bD.match.PSEUDO.test(bW)&&!/!=/.test(bW)){var bT=bQ.call(bU,bW);if(bT||!bS||bU.document&&bU.document.nodeType!==11){return bT}}}catch(bV){}}return by(bW,null,null,[bU]).length>0}}})();(function(){var e=au.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){return}e.lastChild.className="e";if(e.getElementsByClassName("e").length===1){return}bD.order.splice(1,0,"CLASS");bD.find.CLASS=function(bP,bQ,bR){if(typeof bQ.getElementsByClassName!=="undefined"&&!bR){return bQ.getElementsByClassName(bP[1])}};e=null})();function bw(bP,bU,bT,bX,bV,bW){for(var bR=0,bQ=bX.length;bR<bQ;bR++){var e=bX[bR];if(e){var bS=false;e=e[bP];while(e){if(e.sizcache===bT){bS=bX[e.sizset];break}if(e.nodeType===1&&!bW){e.sizcache=bT;e.sizset=bR}if(e.nodeName.toLowerCase()===bU){bS=e;break}e=e[bP]}bX[bR]=bS}}}function bM(bP,bU,bT,bX,bV,bW){for(var bR=0,bQ=bX.length;bR<bQ;bR++){var e=bX[bR];if(e){var bS=false;e=e[bP];while(e){if(e.sizcache===bT){bS=bX[e.sizset];break}if(e.nodeType===1){if(!bW){e.sizcache=bT;e.sizset=bR}if(typeof bU!=="string"){if(e===bU){bS=true;break}}else{if(by.filter(bU,[e]).length>0){bS=e;break}}}e=e[bP]}bX[bR]=bS}}}if(au.documentElement.contains){by.contains=function(bP,e){return bP!==e&&(bP.contains?bP.contains(e):true)}}else{if(au.documentElement.compareDocumentPosition){by.contains=function(bP,e){return !!(bP.compareDocumentPosition(e)&16)}}else{by.contains=function(){return false}}}by.isXML=function(e){var bP=(e?e.ownerDocument||e:0).documentElement;return bP?bP.nodeName!=="HTML":false};var bL=function(e,bV){var bT,bR=[],bS="",bQ=bV.nodeType?[bV]:bV;while((bT=bD.match.PSEUDO.exec(e))){bS+=bT[0];e=e.replace(bD.match.PSEUDO,"")}e=bD.relative[e]?e+"*":e;for(var bU=0,bP=bQ.length;bU<bP;bU++){by(e,bQ[bU],bR)}return by.filter(bS,bR)};b.find=by;b.expr=by.selectors;b.expr[":"]=b.expr.filters;b.unique=by.uniqueSort;b.text=by.getText;b.isXMLDoc=by.isXML;b.contains=by.contains})();var ab=/Until$/,ap=/^(?:parents|prevUntil|prevAll)/,ba=/,/,br=/^.[^:#\[\.,]*$/,S=Array.prototype.slice,K=b.expr.match.POS,ax={children:true,contents:true,next:true,prev:true};b.fn.extend({find:function(e){var bx=this,bz,bw;if(typeof e!=="string"){return b(e).filter(function(){for(bz=0,bw=bx.length;bz<bw;bz++){if(b.contains(bx[bz],this)){return true}}})}var by=this.pushStack("","find",e),bB,bC,bA;for(bz=0,bw=this.length;bz<bw;bz++){bB=by.length;b.find(e,this[bz],by);if(bz>0){for(bC=bB;bC<by.length;bC++){for(bA=0;bA<bB;bA++){if(by[bA]===by[bC]){by.splice(bC--,1);break}}}}}return by},has:function(bw){var e=b(bw);return this.filter(function(){for(var by=0,bx=e.length;by<bx;by++){if(b.contains(this,e[by])){return true}}})},not:function(e){return this.pushStack(aE(this,e,false),"not",e)},filter:function(e){return this.pushStack(aE(this,e,true),"filter",e)},is:function(e){return !!e&&(typeof e==="string"?b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(bF,bw){var bC=[],bz,bx,bE=this[0];if(b.isArray(bF)){var bB,by,bA={},e=1;if(bE&&bF.length){for(bz=0,bx=bF.length;bz<bx;bz++){by=bF[bz];if(!bA[by]){bA[by]=K.test(by)?b(by,bw||this.context):by}}while(bE&&bE.ownerDocument&&bE!==bw){for(by in bA){bB=bA[by];if(bB.jquery?bB.index(bE)>-1:b(bE).is(bB)){bC.push({selector:by,elem:bE,level:e})}}bE=bE.parentNode;e++}}return bC}var bD=K.test(bF)||typeof bF!=="string"?b(bF,bw||this.context):0;for(bz=0,bx=this.length;bz<bx;bz++){bE=this[bz];while(bE){if(bD?bD.index(bE)>-1:b.find.matchesSelector(bE,bF)){bC.push(bE);break}else{bE=bE.parentNode;if(!bE||!bE.ownerDocument||bE===bw||bE.nodeType===11){break}}}}bC=bC.length>1?b.unique(bC):bC;return this.pushStack(bC,"closest",bF)},index:function(e){if(!e||typeof e==="string"){return b.inArray(this[0],e?b(e):this.parent().children())}return b.inArray(e.jquery?e[0]:e,this)},add:function(e,bw){var by=typeof e==="string"?b(e,bw):b.makeArray(e&&e.nodeType?[e]:e),bx=b.merge(this.get(),by);return this.pushStack(F(by[0])||F(bx[0])?bx:b.unique(bx))},andSelf:function(){return this.add(this.prevObject)}});function F(e){return !e||!e.parentNode||e.parentNode.nodeType===11}b.each({parent:function(bw){var e=bw.parentNode;return e&&e.nodeType!==11?e:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(bw,e,bx){return b.dir(bw,"parentNode",bx)},next:function(e){return b.nth(e,2,"nextSibling")},prev:function(e){return b.nth(e,2,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(bw,e,bx){return b.dir(bw,"nextSibling",bx)},prevUntil:function(bw,e,bx){return b.dir(bw,"previousSibling",bx)},siblings:function(e){return b.sibling(e.parentNode.firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.makeArray(e.childNodes)}},function(e,bw){b.fn[e]=function(bA,bx){var bz=b.map(this,bw,bA),by=S.call(arguments);if(!ab.test(e)){bx=bA}if(bx&&typeof bx==="string"){bz=b.filter(bx,bz)}bz=this.length>1&&!ax[e]?b.unique(bz):bz;if((this.length>1||ba.test(bx))&&ap.test(e)){bz=bz.reverse()}return this.pushStack(bz,e,by.join(","))}});b.extend({filter:function(bx,e,bw){if(bw){bx=":not("+bx+")"}return e.length===1?b.find.matchesSelector(e[0],bx)?[e[0]]:[]:b.find.matches(bx,e)},dir:function(bx,bw,bz){var e=[],by=bx[bw];while(by&&by.nodeType!==9&&(bz===N||by.nodeType!==1||!b(by).is(bz))){if(by.nodeType===1){e.push(by)}by=by[bw]}return e},nth:function(bz,e,bx,by){e=e||1;var bw=0;for(;bz;bz=bz[bx]){if(bz.nodeType===1&&++bw===e){break}}return bz},sibling:function(bx,bw){var e=[];for(;bx;bx=bx.nextSibling){if(bx.nodeType===1&&bx!==bw){e.push(bx)}}return e}});function aE(by,bx,e){bx=bx||0;if(b.isFunction(bx)){return b.grep(by,function(bA,bz){var bB=!!bx.call(bA,bz,bA);return bB===e})}else{if(bx.nodeType){return b.grep(by,function(bA,bz){return(bA===bx)===e})}else{if(typeof bx==="string"){var bw=b.grep(by,function(bz){return bz.nodeType===1});if(br.test(bx)){return b.filter(bx,bw,!e)}else{bx=b.filter(bx,bw)}}}}return b.grep(by,function(bA,bz){return(b.inArray(bA,bx)>=0)===e})}var ag=/ jQuery\d+="(?:\d+|null)"/g,aq=/^\s+/,V=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,d=/<([\w:]+)/,y=/<tbody/i,Y=/<|&#?\w+;/,R=/<(?:script|object|embed|option|style)/i,o=/checked\s*(?:[^=]|=\s*.checked.)/i,bn=/\/(java|ecma)script/i,aM=/^\s*<!(?:\[CDATA\[|\-\-)/,aw={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};aw.optgroup=aw.option;aw.tbody=aw.tfoot=aw.colgroup=aw.caption=aw.thead;aw.th=aw.td;if(!b.support.htmlSerialize){aw._default=[1,"div<div>","</div>"]}b.fn.extend({text:function(e){if(b.isFunction(e)){return this.each(function(bx){var bw=b(this);bw.text(e.call(this,bx,bw.text()))})}if(typeof e!=="object"&&e!==N){return this.empty().append((this[0]&&this[0].ownerDocument||au).createTextNode(e))}return b.text(this)},wrapAll:function(e){if(b.isFunction(e)){return this.each(function(bx){b(this).wrapAll(e.call(this,bx))})}if(this[0]){var bw=b(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){bw.insertBefore(this[0])}bw.map(function(){var bx=this;while(bx.firstChild&&bx.firstChild.nodeType===1){bx=bx.firstChild}return bx}).append(this)}return this},wrapInner:function(e){if(b.isFunction(e)){return this.each(function(bw){b(this).wrapInner(e.call(this,bw))})}return this.each(function(){var bw=b(this),bx=bw.contents();if(bx.length){bx.wrapAll(e)}else{bw.append(e)}})},wrap:function(e){return this.each(function(){b(this).wrapAll(e)})},unwrap:function(){return this.parent().each(function(){if(!b.nodeName(this,"body")){b(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1){this.appendChild(e)}})},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1){this.insertBefore(e,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bw){this.parentNode.insertBefore(bw,this)})}else{if(arguments.length){var e=b(arguments[0]);e.push.apply(e,this.toArray());return this.pushStack(e,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bw){this.parentNode.insertBefore(bw,this.nextSibling)})}else{if(arguments.length){var e=this.pushStack(this,"after",arguments);e.push.apply(e,b(arguments[0]).toArray());return e}}},remove:function(e,by){for(var bw=0,bx;(bx=this[bw])!=null;bw++){if(!e||b.filter(e,[bx]).length){if(!by&&bx.nodeType===1){b.cleanData(bx.getElementsByTagName("*"));b.cleanData([bx])}if(bx.parentNode){bx.parentNode.removeChild(bx)}}}return this},empty:function(){for(var e=0,bw;(bw=this[e])!=null;e++){if(bw.nodeType===1){b.cleanData(bw.getElementsByTagName("*"))}while(bw.firstChild){bw.removeChild(bw.firstChild)}}return this},clone:function(bw,e){bw=bw==null?false:bw;e=e==null?bw:e;return this.map(function(){return b.clone(this,bw,e)})},html:function(by){if(by===N){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(ag,""):null}else{if(typeof by==="string"&&!R.test(by)&&(b.support.leadingWhitespace||!aq.test(by))&&!aw[(d.exec(by)||["",""])[1].toLowerCase()]){by=by.replace(V,"<$1></$2>");try{for(var bx=0,bw=this.length;bx<bw;bx++){if(this[bx].nodeType===1){b.cleanData(this[bx].getElementsByTagName("*"));this[bx].innerHTML=by}}}catch(bz){this.empty().append(by)}}else{if(b.isFunction(by)){this.each(function(bA){var e=b(this);e.html(by.call(this,bA,e.html()))})}else{this.empty().append(by)}}}return this},replaceWith:function(e){if(this[0]&&this[0].parentNode){if(b.isFunction(e)){return this.each(function(by){var bx=b(this),bw=bx.html();bx.replaceWith(e.call(this,by,bw))})}if(typeof e!=="string"){e=b(e).detach()}return this.each(function(){var bx=this.nextSibling,bw=this.parentNode;b(this).remove();if(bx){b(bx).before(e)}else{b(bw).append(e)}})}else{return this.length?this.pushStack(b(b.isFunction(e)?e():e),"replaceWith",e):this}},detach:function(e){return this.remove(e,true)},domManip:function(bC,bG,bF){var by,bz,bB,bE,bD=bC[0],bw=[];if(!b.support.checkClone&&arguments.length===3&&typeof bD==="string"&&o.test(bD)){return this.each(function(){b(this).domManip(bC,bG,bF,true)})}if(b.isFunction(bD)){return this.each(function(bI){var bH=b(this);bC[0]=bD.call(this,bI,bG?bH.html():N);bH.domManip(bC,bG,bF)})}if(this[0]){bE=bD&&bD.parentNode;if(b.support.parentNode&&bE&&bE.nodeType===11&&bE.childNodes.length===this.length){by={fragment:bE}}else{by=b.buildFragment(bC,this,bw)}bB=by.fragment;if(bB.childNodes.length===1){bz=bB=bB.firstChild}else{bz=bB.firstChild}if(bz){bG=bG&&b.nodeName(bz,"tr");for(var bx=0,e=this.length,bA=e-1;bx<e;bx++){bF.call(bG?bb(this[bx],bz):this[bx],by.cacheable||(e>1&&bx<bA)?b.clone(bB,true,true):bB)}}if(bw.length){b.each(bw,bq)}}return this}});function bb(e,bw){return b.nodeName(e,"table")?(e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody"))):e}function v(e,bC){if(bC.nodeType!==1||!b.hasData(e)){return}var bB=b.expando,by=b.data(e),bz=b.data(bC,by);if((by=by[bB])){var bD=by.events;bz=bz[bB]=b.extend({},by);if(bD){delete bz.handle;bz.events={};for(var bA in bD){for(var bx=0,bw=bD[bA].length;bx<bw;bx++){b.event.add(bC,bA+(bD[bA][bx].namespace?".":"")+bD[bA][bx].namespace,bD[bA][bx],bD[bA][bx].data)}}}}}function ah(bw,e){var bx;if(e.nodeType!==1){return}if(e.clearAttributes){e.clearAttributes()}if(e.mergeAttributes){e.mergeAttributes(bw)}bx=e.nodeName.toLowerCase();if(bx==="object"){e.outerHTML=bw.outerHTML}else{if(bx==="input"&&(bw.type==="checkbox"||bw.type==="radio")){if(bw.checked){e.defaultChecked=e.checked=bw.checked}if(e.value!==bw.value){e.value=bw.value}}else{if(bx==="option"){e.selected=bw.defaultSelected}else{if(bx==="input"||bx==="textarea"){e.defaultValue=bw.defaultValue}}}}e.removeAttribute(b.expando)}b.buildFragment=function(bA,by,bw){var bz,e,bx,bB;if(by&&by[0]){bB=by[0].ownerDocument||by[0]}if(!bB.createDocumentFragment){bB=au}if(bA.length===1&&typeof bA[0]==="string"&&bA[0].length<512&&bB===au&&bA[0].charAt(0)==="<"&&!R.test(bA[0])&&(b.support.checkClone||!o.test(bA[0]))){e=true;bx=b.fragments[bA[0]];if(bx&&bx!==1){bz=bx}}if(!bz){bz=bB.createDocumentFragment();b.clean(bA,bB,bz,bw)}if(e){b.fragments[bA[0]]=bx?bz:1}return{fragment:bz,cacheable:e}};b.fragments={};b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,bw){b.fn[e]=function(bx){var bA=[],bD=b(bx),bC=this.length===1&&this[0].parentNode;if(bC&&bC.nodeType===11&&bC.childNodes.length===1&&bD.length===1){bD[bw](this[0]);return this}else{for(var bB=0,by=bD.length;bB<by;bB++){var bz=(bB>0?this.clone(true):this).get();b(bD[bB])[bw](bz);bA=bA.concat(bz)}return this.pushStack(bA,e,bD.selector)}}});function bf(e){if("getElementsByTagName" in e){return e.getElementsByTagName("*")}else{if("querySelectorAll" in e){return e.querySelectorAll("*")}else{return[]}}}function ay(e){if(e.type==="checkbox"||e.type==="radio"){e.defaultChecked=e.checked}}function H(e){if(b.nodeName(e,"input")){ay(e)}else{if("getElementsByTagName" in e){b.grep(e.getElementsByTagName("input"),ay)}}}b.extend({clone:function(bz,bB,bx){var bA=bz.cloneNode(true),e,bw,by;if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(bz.nodeType===1||bz.nodeType===11)&&!b.isXMLDoc(bz)){ah(bz,bA);e=bf(bz);bw=bf(bA);for(by=0;e[by];++by){ah(e[by],bw[by])}}if(bB){v(bz,bA);if(bx){e=bf(bz);bw=bf(bA);for(by=0;e[by];++by){v(e[by],bw[by])}}}e=bw=null;return bA},clean:function(bx,bz,bI,bB){var bG;bz=bz||au;if(typeof bz.createElement==="undefined"){bz=bz.ownerDocument||bz[0]&&bz[0].ownerDocument||au}var bJ=[],bC;for(var bF=0,bA;(bA=bx[bF])!=null;bF++){if(typeof bA==="number"){bA+=""}if(!bA){continue}if(typeof bA==="string"){if(!Y.test(bA)){bA=bz.createTextNode(bA)}else{bA=bA.replace(V,"<$1></$2>");var bL=(d.exec(bA)||["",""])[1].toLowerCase(),by=aw[bL]||aw._default,bE=by[0],bw=bz.createElement("div");bw.innerHTML=by[1]+bA+by[2];while(bE--){bw=bw.lastChild}if(!b.support.tbody){var e=y.test(bA),bD=bL==="table"&&!e?bw.firstChild&&bw.firstChild.childNodes:by[1]==="<table>"&&!e?bw.childNodes:[];for(bC=bD.length-1;bC>=0;--bC){if(b.nodeName(bD[bC],"tbody")&&!bD[bC].childNodes.length){bD[bC].parentNode.removeChild(bD[bC])}}}if(!b.support.leadingWhitespace&&aq.test(bA)){bw.insertBefore(bz.createTextNode(aq.exec(bA)[0]),bw.firstChild)}bA=bw.childNodes}}var bH;if(!b.support.appendChecked){if(bA[0]&&typeof(bH=bA.length)==="number"){for(bC=0;bC<bH;bC++){H(bA[bC])}}else{H(bA)}}if(bA.nodeType){bJ.push(bA)}else{bJ=b.merge(bJ,bA)}}if(bI){bG=function(bM){return !bM.type||bn.test(bM.type)};for(bF=0;bJ[bF];bF++){if(bB&&b.nodeName(bJ[bF],"script")&&(!bJ[bF].type||bJ[bF].type.toLowerCase()==="text/javascript")){bB.push(bJ[bF].parentNode?bJ[bF].parentNode.removeChild(bJ[bF]):bJ[bF])}else{if(bJ[bF].nodeType===1){var bK=b.grep(bJ[bF].getElementsByTagName("script"),bG);bJ.splice.apply(bJ,[bF+1,0].concat(bK))}bI.appendChild(bJ[bF])}}}return bJ},cleanData:function(bw){var bz,bx,e=b.cache,bE=b.expando,bC=b.event.special,bB=b.support.deleteExpando;for(var bA=0,by;(by=bw[bA])!=null;bA++){if(by.nodeName&&b.noData[by.nodeName.toLowerCase()]){continue}bx=by[b.expando];if(bx){bz=e[bx]&&e[bx][bE];if(bz&&bz.events){for(var bD in bz.events){if(bC[bD]){b.event.remove(by,bD)}else{b.removeEvent(by,bD,bz.handle)}}if(bz.handle){bz.handle.elem=null}}if(bB){delete by[b.expando]}else{if(by.removeAttribute){by.removeAttribute(b.expando)}}delete e[bx]}}}});function bq(e,bw){if(bw.src){b.ajax({url:bw.src,async:false,dataType:"script"})}else{b.globalEval((bw.text||bw.textContent||bw.innerHTML||"").replace(aM,"/*$0*/"))}if(bw.parentNode){bw.parentNode.removeChild(bw)}}var ak=/alpha\([^)]*\)/i,at=/opacity=([^)]*)/,C=/([A-Z]|^ms)/g,bd=/^-?\d+(?:px)?$/i,bp=/^-?\d/,L=/^[+\-]=/,aj=/[^+\-\.\de]+/g,a7={position:"absolute",visibility:"hidden",display:"block"},am=["Left","Right"],a1=["Top","Bottom"],Z,aH,aV;b.fn.css=function(e,bw){if(arguments.length===2&&bw===N){return this}return b.access(this,e,bw,true,function(by,bx,bz){return bz!==N?b.style(by,bx,bz):b.css(by,bx)})};b.extend({cssHooks:{opacity:{get:function(bx,bw){if(bw){var e=Z(bx,"opacity","opacity");return e===""?"1":e}else{return bx.style.opacity}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(by,bx,bE,bz){if(!by||by.nodeType===3||by.nodeType===8||!by.style){return}var bC,bD,bA=b.camelCase(bx),bw=by.style,bF=b.cssHooks[bA];bx=b.cssProps[bA]||bA;if(bE!==N){bD=typeof bE;if(bD==="number"&&isNaN(bE)||bE==null){return}if(bD==="string"&&L.test(bE)){bE=+bE.replace(aj,"")+parseFloat(b.css(by,bx));bD="number"}if(bD==="number"&&!b.cssNumber[bA]){bE+="px"}if(!bF||!("set" in bF)||(bE=bF.set(by,bE))!==N){try{bw[bx]=bE}catch(bB){}}}else{if(bF&&"get" in bF&&(bC=bF.get(by,false,bz))!==N){return bC}return bw[bx]}},css:function(bz,by,bw){var bx,e;by=b.camelCase(by);e=b.cssHooks[by];by=b.cssProps[by]||by;if(by==="cssFloat"){by="float"}if(e&&"get" in e&&(bx=e.get(bz,true,bw))!==N){return bx}else{if(Z){return Z(bz,by)}}},swap:function(by,bx,bz){var e={};for(var bw in bx){e[bw]=by.style[bw];by.style[bw]=bx[bw]}bz.call(by);for(bw in bx){by.style[bw]=e[bw]}}});b.curCSS=b.css;b.each(["height","width"],function(bw,e){b.cssHooks[e]={get:function(bz,by,bx){var bA;if(by){if(bz.offsetWidth!==0){return p(bz,e,bx)}else{b.swap(bz,a7,function(){bA=p(bz,e,bx)})}return bA}},set:function(bx,by){if(bd.test(by)){by=parseFloat(by);if(by>=0){return by+"px"}}else{return by}}}});if(!b.support.opacity){b.cssHooks.opacity={get:function(bw,e){return at.test((e&&bw.currentStyle?bw.currentStyle.filter:bw.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":e?"1":""},set:function(bz,bA){var by=bz.style,bw=bz.currentStyle;by.zoom=1;var e=b.isNaN(bA)?"":"alpha(opacity="+bA*100+")",bx=bw&&bw.filter||by.filter||"";by.filter=ak.test(bx)?bx.replace(ak,e):bx+" "+e}}}b(function(){if(!b.support.reliableMarginRight){b.cssHooks.marginRight={get:function(bx,bw){var e;b.swap(bx,{display:"inline-block"},function(){if(bw){e=Z(bx,"margin-right","marginRight")}else{e=bx.style.marginRight}});return e}}}});if(au.defaultView&&au.defaultView.getComputedStyle){aH=function(bz,bx){var bw,by,e;bx=bx.replace(C,"-$1").toLowerCase();if(!(by=bz.ownerDocument.defaultView)){return N}if((e=by.getComputedStyle(bz,null))){bw=e.getPropertyValue(bx);if(bw===""&&!b.contains(bz.ownerDocument.documentElement,bz)){bw=b.style(bz,bx)}}return bw}}if(au.documentElement.currentStyle){aV=function(bz,bx){var bA,bw=bz.currentStyle&&bz.currentStyle[bx],e=bz.runtimeStyle&&bz.runtimeStyle[bx],by=bz.style;if(!bd.test(bw)&&bp.test(bw)){bA=by.left;if(e){bz.runtimeStyle.left=bz.currentStyle.left}by.left=bx==="fontSize"?"1em":(bw||0);bw=by.pixelLeft+"px";by.left=bA;if(e){bz.runtimeStyle.left=e}}return bw===""?"auto":bw}}Z=aH||aV;function p(bx,bw,e){var bz=bw==="width"?bx.offsetWidth:bx.offsetHeight,by=bw==="width"?am:a1;if(bz>0){if(e!=="border"){b.each(by,function(){if(!e){bz-=parseFloat(b.css(bx,"padding"+this))||0}if(e==="margin"){bz+=parseFloat(b.css(bx,e+this))||0}else{bz-=parseFloat(b.css(bx,"border"+this+"Width"))||0}})}return bz+"px"}bz=Z(bx,bw,bw);if(bz<0||bz==null){bz=bx.style[bw]||0}bz=parseFloat(bz)||0;if(e){b.each(by,function(){bz+=parseFloat(b.css(bx,"padding"+this))||0;if(e!=="padding"){bz+=parseFloat(b.css(bx,"border"+this+"Width"))||0}if(e==="margin"){bz+=parseFloat(b.css(bx,e+this))||0}})}return bz+"px"}if(b.expr&&b.expr.filters){b.expr.filters.hidden=function(bx){var bw=bx.offsetWidth,e=bx.offsetHeight;return(bw===0&&e===0)||(!b.support.reliableHiddenOffsets&&(bx.style.display||b.css(bx,"display"))==="none")};b.expr.filters.visible=function(e){return !b.expr.filters.hidden(e)}}var k=/%20/g,ao=/\[\]$/,bu=/\r?\n/g,bs=/#.*$/,aC=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,aY=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aL=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,aO=/^(?:GET|HEAD)$/,c=/^\/\//,O=/\?/,a6=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=/^(?:select|textarea)/i,h=/\s+/,bt=/([?&])_=[^&]*/,M=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,D=b.fn.load,aa={},t={},aD,u;try{aD=bm.href}catch(av){aD=au.createElement("a");aD.href="";aD=aD.href}u=M.exec(aD.toLowerCase())||[];function f(e){return function(bz,bB){if(typeof bz!=="string"){bB=bz;bz="*"}if(b.isFunction(bB)){var by=bz.toLowerCase().split(h),bx=0,bA=by.length,bw,bC,bD;for(;bx<bA;bx++){bw=by[bx];bD=/^\+/.test(bw);if(bD){bw=bw.substr(1)||"*"}bC=e[bw]=e[bw]||[];bC[bD?"unshift":"push"](bB)}}}}function aT(bw,bF,bA,bE,bC,by){bC=bC||bF.dataTypes[0];by=by||{};by[bC]=true;var bB=bw[bC],bx=0,e=bB?bB.length:0,bz=(bw===aa),bD;for(;bx<e&&(bz||!bD);bx++){bD=bB[bx](bF,bA,bE);if(typeof bD==="string"){if(!bz||by[bD]){bD=N}else{bF.dataTypes.unshift(bD);bD=aT(bw,bF,bA,bE,bD,by)}}}if((bz||!bD)&&!by["*"]){bD=aT(bw,bF,bA,bE,"*",by)}return bD}b.fn.extend({load:function(bx,bA,bB){if(typeof bx!=="string"&&D){return D.apply(this,arguments)}else{if(!this.length){return this}}var bz=bx.indexOf(" ");if(bz>=0){var e=bx.slice(bz,bx.length);bx=bx.slice(0,bz)}var by="GET";if(bA){if(b.isFunction(bA)){bB=bA;bA=N}else{if(typeof bA==="object"){bA=b.param(bA,b.ajaxSettings.traditional);by="POST"}}}var bw=this;b.ajax({url:bx,type:by,dataType:"html",data:bA,complete:function(bD,bC,bE){bE=bD.responseText;if(bD.isResolved()){bD.done(function(bF){bE=bF});bw.html(e?b("<div>").append(bE.replace(a6,"")).find(e):bE)}if(bB){bw.each(bB,[bE,bC,bD])}}});return this},serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?b.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||s.test(this.nodeName)||aY.test(this.type))}).map(function(e,bw){var bx=b(this).val();return bx==null?null:b.isArray(bx)?b.map(bx,function(bz,by){return{name:bw.name,value:bz.replace(bu,"\r\n")}}):{name:bw.name,value:bx.replace(bu,"\r\n")}}).get()}});b.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,bw){b.fn[bw]=function(bx){return this.bind(bw,bx)}});b.each(["get","post"],function(e,bw){b[bw]=function(bx,bz,bA,by){if(b.isFunction(bz)){by=by||bA;bA=bz;bz=N}return b.ajax({type:bw,url:bx,data:bz,success:bA,dataType:by})}});b.extend({getScript:function(e,bw){return b.get(e,N,bw,"script")},getJSON:function(e,bw,bx){return b.get(e,bw,bx,"json")},ajaxSetup:function(bx,e){if(!e){e=bx;bx=b.extend(true,b.ajaxSettings,e)}else{b.extend(true,bx,b.ajaxSettings,e)}for(var bw in {context:1,url:1}){if(bw in e){bx[bw]=e[bw]}else{if(bw in b.ajaxSettings){bx[bw]=b.ajaxSettings[bw]}}}return bx},ajaxSettings:{url:aD,isLocal:aL.test(u[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":bc.String,"text html":true,"text json":b.parseJSON,"text xml":b.parseXML}},ajaxPrefilter:f(aa),ajaxTransport:f(t),ajax:function(bA,by){if(typeof bA==="object"){by=bA;bA=N}by=by||{};var bE=b.ajaxSetup({},by),bT=bE.context||bE,bH=bT!==bE&&(bT.nodeType||bT instanceof b)?b(bT):b.event,bS=b.Deferred(),bO=b._Deferred(),bC=bE.statusCode||{},bD,bI={},bP={},bR,bz,bM,bF,bJ,bB=0,bx,bL,bK={readyState:0,setRequestHeader:function(bU,bV){if(!bB){var e=bU.toLowerCase();bU=bP[e]=bP[e]||bU;bI[bU]=bV}return this},getAllResponseHeaders:function(){return bB===2?bR:null},getResponseHeader:function(bU){var e;if(bB===2){if(!bz){bz={};while((e=aC.exec(bR))){bz[e[1].toLowerCase()]=e[2]}}e=bz[bU.toLowerCase()]}return e===N?null:e},overrideMimeType:function(e){if(!bB){bE.mimeType=e}return this},abort:function(e){e=e||"abort";if(bM){bM.abort(e)}bG(0,e);return this}};function bG(bZ,bX,b0,bW){if(bB===2){return}bB=2;if(bF){clearTimeout(bF)}bM=N;bR=bW||"";bK.readyState=bZ?4:0;var bU,b4,b3,bY=b0?bk(bE,bK,b0):N,bV,b2;if(bZ>=200&&bZ<300||bZ===304){if(bE.ifModified){if((bV=bK.getResponseHeader("Last-Modified"))){b.lastModified[bD]=bV}if((b2=bK.getResponseHeader("Etag"))){b.etag[bD]=b2}}if(bZ===304){bX="notmodified";bU=true}else{try{b4=I(bE,bY);bX="success";bU=true}catch(b1){bX="parsererror";b3=b1}}}else{b3=bX;if(!bX||bZ){bX="error";if(bZ<0){bZ=0}}}bK.status=bZ;bK.statusText=bX;if(bU){bS.resolveWith(bT,[b4,bX,bK])}else{bS.rejectWith(bT,[bK,bX,b3])}bK.statusCode(bC);bC=N;if(bx){bH.trigger("ajax"+(bU?"Success":"Error"),[bK,bE,bU?b4:b3])}bO.resolveWith(bT,[bK,bX]);if(bx){bH.trigger("ajaxComplete",[bK,bE]);if(!(--b.active)){b.event.trigger("ajaxStop")}}}bS.promise(bK);bK.success=bK.done;bK.error=bK.fail;bK.complete=bO.done;bK.statusCode=function(bU){if(bU){var e;if(bB<2){for(e in bU){bC[e]=[bC[e],bU[e]]}}else{e=bU[bK.status];bK.then(e,e)}}return this};bE.url=((bA||bE.url)+"").replace(bs,"").replace(c,u[1]+"//");bE.dataTypes=b.trim(bE.dataType||"*").toLowerCase().split(h);if(bE.crossDomain==null){bJ=M.exec(bE.url.toLowerCase());bE.crossDomain=!!(bJ&&(bJ[1]!=u[1]||bJ[2]!=u[2]||(bJ[3]||(bJ[1]==="http:"?80:443))!=(u[3]||(u[1]==="http:"?80:443))))}if(bE.data&&bE.processData&&typeof bE.data!=="string"){bE.data=b.param(bE.data,bE.traditional)}aT(aa,bE,by,bK);if(bB===2){return false}bx=bE.global;bE.type=bE.type.toUpperCase();bE.hasContent=!aO.test(bE.type);if(bx&&b.active++===0){b.event.trigger("ajaxStart")}if(!bE.hasContent){if(bE.data){bE.url+=(O.test(bE.url)?"&":"?")+bE.data}bD=bE.url;if(bE.cache===false){var bw=b.now(),bQ=bE.url.replace(bt,"$1_="+bw);bE.url=bQ+((bQ===bE.url)?(O.test(bE.url)?"&":"?")+"_="+bw:"")}}if(bE.data&&bE.hasContent&&bE.contentType!==false||by.contentType){bK.setRequestHeader("Content-Type",bE.contentType)}if(bE.ifModified){bD=bD||bE.url;if(b.lastModified[bD]){bK.setRequestHeader("If-Modified-Since",b.lastModified[bD])}if(b.etag[bD]){bK.setRequestHeader("If-None-Match",b.etag[bD])}}bK.setRequestHeader("Accept",bE.dataTypes[0]&&bE.accepts[bE.dataTypes[0]]?bE.accepts[bE.dataTypes[0]]+(bE.dataTypes[0]!=="*"?", */*; q=0.01":""):bE.accepts["*"]);for(bL in bE.headers){bK.setRequestHeader(bL,bE.headers[bL])}if(bE.beforeSend&&(bE.beforeSend.call(bT,bK,bE)===false||bB===2)){bK.abort();return false}for(bL in {success:1,error:1,complete:1}){bK[bL](bE[bL])}bM=aT(t,bE,by,bK);if(!bM){bG(-1,"No Transport")}else{bK.readyState=1;if(bx){bH.trigger("ajaxSend",[bK,bE])}if(bE.async&&bE.timeout>0){bF=setTimeout(function(){bK.abort("timeout")},bE.timeout)}try{bB=1;bM.send(bI,bG)}catch(bN){if(status<2){bG(-1,bN)}else{b.error(bN)}}}return bK},param:function(e,bx){var bw=[],bz=function(bA,bB){bB=b.isFunction(bB)?bB():bB;bw[bw.length]=encodeURIComponent(bA)+"="+encodeURIComponent(bB)};if(bx===N){bx=b.ajaxSettings.traditional}if(b.isArray(e)||(e.jquery&&!b.isPlainObject(e))){b.each(e,function(){bz(this.name,this.value)})}else{for(var by in e){x(by,e[by],bx,bz)}}return bw.join("&").replace(k,"+")}});function x(bx,bz,bw,by){if(b.isArray(bz)){b.each(bz,function(bB,bA){if(bw||ao.test(bx)){by(bx,bA)}else{x(bx+"["+(typeof bA==="object"||b.isArray(bA)?bB:"")+"]",bA,bw,by)}})}else{if(!bw&&bz!=null&&typeof bz==="object"){for(var e in bz){x(bx+"["+e+"]",bz[e],bw,by)}}else{by(bx,bz)}}}b.extend({active:0,lastModified:{},etag:{}});function bk(bE,bD,bA){var bw=bE.contents,bC=bE.dataTypes,bx=bE.responseFields,bz,bB,by,e;for(bB in bx){if(bB in bA){bD[bx[bB]]=bA[bB]}}while(bC[0]==="*"){bC.shift();if(bz===N){bz=bE.mimeType||bD.getResponseHeader("content-type")}}if(bz){for(bB in bw){if(bw[bB]&&bw[bB].test(bz)){bC.unshift(bB);break}}}if(bC[0] in bA){by=bC[0]}else{for(bB in bA){if(!bC[0]||bE.converters[bB+" "+bC[0]]){by=bB;break}if(!e){e=bB}}by=by||e}if(by){if(by!==bC[0]){bC.unshift(by)}return bA[by]}}function I(bI,bA){if(bI.dataFilter){bA=bI.dataFilter(bA,bI.dataType)}var bE=bI.dataTypes,bH={},bB,bF,bx=bE.length,bC,bD=bE[0],by,bz,bG,bw,e;for(bB=1;bB<bx;bB++){if(bB===1){for(bF in bI.converters){if(typeof bF==="string"){bH[bF.toLowerCase()]=bI.converters[bF]}}}by=bD;bD=bE[bB];if(bD==="*"){bD=by}else{if(by!=="*"&&by!==bD){bz=by+" "+bD;bG=bH[bz]||bH["* "+bD];if(!bG){e=N;for(bw in bH){bC=bw.split(" ");if(bC[0]===by||bC[0]==="*"){e=bH[bC[1]+" "+bD];if(e){bw=bH[bw];if(bw===true){bG=e}else{if(e===true){bG=bw}}break}}}}if(!(bG||e)){b.error("No conversion from "+bz.replace(" "," to "))}if(bG!==true){bA=bG?bG(bA):e(bw(bA))}}}}return bA}var aB=b.now(),w=/(\=)\?(&|$)|\?\?/i;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return b.expando+"_"+(aB++)}});b.ajaxPrefilter("json jsonp",function(bE,bB,bD){var by=bE.contentType==="application/x-www-form-urlencoded"&&(typeof bE.data==="string");if(bE.dataTypes[0]==="jsonp"||bE.jsonp!==false&&(w.test(bE.url)||by&&w.test(bE.data))){var bC,bx=bE.jsonpCallback=b.isFunction(bE.jsonpCallback)?bE.jsonpCallback():bE.jsonpCallback,bA=bc[bx],e=bE.url,bz=bE.data,bw="$1"+bx+"$2";if(bE.jsonp!==false){e=e.replace(w,bw);if(bE.url===e){if(by){bz=bz.replace(w,bw)}if(bE.data===bz){e+=(/\?/.test(e)?"&":"?")+bE.jsonp+"="+bx}}}bE.url=e;bE.data=bz;bc[bx]=function(bF){bC=[bF]};bD.always(function(){bc[bx]=bA;if(bC&&b.isFunction(bA)){bc[bx](bC[0])}});bE.converters["script json"]=function(){if(!bC){b.error(bx+" was not called")}return bC[0]};bE.dataTypes[0]="json";return"script"}});b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){b.globalEval(e);return e}}});b.ajaxPrefilter("script",function(e){if(e.cache===N){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});b.ajaxTransport("script",function(bx){if(bx.crossDomain){var e,bw=au.head||au.getElementsByTagName("head")[0]||au.documentElement;return{send:function(by,bz){e=au.createElement("script");e.async="async";if(bx.scriptCharset){e.charset=bx.scriptCharset}e.src=bx.url;e.onload=e.onreadystatechange=function(bB,bA){if(bA||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;if(bw&&e.parentNode){bw.removeChild(e)}e=N;if(!bA){bz(200,"success")}}};bw.insertBefore(e,bw.firstChild)},abort:function(){if(e){e.onload(0,1)}}}}});var E=bc.ActiveXObject?function(){for(var e in P){P[e](0,1)}}:false,B=0,P;function aK(){try{return new bc.XMLHttpRequest()}catch(bw){}}function ai(){try{return new bc.ActiveXObject("Microsoft.XMLHTTP")}catch(bw){}}b.ajaxSettings.xhr=bc.ActiveXObject?function(){return !this.isLocal&&aK()||ai()}:aK;(function(e){b.extend(b.support,{ajax:!!e,cors:!!e&&("withCredentials" in e)})})(b.ajaxSettings.xhr());if(b.support.ajax){b.ajaxTransport(function(e){if(!e.crossDomain||b.support.cors){var bw;return{send:function(bC,bx){var bB=e.xhr(),bA,bz;if(e.username){bB.open(e.type,e.url,e.async,e.username,e.password)}else{bB.open(e.type,e.url,e.async)}if(e.xhrFields){for(bz in e.xhrFields){bB[bz]=e.xhrFields[bz]}}if(e.mimeType&&bB.overrideMimeType){bB.overrideMimeType(e.mimeType)}if(!e.crossDomain&&!bC["X-Requested-With"]){bC["X-Requested-With"]="XMLHttpRequest"}try{for(bz in bC){bB.setRequestHeader(bz,bC[bz])}}catch(by){}bB.send((e.hasContent&&e.data)||null);bw=function(bL,bF){var bG,bE,bD,bJ,bI;try{if(bw&&(bF||bB.readyState===4)){bw=N;if(bA){bB.onreadystatechange=b.noop;if(E){delete P[bA]}}if(bF){if(bB.readyState!==4){bB.abort()}}else{bG=bB.status;bD=bB.getAllResponseHeaders();bJ={};bI=bB.responseXML;if(bI&&bI.documentElement){bJ.xml=bI}bJ.text=bB.responseText;try{bE=bB.statusText}catch(bK){bE=""}if(!bG&&e.isLocal&&!e.crossDomain){bG=bJ.text?200:404}else{if(bG===1223){bG=204}}}}}catch(bH){if(!bF){bx(-1,bH)}}if(bJ){bx(bG,bE,bJ,bD)}};if(!e.async||bB.readyState===4){bw()}else{bA=++B;if(E){if(!P){P={};b(bc).unload(E)}P[bA]=bw}bB.onreadystatechange=bw}},abort:function(){if(bw){bw(0,1)}}}}})}var T={},a9,n,aA=/^(?:toggle|show|hide)$/,aQ=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,a2,aG=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],a4,U=bc.webkitRequestAnimationFrame||bc.mozRequestAnimationFrame||bc.oRequestAnimationFrame;b.fn.extend({show:function(by,bB,bA){var bx,bz;if(by||by===0){return this.animate(a0("show",3),by,bB,bA)}else{for(var bw=0,e=this.length;bw<e;bw++){bx=this[bw];if(bx.style){bz=bx.style.display;if(!b._data(bx,"olddisplay")&&bz==="none"){bz=bx.style.display=""}if(bz===""&&b.css(bx,"display")==="none"){b._data(bx,"olddisplay",z(bx.nodeName))}}}for(bw=0;bw<e;bw++){bx=this[bw];if(bx.style){bz=bx.style.display;if(bz===""||bz==="none"){bx.style.display=b._data(bx,"olddisplay")||""}}}return this}},hide:function(bx,bA,bz){if(bx||bx===0){return this.animate(a0("hide",3),bx,bA,bz)}else{for(var bw=0,e=this.length;bw<e;bw++){if(this[bw].style){var by=b.css(this[bw],"display");if(by!=="none"&&!b._data(this[bw],"olddisplay")){b._data(this[bw],"olddisplay",by)}}}for(bw=0;bw<e;bw++){if(this[bw].style){this[bw].style.display="none"}}return this}},_toggle:b.fn.toggle,toggle:function(bx,bw,by){var e=typeof bx==="boolean";if(b.isFunction(bx)&&b.isFunction(bw)){this._toggle.apply(this,arguments)}else{if(bx==null||e){this.each(function(){var bz=e?bx:b(this).is(":hidden");b(this)[bz?"show":"hide"]()})}else{this.animate(a0("toggle",3),bx,bw,by)}}return this},fadeTo:function(e,by,bx,bw){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:by},e,bx,bw)},animate:function(bz,bw,by,bx){var e=b.speed(bw,by,bx);if(b.isEmptyObject(bz)){return this.each(e.complete,[false])}bz=b.extend({},bz);return this[e.queue===false?"each":"queue"](function(){if(e.queue===false){b._mark(this)}var bD=b.extend({},e),bK=this.nodeType===1,bH=bK&&b(this).is(":hidden"),bA,bE,bC,bJ,bI,bG,bB,bF,bL;bD.animatedProperties={};for(bC in bz){bA=b.camelCase(bC);if(bC!==bA){bz[bA]=bz[bC];delete bz[bC]}bE=bz[bA];if(b.isArray(bE)){bD.animatedProperties[bA]=bE[1];bE=bz[bA]=bE[0]}else{bD.animatedProperties[bA]=bD.specialEasing&&bD.specialEasing[bA]||bD.easing||"swing"}if(bE==="hide"&&bH||bE==="show"&&!bH){return bD.complete.call(this)}if(bK&&(bA==="height"||bA==="width")){bD.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(b.css(this,"display")==="inline"&&b.css(this,"float")==="none"){if(!b.support.inlineBlockNeedsLayout){this.style.display="inline-block"}else{bJ=z(this.nodeName);if(bJ==="inline"){this.style.display="inline-block"}else{this.style.display="inline";this.style.zoom=1}}}}}if(bD.overflow!=null){this.style.overflow="hidden"}for(bC in bz){bI=new b.fx(this,bD,bC);bE=bz[bC];if(aA.test(bE)){bI[bE==="toggle"?bH?"show":"hide":bE]()}else{bG=aQ.exec(bE);bB=bI.cur();if(bG){bF=parseFloat(bG[2]);bL=bG[3]||(b.cssNumber[bC]?"":"px");if(bL!=="px"){b.style(this,bC,(bF||1)+bL);bB=((bF||1)/bI.cur())*bB;b.style(this,bC,bB+bL)}if(bG[1]){bF=((bG[1]==="-="?-1:1)*bF)+bB}bI.custom(bB,bF,bL)}else{bI.custom(bB,bE,"")}}}return true})},stop:function(bw,e){if(bw){this.queue([])}this.each(function(){var by=b.timers,bx=by.length;if(!e){b._unmark(true,this)}while(bx--){if(by[bx].elem===this){if(e){by[bx](true)}by.splice(bx,1)}}});if(!e){this.dequeue()}return this}});function bh(){setTimeout(ar,0);return(a4=b.now())}function ar(){a4=N}function a0(bw,e){var bx={};b.each(aG.concat.apply([],aG.slice(0,e)),function(){bx[this]=bw});return bx}b.each({slideDown:a0("show",1),slideUp:a0("hide",1),slideToggle:a0("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,bw){b.fn[e]=function(bx,bz,by){return this.animate(bw,bx,bz,by)}});b.extend({speed:function(bx,by,bw){var e=bx&&typeof bx==="object"?b.extend({},bx):{complete:bw||!bw&&by||b.isFunction(bx)&&bx,duration:bx,easing:bw&&by||by&&!b.isFunction(by)&&by};e.duration=b.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in b.fx.speeds?b.fx.speeds[e.duration]:b.fx.speeds._default;e.old=e.complete;e.complete=function(bz){if(b.isFunction(e.old)){e.old.call(this)}if(e.queue!==false){b.dequeue(this)}else{if(bz!==false){b._unmark(this)}}};return e},easing:{linear:function(bx,by,e,bw){return e+bw*bx},swing:function(bx,by,e,bw){return((-Math.cos(bx*Math.PI)/2)+0.5)*bw+e}},timers:[],fx:function(bw,e,bx){this.options=e;this.elem=bw;this.prop=bx;e.orig=e.orig||{}}});b.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(b.fx.step[this.prop]||b.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var e,bw=b.css(this.elem,this.prop);return isNaN(e=parseFloat(bw))?!bw||bw==="auto"?0:bw:e},custom:function(bB,bA,by){var e=this,bx=b.fx,bz;this.startTime=a4||bh();this.start=bB;this.end=bA;this.unit=by||this.unit||(b.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function bw(bC){return e.step(bC)}bw.elem=this.elem;if(bw()&&b.timers.push(bw)&&!a2){if(U){a2=true;bz=function(){if(a2){U(bz);bx.tick()}};U(bz)}else{a2=setInterval(bx.tick,bx.interval)}}},show:function(){this.options.orig[this.prop]=b.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());b(this.elem).show()},hide:function(){this.options.orig[this.prop]=b.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(bz){var by=a4||bh(),e=true,bA=this.elem,bw=this.options,bx,bC;if(bz||by>=bw.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();bw.animatedProperties[this.prop]=true;for(bx in bw.animatedProperties){if(bw.animatedProperties[bx]!==true){e=false}}if(e){if(bw.overflow!=null&&!b.support.shrinkWrapBlocks){b.each(["","X","Y"],function(bD,bE){bA.style["overflow"+bE]=bw.overflow[bD]})}if(bw.hide){b(bA).hide()}if(bw.hide||bw.show){for(var bB in bw.animatedProperties){b.style(bA,bB,bw.orig[bB])}}bw.complete.call(bA)}return false}else{if(bw.duration==Infinity){this.now=by}else{bC=by-this.startTime;this.state=bC/bw.duration;this.pos=b.easing[bw.animatedProperties[this.prop]](this.state,bC,0,1,bw.duration);this.now=this.start+((this.end-this.start)*this.pos)}this.update()}return true}};b.extend(b.fx,{tick:function(){for(var bw=b.timers,e=0;e<bw.length;++e){if(!bw[e]()){bw.splice(e--,1)}}if(!bw.length){b.fx.stop()}},interval:13,stop:function(){clearInterval(a2);a2=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){b.style(e.elem,"opacity",e.now)},_default:function(e){if(e.elem.style&&e.elem.style[e.prop]!=null){e.elem.style[e.prop]=(e.prop==="width"||e.prop==="height"?Math.max(0,e.now):e.now)+e.unit}else{e.elem[e.prop]=e.now}}}});if(b.expr&&b.expr.filters){b.expr.filters.animated=function(e){return b.grep(b.timers,function(bw){return e===bw.elem}).length}}function z(by){if(!T[by]){var e=au.body,bw=b("<"+by+">").appendTo(e),bx=bw.css("display");bw.remove();if(bx==="none"||bx===""){if(!a9){a9=au.createElement("iframe");a9.frameBorder=a9.width=a9.height=0}e.appendChild(a9);if(!n||!a9.createElement){n=(a9.contentWindow||a9.contentDocument).document;n.write((au.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");n.close()}bw=n.createElement(by);n.body.appendChild(bw);bx=b.css(bw,"display");e.removeChild(a9)}T[by]=bx}return T[by]}var X=/^t(?:able|d|h)$/i,ad=/^(?:body|html)$/i;if("getBoundingClientRect" in au.documentElement){b.fn.offset=function(bJ){var bz=this[0],bC;if(bJ){return this.each(function(e){b.offset.setOffset(this,bJ,e)})}if(!bz||!bz.ownerDocument){return null}if(bz===bz.ownerDocument.body){return b.offset.bodyOffset(bz)}try{bC=bz.getBoundingClientRect()}catch(bG){}var bI=bz.ownerDocument,bx=bI.documentElement;if(!bC||!b.contains(bx,bz)){return bC?{top:bC.top,left:bC.left}:{top:0,left:0}}var bD=bI.body,bE=aJ(bI),bB=bx.clientTop||bD.clientTop||0,bF=bx.clientLeft||bD.clientLeft||0,bw=bE.pageYOffset||b.support.boxModel&&bx.scrollTop||bD.scrollTop,bA=bE.pageXOffset||b.support.boxModel&&bx.scrollLeft||bD.scrollLeft,bH=bC.top+bw-bB,by=bC.left+bA-bF;return{top:bH,left:by}}}else{b.fn.offset=function(bG){var bA=this[0];if(bG){return this.each(function(bH){b.offset.setOffset(this,bG,bH)})}if(!bA||!bA.ownerDocument){return null}if(bA===bA.ownerDocument.body){return b.offset.bodyOffset(bA)}b.offset.initialize();var bD,bx=bA.offsetParent,bw=bA,bF=bA.ownerDocument,by=bF.documentElement,bB=bF.body,bC=bF.defaultView,e=bC?bC.getComputedStyle(bA,null):bA.currentStyle,bE=bA.offsetTop,bz=bA.offsetLeft;while((bA=bA.parentNode)&&bA!==bB&&bA!==by){if(b.offset.supportsFixedPosition&&e.position==="fixed"){break}bD=bC?bC.getComputedStyle(bA,null):bA.currentStyle;bE-=bA.scrollTop;bz-=bA.scrollLeft;if(bA===bx){bE+=bA.offsetTop;bz+=bA.offsetLeft;if(b.offset.doesNotAddBorder&&!(b.offset.doesAddBorderForTableAndCells&&X.test(bA.nodeName))){bE+=parseFloat(bD.borderTopWidth)||0;bz+=parseFloat(bD.borderLeftWidth)||0}bw=bx;bx=bA.offsetParent}if(b.offset.subtractsBorderForOverflowNotVisible&&bD.overflow!=="visible"){bE+=parseFloat(bD.borderTopWidth)||0;bz+=parseFloat(bD.borderLeftWidth)||0}e=bD}if(e.position==="relative"||e.position==="static"){bE+=bB.offsetTop;bz+=bB.offsetLeft}if(b.offset.supportsFixedPosition&&e.position==="fixed"){bE+=Math.max(by.scrollTop,bB.scrollTop);bz+=Math.max(by.scrollLeft,bB.scrollLeft)}return{top:bE,left:bz}}}b.offset={initialize:function(){var e=au.body,bw=au.createElement("div"),bz,bB,bA,bC,bx=parseFloat(b.css(e,"marginTop"))||0,by="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";b.extend(bw.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});bw.innerHTML=by;e.insertBefore(bw,e.firstChild);bz=bw.firstChild;bB=bz.firstChild;bC=bz.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(bB.offsetTop!==5);this.doesAddBorderForTableAndCells=(bC.offsetTop===5);bB.style.position="fixed";bB.style.top="20px";this.supportsFixedPosition=(bB.offsetTop===20||bB.offsetTop===15);bB.style.position=bB.style.top="";bz.style.overflow="hidden";bz.style.position="relative";this.subtractsBorderForOverflowNotVisible=(bB.offsetTop===-5);this.doesNotIncludeMarginInBodyOffset=(e.offsetTop!==bx);e.removeChild(bw);b.offset.initialize=b.noop},bodyOffset:function(e){var bx=e.offsetTop,bw=e.offsetLeft;b.offset.initialize();if(b.offset.doesNotIncludeMarginInBodyOffset){bx+=parseFloat(b.css(e,"marginTop"))||0;bw+=parseFloat(b.css(e,"marginLeft"))||0}return{top:bx,left:bw}},setOffset:function(by,bH,bB){var bC=b.css(by,"position");if(bC==="static"){by.style.position="relative"}var bA=b(by),bw=bA.offset(),e=b.css(by,"top"),bF=b.css(by,"left"),bG=(bC==="absolute"||bC==="fixed")&&b.inArray("auto",[e,bF])>-1,bE={},bD={},bx,bz;if(bG){bD=bA.position();bx=bD.top;bz=bD.left}else{bx=parseFloat(e)||0;bz=parseFloat(bF)||0}if(b.isFunction(bH)){bH=bH.call(by,bB,bw)}if(bH.top!=null){bE.top=(bH.top-bw.top)+bx}if(bH.left!=null){bE.left=(bH.left-bw.left)+bz}if("using" in bH){bH.using.call(by,bE)}else{bA.css(bE)}}};b.fn.extend({position:function(){if(!this[0]){return null}var bx=this[0],bw=this.offsetParent(),by=this.offset(),e=ad.test(bw[0].nodeName)?{top:0,left:0}:bw.offset();by.top-=parseFloat(b.css(bx,"marginTop"))||0;by.left-=parseFloat(b.css(bx,"marginLeft"))||0;e.top+=parseFloat(b.css(bw[0],"borderTopWidth"))||0;e.left+=parseFloat(b.css(bw[0],"borderLeftWidth"))||0;return{top:by.top-e.top,left:by.left-e.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||au.body;while(e&&(!ad.test(e.nodeName)&&b.css(e,"position")==="static")){e=e.offsetParent}return e})}});b.each(["Left","Top"],function(bw,e){var bx="scroll"+e;b.fn[bx]=function(bA){var by,bz;if(bA===N){by=this[0];if(!by){return null}bz=aJ(by);return bz?("pageXOffset" in bz)?bz[bw?"pageYOffset":"pageXOffset"]:b.support.boxModel&&bz.document.documentElement[bx]||bz.document.body[bx]:by[bx]}return this.each(function(){bz=aJ(this);if(bz){bz.scrollTo(!bw?bA:b(bz).scrollLeft(),bw?bA:b(bz).scrollTop())}else{this[bx]=bA}})}});function aJ(e){return b.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false}b.each(["Height","Width"],function(bw,e){var bx=e.toLowerCase();b.fn["inner"+e]=function(){var by=this[0];return by&&by.style?parseFloat(b.css(by,bx,"padding")):null};b.fn["outer"+e]=function(bz){var by=this[0];return by&&by.style?parseFloat(b.css(by,bx,bz?"margin":"border")):null};b.fn[bx]=function(bz){var bA=this[0];if(!bA){return bz==null?null:this}if(b.isFunction(bz)){return this.each(function(bE){var bD=b(this);bD[bx](bz.call(this,bE,bD[bx]()))})}if(b.isWindow(bA)){var bB=bA.document.documentElement["client"+e];return bA.document.compatMode==="CSS1Compat"&&bB||bA.document.body["client"+e]||bB}else{if(bA.nodeType===9){return Math.max(bA.documentElement["client"+e],bA.body["scroll"+e],bA.documentElement["scroll"+e],bA.body["offset"+e],bA.documentElement["offset"+e])}else{if(bz===N){var bC=b.css(bA,bx),by=parseFloat(bC);return b.isNaN(by)?bC:by}else{return this.css(bx,typeof bz==="string"?bz:bz+"px")}}}}});bc.jQuery=bc.$=b})(window);jQuery.Buffer=function(){var b=function(c){if(c){this.assign(c)}this._bufferedCommandList=[];this._bufferedCommands={}};b._buffers=[];b._pool=[];b.bufferForElement=function(c){if(c._jquery_buffer){return c._jquery_buffer}return this.bufferFromPool().assign(c)};b.bufferFromPool=function(){var c=null;if(this._pool.length===0){c=new b()}else{c=this._pool.pop()}b._buffers.push(c);if(!this.flushingScheduled){this.scheduleFlushing()}return c};b.returnToPool=function(c){c.unassign();this._pool.push(c)};b.scheduleFlushing=function(){this.flushingScheduled=true};b.flush=function(){var e=this._buffers,d,c=e.length;for(d=0;d<c;d++){e[d].flush();this.returnToPool(e[d])}this._buffers=[];this.flushingScheduled=false};b.prototype.assign=function(c){if(this._el){this.unassign()}this._el=c;this._el._jquery_buffer=this;return this};b.prototype.unassign=function(){if(!this._el){return}this._el._jquery_buffer=undefined;this._el=undefined;return this};b.prototype.flush=function(){var f=this._bufferedCommandList,e=f.length,d,g;for(d=0;d<e;d++){g=f[d];this[g](this._bufferedCommands[g]);delete this._bufferedCommands[g]}this._bufferedCommandList.length=0;this.unassign()};b.prototype.$=function(c,d){if(!d){d=this._el}if(c===""||c===undefined){c=d;d=undefined}return jQuery(c,d)};b.prototype.bufferedCommand=function(c){if(!this._bufferedCommands[c]){this._bufferedCommands[c]={};this._bufferedCommandList.push(c)}return this._bufferedCommands[c]};b.prototype.hasBufferedCommand=function(c){return !!this._bufferedCommands[c]};b.prototype.html=function(d){var c=this.bufferedCommand("flushContent");if(d===undefined){return c.text||c.html||this.$().html()}c.text=undefined;c.html=d};b.prototype.text=function(d){var c=this.bufferedCommand("flushContent");if(d===undefined){return c.text||c.html||this.$().text()}c.text=d;c.html=undefined};b.prototype.flushContent=function(c){if(c.text!==undefined){this.$().text(c.text)}else{if(c.html!==undefined){this.$().html(c.html)}}};b.prototype.attr=function(f,g){if(typeof f==="object"){for(var d in f){this.attr(d,f[d])}return}if(f==="class"){if(g===undefined){return this.setClass().join(" ")}else{if(typeof g==="string"||jQuery.isArray(g)){var c=this.bufferedCommand("flushClassNames");c.classNames=this._hashFromClassNames(g);return}else{return this.setClass(g)}}}else{if(f==="html"){return this.html(g)}else{if(f==="text"){return this.text(g)}else{if(f==="style"){return this.resetStyles(g)}}}}var e=this.bufferedCommand("flushAttributes");if(!e.attr){e.attr={}}e.attr[f]=g};b.prototype.flushAttributes=function(f){var c=f.attr,g=this.$(),d;for(var e in c){if(!c.hasOwnProperty(e)){continue}d=c[e];if(d!==null){g.attr(e,d)}else{g.removeAttr(e)}}};b.prototype._STYLE_REGEX=/-?\s*([^:\s]+)\s*:\s*([^;]+)\s*;?/g;b.prototype._camelizeStyleName=function(c){var d=c.match(/^-(webkit|moz|o)-/),e=c.camelize();if(d){return e.substr(0,1).toUpperCase()+e.substr(1)}else{return e}};b.prototype._dasherizeStyleName=function(c){var d=SC.String.dasherize(c);if(d.match(/^(webkit|moz|ms|o)-/)){d="-"+d}return d};b.prototype._loadStyles=function(c){if(!c){c=this.$().attr("style")}if(c&&(c=c.toString()).length>0){if(SC.browser.isIE){c=c.toLowerCase()}var f={};var e=this._STYLE_REGEX,d;e.lastIndex=0;while(d=e.exec(c)){f[this._camelizeStyleName(d[1])]=d[2]}return f}else{return{}}};b.prototype.resetStyles=function(d){var c=this.bufferedCommand("flushStyles");c._styles=this._loadStyles(d||" ")};b.prototype.styles=function(){var c=this.bufferedCommand("flushStyles");if(!c._styles){c._styles=this._loadStyles()}return c._styles};b.prototype.css=function(e,f){if(typeof e==="object"){for(var c in e){this.css(c,e[c])}return}var d=this.bufferedCommand("flushStyles");if(!d._styles){d._styles=this._loadStyles()}d._styles[e]=f};b.prototype.flushStyles=function(e){var g=e._styles;var j="";var d,h,f=[],c=0;for(d in g){if(!g.hasOwnProperty(d)){continue}h=g[d];if(h===null){continue}if(typeof h==="number"&&d!=="zIndex"&&d!=="fontWeight"&&d!=="opacity"){h+="px"}f[c++]=this._dasherizeStyleName(d)+": "+h}this.$().attr("style",f.join("; "))};b.prototype._hashFromClassNames=function(f){if(typeof f==="string"){f=f.split(" ")}var d,c=f.length,e={};for(d=0;d<c;d++){e[f[d]]=true}return e};b.prototype.setClass=function(g,c){var f=this.bufferedCommand("flushClassNames"),e;if(g===undefined){if(!f.classNames){f.classNames=this._hashFromClassNames(this._el.className)}var h=f.classNames,d=[];for(e in h){if(e&&h[e]){d.push(e)}}return d}if(typeof g==="object"){if(!f.classNames){f.classNames=this._hashFromClassNames(this._el.className)}for(e in g){f.classNames[e]=g[e]}return}if(!f.classNames){f.classNames=this._hashFromClassNames(this._el.className)}f.classNames[g]=c||false};b.prototype.hasClass=function(d){var c=this.bufferedCommand("flushClassNames");if(!c.classNames){c.classNames=this._hashFromClassNames(this._el.className)}return !!c.classNames[d]};b.prototype.addClass=function(f){if(!f){return}var e=this.bufferedCommand("flushClassNames");if(!e.classNames){e.classNames=this._hashFromClassNames(this._el.className)}if(typeof f==="string"){f=f.split(" ")}var d,c=f.length;for(d=0;d<c;d++){e.classNames[jQuery.trim(f[d])]=true}};b.prototype.removeClass=function(d){var c=this.bufferedCommand("flushClassNames");if(d===undefined){c.classNames={}}else{if(!c.classNames){c.classNames=this._hashFromClassNames(this._el.className)}c.classNames[d]=false}};b.prototype.resetClassNames=function(d){var c=this.bufferedCommand("flushClassNames");c.classNames={}};b.prototype.flushClassNames=function(e){var f=[];var g=e.classNames,d;for(d in g){if(g[d]){f.push(d)}}this.$().attr("class",f.join(" "))};function a(d){for(var c in d){if(typeof d[c]==="function"){d[c].displayName=c}}}a(b);a(b.prototype);return b}();(function(){jQuery.buffer=jQuery.bufferedJQuery=jQuery.sub();jQuery.bufferedJQuery.fn.extend({html:function(d){if(d===undefined){if(this.length<1){return undefined}return jQuery.Buffer.bufferForElement(this[0]).html()}var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.html(d)}return this},text:function(d){if(d===undefined){if(this.length<1){return undefined}return jQuery.Buffer.bufferForElement(this[0]).text()}var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.text(d)}return this},attr:function(d,e){var b;if(typeof e==="undefined"&&typeof d==="string"){if(this.length<1){return false}b=jQuery.Buffer.bufferForElement(this[0]);return b.attr(d)}var a=this.length,c;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.attr(d,e)}return this},hasClass:function(a){if(this.length<1){return false}return jQuery.Buffer.bufferForElement(this[0]).hasClass(a)},setClass:function(e,c){var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.setClass(e,c)}return this},addClass:function(d){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.addClass(d)}return this},removeClass:function(d){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.removeClass(d)}return this},resetClassNames:function(){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.resetClassNames()}return this},css:function(d,e){var a=this.length,c,b;for(c=0;c<a;c++){b=jQuery.Buffer.bufferForElement(this[c]);b.css(d,e)}return this},styles:function(){if(this.length<1){return null}return jQuery.Buffer.bufferForElement(this[0]).styles()},resetStyles:function(){if(this.length<1){return null}jQuery.Buffer.bufferForElement(this[0]).resetStyles();return this}})})();jQuery.Buffer._flush=function(){jQuery.Buffer.flush()};jQuery.Buffer.scheduleFlushing=function(){SC.RunLoop.currentRunLoop.invokeOnce(jQuery.Buffer._flush);this.flushingScheduled=true};if(!window.require){window.require=function require(){}}if(!window.sc_require){window.sc_require=require}if(!window.sc_resource){window.sc_resource=function sc_resource(){}}sc_require("license");window.YES=true;window.NO=false;if(typeof console==="undefined"){window.console={};console.log=console.info=console.warn=console.error=function(){}}window.SC=window.SC||{};window.SproutCore=window.SproutCore||SC;SC=window.SC;SC.VERSION="1.9.2";SC._baseMixin=function(c){var f=Array.prototype.slice.call(arguments,1),a,e=f[0]||{},g=1,d=f.length,j,b,h;if(d===1){e=this||{};g=0}for(;g<d;g++){if(!(j=f[g])){continue}for(h in j){if(!j.hasOwnProperty(h)){continue}b=j[h];if(e===b){continue}if(b!==undefined&&(c||(e[h]===undefined))){e[h]=b}}if(j.hasOwnProperty("toString")){e.toString=j.toString}}return e};SC.mixin=function(){var a=Array.prototype.slice.call(arguments);a.unshift(true);return SC._baseMixin.apply(this,a)};SC.supplement=function(){var a=Array.prototype.slice.call(arguments);a.unshift(false);return SC._baseMixin.apply(this,a)};SC.extend=SC.mixin;SC.mixin({T_ERROR:"error",T_OBJECT:"object",T_NULL:"null",T_CLASS:"class",T_HASH:"hash",T_FUNCTION:"function",T_UNDEFINED:"undefined",T_NUMBER:"number",T_BOOL:"boolean",T_ARRAY:"array",T_STRING:"string",T_DATE:"date",T_REGEXP:"regexp",typeOf:function(a){if(a===undefined){return SC.T_UNDEFINED}if(a===null){return SC.T_NULL}var b=jQuery.type(a);if(b==="function"){return a.isClass?SC.T_CLASS:SC.T_FUNCTION}else{if(b==="object"){if(SC.Error&&(a instanceof SC.Error)){return SC.T_ERROR}else{if(a instanceof SC.Object){return SC.T_OBJECT}else{return SC.T_HASH}}}}return b},none:function(a){return a==null},empty:function(a){return a===null||a===undefined||a===""},isArray:function(a){if(!a||a.setInterval){return false}if(Array.isArray&&Array.isArray(a)){return true}if(a.objectAt){return true}if(a.length!==undefined&&jQuery.type(a)==="object"){return true}return false},makeArray:function(a){return SC.isArray(a)?a:SC.A(a)},A:function(c){if(c===null||c===undefined){return[]}if(c.slice instanceof Function){if(typeof(c)==="string"){return[c]}else{return c.slice()}}if(c.toArray){return c.toArray()}if(!SC.isArray(c)){return[c]}var b=[],a=c.length;while(--a>=0){b[a]=c[a]}return b},guidKey:"SproutCore"+(SC.VERSION+Math.random()).replace(/\D/g,""),_guidPrefixes:{number:"nu",string:"st"},_guidCaches:{number:{},string:{}},_numberGuids:[],_stringGuids:{},_keyCache:{},guidFor:function(e){var b,c,d=typeof e;if(e===undefined){return"(undefined)"}if(e===null){return"(null)"}if(d===SC.T_NUMBER||d===SC.T_STRING){b=this._guidCaches[d];c=b[e];if(!c){c="st"+(jQuery.uuid++);b[e]=c}return c}else{if(d===SC.T_BOOL){return(e)?"(true)":"(false)"}}var a=this.guidKey;if(e[a]){return e[a]}if(e===Object){return"(Object)"}if(e===Array){return"(Array)"}return SC.generateGuid(e,"sc")},keyFor:function(d,c){var b,a=this._keyCache[d];if(!a){a=this._keyCache[d]={}}b=a[c];if(!b){b=a[c]=d+"_"+c}return b},generateGuid:function(c,b){var a=(b+(jQuery.uuid++));if(c){c[this.guidKey]=a}return a},hashFor:function(){var a=arguments.length,c="",e,d,b;for(b=0;b<a;++b){e=arguments[b];c+=(e&&(d=e.hash)&&(typeof d===SC.T_FUNCTION))?d.call(e):this.guidFor(e)}return c===""?null:c},isEqual:function(d,c){return this.hashFor(d)===this.hashFor(c)},compare:function(s,p){if(s===p){return 0}var j=SC.typeOf(s);var g=SC.typeOf(p);var b=SC.ORDER_DEFINITION_MAPPING;if(!b){var d=SC.ORDER_DEFINITION;b=SC.ORDER_DEFINITION_MAPPING={};var q,n;for(q=0,n=d.length;q<n;++q){b[d[q]]=q}delete SC.ORDER_DEFINITION}var t=b[j];var c=b[g];if(t<c){return -1}if(t>c){return 1}switch(j){case SC.T_BOOL:case SC.T_NUMBER:case SC.T_DATE:if(s<p){return -1}if(s>p){return 1}return 0;case SC.T_STRING:var k=s.localeCompare(p);if(k<0){return -1}if(k>0){return 1}return 0;case SC.T_ARRAY:var o=s.length;var m=p.length;var e=Math.min(o,m);var a=0;var h=0;var f=arguments.callee;while(a===0&&h<e){a=f(s[h],p[h]);h++}if(a!==0){return a}if(o<m){return -1}if(o>m){return 1}return 0;case SC.T_OBJECT:if(s.constructor.isComparable===YES){return s.constructor.compare(s,p)}return 0;default:return 0}},K:function(){return this},EMPTY_ARRAY:[],EMPTY_HASH:{},EMPTY_RANGE:{start:0,length:0},beget:function(c){if(c===null||c===undefined){return null}var a=SC.K;a.prototype=c;var b=new a();a.prototype=null;if(typeof c.didBeget==="function"){b=c.didBeget(b)}return b},copy:function(d,b){var c=d,a;if(d){if(d.isCopyable){return d.copy(b)}if(d.clone){return d.clone()}}switch(jQuery.type(d)){case"array":c=d.slice();if(b){a=c.length;while(a--){c[a]=SC.copy(c[a],true)}}break;case"object":c={};for(var e in d){c[e]=b?SC.copy(d[e],true):d[e]}}return c},merge:function(){var c={},b=arguments.length,a;for(a=0;a<b;a++){SC.mixin(c,arguments[a])}return c},keys:function(c){var a=[];for(var b in c){a.push(b)}return a},inspect:function(d){var a,b=[];for(var c in d){a=d[c];if(a==="toString"){continue}if(SC.typeOf(a)===SC.T_FUNCTION){a="function() { ... }"}b.push(c+": "+a)}return"{"+b.join(" , ")+"}"},tupleForPropertyPath:function(e,a){if(typeof e==="object"&&(e instanceof Array)){return e}var c;var b=e.indexOf("*");if(b<0){b=e.lastIndexOf(".")}c=(b>=0)?e.slice(b+1):e;var d=this.objectForPropertyPath(e,a,b);return(d&&c)?[d,c]:null},objectForPropertyPath:function(f,c,d){var g,b,e,a;if(!c){c=window}if(SC.typeOf(f)===SC.T_STRING){if(d===undefined){d=f.length}g=0;while((c)&&(g<d)){b=f.indexOf(".",g);if((b<0)||(b>d)){b=d}e=f.slice(g,b);c=c.get?c.get(e):c[e];g=b+1}if(g<d){c=undefined}}else{g=0;a=f.length;e=null;while((g<a)&&c){e=f[g++];if(e){c=(c.get)?c.get(e):c[e]}}if(g<a){c=undefined}}return c},requiredObjectForPropertyPath:function(c,a,b){var d=SC.objectForPropertyPath(c,a,b);if(!d){throw c+" could not be found"}return d}});SC.clone=SC.copy;SC.$A=SC.A;SC.didLoad=SC.K;SC.ORDER_DEFINITION=[SC.T_ERROR,SC.T_UNDEFINED,SC.T_NULL,SC.T_BOOL,SC.T_NUMBER,SC.T_STRING,SC.T_ARRAY,SC.T_HASH,SC.T_OBJECT,SC.T_FUNCTION,SC.T_CLASS];SC.Function={property:function(b,c){b.dependentKeys=SC.$A(c);var a=SC.guidFor(b);b.cacheKey="__cache__"+a;b.lastSetValueKey="__lastValue__"+a;b.isProperty=true;return b},cacheable:function(a,b){a.isProperty=true;if(!a.dependentKeys){a.dependentKeys=[]}a.isCacheable=(b===undefined)?true:b;return a},idempotent:function(a,b){a.isProperty=true;if(!a.dependentKeys){this.dependentKeys=[]}a.isVolatile=(b===undefined)?true:b;return a},enhance:function(a){a.isEnhancement=true;return a},observes:function(c,a){var f=a.length,b=null,e=null;while(--f>=0){var d=a[f];if((d.indexOf(".")<0)&&(d.indexOf("*")<0)){if(!b){b=c.localPropertyPaths=[]}b.push(d)}else{if(!e){e=c.propertyPaths=[]}e.push(d)}}return c}};sc_require("system/function");SC.mixin(Function.prototype,{property:function(){return SC.Function.property(this,arguments)},cacheable:function(a){return SC.Function.cacheable(this,a)},idempotent:function(a){return SC.Function.idempotent(this,a)},enhance:function(){return SC.Function.enhance(this)},observes:function(a){return SC.Function.observes(this,arguments)}});SC.ObserverSet={add:function(k,a,c){var b=SC.guidFor(k),f=SC.guidFor(a),j=this._members,d=this.members,g=j[b],h,e;if(!g){g=j[b]={}}h=g[f];if(h===undefined){g[f]=d.length;e=[k,a,c];d.push(e)}else{}},remove:function(g,h){var e=SC.guidFor(g),b=SC.guidFor(h);var d=this._members[e],a=this.members;if(!d){return false}var c=d[b];if(c===undefined){return false}if(c!==a.length-1){var f=(a[c]=a[a.length-1]);this._members[SC.guidFor(f[0])][SC.guidFor(f[1])]=c}a.pop();delete this._members[e][b];return true},invokeMethods:function(){var b=this.members,d;for(var c=0,a=b.length;c<a;c++){d=b[c];d[1].call(d[0])}},clone:function(){var c=SC.ObserverSet.create(),d=this.members;c._members=SC.clone(this._members);var e=c.members;for(var b=0,a=d.length;b<a;b++){e[b]=SC.clone(d[b]);e[b].length=3}return c},create:function(){return new SC.ObserverSet.constructor()},getMembers:function(){return this.members.slice(0)},constructor:function(){this._members={};this.members=[]}};SC.ObserverSet.constructor.prototype=SC.ObserverSet;SC.ObserverSet.slice=SC.ObserverSet.clone;SC.ObserverSet.copy=SC.ObserverSet.clone;SC._ChainObserver=function(b,a){this.property=b;this.root=a||this};SC._ChainObserver.createChain=function(f,m,g,a,b){var d=m.split("."),j=new SC._ChainObserver(d[0]),h=j;for(var e=1,c=d.length;e<c;e++){h=h.next=new SC._ChainObserver(d[e],j)}var k=j.tails=[h];j.objectDidChange(f);k.forEach(function(l){l.target=g;l.method=a;l.context=b});j.tails=null;return j};SC._ChainObserver.prototype={isChainObserver:true,object:null,property:null,next:null,root:null,target:null,method:null,tail:function(){if(this._tail){return this._tail}var a=this;while(a.next){a=a.next}this._tail=a;return a},objectDidChange:function(a){if(a===this.object){return}if(this.object){if(this.property==="@each"&&this.object._removeContentObserver){this.object._removeContentObserver(this)}else{if(this.object.removeObserver){this.object.removeObserver(this.property,this,this.propertyDidChange)}}}this.object=a;if(this.property==="@each"&&this.next){if(this.object&&this.object._addContentObserver){this.object._addContentObserver(this)}}else{if(this.object&&this.object.addObserver){this.object.addObserver(this.property,this,this.propertyDidChange)}this.propertyDidChange()}},propertyDidChange:function(){var b=this.object;var e=this.property;var d=(b&&b.get)?b.get(e):null;if(this.next){this.next.objectDidChange(d)}var f=this.target,g=this.method,c=this.context;if(f&&g){var a=b?b.propertyRevision:null;if(c){g.call(f,b,e,d,c,a)}else{g.call(f,b,e,d,a)}}},destroyChain:function(){var a=this.object;if(a){if(this.property==="@each"&&this.next&&a._removeContentObserver){a._removeContentObserver(this)}if(a.removeObserver){a.removeObserver(this.property,this,this.propertyDidChange)}}if(this.next){this.next.destroyChain()}this.next=this.target=this.method=this.object=this.context=null;return null}};sc_require("ext/function");sc_require("private/observer_set");sc_require("private/chain_observer");SC.LOG_OBSERVERS=NO;SC.OBSERVES_HANDLER_ADD=0;SC.OBSERVES_HANDLER_REMOVE=1;SC.Observable={isObservable:YES,automaticallyNotifiesObserversFor:function(a){return YES},get:function(c){var b=this[c],a;if(b===undefined){return this.unknownProperty(c)}else{if(b&&b.isProperty){if(b.isCacheable){a=this._kvo_cache;if(!a){a=this._kvo_cache={}}return(a[b.cacheKey]!==undefined)?a[b.cacheKey]:(a[b.cacheKey]=b.call(this,c))}else{return b.call(this,c)}}else{return b}}},set:function(j,g){var b=this[j],k=this.automaticallyNotifiesObserversFor(j),f=g,d,a,h,e;if(g===undefined&&SC.typeOf(j)===SC.T_HASH){var c=j;for(j in c){if(!c.hasOwnProperty(j)){continue}this.set(j,c[j])}return this}if(!k&&this._kvo_cacheable&&(a=this._kvo_cache)){d=this._kvo_cachedep;if(!d||(d=d[j])===undefined){d=this._kvo_computeCachedDependentsFor(j)}if(d){h=d.length;while(--h>=0){e=d[h];a[e.cacheKey]=a[e.lastSetValueKey]=undefined}}}if(b&&b.isProperty){a=this._kvo_cache;if(b.isVolatile||!a||(a[b.lastSetValueKey]!==g)){if(!a){a=this._kvo_cache={}}a[b.lastSetValueKey]=g;if(k){this.propertyWillChange(j)}f=b.call(this,j,g);if(b.isCacheable){a[b.cacheKey]=f}if(k){this.propertyDidChange(j,f,YES)}}}else{if(b===undefined){if(k){this.propertyWillChange(j)}this.unknownProperty(j,g);if(k){this.propertyDidChange(j,f)}}else{if(this[j]!==g){if(k){this.propertyWillChange(j)}f=this[j]=g;if(k){this.propertyDidChange(j,f)}}}}return this},unknownProperty:function(a,b){if(!(b===undefined)){this[a]=b}return b},beginPropertyChanges:function(){this._kvo_changeLevel=(this._kvo_changeLevel||0)+1;return this},endPropertyChanges:function(){this._kvo_changeLevel=(this._kvo_changeLevel||1)-1;var b=this._kvo_changeLevel,a=this._kvo_changes;if((b<=0)&&a&&(a.length>0)&&!SC.Observers.isObservingSuspended){this._notifyPropertyObservers()}return this},propertyWillChange:function(a){return this},propertyDidChange:function(o,m,c){this._kvo_revision=(this._kvo_revision||0)+1;var b=this._kvo_changeLevel||0,h,n,j,d,f=SC.LOG_OBSERVERS&&(this.LOG_OBSERVING!==NO);var k=this._kvo_property_chains;if(k){var g=k[o];if(g){this.beginPropertyChanges();g=SC.clone(g);g.forEach(function(p){p.notifyPropertyDidChange()});this.endPropertyChanges()}}var a=this._kvo_cache;if(a){if(!c){d=this[o];if(d&&d.isProperty){a[d.cacheKey]=a[d.lastSetValueKey]=undefined}}if(this._kvo_cacheable){h=this._kvo_cachedep;if(!h||(h=h[o])===undefined){h=this._kvo_computeCachedDependentsFor(o)}if(h){n=h.length;while(--n>=0){j=h[n];a[j.cacheKey]=a[j.lastSetValueKey]=undefined}}}}var e=SC.Observers.isObservingSuspended;if((b>0)||e){var l=this._kvo_changes;if(!l){l=this._kvo_changes=SC.CoreSet.create()}l.add(o);if(e){if(f){SC.Logger.log("%@%@: will not notify observers because observing is suspended".fmt(SC.KVO_SPACES,this))}SC.Observers.objectHasPendingChanges(this)}}else{this._notifyPropertyObservers(o)}return this},registerDependentKey:function(h,c){var e=this._kvo_dependents,j=this._kvo_chain_dependents,b=this[h],k,g,a,f,d;if(typeof c==="object"&&(c instanceof Array)){k=c;a=0}else{k=arguments;a=1}g=k.length;if(!e){this._kvo_dependents=e={}}while(--g>=a){f=k[g];if(f.indexOf(".")>=0){SC._PropertyChain.createChain(f,this,h).activate()}else{d=e[f];if(!d){d=e[f]=[]}d.push(h)}}},registerDependentKeyWithChain:function(c,a){var d=this._chainsFor(c),b;d.add(a)},removeDependentKeyWithChain:function(c,a){var d=this._chainsFor(c),b;d.remove(a);if(d.get("length")===0){delete this._kvo_property_chains[c]}},_chainsFor:function(a){this._kvo_property_chains=this._kvo_property_chains||{};var b=this._kvo_property_chains[a]||SC.CoreSet.create();this._kvo_property_chains[a]=b;return b},_kvo_addCachedDependents:function(b,f,h,c){var a=f.length,e,d,g;while(--a>=0){d=f[a];c.add(d);e=this[d];if(e&&(e instanceof Function)&&e.isProperty){if(e.isCacheable){b.push(e)}if((g=h[d])&&g.length>0){this._kvo_addCachedDependents(b,g,h,c)}}}},_kvo_computeCachedDependentsFor:function(c){var d=this._kvo_cachedep,f=this._kvo_dependents,e=f?f[c]:null,a,b;if(!d){d=this._kvo_cachedep={}}if(!e||e.length===0){return d[c]=null}a=d[c]=[];b=SC._TMP_SEEN_SET=(SC._TMP_SEEN_SET||SC.CoreSet.create());b.add(c);this._kvo_addCachedDependents(a,e,f,b);b.clear();if(a.length===0){a=d[c]=null}return a},_kvo_for:function(c,b){var a=this[c];if(!this._kvo_cloned){this._kvo_cloned={}}if(!a){a=this[c]=(b===undefined)?[]:b.create();this._kvo_cloned[c]=YES}else{if(!this._kvo_cloned[c]){a=this[c]=a.copy();this._kvo_cloned[c]=YES}}return a},addObserver:function(c,f,h,b){var d,a,e,g;if(h===undefined){h=f;f=this}if(!f){f=this}if(typeof h==="string"){h=f[h]}if(!h){throw"You must pass a method to addObserver()"}c=c.toString();if(c.indexOf(".")>=0){a=SC._ChainObserver.createChain(this,c,f,h,b);a.masterTarget=f;a.masterMethod=h;this._kvo_for(SC.keyFor("_kvo_chains",c)).push(a)}else{if((this[c]===undefined)&&(c.indexOf("@")===0)){this.get(c)}if(f===this){f=null}d=SC.keyFor("_kvo_observers",c);this._kvo_for(d,SC.ObserverSet).add(f,h,b);this._kvo_for("_kvo_observed_keys",SC.CoreSet).add(c)}if(this.didAddObserver){this.didAddObserver(c,f,h)}return this},removeObserver:function(c,f,h){var d,e,b,g,a;if(h===undefined){h=f;f=this}if(!f){f=this}if(typeof h==="string"){h=f[h]}if(!h){throw"You must pass a method to removeObserver()"}c=c.toString();if(c.indexOf(".")>=0){d=SC.keyFor("_kvo_chains",c);if(e=this[d]){e=this._kvo_for(d);a=e.length;while(--a>=0){b=e[a];if(b&&(b.masterTarget===f)&&(b.masterMethod===h)){e[a]=b.destroyChain()}}}}else{if(f===this){f=null}d=SC.keyFor("_kvo_observers",c);if(g=this[d]){g=this._kvo_for(d);g.remove(f,h);if(g.getMembers().length===0){this._kvo_for("_kvo_observed_keys",SC.CoreSet).remove(c)}}}if(this.didRemoveObserver){this.didRemoveObserver(c,f,h)}return this},hasObserverFor:function(b){SC.Observers.flush(this);var d=this[SC.keyFor("_kvo_observers",b)],c=this[SC.keyFor("_kvo_local",b)],a;if(c&&c.length>0){return YES}if(d&&d.getMembers().length>0){return YES}return NO},initObservable:function(){if(this._observableInited){return}this._observableInited=YES;var f,n,l,k,h,e,m,g,c,o,b,j,d,a;if(n=this._observers){g=n.length;for(f=0;f<g;f++){l=n[f];h=this[l];e=h.propertyPaths;m=(e)?e.length:0;for(c=0;c<m;c++){o=e[c];this.addObservesHandler(h,o)}}}this.bindings=[];if(n=this._bindings){for(f=0,a=n.length;f<a;f++){l=n[f];k=this[l];d=l.slice(0,-7);this[l]=this.bind(d,k)}}if(n=this._properties){for(f=0,a=n.length;f<a;f++){l=n[f];if(k=this[l]){if(k.isCacheable){this._kvo_cacheable=YES}if(k.dependentKeys&&(k.dependentKeys.length>0)){this.registerDependentKey(l,k.dependentKeys)}}}}delete this._observers;delete this._bindings;delete this._properties},addObservesHandler:function(a,b){this._configureObservesHandler(SC.OBSERVES_HANDLER_ADD,a,b);return this},removeObservesHandler:function(a,b){this._configureObservesHandler(SC.OBSERVES_HANDLER_REMOVE,a,b);return this},_configureObservesHandler:function(d,b,e){var c,a;switch(d){case SC.OBSERVES_HANDLER_ADD:d="addObserver";break;case SC.OBSERVES_HANDLER_REMOVE:d="removeObserver";break;default:throw"invalid action provided: "+d}c=e.indexOf(".");if(c<0){this[d](e,this,b)}else{if(e.indexOf("*")===0){this[d](e.slice(1),this,b)}else{a=null;if(c===0){a=this;e=e.slice(1)}else{if(c===4&&e.slice(0,5)==="this."){a=this;e=e.slice(5)}else{if(c<0&&e.length===4&&e==="this"){a=this;e=""}else{if(c>0&&e[0]===e.charAt(0).toLowerCase()){a=this}}}}SC.Observers[d](e,this,b,a)}}},observersForKey:function(a){SC.Observers.flush(this);var b=this[SC.keyFor("_kvo_observers",a)];return b?b.getMembers():[]},_notifyPropertyObservers:function(v){if(!this._observableInited){this.initObservable()}SC.Observers.flush(this);var g=SC.LOG_OBSERVERS&&!(this.LOG_OBSERVING===NO),p,t,n,d,o,m,s,q,k,a,f,u,c,j,e,b,h,l;if(g){h=SC.KVO_SPACES=(SC.KVO_SPACES||"")+"  ";SC.Logger.log('%@%@: notifying observers after change to key "%@"'.fmt(h,this,v))}d=this["_kvo_observers_*"];this._kvo_changeLevel=(this._kvo_changeLevel||0)+1;while(((t=this._kvo_changes)&&(t.length>0))||v){s=++this.propertyRevision;if(!t){t=SC.CoreSet.create()}this._kvo_changes=null;if(v==="*"){t.add("*");t.addEach(this._kvo_for("_kvo_observed_keys",SC.CoreSet))}else{if(v){t.add(v)}}if(n=this._kvo_dependents){for(o=0;o<t.length;o++){v=t[o];m=n[v];if(m&&(j=m.length)){if(g){SC.Logger.log("%@...including dependent keys for %@: %@".fmt(h,v,m))}l=this._kvo_cache;if(!l){l=this._kvo_cache={}}while(--j>=0){t.add(v=m[j]);if(e=this[v]){this[e.cacheKey]=undefined;l[e.cacheKey]=l[e.lastSetValueKey]=undefined}}}}}while(t.length>0){v=t.pop();p=this[SC.keyFor("_kvo_observers",v)];if(p){q=SC.clone(p.getMembers());k=q.length;for(f=0;f<k;f++){a=q[f];if(a[3]===s){continue}if(!a[1]){SC.Logger.log(a)}u=a[0]||this;c=a[1];b=a[2];a[3]=s;if(g){SC.Logger.log('%@...firing observer on %@ for key "%@"'.fmt(h,u,v))}if(b!==undefined){c.call(u,this,v,null,b,s)}else{c.call(u,this,v,null,s)}}}q=this[SC.keyFor("_kvo_local",v)];if(q){k=q.length;for(f=0;f<k;f++){a=q[f];c=this[a];if(c){if(g){SC.Logger.log('%@...firing local observer %@.%@ for key "%@"'.fmt(h,this,a,v))}c.call(this,this,v,null,s)}}}if(d&&v!=="*"){q=SC.clone(d.getMembers());k=q.length;for(f=0;f<k;f++){a=q[f];u=a[0]||this;c=a[1];b=a[2];if(g){SC.Logger.log('%@...firing * observer on %@ for key "%@"'.fmt(h,u,v))}if(b!==undefined){c.call(u,this,v,null,b,s)}else{c.call(u,this,v,null,s)}}}if(this.propertyObserver){if(g){SC.Logger.log('%@...firing %@.propertyObserver for key "%@"'.fmt(h,this,v))}this.propertyObserver(this,v,null,s)}}if(t){t.destroy()}v=null}this._kvo_changeLevel=(this._kvo_changeLevel||1)-1;if(g){SC.KVO_SPACES=h.slice(0,-2)}return YES},bind:function(a,c,e){var d,b;if(e!==undefined){c=[c,e]}b=typeof c;if(b==="string"||(b==="object"&&(c instanceof Array))){d=this[a+"BindingDefault"]||SC.Binding;d=d.beget().from(c)}else{d=c.beget()}d=d.to(a,this).connect();this.bindings.push(d);return d},didChangeFor:function(a){var b,f,e,k,d,c,h,j,g;a=SC.hashFor(a);b=this._kvo_didChange_valueCache;if(!b){b=this._kvo_didChange_valueCache={}}f=this._kvo_didChange_revisionCache;if(!f){f=this._kvo_didChange_revisionCache={}}e=b[a]||{};k=f[a]||{};d=false;c=this._kvo_revision||0;h=arguments.length;while(--h>=1){j=arguments[h];if(k[j]!=c){g=this.get(j);if(e[j]!==g){d=true;e[j]=g}}k[j]=c}b[a]=e;f[a]=k;return d},setIfChanged:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){var c=a;for(a in c){if(!c.hasOwnProperty(a)){continue}this.setIfChanged(a,c[a])}return this}return(this.get(a)!==b)?this.set(a,b):this},getPath:function(b){var a=SC.tupleForPropertyPath(b,this);if(a===null||a[0]===null){return undefined}return SC.get(a[0],a[1])},setPath:function(c,b){if(c.indexOf(".")>=0){var a=SC.tupleForPropertyPath(c,this);if(!a||!a[0]){return null}a[0].set(a[1],b)}else{this.set(c,b)}return this},setPathIfChanged:function(c,b){if(c.indexOf(".")>=0){var a=SC.tupleForPropertyPath(c,this);if(!a||!a[0]){return null}if(a[0].get(a[1])!==b){a[0].set(a[1],b)}}else{this.setIfChanged(c,b)}return this},getEach:function(){var d=SC.A(arguments),c=[],a,b;for(a=0,b=d.length;a<b;a++){c[c.length]=this.getPath(d[a])}return c},incrementProperty:function(b,a){if(!a){a=1}this.set(b,(this.get(b)||0)+a);return this.get(b)},decrementProperty:function(b,a){if(!a){a=1}this.set(b,(this.get(b)||0)-a);return this.get(b)},toggleProperty:function(a,b,c){if(b===undefined){b=true}if(c===undefined){c=false}b=(this.get(a)==b)?c:b;this.set(a,b);return this.get(a)},notifyPropertyChange:function(a,b){this.propertyWillChange(a);this.propertyDidChange(a,b);return this},allPropertiesDidChange:function(){this._kvo_cache=null;this._notifyPropertyObservers("*");return this},addProbe:function(a){this.addObserver(a,SC.logChange)},removeProbe:function(a){this.removeObserver(a,SC.logChange)},logProperty:function(){var b=SC.$A(arguments),d,c,a;for(a=0,c=b.length;a<c;a++){d=b[a];SC.Logger.log("%@:%@: ".fmt(SC.guidFor(this),d),this.get(d))}},propertyRevision:1};SC.logChange=function logChange(c,a,b){SC.Logger.log("CHANGE: %@[%@] => %@".fmt(c,a,c.get(a)))};SC.mixin(SC,{get:function(a,b){if(!a){return undefined}if(b===undefined){return this[a]}if(a.get){return a.get(b)}return a[b]},getPath:function(a,b){if(b===undefined){b=a;a=window}return SC.objectForPropertyPath(b,a)}});SC.mixin(Array.prototype,SC.Observable);SC.Enumerator=function(a){this.enumerable=a;this.reset();return this};SC.Enumerator.prototype={nextObject:function(){var c=this._index;var a=this._length;if(c>=a){return undefined}var b=this.enumerable.nextObject(c,this._previousObject,this._context);this._previousObject=b;this._index=c+1;if(c>=a){this._context=SC.Enumerator._pushContext(this._context)}return b},reset:function(){var b=this.enumerable;if(!b){throw SC.$error("Enumerator has been destroyed")}this._length=b.get?b.get("length"):b.length;var a=this._length;this._index=0;this._previousObject=null;this._context=(a>0)?SC.Enumerator._popContext():null},destroy:function(){this.enumerable=this._length=this._index=this._previousObject=this._context=null}};SC.Enumerator.create=function(a){return new SC.Enumerator(a)};SC.Enumerator._popContext=function(){var a=this._contextCache?this._contextCache.pop():null;return a||{}};SC.Enumerator._pushContext=function(b){this._contextCache=this._contextCache||[];var a=this._contextCache;a.push(b);return null};sc_require("core");sc_require("ext/function");sc_require("system/enumerator");SC.Enumerable={isEnumerable:YES,nextObject:function(a,c,b){return this.objectAt?this.objectAt(a):this[a]},firstObject:function(){if(this.get("length")===0){return undefined}if(this.objectAt){return this.objectAt(0)}var b=SC.Enumerator._popContext(),a;a=this.nextObject(0,null,b);b=SC.Enumerator._pushContext(b);return a}.property().cacheable(),lastObject:function(){var a=this.get("length");if(a===0){return undefined}if(this.objectAt){return this.objectAt(a-1)}}.property().cacheable(),enumerator:function(){return SC.Enumerator.create(this)},forEach:function(g,f){if(typeof g!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(f===undefined){f=null}var e=null;var c=SC.Enumerator._popContext();for(var a=0;a<b;a++){var d=this.nextObject(a,e,c);g.call(f,d,a,this);e=d}e=null;c=SC.Enumerator._pushContext(c);return this},getEach:function(a){return this.map(function(b){return b?(b.get?b.get(a):b[a]):null},this)},setEach:function(a,b){this.forEach(function(c){if(c){if(c.set){c.set(a,b)}else{c[a]=b}}},this);return this},map:function(h,g){if(typeof h!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(g===undefined){g=null}var c=[];var f=null;var d=SC.Enumerator._popContext();for(var a=0;a<b;a++){var e=this.nextObject(a,f,d);c[a]=h.call(g,e,a,this);f=e}f=null;d=SC.Enumerator._pushContext(d);return c},mapProperty:function(a){return this.map(function(b){return b?(b.get?b.get(a):b[a]):null})},filter:function(h,g){if(typeof h!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(g===undefined){g=null}var c=[];var f=null;var d=SC.Enumerator._popContext();for(var a=0;a<b;a++){var e=this.nextObject(a,f,d);if(h.call(g,e,a,this)){c.push(e)}f=e}f=null;d=SC.Enumerator._pushContext(d);return c},sortProperty:function(b){var c=(typeof b===SC.T_STRING)?arguments:b,a=c.length,d;if(this instanceof Array){d=this}else{d=[];this.forEach(function(e){d.push(e)})}if(!d){return[]}return d.sort(function(g,f){var e,j,l,k,h=0;for(e=0;h===0&&e<a;e++){j=c[e];l=g?(g.get?g.get(j):g[j]):null;k=f?(f.get?f.get(j):f[j]):null;h=SC.compare(l,k)}return h})},filterProperty:function(k,f){var d=this.get?this.get("length"):this.length;var e=[];var j=null;var b=SC.Enumerator._popContext();for(var g=0;g<d;g++){var c=this.nextObject(g,j,b);var h=c?(c.get?c.get(k):c[k]):null;var a=(f===undefined)?!!h:SC.isEqual(h,f);if(a){e.push(c)}j=c}j=null;b=SC.Enumerator._pushContext(b);return e},find:function(h,d){var c=this.get?this.get("length"):this.length;if(d===undefined){d=null}var g=null,b,j=NO,e=null;var a=SC.Enumerator._popContext();for(var f=0;f<c&&!j;f++){b=this.nextObject(f,g,a);if(j=h.call(d,b,f,this)){e=b}g=b}b=g=null;a=SC.Enumerator._pushContext(a);return e},findProperty:function(j,f){var c=this.get?this.get("length"):this.length;var k=NO,d=null,h=null,b,g;var a=SC.Enumerator._popContext();for(var e=0;e<c&&!k;e++){b=this.nextObject(e,h,a);g=b?(b.get?b.get(j):b[j]):null;k=(f===undefined)?!!g:SC.isEqual(g,f);if(k){d=b}h=b}h=b=null;a=SC.Enumerator._pushContext(a);return d},every:function(h,g){if(typeof h!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(g===undefined){g=null}var c=YES;var f=null;var d=SC.Enumerator._popContext();for(var a=0;c&&(a<b);a++){var e=this.nextObject(a,f,d);if(!h.call(g,e,a,this)){c=NO}f=e}f=null;d=SC.Enumerator._pushContext(d);return c},everyProperty:function(j,e){var c=this.get?this.get("length"):this.length;var d=YES;var h=null;var a=SC.Enumerator._popContext();for(var f=0;d&&(f<c);f++){var b=this.nextObject(f,h,a);var g=b?(b.get?b.get(j):b[j]):null;d=(e===undefined)?!!g:SC.isEqual(g,e);h=b}h=null;a=SC.Enumerator._pushContext(a);return d},some:function(h,g){if(typeof h!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(g===undefined){g=null}var c=NO;var f=null;var d=SC.Enumerator._popContext();for(var a=0;(!c)&&(a<b);a++){var e=this.nextObject(a,f,d);if(h.call(g,e,a,this)){c=YES}f=e}f=null;d=SC.Enumerator._pushContext(d);return c},someProperty:function(j,e){var c=this.get?this.get("length"):this.length;var d=NO;var h=null;var a=SC.Enumerator._popContext();for(var f=0;!d&&(f<c);f++){var b=this.nextObject(f,h,a);var g=b?(b.get?b.get(j):b[j]):null;d=(e===undefined)?!!g:SC.isEqual(g,e);h=b}h=null;a=SC.Enumerator._pushContext(a);return d},reduce:function(g,h,j){if(typeof g!=="function"){throw new TypeError()}var c=this.get?this.get("length"):this.length;if(c===0&&h===undefined){throw new TypeError()}var d=h;var f=null;var a=SC.Enumerator._popContext();for(var e=0;e<c;e++){var b=this.nextObject(e,f,a);if(b!==null){if(d===undefined){d=b}else{d=g.call(null,d,b,e,this,j)}}f=b}f=null;a=SC.Enumerator._pushContext(a);if(d===undefined){throw new TypeError()}return d},invoke:function(h){var e=this.get?this.get("length"):this.length;if(e<=0){return[]}var j;var g=[];var c=arguments.length;if(c>1){for(j=1;j<c;j++){g.push(arguments[j])}}var f=[];var k=null;var b=SC.Enumerator._popContext();for(j=0;j<e;j++){var d=this.nextObject(j,k,b);var a=d?d[h]:null;if(a){f[j]=a.apply(d,g)}k=d}k=null;b=SC.Enumerator._pushContext(b);return f},invokeWhile:function(d,j){var f=this.get?this.get("length"):this.length;if(f<=0){return null}var k;var h=[];var c=arguments.length;if(c>2){for(k=2;k<c;k++){h.push(arguments[k])}}var g=d;var l=null;var b=SC.Enumerator._popContext();for(k=0;(g===d)&&(k<f);k++){var e=this.nextObject(k,l,b);var a=e?e[j]:null;if(a){g=a.apply(e,h)}l=e}l=null;b=SC.Enumerator._pushContext(b);return g},toArray:function(){var a=[];this.forEach(function(b){a.push(b)},this);return a},groupBy:function(j){var c=this.get?this.get("length"):this.length,d=[],h=null,a=SC.Enumerator._popContext(),e=[],k=[],f,b,g;for(f=0;f<c;f++){b=this.nextObject(f,h,a);g=b?(b.get?b.get(j):b[j]):null;if(SC.none(e[g])){e[g]=[];k.push(g)}e[g].push(b);h=b}h=null;a=SC.Enumerator._pushContext(a);for(f=0,c=k.length;f<c;f++){d.push(e[k[f]])}return d}};SC._buildReducerFor=function(a,b){return function(d,e){var f=this[a];if(SC.typeOf(f)!==SC.T_FUNCTION){return this.unknownProperty?this.unknownProperty(d,e):null}else{var c=SC.Enumerable.reduce.call(this,f,null,b);return c}}.property("[]")};SC.Reducers={"[]":function(a,b){return this}.property(),enumerableContentDidChange:function(c,a,b){if(!SC.none(c)){if(c===0){this.notifyPropertyChange("firstObject")}if(!SC.none(a)&&c+a===this.get("length")-1){this.notifyPropertyChange("lastObject")}}this.notifyPropertyChange("[]")},reducedProperty:function(j,g,f){if(!j||typeof j!==SC.T_STRING||j.charAt(0)!=="@"){return undefined}var d=j.match(/^@([^(]*)(\(([^)]*)\))?$/);if(!d||d.length<2){return undefined}var h=d[1];var k=d[3];h="reduce"+h.slice(0,1).toUpperCase()+h.slice(1);var a=this[h];if(SC.typeOf(a)!==SC.T_FUNCTION){return undefined}if(f===NO){return SC.Enumerable.reduce.call(this,a,null,k)}var c=SC._buildReducerFor(h,k);var b=this.constructor.prototype;if(b){b[j]=c;var e=b._properties||[];e.push(j);b._properties=e;this.registerDependentKey(j,"[]")}return SC.Enumerable.reduce.call(this,a,null,k)},reduceMax:function(a,d,b,f,c){if(c&&d){d=d.get?d.get(c):d[c]}if(a===null){return d}return(d>a)?d:a},reduceMaxObject:function(b,f,c,g,d){var a=b,h=f;if(d){if(f){h=f.get?f.get(d):f[d]}if(b){a=b.get?b.get(d):b[d]}}if(a===null){return f}return(h>a)?f:b},reduceMin:function(a,d,b,f,c){if(c&&d){d=d.get?d.get(c):d[c]}if(a===null){return d}return(d<a)?d:a},reduceMinObject:function(b,f,c,g,d){var a=b,h=f;if(d){if(f){h=f.get?f.get(d):f[d]}if(b){a=b.get?b.get(d):b[d]}}if(a===null){return f}return(h<a)?f:b},reduceAverage:function(b,g,d,h,f){if(f&&g){g=g.get?g.get(f):g[f]}var c=(b||0)+g;var a=h.get?h.get("length"):h.length;if(d>=a-1){c=c/a}return c},reduceSum:function(a,d,b,f,c){if(c&&d){d=d.get?d.get(c):d[c]}return(a===null)?d:a+d}};SC.mixin(SC.Enumerable,SC.Reducers);SC.mixin(Array.prototype,SC.Reducers);Array.prototype.isEnumerable=YES;(function(){var a={nextObject:SC.Enumerable.nextObject,enumerator:SC.Enumerable.enumerator,firstObject:SC.Enumerable.firstObject,lastObject:SC.Enumerable.lastObject,sortProperty:SC.Enumerable.sortProperty,mapProperty:function(g){var e=this.length;var f=[];for(var d=0;d<e;d++){var h=this[d];f[d]=h?(h.get?h.get(g):h[g]):null}return f},filterProperty:function(h,k){var f=this.length;var g=[];for(var e=0;e<f;e++){var j=this[e];var l=j?(j.get?j.get(h):j[h]):null;var d=(k===undefined)?!!l:SC.isEqual(l,k);if(d){g.push(j)}}return g},groupBy:function(h){var e=this.length,g=[],k=[],f=[],d,j,l;for(d=0;d<e;d++){j=this[d];l=j?(j.get?j.get(h):j[h]):null;if(SC.none(k[l])){k[l]=[];f.push(l)}k[l].push(j)}for(d=0,e=f.length;d<e;d++){g.push(k[f[d]])}return g},find:function(k,j){if(typeof k!=="function"){throw new TypeError()}var e=this.length;if(j===undefined){j=null}var g,f=null,h=NO;for(var d=0;d<e&&!h;d++){g=this[d];if(h=k.call(j,g,d,this)){f=g}}g=null;return f},findProperty:function(g,k){var e=this.length;var h,l,j=NO,f=null;for(var d=0;d<e&&!j;d++){l=(h=this[d])?(h.get?h.get(g):h[g]):null;j=(k===undefined)?!!l:SC.isEqual(l,k);if(j){f=h}}h=null;return f},everyProperty:function(g,j){var e=this.length;var f=YES;for(var d=0;f&&(d<e);d++){var h=this[d];var k=h?(h.get?h.get(g):h[g]):null;f=(j===undefined)?!!k:SC.isEqual(k,j)}return f},someProperty:function(g,j){var e=this.length;var f=NO;for(var d=0;!f&&(d<e);d++){var h=this[d];var k=h?(h.get?h.get(g):h[g]):null;f=(j===undefined)?!!k:SC.isEqual(k,j)}return f},invoke:function(f){var e=this.length;if(e<=0){return[]}var d;var h=[];var k=arguments.length;if(k>1){for(d=1;d<k;d++){h.push(arguments[d])}}var g=[];for(d=0;d<e;d++){var j=this[d];var l=j?j[f]:null;if(l){g[d]=l.apply(j,h)}}return g},invokeWhile:function(f,l){var h=this.length;if(h<=0){return null}var m;var k=[];var e=arguments.length;if(e>2){for(m=2;m<e;m++){k.push(arguments[m])}}var j=f;for(m=0;(j===f)&&(m<h);m++){var g=this[m];var d=g?g[l]:null;if(d){j=d.apply(g,k)}}return j},toArray:function(){var e=this.length;if(e<=0){return[]}var f=[];for(var d=0;d<e;d++){var g=this[d];f.push(g)}return f},getEach:function(g){var f=[];var e=this.length;for(var d=0;d<e;d++){var h=this[d];f[d]=h?(h.get?h.get(g):h[g]):null}return f},setEach:function(f,g){var e=this.length;for(var d=0;d<e;d++){var h=this[d];if(h){if(h.set){h.set(f,g)}else{h[f]=g}}}return this}};var c={forEach:function(h,g){if(typeof h!=="function"){throw new TypeError()}if(g===undefined){g=null}for(var e=0,d=this.length;e<d;e++){var f=this[e];h.call(g,f,e,this)}return this},map:function(j,h){if(typeof j!=="function"){throw new TypeError()}if(h===undefined){h=null}var e=[];for(var f=0,d=this.length;f<d;f++){var g=this[f];e[f]=j.call(h,g,f,this)}return e},filter:function(j,h){if(typeof j!=="function"){throw new TypeError()}if(h===undefined){h=null}var e=[];for(var f=0,d=this.length;f<d;f++){var g=this[f];if(j.call(h,g,f,this)){e.push(g)}}return e},every:function(j,h){if(typeof j!=="function"){throw new TypeError()}var e=this.length;if(h===undefined){h=null}var f=YES;for(var d=0;f&&(d<e);d++){var g=this[d];if(!j.call(h,g,d,this)){f=NO}}return f},some:function(j,h){if(typeof j!=="function"){throw new TypeError()}var e=this.length;if(h===undefined){h=null}var f=NO;for(var d=0;(!f)&&(d<e);d++){var g=this[d];if(j.call(h,g,d,this)){f=YES}}return f},reduce:function(k,f,j){if(typeof k!=="function"){throw new TypeError()}var e=this.length;if(e===0&&f===undefined){throw new TypeError()}var g=f;for(var d=0;d<e;d++){var h=this[d];if(h!==null){if(g===undefined){g=h}else{g=k.call(null,g,h,d,this,j)}}}if(g===undefined){throw new TypeError()}return g}};for(var b in c){if(!c.hasOwnProperty(b)){continue}if(!Array.prototype[b]||((typeof Prototype==="object")&&Prototype.Version.match(/^1\.6/))){Array.prototype[b]=c[b]}}SC.mixin(Array.prototype,a)})();SC.RangeObserver={isRangeObserver:YES,toString:function(){var a=this.indexes?this.indexes.toString():"SC.IndexSet<..>";return a.replace("IndexSet","RangeObserver(%@)".fmt(SC.guidFor(this)))},create:function(d,f,e,g,c,a){var b=SC.beget(this);b.source=d;b.indexes=f?f.frozenCopy():null;b.target=e;b.method=(typeof g==="string")?e[g]:g;b.context=c;b.isDeep=a||false;b.beginObserving();return b},extend:function(d){var c=SC.beget(this),b=arguments;for(var e=0,a=b.length;e<a;e++){SC.mixin(c,b[e])}return c},destroy:function(a){this.endObserving();return this},update:function(a,b){if(this.indexes&&this.indexes.isEqual(b)){return this}this.indexes=b?b.frozenCopy():null;this.endObserving().beginObserving();return this},beginObserving:function(){if(!this.isDeep){return this}var c=this.observing=this.observing||SC.CoreSet.create();var a=this._beginObservingForEach,b=this.source;if(!a){a=this._beginObservingForEach=function(d){var e=b.objectAt(d);if(e&&e.addObserver){c.push(e);e._kvo_needsRangeObserver=true}}}this.indexes.forEach(a);this.isObserving=false;SC.Observers.addPendingRangeObserver(this);return this},setupPending:function(b){var e=this.observing;if(this.isObserving||!e||(e.get("length")===0)){return true}if(e.contains(b)){this.isObserving=true;var c=this._setupPendingForEach;if(!c){var d=this.source,f=this.objectPropertyDidChange,a=this;c=this._setupPendingForEach=function(g){var k=d.objectAt(g),h=SC.guidFor(k),j;if(k&&k.addObserver){e.push(k);k.addObserver("*",a,f);j=a[h];if(j==null){a[h]=g}else{if(j.isIndexSet){j.add(g)}else{a[h]=SC.IndexSet.create(j).add(g)}}}}}this.indexes.forEach(c);return true}else{return false}},endObserving:function(){if(!this.isDeep){return this}var e=this.observing;if(this.isObserving){var b=this.objectPropertyDidChange,c=this.source,a,f,d;if(e){f=e.length;for(a=0;a<f;a++){d=e[a];d.removeObserver("*",this,b);this[SC.guidFor(d)]=null}e.length=0}this.isObserving=false}if(e){e.clear()}return this},rangeDidChange:function(b){var a=this.indexes;if(!b||!a||a.intersects(b)){this.endObserving();this.method.call(this.target,this.source,null,"[]",b,this.context);this.beginObserving()}return this},objectPropertyDidChange:function(d,f,g,a){var e=this.context,h=this.method,c=SC.guidFor(d),b=this[c];if(b&&!b.isIndexSet){b=this[c]=SC.IndexSet.create(b).freeze()}h.call(this.target,this.source,d,f,b,e||a,a)}};sc_require("ext/function");sc_require("mixins/observable");sc_require("mixins/enumerable");sc_require("system/range_observer");SC.OUT_OF_RANGE_EXCEPTION="Index out of range";SC.CoreArray={isSCArray:YES,replace:function(a,c,b){throw"replace() must be implemented to support SC.Array"},indexOf:function(d,c){var b,a=this.get("length");if(c===undefined){c=0}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b<a;b++){if(this.objectAt(b,YES)===d){return b}}return -1},lastIndexOf:function(d,c){var b,a=this.get("length");if(c===undefined){c=a-1}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b>=0;b--){if(this.objectAt(b)===d){return b}}return -1},objectAt:function(a){if(a<0){return undefined}if(a>=this.get("length")){return undefined}return this.get(a)},"[]":function(a,b){if(b!==undefined){this.replace(0,this.get("length"),b)}return this}.property(),insertAt:function(a,b){if(a>this.get("length")){throw SC.OUT_OF_RANGE_EXCEPTION}this.replace(a,0,[b]);return this},removeAt:function(d,a){var c=0,b=[];if(typeof d===SC.T_NUMBER){if((d<0)||(d>=this.get("length"))){throw SC.OUT_OF_RANGE_EXCEPTION}if(a===undefined){this.replace(d,1,b);return this}else{d=SC.IndexSet.create(d,a)}}this.beginPropertyChanges();d.forEachRange(function(f,e){f-=c;c+=e;this.replace(f,e,b)},this);this.endPropertyChanges();return this},removeObject:function(b){var c=this.get("length")||0;while(--c>=0){var a=this.objectAt(c);if(a==b){this.removeAt(c)}}return this},removeObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.removeObject(b)},this);this.endPropertyChanges();return this},slice:function(b,d){var a=[];var c=this.get("length");if(SC.none(b)){b=0}if(SC.none(d)||(d>c)){d=c}while(b<d){a[a.length]=this.objectAt(b++)}return a},pushObject:function(a){this.insertAt(this.get("length"),a);return a},pushObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.pushObject(b)},this);this.endPropertyChanges();return this},popObject:function(){var a=this.get("length");if(a===0){return null}var b=this.objectAt(a-1);this.removeAt(a-1);return b},shiftObject:function(){if(this.get("length")===0){return null}var a=this.objectAt(0);this.removeAt(0);return a},unshiftObject:function(a){this.insertAt(0,a);return a},unshiftObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.unshiftObject(b)},this);this.endPropertyChanges();return this},isEqual:function(a){if(!a){return false}if(a==this){return true}var b=a.get("length");if(b!=this.get("length")){return false}while(--b>=0){if(!SC.isEqual(a.objectAt(b),this.objectAt(b))){return false}}return true},compact:function(){return this.without(null)},without:function(b){if(this.indexOf(b)<0){return this}var a=[];this.forEach(function(c){if(c!==b){a[a.length]=c}});return a},uniq:function(){var a=[];this.forEach(function(b){if(a.indexOf(b)<0){a[a.length]=b}});return a},flatten:function(){var a=[];this.forEach(function(b){if(b&&b.isEnumerable){a=a.pushObjects(b.flatten())}else{a.pushObject(b)}});return a},max:function(){return Math.max.apply(Math,this)},min:function(){return Math.min.apply(Math,this)},rangeObserverClass:SC.RangeObserver,contains:function(a){return this.indexOf(a)>=0},addRangeObserver:function(d,f,h,e){var a=this._array_rangeObservers;if(!a){a=this._array_rangeObservers=SC.CoreSet.create()}if(this._array_oldLength===undefined){this._array_oldLength=this.get("length")}var g=this.rangeObserverClass;var b=NO;var c=g.create(this,d,f,h,e,b);a.add(c);if(!this._array_isNotifyingRangeObservers){this._array_isNotifyingRangeObservers=YES;this.addObserver("[]",this,this._array_notifyRangeObservers)}return c},updateRangeObserver:function(b,a){return b.update(this,a)},removeRangeObserver:function(c){var b=c.destroy(this);var a=this._array_rangeObservers;if(a){a.remove(c)}return b},addArrayObservers:function(a){this._modifyObserverSet("add",a)},removeArrayObservers:function(a){this._modifyObserverSet("remove",a)},_modifyObserverSet:function(h,c){var e,b;var g=c.target||this;var a=c.willChange||"arrayWillChange";var f=c.didChange||"arrayDidChange";var d=c.context;if(typeof a==="string"){a=g[a]}if(typeof f==="string"){f=g[f]}e=this._kvo_for("_kvo_array_will_change",SC.ObserverSet);b=this._kvo_for("_kvo_array_did_change",SC.ObserverSet);e[h](g,a,d);b[h](g,f,d)},arrayContentWillChange:function(b,j,a){this._teardownContentObservers(b,j);var f,d,h,k;var g,c;var e=this._kvo_array_will_change;if(e){d=e.members;h=d.length;for(k=0;k<h;k++){f=d[k];g=f[0];c=f[1];c.call(g,b,j,a,this)}}},arrayContentDidChange:function(b,o,a){var d=this._array_rangeObservers,h,c,m;this.beginPropertyChanges();this.notifyPropertyChange("length");if(d&&d.length>0){m=this._array_rangeChanges;if(!m){m=this._array_rangeChanges=SC.IndexSet.create()}if(o===a){c=o}else{c=this.get("length")-b;if(o>a){c+=(o-a)}}m.add(b,c)}this._setupContentObservers(b,a);var g,f,l,n;var j,e;var k=this._kvo_array_did_change;if(k){if(b===undefined){b=0;o=this.get("length");a=0}f=k.members;l=f.length;for(n=0;n<l;n++){g=f[n];j=g[0];e=g[1];e.call(j,b,o,a,this)}}this.notifyPropertyChange("[]");this.endPropertyChanges();return this},_setupContentObservers:function(f,e){var c=this._kvo_for("_kvo_content_observed_keys",SC.CoreSet);var d;var b;if(c.get("length")>0){d=this.slice(f,f+e);var a=this;c.forEach(function(g){b=SC.keyFor("_kvo_content_observers",g);a._kvo_for(b).forEach(function(h){d.forEach(function(j){a._resumeChainObservingForItemWithChainObserver(j,h)})})})}},_teardownContentObservers:function(e,a){var c=this._kvo_for("_kvo_content_observed_keys",SC.CoreSet);var d;var b;if(c.get("length")>0){d=this.slice(e,e+a);c.forEach(function(f){b=SC.keyFor("_kvo_content_observers",f);d.forEach(function(g){g._kvo_for(b).forEach(function(h){h.destroyChain()})})})}},teardownEnumerablePropertyChains:function(b){var a=this._kvo_enumerable_property_chains;if(a){a.forEach(function(g){var d,c=b.get("length"),j=SC.guidFor(g),f,h,e="_kvo_enumerable_property_clones";g.notifyPropertyDidChange();for(d=0;d<c;d++){h=b.objectAt(d);f=h[e][j];f.deactivate();delete h[e][j]}},this)}return this},setupEnumerablePropertyChains:function(b){var a=this._kvo_enumerable_property_chains;if(a){a.forEach(function(e){var d,c=b.get("length");e.notifyPropertyDidChange();c=b.get("length");for(d=0;d<c;d++){this._clonePropertyChainToItem(e,b.objectAt(d))}},this)}return this},registerDependentKeyWithChain:function(e,c){var b="_kvo_enumerable_property_chains",f,d,g,a;f=this._kvo_for(b,SC.CoreSet);f.add(c);this.forEach(function(h){this._clonePropertyChainToItem(c,h)},this)},_clonePropertyChainToItem:function(c,d){var e=SC.clone(c),b="_kvo_enumerable_property_clones",a;e.object=d;a=d[b]=d[b]||{};a[SC.guidFor(c)]=e;e.activate(d)},removeDependentKeyWithChain:function(f,d){var b="_kvo_enumerable_property_chains",c="_kvo_enumerable_property_clones",g,e,h,a;this.forEach(function(j){j.removeDependentKeyWithChain(f,d);a=j[c];h=a[SC.guidFor(d)];h.deactivate(j)},this)},_resumeChainObservingForItemWithChainObserver:function(d,a){var b=SC.clone(a.next);var c=b.property;b.object=d;d.addObserver(c,b,b.propertyDidChange);if(a.root.tails){a.root.tails.pushObject(b.tail())}b.propertyDidChange();d._kvo_for(SC.keyFor("_kvo_content_observers",c)).push(b)},_addContentObserver:function(a){var b=a.next.property;this._kvo_for("_kvo_content_observed_keys",SC.CoreSet).push(b);var c=SC.keyFor("_kvo_content_observers",b);this._kvo_for(c).push(a);this._setupContentObservers(0,a.object.get("length"))},_removeContentObserver:function(a){var e,c;var d=this._kvo_content_observed_keys;var b=a.next.property;if(d.contains(b)){c=SC.keyFor("_kvo_content_observers",b);e=this._kvo_for(c);e.removeObject(a);this._teardownContentObservers(0,a.object.get("length"));if(e.length===0){this._kvo_for("_kvo_content_observed_keys").remove(b)}}},_array_notifyRangeObservers:function(){var c=this._array_rangeObservers,d=this._array_rangeChanges,b=c?c.length:0,a,e;if(b>0&&d&&d.length>0){for(a=0;a<b;a++){c[a].rangeDidChange(d)}d.clear()}}};SC.Array=SC.mixin({},SC.Enumerable,SC.CoreArray);sc_require("mixins/array");SC.supplement(Array.prototype,SC.CoreArray);SC.mixin(Array.prototype,{replace:function(b,e,d){if(this.isFrozen){throw SC.FROZEN_ERROR}var c;var a=d?(d.get?d.get("length"):d.length):0;this.arrayContentWillChange(b,e,a);if(a===0){this.splice(b,e)}else{c=[b,e].concat(d);this.splice.apply(this,c)}this.beginPropertyChanges();this.arrayContentDidChange(b,e,a);this.enumerableContentDidChange(b,e,a-e);this.endPropertyChanges();return this},unknownProperty:function(b,c){var a=this.reducedProperty(b,c);if((c!==undefined)&&a===undefined){a=this[b]=c}return a}});if(Array.prototype.indexOf===SC.CoreArray.indexOf){Array.prototype.indexOf=function(d,c){var b,a=this.length;if(c===undefined){c=0}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b<a;b++){if(this[b]===d){return b}}return -1}}if(Array.prototype.lastIndexOf===SC.CoreArray.lastIndexOf){Array.prototype.lastIndexOf=function(d,c){var b,a=this.length;if(c===undefined){c=a-1}else{c=(c<0)?Math.ceil(c):Math.floor(c)}if(c<0){c+=a}for(b=c;b>=0;b--){if(this[b]===d){return b}}return -1}}if(!Date.now){Date.now=function(){return new Date().getTime()}}SC.String={_scs_valueForKey:function(e,g,c){var a,f,d,b=e.indexOf(":");if(b>-1){a=e.substr(b+1);e=e.substr(0,b)}f=g[e];d=g[e+"Formatter"];if(d){f=d(f,a)}else{if(a){throw"String.fmt was given a formatting string, but key `"+e+"` has no formatter! String: "+c}}return f},fmt:function(b,a){var c=0,d=undefined,e;if(a){d=a[0]}return b.replace(/%\{(.*?)\}/g,function(f,g){e=YES;if(!d){throw"Cannot use named parameters with `fmt` without a data hash. String: '"+b+"'"}return SC.String._scs_valueForKey(g,d,b)}).replace(/%@([0-9]+)?/g,function(g,f){if(e){throw"Invalid attempt to use both named parameters and indexed parameters. String: '"+b+"'"}f=f?parseInt(f,10)-1:c++;if(a[f]!==undefined){return a[f]}else{return""}})},w:function(f){var d=[],e=f.split(" "),b=e.length,c,a=0;for(a=0;a<b;++a){c=e[a];if(c.length!==0){d.push(c)}}return d}};sc_require("system/string");SC.mixin(String.prototype,{fmt:function(){return SC.String.fmt(this,arguments)},w:function(){return SC.String.w(this)}});SC.Comparable={isComparable:YES,compare:function(d,c){throw"%@.compare() is not implemented".fmt(this.toString())}};SC.Copyable={isCopyable:YES,copy:function(a){var b=SC._object_className(this.constructor);throw"%@.copy() is not implemented".fmt(b)},frozenCopy:function(){var a=this.get?this.get("isFrozen"):this.isFrozen;if(a===YES){return this}else{if(a===undefined){throw"%@ does not support freezing".fmt(this)}else{return this.copy().freeze()}}}};SC.mixin(Array.prototype,SC.Copyable);Array.prototype.copy=function(b){var c=this.slice(),a;if(b){a=c.length;while(a--){c[a]=SC.copy(c[a],true)}}return c};SC.FROZEN_ERROR=new Error("Cannot modify a frozen object");SC.Freezable={isFreezable:YES,isFrozen:NO,freeze:function(){if(this.set){this.set("isFrozen",YES)}else{this.isFrozen=YES}return this}};SC.mixin(Array.prototype,SC.Freezable);sc_require("mixins/enumerable");sc_require("mixins/observable");sc_require("mixins/freezable");sc_require("mixins/copyable");SC.Set=SC.mixin({},SC.Enumerable,SC.Observable,SC.Freezable,{create:function(c){var d,b,e=SC.Set._pool,f=this.isObservable,a;if(!f&&c===undefined&&e.length>0){return e.pop()}else{d=SC.beget(this);if(f){d.initObservable()}if(c&&c.isEnumerable&&c.get("length")>0){d.isObservable=NO;if(c.isSCArray){a=c.get("length");for(b=0;b<a;b++){d.add(c.objectAt(b))}}else{if(c.isSet){a=c.length;for(b=0;b<a;b++){d.add(c[b])}}else{c.forEach(function(g){d.add(g)},this)}}d.isObservable=f}}return d},isSet:YES,length:0,firstObject:function(){return(this.length>0)?this[0]:undefined}.property(),clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}this.length=0;return this},contains:function(b){if(b===null){return NO}var a=this[SC.hashFor(b)];return(!SC.none(a)&&(a<this.length)&&(this[a]===b))},isEqual:function(a){if(!a||!a.isSet||(a.get("length")!==this.get("length"))){return NO}var b=this.get("length");while(--b>=0){if(!a.contains(this[b])){return NO}}return YES},addSetObserver:function(a){if(!this.setObservers){this.setObservers=SC.CoreSet.create()}this.setObservers.add(a)},removeSetObserver:function(a){if(!this.setObservers){return}this.setObservers.remove(a)},add:function(e){if(this.isFrozen){throw SC.FROZEN_ERROR}if(SC.none(e)){return this}var c,d=((c=e.hash)&&(typeof c==="function"))?c.call(e):SC.guidFor(e),b=this[d],a=this.length;if((b>=a)||(this[b]!==e)){this[a]=e;this[d]=a;this.length=a+1;if(this.setObservers){this.didAddItem(e)}}if(this.isObservable){this.enumerableContentDidChange()}return this},addEach:function(c){if(this.isFrozen){throw SC.FROZEN_ERROR}if(!c||!c.isEnumerable){throw"%@.addEach must pass enumerable".fmt(this)}var a,b=this.isObservable;if(b){this.beginPropertyChanges()}if(c.isSCArray){a=c.get("length");while(--a>=0){this.add(c.objectAt(a))}}else{if(c.isSet){a=c.length;while(--a>=0){this.add(c[a])}}else{c.forEach(function(d){this.add(d)},this)}}if(b){this.endPropertyChanges()}return this},remove:function(f){if(this.isFrozen){throw SC.FROZEN_ERROR}if(f===null||f===undefined){return this}var c,d=(f&&(c=f.hash)&&(typeof c===SC.T_FUNCTION))?c.call(f):SC.guidFor(f),b=this[d],a=this.length,e;if((b===null||b===undefined)||(b>=a)||(this[b]!==f)){return this}delete this[d];if(b<(a-1)){e=this[b]=this[a-1];d=(e&&(c=e.hash)&&(typeof c===SC.T_FUNCTION))?c.call(e):SC.guidFor(e);this[d]=b}this.length=a-1;if(this.isObservable){this.enumerableContentDidChange()}if(this.setObservers){this.didRemoveItem(f)}return this},pop:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}var a=(this.length>0)?this[this.length-1]:null;this.remove(a);return a},removeEach:function(c){if(this.isFrozen){throw SC.FROZEN_ERROR}if(!c||!c.isEnumerable){throw"%@.addEach must pass enumerable".fmt(this)}var a,b=this.isObservable;if(b){this.beginPropertyChanges()}if(c.isSCArray){a=c.get("length");while(--a>=0){this.remove(c.objectAt(a))}}else{if(c.isSet){a=c.length;while(--a>=0){this.remove(c[a])}}else{c.forEach(function(d){this.remove(d)},this)}}if(b){this.endPropertyChanges()}return this},copy:function(){return this.constructor.create(this)},destroy:function(){this.isFrozen=NO;if(!this.isObservable){SC.Set._pool.push(this.clear())}return this},forEach:function(c,d){var b=this.length;if(!d){d=this}for(var a=0;a<b;a++){c.call(d,this[a],a,this)}return this},toString:function(){var b=this.length,a,c=[];for(a=0;a<b;a++){c[a]=this[a]}return"SC.Set<%@>".fmt(c.join(","))},didAddItem:function(c){var d=this.setObservers;if(!d){return}var b=d.length,a;for(a=0;a<b;a++){d[a].didAddItem(this,c)}},didRemoveItem:function(c){var d=this.setObservers;if(!d){return}var b=d.length,a;for(a=0;a<b;a++){d[a].didRemoveItem(this,c)}},_pool:[],isObservable:YES});SC.Set.constructor=SC.Set;SC.Set.clone=SC.Set.copy;SC.Set.push=SC.Set.unshift=SC.Set.add;SC.Set.shift=SC.Set.pop;SC.Set.addObject=SC.Set.add;SC.Set.removeObject=SC.Set.remove;SC.Set._pool=[];SC.CoreSet=SC.beget(SC.Set);SC.CoreSet.isObservable=NO;SC.CoreSet.constructor=SC.CoreSet;sc_require("mixins/observable");sc_require("system/set");SC.Observers={queue:[],addObserver:function(c,d,e,b){var a;if(typeof c==="string"){a=SC.tupleForPropertyPath(c,b)}else{a=c}if(a&&a[0].addObserver){a[0].addObserver(a[1],d,e)}else{this.queue.push([c,d,e,b])}},removeObserver:function(f,g,h,d){var c,b,a,e;a=SC.tupleForPropertyPath(f,d);if(a){a[0].removeObserver(a[1],g,h)}c=this.queue.length;b=this.queue,newQueue=undefined;while(--c>=0){e=b[c];if(e[0]!==f||e[1]!==g||e[2]!==h||e[3]!==d){if(!newQueue){newQueue=[]}newQueue.push(e)}}this.queue=newQueue||this.queue},addPendingRangeObserver:function(a){var b=this.rangeObservers;if(!b){b=this.rangeObservers=SC.CoreSet.create()}b.add(a);return this},_TMP_OUT:[],flush:function(b){var g=this.queue,d,a=g.length;if(g&&a>0){var k=(this.queue=[]);for(d=0;d<a;d++){var l=g[d];if(!l){continue}var h=SC.tupleForPropertyPath(l[0],l[3]);if(h&&h[0].addObserver){h[0].addObserver(h[1],l[1],l[2])}else{k.push(l)}}}if(b._kvo_needsRangeObserver){var j=this.rangeObservers,f=j?j.get("length"):0,c=this._TMP_OUT,e;for(d=0;d<f;d++){e=j[d];if(e.setupPending(b)){c.push(e)}}if(c.length>0){j.removeEach(c)}c.length=0;b._kvo_needsRangeObserver=false}},isObservingSuspended:0,_pending:SC.CoreSet.create(),objectHasPendingChanges:function(a){this._pending.add(a)},suspendPropertyObserving:function(){this.isObservingSuspended++},resumePropertyObserving:function(){var c;if(--this.isObservingSuspended<=0){c=this._pending;this._pending=SC.CoreSet.create();var b,a=c.length;for(b=0;b<a;b++){c[b]._notifyPropertyObservers()}c.clear();c=null}}};sc_require("core");sc_require("mixins/observable");sc_require("private/observer_queue");sc_require("mixins/array");sc_require("system/set");SC.BENCHMARK_OBJECTS=NO;SC._detect_base=function _detect_base(c,b,a){return function d(){var f=b[a],e;if(!f){throw new Error("No '"+a+"' method was found on the superclass")}if(c.isEnhancement){e=Array.prototype.slice.call(arguments,1)}else{e=arguments}return f.apply(this,e)}};SC._object_extend=function _object_extend(g,f,o){if(!f){throw"SC.Object.extend expects a non-null value.  Did you forget to 'sc_require' something?  Or were you passing a Protocol to extend() as if it were a mixin?"}g._kvo_cloned=null;var z,n,v,e,h=g.concatenatedProperties,l=SC.K,c,b;n=(h)?h.length:0;var a=(n>0)?{}:null;while(--n>=0){z=h[n];c=g[z];b=f[z];if(c){if(!(c instanceof Array)){c=SC.$A(c)}a[z]=(b)?c.concat(b):b}else{if(!(b instanceof Array)){b=SC.$A(b)}a[z]=b}}var y=g._bindings,m=NO,w=g._observers,x=NO,j=g._properties,d=NO,s,k,p,q;var u=g.outlets,t=NO;if(f.outlets){u=(u||SC.EMPTY_ARRAY).concat(f.outlets);t=YES}for(z in f){if(z==="_kvo_cloned"){continue}if(!f.hasOwnProperty(z)){continue}q=(a.hasOwnProperty(z)?a[z]:null)||f[z];if(z.length>7&&z.slice(-7)==="Binding"){if(!m){y=(y||SC.EMPTY_ARRAY).slice();m=YES}if(y===null){y=(g._bindings||SC.EMPTY_ARRAY).slice()}y[y.length]=z}else{if(q&&(q instanceof Function)){if(!q.superclass&&(q!==(e=g[z]))){q.superclass=e||l;q.base=o?SC._detect_base(q,o,z):e||l}if(q.propertyPaths){if(!x){w=(w||SC.EMPTY_ARRAY).slice();x=YES}w[w.length]=z}if(s=q.localPropertyPaths){k=s.length;while(--k>=0){p=g._kvo_for(SC.keyFor("_kvo_local",s[k]),SC.CoreSet);p.add(z);g._kvo_for("_kvo_observed_keys",SC.CoreSet).add(s[k])}}if(q.dependentKeys){if(!d){j=(j||SC.EMPTY_ARRAY).slice();d=YES}j[j.length]=z}if(q.autoconfiguredOutlet){if(!t){u=(u||SC.EMPTY_ARRAY).slice();t=YES}u[u.length]=z}if(q.isEnhancement){q=SC._enhance(g[z]||l,q)}}}g[z]=q}if(f.hasOwnProperty("toString")){z="toString";q=(a.hasOwnProperty(z)?a[z]:null)||f[z];if(!q.superclass&&(q!==(e=g[z]))){q.superclass=q.base=e||l}g[z]=q}g._bindings=y||[];g._observers=w||[];g._properties=j||[];g.outlets=u||[];return g};SC._enhance=function(b,a){return function(){var d=Array.prototype.slice.call(arguments,0),c=this;d.unshift(function(){return b.apply(c,arguments)});return a.apply(this,d)}};SC.Object=function(a){this.__sc_super__=SC.Object.prototype;return this._object_init(a)};SC.mixin(SC.Object,{mixin:function(b){var a=arguments.length,c;for(c=0;c<a;c++){SC.mixin(this,arguments[c])}return this},superclass:null,extend:function(e){var d=SC.BENCHMARK_OBJECTS;if(d){SC.Benchmark.start("SC.Object.extend")}var g,c=function(h){this.__sc_super__=c.prototype;return this._object_init(h)};for(g in this){if(!this.hasOwnProperty(g)){continue}c[g]=this[g]}if(this.hasOwnProperty("toString")){c.toString=this.toString}c.superclass=this;c.__sc_super__=this.prototype;SC.generateGuid(c,"sc");c.subclasses=SC.Set.create();this.subclasses.add(c);var f=(c.prototype=SC.beget(this.prototype)),b,a=arguments.length;for(b=0;b<a;b++){SC._object_extend(f,arguments[b],c.__sc_super__)}f.constructor=c;if(d){SC.Benchmark.end("SC.Object.extend")}return c},reopen:function(b){var a;a=SC._object_extend(this.prototype,b,this.__sc_super__);if(this.subclasses){this.subclasses.forEach(function(d,c){var e,f;for(e in b){if(!b.hasOwnProperty(e)){continue}f=b[e];if(d.prototype.hasOwnProperty(e)){delete b[e]}if(f&&(f instanceof Function)&&(f.isEnhancement)){delete b[e]}}d.reopen(b)},this)}return a},create:function(){var b=this,a=new b(arguments);if(SC.ObjectDesigner){SC.ObjectDesigner.didCreateObject(a,SC.$A(arguments))}return a},isClass:YES,subclasses:SC.Set.create(),toString:function(){return SC._object_className(this)},subclassOf:function(b){if(this===b){return NO}var a=this;while(a=a.superclass){if(a===b){return YES}}return NO},hasSubclass:function(a){return(a&&a.subclassOf)?a.subclassOf(this):NO},kindOf:function(a){return(this===a)||this.subclassOf(a)},design:function(){if(this.isDesign){return this}var a=this.extend.apply(this,arguments);a.isDesign=YES;if(SC.ObjectDesigner){SC.ObjectDesigner.didLoadDesign(a,this,SC.A(arguments))}return a}});SC.Object.prototype={_kvo_enabled:YES,_object_init:function(c){var b,a=(c)?c.length:0;for(b=0;b<a;b++){SC._object_extend(this,c[b],this.__sc_super__)}SC.generateGuid(this,"sc");this.init();var d=this.initMixin;a=(d)?d.length:0;for(b=0;b<a;b++){d[b].call(this)}return this},mixin:function(){var b,a=arguments.length,c;for(b=0;b<a;b++){SC._object_extend(this,arguments[b])}this._observableInited=NO;this.initObservable();for(b=0;b<a;b++){c=arguments[b].initMixin;if(c){c.call(this)}}return this},init:function(){this.initObservable();return this},isDestroyed:NO,destroy:function(){if(this.get("isDestroyed")){return this}this.set("isDestroyed",YES);var b,c=this.destroyMixin,a=(c)?c.length:0;for(b=0;b<a;b++){c[b].call(this)}this.bindings.invoke("disconnect");this.bindings=null;return this},isObject:true,respondsTo:function(a){return !!(this[a] instanceof Function)},tryToPerform:function(b,c,a){return this.respondsTo(b)&&(this[b](c,a)!==NO)},superclass:function(b){var a=arguments.callee.caller;if(!a){throw"superclass cannot determine the caller method"}return a.superclass?a.superclass.apply(this,arguments):null},instanceOf:function(a){return this.constructor===a},kindOf:function(a){return this.constructor.kindOf(a)},toString:function(){if(!this._object_toString){var a=SC._object_className(this.constructor),b=a+":"+SC.guidFor(this);if(a){this._object_toString=b}else{return b}}return this._object_toString},awake:function(){var d=this.outlets,b,a,c;for(b=0,a=d.length;b<a;++b){c=d[b];this.get(c)}this.bindings.invoke("sync")},invokeOnce:function(a){SC.RunLoop.currentRunLoop.invokeOnce(this,a);return this},invokeLast:function(a){SC.RunLoop.currentRunLoop.invokeLast(this,a);return this},invokeNext:function(a){SC.RunLoop.currentRunLoop.invokeNext(this,a);return this},concatenatedProperties:["concatenatedProperties","initMixin","destroyMixin"]};SC.Object.prototype.constructor=SC.Object;SC.mixin(SC.Object.prototype,SC.Observable);function findClassNames(){if(SC._object_foundObjectClassNames){return}SC._object_foundObjectClassNames=true;var b=[],c=false;var a=function(d,f,k){var m,j,h;k--;if(b.indexOf(f)>=0){return}b.push(f);for(var g in f){if(g=="__scope__"){continue}if(g=="superclass"){continue}if(g=="__SC__"){g="SC"}if(!g.match(/^[A-Z0-9]/)){continue}if(g=="SC"){if(c){continue}c=true}m=(d)?[d,g].join("."):g;j=f[g];try{h=SC.typeOf(j)}catch(l){break}switch(h){case SC.T_CLASS:if(!j._object_className){j._object_className=m}if(k>=0){a(m,j,k)}break;case SC.T_OBJECT:if(k>=0){a(m,j,k)}break;case SC.T_HASH:if(((d)||(m==="SC"))&&(k>=0)){a(m,j,k)}break;default:break}}};window.__SC__=SC;a(null,window,2)}SC.instanceOf=function(a,b){return !!(a&&a.constructor===b)};SC.kindOf=function(a,b){if(a&&!a.isClass){a=a.constructor}return !!(a&&a.kindOf&&a.kindOf(b))};SC._object_className=function(b){if(SC.isReady===NO){return""}if(!b._object_className){findClassNames()}if(b._object_className){return b._object_className}var a=b;while(a&&!a._object_className){a=a.superclass}return(a&&a._object_className)?a._object_className:"Anonymous"};sc_require("system/object");SC._PropertyChain=SC.Object.extend({object:null,property:null,target:null,toInvalidate:null,nextProperty:null,activate:function(b){var a=this.get("object"),c=this.get("property"),d;if(!b){b=this.get("target")}if(a&&a!==b){this.deactivate()}this.set("object",b);if(b&&c!=="@each"){b.registerDependentKeyWithChain(c,this)}if(this.next){d=b?b.get(c):undefined;this.next.activate(d)}return this},deactivate:function(){var a=this.get("object"),b=this.get("property");if(a){a.removeDependentKeyWithChain(b,this)}if(this.next){this.next.deactivate()}return this},notifyPropertyDidChange:function(){var d=this.get("target"),c=this.get("toInvalidate"),b,a;d.propertyDidChange(c);if(this.next){b=this.get("object");a=b.get(this.get("property"));this.next.activate(a)}}});SC._PropertyChain.createChain=function(h,g,e){var f=h.split(".");var a=f.length,d=1;var b=SC._PropertyChain.create({property:f[0],target:g,toInvalidate:e,nextProperty:f[1]});b.set("length",a);var c=b;while(--a>=1){c=c.next=SC._PropertyChain.create({property:f[d],target:g,toInvalidate:e,nextProperty:f[++d]});c.set("length",a)}return b};sc_require("ext/function");sc_require("system/object");SC.LOG_BINDINGS=NO;SC.BENCHMARK_BINDING_NOTIFICATIONS=NO;SC.BENCHMARK_BINDING_SETUP=NO;SC.MULTIPLE_PLACEHOLDER="@@MULT@@";SC.NULL_PLACEHOLDER="@@NULL@@";SC.EMPTY_PLACEHOLDER="@@EMPTY@@";SC.Binding={beget:function(b){var a=SC.beget(this);a.parentBinding=this;if(b!==undefined){a=a.from(b)}return a},builder:function(){var b=this,a=function(c){return b.beget().from(c)};a.beget=function(){return b.beget()};return a},from:function(b,a){if(!b){return this}var c=(this===SC.Binding)?this.beget():this;c._fromPropertyPath=b;c._fromRoot=a;c._fromTuple=null;return c},to:function(b,a){var c=(this===SC.Binding)?this.beget():this;c._toPropertyPath=b;c._toRoot=a;c._toTuple=null;return c},connect:function(){if(this.isConnected){return this}this.isConnected=YES;this._connectionPending=YES;this._syncOnConnect=YES;SC.Binding._connectQueue.add(this);if(!SC.RunLoop.isRunLoopInProgress()){this._scheduleSync()}return this},_connect:function(){if(!this._connectionPending){return}this._connectionPending=NO;var c,a,b=SC.BENCHMARK_BINDING_SETUP;if(b){SC.Benchmark.start("SC.Binding.connect()")}c=this._fromPropertyPath;a=this._fromRoot;if(typeof c==="string"){if(c.indexOf(".")===0){c=c.slice(1);if(!a){a=this._toRoot}}else{if(c.indexOf("*")===0){c=[this._fromRoot||this._toRoot,c.slice(1)];a=null}}}this._fromObserverData=[c,this,this.fromPropertyDidChange,a];SC.Observers.addObserver.apply(SC.Observers,this._fromObserverData);if(!this._oneWay){c=this._toPropertyPath;a=this._toRoot;this._toObserverData=[c,this,this.toPropertyDidChange,a];SC.Observers.addObserver.apply(SC.Observers,this._toObserverData)}if(b){SC.Benchmark.end("SC.Binding.connect()")}if(this._syncOnConnect){this._syncOnConnect=NO;if(b){SC.Benchmark.start("SC.Binding.connect().sync")}this.sync();if(b){SC.Benchmark.end("SC.Binding.connect().sync")}}},disconnect:function(){if(!this.isConnected){return this}if(this._connectionPending){this._connectionPending=NO}else{SC.Observers.removeObserver.apply(SC.Observers,this._fromObserverData);if(!this._oneWay){SC.Observers.removeObserver.apply(SC.Observers,this._toObserverData)}}this.isConnected=NO;return this},fromPropertyDidChange:function(c,b){var a=c?c.get(b):null;if(a!==this._bindingValue||b==="[]"){this._setBindingValue(c,b);this._changePending=YES;SC.Binding._changeQueue.add(this);this._scheduleSync()}},toPropertyDidChange:function(c,b){if(this._oneWay){return}var a=c.get(b);if(a!==this._transformedBindingValue){this._setBindingValue(c,b);this._changePending=YES;SC.Binding._changeQueue.add(this);this._scheduleSync()}},_scheduleSync:function(){if(SC.RunLoop.isRunLoopInProgress()||SC.Binding._syncScheduled){return}SC.Binding._syncScheduled=YES;setTimeout(function(){SC.run();SC.Binding._syncScheduled=NO},1)},_setBindingValue:function(b,a){this._bindingSource=b;this._bindingKey=a},_computeBindingValue:function(){var g=this._bindingSource,e=this._bindingKey,c,b;this._bindingValue=c=(g?g.getPath(e):null);var f=this._transforms;if(f){var a=f.length,d;for(b=0;b<a;b++){d=f[b];c=d(c,this)}}if(this._noError&&SC.typeOf(c)===SC.T_ERROR){c=null}this._transformedBindingValue=c},_connectQueue:SC.CoreSet.create(),_alternateConnectQueue:SC.CoreSet.create(),_changeQueue:SC.CoreSet.create(),_alternateChangeQueue:SC.CoreSet.create(),_changePending:NO,flushPendingChanges:function(){if(this._isFlushing){return NO}this._isFlushing=YES;SC.Observers.suspendPropertyObserving();var b=NO,c=SC.LOG_BINDINGS,a,d;while((a=this._connectQueue).length>0){this._connectQueue=this._alternateConnectQueue;this._alternateConnectQueue=a;while(d=a.pop()){d._connect()}}while((a=this._changeQueue).length>0){if(c){SC.Logger.log("Begin: Trigger changed bindings")}b=YES;this._changeQueue=this._alternateChangeQueue;this._alternateChangeQueue=a;while(d=a.pop()){d.applyBindingValue()}if(c){SC.Logger.log("End: Trigger changed bindings")}}this._isFlushing=NO;SC.Observers.resumePropertyObserving();return b},applyBindingValue:function(){this._changePending=NO;this._computeBindingTargets();this._computeBindingValue();var a=this._bindingValue,b=this._transformedBindingValue,c=SC.BENCHMARK_BINDING_NOTIFICATIONS,d=SC.LOG_BINDINGS;if(!this._oneWay&&this._fromTarget){if(d){SC.Logger.log("%@: %@ -> %@".fmt(this,a,b))}if(c){SC.Benchmark.start(this.toString()+"->")}this._fromTarget.setPathIfChanged(this._fromPropertyKey,a);if(c){SC.Benchmark.end(this.toString()+"->")}}if(this._toTarget){if(d){SC.Logger.log("%@: %@ <- %@".fmt(this,a,b))}if(c){SC.Benchmark.start(this.toString()+"<-")}this._toTarget.setPathIfChanged(this._toPropertyKey,b);if(c){SC.Benchmark.start(this.toString()+"<-")}}},sync:function(){if(!this.isConnected){return this}if(this._connectionPending){this._syncOnConnect=YES}else{this._computeBindingTargets();var c=this._fromTarget,b=this._fromPropertyKey;if(!c||!b){return this}if(!c.isObservable){SC.Logger.warn("Cannot bind '%@' to property '%@' on non-observable '%@'".fmt(this._toPropertyPath,b,c));return this}var a=c.getPath(b);if(a!==this._bindingValue||b==="[]"){this._setBindingValue(c,b);this._changePending=YES;SC.Binding._changeQueue.add(this)}}return this},_syncOnConnect:NO,_computeBindingTargets:function(){if(!this._fromTarget){var c,b,a;c=this._fromPropertyPath;b=this._fromRoot;if(typeof c==="string"){if(c.indexOf(".")===0){c=c.slice(1);if(!b){b=this._toRoot}}else{if(c.indexOf("*")===0){c=[b||this._toRoot,c.slice(1)];b=null}}}a=SC.tupleForPropertyPath(c,b);if(a){this._fromTarget=a[0];this._fromPropertyKey=a[1]}}if(!this._toTarget){c=this._toPropertyPath;b=this._toRoot;a=SC.tupleForPropertyPath(c,b);if(a){this._toTarget=a[0];this._toPropertyKey=a[1]}}},oneWay:function(c,a){if((a===undefined)&&(SC.typeOf(c)===SC.T_BOOL)){a=c;c=null}var b=this.from(c);if(b===SC.Binding){b=b.beget()}b._oneWay=(a===undefined)?YES:a;return b},transform:function(b){var c=(this===SC.Binding)?this.beget():this;var a=c._transforms;if(a&&(a===c.parentBinding._transform)){a=c._transforms=a.slice()}if(!a){a=c._transforms=[]}a.push(b);return c},resetTransforms:function(){var a=(this===SC.Binding)?this.beget():this;a._transforms=null;return a},noError:function(c,a){if((a===undefined)&&(SC.typeOf(c)===SC.T_BOOL)){a=c;c=null}var b=this.from(c);if(b===SC.Binding){b=b.beget()}b._noError=(a===undefined)?YES:a;return b},single:function(b,a){if(a===undefined){a=SC.MULTIPLE_PLACEHOLDER}return this.from(b).transform(function(e,d){if(e&&e.isEnumerable){var c=e.get("length");e=(c>1)?a:(c<=0)?null:e.firstObject()}return e})},notEmpty:function(b,a){if(a===undefined){a=SC.EMPTY_PLACEHOLDER}return this.from(b).transform(function(d,c){if(SC.none(d)||(d==="")||(SC.isArray(d)&&(d.get?d.get("length"):d.length)===0)){d=a}return d})},notNull:function(b,a){if(a===undefined){a=SC.EMPTY_PLACEHOLDER}return this.from(b).transform(function(d,c){if(SC.none(d)){d=a}return d})},multiple:function(a){return this.from(a).transform(function(b){if(!SC.isArray(b)){b=(b==null)?[]:[b]}return b})},bool:function(a){return this.from(a).transform(function(b){var c=SC.typeOf(b);if(c===SC.T_ERROR){return b}return(c==SC.T_ARRAY)?(b.length>0):(b==="")?NO:!!b})},and:function(b,a){var c=SC.Object.create({valueABinding:b,valueBBinding:a,and:function(){return(this.get("valueA")&&this.get("valueB"))}.property("valueA","valueB").cacheable()});return this.from("and",c).oneWay()},or:function(b,a){var c=SC.Object.create({valueABinding:b,valueBBinding:a,or:function(){return(this.get("valueA")||this.get("valueB"))}.property("valueA","valueB").cacheable()});return this.from("or",c).oneWay()},not:function(a){return this.from(a).transform(function(b){var c=SC.typeOf(b);if(c===SC.T_ERROR){return b}return !((c==SC.T_ARRAY)?(b.length>0):(b==="")?NO:!!b)})},isNull:function(a){return this.from(a).transform(function(b){var c=SC.typeOf(b);return(c===SC.T_ERROR)?b:SC.none(b)})},toString:function(){var c=this._fromRoot?"<%@>:%@".fmt(this._fromRoot,this._fromPropertyPath):this._fromPropertyPath;var b=this._toRoot?"<%@>:%@".fmt(this._toRoot,this._toPropertyPath):this._toPropertyPath;var a=this._oneWay?"[oneWay]":"";return"SC.Binding%@(%@ -> %@)%@".fmt(SC.guidFor(this),c,b,a)}};SC.binding=function(b,a){return SC.Binding.from(b,a)};sc_require("ext/function");SC.Error=SC.Object.extend({code:-1,message:"",errorValue:null,errorObject:function(){return this}.property().cacheable(),label:null,toString:function(){return"SC.Error:%@:%@ (%@)".fmt(SC.guidFor(this),this.get("message"),this.get("code"))},isError:YES});SC.Error.desc=function(d,a,e,c){var b={message:d};if(a!==undefined){b.label=a}if(c!==undefined){b.code=c}if(e!==undefined){b.errorValue=e}return this.create(b)};SC.$error=function(b,a,d,e){return SC.Error.desc(b,a,d,e)};SC.ok=function(a){return(a!==false)&&!(a&&a.isError)};SC.$ok=SC.ok;SC.val=function(a){if(a&&a.isError){return a.get?a.get("errorValue"):null}else{return a}};SC.$val=SC.val;SC.Error.HAS_MULTIPLE_VALUES=-100;sc_require("mixins/enumerable");sc_require("mixins/observable");sc_require("mixins/freezable");sc_require("mixins/copyable");SC.IndexSet=SC.mixin({},SC.Enumerable,SC.Observable,SC.Freezable,SC.Copyable,{_sc_sliceContent:function(e){if(e.length<1000){return e.slice()}var d=0,a=[],b=e[0];while(b!==0){a[d]=b;d=(b<0)?(0-b):b;b=e[d]}a[d]=0;this._hint(0,d,a);return a},create:function(c,b){var a=SC.beget(this);a.initObservable();a.registerDependentKey("min","[]");if(c&&c.isIndexSet){a._content=this._sc_sliceContent(c._content);a.max=c.max;a.length=c.length;a.source=c.source}else{a._content=[0];if(c!==undefined){a.add(c,b)}}return a},isIndexSet:YES,HINT_SIZE:256,length:0,max:0,min:function(){var a=this._content,b=a[0];return(b===0)?-1:(b>0)?0:Math.abs(b)}.property("[]").cacheable(),firstObject:function(){return(this.get("length")>0)?this.get("min"):undefined}.property(),rangeStartForIndex:function(c){var f=this._content,a=this.get("max"),b,e,d;if(c>=a){return a}if(Math.abs(f[c])>c){return c}d=c-(c%SC.IndexSet.HINT_SIZE);b=f[d];if(b<0||b>c){b=d}e=f[b];if(e===undefined){e=this.rangeStartForIndex(b)}else{e=Math.abs(e)}while(e<c){b=e;e=Math.abs(f[b])}return b},isEqual:function(c){if(c===this){return YES}if(!c||!c.isIndexSet||(c.max!==this.max)||(c.length!==this.length)){return NO}var e=this._content,b=c._content,d=0,a=e[d];do{if(b[d]!==a){return NO}d=Math.abs(a);a=e[d]}while(d!==0);return YES},indexBefore:function(b){if(b===0){return -1}b--;var c=this._content,a=this.get("max"),d=this.rangeStartForIndex(b);if(!c){return null}while((d===a)||(c[d]<0)){if(d===0){return -1}b=d-1;d=this.rangeStartForIndex(b)}return b},indexAfter:function(b){var d=this._content,a=this.get("max"),e,c;if(!d||(b>=a)){return -1}b++;e=this.rangeStartForIndex(b);c=d[e];while(c<0){if(c===0){return -1}b=e=Math.abs(c);c=d[e]}return b},contains:function(g,c){var b,f,a,e,d;if(c===undefined){if(g===null||g===undefined){return NO}if(typeof g===SC.T_NUMBER){c=1}else{if(g&&g.isIndexSet){if(g===this){return YES}b=g._content;f=0;a=b[f];while(a!==0){if((a>0)&&!this.contains(f,a-f)){return NO}f=Math.abs(a);a=b[f]}return YES}else{c=g.length;g=g.start}}}e=this.rangeStartForIndex(g);d=this._content[e];return(d>0)&&(e<=g)&&(d>=(g+c))},intersects:function(f,c){var b,e,a,d;if(c===undefined){if(typeof f===SC.T_NUMBER){c=1}else{if(f&&f.isIndexSet){if(f===this){return YES}b=f._content;e=0;a=b[e];while(a!==0){if((a>0)&&this.intersects(e,a-e)){return YES}e=Math.abs(a);a=b[e]}return NO}else{c=f.length;f=f.start}}}e=this.rangeStartForIndex(f);b=this._content;a=b[e];d=f+c;while(e<d){if(a===0){return NO}if((a>0)&&(a>f)){return YES}e=Math.abs(a);a=b[e]}return NO},without:function(b,a){if(b===this){return SC.IndexSet.create()}return this.clone().remove(b,a)},replace:function(c,a){if(a===undefined){if(typeof c===SC.T_NUMBER){a=1}else{if(c&&c.isIndexSet){this._content=this._sc_sliceContent(c._content);this.beginPropertyChanges().set("max",c.max).set("length",c.length).set("source",c.source).enumerableContentDidChange();this.endPropertyChanges();return this}else{a=c.length;c=c.start}}}var b=this.length;this._content.length=1;this._content[0]=0;this.length=this.max=0;return this.add(c,a)},add:function(a,b){if(this.isFrozen){throw SC.FROZEN_ERROR}var e,j,d;if(a&&a.isIndexSet){e=a._content;if(!e){return this}j=0;d=e[0];while(d!==0){if(d>0){this.add(j,d-j)}j=d<0?0-d:d;d=e[j]}return this}else{if(b===undefined){if(a===null||a===undefined){return this}else{if(typeof a===SC.T_NUMBER){b=1}else{b=a.length;a=a.start}}}else{if(b===null){b=1}}}if(b<=0){return this}var f=this.get("max"),c=f,h,g;e=this._content;if(a===f){if(a>0){j=this.rangeStartForIndex(a-1);d=e[j];if(d>0){delete e[f];e[j]=f=a+b;a=j}else{e[f]=f=a+b}}else{e[a]=f=b}e[f]=0;this.set("max",f);this.set("length",this.length+b);b=f-a}else{if(a>f){e[f]=0-a;e[a]=a+b;e[a+b]=0;this.set("max",a+b);this.set("length",this.length+b);b=a+b-f;a=f}else{j=this.rangeStartForIndex(a);d=e[j];f=a+b;h=0;if((a>0)&&(j===a)&&(d<=0)){j=this.rangeStartForIndex(a-1);d=e[j]}if(d<0){e[j]=0-a;if(Math.abs(d)>f){e[a]=0-f;e[f]=d}else{e[a]=d}}else{a=j;if(d>f){f=d}}j=a;while(j<f){g=e[j];if(g===0){e[f]=0;d=f;h+=f-j}else{d=Math.abs(g);if(d>f){e[f]=g;d=f}if(g<0){h+=d-j}}delete e[j];j=d}if((j=e[f])>0){delete e[f];f=j}e[a]=f;if(f>c){this.set("max",f)}this.set("length",this.get("length")+h);b=f-a}}this._hint(a,b);if(h!==0){this.enumerableContentDidChange()}return this},remove:function(a,b){if(this.isFrozen){throw SC.FROZEN_ERROR}if(b===undefined){if(a===null||a===undefined){return this}else{if(typeof a===SC.T_NUMBER){b=1}else{if(a.isIndexSet){a.forEachRange(this.remove,this);return this}else{b=a.length;a=a.start}}}}if(b<=0){return this}var f=this.get("max"),c=f,e=this._content,k,d,j,g,h;if(a>=f){return this}k=this.rangeStartForIndex(a);d=e[k];h=a+b;j=0;if((a>0)&&(k===a)&&(d>0)){k=this.rangeStartForIndex(a-1);d=e[k]}if(d>0){e[k]=a;if(d>h){e[a]=h;e[h]=d}else{e[a]=d}}else{a=k;d=Math.abs(d);if(d>h){h=d}}k=a;while(k<h){g=e[k];if(g===0){e[h]=0;d=h}else{d=Math.abs(g);if(d>h){e[h]=g;d=h}if(g>0){j+=d-k}}delete e[k];k=d}if((k=e[h])<0){delete e[h];h=Math.abs(k)}if(e[h]===0){delete e[h];e[a]=0;this.set("max",a)}else{e[a]=0-h}this.set("length",this.get("length")-j);b=h-a;this._hint(a,b);if(j!==0){this.enumerableContentDidChange()}return this},_hint:function(g,d,c){if(c===undefined){c=this._content}var b=SC.IndexSet.HINT_SIZE,a=Math.abs(c[g]),f=g-(g%b)+b,e=g+d;while(f<e){while((a!==0)&&(a<=f)){g=a;a=Math.abs(c[g])}if(a===0){delete c[f]}else{if(f!==g){c[f]=g}}f+=b}},clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}var a=this.length;this._content.length=1;this._content[0]=0;this.set("length",0).set("max",0);if(a>0){this.enumerableContentDidChange()}},addEach:function(b){if(this.isFrozen){throw SC.FROZEN_ERROR}this.beginPropertyChanges();var a=b.get("length");if(b.isSCArray){while(--a>=0){this.add(b.objectAt(a))}}else{if(b.isEnumerable){b.forEach(function(c){this.add(c)},this)}}this.endPropertyChanges();return this},removeEach:function(b){if(this.isFrozen){throw SC.FROZEN_ERROR}this.beginPropertyChanges();var a=b.get("length");if(b.isSCArray){while(--a>=0){this.remove(b.objectAt(a))}}else{if(b.isEnumerable){b.forEach(function(c){this.remove(c)},this)}}this.endPropertyChanges();return this},clone:function(){return SC.IndexSet.create(this)},inspect:function(){var e=this._content,b=e.length,a=0,c=[],d;for(a=0;a<b;a++){d=e[a];if(d!==undefined){c.push("%@:%@".fmt(a,d))}}return"SC.IndexSet<%@>".fmt(c.join(" , "))},forEachRange:function(f,d){var b=this._content,e=0,a=b[e],c=this.source;if(d===undefined){d=null}while(a!==0){if(a>0){f.call(d,e,a-e,this,c)}e=Math.abs(a);a=b[e]}return this},forEachIn:function(b,c,k,f){var g=this._content,j=0,h=0,d=b+c,a=this.source,e=g[j];if(f===undefined){f=null}while(e!==0){if(j<b){j=b}while((j<e)&&(j<d)){k.call(f,j++,h++,this,a)}if(j>=d){j=e=0}else{j=Math.abs(e);e=g[j]}}return this},lengthIn:function(g,d){var a=0;if(d===undefined){if(g===null||g===undefined){return 0}else{if(typeof g===SC.T_NUMBER){d=1}else{if(g.isIndexSet){g.forEachRange(function(j,h){a+=this.lengthIn(j,h)},this);return a}else{d=g.length;g=g.start}}}}if(this.get("length")===0){return 0}var c=this._content,f=0,b=c[f],e=g+d;while(f<e&&b!==0){if(b>0){a+=(b>e)?e-f:b-f}f=Math.abs(b);b=c[f]}return a},source:null,indexOf:function(d,c){var f=this.source;if(!f){throw"%@.indexOf() requires source".fmt(this)}var b=f.get("length"),e=this._content,g=e[0]<0?Math.abs(e[0]):0,a;while(g>=0&&g<b){a=f.indexOf(d,g);if(a<0){return -1}if(this.contains(a)){return a}g=a+1}return -1},lastIndexOf:function(d,c){var e=this.source;if(!e){throw"%@.lastIndexOf() requires source".fmt(this)}var b=e.get("length"),f=this.max-1,a;if(f>=b){f=b-1}while(f>=0){a=e.lastIndexOf(d,f);if(a<0){return -1}if(this.contains(a)){return a}f=a+1}return -1},forEachObject:function(g,e){var d=this.source;if(!d){throw"%@.forEachObject() requires source".fmt(this)}var c=this._content,f=0,a=0,b=c[f];if(e===undefined){e=null}while(b!==0){while(f<b){g.call(e,d.objectAt(f),f,d,this);f++}f=Math.abs(b);b=c[f]}return this},addObject:function(c,d){var e=this.source;if(!e){throw"%@.addObject() requires source".fmt(this)}var b=e.get("length"),f=0,a;while(f>=0&&f<b){a=e.indexOf(c,f);if(a>=0){this.add(a);if(d){return this}f=a++}else{return this}}return this},addObjects:function(b,a){b.forEach(function(c){this.addObject(c,a)},this);return this},removeObject:function(c,d){var e=this.source;if(!e){throw"%@.removeObject() requires source".fmt(this)}var b=e.get("length"),f=0,a;while(f>=0&&f<b){a=e.indexOf(c,f);if(a>=0){this.remove(a);if(d){return this}f=a+1}else{return this}}return this},removeObjects:function(b,a){b.forEach(function(c){this.removeObject(c,a)},this);return this},LOG_OBSERVING:NO,forEach:function(g,e){var c=this._content,f=0,a=0,d=this.source,b=c[f];if(e===undefined){e=null}while(b!==0){while(f<b){g.call(e,f++,a++,this,d)}f=Math.abs(b);b=c[f]}return this},nextObject:function(f,b,c){var e=this._content,d=c.next,a=this.get("max");if(b===null){b=d=0}else{if(b>=a){delete c.next;return null}else{b++}}if(b===d){do{b=Math.abs(d);d=e[b]}while(d<0);c.next=d}return b},toString:function(){var a=[];this.forEachRange(function(c,b){a.push(b===1?c:"%@..%@".fmt(c,c+b-1))},this);return"SC.IndexSet<%@>".fmt(a.join(","))},max:0});SC.IndexSet.slice=SC.IndexSet.copy=SC.IndexSet.clone;SC.IndexSet.EMPTY=SC.IndexSet.create().freeze();SC.json={encode:function(a){return JSON.stringify(a)},decode:function(a){return JSON.parse(a)}};if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());sc_require("ext/function");SC.LOGGER_LOG_DELIMITER=", ";SC.LOGGER_LOG_ERROR="ERROR: ";SC.LOGGER_LOG_INFO="INFO:  ";SC.LOGGER_LOG_WARN="WARN:  ";SC.LOGGER_LOG_DEBUG="DEBUG: ";SC.LOGGER_LOG_GROUP_HEADER="** %@";SC.LOGGER_LOG_GROUP_INDENTATION="    ";SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX="%@:  ";SC.LOGGER_LEVEL_DEBUG="debug";SC.LOGGER_LEVEL_INFO="info";SC.LOGGER_LEVEL_WARN="warn";SC.LOGGER_LEVEL_ERROR="error";SC.LOGGER_LEVEL_NONE="none";SC.Logger=SC.Object.create({messagePrefix:null,outputMessagePrefix:null,recordedMessagePrefix:null,logOutputLevel:null,logRecordingLevel:SC.LOGGER_LEVEL_NONE,recordedLogMessages:null,recordedLogMessagesMaximumLength:500,recordedLogMessagesPruningMinimumLength:100,debugEnabled:NO,exists:function(){return !SC.none(this.get("reporter"))}.property("reporter").cacheable(),fallBackOnAlert:NO,reporter:console,debug:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_DEBUG,YES,a,arguments)},debugWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_DEBUG,NO,null,arguments)},debugGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_DEBUG,a,arguments)},debugGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_DEBUG)},info:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_INFO,YES,a,arguments)},infoWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_INFO,NO,null,arguments)},infoGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_INFO,a,arguments)},infoGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_INFO)},warn:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_WARN,YES,a,arguments)},warnWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_WARN,NO,null,arguments)},warnGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_WARN,a,arguments)},warnGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_WARN)},error:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_ERROR,YES,a,arguments)},errorWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_ERROR,NO,null,arguments)},errorGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_ERROR,a,arguments)},errorGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_ERROR)},outputRecordedLogMessages:function(n){if(!this.get("exists")){return}var s=this.get("reporter"),k=this.get("recordedLogMessages"),a=0,d=SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX,q,o,b,c,g,h,e,f,u,m,l,p,t;if(k){for(q=0,o=k.length;q<o;++q){b=k[q];c=b.type;if(n){g=d.fmt(b.timestamp.toUTCString())}h=b.message;if(h){e=b.originalArguments;this._outputMessage(c,g,a,h,e)}else{m=b.indentation;u=b.title;l=m-a;if(s.group){if(Math.abs(l)>1){for(p=0,t=(l-1);p<t;++p){if(l>0){s.group()}else{s.groupEnd()}}}if(l>0){f=g?g:"";f+=u;s.group(f)}else{s.groupEnd()}}else{if(l>0){this._outputGroup(c,g,m-1,u)}}a=m}}}},stringifyRecordedLogMessages:function(){var j="",f=this.get("recordedLogMessages"),m=0,h=SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX,d=this._LOG_FALLBACK_PREFIX_MAPPING,c=SC.LOGGER_LOG_GROUP_HEADER,e,a,o,l,s,q,g,p,n,k,b;if(f){for(e=0,a=f.length;e<a;++e){o=f[e];l=o.type;g=h.fmt(o.timestamp.toUTCString());g+=d[l]||"";s=o.message;if(s){q=o.originalArguments;p=g+this._indentation(m);p+=q?this._argumentsToString(q):s}else{k=o.indentation;n=o.title;b=k-m;if(b>0){p=g+this._indentation(m)+c.fmt(n)}m=k}j+=p+"\n"}}return j},log:function(){var a=this.get("reporter"),c=arguments[0],d=this.get("messagePrefix"),e=this.get("outputMessagePrefix"),b=NO;if(c&&SC.typeOf(c)===SC.T_STRING){if(d||e){if(d){c=d+c}if(e){c=e+c}arguments[0]=c}}if(this.get("exists")){if(typeof a.log==="function"){a.log.apply(a,arguments);b=YES}else{if(a.log){a.log(this._argumentsToArray(arguments));b=YES}}}if(!b&&this.get("fallBackOnAlert")){if(this.get("exists")&&(typeof a.alert==="function")){a.alert(arguments);b=YES}else{alert(arguments);b=YES}}return b},group:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.group==="function")){a.group(b)}},groupEnd:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.groupEnd==="function")){a.groupEnd()}},dir:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.dir==="function")){a.dir.apply(a,arguments)}else{this.log.apply(this,arguments)}},dirxml:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.dirxml==="function")){a.dirxml.apply(a,arguments)}else{this.log.apply(this,arguments)}},profile:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.profile==="function")){a.profile(b);return YES}return NO},profileEnd:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.profileEnd==="function")){a.profileEnd(b);return YES}return NO},time:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.time==="function")){a.time(b);return YES}return NO},timeEnd:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.timeEnd==="function")){a.timeEnd(b);return YES}return NO},trace:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.trace==="function")){a.trace();return YES}return NO},init:function(){arguments.callee.base.apply(this,arguments);if(!this.get("logOutputLevel")){if(SC.buildMode==="debug"){this.set("logOutputLevel",SC.LOGGER_LEVEL_DEBUG)}else{this.set("logOutputLevel",SC.LOGGER_LEVEL_INFO)}}this.debugEnabledDidChange()},debugEnabledDidChange:function(){if(this.get("debugEnabled")){this.set("logOutputLevel",SC.LOGGER_LEVEL_DEBUG)}}.observes("debugEnabled"),_handleMessage:function(l,n,p,o){var a=this._shouldOutputType(l),d=this._shouldRecordType(l),e,f,j,k,b,m,h,c,g;if(!(a||d)){return}e=(o&&o.length>1);if(n&&(SC.none(p)||(typeof p!=="string"))){n=NO}if(n){if(e){k=[];for(f=1,j=o.length;f<j;++f){k.push(o[f])}p=p.fmt.apply(p,k)}}h=this.get("messagePrefix");if(h){p=h+p}if(a){c=this.get("outputMessagePrefix");k=n?null:o;this._outputMessage(l,null,this._outputIndentationLevel,(c?c+p:p),k)}if(d){g=this.get("recordedMessagePrefix");m={type:l,message:p?(g?g+p:p):YES,timestamp:new Date()};if(!n&&e){m.originalArguments=o}this._addRecordedMessageEntry(m)}},_handleGroup:function(l,n,q){var a=this._shouldOutputType(l),e=this._shouldRecordType(l),f,g,j,k,p,d,c,h,b,m,o;if(!(a||e)){return}f=(q&&q.length>1);if(n&&f){k=[];for(g=1,j=q.length;g<j;++g){k.push(q[g])}n=n.fmt.apply(n,k)}if(a){this._outputGroup(l,null,this._outputIndentationLevel,n);this._outputIndentationLevel++}if(e){m=++this._recordingIndentationLevel;o={type:l,indentation:m,beginGroup:YES,title:n,timestamp:new Date()};this._addRecordedMessageEntry(o)}},_handleGroupEnd:function(d){var g=this._shouldOutputType(d),c=this._shouldRecordType(d),a,f,b,e;if(!(g||c)){return}if(g){this._outputIndentationLevel--;if(this.get("exists")){a=this.get("reporter");f=a.groupEnd;if(f){f.call(a)}}}if(c){b=--this._recordingIndentationLevel;e={type:d,indentation:b,timestamp:new Date()};this._addRecordedMessageEntry(e)}},_shouldOutputType:function(a){var c=this._LOG_LEVEL_MAPPING,d=c[a]||0,b=c[this.get("logOutputLevel")]||0;return(d<=b)},_shouldRecordType:function(a){var c=this._LOG_LEVEL_MAPPING,d=c[a]||0,b=c[this.get("logRecordingLevel")]||0;return(d<=b)},_outputMessage:function(h,g,j,m,l){if(!this.get("exists")){return}var d=this.get("reporter"),b,a,c,e,f,k;a=!d.group;c=d[h];if(c){if(!l){b=g?g:"";if(a){b+=this._indentation(j)}b+=m;d[h](b)}else{f=this._argumentsToArray(l);e="";if(g){e=g}if(a){e+=this._indentation(j)}if(e){f.splice(0,0,e)}if(c.apply){c.apply(d,f)}else{d[h](f)}}}else{if(d.log){e="";if(g){e=g}e+=this._LOG_FALLBACK_PREFIX_MAPPING[h]||"";if(a){e+=this._indentation(j)}if(!l){d.log(e+m)}else{f=this._argumentsToArray(l);if(e){f.splice(0,0,e)}d.log(f)}}}},_outputGroup:function(d,f,c,g){if(!this.get("exists")){return}var b=this.get("reporter"),e=b.group,a;if(e){a=f?f:"";a+=g;e.call(b,a)}else{if(b.log){a="";if(f){a=f}a+=this._LOG_FALLBACK_PREFIX_MAPPING[d]||"";a+=this._indentation(c);a+=SC.LOGGER_LOG_GROUP_HEADER.fmt(g);b.log(a)}}},_addRecordedMessageEntry:function(c){var b=this.get("recordedLogMessages"),a;if(!b){b=[];this.set("recordedLogMessages",b)}b.push(c);a=b.length;if(a>this.get("recordedLogMessagesMaximumLength")){b.splice(0,(a-this.get("recordedLogMessagesPruningMinimumLength")))}b.enumerableContentDidChange()},_argumentsToArray:function(c){var b=[],d,a;if(c){for(d=0,a=c.length;d<a;++d){b[d]=c[d]}}return b},_argumentsToString:function(){var c="",b=SC.LOGGER_LOG_DELIMITER,d,a;for(d=0,a=(arguments.length-1);d<a;++d){c+=arguments[d]+b}c+=arguments[a];return c},_indentation:function(d){if(!d||d<0){d=0}var b="",a=SC.LOGGER_LOG_GROUP_INDENTATION,c;for(c=0;c<d;++c){b+=a}return b},_outputIndentationLevel:0,_recordingIndentationLevel:0,_LOG_LEVEL_MAPPING:{debug:4,info:3,warn:2,error:1,none:0},_LOG_FALLBACK_PREFIX_MAPPING:{debug:SC.LOGGER_LOG_DEBUG,info:SC.LOGGER_LOG_INFO,warn:SC.LOGGER_LOG_WARN,error:SC.LOGGER_LOG_ERROR}});SC.debug=SC.Logger.debug;SC.info=SC.Logger.info;SC.warn=SC.Logger.warn;SC.error=SC.Logger.error;sc_require("ext/function");sc_require("private/observer_set");SC.RunLoop=SC.Object.extend({beginRunLoop:function(){this._start=new Date().getTime();if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.beginRunLoop at %@".fmt(this._start))}this._runLoopInProgress=YES;this._flushinvokeNextQueue();return this},isRunLoopInProgress:function(){return this._runLoopInProgress}.property(),endRunLoop:function(){if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.endRunLoop ~ flushing application queues")}this.flushAllPending();this._start=null;if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.endRunLoop ~ End")}SC.RunLoop.lastRunLoopEnd=Date.now();this._runLoopInProgress=NO;return this},flushAllPending:function(){var a;do{a=this.flushApplicationQueues();if(!a){a=this._flushinvokeLastQueue()}}while(a)},invokeOnce:function(b,c){if(c===undefined){c=b;b=this}var a;if(typeof c==="string"){c=b[c]}if(!this._invokeQueue){this._invokeQueue=SC.ObserverSet.create()}if(c){this._invokeQueue.add(b,c,undefined,a)}return this},invokeLast:function(b,c){if(c===undefined){c=b;b=this}var a;if(typeof c==="string"){c=b[c]}if(!this._invokeLastQueue){this._invokeLastQueue=SC.ObserverSet.create()}this._invokeLastQueue.add(b,c,undefined,a);return this},invokeNext:function(a,b){if(b===undefined){b=a;a=this}if(typeof b==="string"){b=a[b]}if(!this._invokeNextQueue){this._invokeNextQueue=SC.ObserverSet.create()}this._invokeNextQueue.add(a,b);return this},flushApplicationQueues:function(){var b=NO,a=this._invokeQueue;if(a&&a.getMembers().length){this._invokeQueue=null;b=YES;a.invokeMethods()}return SC.Binding.flushPendingChanges()||b},_flushinvokeLastQueue:function(){var a=this._invokeLastQueue,b=NO;if(a&&a.getMembers().length){this._invokeLastQueue=null;b=YES;if(b){a.invokeMethods()}}return b},_flushinvokeNextQueue:function(){var a=this._invokeNextQueue,b=NO;if(a&&a.getMembers().length){this._invokeNextQueue=null;b=YES;if(b){a.invokeMethods()}}return b}});SC.RunLoop.currentRunLoop=null;SC.RunLoop.runLoopClass=SC.RunLoop;SC.RunLoop.begin=function(){var a=this.currentRunLoop;if(!a){a=this.currentRunLoop=this.runLoopClass.create()}a.beginRunLoop();return this};SC.RunLoop.end=function(){var a=this.currentRunLoop;if(!a){throw"SC.RunLoop.end() called outside of a runloop!"}a.endRunLoop();return this};SC.RunLoop.kill=function(){this.currentRunLoop=this.runLoopClass.create();return this};SC.RunLoop.isRunLoopInProgress=function(){if(this.currentRunLoop){return this.currentRunLoop.get("isRunLoopInProgress")}return NO};SC.run=function(g,f,b){var a=SC.RunLoop.isRunLoopInProgress();if(SC.ExceptionHandler&&SC.ExceptionHandler.enabled){try{if(b||!a){SC.RunLoop.begin()}if(g){g.call(f)}if(b||!a){SC.RunLoop.end()}}catch(d){var c=SC.ExceptionHandler.handleException(d);if(!c&&!SC.browser.isIE){throw d}}}else{if(b||!a){SC.RunLoop.begin()}if(g){g.call(f)}if(b||!a){SC.RunLoop.end()}}};SC.RunLoop.wrapFunction=function(b){var a=function(){var c=SC.RunLoop.isRunLoopInProgress();if(!c){SC.RunLoop.begin()}var d=arguments.callee.wrapped.apply(this,arguments);if(!c){SC.RunLoop.end()}return d};a.wrapped=b;return a};SC.DROP_ON=1;SC.DROP_BEFORE=2;SC.DROP_AFTER=4;SC.DROP_ANY=7;SC.ALIGN_LEFT="left";SC.ALIGN_RIGHT="right";SC.ALIGN_CENTER="center";SC.ALIGN_TOP="top";SC.ALIGN_MIDDLE="middle";SC.ALIGN_BOTTOM="bottom";SC.ALIGN_TOP_LEFT="top-left";SC.ALIGN_TOP_RIGHT="top-right";SC.ALIGN_BOTTOM_LEFT="bottom-left";SC.ALIGN_BOTTOM_RIGHT="bottom-right";SC.mixin({data:$.data,removeData:$.removeData,STRINGS:{},stringsFor:function(b,a){SC.mixin(SC.STRINGS,a);return this}});SC.Controller=SC.Object.extend({isEditable:YES,destroyContentOnReplace:NO,contentObjectDidChanged:function(){var b,a;if(!this.get("destroyContentOnReplace")){return}b=this._oldContent;a=this.get("content");if(b&&a!==b&&b.destroy){b.destroy()}this._oldContent=a}.observes("content")});SC.SelectionSupport={hasSelectionSupport:YES,allowsSelection:YES,allowsMultipleSelection:YES,allowsEmptySelection:YES,firstSelectableObject:function(){return this.get("firstObject")}.property(),selection:function(d,f){var c=this._scsel_selection,g=c?c.get("length"):0,e,b=this.get("arrangedObjects"),a;if((f===undefined)||!this.get("allowsSelection")){f=c}a=(f&&f.isEnumerable)?f.get("length"):0;if((a>1)&&!this.get("allowsMultipleSelection")){if(g>1){f=SC.SelectionSet.create().addObject(c.get("firstObject")).freeze();a=1}else{f=c;a=g}}if((a===0)&&!this.get("allowsEmptySelection")&&b&&b.get("length")!==0){if(g===0){f=this.get("firstSelectableObject");if(f){f=SC.SelectionSet.create().addObject(f).freeze()}else{f=SC.SelectionSet.EMPTY}a=f.get("length")}else{f=c;a=g}}if(a===0){f=SC.SelectionSet.EMPTY}if(f!==c){f=f.frozenCopy()}this._scsel_selection=f;return f}.property("arrangedObjects","allowsEmptySelection","allowsMultipleSelection","allowsSelection").cacheable(),hasSelection:function(){var a=this.get("selection");return !!a&&(a.get("length")>0)}.property("selection").cacheable(),selectObjects:function(b,c){if(!b||b.get("length")===0){if(!c){this.set("selection",SC.SelectionSet.EMPTY)}return this}var a=this.get("selection");if(c&&a){a=a.copy()}else{a=SC.SelectionSet.create()}a.addObjects(b).freeze();this.set("selection",a);return this},selectObject:function(a,b){if(a===null){if(!b){this.set("selection",null)}return this}else{return this.selectObjects([a],b)}},deselectObjects:function(b){if(!b||b.get("length")===0){return this}var a=this.get("selection");if(!a||a.get("length")===0){return this}a=a.copy().removeObjects(b).freeze();this.set("selection",a.freeze());return this},deselectObject:function(a){if(!a){return this}else{return this.deselectObjects([a])}},updateSelectionAfterContentChange:function(){var a=this.get("arrangedObjects");var b=this.get("selection");var d=this.get("allowsEmptySelection");var c;if(!b){return this}c=b.indexSetForSource(a);if((c&&(c.get("length")!==b.get("length")))||(!c&&(b.get("length")>0))){b=b.copy().constrain(a).freeze();this.set("selection",b)}if((b.get("length")===0)&&a&&(a.get("length")>0)&&!d){this.selectObject(this.get("firstSelectableObject"),NO)}return this}};sc_require("controllers/controller");sc_require("mixins/selection_support");SC.ArrayController=SC.Controller.extend(SC.Array,SC.SelectionSupport,{content:null,isEditable:YES,orderBy:null,allowsSingleContent:YES,destroyOnRemoval:NO,arrangedObjects:function(){return this}.property().cacheable(),canRemoveContent:function(){var b=this.get("content"),a;a=!!b&&this.get("isEditable")&&this.get("hasContent");if(a){return !b.isEnumerable||(SC.typeOf(b.removeObject)===SC.T_FUNCTION)}else{return NO}}.property("content","isEditable","hasContent"),canReorderContent:function(){var b=this.get("content"),a;a=!!b&&this.get("isEditable")&&!this.get("orderBy");return a&&!!b.isSCArray}.property("content","isEditable","orderBy"),canAddContent:function(){var b=this.get("content"),a;a=b&&this.get("isEditable")&&b.isEnumerable;if(a){return(SC.typeOf(b.addObject)===SC.T_FUNCTION)||(SC.typeOf(b.pushObject)===SC.T_FUNCTION)}else{return NO}}.property("content","isEditable"),hasContent:function(){var a=this.get("content");return !!a&&(!!a.isEnumerable||!!this.get("allowsSingleContent"))}.property("content","allowSingleContent"),status:function(){var b=this.get("content"),a=b?b.get("status"):null;return a?a:SC.Record.READY}.property().cacheable(),addObject:function(a){if(!this.get("canAddContent")){throw"%@ cannot add content".fmt(this)}var b=this.get("content");if(b.isSCArray){b.pushObject(a)}else{if(b.addObject){b.addObject(a)}else{throw"%@.content does not support addObject".fmt(this)}}return this},removeObject:function(a){if(!this.get("canRemoveContent")){throw"%@ cannot remove content".fmt(this)}var b=this.get("content");if(b.isEnumerable){b.removeObject(a)}else{this.set("content",null)}if(this.get("destroyOnRemoval")&&a.destroy){a.destroy()}return this},length:function(){var a=this._scac_observableContent();return a?a.get("length"):0}.property().cacheable(),objectAt:function(a){var b=this._scac_observableContent();return b?b.objectAt(a):undefined},replace:function(g,f,d){if(!d||d.get("length")===0){if(!this.get("canRemoveContent")){throw"%@ cannot remove objects from the current content".fmt(this)}}else{if(!this.get("canReorderContent")){throw"%@ cannot add or reorder the current content".fmt(this)}}var c=this.get("content");var b=[],a,e;if(this.get("destroyOnRemoval")){for(a=0;a<f;a++){b.push(c.objectAt(a+g))}}if(c){c.replace(g,f,d)}for(a=0,e=b.length;a<e;a++){b[a].destroy()}b=null;return this},indexOf:function(b,a){var c=this._scac_observableContent();return c?c.indexOf(b,a):-1},init:function(){arguments.callee.base.apply(this,arguments);this._scac_contentDidChange()},_scac_cached:NO,_scac_observableContent:function(){var c=this._scac_cached;if(c){return c}var f=this.get("content"),e,b,a;if(SC.none(f)){return(this._scac_cached=[])}if(!f.isEnumerable){c=this.get("allowsSingleContent")?[f]:[];return(this._scac_cached=c)}var g=this.get("orderBy");if(!g){if(f.isSCArray){return(this._scac_cached=f)}else{throw"%@.orderBy is required for unordered content".fmt(this)}}var d=SC.typeOf(g);if(d===SC.T_STRING){g=[g]}else{if(d===SC.T_FUNCTION){e=g}else{if(d!==SC.T_ARRAY){throw"%@.orderBy must be Array, String, or Function".fmt(this)}}}e=e||function(p,o){var k,q,n,h,s;for(var m=0,j=g.get("length");m<j&&!k;m++){q=g.objectAt(m);if(q.search(/(ASC|DESC)/)===0){n=q.match(/^(ASC )?(DESC )?(.*)$/);q=n[3]}else{n=q.match(/^(\S*)\s*(DESC)?(?:ASC)?$/);q=n[1]}a=n[2]?-1:1;if(p){h=p.isObservable?p.get(q):p[q]}if(o){s=o.isObservable?o.get(q):o[q]}k=SC.compare(h,s)*a}return k};return(this._scac_cached=f.toArray().sort(e))},propertyWillChange:function(a){if(a==="content"){this.arrayContentWillChange(0,this.get("length"),0)}else{return arguments.callee.base.apply(this,arguments)}},_scac_arrayContentWillChange:function(d,c,a){this.arrayContentWillChange(d,c,a);if(this._kvo_enumerable_property_chains){var b=this.slice(d,d+c);this.teardownEnumerablePropertyChains(b)}},_scac_arrayContentDidChange:function(d,c,a){this._scac_cached=NO;this.arrayContentDidChange(d,c,a);if(this._kvo_enumerable_property_chains){var b=this.slice(d,d+a);this.setupEnumerablePropertyChains(b)}this.updateSelectionAfterContentChange()},_scac_contentDidChange:function(){this._scac_cached=NO;var h=this.get("content"),d=!!this.get("orderBy"),j=this._scac_content,a=this._scac_length||0,g=this._scac_arrayContentDidChange,c=this._scac_arrayContentWillChange,b=this._scac_contentStatusDidChange,f=this._scac_enumerableDidChange,e;if(h===j){return this}if(j){if(j.isSCArray){j.removeArrayObservers({target:this,didChange:g,willChange:c})}else{if(j.isEnumerable){j.removeObserver("[]",this,f)}}j.removeObserver("status",this,b);this.teardownEnumerablePropertyChains(j)}this._scac_cached=NO;this._scac_content=h;if(h){if(h.isSCArray){h.addArrayObservers({target:this,didChange:g,willChange:c});e=h.get("length")}else{if(h.isEnumerable){h.addObserver("[]",this,f);e=h.get("length")}else{e=1}}h.addObserver("status",this,b);this.setupEnumerablePropertyChains(h)}else{e=SC.none(h)?0:1}this._scac_length=e;this._scac_contentStatusDidChange();this.arrayContentDidChange(0,0,e);this.updateSelectionAfterContentChange()}.observes("content"),_scac_enumerableDidChange:function(){var a=this.get("content"),c=a?a.get("length"):0,b=this._scac_length;this._scac_length=c;this.beginPropertyChanges();this._scac_cached=NO;this.arrayContentDidChange(0,b,c);this.enumerableContentDidChange(0,b-1);this.endPropertyChanges();this.updateSelectionAfterContentChange()}.observes("orderBy"),_scac_contentStatusDidChange:function(){this.notifyPropertyChange("status")}});sc_require("controllers/controller");SC.ObjectController=SC.Controller.extend({content:null,allowsMultipleContent:NO,hasContent:function(){return !SC.none(this.get("observableContent"))}.property("observableContent"),isEditable:YES,observableContent:function(){var b=this.get("content"),a,c;if(b&&b.isEnumerable){a=b.get("length");c=this.get("allowsMultipleContent");if(a===1){b=b.firstObject()}else{if(a===0||!c){b=null}}if(b&&!c&&b.isEnumerable){b=null}}return b}.property("content","allowsMultipleContent").cacheable(),destroy:function(){var a=this.get("observableContent");if(a&&SC.typeOf(a.destroy)===SC.T_FUNCTION){a.destroy()}this.set("content",null);return this},contentPropertyDidChange:function(b,a){if(a==="*"){this.allPropertiesDidChange()}else{this.notifyPropertyChange(a)}},unknownProperty:function(b,d){if(b==="content"){if(d!==undefined){this.content=d}return this.content}var c=this.get("observableContent"),f,e,a;if(c===null||c===undefined){return undefined}if(d===undefined){if(c.isEnumerable){d=c.getEach(b);f=d.get("length");if(f>0){a=YES;e=d.objectAt(0);while((--f>0)&&a){if(e!==d.objectAt(f)){a=NO}}if(a){d=e}}else{d=undefined}}else{d=(c.isObservable)?c.get(b):c[b]}}else{if(!this.get("isEditable")){throw"%@.%@ is not editable".fmt(this,b)}if(c.isEnumerable){c.setEach(b,d)}else{if(c.isObservable){c.set(b,d)}else{c[b]=d}}}return d},init:function(){arguments.callee.base.apply(this,arguments);if(this.get("content")){this._scoc_contentDidChange()}if(this.get("observableContent")){this._scoc_observableContentDidChange()}},_scoc_contentDidChange:function(){var b=this._scoc_content,c=this.get("content");if(b!==c){this._scoc_content=c;var a=this._scoc_enumerableContentDidChange;if(b&&b.isEnumerable){b.removeObserver("[]",this,a)}if(c&&c.isEnumerable){c.addObserver("[]",this,a)}}}.observes("content"),_scoc_observableContentDidChange:function(){var b=this._scoc_observableContent,d=this.get("observableContent"),a=this.contentPropertyDidChange,c=this._scoc_enumerableContentDidChange;if(b===d){return this}this._scoc_observableContent=d;if(b){if(b.isEnumerable){b.removeObserver("[]",this,c)}else{if(b.isObservable){b.removeObserver("*",this,a)}}}if(d){if(d.isEnumerable){d.addObserver("[]",this,c)}else{if(d.isObservable){d.addObserver("*",this,a)}}}if((b&&b.isEnumerable)||(d&&d.isEnumerable)){this._scoc_enumerableContentDidChange()}else{this.contentPropertyDidChange(d,"*")}}.observes("observableContent"),_scoc_enumerableContentDidChange:function(){var b=this.get("observableContent"),c=this._scoc_observableContentItems,a=this.contentPropertyDidChange;if(c){c.forEach(function(d){if(d.isObservable){d.removeObserver("*",this,a)}},this);c.clear()}if(b&&b.isEnumerable){if(!c){c=SC.Set.create()}b.forEach(function(d){if(c.contains(d)){return}c.add(d);if(d.isObservable){d.addObserver("*",this,a)}},this)}else{c=null}this._scoc_observableContentItems=c;this.contentPropertyDidChange(b,"*");return this}});SC.mixin(Function.prototype,{invokeLater:function(e,a){if(a===undefined){a=1}var d=this;if(arguments.length>2){var b=SC.$A(arguments).slice(2,arguments.length);b.unshift(e);var c=d;d=function(){return c.apply(this,b.slice(1))}}return SC.Timer.schedule({target:e,action:d,interval:a})}});SC.mixin(SC.Object.prototype,{invokeLater:function(d,a){var c,b;if(SC.typeOf(d)===SC.T_STRING){d=this[d]}if(a===undefined){a=1}if(arguments.length>2){b=SC.$A(arguments).slice(2);c=function(){return d.apply(this,b)}}else{c=d}return SC.Timer.schedule({target:this,action:c,interval:a})},invokeOnceLater:function(j,c){var d,g,b,e=this._sc_invokeOnceLaterTimers,h,a;if(SC.typeOf(j)===SC.T_STRING){j=this[j]}if(c===undefined){c=1}if(!e){e=this._sc_invokeOnceLaterTimers={}}b=SC.guidFor(j);h=e[b];if(h){h.invalidate()}if(arguments.length>2){d=SC.$A(arguments).slice(2)}else{d=arguments}g=function(){delete e[b];return j.apply(this,d)};a=SC.Timer.schedule({target:this,action:g,interval:c});e[b]=a;return a},invokeWith:function(b,c,d){if(d===undefined){d=c;c=this}if(!c){c=this}if(SC.typeOf(d)===SC.T_STRING){d=c[d]}var a=this.getPath(b);d.call(c,a,this);return this}});SC.RunLoop=SC.RunLoop.extend({startTime:function(){if(!this._start){this._start=Date.now()}return this._start}.property(),endRunLoop:function(){this.fireExpiredTimers();var a=arguments.callee.base.apply(this,arguments);this.scheduleNextTimeout();return a},scheduleTimer:function(b,a){this._timerQueue=b.removeFromTimerQueue(this._timerQueue);this._timerQueue=b.scheduleInTimerQueue(this._timerQueue,a);return this},cancelTimer:function(a){this._timerQueue=a.removeFromTimerQueue(this._timerQueue);return this},TIMER_ARRAY:[],fireExpiredTimers:function(){if(!this._timerQueue||this._firing){return NO}var d=this.get("startTime"),e=this.TIMER_ARRAY,c,b,a;this._firing=YES;this._timerQueue=this._timerQueue.collectExpiredTimers(e,d);b=e.length;for(c=0;c<b;c++){e[c].fire()}a=e.length>0;e.length=0;this._firing=NO;return a},scheduleNextTimeout:function(){var d=this._timerQueue;var b=NO;if(!d){if(this._timeout){clearTimeout(this._timeout)}}else{var c=d._timerQueueRunTime;if(this._timeoutAt!==c){if(this._timeout){clearTimeout(this._timeout)}var a=Math.max(0,c-Date.now());this._timeout=setTimeout(this._timeoutDidFire,a);this._timeoutAt=c}b=YES}return b},_timeoutDidFire:function(){var a=SC.RunLoop.currentRunLoop;a._timeout=a._timeoutAt=null;SC.run()}});SC.RunLoop.currentRunLoop=SC.RunLoop.create();SC.RunLoop.runLoopClass=SC.RunLoop;SC.Locale=SC.Object.extend({init:function(){if(!this.language){SC.Locale._assignLocales()}if(!this.hasStrings){var c=this._deprecatedLanguageCodes||[];c.push(this.language);var b=c.length;var a=null;while(!a&&--b>=0){a=String[c[b]]}if(a){this.hasStrings=YES;this.strings=a}}},hasStrings:NO,strings:{},metrics:{},toString:function(){if(!this.language){SC.Locale._assignLocales()}return"SC.Locale["+this.language+"]"+SC.guidFor(this)},locWithDefault:function(b,c){var a=this.strings[b];if(SC.typeOf(a)===SC.T_STRING){return a}else{if(SC.typeOf(c)===SC.T_STRING){return c}}return b},locMetric:function(b){var a=this.metrics[b];if(SC.typeOf(a)===SC.T_NUMBER){return a}else{if(a===undefined){SC.warn('No localized metric found for key "'+b+'"');return undefined}else{SC.warn('Unexpected metric type for key "'+b+'"');return undefined}}},locLayout:function(c,b){var e,g,f,m,l,a=SC.Locale.layoutKeys,k=this.metrics,j=SC.typeOf,d=SC.T_NUMBER,h={};if(b){SC.mixin(h,b)}for(e=0,g=a.length;e<g;++e){f=a[e];m=c+"."+f;l=k[m];if(j(l)===d){if(b&&b[f]){throw"locLayout():  There is a localized value for the key '"+m+"' but a value for '"+f+"' was also specified in the non-localized hash"}h[f]=l}}return h}});SC.Locale.mixin({useAutodetectedLanguage:NO,preferredLanguage:null,layoutKeys:["left","top","right","bottom","width","height","minWidth","minHeight","centerX","centerY"],createCurrentLocale:function(){var c=(String.useAutodetectedLanguage!==undefined)?String.useAutodetectedLanguage:this.useAutodetectedLanguage;var b=(String.preferredLanguage!==undefined)?String.preferredLanguage:this.preferredLanguage;var d=((c)?SC.browser.language:null)||b||SC.browser.language||"en";d=SC.Locale.normalizeLanguage(d);var a=this.localeClassFor(d);if(d!=this.currentLanguage){this.currentLanguage=d;this.currentLocale=a.create()}return this.currentLocale},localeClassFor:function(c){c=SC.Locale.normalizeLanguage(c);var b,a=this.locales[c];if(!a&&((b=c.split("-")[0])!==c)&&(a=this.locales[b])){a=this.locales[c]=a.extend()}if(!a){a=this.locales[c]=this.locales.en.extend()}return a},define:function(b,c){var a;if(c===undefined&&(SC.typeOf(b)!==SC.T_STRING)){a=this;c=b}else{a=SC.Locale.localeClassFor(b)}SC.mixin(a.prototype,c);return a},options:function(){return this.prototype},addStrings:function(b){var a=this.prototype.strings;if(a){if(!this.prototype.hasOwnProperty("strings")){a=this.prototype.strings=SC.clone(a)}}else{a=this.prototype.strings={}}if(b){this.prototype.strings=SC.mixin(a,b)}this.prototype.hasStrings=YES;return this},addMetrics:function(b){var a=this.prototype.metrics;if(a){if(!this.prototype.hasOwnProperty(a)){a=this.prototype.metrics=SC.clone(a)}}else{a=this.prototype.metrics={}}if(b){this.prototype.metrics=SC.mixin(a,b)}return this},_map:{english:"en",french:"fr",german:"de",japanese:"ja",jp:"ja",spanish:"es"},normalizeLanguage:function(a){if(!a){return"en"}return SC.Locale._map[a.toLowerCase()]||a},_assignLocales:function(){for(var a in this.locales){this.locales[a].prototype.language=a}},toString:function(){if(!this.prototype.language){SC.Locale._assignLocales()}return"SC.Locale["+this.prototype.language+"]"},extend:function(){var a=SC.Object.extend.apply(this,arguments);a.addStrings=SC.Locale.addStrings;a.define=SC.Locale.define;a.options=SC.Locale.options;a.toString=SC.Locale.toString;return a}});SC.Locale.locales={en:SC.Locale.extend({_deprecatedLanguageCodes:["English"]}),fr:SC.Locale.extend({_deprecatedLanguageCodes:["French"]}),de:SC.Locale.extend({_deprecatedLanguageCodes:["German"]}),ja:SC.Locale.extend({_deprecatedLanguageCodes:["Japanese","jp"]}),es:SC.Locale.extend({_deprecatedLanguageCodes:["Spanish"]})};SC.stringsFor=function(c,b){var a=SC.Locale.localeClassFor(c);a.addStrings(b);return this};SC.metricsFor=function(c,b){var a=SC.Locale.localeClassFor(c);a.addMetrics(b);return this};sc_require("system/locale");SC.STRING_TITLEIZE_REGEXP=(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g);SC.STRING_DECAMELIZE_REGEXP=(/([a-z])([A-Z])/g);SC.STRING_DASHERIZE_REGEXP=(/[ _]/g);SC.STRING_DASHERIZE_CACHE={};SC.STRING_TRIM_LEFT_REGEXP=(/^\s+/g);SC.STRING_TRIM_RIGHT_REGEXP=(/\s+$/g);SC.mixin(SC.String,{capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},camelize:function(d){var b=d.replace(SC.STRING_TITLEIZE_REGEXP,function(f,g,e){return e?e.toUpperCase():""});var c=b.charAt(0),a=c.toLowerCase();return c!==a?a+b.slice(1):b},decamelize:function(a){return a.replace(SC.STRING_DECAMELIZE_REGEXP,"$1_$2").toLowerCase()},dasherize:function(c){var a=SC.STRING_DASHERIZE_CACHE,b=a[c];if(b){return b}else{b=SC.String.decamelize(c).replace(SC.STRING_DASHERIZE_REGEXP,"-");a[c]=b}return b},loc:function(d){if(!SC.Locale.currentLocale){SC.Locale.createCurrentLocale()}var b=SC.Locale.currentLocale.locWithDefault(d);if(SC.typeOf(b)!==SC.T_STRING){b=d}var a=SC.$A(arguments);a.shift();if(a.length>0&&a[0]&&a[0].isSCArray){a=a[0]}try{return SC.String.fmt(b,a)}catch(c){SC.error("Error processing string with key: "+d);SC.error("Localized String: "+b);SC.error("Error: "+c)}},locMetric:function(b){var a=SC.Locale,c=a.currentLocale;if(!c){a.createCurrentLocale();c=a.currentLocale}return c.locMetric(b)},locLayout:function(b,c){var a=SC.Locale,d=a.currentLocale;if(!d){a.createCurrentLocale();d=a.currentLocale}return d.locLayout(b,c)},locWithDefault:function(d,c){if(!SC.Locale.currentLocale){SC.Locale.createCurrentLocale()}var b=SC.Locale.currentLocale.locWithDefault(d,c);if(SC.typeOf(b)!==SC.T_STRING){b=d}var a=SC.$A(arguments);a.shift();a.shift();return SC.String.fmt(b,a)},trim:jQuery.trim,trimLeft:function(a){return a.replace(SC.STRING_TRIM_LEFT_REGEXP,"")},trimRight:function(a){return a.replace(SC.STRING_TRIM_RIGHT_REGEXP,"")},mult:function(d,c){if(SC.typeOf(c)!==SC.T_NUMBER||c<1){return null}var a="";for(var b=0;b<c;b+=1){a+=d}return a}});if(String.prototype.trim){SC.supplement(String.prototype,{trim:function(){return SC.String.trim(this,arguments)},trimLeft:function(){return SC.String.trimLeft(this,arguments)},trimRight:function(){return SC.String.trimRight(this,arguments)}})}SC.mixin(String.prototype,{loc:function(){return SC.String.loc(this.toString(),SC.$A(arguments))},locMetric:function(){return SC.String.locMetric(this.toString())},locLayout:function(a){return SC.String.locLayout(this.toString(),a)}});sc_require("system/string");SC.supplement(String.prototype,{capitalize:function(){return SC.String.capitalize(this,arguments)},camelize:function(){return SC.String.camelize(this,arguments)},decamelize:function(){return SC.String.decamelize(this,arguments)},dasherize:function(){return SC.String.dasherize(this,arguments)},loc:function(){var a=SC.$A(arguments);a.unshift(this);return SC.String.loc.apply(SC.String,a)},locWithDefault:function(b){var a=SC.$A(arguments);a.unshift(this);return SC.String.locWithDefault.apply(SC.String,a)},mult:function(a){return SC.String.mult(this,a)}});SC.ActionSupport={target:null,action:null,actionContext:null,fireAction:function(b){var c=this.get("target")||null,a=this.getPath("pane.rootResponder");if(b===undefined){b=this.get("action")}if(b&&a){return a.sendAction(b,c,this,this.get("pane"),this.get("actionContext"),this)}return false}};SC.DelegateSupport={delegateFor:function(c){var b=1,a=arguments.length,d;while(b<a){d=arguments[b];if(d&&d[c]!==undefined){return d}b++}return(this[c]!==undefined)?this:null},invokeDelegateMethod:function(c,a,b){b=SC.A(arguments);b=b.slice(2,b.length);if(!c||!c[a]){c=this}var d=c[a];return d?d.apply(c,b):null},getDelegateProperty:function(d,e){var b=1,a=arguments.length,c;while(b<a){c=arguments[b++];if(c&&c[d]!=undefined){return c.get?c.get(d):c[d]}}return(this[d]!=undefined)?this.get(d):undefined}};SC.Responder=SC.Object.extend({isResponder:YES,pane:null,responderContext:null,nextResponder:null,isFirstResponder:NO,hasFirstResponder:NO,acceptsFirstResponder:YES,becomingFirstResponder:NO,becomeFirstResponder:function(){var a=this.get("pane")||this.get("responderContext")||this.pane();if(a&&this.get("acceptsFirstResponder")){if(a.get("firstResponder")!==this){a.makeFirstResponder(this)}}return this},resignFirstResponder:function(a){var b=this.get("pane")||this.get("responderContext");if(b&&(b.get("firstResponder")===this)){b.makeFirstResponder(null,a)}return YES},willLoseFirstResponder:function(a){},didBecomeFirstResponder:function(a){}});sc_require("system/responder");SC.ResponderContext={isResponderContext:YES,trace:NO,defaultResponder:null,nextResponder:function(){return this.get("defaultResponder")}.property("defaultResponder").cacheable(),firstResponder:null,nextResponderFor:function(a){var b=a.get("nextResponder");if(typeof b===SC.T_STRING){b=SC.objectForPropertyPath(b,this)}else{if(!b&&(a!==this)){b=this}}return b},responderNameFor:function(a){if(!a){return"(No Responder)"}else{if(a._scrc_name){return a._scrc_name}}var b=this.NAMESPACE;this._findResponderNamesFor(this,3,b?[this.NAMESPACE]:[]);return a._scrc_name||a.toString()},_findResponderNamesFor:function(a,e,d){var b,c;for(b in a){if(b==="nextResponder"){continue}c=a[b];if(c&&c.isResponder){if(c._scrc_name){continue}d.push(b);c._scrc_name=d.join(".");if(e>0){this._findResponderNamesFor(c,e-1,d)}d.pop()}}},makeFirstResponder:function(b,a){var f=this.get("firstResponder"),d=this.get("nextResponder"),e=this.get("trace"),c;if(this._locked){if(e){SC.Logger.log("%@: AFTER ACTION: makeFirstResponder => %@".fmt(this,this.responderNameFor(b)))}this._pendingResponder=b;return}if(e){SC.Logger.log("%@: makeFirstResponder => %@".fmt(this,this.responderNameFor(b)))}if(b){b.set("becomingFirstResponder",YES)}this._locked=YES;this._pendingResponder=null;c=b?b:null;while(c){if(c.get("hasFirstResponder")){break}c=(c===d)?null:this.nextResponderFor(c)}if(!c){c=d}this._notifyWillLoseFirstResponder(f,f,c,a);if(f){f.set("isFirstResponder",NO)}this.beginPropertyChanges();this.set("firstResponder",b);if(b){b.set("isFirstResponder",YES)}this._notifyDidBecomeFirstResponder(b,b,c);this.endPropertyChanges();this._locked=NO;if(this._pendingResponder){this.makeFirstResponder(this._pendingResponder);this._pendingResponder=null}if(b){b.set("becomingFirstResponder",NO)}return this},_notifyWillLoseFirstResponder:function(c,e,b,a){if(!e||e===b){return}e.willLoseFirstResponder(c,a);e.set("hasFirstResponder",NO);var d=this.nextResponderFor(e);if(d){this._notifyWillLoseFirstResponder(c,d,b)}},_notifyDidBecomeFirstResponder:function(b,d,a){if(!d||d===a){return}var c=this.nextResponderFor(d);if(c){this._notifyDidBecomeFirstResponder(b,c,a)}d.set("hasFirstResponder",YES);d.didBecomeFirstResponder(b)},resetFirstResponder:function(){var a=this.get("firstResponder");if(!a){return}a.willLoseFirstResponder();a.didBecomeFirstResponder()},sendAction:function(g,d,c){var a=this.get("firstResponder"),e=this.get("nextResponder"),f=this.get("trace"),h=NO,b;this._locked=YES;if(f){SC.Logger.log("%@: begin action '%@' (%@, %@)".fmt(this,g,d,c))}if(!h&&!a&&this.tryToPerform){h=this.tryToPerform(g,d,c)}while(!h&&a){if(a.tryToPerform){h=a.tryToPerform(g,d,c)}if(!h){a=(a===e)?null:this.nextResponderFor(a)}}if(f){if(!h){SC.Logger.log("%@:  action '%@' NOT HANDLED".fmt(this,g))}else{SC.Logger.log("%@: action '%@' handled by %@".fmt(this,g,this.responderNameFor(a)))}}this._locked=NO;if(b=this._pendingResponder){this._pendingResponder=null;this.makeFirstResponder(b)}return a}};SC.bodyOverflowArbitrator=SC.Object.create({requestHidden:function(b,a){this._makeRequest(b,-1-9*!!a)},requestVisible:function(b,a){this._makeRequest(b,1+9*!!a)},withdrawRequest:function(b){if(!b){return}var a=SC.guidFor(b);if(this._requests[a]){delete this._requests[a]}this.setOverflow()},setOverflow:function(){var a=this._decideOverflow();if(a!==undefined){document.body.style.overflow=a?"auto":"hidden"}},_makeRequest:function(c,b){if(!c){return}var a=SC.guidFor(c);this._requests[a]=b;this.setOverflow()},_requests:{},_decideOverflow:function(){var a,e,c,f,b=this._requests,g;for(var d in b){if((g=b[d])<0){a=YES}if(g<-1){c=YES}if(g>0){e=YES}if(g>1){f=YES}}if(f){return YES}if(e&&c){return NO}if(e){return YES}if(a){return NO}return undefined}});SC.mixin(SC.browser,{compare:function(c,a){var f,g,e;if(typeof c==="number"||typeof a==="number"){SC.warn("SC.browser.compare(): Versions compared against Numbers may not provide accurate results.  Use a String of decimal separated Numbers instead.");c=String(c);a=String(a)}f=function(h){return Number(h.match(/^[0-9]+/))};g=SC.A(c.split(".")).map(f);e=SC.A(a.split(".")).map(f);for(var d=0;d<e.length;d++){var b=g[d]-e[d];if(isNaN(b)){return 0}if(b!==0){return b}}return 0},compareVersion:function(){SC.warn("SC.browser.compareVersion() has been deprecated.  Please use SC.browser.compare() instead.  Example: SC.browser.compareVersion(16,0,912) < 0 becomes SC.browser.compare(SC.browser.engineVersion, '16.0.912').");if(this._versionSplit===undefined){var d=function(e){return Number(e.match(/^[0-9]+/))};this._versionSplit=SC.A(this.version.split(".")).map(d)}var c=SC.A(arguments).map(Number);for(var b=0;b<c.length;b++){var a=this._versionSplit[b]-c[b];if(isNaN(a)){return 0}if(a!==0){return a}}return 0}});SC.Builder=function(a){return SC.Builder.create(a)};SC.Builder.create=function create(c){var b=SC.mixin(SC.beget(this.fn),c||{});if(c.hasOwnProperty("toString")){b.toString=c.toString}var a=function(){var d=SC.beget(b);d.defaultClass=this;d.constructor=a;return d.init.apply(d,arguments)};a.fn=a.prototype=b;a.extend=SC.Builder.create;a.mixin=SC.Builder.mixin;return a};SC.Builder.mixin=function(){var b=arguments.length,a;for(a=0;a<b;a++){SC.mixin(this,arguments[a])}return this};SC.Builder.fn={init:function(a){if(a!==undefined){if(SC.typeOf(a)===SC.T_ARRAY){var b=a.length;while(--b>=0){this[b]=a.objectAt?a.objectAt(b):a[b]}this.length=a.length}else{this[0]=a;this.length=1}}return this},size:function(){return this.length},pushStack:function(){var a=this.constructor.apply(this,arguments);a.prevObject=this;return a},end:function(){return this.prevObject||this.constructor()},toString:function(){return"%@$(%@)".fmt(this.defaultClass.toString(),SC.A(this).invoke("toString").join(","))},mixin:SC.Builder.mixin};(function(){var a=SC.Enumerable,c=SC.Builder.fn,b,d;for(b in a){if(!a.hasOwnProperty(b)){continue}d=Array.prototype[b]||a[b];c[b]=d}})();sc_require("system/builder");SC.$=SC.CoreQuery=jQuery;SC.mixin(SC.$.fn,{isCoreQuery:YES,toString:function(){var c=[],b=this.length,a=0;for(a=0;a<b;a++){c[a]="%@: %@".fmt(a,this[a]?this[a].toString():"(null)")}return"<$:%@>(%@)".fmt(SC.guidFor(this),c.join(" , "))},isVisible:function(){return Array.prototype.every.call(this,function(a){return SC.$.isVisible(a)})},view:function(){return this.map(function(){var b=null,a=SC.viewKey,d=this,c;while(!b&&d&&(d!==document)){if(d.nodeType===1&&(c=d.getAttribute("id"))){b=SC.View.views[c]}d=d.parentNode}d=null;return b})},within:function(a){if(this.filter(a).length){return true}return !!this.has(a).length}});(function(){var c={},f={find:function(h,g){return(g!==undefined)?SC.Enumerable.find.call(this,h,g):c.find.call(this,h)},filter:function(h,g){return(g!==undefined)?this.pushStack(SC.Enumerable.filter.call(this,h,g)):c.filter.call(this,h)},filterProperty:function(g,h){return this.pushStack(SC.Enumerable.filterProperty.call(this,g,h))},indexOf:SC.$.index,map:function(h,g){return(g!==undefined)?SC.Enumerable.map.call(this,h,g):c.map.call(this,h)}};var d=SC.$.fn,a=SC.Enumerable,e;for(var b in a){if(a.hasOwnProperty(b)){e=a[b];if(b in f){c[b]=d[b];e=f[b]}d[b]=e}}})();SC.mixin(SC.$,{isVisible:function(a){var b=SC.$;return("hidden"!=a.type)&&(b.css(a,"display")!="none")&&(b.css(a,"visibility")!="hidden")}});sc_require("system/core_query");SC.Event=function(d){var c,b;if(d){this.originalEvent=d;var g=SC.Event._props,f;b=g.length;c=b;while(--c>=0){f=g[c];this[f]=d[f]}}this.timeStamp=this.timeStamp||Date.now();if(!this.target){this.target=this.srcElement||document}if(this.target.nodeType===3){this.target=this.target.parentNode}if(!this.relatedTarget&&this.fromElement){this.relatedTarget=(this.fromElement===this.target)?this.toElement:this.fromElement}if(SC.none(this.pageX)&&!SC.none(this.clientX)){var h=document.documentElement,a=document.body;this.pageX=this.clientX+(h&&h.scrollLeft||a&&a.scrollLeft||0)-(h.clientLeft||0);this.pageY=this.clientY+(h&&h.scrollTop||a&&a.scrollTop||0)-(h.clientTop||0)}if(!this.which&&((this.charCode||d.charCode===0)?this.charCode:this.keyCode)){this.which=this.charCode||this.keyCode}if(!this.metaKey&&this.ctrlKey){this.metaKey=this.ctrlKey}if(!this.which&&this.button){this.which=((this.button&1)?1:((this.button&2)?3:((this.button&4)?2:0)))}if(this.type==="mousewheel"||this.type==="DOMMouseScroll"||this.type==="MozMousePixelScroll"){var e=SC.Event.MOUSE_WHEEL_MULTIPLIER;if(SC.browser.isWebkit&&d.wheelDelta!==undefined){this.wheelDelta=0-(d.wheelDeltaY||d.wheelDeltaX);this.wheelDeltaY=0-(d.wheelDeltaY||0);this.wheelDeltaX=0-(d.wheelDeltaX||0)}else{if(!SC.none(d.detail)&&SC.browser.isMozilla){if(d.axis&&(d.axis===d.HORIZONTAL_AXIS)){this.wheelDeltaX=d.detail;this.wheelDeltaY=this.wheelDelta=0}else{this.wheelDeltaY=this.wheelDelta=d.detail;this.wheelDeltaX=0}}else{this.wheelDelta=this.wheelDeltaY=SC.browser.isIE||SC.browser.isOpera?0-d.wheelDelta:d.wheelDelta;this.wheelDeltaX=0}}this.wheelDelta*=e;this.wheelDeltaX*=e;this.wheelDeltaY*=e}return this};SC.mixin(SC.Event,{MOUSE_WHEEL_MULTIPLIER:function(){var b=1,a=SC.browser.engineVersion;if(SC.browser.name===SC.BROWSER.safari){b=0.4;if(SC.browser.compare(a,"533.17")>0&&SC.browser.compare(a,"534")<0){b=0.004}else{if(SC.browser.compare(a,"533")<0){b=40}}}else{if(SC.browser.name===SC.BROWSER.ie){b=0.3}else{if(SC.browser.name===SC.BROWSER.chrome){b=0.4}}}return b}(),MOUSE_WHEEL_DELTA_LIMIT:1000,_MOUSE_WHEEL_LIMIT_INVALIDATED:NO,create:function(a){return new SC.Event(a)},add:function(f,e,g,h,d,a){if(f&&f.isCoreQuery){if(f.length>0){f.forEach(function(j){this.add(j,e,g,h,d)},this);return this}else{f=f[0]}}if(!f){return this}if(!a){a=NO}if(f.nodeType===3||f.nodeType===8){return SC.Event}if(SC.browser.name===SC.BROWSER.ie&&f.setInterval){f=window}if(SC.typeOf(g)===SC.T_FUNCTION){d=h;h=g;g=null}else{if(g&&SC.typeOf(h)===SC.T_STRING){h=g[h]}}var c=SC.data(f,"sc_events")||SC.data(f,"sc_events",{}),b=c[e];if(!b){b=c[e]={};this._addEventListener(f,e,a)}b[SC.hashFor(g,h)]=[g,h,d];SC.Event._global[e]=YES;f=c=b=null;return this},remove:function(f,e,g,h){if(f&&f.isCoreQuery){if(f.length>0){f.forEach(function(j){this.remove(j,e,g,h)},this);return this}else{f=f[0]}}if(!f){return this}if(f.nodeType===3||f.nodeType===8){return SC.Event}var a,d,c=SC.data(f,"sc_events");if(!c){return this}if(e===undefined){for(e in c){this.remove(f,e)}}else{if(a=c[e]){var b=NO;if(g||h){if(SC.typeOf(g)===SC.T_FUNCTION){h=g;g=null}else{if(SC.typeOf(h)===SC.T_STRING){h=g[h]}}delete a[SC.hashFor(g,h)];d=null;for(d in a){break}if(d===null){b=YES}}else{b=YES}if(b){delete c[e];this._removeEventListener(f,e)}d=null;for(d in c){break}if(!d){SC.removeData(f,"sc_events");delete this._elements[SC.guidFor(f)]}}}f=c=a=null;return this},NO_BUBBLE:["blur","focus","change"],simulateEvent:function(d,c,b){var a=SC.Event.create({type:c,target:d,preventDefault:function(){this.cancelled=YES},stopPropagation:function(){this.bubbles=NO},allowDefault:function(){this.hasCustomEventHandling=YES},timeStamp:Date.now(),bubbles:(this.NO_BUBBLE.indexOf(c)<0),cancelled:NO,normalized:YES});if(b){SC.mixin(a,b)}return a},trigger:function(c,b,j,k){if(c&&c.isCoreQuery){if(c.length>0){c.forEach(function(n){this.trigger(n,b,j,k)},this);return this}else{c=c[0]}}if(!c){return this}if(c.nodeType===3||c.nodeType===8){return undefined}j=SC.A(j);var h,l=SC.typeOf(c[b]||null)===SC.T_FUNCTION,a,g,d,m;a=j[0];if(!a||!a.preventDefault){a=this.simulateEvent(c,b);j.unshift(a)}a.type=b;g=c;do{h=SC.Event.handle.apply(g,j);g=(g===document)?null:(g.parentNode||document)}while(!h&&a.bubbles&&g);g=null;d=c["on"+b];m=SC.$.nodeName(c,"a")&&b==="click";if((!l||m)&&d&&d.apply(c,j)===NO){h=NO}if(l&&k!==NO&&h!==NO&&!m){this.triggered=YES;try{c[b]()}catch(f){}}this.triggered=NO;return h},handle:function(b){if((typeof SC==="undefined")||SC.Event.triggered){return YES}var c,g,e,j,d,h,k,l,a,f;h=SC.A(arguments);h[0]=b=SC.Event.normalizeEvent(b||window.event);d=(SC.data(this,"sc_events")||{})[b.type];if(!d){return NO}for(k in d){l=d[k];a=l[1];b.handler=a;b.data=b.context=l[2];f=l[0]||this;g=a.apply(f,h);if(c!==NO){c=g}if(g===NO){b.preventDefault();b.stopPropagation()}}return c},unload:function(){var a,b=this._elements;for(a in b){this.remove(b[a])}for(a in b){delete b[a]}delete this._elements},special:{ready:{setup:function(){SC._bindReady();return},teardown:function(){return}},mouseenter:{setup:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.add(this,"mouseover",SC.Event.special.mouseenter.handler);return YES},teardown:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.remove(this,"mouseover",SC.Event.special.mouseenter.handler);return YES},handler:function(a){if(SC.Event._withinElement(a,this)){return YES}a.type="mouseenter";return SC.Event.handle.apply(this,arguments)}},mouseleave:{setup:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.add(this,"mouseout",SC.Event.special.mouseleave.handler);return YES},teardown:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.remove(this,"mouseout",SC.Event.special.mouseleave.handler);return YES},handler:function(a){if(SC.Event._withinElement(a,this)){return YES}a.type="mouseleave";return SC.Event.handle.apply(this,arguments)}}},KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,_withinElement:function(d,c){var b=d.relatedTarget;while(b&&b!==c){try{b=b.parentNode}catch(a){b=c}}return b===c},_addEventListener:function(e,d,a){var f,c=this.special[d];if(!a){a=NO}if(!c||c.setup.call(e)===NO){var b=SC.guidFor(e);this._elements[b]=e;f=SC.data(e,"listener")||SC.data(e,"listener",function(){return SC.Event.handle.apply(SC.Event._elements[b],arguments)});if(e.addEventListener){e.addEventListener(d,f,a)}else{if(e.attachEvent){e.attachEvent("on"+d,f)}}}e=c=f=null},_removeEventListener:function(c,b){var d,a=SC.Event.special[b];if(!a||(a.teardown.call(c)===NO)){d=SC.data(c,"listener");if(d){if(c.removeEventListener){c.removeEventListener(b,d,NO)}else{if(c.detachEvent){c.detachEvent("on"+b,d)}}}}c=a=d=null},_elements:{},normalizeEvent:function(a){if(a===window.event){return SC.Event.create(a)}else{return a.normalized?a:SC.Event.create(a)}},_global:{},_props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target timeStamp toElement type view which touches targetTouches changedTouches animationName elapsedTime dataTransfer".split(" ")});SC.Event.prototype={hasCustomEventHandling:NO,touchesForView:function(a){if(this.touchContext){return this.touchContext.touchesForView(a)}},touchesForResponder:function(a){if(this.touchContext){return this.touchContext.touchesForView(a)}},averagedTouchesForView:function(a){if(this.touchContext){return this.touchContext.averagedTouchesForView(a)}return null},allowDefault:function(){this.hasCustomEventHandling=YES;return this},preventDefault:function(){var a=this.originalEvent;if(a){if(a.preventDefault){a.preventDefault()}a.returnValue=NO}this.hasCustomEventHandling=YES;return this},stopPropagation:function(){var a=this.originalEvent;if(a){if(a.stopPropagation){a.stopPropagation()}a.cancelBubble=YES}this.hasCustomEventHandling=YES;return this},stop:function(){return this.preventDefault().stopPropagation()},normalized:YES,getCharString:function(){if(SC.browser.name===SC.BROWSER.ie&&SC.browser.compare(SC.browser.version,"9.0")<0){if(this.keyCode==8||this.keyCode==9||(this.keyCode>=37&&this.keyCode<=40)){return String.fromCharCode(0)}else{return(this.keyCode>0)?String.fromCharCode(this.keyCode):null}}else{return(this.charCode>0)?String.fromCharCode(this.charCode):null}},commandCodes:function(){var e=this.keyCode,b=null,c=null,a="",d;if(e&&e!==this.charCode){b=SC.FUNCTION_KEYS[e];if(!b&&(this.altKey||this.ctrlKey||this.metaKey)){b=SC.PRINTABLE_KEYS[e]}if(b){if(this.altKey){a+="alt_"}if(this.ctrlKey||this.metaKey){a+="ctrl_"}if(this.shiftKey){a+="shift_"}}}if(!b){e=this.which;c=b=String.fromCharCode(e);d=b.toLowerCase();if(this.metaKey){a="meta_";b=d}else{b=null}}if(b){b=a+b}return[b,c]}};SC.Event.observe=SC.Event.add;SC.Event.stopObserving=SC.Event.remove;SC.Event.fire=SC.Event.trigger;if(SC.browser.name===SC.BROWSER.ie){SC.Event.add(window,"unload",SC.Event.prototype,SC.Event.unload)}SC.MODIFIER_KEYS={16:"shift",17:"ctrl",18:"alt"};SC.FUNCTION_KEYS={8:"backspace",9:"tab",13:"return",19:"pause",27:"escape",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"printscreen",45:"insert",46:"delete",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock"};SC.PRINTABLE_KEYS={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:'"'};SC.SYSTEM_CURSOR="default";SC.AUTO_CURSOR=SC.DEFAULT_CURSOR="auto";SC.CROSSHAIR_CURSOR="crosshair";SC.HAND_CURSOR=SC.POINTER_CURSOR="pointer";SC.MOVE_CURSOR="move";SC.E_RESIZE_CURSOR="e-resize";SC.NE_RESIZE_CURSOR="ne-resize";SC.NW_RESIZE_CURSOR="nw-resize";SC.N_RESIZE_CURSOR="n-resize";SC.SE_RESIZE_CURSOR="se-resize";SC.SW_RESIZE_CURSOR="sw-resize";SC.S_RESIZE_CURSOR="s-resize";SC.W_RESIZE_CURSOR="w-resize";SC.IBEAM_CURSOR=SC.TEXT_CURSOR="text";SC.WAIT_CURSOR="wait";SC.HELP_CURSOR="help";SC.Cursor=SC.Object.extend({init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("cursorStyle")||SC.DEFAULT_CURSOR,c=this.constructor.sharedStyleSheet(),b=SC.guidFor(this);if(c.insertRule){c.insertRule("."+b+" {cursor: "+a+";}",c.cssRules?c.cssRules.length:0)}else{if(c.addRule){c.addRule("."+b,"cursor: "+a)}}this.cursorStyle=a;this.className=b;return this},className:null,cursorStyle:SC.DEFAULT_CURSOR,cursorStyleDidChange:function(){var d,f,c,e,g,b,a;d=this.get("cursorStyle")||SC.DEFAULT_CURSOR;f=this._rule;if(f){f.style.cursor=d;return}c="."+this.get("className");e=this.constructor.sharedStyleSheet();g=(e.cssRules?e.cssRules:e.rules)||[];for(b=0,a=g.length;b<a;++b){f=g[b];if(f.selectorText===c){this._rule=f;f.style.cursor=d;break}}}.observes("cursorStyle")});SC.Cursor.sharedStyleSheet=function(){var b,a=this._styleSheet;if(!a){a=document.createElement("style");a.type="text/css";b=document.getElementsByTagName("head")[0];if(!b){b=document.documentElement}b.appendChild(a);a=document.styleSheets[document.styleSheets.length-1];this._styleSheet=a}return a};SC.Theme={isTheme:YES,classNames:SC.CoreSet.create(),_extend_class_names:function(b){if(b){if(SC.typeOf(b)===SC.T_HASH&&!b.isSet){for(var a in b){if(b[a]){this.classNames.add(a)}else{this.classNames.remove(a)}}}else{if(typeof b==="string"){this.classNames.addEach(b.split(" "))}else{this.classNames.addEach(b)}}}},_extend_self:function(b){if(b.classNames){this._extend_class_names(b.classNames)}var a,c,d;for(a in b){if(a==="classNames"){continue}if(!b.hasOwnProperty(a)){continue}c=b[a];if(c instanceof Function&&!c.base&&(c!==(d=this[a]))){c.base=d}this[a]=c}},create:function(){var c=SC.beget(this);c.baseTheme=this;if(this.themes===SC.Theme.themes){c.themes={}}else{c.themes=SC.beget(this.themes)}c._privateThemes={};c._specializedThemes={};c.classNames=SC.clone(this.classNames);var e=arguments,b=e.length,a,d;for(a=0;a<b;a++){c._extend_self(e[a])}if(c.name){c.classNames.add(c.name)}return c},subtheme:function(a){var b=this.create({name:a});this.addTheme(b);return b},invisibleSubtheme:function(a){var b=this.create({name:a});this._privateThemes[a]=b;return b},themes:{},find:function(a){if(this===SC.Theme){return this.themes[a]}var b;b=this._privateThemes[a];if(b){return b}b=this._specializedThemes[a];if(b){return b}b=this.themes[a];if(b&&!this._specializedThemes[a]){return(this._specializedThemes[a]=b.create({classNames:this.classNames}))}b=SC.Theme.themes[a];if(b){return b}return null},addTheme:function(a){this.themes[a.name]=a}};SC.BaseTheme=SC.Theme.create({name:""});SC.Theme.themes["sc-base"]=SC.BaseTheme;SC.defaultTheme="sc-base";sc_require("mixins/delegate_support");SC.CoreView=SC.Responder.extend(SC.DelegateSupport);sc_require("system/browser");sc_require("system/event");sc_require("system/cursor");sc_require("system/responder");sc_require("system/theme");sc_require("system/string");sc_require("views/view/base");SC.CONTEXT_MENU_ENABLED=YES;SC.TABBING_ONLY_INSIDE_DOCUMENT=NO;SC.FROM_THEME="__FROM_THEME__";SC.EMPTY_CHILD_VIEWS_ARRAY=[];SC.EMPTY_CHILD_VIEWS_ARRAY.needsClone=YES;SC.CoreView.reopen({concatenatedProperties:["outlets","displayProperties","classNames","renderMixin","didCreateLayerMixin","willDestroyLayerMixin","classNameBindings","attributeBindings"],ariaRole:null,ariaHidden:null,pane:function(){var a=this;while(a&&!a.isPane){a=a.get("parentView")}return a}.property("parentView").cacheable(),page:null,parentView:null,isVisible:YES,isVisibleBindingDefault:SC.Binding.bool(),isVisibleInWindow:YES,childViews:SC.EMPTY_CHILD_VIEWS_ARRAY,layer:function(a,c){if(c!==undefined){this._view_layer=c}else{c=this._view_layer;if(!c){var b=this.get("parentView");if(b){b=b.get("layer")}this._view_layer=c=this.findLayerInParentLayer(b)}}return c}.property("isVisibleInWindow").cacheable(),$:function(b){var a=this.get("layer");if(!a){return SC.$()}else{if(b===undefined){return SC.$(a)}else{return SC.$(b,a)}}},containerLayer:function(){return this.get("layer")}.property("layer").cacheable(),layerId:function(a,b){if(b){this._layerId=b}if(this._layerId){return this._layerId}return SC.guidFor(this)}.property().cacheable(),findLayerInParentLayer:function(a){var b="#"+this.get("layerId");return jQuery(b,a)[0]||jQuery(b)[0]},isDescendantOf:function(a){var b=this.get("parentView");if(this===a){return YES}else{if(b){return b.isDescendantOf(a)}else{return NO}}},displayDidChange:function(){this.set("layerNeedsUpdate",YES);return this},_sc_isVisibleDidChange:function(){this.displayDidChange()}.observes("isVisible"),layerNeedsUpdate:NO,_view_layerNeedsUpdateDidChange:function(){if(this.get("layerNeedsUpdate")){this.invokeOnce(this.updateLayerIfNeeded)}}.observes("layerNeedsUpdate"),updateLayerIfNeeded:function(b){var c=this.get("layerNeedsUpdate"),a=c&&(b||this.get("isVisibleInWindow"));if(a){if(this.get("layer")){this.beginPropertyChanges();this.set("layerNeedsUpdate",NO);this.updateLayer();this.endPropertyChanges()}}return this},updateLayer:function(f){var c,b,a,d;var e=f||this.renderContext(this.get("layer"));this._renderLayerSettings(e,NO);d=!this.update;if(d){this.render(e,NO)}else{this.update(e.$())}if(c=this.renderMixin){a=c.length;for(b=0;b<a;++b){c[b].call(this,e,NO)}}e.update();if(e._innerHTMLReplaced){var g=this.get("pane");if(g&&g.get("isPaneAttached")){this._notifyDidAppendToDocument()}}if(this.useStaticLayout){this.viewDidResize()}if(this.didUpdateLayer){this.didUpdateLayer()}if(this.designer&&this.designer.viewDidUpdateLayer){this.designer.viewDidUpdateLayer()}return this},parentViewDidResize:function(){if(!this.get("hasLayout")){this.notifyPropertyChange("frame")}this.viewDidResize()},viewDidResize:function(){},renderContext:function(a){return SC.RenderContext(a)},createLayer:function(){if(this.get("layer")){return this}var a=this.renderContext(this.get("tagName"));this.renderToContext(a);this.set("layer",a.element());this._notifyDidCreateLayer();return this},_notifyDidCreateLayer:function(){this.notifyPropertyChange("layer");if(this.get("useStaticLayout")){this.viewDidResize()}if(this.didCreateLayer){this.didCreateLayer()}var c=this.didCreateLayerMixin,b,a,d=this.get("childViews"),e;if(c){b=c.length;for(a=0;a<b;++a){c[a].call(this)}}b=d.length;for(a=0;a<b;++a){e=d[a];if(!e){continue}e.notifyPropertyChange("layer");if(this.get("useStaticLayout")){if(!e.get("isFixedLayout")){e.viewDidResize()}}e._notifyDidCreateLayer()}},destroyLayer:function(){var a=this.get("layer");if(a){this._notifyWillDestroyLayer();if(a.parentNode){a.parentNode.removeChild(a)}a=null}return this},replaceLayer:function(){this.destroyLayer();this.set("layerLocationNeedsUpdate",YES);this.invokeOnce(this.updateLayerLocationIfNeeded)},parentViewDidChange:function(){this.parentViewDidResize();this.updateLayerLocation()},layerLocationNeedsUpdate:NO,updateLayerLocationIfNeeded:function(a){if(this.get("layerLocationNeedsUpdate")){this.updateLayerLocation()}return this},updateLayerLocation:function(){var e=this.get("layer"),d=this.get("parentView"),b=d?d.get("containerLayer"):null;if(e&&e.parentNode&&e.parentNode!==b){e.parentNode.removeChild(e)}if(!d){if(e&&e.parentNode){e.parentNode.removeChild(e)}}else{if(!b){if(e){if(e.parentNode){e.parentNode.removeChild(e)}this.destroyLayer()}}else{if(!e){this.createLayer();e=this.get("layer");if(!e){return}}var f=d.get("childViews"),c=f.objectAt(f.indexOf(this)+1),a=(c)?c.get("layer"):null;if(c&&(!a||a.parentNode!==b)){c.updateLayerLocationIfNeeded();a=c.get("layer")||null}if((e.parentNode!==b)||(e.nextSibling!==a)){b.insertBefore(e,a)}}}b=d=e=a=null;this.set("layerLocationNeedsUpdate",NO);return this},_notifyWillDestroyLayer:function(){if(this.willDestroyLayer){this.willDestroyLayer()}var c=this.willDestroyLayerMixin,b,a,d=this.get("childViews");if(c){b=c.length;for(a=0;a<b;++a){c[a].call(this)}}b=d.length;for(a=0;a<b;++a){d[a]._notifyWillDestroyLayer()}this.set("layer",null)},renderToContext:function(e,f){var d,c,b,a;this.beginPropertyChanges();this.set("layerNeedsUpdate",NO);if(SC.none(f)){f=YES}this._renderLayerSettings(e,f);d=!this.update;if(d){this.render(e,f)}else{if(f){this.render(e)}else{this.update(e.$())}}if(f&&!this._didRenderChildViews){this.renderChildViews(e,f)}this._didRenderChildViews=NO;if(c=this.renderMixin){a=c.length;for(b=0;b<a;++b){c[b].call(this,e,f)}}this.endPropertyChanges()},_renderLayerSettings:function(a,b){a.resetClassNames();a.resetStyles();this.applyAttributesToContext(a)},applyAttributesToContext:function(a){if(!this.get("layer")){this._applyClassNameBindings();this._applyAttributeBindings(a)}a.addClass(this.get("classNames"));if(this.get("isTextSelectable")){a.addClass("allow-select")}if(!this.get("isVisible")){a.addClass("sc-hidden")}if(this.get("isFirstResponder")){a.addClass("focus")}a.id(this.get("layerId"));a.attr("role",this.get("ariaRole"));var b=this.get("ariaHidden");if(b!==null){if(b===NO){a.removeAttr("aria-hidden")}else{a.attr("aria-hidden",b)}}},_applyClassNameBindings:function(){var a=this.get("classNameBindings"),b=this.get("classNames"),c;if(!a){return}a.forEach(function(f){var e;var d=function(){var h=this._classStringForProperty(f);var g=this.$();if(e){g.removeClass(e);b.removeObject(e)}if(h){g.addClass(h);b.push(h);e=h}else{e=null}};this.addObserver(f.split(":")[0],this,d);c=this._classStringForProperty(f);if(c){b.push(c);e=c}},this)},_applyAttributeBindings:function(a){var e=this.get("attributeBindings"),c,d,b;if(!e){return}e.forEach(function(g){var f=function(){d=this.$();var h=d.attr(g);c=this.get(g);b=typeof c;if((b==="string"||b==="number")&&c!==h){d.attr(g,c)}else{if(c&&b==="boolean"){d.attr(g,g)}else{if(c===NO){d.removeAttr(g)}}}};this.addObserver(g,this,f);c=this.get(g);b=typeof c;if(b==="string"||b==="number"){a.attr(g,c)}else{if(c&&b==="boolean"){a.attr(g,g)}}},this)},_classStringForProperty:function(c){var a=c.split(":"),b=a[1];c=a[0];var d=SC.getPath(this,c);if(d===YES){if(b){return b}return SC.String.dasherize(c.split(".").get("lastObject"))}else{if(d!==NO&&d!==undefined&&d!==null){return d}else{return null}}},prepareContext:function(a,b){if(b!==false){b=YES}if(b){this.renderToContext(a)}else{this.updateLayer(a)}},renderChildViews:function(e,f){var d=this.get("childViews"),b=d.length,a,c;for(a=0;a<b;++a){c=d[a];if(!c){continue}e=e.begin(c.get("tagName"));c.renderToContext(e,f);e=e.end()}this._didRenderChildViews=YES;return e},render:function(){},_notifyDidAppendToDocument:function(){if(!this.get("hasLayout")){this.notifyPropertyChange("frame")}if(this.didAppendToDocument){this.didAppendToDocument()}var c=0,d,a,b=this.get("childViews");for(c=0,a=b.length;c<a;c++){d=b[c];if(d._notifyDidAppendToDocument){d._notifyDidAppendToDocument()}}},childViewsObserver:function(){var c=this.get("childViews"),b,a,d;for(b=0,a=c.length;b<a;b++){d=c[b];if(d._notifyDidAppendToDocument){d._notifyDidAppendToDocument()}}}.observes("childViews"),attributeBindings:null,tagName:"div",classNames:[],classNameBindings:null,toolTip:null,displayToolTip:function(){var a=this.get("toolTip");return(a&&this.get("localize"))?SC.String.loc(a):(a||"")}.property("toolTip","localize").cacheable(),isTextSelectable:NO,displayProperties:["ariaHidden"],nextResponder:function(){return this.get("parentView")}.property("parentView").cacheable(),acceptsFirstResponder:NO,init:function(){var e=this.get("parentView"),g,b,d,f;arguments.callee.base.apply(this,arguments);SC.View.views[this.get("layerId")]=this;this.classNames=this.get("classNames").slice();this.childViews=this.get("childViews").slice();this.createChildViews();f=this.get("displayProperties");for(var c=0,a=f.length;c<a;c++){this.addObserver(f[c],this,this.displayDidChange)}},awake:function(){arguments.callee.base.apply(this,arguments);var c=this.get("childViews"),b=c.length,a;for(a=0;a<b;++a){if(!c[a]){continue}c[a].awake()}},frame:function(){return this.computeFrameWithParentFrame(null)}.property("useStaticLayout").cacheable(),computeFrameWithParentFrame:function(){var a,b=this.get("parentView"),c;if(a=this.get("layer")){c=SC.offset(a);if(b){c=b.convertFrameFromView(c,null)}c.width=a.offsetWidth;c.height=a.offsetHeight;return c}if(this.get("hasLayout")){return null}else{return{x:0,y:0,width:0,height:0}}},clippingFrame:function(){var d=this.get("frame"),a=d,b,c;if(!d){return null}b=this.get("parentView");if(b){c=b.get("clippingFrame");if(!c){return{x:0,y:0,width:d.width,height:d.height}}a=SC.intersectRects(c,d)}a.x-=d.x;a.y-=d.y;return a}.property("parentView","frame").cacheable(),_sc_view_clippingFrameDidChange:function(){var d=this.get("childViews"),b=d.length,a,c;for(a=0;a<b;++a){c=d[a];c.notifyPropertyChange("clippingFrame");c._sc_view_clippingFrameDidChange()}},removeChild:function(b){b.set("parentView",null);var c=this.get("childViews"),a=c.indexOf(b);if(a>=0){c.removeAt(a)}return this},removeAllChildren:function(){var b=this.get("childViews"),a;while(a=b.objectAt(b.get("length")-1)){this.removeChild(a)}return this},removeFromParent:function(){var a=this.get("parentView");if(a){a.removeChild(this)}return this},destroy:function(){if(this.get("isDestroyed")){return this}this._destroy();return arguments.callee.base.apply(this,arguments)},_destroy:function(){this.destroyLayer();var c=this.get("childViews"),b=c.length,a;if(b){c=c.slice();for(a=0;a<b;++a){c[a].destroy()}}delete SC.View.views[this.get("layerId")];delete this._CQ;delete this.page;if(this.get("parentView")){this.removeFromParent()}this.set("owner",null);return this},createChildViews:function(){var f=this.get("childViews"),b=f.length,a,e,d,c;this.beginPropertyChanges();for(a=0;a<b;++a){if(e=(c=f[a])){if(typeof e===SC.T_STRING){c=this[e]}else{e=null}if(!c){SC.Logger.error("No view with name "+e+" has been found in "+this.toString());continue}c=this.createChildView(c);if(e){this[e]=c}}f[a]=c}this.endPropertyChanges();return this},createChildView:function(a,b){if(!a.isClass){b=a}else{if(!b){b={}}else{b=SC.clone(b)}}b.owner=b.parentView=this;if(a.isClass&&a.prototype.hasVisibility){b.isVisibleInWindow=this.get("isVisibleInWindow")}if(!b.page){b.page=this.page}if(a.isClass){a=a.create(b)}return a},isView:YES,selectStart:function(a){return this.get("isTextSelectable")},contextMenu:function(a){if(this.get("isContextMenuEnabled")){a.allowDefault();return YES}}});SC.CoreView.mixin({isViewClass:YES,design:function(){if(this.isDesign){return this}var a=this.extend.apply(this,arguments);a.isDesign=YES;if(SC.ViewDesigner){SC.ViewDesigner.didLoadDesign(a,this,SC.A(arguments))}return a},extend:function(){var a=arguments[arguments.length-1];if(a&&!SC.none(a.theme)){a.themeName=a.theme;delete a.theme}return SC.Object.extend.apply(this,arguments)},layout:function(a){this.prototype.layout=a;return this},classNames:function(a){a=(this.prototype.classNames||[]).concat(a);this.prototype.classNames=a;return this},tagName:function(a){this.prototype.tagName=a;return this},childView:function(a){var b=this.prototype.childViews||[];if(b===this.superclass.prototype.childViews){b=b.slice()}b.push(a);this.prototype.childViews=b;return this},bind:function(b,d){var c=this.prototype,a=this.superclass.prototype;var e=c._bindings;if(!e||e===a._bindings){e=c._bindings=(e||[]).slice()}b=b+"Binding";c[b]=d;e.push(b);return this},prop:function(a,b){this.prototype[a]=b;return this},localization:function(b,a){if(a){b.rootElement=SC.$(a)[0]}return b},viewFor:function(d,c){var b=SC.$A(arguments);if(SC.none(d)){b.shift()}else{b[0]={rootElement:SC.$(d)[0]}}var a=this.create.apply(this,arguments);b=b[0]=null;return a},create:function(){var b=arguments[arguments.length-1];if(b&&b.theme){b.themeName=b.theme;delete b.theme}var c=this,a=new c(arguments);if(SC.ViewDesigner){SC.ViewDesigner.didCreateView(a,SC.$A(arguments))}return a},loc:function(e){var b=e.childViews;delete e.childViews;this.applyLocalizedAttributes(e);if(SC.ViewDesigner){SC.ViewDesigner.didLoadLocalization(this,SC.$A(arguments))}var d=this.prototype.childViews,a=d.length,c;while(--a>=0){c=d[a];e=b[a];if(e&&c&&typeof c===SC.T_STRING){SC.String.loc(c,e)}}return this},applyLocalizedAttributes:function(a){SC.mixin(this.prototype,a)},views:{}});SC.outlet=function(b,a){return function(c){return(this[c]=SC.objectForPropertyPath(b,(a!==undefined)?a:this))}.property()};SC.CoreView.unload=function(){var a=SC.View.views;if(a){for(var b in a){if(!a.hasOwnProperty(b)){continue}delete a[b]}}};SC.View=SC.CoreView.extend({classNames:["sc-view"],displayProperties:["isFirstResponder"]});if(SC.browser.isIE){SC.Event.add(window,"unload",SC.View,SC.View.unload)}sc_require("views/view");sc_require("views/view/layout_style");SC.ANIMATABLE_PROPERTIES={top:YES,left:YES,bottom:YES,right:YES,width:YES,height:YES,centerX:YES,centerY:YES,opacity:YES,scale:YES,rotate:YES,rotateX:YES,rotateY:YES,rotateZ:YES};SC.View.reopen({didCreateLayerMixin:function(){if(SC.platform.supportsCSSTransitions){this.resetAnimation()}},animate:function(p,l,d,o){var f,q;if(typeof p===SC.T_STRING){f={};f[p]=l;q=d}else{f=p;q=l;o=d}var c=SC.typeOf(q);if(c===SC.T_NUMBER){q={duration:q}}else{if(c!==SC.T_HASH){throw"Must provide options hash or duration!"}}if(o){q.callback=o}else{if(q.callback){o=q.callback}}if(q.duration===0){var j=this.adjust(f);if(o){this.layoutStyleCalculator.invokeOnceLater("runAnimationCallback",1,o,null,NO)}return j}var a=q.timing;if(a){if(typeof a!==SC.T_STRING){q.timing="cubic-bezier("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}}else{q.timing="linear"}var g=SC.clone(this.get("layout")),h=NO,k,n,b,e,m;if(!g.animate){g.animate={}}for(m in f){if(!f.hasOwnProperty(m)||!SC.ANIMATABLE_PROPERTIES[m]){continue}k=f[m];n=g[m];e=g.animate[m];if(SC.none(k)){throw"Can only animate to an actual value!"}if(n!==k||(e&&e.duration!==q.duration)){h=YES;g.animate[m]=q;g[m]=k}}if(h){this.set("layout",g)}else{if(o){this.layoutStyleCalculator.invokeOnceLater("runAnimationCallback",1,o,null,NO)}}return this},resetAnimation:function(){var c=this.get("layout"),e=c.animate,d=NO,b;if(!e){return}var a;for(b in e){d=YES;delete e[b]}if(d){this.set("layout",c);this.notifyPropertyChange("layout")}return this},transitionDidEnd:function(a){this.get("layoutStyleCalculator").transitionDidEnd(a)}});sc_require("ext/string");sc_require("views/view");sc_require("views/view/animation");SC.CSS_TRANSFORM_MAP={rotate:function(a){return null},rotateX:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateX("+a+")"},rotateY:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateY("+a+")"},rotateZ:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateZ("+a+")"},scale:function(a){if(SC.typeOf(a)===SC.T_ARRAY){a=a.join(", ")}return"scale("+a+")"}};SC.View.reopen({layoutStyleCalculator:null,layoutStyle:function(){var a={layout:this.get("layout"),turbo:this.get("hasAcceleratedLayer"),staticLayout:this.get("useStaticLayout")};var b=this.get("layoutStyleCalculator");b.set(a);return b.calculate()}.property().cacheable()});SC.View.LayoutStyleCalculator=SC.Object.extend({_layoutDidUpdate:function(){var g=this.get("layout");if(!g){return}this.dims=SC._VIEW_DEFAULT_DIMS;this.loc=this.dims.length;var o=(this.right=g.right);this.hasRight=(o!=null);var c=(this.left=g.left);this.hasLeft=(c!=null);var k=(this.top=g.top);this.hasTop=(k!=null);var a=(this.bottom=g.bottom);this.hasBottom=(a!=null);var b=(this.width=g.width);this.hasWidth=(b!=null);var p=(this.height=g.height);this.hasHeight=(p!=null);this.minWidth=((g.minWidth===undefined)?null:g.minWidth);var n=(this.maxWidth=(g.maxWidth===undefined)?null:g.maxWidth);this.hasMaxWidth=(n!=null);this.minHeight=(g.minHeight===undefined)?null:g.minHeight;var m=(this.maxHeight=(g.maxHeight===undefined)?null:g.maxHeight);this.hasMaxHeight=(m!=null);var f=(this.centerX=g.centerX);this.hasCenterX=(f!=null);var e=(this.centerY=g.centerY);this.hasCenterY=(e!=null);var d=(this.borderTop=((g.borderTop!==undefined)?g.borderTop:g.border)||0);var l=(this.borderRight=((g.borderRight!==undefined)?g.borderRight:g.border)||0);var j=(this.borderBottom=((g.borderBottom!==undefined)?g.borderBottom:g.border)||0);var h=(this.borderLeft=((g.borderLeft!==undefined)?g.borderLeft:g.border)||0);this.zIndex=(g.zIndex!=null)?g.zIndex.toString():null;this.opacity=(g.opacity!=null)?g.opacity.toString():null;this.backgroundPosition=(g.backgroundPosition!=null)?g.backgroundPosition:null;this.ret={marginTop:null,marginLeft:null}}.observes("layout"),_invalidAutoValue:function(b){var a=SC.Error.desc("%@.layout() you cannot use %@:auto if staticLayout is disabled".fmt(this.get("view"),b),"%@".fmt(this.get("view")),-1);SC.Logger.error(a.toString());throw a},_handleMistakes:function(){var c=this.get("layout");if(!this.staticLayout){if(this.width===SC.LAYOUT_AUTO){this._invalidAutoValue("width")}if(this.height===SC.LAYOUT_AUTO){this._invalidAutoValue("height")}}if(SC.platform.supportsCSSTransforms){var d=c.animate,a,b;if(d){for(b in d){if(SC.CSS_TRANSFORM_MAP[b]){if(this._pendingAnimations&&this._pendingAnimations["-"+SC.platform.cssPrefix+"-transform"]){throw"Animations of transforms must be executed simultaneously!"}if(a&&d[b].duration!==a){SC.Logger.warn("Can't animate transforms with different durations! Using first duration specified.");d[b].duration=a}a=d[b].duration}}}}},_calculatePosition:function(o){var g=null,a=this.get("turbo"),t=this.ret;var d,l,k,c,j,n,b,f,e,m,s,h,p,q;if(o==="x"){d="left";l="right";k="width";c="maxWidth";j="marginLeft";m="borderLeft";h="borderRight";n=this.hasLeft;b=this.hasRight;f=this.hasWidth;e=this.hasMaxWidth}else{d="top";l="bottom";k="height";c="maxHeight";j="marginTop";m="borderTop";h="borderBottom";n=this.hasTop;b=this.hasBottom;f=this.hasHeight;e=this.hasMaxHeight}t[d]=this._cssNumber(this[d]);t[l]=this._cssNumber(this[l]);s=this._cssNumber(this[m]);p=this._cssNumber(this[h]);t[m+"Width"]=s||null;t[h+"Width"]=p||null;q=this[k];if(q>=1){q-=(s+p)}t[k]=this._cssNumber(q);if(n){if(a){g=t[d];t[d]=0}if(b&&f){t[l]=null}}else{if(!b||(b&&!f&&!e)){t[d]=0}}if(!f&&!b){t[l]=0}return g},_calculateCenter:function(o){var j=this.ret,s,a,c,p,f,g,m,n,e;if(o==="x"){s="width";a="centerX";c="left";p="right";f="marginLeft";g="borderLeft";n="borderRight"}else{s="height";a="centerY";c="top";p="bottom";f="marginTop";g="borderTop";n="borderBottom"}j[c]="50%";m=this._cssNumber(this[g]);e=this._cssNumber(this[n]);j[g+"Width"]=m||null;j[n+"Width"]=e||null;var l=this[s],k=this[a],b=this[c];var h=SC.isPercentage(l),d=SC.isPercentage(k,YES);if(l>1){l-=(m+e)}if((h&&d)||(!h&&!d)){var q=k-l/2;j[f]=(h)?Math.floor(q*100)+"%":Math.floor(q)}else{SC.Logger.warn("You have to set "+s+" and "+a+" using both percentages or pixels");j[f]="50%"}j[s]=this._cssNumber(l)||0;j[p]=null},_calculateTransforms:function(e,h){if(SC.platform.supportsCSSTransforms){var g=this.get("layout");var b=SC.platform.domCSSPrefix+"Transform";var d=[];if(this.turbo){d.push("translateX("+(e||0)+"px)","translateY("+(h||0)+"px)");if(SC.platform.supportsCSS3DTransforms){d.push("translateZ(0px)")}}var f=SC.CSS_TRANSFORM_MAP;for(var a in f){var c=g[a];if(c!=null){d.push(f[a](c))}}this.ret[b]=d.length>0?d.join(" "):null}},_calculateAnimations:function(e,c){var d=this.layout,h=d.animate,g;if(!h){return}if(this.getPath("view.isAnimatable")){return}var f=[],b;this._animatedTransforms=[];if(!this._pendingAnimations){this._pendingAnimations={}}var j="-"+SC.platform.cssPrefix+"-transform";if(SC.platform.supportsCSSTransitions){for(g in h){b=h[g];var k=SC.CSS_TRANSFORM_MAP[g];var a=(g==="top"&&c!=null)||(g==="left"&&e!=null);if(SC.platform.supportsCSSTransforms&&(a||k)){this._animatedTransforms.push(g);g=j}b.css=g+" "+b.duration+"s "+b.timing;if(!this._pendingAnimations[g]){this._pendingAnimations[g]=b;f.push(b.css)}}this.ret[SC.platform.domCSSPrefix+"Transition"]=f.join(", ")}else{for(g in h){this._pendingAnimations[g]=h[g]}}delete d.animate},_cssNumber:function(a){if(a==null){return null}else{if(a===SC.LAYOUT_AUTO){return SC.LAYOUT_AUTO}else{if(SC.isPercentage(a)){return(a*100)+"%"}else{return Math.floor(a)}}}},calculate:function(){var d=this.get("layout"),b=null,m=this.get("staticLayout"),c=null,e=null,a=this.get("turbo"),g=this.ret,k=this.dims,f=this.loc,h=this.get("view"),l,j;this._handleMistakes(d);if(m&&d===SC.View.prototype.layout){return{}}if(this.hasLeft||this.hasRight||!this.hasCenterX){e=this._calculatePosition("x")}else{this._calculateCenter("x")}if(this.hasTop||this.hasBottom||!this.hasCenterY){c=this._calculatePosition("y")}else{this._calculateCenter("y")}g.minWidth=this.minWidth;g.maxWidth=this.maxWidth;g.minHeight=this.minHeight;g.maxHeight=this.maxHeight;g.zIndex=this.zIndex;g.opacity=this.opacity;g.backgroundPosition=this.backgroundPosition;this._calculateTransforms(e,c);this._calculateAnimations(e,c);for(l in g){j=g[l];if(typeof j===SC.T_NUMBER){g[l]=(j+"px")}}return g},willRenderAnimations:function(){if(SC.platform.supportsCSSTransitions){var h=this.get("view"),f=h.get("layer"),a=f?f.style:null,b=h.get("layoutStyle"),m=this._activeAnimations,c,e=this._pendingAnimations,d,o=this._animatedTransforms,g=o?o.length:0,l,p=[],n,k,j;if(e){if(!m){m={}}for(l in e){if(!e.hasOwnProperty(l)){continue}d=e[l];c=m[l];j=NO;if(b[l]!==(a?a[l]:null)){j=YES}if(c&&(c.duration!==d.duration||c.timing!==d.timing)){j=YES}if(j&&c){if(n=c.callback){if(g>0){this.runAnimationCallback(n,null,YES);this._animatedTransforms=null}else{this.runAnimationCallback(n,null,YES)}}this.removeAnimationFromLayout(l,YES)}m[l]=d;p.push(l)}if(!this._groupedAnimations){this._groupedAnimations={}}this._groupedAnimations[l]=p;this._activeAnimations=m;this._pendingAnimations=null}}},didRenderAnimations:function(){if(!SC.platform.supportsCSSTransitions){var a,b;for(a in this._pendingAnimations){b=this._pendingAnimations[a].callback;if(b){this.invokeOnceLater("runAnimationCallback",1,b,null,NO)}this.removeAnimationFromLayout(a,NO,YES)}this._activeAnimations=this._pendingAnimations=null}},runAnimationCallback:function(d,b,c){var a=this.get("view");if(d){if(SC.typeOf(d)!==SC.T_HASH){d={action:d}}d.source=a;if(!d.target){d.target=this}}SC.View.runCallback(d,{event:b,view:a,isCancelled:c})},transitionDidEnd:function(c){var e=c.originalEvent.propertyName,d,h,b;h=this._activeAnimations?this._activeAnimations[e]:null;if(h){if(h.callback){this.invokeOnceLater("runAnimationCallback",1,h.callback,c,NO)}this.removeAnimationFromLayout(e,YES);var g;d=this._groupedAnimations&&this._groupedAnimations[e];if(d){for(var f=0,a=d.length;f<a;f++){g=d[f];delete this._activeAnimations[g]}delete this._groupedAnimations[e]}}},removeAnimationFromLayout:function(c,h,b){if(h){var e=this.getPath("view.layer"),g=[],d;for(d in this._activeAnimations){if(d!==c){g.push(this._activeAnimations[d].css)}}if(e){e.style[SC.platform.domCSSPrefix+"Transition"]=g.join(", ")}}var f=this.getPath("view.layout"),a;if(c==="-"+SC.platform.cssPrefix+"-transform"&&this._animatedTransforms&&this._animatedTransforms.length>0){for(a=0;a<this._animatedTransforms.length;a++){delete f["animate"+SC.String.capitalize(this._animatedTransforms[a])]}this._animatedTransforms=null}delete f["animate"+SC.String.capitalize(c)]}});SC.CoreView.runCallback=function(g){var b=SC.$A(arguments).slice(1),a=SC.typeOf(g.action);if(a==SC.T_FUNCTION){g.action.apply(g.target,b)}else{if(a===SC.T_STRING){if(g.action.indexOf(".")>=0){var f=g.action.split(".");var d=f.pop();var e=SC.objectForPropertyPath(f,window);var c=e.get?e.get(d):e[d];if(c&&SC.typeOf(c)==SC.T_FUNCTION){c.apply(e,b)}else{throw"SC.runCallback could not find a function at %@".fmt(g.action)}}}}};SC.View.runCallback=SC.CoreView.runCallback;sc_require("views/view");sc_require("views/view/layout_style");SC.LAYOUT_HORIZONTAL="sc-layout-horizontal";SC.LAYOUT_VERTICAL="sc-layout-vertical";SC._VIEW_DEFAULT_DIMS=["marginTop","marginLeft"];SC.FULL_WIDTH={left:0,right:0};SC.FULL_HEIGHT={top:0,bottom:0};SC.ANCHOR_CENTER={centerX:0,centerY:0};SC.LAYOUT_AUTO="auto";SC.View.reopen({hasLayout:YES,concatenatedProperties:["layoutProperties"],backgroundColor:null,displayProperties:["backgroundColor"],useStaticLayout:NO,init:function(a){a();this.layoutStyleCalculator=SC.View.LayoutStyleCalculator.create({view:this});this._previousLayout=this.get("layout")}.enhance(),propertyDidChange:function(b,d,c){var a=false;if(typeof this.layout==="function"&&this._kvo_dependents){var e=this._kvo_dependents[b];if(e&&e.indexOf("layout")!=-1){a=true}}if(b==="layout"||a){this.layoutDidChange()}arguments.callee.base.apply(this,arguments)},adjust:function(a,d){var b=this.get("layout"),c=NO,f,e;if(a===undefined){return this}if(SC.typeOf(a)===SC.T_STRING){f=b[a];if(d===undefined||f==d){return this}b=SC.clone(b);if(d===null){delete b[a]}else{b[a]=d}c=YES}else{e=a;for(a in e){if(!e.hasOwnProperty(a)){continue}d=e[a];f=b[a];if(d===undefined||f==d){continue}if(!c){b=SC.clone(b)}if(d===null){delete b[a]}else{b[a]=d}c=YES}}if(c){this.set("layout",b)}return this},layout:{top:0,left:0,bottom:0,right:0},isFixedLayout:function(){return this.get("isFixedPosition")&&this.get("isFixedSize")}.property("isFixedPosition","isFixedSize").cacheable(),isFixedPosition:function(){var b=this.get("layout"),a;a=(((b.left!==undefined)&&(b.top!==undefined))&&((b.left!==SC.LAYOUT_AUTO)&&(b.top!==SC.LAYOUT_AUTO)));if(a){a=(!SC.isPercentage(b.top)&&!SC.isPercentage(b.left))}return a}.property("layout").cacheable(),isFixedSize:function(){var b=this.get("layout"),a;a=(((b.width!==undefined)&&(b.height!==undefined))&&((b.width!==SC.LAYOUT_AUTO)&&(b.height!==SC.LAYOUT_AUTO)));if(a){a=(!SC.isPercentage(b.width)&&!SC.isPercentage(b.height))}return a}.property("layout").cacheable(),convertFrameToView:function(j,d){var c=0,b=0,g=0,e=0,a=this,h;while(a){h=a.get("frame");c+=h.x;b+=h.y;a=a.get("layoutView")}if(d){a=d;while(a){h=a.get("frame");g+=h.x;e+=h.y;a=a.get("layoutView")}}c=j.x+c-g;b=j.y+b-e;return{x:c,y:b,width:j.width,height:j.height}},convertFrameFromView:function(j,d){var c=0,b=0,g=0,e=0,a=this,h;while(a&&(h=a.get("frame"))){c+=h.x;b+=h.y;a=a.get("parentView")}if(d){a=d;while(a){h=a.get("frame");g+=h.x;e+=h.y;a=a.get("parentView")}}c=j.x-c+g;b=j.y-b+e;return{x:c,y:b,width:j.width,height:j.height}},scrollToVisible:function(){var a=this.get("parentView");while(a&&!a.get("isScrollable")){a=a.get("parentView")}if(a){a.scrollToVisible();return a.scrollToVisible(this)}else{return NO}},_adjustForBorder:function(e,c){var f=((c.borderTop!==undefined)?c.borderTop:c.border)||0,d=((c.borderLeft!==undefined)?c.borderLeft:c.border)||0,b=((c.borderBottom!==undefined)?c.borderBottom:c.border)||0,a=((c.borderRight!==undefined)?c.borderRight:c.border)||0;e.x+=d;e.y+=f;e.width-=(d+a);e.height-=(f+b);return e},computeFrameWithParentFrame:function(n,g){var p,q=this.get("layout");if(this.get("useStaticLayout")){p=n();return p?this._adjustForBorder(p,q):null}else{p={}}var o,u,m=SC.LAYOUT_AUTO,l=this.get("parentView"),h,c,a=q.right,b=q.left,t=q.top,e=q.bottom,s=q.width,d=q.height,k=q.centerX,j=q.centerY;if(s===m){o=SC.Error.desc(("%@.layout() cannot use width:auto if staticLayout is disabled").fmt(this),"%@".fmt(this),-1);SC.Logger.error(o.toString());throw o}if(d===m){o=SC.Error.desc(("%@.layout() cannot use height:auto if staticLayout is disabled").fmt(this),"%@".fmt(this),-1);SC.Logger.error(o.toString());throw o}if(!g){g=this.computeParentDimensions(q)}h=g.height;c=g.width;if(!SC.none(b)){if(SC.isPercentage(b)){p.x=c*b}else{p.x=b}if(s!==undefined){if(s===m){p.width=m}else{if(SC.isPercentage(s)){p.width=c*s}else{p.width=s}}}else{p.width=c-p.x;if(a&&SC.isPercentage(a)){p.width=p.width-(a*c)}else{p.width=p.width-(a||0)}}}else{if(!SC.none(a)){if(SC.none(s)){if(SC.isPercentage(a)){p.width=c-(c*a)}else{p.width=c-a}p.x=0}else{if(s===m){p.width=m}else{if(SC.isPercentage(s)){p.width=c*s}else{p.width=(s||0)}}if(SC.isPercentage(s)){p.x=c-(a*c)-p.width}else{p.x=c-a-p.width}}}else{if(!SC.none(k)){if(s===m){p.width=m}else{if(SC.isPercentage(s)){p.width=s*c}else{p.width=(s||0)}}if(SC.isPercentage(k)){p.x=(c-p.width)/2+(k*c)}else{p.x=(c-p.width)/2+k}}else{p.x=0;if(SC.none(s)){p.width=c}else{if(s===m){p.width=m}if(SC.isPercentage(s)){p.width=s*c}else{p.width=(s||0)}}}}}if(!SC.none(t)){if(SC.isPercentage(t)){p.y=t*h}else{p.y=t}if(d!==undefined){if(d===m){p.height=m}else{if(SC.isPercentage(d)){p.height=d*h}else{p.height=d}}}else{if(e&&SC.isPercentage(e)){p.height=h-p.y-(e*h)}else{p.height=h-p.y-(e||0)}}}else{if(!SC.none(e)){if(SC.none(d)){if(SC.isPercentage(e)){p.height=h-(e*h)}else{p.height=h-e}p.y=0}else{if(d===m){p.height=m}if(d&&SC.isPercentage(d)){p.height=d*h}else{p.height=(d||0)}if(SC.isPercentage(e)){p.y=h-(e*h)-p.height}else{p.y=h-e-p.height}}}else{if(!SC.none(j)){if(d===m){p.height=m}if(d&&SC.isPercentage(d)){p.height=d*h}else{p.height=(d||0)}if(SC.isPercentage(j)){p.y=(h-p.height)/2+(j*h)}else{p.y=(h-p.height)/2+j}}else{p.y=0;if(SC.none(d)){p.height=h}else{if(d===m){p.height=m}if(SC.isPercentage(d)){p.height=d*h}else{p.height=d||0}}}}}p.x=Math.floor(p.x);p.y=Math.floor(p.y);if(p.height!==m){p.height=Math.floor(p.height)}if(p.width!==m){p.width=Math.floor(p.width)}if(p.height===m||p.width===m){u=this.get("layer");if(p.height===m){p.height=u?u.clientHeight:0}if(p.width===m){p.width=u?u.clientWidth:0}}p=this._adjustForBorder(p,q);if(l&&l.isScrollContainer){l=l.get("parentView");p.x-=l.get("horizontalScrollOffset");p.y-=l.get("verticalScrollOffset")}if(!SC.none(q.maxHeight)&&(p.height>q.maxHeight)){p.height=q.maxHeight}if(!SC.none(q.minHeight)&&(p.height<q.minHeight)){p.height=q.minHeight}if(!SC.none(q.maxWidth)&&(p.width>q.maxWidth)){p.width=q.maxWidth}if(!SC.none(q.minWidth)&&(p.width<q.minWidth)){p.width=q.minWidth}if(p.height<0){p.height=0}if(p.width<0){p.width=0}return p}.enhance(),computeParentDimensions:function(e){var b,c=this.get("parentView"),a=(c)?c.get("frame"):null;if(a){b={width:a.width,height:a.height}}else{var d=e||{};b={width:(d.left||0)+(d.width||0)+(d.right||0),height:(d.top||0)+(d.height||0)+(d.bottom||0)}}return b},borderFrame:function(){var d=this.get("layout"),f=this.get("frame"),a=d.border,e=((d.topBorder!==undefined)?d.topBorder:d.border)||0,c=((d.rightBorder!==undefined)?d.rightBorder:d.border)||0,g=((d.bottomBorder!==undefined)?d.bottomBorder:d.border)||0,b=((d.leftBorder!==undefined)?d.leftBorder:d.border)||0;return{x:f.x-b,y:f.y-e,width:f.width+b+c,height:f.height+e+g}}.property("frame").cacheable(),parentViewDidResize:function(){var b,a;a=this.useStaticLayout||!this.get("isFixedSize");b=!this.get("isFixedPosition");if(a){this.viewDidResize()}else{if(b){this._viewFrameDidChange()}}},viewDidResize:function(){this._viewFrameDidChange();var d=this.childViews,b,a,c;for(a=0;a<(b=d.length);++a){c=d[a];c.tryToPerform("parentViewDidResize")}},_viewFrameDidChange:function(){this.notifyPropertyChange("frame");this._sc_view_clippingFrameDidChange()},beginLiveResize:function(){if(this.willBeginLiveResize){this.willBeginLiveResize()}var d=this.get("childViews"),b=d.length,a,c;for(a=0;a<b;++a){c=d[a];if(c.beginLiveResize){c.beginLiveResize()}}return this},endLiveResize:function(){var d=this.get("childViews"),b=d.length,a,c;for(a=b-1;a>=0;--a){c=d[a];if(c.endLiveResize){c.endLiveResize()}}if(this.didEndLiveResize){this.didEndLiveResize()}return this},layoutView:function(){return this.get("parentView")}.property("parentView").cacheable(),layoutDidChange:function(){var g=this._previousLayout,f=this.get("layout"),j=YES,d,c,a,b;if(!SC.none(f.rotate)){if(SC.none(f.rotateX)){f.rotateX=f.rotate;SC.Logger.warn("Please set rotateX instead of rotate")}}if(!SC.none(f.rotateX)){f.rotate=f.rotateX}else{delete f.rotate}var h=f.animations;if(h){if(!SC.none(h.rotate)){if(SC.none(h.rotateX)){h.rotateX=h.rotate;SC.Logger.warn("Please animate rotateX instead of rotate")}}if(!SC.none(h.rotateX)){h.rotate=h.rotateX}else{delete h.rotate}}if(g&&g!==f){d=g.width;if(d!==undefined){a=f.width;if(d===a){c=g.height;if(g!==undefined){b=f.height;if(c===b){j=NO}}}}}this.beginPropertyChanges();this.notifyPropertyChange("hasAcceleratedLayer");this.notifyPropertyChange("layoutStyle");if(j){this.viewDidResize()}else{this._viewFrameDidChange()}this.endPropertyChanges();var e=this.get("layoutView");if(e){e.set("childViewsNeedLayout",YES);e.layoutDidChangeFor(this);if(e.get("childViewsNeedLayout")){e.invokeOnce(e.layoutChildViewsIfNeeded)}}this._previousLayout=f;return this},childViewsNeedLayout:NO,layoutDidChangeFor:function(b){var a=this._needLayoutViews;if(!a){a=this._needLayoutViews=SC.CoreSet.create()}a.add(b)},layoutChildViewsIfNeeded:function(a){if(!a){a=this.get("isVisibleInWindow")}if(a&&this.get("childViewsNeedLayout")){this.set("childViewsNeedLayout",NO);this.layoutChildViews()}return this},layoutChildViews:function(){var c=this._needLayoutViews,a=c?c.length:0,b;for(b=0;b<a;++b){c[b].updateLayout()}c.clear()},updateLayout:function(){var b=this.get("layer"),a;if(b){a=this.renderContext(b);this.renderLayout(a,NO);a.update();if(this.useStaticLayout){this.viewDidResize()}}b=null;return this},renderLayout:function(a,b){this.get("layoutStyleCalculator").willRenderAnimations();a.addStyle(this.get("layoutStyle"));this.get("layoutStyleCalculator").didRenderAnimations()},_renderLayerSettings:function(b,a,c){b(a,c);this.renderLayout(a,c)}.enhance(),applyAttributesToContext:function(b,a){b(a);if(this.get("useStaticLayout")){a.addClass("sc-static-layout")}if(this.get("backgroundColor")){a.css("backgroundColor",this.get("backgroundColor"))}}.enhance()});SC.View.mixin({convertLayoutToAnchoredLayout:function(f,n){var h={top:0,left:0,width:n.width,height:n.height},d=n.width,l=n.height,m=f.right,a=f.left,k=f.top,g=f.bottom,j=f.width,e=f.height,c=f.centerX,b=f.centerY;if(!SC.none(a)){if(SC.isPercentage(a)){h.left=a*d}else{h.left=a}if(j!==undefined){if(j===SC.LAYOUT_AUTO){h.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(j)){h.width=j*d}else{h.width=j}}}else{if(m&&SC.isPercentage(m)){h.width=d-h.left-(m*d)}else{h.width=d-h.left-(m||0)}}}else{if(!SC.none(m)){if(SC.none(j)){h.left=0;if(m&&SC.isPercentage(m)){h.width=d-(m*d)}else{h.width=d-(m||0)}}else{if(j===SC.LAYOUT_AUTO){h.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(j)){h.width=j*d}else{h.width=j}if(SC.isPercentage(m)){h.left=d-(h.width+m)}else{h.left=d-(h.width+m)}}}}else{if(!SC.none(c)){if(j&&SC.isPercentage(j)){h.width=(j*d)}else{h.width=(j||0)}h.left=((d-h.width)/2);if(SC.isPercentage(c)){h.left=h.left+c*d}else{h.left=h.left+c}}else{if(!SC.none(j)){h.left=0;if(j===SC.LAYOUT_AUTO){h.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(j)){h.width=j*d}else{h.width=j}}}else{h.left=0;h.width=0}}}}if(f.minWidth!==undefined){h.minWidth=f.minWidth}if(f.maxWidth!==undefined){h.maxWidth=f.maxWidth}if(!SC.none(k)){if(SC.isPercentage(k)){h.top=k*l}else{h.top=k}if(e!==undefined){if(e===SC.LAYOUT_AUTO){h.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(e)){h.height=e*l}else{h.height=e}}}else{h.height=l-h.top;if(g&&SC.isPercentage(g)){h.height=h.height-(g*l)}else{h.height=h.height-(g||0)}}}else{if(!SC.none(g)){if(SC.none(e)){h.top=0;if(g&&SC.isPercentage(g)){h.height=l-(g*l)}else{h.height=l-(g||0)}}else{if(e===SC.LAYOUT_AUTO){h.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(e)){h.height=e*l}else{h.height=e}h.top=l-h.height;if(SC.isPercentage(g)){h.top=h.top-(g*l)}else{h.top=h.top-g}}}}else{if(!SC.none(b)){if(e&&SC.isPercentage(e)){h.height=(e*l)}else{h.height=(e||0)}h.top=((l-h.height)/2);if(SC.isPercentage(b)){h.top=h.top+b*l}else{h.top=h.top+b}}else{if(!SC.none(e)){h.top=0;if(e===SC.LAYOUT_AUTO){h.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(e)){h.height=e*l}else{h.height=e}}}else{h.top=0;h.height=0}}}}if(h.top){h.top=Math.floor(h.top)}if(h.bottom){h.bottom=Math.floor(h.bottom)}if(h.left){h.left=Math.floor(h.left)}if(h.right){h.right=Math.floor(h.right)}if(h.width!==SC.LAYOUT_AUTO){h.width=Math.floor(h.width)}if(h.height!==SC.LAYOUT_AUTO){h.height=Math.floor(h.height)}if(f.minHeight!==undefined){h.minHeight=f.minHeight}if(f.maxHeight!==undefined){h.maxHeight=f.maxHeight}return h},convertLayoutToCustomLayout:function(b,a,c){}});sc_require("views/view");sc_require("views/view/layout");sc_require("views/view/layout_style");SC.View.reopen({wantsAcceleratedLayer:NO,hasAcceleratedLayer:function(){if(this.get("wantsAcceleratedLayer")&&SC.platform.supportsAcceleratedLayers){var c=this.get("layout"),d=c.animate,b=SC.LAYOUT_AUTO,a;if(d&&(d.top||d.left)){for(a in d){if(SC.CSS_TRANSFORM_MAP[a]&&((d.top&&d.top.duration!==d[a].duration)||(d.left&&d.left.duration!==d[a].duration))){return NO}}}return this.get("isFixedLayout")}return NO}.property("wantsAcceleratedLayer").cacheable()});sc_require("views/view");SC.View.reopen({cursor:function(a,c){var b;if(c){this._setCursor=c}if(this._setCursor!==undefined){return this._setCursor}b=this.get("parentView");if(this.get("shouldInheritCursor")&&b){return b.get("cursor")}return null}.property("parentView","shouldInheritCursor").cacheable(),applyAttributesToContext:function(b,a){var c=this.get("cursor");if(c){a.addClass(c.get("className"))}b(a)}.enhance(),shouldInheritCursor:YES});sc_require("views/view");SC.View.reopen({isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay().bool(),isEnabledInPane:function(){var a=this.get("isEnabled"),b;if(a&&(b=this.get("parentView"))){a=b.get("isEnabledInPane")}return a}.property("parentView","isEnabled"),_sc_view_isEnabledDidChange:function(){if(!this.get("isEnabled")&&this.get("isFirstResponder")){this.resignFirstResponder()}}.observes("isEnabled"),applyAttributesToContext:function(b,a){var c=this.get("isEnabled");b(a);a.setClass("disabled",!c);a.attr("aria-disabled",!c?"true":null)}.enhance()});sc_require("views/view");SC.View.reopen({isKeyResponder:NO,willLoseKeyResponderTo:function(a){},willBecomeKeyResponderFrom:function(a){},didLoseKeyResponderTo:function(a){},didBecomeKeyResponderFrom:function(a){},interpretKeyEvents:function(b){var a=b.commandCodes(),d=a[0],e=a[1],g;if(!d&&!e){return null}if(d){var h=SC.MODIFIED_KEY_BINDINGS[d]||SC.BASE_KEY_BINDINGS[d.match(/[^_]+$/)[0]];if(h){var f=this,c=this.get("pane"),j=null;while(f&&!(j=f.tryToPerform(h,b))){f=(f===c)?null:f.get("nextResponder")}return j}}if(e&&this.respondsTo("insertText")){g=this.insertText(e,b);return g?(g===YES?this:g):null}return null},insertText:function(a){return NO},performKeyEquivalent:function(f,d){var e=NO,g=this.get("childViews"),b=g.length,a=-1,c;while(!e&&(++a<b)){c=g[a];e=c.tryToPerform("performKeyEquivalent",f,d)}return e},firstKeyView:null,_getFirstKeyView:function(){var a=this.get("firstKeyView");if(a){return a}var b=this.get("childViews");if(b){return b[0]}},lastKeyView:null,_getLastKeyView:function(){var d=this.get("lastKeyView");if(d){return d}var a,b=this.get("firstKeyView");if(b){while(a=b._getNextKeyView()){b=a}return b}else{var c=this.get("childViews");if(c){return c[c.length-1]}}},nextKeyView:undefined,_getNextKeyView:function(){var b=this.get("parentView"),a=this.get("nextKeyView");if(b&&b.get("lastKeyView")===this){return null}if(a!==undefined){return a}if(b){var c=b.get("childViews");return c[c.indexOf(this)+1]}},nextValidKeyView:function(){var b=this,a;while(a!==this){a=null;if(b.get("isVisibleInWindow")){a=b._getFirstKeyView()}if(!a){a=b._getNextKeyView()}if(!a){while(b=b.get("parentView")){if(a=b._getNextKeyView()){break}}}if(!a){if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){break}else{a=this.get("pane")}}if(a.get("isVisibleInWindow")&&a.get("acceptsFirstResponder")){return a}b=a}return null}.property("nextKeyView"),previousKeyView:undefined,_getPreviousKeyView:function(){var b=this.get("parentView"),a=this.get("previousKeyView");if(b&&b.get("firstKeyView")===this){return null}if(a!==undefined){return a}if(b){var c=b.get("childViews");return c[c.indexOf(this)-1]}},previousValidKeyView:function(){var b=this,a;while(a!==this){if(b.get("parentView")){a=b._getPreviousKeyView()}else{if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){break}else{a=b}}if(a){do{b=a;a=a._getLastKeyView()}while(a&&a.get("isVisibleInWindow"));if(!a){a=b}}else{a=b.get("parentView")}if(a.get("isVisibleInWindow")&&a.get("acceptsFirstResponder")){return a}b=a}return null}.property("previousKeyView")});sc_require("views/view");SC.View.reopen({_lastLayerId:null,layerIdDidChange:function(){var a=this.get("layer"),b=this.get("layerId"),c=this._lastLayerId;if(b!==c){if(c&&SC.View.views[c]===this){delete SC.View.views[c]}this._lastLayerId=b;SC.View.views[b]=this;if(a){a.id=b}}}.observes("layerId"),parentViewDidChange:function(){this.recomputeIsVisibleInWindow();this.resetBuildState();this.set("layerLocationNeedsUpdate",YES);this.invokeOnce(this.updateLayerLocationIfNeeded);this._invalidatePaneCacheForSelfAndAllChildViews();return this},_invalidatePaneCacheForSelfAndAllChildViews:function(){var d,c=this.get("childViews"),b=c.length,a;this.notifyPropertyChange("pane");for(a=0;a<b;++a){d=c[a];if(d._invalidatePaneCacheForSelfAndAllChildViews){d._invalidatePaneCacheForSelfAndAllChildViews()}}},insertBefore:function(b,d){b.beginPropertyChanges();if(b.get("parentView")){b.removeFromParent()}if(this.willAddChild){this.willAddChild(b,d)}if(b.willAddToParent){b.willAddToParent(this,d)}b.set("parentView",this);var a,c=this.get("childViews");if(c.needsClone){this.set(c=[])}a=(d)?c.indexOf(d):c.length;if(a<0){a=c.length}c.insertAt(a,b);if(b.parentViewDidChange){b.parentViewDidChange()}if(b.layoutDidChange){b.layoutDidChange()}b.endPropertyChanges();this.invokeLast(function(){var e=b.get("pane");if(e&&e.get("isPaneAttached")){b._notifyDidAppendToDocument()}});if(this.didAddChild){this.didAddChild(b,d)}if(b.didAddToParent){b.didAddToParent(this,d)}return this},removeChild:function(b,a){if(!a){return this}if(a.parentView!==this){throw"%@.removeChild(%@) must belong to parent".fmt(this,a)}if(a.willRemoveFromParent){a.willRemoveFromParent()}if(this.willRemoveChild){this.willRemoveChild(a)}b(a);if(a.parentViewDidChange){a.parentViewDidChange()}if(this.didRemoveChild){this.didRemoveChild(a)}if(a.didRemoveFromParent){a.didRemoveFromParent(this)}return this}.enhance(),replaceChild:function(a,b){a.beginPropertyChanges();b.beginPropertyChanges();this.beginPropertyChanges();this.insertBefore(a,b).removeChild(b);this.endPropertyChanges();b.endPropertyChanges();a.endPropertyChanges();return this},replaceAllChildren:function(c){var b=c.get("length"),a;this.beginPropertyChanges();this.destroyLayer().removeAllChildren();for(a=0;a<b;a++){this.appendChild(c.objectAt(a))}this.replaceLayer();this.endPropertyChanges();return this},appendChild:function(a){return this.insertBefore(a,null)},buildInChild:function(a){a.willBuildInToView(this);this.appendChild(a);a.buildInToView(this)},buildOutChild:function(a){a.buildOutFromView(this)},buildInDidFinishFor:function(a){},buildOutDidFinishFor:function(a){this.removeChild(a)},isBuildingIn:NO,isBuildingOut:NO,buildIn:function(){this.buildInDidFinish()},buildOut:function(){this.buildOutDidFinish()},resetBuild:function(){},buildOutDidCancel:function(){},buildInDidCancel:function(){},buildInDidFinish:function(){this.isBuildingIn=NO;this._buildingInTo.buildInDidFinishFor(this);this._buildingInTo=null},buildOutDidFinish:function(){this.isBuildingOut=NO;this._buildingOutFrom.buildOutDidFinishFor(this);this._buildingOutFrom=null},resetBuildState:function(){if(this.isBuildingIn){this.buildInDidCancel();this.isBuildingIn=NO}if(this.isBuildingOut){this.buildOutDidCancel();this.isBuildingOut=NO}this.buildingInTo=null;this.buildingOutFrom=null;this.resetBuild()},willBuildInToView:function(a){if(this.isBuildingOut){this.buildOutDidCancel()}},buildInToView:function(a){if(this.isBuildingIn){return}this._buildingInTo=a;this.isBuildingOut=NO;this.isBuildingIn=YES;this.buildIn()},buildOutFromView:function(a){if(this.isBuildingOut){return}if(this.isBuildingIn){this.buildInDidCancel()}this.isBuildingOut=YES;this.isBuildingIn=NO;this._buildingOutFrom=a;this.buildOut()}});sc_require("views/view");SC.View.reopen({init:function(a){a();this._lastTheme=this.get("theme")}.enhance(),themeName:null,baseThemeName:null,theme:function(){var b=this.get("baseTheme"),a=this.get("themeName");if(a){var c;if(b){c=b.find(a);if(c){return c}}c=SC.Theme.find(a);if(c){return c}return b.invisibleSubtheme(a)}return b}.property("baseTheme","themeName").cacheable(),_sc_view_themeDidChange:function(){if(this._lastTheme===this.get("theme")){return}this._lastTheme=this.get("theme");var c=this.childViews,b=c.length,a;for(a=0;a<b;a++){c[a].notifyPropertyChange("baseTheme")}if(this.get("layer")){this.replaceLayer()}}.observes("theme"),baseTheme:function(){var b;var a=this.get("baseThemeName");if(a){return SC.Theme.find(a)}else{b=this.get("parentView");var c=b&&b.get("theme");return c||SC.Theme.find(SC.defaultTheme)}}.property("baseThemeName","parentView").cacheable(),renderDelegate:function(c,d){if(d){this._setRenderDelegate=d}if(this._setRenderDelegate){return this._setRenderDelegate}var a=this.get("renderDelegateName"),b;if(a){b=this.get("theme")[a];if(!b){throw'%@: Unable to locate render delegate "%@" in theme.'.fmt(this,a)}return b}return null}.property("renderDelegateName","theme"),renderDelegateName:null,renderDelegateProxy:function(){return SC.View._RenderDelegateProxy.createForView(this)}.property("renderDelegate").cacheable(),render:function(b,c){var a=this.get("renderDelegate");if(a){if(c){a.render(this.get("renderDelegateProxy"),b)}else{a.update(this.get("renderDelegateProxy"),b.$())}}},applyAttributesToContext:function(f,e){var g=this.get("theme");var c=g.classNames,b,a=c.length;for(b=0;b<a;b++){e.addClass(c[b])}f(e);var d=this.get("renderDelegate");if(d&&d.className){e.addClass(d.className)}}.enhance(),invokeRenderDelegateMethod:function(c,b){var a=this.get("renderDelegate");if(!a){return undefined}if(SC.typeOf(a[c])!==SC.T_FUNCTION){return undefined}b=SC.$A(arguments);b.shift();b.unshift(this.get("renderDelegateProxy"));return a[c].apply(a,b)}});SC.View._RenderDelegateProxy={isViewRenderDelegateProxy:YES,createForView:function(c){var d=SC.beget(this);var f=c.get("displayProperties"),e={};for(var b=0,a=f.length;b<a;b++){e[f[b]]=YES}e.theme=YES;d._displayPropertiesLookup=e;d.renderState={};d._view=c;return d},get:function(b){if(this[b]!==undefined){return this[b]}var a="display"+b.capitalize();if(this._displayPropertiesLookup[a]){return this._view.get(a)}else{if(this._displayPropertiesLookup[b]){return this._view.get(b)}}return undefined},didChangeFor:function(d){var b=arguments.length,a;for(a=1;a<b;a++){var e=arguments[a],c="display"+e.capitalize();if(this._displayPropertiesLookup[c]){if(this._view.didChangeFor(d,c)){return YES}}else{if(this._displayPropertiesLookup[e]){if(this._view.didChangeFor(d,e)){return YES}}}}return NO}};SC.propertyFromRenderDelegate=function(a,b){return function(f,g){if(g!==undefined){this["_set_rd_"+f]=g}var d=this["_set_rd_"+f];if(d!==undefined){return d}var c=this.get("renderDelegate");if(c&&c.get){var e=this.get("renderDelegateProxy");d=c.getPropertyFor(e,a)}if(d!==undefined){return d}return b}.property("renderDelegate").cacheable()};sc_require("views/view");SC.View.reopen({acceptsMultitouch:NO,hasTouch:NO,touchBoundary:{left:25,right:25,top:25,bottom:25},_touchBoundaryFrame:function(){var b=this.get("touchBoundary"),a;a=this.get("parentView").convertFrameToView(this.get("frame"),null);a.x-=b.left;a.y-=b.top;a.width+=b.left+b.right;a.height+=b.top+b.bottom;return a}.property("touchBoundary","clippingFrame").cacheable(),touchIsInBoundary:function(a){return SC.pointInRect({x:a.pageX,y:a.pageY},this.get("_touchBoundaryFrame"))}});sc_require("views/view");SC.View.reopen({hasVisibility:YES,isVisibleInWindow:NO,isContextMenuEnabled:function(){return SC.CONTEXT_MENU_ENABLED}.property(),recomputeIsVisibleInWindow:function(d){var f=this.get("isVisibleInWindow"),h=this.get("isVisible"),e;if(h){if(d===undefined){e=this.get("parentView");d=e?e.get("isVisibleInWindow"):NO}h=h&&d}if(f!==h){this.set("isVisibleInWindow",h);var g=this.get("childViews"),b=g.length,a,c;for(a=0;a<b;a++){c=g[a];if(c.recomputeIsVisibleInWindow){c.recomputeIsVisibleInWindow(h)}}if(h){if(this.get("childViewsNeedLayout")){this.invokeOnce(this.layoutChildViewsIfNeeded)}}else{if(this.get("isFirstResponder")){this.resignFirstResponder()}}}this.updateLayerIfNeeded(YES);return this},_sc_isVisibleDidChange:function(){this.displayDidChange();this.recomputeIsVisibleInWindow()}.observes("isVisible")});sc_require("views/view");sc_require("views/view/acceleration");sc_require("views/view/cursor");sc_require("views/view/enabled");sc_require("views/view/keyboard");sc_require("views/view/layout");sc_require("views/view/manipulation");sc_require("views/view/theming");sc_require("views/view/touch");sc_require("views/view/visibility");sc_require("mixins/responder_context");SC.MIXED_STATE="__MIXED__";SC.Pane=SC.View.extend(SC.ResponderContext,{isPane:YES,page:null,rootResponder:null,sendEvent:function(c,a,d){var b;if(!d){d=this.get("firstResponder")}while(d){if(c==="touchStart"){if(a.touchResponder===d){d=null;break}if(!d.get("hasTouch")||d.get("acceptsMultitouch")){if(d.tryToPerform("touchStart",a)){break}}}else{if(c==="touchEnd"&&!d.get("acceptsMultitouch")){if(!d.get("hasTouch")){if(d.tryToPerform("touchEnd",a)){break}}}else{if(d.tryToPerform(c,a)){break}}}d=(d===this)?null:d.get("nextResponder")}if(!d&&(d=this.get("defaultResponder"))){if(typeof d===SC.T_STRING){d=SC.objectForPropertyPath(d)}if(!d){d=null}else{d=d.tryToPerform(c,a)?d:null}}else{if(!d&&!(d=this.get("defaultResponder"))){d=this.tryToPerform(c,a)?this:null}}return a.mouseHandler||d},nextResponder:function(){return null}.property().cacheable(),firstResponder:null,acceptsKeyPane:YES,isKeyPane:NO,becomeKeyPane:function(){if(this.get("isKeyPane")){return this}if(this.rootResponder){this.rootResponder.makeKeyPane(this)}return this},resignKeyPane:function(){if(!this.get("isKeyPane")){return this}if(this.rootResponder){this.rootResponder.makeKeyPane(null)}return this},makeFirstResponder:function(c,b,a){if(!b){b=this}var e=this.get("firstResponder"),d=this.get("isKeyPane");if(e===b){return this}if(SC.platform.touch&&b&&b.kindOf(SC.TextFieldView)&&!b.get("focused")){return this}if(d){if(e){e.tryToPerform("willLoseKeyResponderTo",b)}if(b){b.tryToPerform("willBecomeKeyResponderFrom",e)}}if(e){e.beginPropertyChanges();e.set("isKeyResponder",NO)}if(b){b.beginPropertyChanges();b.set("isKeyResponder",d)}c(b,a);if(e){e.endPropertyChanges()}if(b){b.endPropertyChanges()}if(d){if(b){b.tryToPerform("didBecomeKeyResponderFrom",e)}if(e){e.tryToPerform("didLoseKeyResponderTo",b)}}return this}.enhance(),willLoseKeyPaneTo:function(a){this._forwardKeyChange(this.get("isKeyPane"),"willLoseKeyResponderTo",a,NO);return this},willBecomeKeyPaneFrom:function(a){this._forwardKeyChange(!this.get("isKeyPane"),"willBecomeKeyResponderFrom",a,YES);return this},didBecomeKeyResponderFrom:function(a){},didLoseKeyPaneTo:function(b){var a=this.get("isKeyPane");this.set("isKeyPane",NO);this._forwardKeyChange(a,"didLoseKeyResponderTo",b);return this},didBecomeKeyPaneFrom:function(b){var a=this.get("isKeyPane");this.set("isKeyPane",YES);this._forwardKeyChange(!a,"didBecomeKeyResponderFrom",b,YES);return this},isMainPane:NO,focusFrom:function(a){},blurTo:function(a){},blurMainTo:function(a){this.set("isMainPane",NO)},focusMainFrom:function(a){this.set("isMainPane",YES)},append:function(){return this.appendTo(document.body)},remove:function(){if(!this.get("isVisibleInWindow")){return this}if(!this.get("isPaneAttached")){return this}var b=this.get("layer");if(b&&b.parentNode){b.parentNode.removeChild(b)}b=null;this._removeIntercept();this.resignKeyPane();var a=this.rootResponder;if(this.get("isMainPane")){a.makeMainPane(null)}a.panes.remove(this);this.rootResponder=null;this.set("isPaneAttached",NO);this.parentViewDidChange();return this},insert:function(b){var a=this.get("layer");if(!a){a=this.createLayer().get("layer")}b(a);if(!this.get("isPaneAttached")){this.paneDidAttach()}return this},appendTo:function(a){return this.insert(function(b){jQuery(a).append(b)})},paneDidAttach:function(){var a=(this.rootResponder=SC.RootResponder.responder);a.panes.add(this);this.set("isPaneAttached",YES);this.recomputeDependentProperties();this._notifyDidAppendToDocument();this._addIntercept();return this},recomputeDependentProperties:function(){},isPaneAttached:NO,wantsTouchIntercept:NO,hasTouchIntercept:function(){return this.get("wantsTouchIntercept")&&SC.platform.touch}.property("wantsTouchIntercept").cacheable(),zIndex:0,touchZ:99,_addIntercept:function(){if(this.get("hasTouchIntercept")){var b=document.createElement("div");var a=b.style;a.position="absolute";a.left="0px";a.top="0px";a.right="0px";a.bottom="0px";a.webkitTransform="translateZ(0px)";a.zIndex=this.get("zIndex")+this.get("touchZ");b.className="touch-intercept";b.id="touch-intercept-"+SC.guidFor(this);this._touchIntercept=b;document.body.appendChild(b)}},_removeIntercept:function(){if(this._touchIntercept){document.body.removeChild(this._touchIntercept);this._touchIntercept=null}},hideTouchIntercept:function(){if(this._touchIntercept){this._touchIntercept.style.display="none"}},showTouchIntercept:function(){if(this._touchIntercept){this._touchIntercept.style.display="block"}},recomputeIsVisibleInWindow:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}var d=this.get("isVisibleInWindow"),f=this.get("isVisible")&&this.get("isPaneAttached");if(d!==f){this.set("isVisibleInWindow",f);var e=this.get("childViews"),b=e.length,a,c;for(a=0;a<b;a++){c=e[a];if(c.recomputeIsVisibleInWindow){c.recomputeIsVisibleInWindow(f)}}if(f){if(this.get("childViewsNeedLayout")){this.invokeOnce(this.layoutChildViewsIfNeeded)}}else{if(this.get("isKeyPane")){this.resignKeyPane()}}}this.updateLayerIfNeeded(YES);return this},updateLayerLocation:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}return this},init:function(){if(this.hasTouchIntercept===YES){SC.Logger.warn("Do not set hasTouchIntercept directly. Use wantsTouchIntercept instead.");this.hasTouchIntercept=SC.platform.touch}var a=!!this.get("layer");arguments.callee.base.apply(this,arguments);if(a){this.paneDidAttach()}},classNames:["sc-pane"]});sc_require("panes/pane");SC.Pane.reopen({performKeyEquivalent:function(c,a){var b=arguments.callee.base.apply(this,arguments);if(!b){var d=this.get("defaultResponder");if(d){if(d.performKeyEquivalent){b=d.performKeyEquivalent(c,a)}if(!b&&d.tryToPerform){b=d.tryToPerform(c,a)}}}return b},keyDown:function(a){var b;if(a.keyCode===9&&!this.get("firstResponder")){if(a.shiftKey){b=this.get("previousValidKeyView")}else{b=this.get("nextValidKeyView")}if(b){this.makeFirstResponder(b);return YES}else{if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){a.allowDefault()}}}return NO},_forwardKeyChange:function(d,b,g,f){var c,a,e;if(d&&(a=this.get("firstResponder"))){e=(g)?g.get("firstResponder"):null;c=this.get("firstResponder");if(c&&c[b]){c[b](e)}if((f!==undefined)&&a){a.set("isKeyResponder",f)}}}});sc_require("panes/pane");SC.Pane.reopen({currentWindowSize:null,computeParentDimensions:function(c){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}var d={x:0,y:0,width:1000,height:1000},b=this.get("layout");if(document&&document.body){d.width=document.body.clientWidth;d.height=document.body.clientHeight;if(SC.browser.name===SC.BROWSER.ie&&SC.browser.compareVersion(SC.browser.version,"7")===0){var a=SC.platform.get("scrollbarSize");if(document.body.scrollWidth>d.width){d.width-=a}if(document.body.scrollHeight>d.height){d.height-=a}}}if(b.minHeight||b.minWidth){if(b.minHeight){d.height=Math.max(d.height,b.minHeight)}if(b.minWidth){d.width=Math.max(d.width,b.minWidth)}}return d},frame:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}return this.computeFrameWithParentFrame(null)}.property(),windowSizeDidChange:function(b,a){this.set("currentWindowSize",a);this.setBodyOverflowIfNeeded();this.parentViewDidResize();return this},setBodyOverflowIfNeeded:function(e){var d=this.get("layout"),b=this.get("currentWindowSize");if(!d||!b||!b.width||!b.height){return}var a=d.minWidth,c=d.minHeight;if(e===true||a||c){if((c&&b.height<c)||(a&&b.width<a)){SC.bodyOverflowArbitrator.requestVisible(this)}else{SC.bodyOverflowArbitrator.requestHidden(this)}}},paneLayoutDidChange:function(){this.invokeOnce(this.updateLayout);this.setBodyOverflowIfNeeded()}.observes("layout"),recomputeDependentProperties:function(a){this.set("currentWindowSize",this.rootResponder.computeWindowSize());a()}.enhance()});sc_require("panes/pane");SC.Pane.reopen({prependTo:function(a){return this.insert(function(b){jQuery(a).prepend(b)})},removeFromParent:function(){throw SC.Error.desc("SC.Pane cannot be removed from its parent, since it's the root. Did you mean remove()?")}});sc_require("panes/pane");SC.Pane.reopen({recomputeDependentProperties:function(a){this.recomputeIsVisibleInWindow();a()}.enhance()});SC.Application=SC.Responder.extend(SC.ResponderContext,{});SC.Color=SC.Object.extend(SC.Copyable,{original:null,a:1,r:0,g:0,b:0,hue:function(c,d){var e=SC.Color.clampToDeviceGamut,a=SC.Color.rgbToHsl(e(this.get("r")),e(this.get("g")),e(this.get("b"))),b;if(d!==undefined){a[0]=(d%360+360)%360;b=SC.Color.hslToRgb(a[0],a[1],a[2]);this.beginPropertyChanges();this.set("r",b[0]);this.set("g",b[1]);this.set("b",b[2]);this.endPropertyChanges()}return a[0]}.property("r","g","b").cacheable(),saturation:function(c,d){var e=SC.Color.clampToDeviceGamut,a=SC.Color.rgbToHsl(e(this.get("r")),e(this.get("g")),e(this.get("b"))),b;if(d!==undefined){a[1]=SC.Color.clamp(d,0,1);b=SC.Color.hslToRgb(a[0],a[1],a[2]);this.beginPropertyChanges();this.set("r",b[0]);this.set("g",b[1]);this.set("b",b[2]);this.endPropertyChanges()}return a[1]}.property("r","g","b").cacheable(),luminosity:function(c,d){var e=SC.Color.clampToDeviceGamut,a=SC.Color.rgbToHsl(e(this.get("r")),e(this.get("g")),e(this.get("b"))),b;if(d!==undefined){a[2]=SC.Color.clamp(d,0,1);b=SC.Color.hslToRgb(a[0],a[1],a[2]);this.beginPropertyChanges();this.set("r",b[0]);this.set("g",b[1]);this.set("b",b[2]);this.endPropertyChanges()}return a[2]}.property("r","g","b").cacheable(),isEqualTo:function(a){return this.get("r")===a.get("r")&&this.get("g")===a.get("g")&&this.get("b")===a.get("b")&&this.get("a")===a.get("a")},toArgb:function(){var a=SC.Color.clampToDeviceGamut;return"#"+[a(255*this.get("a")),a(this.get("r")),a(this.get("g")),a(this.get("b"))].map(function(b){b=b.toString(16);return b.length===1?"0"+b:b}).join("")},toHex:function(){var a=SC.Color.clampToDeviceGamut;return"#"+[a(this.get("r")),a(this.get("g")),a(this.get("b"))].map(function(b){b=b.toString(16);return b.length===1?"0"+b:b}).join("")},toRgb:function(){var a=SC.Color.clampToDeviceGamut;return"rgb("+a(this.get("r"))+","+a(this.get("g"))+","+a(this.get("b"))+")"},toRgba:function(){var a=SC.Color.clampToDeviceGamut;return"rgba("+a(this.get("r"))+","+a(this.get("g"))+","+a(this.get("b"))+","+this.get("a")+")"},toHsl:function(){var a=Math.round;return"hsl("+a(this.get("hue"))+","+a(this.get("saturation")*100)+"%,"+a(this.get("luminosity")*100)+"%)"},toHsla:function(){var a=Math.round;return"hsla("+a(this.get("hue"))+","+a(this.get("saturation")*100)+"%,"+a(this.get("luminosity")*100)+"%,"+this.get("a")+")"},cssText:function(){var a=SC.Color.supportsRgba||SC.Color.supportsArgb;return(this.a===1||!a)?this.toHex():SC.Color.supportsRgba?this.toRgba():this.toArgb()}.property("r","g","b","a").cacheable(),copy:function(){return SC.Color.create({original:this.get("original"),r:this.get("r"),g:this.get("g"),b:this.get("b"),a:this.get("a")})},sub:function(a){return SC.Color.create({r:this.get("r")-a.get("r"),g:this.get("g")-a.get("g"),b:this.get("b")-a.get("b"),a:this.get("a")-a.get("a")})},add:function(a){return SC.Color.create({r:this.get("r")+a.get("r"),g:this.get("g")+a.get("g"),b:this.get("b")+a.get("b"),a:this.get("a")+a.get("a")})},mult:function(b){var a=Math.round;return SC.Color.create({r:a(this.get("r")*b),g:a(this.get("g")*b),b:a(this.get("b")*b),a:this.get("a")*b})}});SC.Color.mixin({supportsRgba:(function(){var c=document.getElementsByTagName("script")[0].style,b=c.cssText,a;c.cssText="background-color:rgba(5,2,1,.5)";a=c.backgroundColor.indexOf("rgba")!==-1;c.cssText=b;return a}()),supportsArgb:(function(){var c=document.getElementsByTagName("script")[0].style,b=c.cssText,a;c.cssText='filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#55000000", endColorstr="#55000000");';a=c.backgroundColor.indexOf("#55000000")!==-1;c.cssText=b;return a}()),clamp:function(c,b,a){return Math.max(Math.min(c,a),b)},clampInt:function(c,b,a){return Math.round(SC.Color.clamp(c,b,a))},clampToDeviceGamut:function(a){return SC.Color.clampInt(a,0,255)},hsvToRgb:function(j,x,u){j/=360;var a,l,o,e=Math.floor(j*6),m=j*6-e,d=u*(1-x),c=u*(1-(x*m)),w=u*(1-(x*(1-m))),n=[[u,w,d],[c,u,d],[d,u,w],[d,c,u],[w,d,u],[u,d,c]],k=SC.Color.clampToDeviceGamut;e=e%6;a=k(n[e][0]*255);l=k(n[e][1]*255);o=k(n[e][2]*255);return[a,l,o]},rgbToHsv:function(a,f,k){a/=255;f/=255;k/=255;var l=Math.max(a,f,k),c=Math.min(a,f,k),j=l-c,e,n=l===0?0:j/l,m=l;if(l===c){e=0}else{switch(l){case a:e=(f-k)/j+(f<k?6:0);break;case f:e=(k-a)/j+2;break;case k:e=(a-f)/j+4;break}e/=6}e*=360;return[e,n,m]},hslToRgb:function(f,e,b){f/=360;var d,c,a=SC.Color.hueToRgb,g=SC.Color.clampToDeviceGamut;c=b<=0.5?b*(e+1):b+e-b*e;d=b*2-c;return[g(a(d,c,f+1/3)*255),g(a(d,c,f)*255),g(a(d,c,f-1/3)*255)]},hueToRgb:function(b,a,c){if(c<0){c++}if(c>1){c--}if(c<1/6){return b+(a-b)*c*6}if(c<1/2){return a}if(c<2/3){return b+(a-b)*(2/3-c)*6}return b},rgbToHsl:function(a,j,m){a/=255;j/=255;m/=255;var n=Math.max(a,j,m),e=Math.min(a,j,m),f,o,c=(n+e)/2,k=n-e;if(n===e){f=o=0}else{o=c>0.5?k/(2-n-e):k/(n+e);switch(n){case a:f=(j-m)/k+(j<m?6:0);break;case j:f=(m-a)/k+2;break;case m:f=(a-j)/k+4;break}f/=6}f*=360;return[f,o,c]},PARSE_RGBA:/^rgba\(\s*([\d]+%?)\s*,\s*([\d]+%?)\s*,\s*([\d]+%?)\s*,\s*([.\d]+)\s*\)$/,PARSE_RGB:/^rgb\(\s*([\d]+%?)\s*,\s*([\d]+%?)\s*,\s*([\d]+%?)\s*\)$/,PARSE_HSLA:/^hsla\(\s*(-?[\d]+)\s*\s*,\s*([\d]+)%\s*,\s*([\d]+)%\s*,\s*([.\d]+)\s*\)$/,PARSE_HSL:/^hsl\(\s*(-?[\d]+)\s*,\s*([\d]+)%\s*,\s*([\d]+)%\s*\)$/,PARSE_HEX:/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,PARSE_ARGB:/^#[0-9a-fA-F]{8}$/,KEYWORDS:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},from:function(f){var l=SC.Color,k=f,j,h,c,d=1,e=function(b){var a=parseInt(b,10);return b.slice(-1)==="%"?l.clampInt(a*2.55,0,255):l.clampInt(a,0,255)};if(l.KEYWORDS.hasOwnProperty(f)){f=l.KEYWORDS[f]}if(l.PARSE_RGB.test(f)){f=f.match(l.PARSE_RGB);j=e(f[1]);h=e(f[2]);c=e(f[3])}else{if(l.PARSE_RGBA.test(f)){f=f.match(l.PARSE_RGBA);j=e(f[1]);h=e(f[2]);c=e(f[3]);d=parseFloat(f[4],10)}else{if(l.PARSE_HEX.test(f)){if(f.length===4){f="#"+f.charAt(1)+f.charAt(1)+f.charAt(2)+f.charAt(2)+f.charAt(3)+f.charAt(3)}j=parseInt(f.slice(1,3),16);h=parseInt(f.slice(3,5),16);c=parseInt(f.slice(5,7),16)}else{if(l.PARSE_ARGB.test(f)){j=parseInt(f.slice(3,5),16);h=parseInt(f.slice(5,7),16);c=parseInt(f.slice(7,9),16);d=parseInt(f.slice(1,3),16)/255}else{if(l.PARSE_HSL.test(f)){f=f.match(l.PARSE_HSL);f=l.hslToRgb(((parseInt(f[1],10)%360+360)%360),l.clamp(parseInt(f[2],10)/100,0,1),l.clamp(parseInt(f[3],10)/100,0,1));j=f[0];h=f[1];c=f[2]}else{if(l.PARSE_HSLA.test(f)){f=f.match(l.PARSE_HSLA);d=parseFloat(f[4],10);f=l.hslToRgb(((parseInt(f[1],10)%360+360)%360),l.clamp(parseInt(f[2],10)/100,0,1),l.clamp(parseInt(f[3],10)/100,0,1));j=f[0];h=f[1];c=f[2]}else{if(f==="transparent"){j=h=c=0;d=0}else{return NO}}}}}}}return SC.Color.create({original:k,r:l.clampInt(j,0,255),g:l.clampInt(h,0,255),b:l.clampInt(c,0,255),a:l.clamp(d,0,1)})}});SC.BENCHMARK_LOG_READY=YES;sc_require("system/event");SC.mixin({isReady:NO,suppressOnReady:SC.suppressOnReady?YES:NO,suppressMain:SC.suppressMain?YES:NO,ready:function(b,c){var a=SC._readyQueue;if(c===undefined){c=b;b=null}else{if(SC.typeOf(c)===SC.T_STRING){c=b[c]}}if(SC.isReady){jQuery(document).ready(function(){c.call(b)})}else{if(!a){SC._readyQueue=[]}SC._readyQueue.push(function(){c.call(b)})}return this},onReady:{done:function(){if(SC.isReady){return}SC.isReady=true;SC.RunLoop.begin();SC.Locale.createCurrentLocale();var d=SC.Locale.currentLanguage.toLowerCase();jQuery("body").addClass(d);jQuery("html").attr("lang",d);jQuery("#loading").remove();var c=SC._readyQueue,b,a;if(c){for(b=0,a=c.length;b<a;b++){c[b].call()}SC._readyQueue=null}if(window.main&&!SC.suppressMain&&(SC.mode===SC.APP_MODE)){window.main()}SC.RunLoop.end()}}});if(!SC.suppressOnReady){jQuery.event.special.ready._default=SC.onReady.done}SC.APP_MODE="APP_MODE";SC.TEST_MODE="TEST_MODE";SC.mode=SC.APP_MODE;SC.platform=SC.Object.create({scrollbarSize:function(){var a=document.createElement("DIV"),d;a.innerHTML="<div style='height:1px;'></div>";a.style.cssText="position:absolute;width:100px;height:100px;overflow-y:visible;";d=a.childNodes[0];document.body.appendChild(a);var b=d.innerWidth||d.clientWidth;a.style.overflowY="scroll";var c=d.innerWidth||d.clientWidth;document.body.removeChild(a);return b-c}.property().cacheable(),touch:!SC.none(window.ontouchstart)||SC.browser.name===SC.BROWSER.android||"ontouchstart" in document.documentElement,bounceOnScroll:SC.browser.os===SC.OS.ios,pinchToZoom:SC.browser.os===SC.OS.ios,input:{placeholder:("placeholder" in document.createElement("input"))},input:function(d){var e={},c=d.length,f=document.createElement("input"),b,a;for(a=0;a<c;a++){b=d[a];e[b]=!!(b in f)}return e}(["autocomplete","readonly","list","size","required","multiple","maxlength","pattern","min","max","step","placeholder"]),standalone:!!navigator.standalone,cssPrefix:null,domCSSPrefix:null,simulateTouchEvents:function(){if(this.touch){return}SC.Logger.log("Simulating touch events");SC.platform.touch=YES;SC.platform.bounceOnScroll=YES;document.body.className=document.body.className+" touch";this._simtouch_counter=1;this.removeEvents(["click","dblclick","mouseout","mouseover","mousewheel"]);this.replaceEvent("mousemove",this._simtouch_mousemove);this.replaceEvent("mousedown",this._simtouch_mousedown);this.replaceEvent("mouseup",this._simtouch_mouseup);SC.platform.windowSizeDeterminesOrientation=YES;SC.device.orientationHandlingShouldChange()},removeEvents:function(d){var b,a=d.length,c;for(b=0;b<a;b++){c=d[b];SC.Event.remove(document,c,SC.RootResponder.responder,SC.RootResponder.responder[c])}},replaceEvent:function(a,b){SC.Event.remove(document,a,SC.RootResponder.responder,SC.RootResponder.responder[a]);SC.Event.add(document,a,this,b)},_simtouch_mousemove:function(a){if(!this._mousedown){if(a.altKey&&this._pinchCenter===null){this._pinchCenter={pageX:a.pageX,pageY:a.pageY,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}}else{if(!a.altKey&&this._pinchCenter!==null){this._pinchCenter=null}}return NO}var b=this.manufactureTouchEvent(a,"touchmove");return SC.RootResponder.responder.touchmove(b)},_simtouch_mousedown:function(a){this._mousedown=YES;var b=this.manufactureTouchEvent(a,"touchstart");return SC.RootResponder.responder.touchstart(b)},_simtouch_mouseup:function(a){var c=this.manufactureTouchEvent(a,"touchend"),b=SC.RootResponder.responder.touchend(c);this._mousedown=NO;this._simtouch_counter++;return b},manufactureTouchEvent:function(l,k){var c,m,f=this._simtouch_counter;c={type:k,target:l.target,identifier:f,pageX:l.pageX,pageY:l.pageY,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY};l.touches=[c];if(l.altKey&&this._pinchCenter!==null){var h=this._pinchCenter.pageX+this._pinchCenter.pageX-l.pageX,g=this._pinchCenter.pageY+this._pinchCenter.pageY-l.pageY,e=this._pinchCenter.screenX+this._pinchCenter.screenX-l.screenX,d=this._pinchCenter.screenY+this._pinchCenter.screenY-l.screenY,b=this._pinchCenter.clientX+this._pinchCenter.clientX-l.clientX,a=this._pinchCenter.clientY+this._pinchCenter.clientY-l.clientY,j=this._simtouch_counter+1;m={type:k,target:l.target,identifier:j,pageX:h,pageY:g,screenX:e,screenY:d,clientX:b,clientY:a};l.touches=[c,m]}l.changedTouches=l.touches;return l},supportsCSSTransitions:NO,supportsCSSTransforms:NO,understandsCSS3DTransforms:NO,supportsCSS3DTransforms:NO,supportsAcceleratedLayers:NO,supportsHashChange:function(){return("onhashchange" in window)&&(document.documentMode===undefined||document.documentMode>7)}(),supportsHistory:function(){return !!(window.history&&window.history.pushState)}(),supportsCanvas:function(){return !!document.createElement("canvas").getContext}(),supportsOrientationChange:("onorientationchange" in window),windowSizeDeterminesOrientation:SC.browser.os===SC.OS.ios||!("onorientationchange" in window)});(function(){var a=navigator.userAgent.toLowerCase();if((/webkit/).test(a)){SC.platform.cssPrefix="webkit";SC.platform.domCSSPrefix="Webkit"}else{if((/opera/).test(a)){SC.platform.cssPrefix="opera";SC.platform.domCSSPrefix="O"}else{if((/msie/).test(a)&&!(/opera/).test(a)){SC.platform.cssPrefix="ms";SC.platform.domCSSPrefix="ms"}else{if((/mozilla/).test(a)&&!(/(compatible|webkit)/).test(a)){SC.platform.cssPrefix="moz";SC.platform.domCSSPrefix="Moz"}}}}})();(function(){var b=document.createElement("div");var a=["-moz-","-moz-","-o-","-ms-","-webkit-"],h=["moz","Moz","o","ms","webkit"];var f="",d=null,j,c;for(d=0,c=a.length;d<c;d++){j=a[d];f+=j+"transition:all 1s linear;";f+=j+"transform: translate(1px, 1px);";f+=j+"perspective: 500px;"}b.style.cssText=f;var k;for(d=0,c=h.length;d<c;d++){k=h[d];if(b.style[k+"TransitionProperty"]!==undefined){SC.platform.supportsCSSTransitions=YES}if(b.style[k+"Transform"]!==undefined){SC.platform.supportsCSSTransforms=YES}if(b.style[k+"Perspective"]!==undefined||b.style[k+"PerspectiveProperty"]!==undefined){SC.platform.understandsCSS3DTransforms=YES;SC.platform.supportsCSS3DTransforms=YES}}try{if(window.media&&window.media.matchMedium){if(!window.media.matchMedium("(-webkit-transform-3d)")){SC.platform.supportsCSS3DTransforms=NO}}else{if(window.styleMedia&&window.styleMedia.matchMedium){if(!window.styleMedia.matchMedium("(-webkit-transform-3d)")){SC.platform.supportsCSS3DTransforms=NO}}}}catch(g){SC.platform.supportsCSS3DTransforms=NO}if(SC.platform.supportsCSSTransforms&&SC.platform.cssPrefix==="webkit"){SC.platform.supportsAcceleratedLayers=YES}})();sc_require("system/ready");sc_require("system/platform");SC.CAPTURE_BACKSPACE_KEY=NO;SC.RootResponder=SC.Object.extend({panes:null,init:function(){arguments.callee.base.apply(this,arguments);this.panes=SC.Set.create()},mainPane:null,makeMainPane:function(b){var a=this.get("mainPane");if(a===b){return this}this.beginPropertyChanges();if(this.get("keyPane")===a){this.makeKeyPane(b)}this.set("mainPane",b);if(a){a.blurMainTo(b)}if(b){b.focusMainFrom(a)}this.endPropertyChanges();return this},menuPane:null,makeMenuPane:function(b){if(b&&!b.get("acceptsMenuPane")){return this}else{var a=this.get("menuPane");if(a===b){return this}this.set("menuPane",b)}return this},keyPane:null,previousKeyPanes:[],makeKeyPane:function(f){var e,a,d;if(f){if(!f.get("acceptsKeyPane")){return this}else{a=this.get("keyPane");if(a===f){return this}else{if(a){d=this.get("previousKeyPanes");d.push(a)}e=f}}}else{a=this.get("keyPane");d=this.get("previousKeyPanes");e=null;var c;while(d.length>0){c=d.pop();if(c.get("isPaneAttached")&&c.get("acceptsKeyPane")){e=c;break}}}if(!e){var b=this.get("mainPane");if(b&&b.get("acceptsKeyPane")){e=b}}if(a){a.willLoseKeyPaneTo(e)}if(e){e.willBecomeKeyPaneFrom(a)}this.set("keyPane",e);if(e){e.didBecomeKeyPaneFrom(a)}if(a){a.didLoseKeyPaneTo(e)}return this},currentWindowSize:null,computeWindowSize:function(){var c,b,a;if(!this._bod||!this._docElement){b=document.body;a=document.documentElement;this._bod=b;this._docElement=a}else{b=this._bod;a=this._docElement}if(window.innerHeight){c={width:window.innerWidth,height:window.innerHeight}}else{if(a&&a.clientHeight){c={width:a.clientWidth,height:a.clientHeight}}else{if(b){c={width:b.clientWidth,height:b.clientHeight}}}}return c},resize:function(){this._resize();this._assignDesignMode();return YES},_resize:function(){var a=this.computeWindowSize(),b=this.get("currentWindowSize");this.set("currentWindowSize",a);if(!SC.rectsEqual(a,b)){SC.run(function(){SC.device.windowSizeDidChange(a);if(this.panes){if(b!==a){this.panes.invoke("windowSizeDidChange",b,a)}}},this)}},_assignDesignMode:function(){var a=this.computeDesignMode(),b=this.get("currentDesignMode");if(b!==a){this.set("currentDesignMode",a);if(this.panes){SC.run(function(){this.panes.invoke("updateDesignMode",b,a)},this)}}},hasFocus:NO,focus:function(a){if(!this.get("hasFocus")){SC.$("body").addClass("sc-focus").removeClass("sc-blur");SC.run(function(){if(!SC.TABBING_ONLY_INSIDE_DOCUMENT&&!SC.browser.isIE8OrLower){var b=SC.RootResponder.responder.get("keyPane");if(b){var c=b.get("nextValidKeyView");if(c){b.makeFirstResponder(c)}}}this.set("hasFocus",YES)},this)}return YES},focusin:function(a){if(this._focusTimeout){clearTimeout(this._focusTimeout)}this.focus(a)},focusout:function(a){var b=this;this._focusTimeout=setTimeout(function(){b.blur(a)},300)},blur:function(a){if(this.get("hasFocus")){SC.$("body").addClass("sc-blur").removeClass("sc-focus");SC.run(function(){this.set("hasFocus",NO)},this)}return YES},dragDidStart:function(a){this._mouseDownView=a;this._drag=a},currentDesignMode:null,designModes:function(a,b){if(SC.none(b)){if(this._designModeNames){delete this._designModeNames;delete this._designModeThresholds}b=null}else{this._prepOrderedArrays(b)}this._assignDesignMode();return b}.property().cacheable(),computeDesignMode:function(){var j=null,g=this._designModeNames,e=this._designModeThresholds,h=window.devicePixelRatio,c,a;if(!g){return null}c=this.get("currentWindowSize");if(!h){h=1}a=(c.width*c.height)/h;var d,f;for(d=0,f=e.get("length");d<f;d++){var b=e.objectAt(d);if(a<b){j=g.objectAt(d);break}}if(SC.none(j)&&g&&g.get("length")>0){j=g.objectAt(d)}return SC.device.orientation===SC.PORTRAIT_ORIENTATION?j+"_p":j+"_l"},fallbackDesignMode:function(d){var c=this._designModeNames,b,a=null;b=c.indexOf(d);if(b>=0){a=c[b-1]}return a},_prepOrderedArrays:function(e){var a,f;if(e){a=this._designModeNames=[];f=this._designModeThresholds=[];var c;outer:for(c in e){var b,d;d=e[c];inner:for(b=f.length-1;b>=0;b--){if(f[b]<d){break inner}}b+=1;a.splice(b,0,c);f.splice(b,0,d)}}},defaultResponder:null,sendAction:function(d,e,c,f,b,a){e=this.targetForAction(d,e,c,f,a);if(e&&e.isResponderContext){return !!e.sendAction(d,c,b,a)}else{return e&&e.tryToPerform(d,c)}},_responderFor:function(d,b,a){var c=d?d.get("defaultResponder"):null;if(d){d=a||d.get("firstResponder")||d;do{if(d.respondsTo(b)){return d}}while((d=d.get("nextResponder")))}if(typeof c===SC.T_STRING){c=SC.objectForPropertyPath(c)}if(!c){return null}else{if(c.isResponderContext){return c}else{if(c.respondsTo(b)){return c}else{return null}}}},targetForAction:function(c,f,e,g,a){if(!c||(SC.typeOf(c)!==SC.T_STRING)){return null}if(f){if(SC.typeOf(f)===SC.T_STRING){f=SC.objectForPropertyPath(f)||SC.objectForPropertyPath(f,e)}if(f&&!f.isResponderContext){if(f.respondsTo&&!f.respondsTo(c)){f=null}else{if(SC.typeOf(f[c])!==SC.T_FUNCTION){f=null}}}return f}if(g){f=this._responderFor(g,c,a);if(f){return f}}var b=this.get("keyPane"),d=this.get("mainPane");if(b&&(b!==g)){f=this._responderFor(b,c)}if(!f&&d&&(d!==b)){f=this._responderFor(d,c)}if(!f&&(f=this.get("defaultResponder"))){if(SC.typeOf(f)===SC.T_STRING){f=SC.objectForPropertyPath(f);if(f){this.set("defaultResponder",f)}}if(f&&!f.isResponderContext){if(f.respondsTo&&!f.respondsTo(c)){f=null}else{if(SC.typeOf(f[c])!==SC.T_FUNCTION){f=null}}}}return f},targetViewForEvent:function(a){return a.target?SC.$(a.target).view()[0]:null},sendEvent:function(c,a,d){var e,b;SC.run(function(){if(d){e=d.get("pane")}else{e=this.get("menuPane")||this.get("keyPane")||this.get("mainPane")}b=(e)?e.sendEvent(c,a,d):null},this);return b},listenFor:function(d,c,b,a){b=b?b:this;d.forEach(function(e){var f=b[e];if(f){SC.Event.add(c,e,b,f,null,a)}},this);c=null;return b},setup:function(){this.listenFor(["touchstart","touchmove","touchend","touchcancel","keydown","keyup","beforedeactivate","mousedown","mouseup","dragenter","dragover","dragleave","drop","click","dblclick","mousemove","contextmenu"],document).listenFor(["resize"],window);if(SC.browser.isIE8OrLower){this.listenFor(["focusin","focusout"],document)}else{this.listenFor(["focus","blur"],window)}if(this.keypress){if(SC.CAPTURE_BACKSPACE_KEY&&SC.browser.isMozilla){var b=this;document.onkeypress=function(f){f=SC.Event.normalizeEvent(f);return b.keypress.call(b,f)}}else{SC.Event.add(document,"keypress",this,this.keypress)}}["drag","selectstart"].forEach(function(f){var g=this[f];if(g){if(SC.browser.isIE){var e=this;document.body["on"+f]=function(h){return g.call(e,SC.Event.normalizeEvent(event||window.event))};SC.Event.add(window,"unload",this,function(){document.body["on"+f]=null})}else{SC.Event.add(document,f,this,g)}}},this);var a="mousewheel";if(SC.browser.isMozilla){if(SC.browser.compare(SC.browser.engineVersion,"1.9.1")<0){a="DOMMouseScroll"}else{a="MozMousePixelScroll"}}SC.Event.add(document,a,this,this.mousewheel);this.set("currentWindowSize",this.computeWindowSize());if(SC.browser.os===SC.OS.ios&&SC.browser.name===SC.BROWSER.safari){if(SC.platform&&!SC.platform.touch){SC.platform.simulateTouchEvents()}var c=SC.RunLoop.prototype.endRunLoop,d;d=function(){if(c){c.apply(this,arguments)}var j=SC.RootResponder.responder._touches,l,f,h,g=NO;if(j){for(l in j){if(j[l]._rescuedElement){continue}h=f=j[l].target;while(f&&(f=f.parentNode)&&!g){g=(f===document.body)}if(!g&&h){if(h.parentNode&&h.cloneNode){var k=h.cloneNode(true);h.parentNode.replaceChild(k,h);h.swapNode=k}var e=SC.touchHoldingPen;if(!e){e=SC.touchHoldingPen=document.createElement("div");e.style.display="none";document.body.appendChild(e)}e.appendChild(h);j[l]._rescuedElement=h}}}};SC.RunLoop.prototype.endRunLoop=d}},cleanUpTransitionListeners:function(){var a=SC.platform.transitionendEventName,c=SC.browser.domPrefix,b=c.toLowerCase(),f=b+"transitionend",e=b+"TransitionEnd",d=c+"TransitionEnd";["transitionend",f,e,d].forEach(function(g){if(g!=a){SC.Event.remove(document,g,this,this[g]);this[g]=null}})},cleanUpAnimationListeners:function(){var c=SC.browser.domPrefix,b=c.toLowerCase(),a=SC.platform.animationendEventName,f=b+"animationend",e=b+"AnimationEnd",d=c+"AnimationEnd";["animationend",f,e,d].forEach(function(g){if(g!=a){SC.Event.remove(document,g,this,this[g]);this[g]=null}});a=SC.platform.animationiterationEventName;f=b+"animationiteration";e=b+"AnimationIteration";d=c+"AnimationIteration";["animationiteration",f,e,d].forEach(function(g){if(g!=a){SC.Event.remove(document,g,this,this[g]);this[g]=null}});a=SC.platform.animationstartEventName;f=b+"animationstart";e=b+"AnimationStart";d=c+"AnimationStart";["animationstart",f,e,d].forEach(function(g){if(g!=a){SC.Event.remove(document,g,this,this[g]);this[g]=null}})},_touchedViews:{},_touches:{},touchesForView:function(a){if(this._touchedViews[SC.guidFor(a)]){return this._touchedViews[SC.guidFor(a)].touches}},averagedTouchesForView:function(h,g){var f,m=this.touchesForView(h),b=h._scrr_averagedTouches||(h._scrr_averagedTouches={});if((!m||m.length===0)&&!g){b.x=0;b.y=0;b.d=0;b.touchCount=0}else{var e=this._averagedTouches_touches||(this._averagedTouches_touches=[]);e.length=0;if(m){var d;f=m.length;for(d=0;d<f;d++){e.push(m[d])}}if(g){e.push(g)}var j,c,a=0,o=0,n,l,k=0;f=e.length;for(j=0;j<f;j++){c=e[j];a+=c.pageX;o+=c.pageY}a/=f;o/=f;for(j=0;j<f;j++){c=e[j];n=Math.abs(c.pageX-a);l=Math.abs(c.pageY-o);k+=Math.pow(n*n+l*l,0.5)}k/=f;b.x=a;b.y=o;b.d=k;b.touchCount=f}return b},assignTouch:function(b,a){if(b.hasEnded){throw new Error("Attempt to assign a touch that is already finished.")}if(b.view===a){return}if(b.view){this.unassignTouch(b)}if(!this._touchedViews[SC.guidFor(a)]){this._touchedViews[SC.guidFor(a)]={view:a,touches:SC.CoreSet.create([]),touchCount:0};a.set("hasTouch",YES)}b.view=a;this._touchedViews[SC.guidFor(a)].touches.add(b);this._touchedViews[SC.guidFor(a)].touchCount++},unassignTouch:function(c){var a,b;if(!c.view){return}a=c.view;b=this._touchedViews[SC.guidFor(a)];b.touches.remove(c);b.touchCount--;if(b.touchCount<1){a.set("hasTouch",NO);b.view=null;delete this._touchedViews[SC.guidFor(a)]}c.view=undefined},_flushQueuedTouchResponder:function(){if(this._queuedTouchResponder){var a=this._queuedTouchResponder;this._queuedTouchResponder=null;this.makeTouchResponder.apply(this,a)}},makeTouchResponder:function(f,d,c,l){if(this._isMakingTouchResponder){this._queuedTouchResponder=[f,d,c,l];return}this._isMakingTouchResponder=YES;var h=f.touchResponders,b;if(f.touchResponder===d){this._isMakingTouchResponder=NO;this._flushQueuedTouchResponder();return}var a;if(d){a=d.get("pane")}else{a=this.get("keyPane")||this.get("mainPane")}if(h.indexOf(d)<0){if(l){try{d=(a)?a.sendEvent("touchStart",f,d):null}catch(g){SC.Logger.error("Error in touchStart: "+g);d=null}}else{if(d&&((d.get?d.get("acceptsMultitouch"):d.acceptsMultitouch)||!d.hasTouch)){if(!d.touchStart(f)){d=null}}else{}}}if(!c||(h.indexOf(d)>-1&&h[h.length-1]!==d)){this.unassignTouch(f);var j=h.length-1,k=h[j];while(k&&k!==d){b=this.touchesForView(k);if((k.get?k.get("acceptsMultitouch"):k.acceptsMultitouch)||!b){if(k.touchCancelled){k.touchCancelled(f)}}j--;k=h[j];h.pop();f.touchResponder=h[j];f.nextTouchResponder=h[j-1]}}if(d){this.assignTouch(f,d);if(d!==f.touchResponder){h.push(d);f.touchResponder=d;f.nextTouchResponder=h[h.length-2]}}this._isMakingTouchResponder=NO;this._flushQueuedTouchResponder()},captureTouch:function(h,e,g){if(!e){e=this}var f=h.targetView,c=f,d=[],b,a;while(c&&(c!==e)){d.unshift(c);c=c.get("nextResponder")}for(a=d.length,b=0;b<a;b++){c=d[b];if(c.tryToPerform("captureTouch",h)){this.makeTouchResponder(h,c,g,YES);return}}this.makeTouchResponder(h,f,g,YES)},endMissingTouches:function(e){var b,a=e.length,d={},c=[];for(b=0;b<a;b++){d[e[b].identifier]=YES}for(b in this._touches){var f=this._touches[b].identifier;if(!d[f]){c.push(this._touches[b])}}for(b=0,a=c.length;b<a;b++){this.endTouch(c[b]);this.finishTouch(c[b])}},_touchCount:0,endTouch:function(b,g,c){if(!g){g="touchEnd"}var a,f,d,e;this.unassignTouch(b);if(b.touchResponder){e=b.touchResponder;f=b.touchResponders;a=f.length-1;d=f[a];while(d){if(d[g]){d[g](b,c)}if(b.touchResponder!==e){break}a--;d=f[a];g="touchCancelled"}}},finishTouch:function(b){var a;this.unassignTouch(b);if(a=b._rescuedElement){if(a.swapNode&&a.swapNode.parentNode){a.swapNode.parentNode.replaceChild(a,a.swapNode)}else{if(a.parentNode===SC.touchHoldingPen){SC.touchHoldingPen.removeChild(a)}}delete b._rescuedElement;a.swapNode=null;a=null}b.touchResponders=null;b.touchResponder=null;b.nextTouchResponder=null;b.hasEnded=YES;if(this._touches[b.identifier]){delete this._touches[b.identifier]}},touchstart:function(a){if(this.ignoreTouchHandle(a)){return YES}var b=NO;SC.run(function(){this.endMissingTouches(a.touches);var e,f=a.changedTouches,d=f.length,g,c;a.touchContext=this;for(e=0;e<d;e++){g=f[e];c=SC.Touch.create(g,this);if(!c.targetView){continue}if(c.hidesTouchIntercept){b=YES}c.timeStamp=a.timeStamp;this._touches[g.identifier]=c;c.event=a;this.captureTouch(c,this);c.event=null}},this);if(b){return YES}return a.hasCustomEventHandling},touchmove:function(a){SC.run(function(){var c=a.changedTouches,b,n,l,e=c.length,k,j,h,m,f={},g,d=NO;if(this._drag){b=SC.Touch.create(a.changedTouches[0],this);this._drag.tryToPerform("mouseDragged",b)}for(l=0;l<e;l++){b=c[l];n=this._touches[b.identifier];if(!n){continue}if(n.hidesTouchIntercept){d=YES}n.pageX=b.pageX;n.pageY=b.pageY;n.clientX=b.clientX;n.clientY=b.clientY;n.screenX=b.screenX;n.screenY=b.screenY;n.timeStamp=a.timeStamp;n.event=a;if(n.touchResponder){k=n.touchResponder;g=SC.guidFor(k);if(!f[g]){f[g]={view:k,touches:[]}}f[g].touches.push(n)}}if(d){a.allowDefault();return YES}for(l in f){k=f[l].view;j=f[l].touches;a.viewChangedTouches=j;h=this.touchesForView(k);m=h.firstObject();a.pageX=m.pageX;a.pageY=m.pageY;a.clientX=m.clientX;a.clientY=m.clientY;a.screenX=m.screenX;a.screenY=m.screenY;a.touchContext=this;k.tryToPerform("touchesDragged",a,h)}c=a.changedTouches;e=c.length;for(l=0;l<e;l++){b=c[l];n=this._touches[b.identifier];if(n){n.event=null}}},this);return a.hasCustomEventHandling},touchend:function(b){var c=NO;if(this.ignoreTouchHandle(b)){return YES}SC.run(function(){var h=b.changedTouches,j,f,e,d=h.length,g=b.isCancel?"touchCancelled":"touchEnd";for(e=0;e<d;e++){j=h[e];j.type="touchend";f=this._touches[j.identifier];if(!f){continue}f.timeStamp=b.timeStamp;f.pageX=j.pageX;f.pageY=j.pageY;f.clientX=j.clientX;f.clientY=j.clientY;f.screenX=j.screenX;f.screenY=j.screenY;f.type="touchend";f.event=b;if(f.hidesTouchIntercept){f.unhideTouchIntercept();c=YES}if(this._drag){this._drag.tryToPerform("mouseUp",j);this._drag=null}this.endTouch(f,g,b);this.finishTouch(f)}},this);if(c){return YES}if(SC.browser.isiOS){var a=b.target.tagName;if(a==="INPUT"||a==="TEXTAREA"){window.focus()}else{window.focus();$(".field").blur()}}return b.hasCustomEventHandling},touchcancel:function(a){a.isCancel=YES;this.touchend(a)},ignoreTouchHandle:function(b){if(SC.browser.isiOS||SC.browser.isAndroid){var a=b.target.tagName;if(a==="INPUT"||a==="TEXTAREA"||a==="A"||a==="SELECT"){b.allowDefault();return NO}}return NO},ignoreMouseHandle:function(b){if(SC.browser.isAndroid){var a=b.target.tagName;if(a==="INPUT"||a==="TEXTAREA"||a==="A"||a==="SELECT"){return NO}return YES}return NO},attemptKeyEquivalent:function(b){var d=null;var c=b.commandCodes()[0];if(!c){return NO}var f=this.get("menuPane"),a=this.get("keyPane"),e=this.get("mainPane");if(f){d=f.performKeyEquivalent(c,b);if(d){return d}}if(a){d=a.performKeyEquivalent(c,b);if(d||a.get("isModal")){return d}}if(!d&&e&&(e!==a)){d=e.performKeyEquivalent(c,b);if(d||e.get("isModal")){return d}}return d},_lastModifiers:null,_handleModifierChanges:function(b){var a;a=this._lastModifiers=(this._lastModifiers||{alt:false,ctrl:false,shift:false});var c=false;if(b.altKey!==a.alt){a.alt=b.altKey;c=true}if(b.ctrlKey!==a.ctrl){a.ctrl=b.ctrlKey;c=true}if(b.shiftKey!==a.shift){a.shift=b.shiftKey;c=true}b.modifiers=a;return(c)?(this.sendEvent("flagsChanged",b)?b.hasCustomEventHandling:YES):YES},_isFunctionOrNonPrintableKey:function(a){return !!(a.altKey||a.ctrlKey||a.metaKey||SC.FUNCTION_KEYS[a.which])},_isModifierKey:function(a){return !!SC.MODIFIER_KEYS[a.charCode]},_isPrintableKey:function(a){return((a.originalEvent.which===undefined||a.originalEvent.which>0)&&!(a.which===8||a.which===9||a.which===13||a.which===27))},keydown:function(a){if(SC.none(a)){return YES}var e=a.keyCode;if(SC.browser.isMozilla&&a.keyCode===9){this.keydownCounter=1}if(e===229){this._IMEInputON=YES;return this.sendEvent("keyDown",a)}if(e===27&&this._drag){this._drag.cancelDrag(a);this._drag=null;this._mouseDownView=null;return YES}if(SC.browser.isMozilla&&(a.which===8)){return true}var b=this._handleModifierChanges(a),d=a.target||a.srcElement,c=(a.which===8)&&!SC.allowsBackspaceToPreviousPage&&(d===document.body);if(this._isModifierKey(a)){return(c?NO:b)}b=YES;if(this._isFunctionOrNonPrintableKey(a)){if(e>=37&&e<=40&&SC.browser.isMozilla){return YES}b=this.sendEvent("keyDown",a);if(!b){SC.run(function(){b=!this.attemptKeyEquivalent(a)},this)}else{b=a.hasCustomEventHandling;if(b){c=NO}}}return c?NO:b},keypress:function(b){var c,e=b.keyCode,f=SC.browser.isMozilla;if(f&&b.keyCode===9){this.keydownCounter++;if(this.keydownCounter==2){return YES}}if(f&&(b.which===8)){b.which=e;c=this.sendEvent("keyDown",b);return c?(SC.allowsBackspaceToPreviousPage||b.hasCustomEventHandling):YES}else{var d=(e>=37&&e<=40&&f),a=b.charCode;if((a!==undefined&&a===0&&b.keyCode!==9)&&!d){return YES}if(d){b.which=e}if(d||this._isPrintableKey(b)){return this.sendEvent("keyDown",b)?b.hasCustomEventHandling:YES}}},keyup:function(a){if(this._ffevt){this._ffevt=null}var b=this._handleModifierChanges(a);if(this._isModifierKey(a)){return b}if(this._IMEInputON&&a.keyCode===13){a.isIMEInput=YES;this.sendEvent("keyDown",a);this._IMEInputON=NO}return this.sendEvent("keyUp",a)?a.hasCustomEventHandling:YES},beforedeactivate:function(c){var b=c.toElement;if(b&&b.tagName&&b.tagName!=="IFRAME"){var a=SC.$(b).view()[0];if(a&&a.get("blocksIEDeactivate")){return NO}}return YES},mousedown:function(d){if(this.ignoreMouseHandle(d)){return YES}this._clickCount+=1;if(!this._lastMouseUpAt||this._lastClickWhich!==d.which||((Date.now()-this._lastMouseUpAt)>250)){this._clickCount=1}else{var c=this._lastMouseDownX-d.clientX,a=this._lastMouseDownY-d.clientY,f=Math.sqrt(c*c+a*a);if(f>8){this._clickCount=1}}d.clickCount=this._clickCount;this._lastClickWhich=d.which;this._lastMouseDownX=d.clientX;this._lastMouseDownY=d.clientY;var b=this.targetViewForEvent(d);if(b){fr=b.getPath("pane.firstResponder")}if(fr&&fr.get("blurOnMouseDown")&&fr!==b){fr.resignFirstResponder(d)}b=this._mouseDownView=this.sendEvent("mouseDown",d,b);if(b&&b.respondsTo("mouseDragged")){this._mouseCanDrag=YES}var e=b?d.hasCustomEventHandling:YES;this._lastMouseDownCustomHandling=e;return e},mouseup:function(b){if(this.ignoreMouseHandle(b)){return YES}var g=NO,c=this._drag,f=null;if(c){SC.run(function(){c.tryToPerform("mouseUp",b)})}else{var a=this._mouseDownView,e=this.targetViewForEvent(b);b.clickCount=this._clickCount;if(a){f=this.sendEvent("mouseUp",b,a);if(!f&&(this._clickCount===2)){f=this.sendEvent("doubleClick",b,a);g=YES}if(!f){f=this.sendEvent("click",b,a);g=YES}}if(!f&&!g){if(this._clickCount===2){f=this.sendEvent("doubleClick",b,e)}if(!f){f=this.sendEvent("click",b,e)}}}this._mouseCanDrag=NO;this._mouseDownView=this._drag=null;this._lastMouseUpAt=Date.now();var d=f?b.hasCustomEventHandling:YES;this._lastMouseUpCustomHandling=d;return d},click:function(a){if(!this._lastMouseUpCustomHandling||!this._lastMouseDownCustomHandling){a.preventDefault();a.stopPropagation();return NO}return YES},dblclick:function(a){if(SC.browser.isIE8OrLower){this._clickCount=2;this.mouseup(a)}},mousewheel:function(b){var a=this.targetViewForEvent(b),c=this.sendEvent("mouseWheel",b,a);return(c)?b.hasCustomEventHandling:YES},_lastHovered:null,mousemove:function(a){if(SC.browser.isIE){if(this._lastMoveX===a.clientX&&this._lastMoveY===a.clientY){return}}this._lastMoveX=a.clientX;this._lastMoveY=a.clientY;SC.run(function(){var e=this._drag;if(e){if(SC.browser.isIE){if(this._lastMouseDownX!==a.clientX||this._lastMouseDownY!==a.clientY){e.tryToPerform("mouseDragged",a)}}else{e.tryToPerform("mouseDragged",a)}}else{var d=this._lastHovered||[],f=[],g,b,c=this.targetViewForEvent(a);while(c&&(c!==this)){f.push(c);c=c.get("nextResponder")}for(g=0,b=d.length;g<b;g++){c=d[g];if(f.indexOf(c)===-1){c.tryToPerform("mouseExited",a)}}for(g=0,b=f.length;g<b;g++){c=f[g];if(d.indexOf(c)!==-1){c.tryToPerform("mouseMoved",a)}else{c.tryToPerform("mouseEntered",a)}}this._lastHovered=f;if(this._mouseDownView){if(SC.browser.isIE){if(this._lastMouseDownX!==a.clientX&&this._lastMouseDownY!==a.clientY){this._mouseDownView.tryToPerform("mouseDragged",a)}}else{this._mouseDownView.tryToPerform("mouseDragged",a)}}}},this)},dragenter:function(a){SC.run(function(){this._dragenter(a)},this)},_dragenter:function(a){if(!this._dragCounter){this.sendAction("dataDragDidEnter",null,a);this._dragCounter=1}else{this._dragCounter++}return this._dragover(a)},dragleave:function(a){SC.run(function(){this._dragleave(a)},this)},_dragleave:function(a){this._dragCounter--;var b=this._dragover(a);if(this._dragCounter===0){this.sendAction("dataDragDidExit",null,a)}return b},_forceDragLeave:function(){this.invokeLast(function(){if(this._dragCounter===0){return}this._dragCounter=0;var a=this._lastDraggedEvt;this._dragover(a);this.sendAction("dataDragDidExit",null,a)})},dragover:function(a){SC.run(function(){this._dragover(a)},this)},_dragover:function(c){if(c.dataTransfer.types&&(c.dataTransfer.types.contains("Files")||c.dataTransfer.types.contains("text/uri-list"))){c.preventDefault();c.stopPropagation();c.dataTransfer.dropEffect="none"}this.sendAction("dataDragDidHover",null,c);var d=this._lastDraggedOver||[],f=[],e,a,b=this.targetViewForEvent(c);while(b&&(b!==this)){f.push(b);b=b.get("nextResponder")}if(this._dragLeaveTimer){this._dragLeaveTimer.invalidate()}if(this._dragCounter===0){for(e=0,a=f.length;e<a;e++){b=f[e];b.tryToPerform("dataDragExited",c)}this._lastDraggedOver=this._lastDraggedEvt=this._dragLeaveTimer=null}else{if(c.type!=="dragleave"){for(e=0,a=d.length;e<a;e++){b=d[e];if(f.indexOf(b)===-1){b.tryToPerform("dataDragExited",c)}}for(e=f.length-1;e>=0;e--){b=f[e];if(d.indexOf(b)===-1){b.tryToPerform("dataDragEntered",c)}}for(e=0,a=f.length;e<a;e++){b=f[e];b.tryToPerform("dataDragHovered",c)}this._lastDraggedOver=f;this._lastDraggedEvt=c;this._dragLeaveTimer=SC.Timer.schedule({target:this,action:"_forceDragLeave",interval:300})}}},drop:function(a){SC.run(function(){this._drop(a)},this)},_drop:function(c){if(c.dataTransfer.types&&(c.dataTransfer.types.contains("Files")||c.dataTransfer.types.contains("text/uri-list"))){c.preventDefault();c.stopPropagation();c.dataTransfer.dropEffect="none"}var d=this._lastDraggedOver||[],f=[],e,a,b=this.targetViewForEvent(c);while(b&&(b!==this)){f.push(b);b=b.get("nextResponder")}for(e=0,a=d.length;e<a;e++){b=d[e];if(f.indexOf(b)===-1){b.tryToPerform("dataDragExited",c)}}for(e=0,a=f.length;e<a;e++){b=f[e];if(b.tryToPerform("dataDragDropped",c)){break}}for(e=0,a=f.length;e<a;e++){b=f[e];b.tryToPerform("dataDragExited",c)}this._lastDraggedOver=null;this._lastDraggedAt=null;this._dragCounter=0;if(this._dragLeaveTimer){this._dragLeaveTimer.invalidate()}this._dragLeaveTimer=null;this.sendAction("dataDragDidDrop",null,c);this.sendAction("dataDragDidExit",null,c)},_mouseCanDrag:YES,selectstart:function(b){var c=this.targetViewForEvent(b),a=this.sendEvent("selectStart",b,c);if(c&&c.respondsTo("mouseDragged")){return(a!==null?YES:NO)&&!this._mouseCanDrag}else{return(a!==null?YES:NO)}},drag:function(){return false},contextmenu:function(b){var a=this.targetViewForEvent(b),c;a=this.sendEvent("contextMenu",b,a);c=a?b.hasCustomEventHandling:YES;return c},animationstart:function(b){var a=this.targetViewForEvent(b);this.sendEvent("animationDidStart",b,a);return a?b.hasCustomEventHandling:YES},animationiteration:function(b){var a=this.targetViewForEvent(b);this.sendEvent("animationDidIterate",b,a);return a?b.hasCustomEventHandling:YES},animationend:function(b){var a=this.targetViewForEvent(b);this.sendEvent("animationDidEnd",b,a);return a?b.hasCustomEventHandling:YES},transitionend:function(b){var a=this.targetViewForEvent(b);this.sendEvent("transitionDidEnd",b,a);return a?b.hasCustomEventHandling:YES}});SC.Touch=function(d,a){this.touchContext=a;this.identifier=d.identifier;var c=d.target,b;if(c&&SC.$(c).hasClass("touch-intercept")){d.target.style.webkitTransform="translate3d(0px,-5000px,0px)";c=document.elementFromPoint(d.pageX,d.pageY);if(c){b=SC.$(c).view()[0]}this.hidesTouchIntercept=NO;if(c.tagName==="INPUT"){this.hidesTouchIntercept=d.target}else{d.target.style.webkitTransform="translate3d(0px,0px,0px)"}}else{b=d.target?SC.$(d.target).view()[0]:null}this.targetView=b;this.target=c;this.hasEnded=NO;this.type=d.type;this.clickCount=1;this.view=undefined;this.touchResponder=this.nextTouchResponder=undefined;this.touchResponders=[];this.startX=this.pageX=d.pageX;this.startY=this.pageY=d.pageY;this.clientX=d.clientX;this.clientY=d.clientY;this.screenX=d.screenX;this.screenY=d.screenY};SC.Touch.prototype={unhideTouchIntercept:function(){var a=this.hidesTouchIntercept;if(a){setTimeout(function(){a.style.webkitTransform="translate3d(0px,0px,0px)"},500)}},allowDefault:function(){if(this.event){this.event.hasCustomEventHandling=YES}},preventDefault:function(){if(this.event){this.event.preventDefault()}},stopPropagation:function(){if(this.event){this.event.stopPropagation()}},stop:function(){if(this.event){this.event.stop()}},end:function(){this.touchContext.endTouch(this)},makeTouchResponder:function(b,c,a){this.touchContext.makeTouchResponder(this,b,c,a)},captureTouch:function(a,b){this.touchContext.captureTouch(this,a,b)},touchesForView:function(a){return this.touchContext.touchesForView(a)},touchesForResponder:function(a){return this.touchContext.touchesForView(a)},averagedTouchesForView:function(a,b){return this.touchContext.averagedTouchesForView(a,(b?this:null))}};SC.mixin(SC.Touch,{create:function(b,a){return new SC.Touch(b,a)}});SC.ready(SC.RootResponder,SC.RootResponder.ready=function(){var a;a=SC.RootResponder.responder=SC.RootResponder.create();a.setup()});sc_require("system/core_query");sc_require("system/ready");sc_require("system/root_responder");sc_require("system/platform");SC.PORTRAIT_ORIENTATION="portrait";SC.LANDSCAPE_ORIENTATION="landscape";SC.NO_ORIENTATION="desktop";SC.device=SC.Object.create({orientation:SC.NO_ORIENTATION,isOffline:NO,mouseLocation:function(){var a=SC.RootResponder.responder,c=a._lastMoveX,b=a._lastMoveY;if(SC.empty(c)||SC.empty(b)){return null}return{x:c,y:b}}.property(),init:function(){arguments.callee.base.apply(this,arguments);if(navigator&&navigator.onLine===false){this.set("isOffline",YES)}},setup:function(){var a=SC.RootResponder.responder;a.listenFor(["online","offline"],window,this);this.orientationHandlingShouldChange()},orientationHandlingShouldChange:function(){if(SC.platform.windowSizeDeterminesOrientation){SC.Event.remove(window,"orientationchange",this,this.orientationchange);this.windowSizeDidChange(SC.RootResponder.responder.get("currentWindowSize"))}else{if(SC.platform.supportsOrientationChange){SC.Event.add(window,"orientationchange",this,this.orientationchange);this.orientationchange()}}},windowSizeDidChange:function(a){if(SC.platform.windowSizeDeterminesOrientation){if(!SC.browser.iOS){SC.run(function(){if(SC.platform.touch){if(a.height>=a.width){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}}else{SC.device.set("orientation",SC.NO_ORIENTATION)}})}else{SC.run(function(){if(a.width===window.screen.width){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}})}return YES}return NO},orientationchange:function(a){SC.run(function(){if(window.orientation===0||window.orientation===180){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}})},orientationObserver:function(){var a=SC.$(document.body),b=this.get("orientation");if(b===SC.PORTRAIT_ORIENTATION){a.addClass("portrait")}else{a.removeClass("portrait")}if(b===SC.LANDSCAPE_ORIENTATION){a.addClass("landscape")}else{a.removeClass("landscape")}}.observes("orientation"),online:function(a){this.set("isOffline",NO)},offline:function(a){this.set("isOffline",YES)}});SC.ready(function(){SC.device.setup()});SC.MODIFIED_KEY_BINDINGS={"ctrl_.":"cancel",shift_tab:"insertBacktab",shift_left:"moveLeftAndModifySelection",shift_right:"moveRightAndModifySelection",shift_up:"moveUpAndModifySelection",shift_down:"moveDownAndModifySelection",alt_left:"moveLeftAndModifySelection",alt_right:"moveRightAndModifySelection",alt_up:"moveUpAndModifySelection",alt_down:"moveDownAndModifySelection",ctrl_a:"selectAll"};SC.BASE_KEY_BINDINGS={escape:"cancel",backspace:"deleteBackward","delete":"deleteForward","return":"insertNewline",tab:"insertTab",left:"moveLeft",right:"moveRight",up:"moveUp",down:"moveDown",home:"moveToBeginningOfDocument",end:"moveToEndOfDocument",pagedown:"pageDown",pageup:"pageUp"};SC.Page=SC.Object.extend({owner:null,get:function(a){var b=this[a];if(b&&b.isClass){this[a]=b=b.create({page:this});if(!this.get("inDesignMode")){b.awake()}return b}else{return arguments.callee.base.apply(this,arguments)}},awake:function(){var b,a;for(a in this){if(!this.hasOwnProperty(a)){continue}b=this[a];if(b&&b.isViewClass){this[a]=b=b.create({page:this})}}return this},getIfConfigured:function(b){var a=this[b];return(a&&a.isViewClass)?null:this.get(b)},loc:function(c){var a,b;for(b in c){if(!c.hasOwnProperty(b)){continue}a=this[b];if(!a||!a.isViewClass){continue}a.loc(c[b])}return this}});SC.Page.design=SC.Page.create;SC.Page.localization=function(a){return a};sc_require("system/builder");SC.MODE_REPLACE="replace";SC.MODE_APPEND="append";SC.MODE_PREPEND="prepend";SC.NON_PIXEL_PROPERTIES=["zIndex","fontWeight","opacity"];SC.COMBO_STYLES={WebkitTransition:["WebkitTransitionProperty","WebkitTransitionDuration","WebkitTransitionDelay","WebkitTransitionTimingFunction"]};SC.RenderContext=SC.Builder.create({SELF_CLOSING:SC.CoreSet.create().addEach(["area","base","basefront","br","hr","input","img","link","meta"]),init:function(e,d){var b,a;if(d){this.prevObject=d;this.strings=d.strings;this.offset=d.length+d.offset}if(!this.strings){this.strings=[]}if(e===undefined){e="div";a=YES}else{if(e==="div"||e==="label"||e==="a"){a=YES}else{if(SC.typeOf(e)===SC.T_STRING){e=e.toLowerCase();a=YES}}}if(a){this._tagName=e;this._needsTag=YES;this.needsContent=YES;var f=this;while(f){f.length++;f=f.prevObject}this.strings.push(null);this._selfClosing=this.SELF_CLOSING.contains(e)}else{this._elem=e;this._needsTag=NO;this.length=0;this.needsContent=NO}return this},strings:null,offset:0,length:0,updateMode:SC.MODE_REPLACE,needsContent:NO,get:function(b){var a=this.strings||[];return(b===undefined)?a.slice(this.offset,this.length):a[b+this.offset]},push:function(d){var b=this.strings,a=arguments.length;if(!b){this.strings=b=[]}if(a>1){b.push.apply(b,arguments)}else{b.push(d)}var e=this;while(e){e.length+=a;e=e.prevObject}this.needsContent=YES;return this},text:function(c){var b=arguments.length,a=0;for(a=0;a<b;a++){this.push(SC.RenderContext.escapeHTML(arguments[a]))}return this},join:function(b){if(this._needsTag){this.end()}var a=this.strings;return a?a.join(b||""):""},begin:function(a){return SC.RenderContext(a,this)},element:function(){return this._elem?this._elem:SC.$(this.join())[0]},remove:function(a){if(!a){return}var b,c=this._elem;if(!c||!c.removeChild){return}b=document.getElementById(a);if(b){b=c.removeChild(b);b=null}},update:function(){var c=this._elem,g=this.updateMode,e,d,a,f,b;this._innerHTMLReplaced=NO;if(!c){return}e=this.$();if(this.length>0){this._innerHTMLReplaced=YES;if(g===SC.MODE_REPLACE){e.html(this.join())}else{a=c.cloneNode(false);a.innerHTML=this.join();f=a.firstChild;while(f){b=f.nextSibling;c.insertBefore(f,b);f=b}f=b=a=null}}if(this._idDidChange&&(d=this._id)){e.attr("id",d)}jQuery.Buffer.flush();c=this._elem=null;return this.prevObject||this},_DEFAULT_ATTRS:{},end:function(){var o="",b="",d,m,k,h,l=this._attrs,e=this._classNames,a=this._id,n=this._styles,j,g;o="<"+this._tagName;if(l||e||n||a){if(!l){l=this._DEFAULT_ATTRS}if(a){l.id=a}if(e){l["class"]=e.join(" ")}if(n){for(k in n){if(!n.hasOwnProperty(k)){continue}h=n[k];if(h===null){continue}if(typeof h===SC.T_NUMBER&&!SC.NON_PIXEL_PROPERTIES.contains(k)){h+="px"}b=b+this._dasherizeStyleName(k)+": "+h+"; "}l.style=b}o=o+" ";for(k in l){if(!l.hasOwnProperty(k)){continue}h=l[k];if(h===null){continue}o=o+k+'="'+h+'" '}if(l===this._DEFAULT_ATTRS){delete l.style;delete l["class"];delete l.id}}j=this.strings;g=(this._selfClosing===NO)?NO:(this.length===1);o=o+(g?" />":">");j[this.offset]=o;if(!g){j.push("</"+this._tagName+">");var f=this;while(f){f.length++;f=f.prevObject}}this._elem=null;return this.prevObject||this},tag:function(a,b){return this.begin(a,b).end()},tagName:function(a){if(a===undefined){if(!this._tagName&&this._elem){this._tagName=this._elem.tagName}return this._tagName}else{this._tagName=a;this._tagNameDidChange=YES;return this}},id:function(a){if(a===undefined){if(!this._id&&this._elem){this._id=this._elem.id}return this._id}else{this._id=a;this._idDidChange=YES;return this}},classNames:function(b,a){if(this._elem){if(b){this.$().resetClassNames().addClass(b);return this}else{return this.$().attr("class").split(" ")}}if(b===undefined){if(this._cloneClassNames){this._classNames=(this._classNames||[]).slice();this._cloneClassNames=NO}if(!this._classNames){this._classNames=[]}return this._classNames}else{this._classNames=b;this._cloneClassNames=a||NO;this._classNamesDidChange=YES;return this}},hasClass:function(a){if(this._elem){return this.$().hasClass(a)}return this.classNames().indexOf(a)>=0},addClass:function(f){if(f===undefined||f===null){SC.Logger.warn("You are adding an undefined or empty class"+this.toString());return this}if(this._elem){if(SC.typeOf(f)===SC.T_STRING){this.$().addClass(f)}else{var c,b=f.length;for(c=0;c<b;c++){this.$().addClass(f[c])}}return this}var g=this.classNames();if(SC.typeOf(f)===SC.T_STRING){if(g.indexOf(f)<0){g.push(f);this._classNamesDidChange=YES}}else{var d;for(var e=0,a=f.length;e<a;e++){d=f[e];if(g.indexOf(d)<0){g.push(d);this._classNamesDidChange=YES}}}return this},removeClass:function(b){if(this._elem){this.$().removeClass(b);return this}var c=this._classNames,a;if(c&&(a=c.indexOf(b))>=0){if(this._cloneClassNames){c=this._classNames=c.slice();this._cloneClassNames=NO}c[a]=null;this._classNamesDidChange=YES}return this},resetClassNames:function(){if(this._elem){this.$().resetClassNames();return this}this._classNames=[];this._classNamesDidChange=YES;return this},setClass:function(d,c){if(this._elem){this.$().setClass(d,c);return this}var f,a,b,e;if(c!==undefined){return c?this.addClass(d):this.removeClass(d)}else{f=this._classNames;if(!f){f=this._classNames=[]}if(this._cloneClassNames){f=this._classNames=f.slice();this._cloneClassNames=NO}e=NO;for(b in d){if(!d.hasOwnProperty(b)){continue}a=f.indexOf(b);if(d[b]){if(a<0){f.push(b);e=YES}}else{if(a>=0){f[a]=null;e=YES}}}if(e){this._classNamesDidChange=YES}}return this},_STYLE_REGEX:/-?\s*([^:\s]+)\s*:\s*([^;]+)\s*;?/g,styles:function(d,e){if(this._elem){if(d){this.$().resetStyles().css(d)}return this.$().styles()}var a,c,b;if(d===undefined){if(!this._styles&&this._elem){a=this.$().attr("style");if(a&&(a=a.toString()).length>0){if(SC.browser.name===SC.BROWSER.ie){a=a.toLowerCase()}d={};c=this._STYLE_REGEX;c.lastIndex=0;while(b=c.exec(a)){d[this._camelizeStyleName(b[1])]=b[2]}this._styles=d;this._cloneStyles=NO}else{this._styles={}}}else{if(!this._styles){this._styles={}}else{if(this._cloneStyles){this._styles=SC.clone(this._styles);this._cloneStyles=NO}}}return this._styles}else{this._styles=d;this._cloneStyles=e||NO;this._stylesDidChange=YES;return this}},_deleteComboStyles:function(e,d){var g=SC.COMBO_STYLES[d],f=NO,c;if(g){for(var a=0,b=g.length;a<b;a++){c=g[a];if(e[c]){delete e[c];f=YES}}}return f},resetStyles:function(){this.styles({});return this},addStyle:function(a,e){if(this._elem){this.$().css(a,e);return this}var b,d=NO,c=this.styles();if(typeof a===SC.T_STRING){if(e===undefined){return c[a]}else{d=this._deleteComboStyles(c,a);if(c[a]!==e){c[a]=e;d=YES}if(d){this._stylesDidChange=YES}}}else{for(b in a){if(!a.hasOwnProperty(b)){continue}d=d||this._deleteComboStyles(c,b);e=a[b];if(c[b]!==e){c[b]=e;d=YES}}if(d){this._stylesDidChange=YES}}return this},removeStyle:function(a){if(this._elem){this.$().css(a,null);return this}if(!this._styles){return this}var b=this.styles();if(b[a]){b[a]=null;this._stylesDidChange=YES}},attr:function(a,e){if(this._elem){this.$().attr(a,e);return this}var c,b=this._attrs,d=NO;if(!b){this._attrs=b={}}if(typeof a===SC.T_STRING){if(e===undefined){return b[a]}else{if(b[a]!==e){b[a]=e;this._attrsDidChange=YES}}}else{for(c in a){if(!a.hasOwnProperty(c)){continue}e=a[c];if(b[c]!==e){b[c]=e;d=YES}}if(d){this._attrsDidChange=YES}}return this},removeAttr:function(a){if(this._elem){this.$().removeAttr(a);return this}},$:function(c){var a,b=this._elem;a=!b?SC.$.buffer([]):(c===undefined)?SC.$.buffer(b):SC.$.buffer(c,b);b=null;return a},_camelizeStyleName:function(a){var b=a.match(/^-(webkit|moz|o)-/),c=SC.String.camelize(a);if(b){return c.substr(0,1).toUpperCase()+c.substr(1)}else{return c}},_dasherizeStyleName:function(a){var b=SC.String.dasherize(a);if(b.match(/^(webkit|moz|ms|o)-/)){b="-"+b}return b}});SC.RenderContext.fn.html=SC.RenderContext.fn.push;SC.RenderContext.fn.css=SC.RenderContext.fn.addStyle;(function(){var b=/[&<> ]/g,a=function(c){switch(c){case" ":return"&nbsp;";case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;"}};SC.RenderContext.escapeHTML=function(c){if(!c){return""}if(SC.typeOf(c)===SC.T_NUMBER){c=c.toString()}return c.replace(b,a)}})();(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelRequestAnimationFrame=window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}}());SC.SelectionSet=SC.Object.extend(SC.Enumerable,SC.Freezable,SC.Copyable,{isSelectionSet:YES,length:function(){var a=0,b=this._sets,c=this._objects;if(c){a+=c.get("length")}if(b){b.forEach(function(d){a+=d.get("length")})}return a}.property().cacheable(),sources:function(){var c=[],d=this._sets,b=d?d.length:0,a,f,e;for(a=0;a<b;a++){f=d[a];if(f&&f.get("length")>0&&f.source){c.push(f.source)}}return c}.property().cacheable(),indexSetForSource:function(e){if(!e||!e.isSCArray){return null}var b=this._indexSetCache,d=this._objects,c,a;if(!b){b=this._indexSetCache={}}c=b[SC.guidFor(e)];if(c&&c._sourceRevision&&(c._sourceRevision!==e.propertyRevision)){c=null}if(!c){c=this._indexSetForSource(e,NO);if(c&&c.get("length")===0){c=null}if(d){if(c){c=c.copy()}d.forEach(function(f){if((a=e.indexOf(f))>=0){if(!c){c=SC.IndexSet.create()}c.add(a)}},this)}if(c){c=b[SC.guidFor(e)]=c.frozenCopy();c._sourceRevision=e.propertyRevision}}return c},_indexSetForSource:function(f,g){if(g===undefined){g=YES}var d=SC.guidFor(f),c=this[d],e=this._sets,a=e?e.length:0,b=null;if(c>=a){c=null}if(SC.none(c)){if(g&&!this.isFrozen){this.propertyWillChange("sources");if(!e){e=this._sets=[]}b=e[a]=SC.IndexSet.create();b.source=f;this[d]=a;this.propertyDidChange("sources")}}else{b=e?e[c]:null}return b},add:function(a,b,d){if(this.isFrozen){throw SC.FROZEN_ERROR}var g,f,k,j,c,e,h,l;if(b===undefined&&d===undefined){if(!a){throw"Must pass params to SC.SelectionSet.add()"}if(a.isIndexSet){return this.add(a.source,a)}if(a.isSelectionSet){g=a._sets;l=a._objects;f=g?g.length:0;this.beginPropertyChanges();for(k=0;k<f;k++){j=g[k];if(j&&j.get("length")>0){this.add(j.source,j)}}if(l){this.addObjects(l)}this.endPropertyChanges();return this}}j=this._indexSetForSource(a,YES);c=this.get("length");h=j.get("length");e=c-h;j.add(b,d);this._indexSetCache=null;e+=j.get("length");if(e!==c){this.propertyDidChange("length");this.enumerableContentDidChange();if(h===0){this.notifyPropertyChange("sources")}}return this},remove:function(a,b,d){if(this.isFrozen){throw SC.FROZEN_ERROR}var g,f,k,j,c,e,h,l;if(b===undefined&&d===undefined){if(!a){throw"Must pass params to SC.SelectionSet.remove()"}if(a.isIndexSet){return this.remove(a.source,a)}if(a.isSelectionSet){g=a._sets;l=a._objects;f=g?g.length:0;this.beginPropertyChanges();for(k=0;k<f;k++){j=g[k];if(j&&j.get("length")>0){this.remove(j.source,j)}}if(l){this.removeObjects(l)}this.endPropertyChanges();return this}}j=this._indexSetForSource(a,YES);c=this.get("length");e=c-j.get("length");if(j&&(l=this._objects)){if(d!==undefined){b=SC.IndexSet.create(b,d);d=undefined}l.forEach(function(m){k=a.indexOf(m);if(b.contains(k)){l.remove(m);e--}},this)}j.remove(b,d);h=j.get("length");e+=h;this._indexSetCache=null;if(e!==c){this.propertyDidChange("length");this.enumerableContentDidChange();if(h===0){this.notifyPropertyChange("sources")}}return this},contains:function(b,d,a){if(d===undefined&&a===undefined){return this.containsObject(b)}var c=this.indexSetForSource(b);if(!c){return NO}return c.contains(d,a)},intersects:function(b,d,a){var c=this.indexSetForSource(b,NO);if(!c){return NO}return c.intersects(d,a)},_TMP_ARY:[],addObject:function(b){var c=this._TMP_ARY,a;c[0]=b;a=this.addObjects(c);c.length=0;return a},addObjects:function(a){var d=this._objects,b,c;if(!d){d=this._objects=SC.CoreSet.create()}b=d.get("length");d.addEach(a);c=d.get("length");this._indexSetCache=null;if(c!==b){this.propertyDidChange("length");this.enumerableContentDidChange()}return this},removeObject:function(b){var c=this._TMP_ARY,a;c[0]=b;a=this.removeObjects(c);c.length=0;return a},removeObjects:function(b){var e=this._objects,c,d,a;if(!e){return this}c=e.get("length");e.removeEach(b);d=e.get("length");if(a=this._sets){a.forEach(function(f){c+=f.get("length");f.removeObjects(b);d+=f.get("length")},this)}this._indexSetCache=null;if(d!==c){this.propertyDidChange("length");this.enumerableContentDidChange()}return this},containsObject:function(c){var e=this._objects;if(e&&e.contains(c)){return YES}var d=this._sets,b=d?d.length:0,a,f;for(a=0;a<b;a++){f=d[a];if(f&&f.indexOf(c)>=0){return YES}}return NO},constrain:function(e){var g,b,a,d;this.beginPropertyChanges();this.get("sources").forEach(function(h){if(h===e){return}var j=this._indexSetForSource(e,NO);if(j){this.remove(e,j)}},this);g=this._indexSetForSource(e,NO);if(g&&((a=g.get("max"))>(b=e.get("length")))){this.remove(e,b,a-b)}if(d=this._objects){var c,f;for(c=d.length-1;c>=0;c--){f=d[c];if(e.indexOf(f)<0){this.removeObject(f)}}}this.endPropertyChanges();return this},isEqual:function(g){var f,d,b,a,c,e;if(!g||!g.isSelectionSet){return NO}if(g===this){return YES}if((this._sets===g._sets)&&(this._objects===g._objects)){return YES}if(this.get("length")!==g.get("length")){return NO}f=this._objects;d=g._objects;if(f||d){if((f?f.get("length"):0)!==(d?d.get("length"):0)){return NO}if(f&&!f.isEqual(d)){return NO}}c=this.get("sources");a=c.get("length");for(b=0;b<a;b++){e=c.objectAt(b);f=this._indexSetForSource(e,NO);d=this._indexSetForSource(e,NO);if(!!d!==!!f){return NO}if(f&&!f.isEqual(d)){return NO}}return YES},clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}if(this._sets){this._sets.length=0}if(this._objects){this._objects=null}this._indexSetCache=null;this.propertyDidChange("length");this.enumerableContentDidChange();this.notifyPropertyChange("sources");return this},copy:function(){var c=this.constructor.create(),d=this._sets,b=d?d.length:0,a,e;if(d&&b>0){d=c._sets=d.slice();for(a=0;a<b;a++){if(!(e=d[a])){continue}e=d[a]=e.copy();c[SC.guidFor(e.source)]=a}}if(this._objects){c._objects=this._objects.copy()}return c},freeze:function(){if(this.get("isFrozen")){return this}var a=this._sets,b=a?a.length:0,c;while(--b>=0){c=a[b];if(c){c.freeze()}}if(this._objects){this._objects.freeze()}this.set("isFrozen",YES);return this},toString:function(){var a=this._sets||[];a=a.map(function(b){return b.toString().replace("SC.IndexSet",SC.guidFor(b.source))},this);if(this._objects){a.push(this._objects.toString())}return"SC.SelectionSet:%@<%@>".fmt(SC.guidFor(this),a.join(","))},firstObject:function(){var b=this._sets,c=this._objects;if(b&&b.get("length")>0){var e=b?b[0]:null,d=e?e.source:null,a=e?e.firstObject():-1;if(d&&a>=0){return d.objectAt(a)}}return c?c.firstObject():undefined}.property(),nextObject:function(c,e,b){var d,a;if(c===0){d=b.objects=[];this.forEach(function(f){d.push(f)},this);b.max=d.length}d=b.objects;a=d[c];if(c+1>=b.max){b.objects=b.max=null}return a},forEach:function(g,e){var c=this._sets,d=this._objects,b=c?c.length:0,f,a;for(a=0;a<b;a++){f=c[a];if(f){f.forEachObject(g,e)}}if(d){d.forEach(g,e)}return this}});SC.SelectionSet.prototype.clone=SC.SelectionSet.prototype.copy;SC.SelectionSet.EMPTY=SC.SelectionSet.create().freeze();sc_require("mixins/delegate_support");SC.SparseArray=SC.Object.extend(SC.Observable,SC.Enumerable,SC.Array,SC.DelegateSupport,{_requestingLength:0,_requestingIndex:0,length:function(){var a=this.delegate;if(a&&SC.none(this._length)&&a.sparseArrayDidRequestLength){this._requestingLength++;a.sparseArrayDidRequestLength(this);this._requestingLength--}return this._length||0}.property().cacheable(),provideLength:function(b){var a;if(SC.none(b)){this._sa_content=null}if(b!==this._length){a=this._length;this._length=b;if(this._requestingLength<=0){this.arrayContentDidChange(0,a||0,b||0)}}return this},rangeWindowSize:1,requestedRangeIndex:null,init:function(){arguments.callee.base.apply(this,arguments);this.requestedRangeIndex=[];this._TMP_PROVIDE_ARRAY=[];this._TMP_PROVIDE_RANGE={length:1};this._TMP_RANGE={}},objectAt:function(a,d){var c=this._sa_content,b;if(!c){c=this._sa_content=[]}if((b=c[a])===undefined){if(!d){this.requestIndex(a)}b=c[a]}return b},definedIndexes:function(d){var c=SC.IndexSet.create(),e=this._sa_content,b,a;if(!e){return c.freeze()}if(d){d.forEach(function(f){if(e[f]!==undefined){c.add(f)}})}else{a=e.length;for(b=0;b<a;b++){if(e[b]!==undefined){c.add(b)}}}return c.freeze()},_TMP_RANGE:{},requestIndex:function(b){var c=this.delegate;if(!c){return this}var a=this.get("rangeWindowSize"),e=b;if(a>1){e=e-Math.floor(e%a)}if(a<1){a=1}this._requestingIndex++;if(c.sparseArrayDidRequestRange){var d=this._TMP_RANGE;if(this.wasRangeRequested(e)===-1){d.start=e;d.length=a;this.requestedRangeIndex.push(e);c.sparseArrayDidRequestRange(this,d)}}else{if(c.sparseArrayDidRequestIndex){while(--a>=0){c.sparseArrayDidRequestIndex(this,e+a)}}}this._requestingIndex--;return this},wasRangeRequested:function(c){var b,a;for(b=0,a=this.requestedRangeIndex.length;b<a;b++){if(this.requestedRangeIndex[b]===c){return b}}return -1},rangeRequestCompleted:function(b){var a=this.wasRangeRequested(b);if(a>=0){this.requestedRangeIndex.removeAt(a,1);return YES}return NO},provideObjectsInRange:function(b,e){var c=this._sa_content;if(!c){c=this._sa_content=[]}var d=b.start,a=b.length;while(--a>=0){c[d+a]=e.objectAt(a)}if(this._requestingIndex<=0){this.arrayContentDidChange(b.start,b.length,b.length)}return this},provideObjectAtIndex:function(c,b){var d=this._TMP_PROVIDE_ARRAY,a=this._TMP_PROVIDE_RANGE;d[0]=b;a.start=c;return this.provideObjectsInRange(a,d)},objectsDidChangeInRange:function(a){var b=this._sa_content;if(b){if(a.start===0&&SC.maxRange(a)>=b.length){this._sa_content=null}else{var d=a.start,c=Math.min(d+a.length,b.length);while(--c>=d){b[c]=undefined}}}this.arrayContentDidChange(a.start,a.length,a.length);return this},indexOf:function(d){var e,b,a=this.delegate;if(a&&a.sparseArrayDidRequestIndexOf){b=a.sparseArrayDidRequestIndexOf(this,d)}if(SC.none(b)){e=this._sa_content;if(!e){e=this._sa_content=[]}b=e.indexOf(d)}return b},replace:function(b,g,e){e=e||[];var c=this.delegate;if(c){if(!c.sparseArrayShouldReplace||!c.sparseArrayShouldReplace(this,b,g,e)){return this}}var d=this._sa_content;if(!d){d=this._sa_content=[]}d.replace(b,g,e);var a=e?(e.get?e.get("length"):e.length):0;var f=a-g;this.arrayContentWillChange(b,g,a);if(!SC.none(this._length)){this.propertyWillChange("length");this._length+=f;this.propertyDidChange("length")}this.beginPropertyChanges();this.arrayContentDidChange(b,g,a);this.enumerableContentDidChange(b,g,f);this.endPropertyChanges();return this},reset:function(){var a;this._sa_content=null;a=this._length;this._length=null;this.arrayContentDidChange(0,a,0);this.invokeDelegateMethod(this.delegate,"sparseArrayDidReset",this);return this}});SC.SparseArray.array=function(a){return this.create({_length:a||0})};SC.Timer=SC.Object.extend({target:null,action:null,isPooled:NO,interval:0,startTime:null,repeats:NO,until:null,isPaused:NO,isScheduled:NO,isValid:YES,lastFireTime:0,fireTime:function(){if(!this.get("isValid")){return -1}var e=this.get("startTime");if(!e||e===0){return -1}var a=this.get("interval"),c=this.get("lastFireTime");if(c<e){c=e}var b;if(this.get("repeats")){if(a===0){b=c}else{b=e+(Math.floor((c-e)/a)+1)*a}}else{b=e+a}var d=this.get("until");if(d&&d>0&&b>d){b=d}return b}.property("interval","startTime","repeats","until","isValid","lastFireTime").cacheable(),schedule:function(){if(!this.get("isValid")){return this}this.beginPropertyChanges();if(!this.startTime){this.set("startTime",SC.RunLoop.currentRunLoop.get("startTime"))}var a=this.get("fireTime"),b=this.get("lastFireTime");if(a>=b){this.set("isScheduled",YES);SC.RunLoop.currentRunLoop.scheduleTimer(this,a)}this.endPropertyChanges();return this},invalidate:function(){this.beginPropertyChanges();this.set("isValid",NO);var a=SC.RunLoop.currentRunLoop;if(a){a.cancelTimer(this)}this.action=this.target=null;this.endPropertyChanges();if(this.get("isPooled")){SC.Timer.returnTimerToPool(this)}return this},fire:function(){var b=Date.now();this.set("lastFireTime",b);var a=this.get("fireTime");if(!this.get("isPaused")){this.performAction()}if(a>b){this.schedule()}else{this.invalidate()}},performAction:function(){var a=SC.typeOf(this.action);if(a==SC.T_FUNCTION){this.action.call((this.target||this),this)}else{if(a===SC.T_STRING){if(this.action.indexOf(".")>=0){var e=this.action.split(".");var c=e.pop();var d=SC.objectForPropertyPath(e,window);var b=d.get?d.get(c):d[c];if(b&&SC.typeOf(b)==SC.T_FUNCTION){b.call(d,this)}else{throw"%@: Timer could not find a function at %@".fmt(this,this.action)}}else{SC.RootResponder.responder.sendAction(this.action,this.target,this)}}}},init:function(){arguments.callee.base.apply(this,arguments);if(this.startTime instanceof Date){this.startTime=this.startTime.getTime()}if(this.until instanceof Date){this.until=this.until.getTime()}},RESET_DEFAULTS:{target:null,action:null,isPooled:NO,isPaused:NO,isScheduled:NO,isValid:YES,interval:0,repeats:NO,until:null,startTime:null,lastFireTime:0},reset:function(b){if(!b){b=SC.EMPTY_HASH}this.propertyWillChange("fireTime");var c=this.RESET_DEFAULTS;for(var a in c){if(!c.hasOwnProperty(a)){continue}this[a]=SC.none(b[a])?c[a]:b[a]}this.propertyDidChange("fireTime");return this},removeFromTimerQueue:function(c){var b=this._timerQueuePrevious,a=this._timerQueueNext;if(!b&&!a&&c!==this){return c}if(b){b._timerQueueNext=a}if(a){a._timerQueuePrevious=b}this._timerQueuePrevious=this._timerQueueNext=null;return(c===this)?a:c},scheduleInTimerQueue:function(c,b){this._timerQueueRunTime=b;var a=c;var d=null;while(a&&a._timerQueueRunTime<b){d=a;a=a._timerQueueNext}if(d){d._timerQueueNext=this;this._timerQueuePrevious=d}if(a){a._timerQueuePrevious=this;this._timerQueueNext=a}return(a===c)?this:c},collectExpiredTimers:function(c,a){if(this._timerQueueRunTime>a){return this}c.push(this);var b=this._timerQueueNext;this._timerQueueNext=null;if(b){b._timerQueuePrevious=null}return b?b.collectExpiredTimers(c,a):null}});SC.Timer.schedule=function(a){var b;if(!a||SC.none(a.isPooled)||a.isPooled){b=this.timerFromPool(a)}else{b=this.create(a)}return b.schedule()};SC.Timer.timerFromPool=function(a){var b=this._timerPool;if(!b){b=this._timerPool=[]}var c=b.pop();if(!c){c=this.create()}return c.reset(a)};SC.Timer.returnTimerToPool=function(a){if(!this._timerPool){this._timerPool=[]}this._timerPool.push(a);return this};sc_require("system/browser");SC.mixin({normalizeURL:function(a){if(a.slice(0,1)=="/"){a=window.location.protocol+"//"+window.location.host+a}else{if((a.slice(0,5)=="http:")||(a.slice(0,6)=="https:")){}else{a=window.location.href+"/"+a}}return a},isPercentage:function(a){return(a<1&&a>0)},minX:function(a){return a.x||0},maxX:function(a){return(a.x||0)+(a.width||0)},midX:function(a){return(a.x||0)+((a.width||0)/2)},minY:function(a){return a.y||0},maxY:function(a){return(a.y||0)+(a.height||0)},midY:function(a){return(a.y||0)+((a.height||0)/2)},centerX:function(b,a){return(a.width-b.width)/2},centerY:function(b,a){return(a.height-b.height)/2},offset:function(d,c){var f,b,h,a;c=c||"document";if(c==="parent"){a=jQuery(d).position()}else{a=jQuery(d).offset();if(SC.browser.isMobileSafari){f=navigator.userAgent;b=f.indexOf("Mobile/");h=f.substring(b+7,b+9);if(parseInt(SC.browser.mobileSafari,0)<=532||(h<="8A")){a.left-=window.pageXOffset;a.top-=window.pageYOffset}}if(c==="viewport"){if(SC.browser.isIE8OrLower){a.left-=$(window).scrollLeft();a.top-=$(window).scrollTop()}else{a.left-=window.pageXOffset;a.top-=window.pageYOffset}}}try{a.x=a.left;a.y=a.top}catch(g){a={x:a.left,y:a.top}}delete a.left;delete a.top;return a},viewportOffset:function(b){var a=SC.offset(b,"viewport");return{x:a.left,y:a.top}}});SC.mixin({ZERO_POINT:{x:0,y:0},pointInRect:function(a,b){return(a.x>=SC.minX(b))&&(a.y>=SC.minY(b))&&(a.x<=SC.maxX(b))&&(a.y<=SC.maxY(b))},rectsEqual:function(b,a,c){if(!b||!a){return(b==a)}if(!c&&c!==0){c=0.1}if((b.y!=a.y)&&(Math.abs(b.y-a.y)>c)){return NO}if((b.x!=a.x)&&(Math.abs(b.x-a.x)>c)){return NO}if((b.width!=a.width)&&(Math.abs(b.width-a.width)>c)){return NO}if((b.height!=a.height)&&(Math.abs(b.height-a.height)>c)){return NO}return YES},intersectRects:function(b,a){var c={x:Math.max(SC.minX(b),SC.minX(a)),y:Math.max(SC.minY(b),SC.minY(a)),width:Math.min(SC.maxX(b),SC.maxX(a)),height:Math.min(SC.maxY(b),SC.maxY(a))};c.width=Math.max(0,c.width-c.x);c.height=Math.max(0,c.height-c.y);return c},unionRects:function(b,a){var c={x:Math.min(SC.minX(b),SC.minX(a)),y:Math.min(SC.minY(b),SC.minY(a)),width:Math.max(SC.maxX(b),SC.maxX(a)),height:Math.max(SC.maxY(b),SC.maxY(a))};c.width=Math.max(0,c.width-c.x);c.height=Math.max(0,c.height-c.y);return c},cloneRect:function(a){return{x:a.x,y:a.y,width:a.width,height:a.height}},stringFromRect:function(a){if(!a){return"(null)"}else{return"{x:"+a.x+", y:"+a.y+", width:"+a.width+", height:"+a.height+"}"}}});sc_require("panes/pane");sc_require("panes/keyboard");sc_require("panes/layout");sc_require("panes/manipulation");sc_require("panes/visibility");SC.MainPane=SC.Pane.extend({layout:{top:0,left:0,bottom:0,right:0,minHeight:200,minWidth:200},init:function(){var c={x:0,y:0,width:1000,height:1000},a=this.get("layout"),b=false;if(document&&document.body){c.width=document.body.clientWidth;c.height=document.body.clientHeight;if(a.minHeight||a.minWidth){if((a.minHeight&&c.height<a.minHeight)||(a.minWidth&&c.width<a.minWidth)){SC.bodyOverflowArbitrator.requestVisible(this)}else{SC.bodyOverflowArbitrator.requestHidden(this)}}}arguments.callee.base.apply(this,arguments)},paneDidAttach:function(){var b=arguments.callee.base.apply(this,arguments),a=this.rootResponder;a.makeMainPane(this);if(!a.get("keyRootView")){a.makeKeyPane(this)}return b},acceptsKeyPane:YES,classNames:["sc-main"]});SC.routes=SC.Object.create({wantsHistory:NO,usesHistory:null,baseURI:document.baseURI,_didSetup:NO,_location:null,_firstRoute:null,_extractParametersAndRoute:function(d,b){var a={},j=d.route||"",f,c,e,h,g,k;f=(j.indexOf("?")<0&&j.indexOf("&")>=0)?"&":"?";c=j.split(f);j=c.shift();a=this.deparam(c.join("&"),b||false);for(k in d){if(d.hasOwnProperty(k)&&k!=="route"){a[k]=""+d[k]}}a.params=f+$.param(a);a.route=j;return a},location:function(a,b){this._skipRoute=NO;return this._extractLocation(a,b)}.property(),informLocation:function(a,b){this._skipRoute=YES;var c=this.location.lastSetValueKey;if(c&&this._kvo_cache){this._kvo_cache[c]=b}return this._extractLocation(a,b)}.property(),_extractLocation:function(c,d){var a,b;if(d!==undefined){if(d===null){d=""}if(typeof(d)==="object"){a=this._extractParametersAndRoute(d);d=a.route+a.params}if(!SC.empty(d)||(this._location&&this._location!==d)){b=encodeURI(d);if(this.usesHistory){if(b.length>0){b="/"+b}window.history.pushState(null,null,this.get("baseURI")+b)}else{window.location.hash=b}}this._location=d}return this._location},ping:function(){var a;if(!this._didSetup){this._didSetup=YES;if(this.get("wantsHistory")&&SC.platform.supportsHistory){this.usesHistory=YES;this.popState();SC.Event.add(window,"popstate",this,this.popState)}else{this.usesHistory=NO;if(SC.platform.supportsHashChange){this.hashChange();SC.Event.add(window,"hashchange",this,this.hashChange)}else{a=this;this._invokeHashChange=function(){a.hashChange();setTimeout(a._invokeHashChange,100)};this._invokeHashChange()}}}},hashChange:function(a){var b=window.location.hash;b=(b&&b.length>0)?b.slice(1,b.length):"";if(!SC.browser.isMozilla){b=decodeURI(b)}if(this.get("location")!==b&&!this._skipRoute){SC.run(function(){this.set("location",b)},this)}this._skipRoute=false},popState:function(a){var b=this.get("baseURI"),c=document.location.href;if(c.slice(0,b.length)===b){c=c.slice(b.length+1,c.length);if(this.get("location")!==c&&!this._skipRoute){SC.run(function(){this.set("location",c)},this)}}this._skipRoute=false},add:function(a,b,c){if(!this._didSetup){this.invokeLast(this.ping)}if(c===undefined&&SC.typeOf(b)===SC.T_FUNCTION){c=b;b=null}else{if(SC.typeOf(c)===SC.T_STRING){c=b[c]}}if(!this._firstRoute){this._firstRoute=this._Route.create()}this._firstRoute.add(a.split("/"),b,c);return this},locationDidChange:function(){this.trigger()}.observes("location"),trigger:function(){var a=this._firstRoute,b=this.get("location"),d,c;if(a){d=this._extractParametersAndRoute({route:b});b=d.route;delete d.route;delete d.params;c=a.routeForParts(b.split("/"),d);if(c&&c.method){c.method.call(c.target||this,d)}}},deparam:function(k,g){var j={},b={"true":!0,"false":!1,"null":null},f=k.replace(/\+/g," ").split("&"),l=f.length,n,d,p,c,o,h,q,m,e=decodeURIComponent,a=Object.prototype.toString;for(n=0;n<l;++n){d=f[n].split("="),p=e(d[0]),o=j,q=p.split("]["),m=p.length-1;if(/\[/.test(q[0])&&/\]$/.test(q[m])){q[m]=q[m].replace(/\]$/,"");q=q.shift().split("[").concat(q);m=q.length-1}else{m=0}if(d.length===2){c=e(d[1]);if(g){c=c&&!isNaN(c)?+c:c==="undefined"?undefined:b[c]!==undefined?b[c]:c}if(m){for(h=0;h<m;++h){p=q[h]===""?o.length:q[h];o=o[p]=h<m?o[p]||(q[h+1]&&isNaN(q[h+1])?{}:[]):c}}else{if(a.apply(j[p])==="[object Array]"){j[p].push(c)}else{if(j[p]!==undefined){j[p]=[j[p],c]}else{j[p]=c}}}}else{if(p){j[p]=g?undefined:""}}}return j},_Route:SC.Object.extend({target:null,method:null,staticRoutes:null,dynamicRoutes:null,wildcardRoutes:null,add:function(c,b,e){var a,d;c=SC.clone(c);if(!c||c.length===0){this.target=b;this.method=e}else{a=c.shift();switch(a.slice(0,1)){case":":a=a.slice(1,a.length);if(!this.dynamicRoutes){this.dynamicRoutes={}}if(!this.dynamicRoutes[a]){this.dynamicRoutes[a]=this.constructor.create()}d=this.dynamicRoutes[a];break;case"*":a=a.slice(1,a.length);if(!this.wildcardRoutes){this.wildcardRoutes={}}d=this.wildcardRoutes[a]=this.constructor.create();break;default:if(!this.staticRoutes){this.staticRoutes={}}if(!this.staticRoutes[a]){this.staticRoutes[a]=this.constructor.create()}d=this.staticRoutes[a]}if(d){d.add(c,b,e)}}},routeForParts:function(d,e){var b,c,a;d=SC.clone(d);if(!d||d.length===0){return this.method?this:null}else{b=d.shift();if(this.staticRoutes&&this.staticRoutes[b]){return this.staticRoutes[b].routeForParts(d,e)}else{for(c in this.dynamicRoutes){a=this.dynamicRoutes[c].routeForParts(d,e);if(a){e[c]=b;return a}}for(c in this.wildcardRoutes){d.unshift(b);e[c]=d.join("/");return this.wildcardRoutes[c].routeForParts(null,e)}return null}}}})});SC.SCANNER_OUT_OF_BOUNDS_ERROR=new Error("Out of bounds.");SC.SCANNER_INT_ERROR=new Error("Not an int.");SC.SCANNER_SKIP_ERROR=new Error("Did not find the string to skip.");SC.SCANNER_SCAN_ARRAY_ERROR=new Error("Did not find any string of the given array to scan.");SC.DATETIME_COMPAREDATE_TIMEZONE_ERROR=new Error("Can't compare the dates of two DateTimes that don't have the same timezone.");SC.DATETIME_ISO8601="%Y-%m-%dT%H:%M:%S%Z";SC.Scanner=SC.Object.extend({string:null,scanLocation:0,scan:function(a){if(this.scanLocation+a>this.length){throw SC.SCANNER_OUT_OF_BOUNDS_ERROR}var b=this.string.substr(this.scanLocation,a);this.scanLocation+=a;return b},scanInt:function(c,e){if(e===undefined){e=c}var d=this.scan(e);var b=new RegExp("^\\d{"+c+","+e+"}");var a=d.match(b);if(!a){throw SC.SCANNER_INT_ERROR}if(a[0].length<e){this.scanLocation+=a[0].length-e}return parseInt(a[0],10)},skipString:function(a){if(this.scan(a.length)!==a){throw SC.SCANNER_SKIP_ERROR}return YES},scanArray:function(c){for(var b=0,a=c.length;b<a;b++){if(this.scan(c[b].length)===c[b]){return b}this.scanLocation-=c[b].length}throw SC.SCANNER_SCAN_ARRAY_ERROR}});SC.DateTime=SC.Object.extend(SC.Freezable,SC.Copyable,{_ms:0,timezone:0,isFrozen:YES,adjust:function(b,a){var c;b=b?SC.clone(b):{};c=(b.timezone!==undefined)?b.timezone:(this.timezone!==undefined)?this.timezone:0;return this.constructor._adjust(b,this._ms,c,a)._createFromCurrentState()},advance:function(a){return this.constructor._advance(a,this._ms,this.timezone)._createFromCurrentState()},unknownProperty:function(a){return this.constructor._get(a,this._ms,this.timezone)},toFormattedString:function(a){return this.constructor._toFormattedString(a,this._ms,this.timezone)},toISO8601:function(){return this.constructor._toFormattedString(SC.DATETIME_ISO8601,this._ms,this.timezone)},toString:function(){return"UTC: "+new Date(this._ms).toUTCString()+", timezone: "+this.timezone},isEqual:function(a){return this.constructor.compare(this,a)===0},copy:function(){return this},toTimezone:function(a){if(a===undefined){a=0}return this.advance({timezone:a-this.timezone})}});SC.DateTime.mixin(SC.Comparable,{recordFormat:SC.DATETIME_ISO8601,dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_englishDayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AMPMNames:["AM","PM"],_date:new Date(),_tz:0,timezone:new Date().getTimezoneOffset(),_dt_cache:{},_dt_cache_index:-1,_DT_CACHE_MAX_LENGTH:1000,_setCalcState:function(a,c){var b={milliseconds:this._date.getTime(),timezone:this._tz};if(a!==undefined){this._date.setTime(a)}if(c!==undefined){this._tz=c}return b},_setCalcStateFromHash:function(c,b){var d=(b!==undefined)?b:this._tz;var a=this._toMilliseconds(c,this._ms,d);return this._setCalcState(a,d)},_get:function(x,b,o){var n,u,h,p,e,k,l,f,q,a;var c,j;var t=this._date;var s,g=null;s=this._setCalcState(b,o);if(x==="milliseconds"){g=t.getTime()}else{if(x==="timezone"){g=this._tz}}if(g===null){q=x.slice(0,4);a=x.slice(4);if(q==="last"||q==="next"){c=this._get("dayOfWeek",b,o);j=this._englishDayNames.indexOf(a);if(j>=0){var w=j-c;if(q==="last"&&w>=0){w-=7}if(q==="next"&&w<0){w+=7}this._advance({day:w},b,o);g=this._createFromCurrentState()}}}if(g===null){if(o!==undefined){this._setCalcState(t.getTime()-(o*60000),0)}switch(x){case"year":g=t.getUTCFullYear();break;case"month":g=t.getUTCMonth()+1;break;case"day":g=t.getUTCDate();break;case"dayOfWeek":g=t.getUTCDay();break;case"hour":g=t.getUTCHours();break;case"minute":g=t.getUTCMinutes();break;case"second":g=t.getUTCSeconds();break;case"millisecond":g=t.getUTCMilliseconds();break}if((g===null)&&(x==="isLeapYear")){e=this._get("year");g=(e%4===0&&e%100!==0)||e%400===0}if((g===null)&&(x==="daysInMonth")){switch(this._get("month")){case 4:case 6:case 9:case 11:g=30;break;case 2:g=this._get("isLeapYear")?29:28;break;default:g=31;break}}if((g===null)&&(x==="dayOfYear")){n=t.getTime();h=this._get("day");this._setCalcStateFromHash({day:1});for(p=this._get("month")-1;p>0;p--){this._setCalcStateFromHash({month:p});h+=this._get("daysInMonth")}t.setTime(n);g=h}if((g===null)&&(x.slice(0,4)==="week")){k=x.length===4?1:parseInt(x.slice("4"),10);l=this._get("dayOfWeek");f=this._get("dayOfYear")-1;if(k===0){g=parseInt((f-l+7)/7,10)}else{g=parseInt((f-(l-1+7)%7+7)/7,10)}}}this._setCalcState(s.milliseconds,s.timezone);return g},_adjust:function(c,f,e,a){var d=c?SC.clone(c):{};var b=this._toMilliseconds(c,f,e,a);this._setCalcState(b,e);return this},_advance:function(a,f,d){var c=a?SC.clone(a):{};var e;for(var b in c){c[b]+=this._get(b,f,d)}e=(c.timezone!==undefined)?c.timezone:d;return this._adjust(c,f,e,NO)},_toMilliseconds:function(k,c,h,f){var a=k?SC.clone(k):{};var j=this._date;var g=j.getTime();var b,e;if(!SC.none(c)){j.setTime(c)}e=(h!==undefined)?h:(this.timezone!==undefined)?this.timezone:0;j.setTime(j.getTime()-(e*60000));if(f===undefined||f===YES){if(!SC.none(a.hour)&&SC.none(a.minute)){a.minute=0}if(!(SC.none(a.hour)&&SC.none(a.minute))&&SC.none(a.second)){a.second=0}if(!(SC.none(a.hour)&&SC.none(a.minute)&&SC.none(a.second))&&SC.none(a.millisecond)){a.millisecond=0}}if(SC.none(a.year)){a.year=j.getUTCFullYear()}if(SC.none(a.month)){a.month=j.getUTCMonth()+1}if(SC.none(a.day)){a.day=j.getUTCDate()}if(SC.none(a.hour)){a.hour=j.getUTCHours()}if(SC.none(a.minute)){a.minute=j.getUTCMinutes()}if(SC.none(a.second)){a.second=j.getUTCSeconds()}if(SC.none(a.millisecond)){a.millisecond=j.getUTCMilliseconds()}b=Date.UTC(a.year,a.month-1,a.day,a.hour,a.minute,a.second,a.millisecond);j.setTime(b+(e*60000));b=j.getTime();j.setTime(g);return b},create:function(){var j=arguments.length===0?{}:arguments[0];var d;if(SC.typeOf(j)===SC.T_NUMBER){j={milliseconds:j}}d=(j.timezone!==undefined)?j.timezone:this.timezone;if(d===undefined){d=0}if(!SC.none(j.milliseconds)){var h="nu"+j.milliseconds+d,a=this._dt_cache;var e=a[h];if(!e){var f,g=this._dt_cache_index,b=this;e=a[h]=new b([{_ms:j.milliseconds,timezone:d}]);g=this._dt_cache_index=(g+1)%this._DT_CACHE_MAX_LENGTH;f=a[g];if(f!==undefined&&a[f]){delete a[f]}a[g]=h}return e}else{var c=new Date();return this.create({milliseconds:this._toMilliseconds(j,c.getTime(),d,j.resetCascadingly),timezone:d})}},_createFromCurrentState:function(){return this.create({milliseconds:this._date.getTime(),timezone:this._tz})},parse:function(p,c){var q=new RegExp("(?:%([aAbBcdDhHiIjmMpsSUWwxXyYZ%])|(.))","g");var o,k,a={},b={},j=SC.Scanner.create({string:p});if(SC.none(c)){c=SC.DATETIME_ISO8601}try{while((k=q.exec(c))!==null){switch(k[1]){case"a":b.dayOfWeek=j.scanArray(this.abbreviatedDayNames);break;case"A":b.dayOfWeek=j.scanArray(this.dayNames);break;case"b":a.month=j.scanArray(this.abbreviatedMonthNames)+1;break;case"B":a.month=j.scanArray(this.monthNames)+1;break;case"c":throw"%c is not implemented";case"d":case"D":a.day=j.scanInt(1,2);break;case"h":case"H":a.hour=j.scanInt(1,2);break;case"i":case"I":a.hour=j.scanInt(1,2);break;case"j":throw"%j is not implemented";case"m":a.month=j.scanInt(1,2);break;case"M":a.minute=j.scanInt(1,2);break;case"p":a.meridian=j.scanArray(this.AMPMNames);break;case"S":a.second=j.scanInt(1,2);break;case"s":a.millisecond=j.scanInt(1,3);break;case"U":throw"%U is not implemented";case"W":throw"%W is not implemented";case"w":throw"%w is not implemented";case"x":throw"%x is not implemented";case"X":throw"%X is not implemented";case"y":a.year=j.scanInt(2);a.year+=(a.year>70?1900:2000);break;case"Y":a.year=j.scanInt(4);break;case"Z":var g=j.scan(1);if(g==="Z"){a.timezone=0}else{if(g==="+"||g==="-"){var l=j.scanInt(2);if(j.scan(1)!==":"){j.scan(-1)}var f=j.scanInt(2);a.timezone=(g==="+"?-1:1)*(l*60+f)}}break;case"%":j.skipString("%");break;default:j.skipString(k[0]);break}}}catch(n){SC.Logger.log("SC.DateTime.createFromString "+n.toString());return null}if(!SC.none(a.meridian)&&!SC.none(a.hour)){if((a.meridian===1&&a.hour!==12)||(a.meridian===0&&a.hour===12)){a.hour=(a.hour+12)%24}delete a.meridian}o=this.create(a);if(!SC.none(b.dayOfWeek)&&o.get("dayOfWeek")!==b.dayOfWeek){return null}return o},_pad:function(b,a){var c=""+b;if(a===undefined){a=2}while(c.length<a){c="0"+c}return c},__toFormattedString:function(b,e,c){var a,d;switch(b[1]){case"a":return this.abbreviatedDayNames[this._get("dayOfWeek")];case"A":return this.dayNames[this._get("dayOfWeek")];case"b":return this.abbreviatedMonthNames[this._get("month")-1];case"B":return this.monthNames[this._get("month")-1];case"c":return this._date.toString();case"d":return this._pad(this._get("day"));case"D":return this._get("day");case"h":return this._get("hour");case"H":return this._pad(this._get("hour"));case"i":a=this._get("hour");return(a===12||a===0)?12:(a+12)%12;case"I":a=this._get("hour");return this._pad((a===12||a===0)?12:(a+12)%12);case"j":return this._pad(this._get("dayOfYear"),3);case"m":return this._pad(this._get("month"));case"M":return this._pad(this._get("minute"));case"p":return this._get("hour")>11?this.AMPMNames[1]:this.AMPMNames[0];case"S":return this._pad(this._get("second"));case"s":return this._pad(this._get("millisecond"),3);case"u":return this._pad(this._get("utc"));case"U":return this._pad(this._get("week0"));case"W":return this._pad(this._get("week1"));case"w":return this._get("dayOfWeek");case"x":return this._date.toDateString();case"X":return this._date.toTimeString();case"y":return this._pad(this._get("year")%100);case"Y":return this._get("year");case"Z":d=-1*c;return(d>=0?"+":"-")+this._pad(parseInt(Math.abs(d)/60,10))+":"+this._pad(Math.abs(d)%60);case"%":return"%"}},_toFormattedString:function(c,e,b){var a=this;var d=(b!==undefined)?b:(this.timezone!==undefined)?this.timezone:0;this._setCalcState(e-(b*60000),0);return c.replace(/\%([aAbBcdDhHiIjmMpsSUWwxXyYZ\%])/g,function(){var f=a.__toFormattedString.call(a,arguments,e,b);return f})},compare:function(d,c){var f=d.get("milliseconds");var e=c.get("milliseconds");return f<e?-1:f===e?0:1},compareDate:function(d,c){if(d.get("timezone")!==c.get("timezone")){throw SC.DATETIME_COMPAREDATE_TIMEZONE_ERROR}var f=d.adjust({hour:0}).get("milliseconds");var e=c.adjust({hour:0}).get("milliseconds");return f<e?-1:f===e?0:1}});SC.Binding.dateTime=function(a){return this.transform(function(b,c){return b?b.toFormattedString(a):null})};SC.stringsFor("English",{"_SC.DateTime.dayNames":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday","_SC.DateTime.abbreviatedDayNames":"Sun Mon Tue Wed Thu Fri Sat","_SC.DateTime.monthNames":"January February March April May June July August September October November December","_SC.DateTime.abbreviatedMonthNames":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec","_SC.DateTime.AMPMNames":"AM PM"});SC.DateTime.mixin({_setup:function(){SC.DateTime.dayNames=SC.String.w(SC.String.loc("_SC.DateTime.dayNames"));SC.DateTime.abbreviatedDayNames=SC.String.w(SC.String.loc("_SC.DateTime.abbreviatedDayNames"));SC.DateTime.monthNames=SC.String.w(SC.String.loc("_SC.DateTime.monthNames"));SC.DateTime.abbreviatedMonthNames=SC.String.w(SC.String.loc("_SC.DateTime.abbreviatedMonthNames"));SC.DateTime.AMPMNames=SC.String.w(SC.String.loc("_SC.DateTime.AMPMNames"))}});jQuery(document).ready(function(){SC.DateTime._setup()});SC.Response=SC.Object.extend({isResponse:YES,isError:NO,errorValue:function(){return this}.property().cacheable(),errorObject:null,request:null,originalRequest:function(){var a=this.get("request");while(a.get("source")){a=a.get("source")}return a}.property("request").cacheable(),type:function(){return this.getPath("request.type")}.property("request").cacheable(),address:function(){return this.getPath("request.address")}.property("request").cacheable(),isJSON:function(){return this.getPath("request.isJSON")||NO}.property("request").cacheable(),isXML:function(){return this.getPath("request.isXML")||NO}.property("request").cacheable(),listeners:function(){return this.getPath("request.listeners")}.property("request").cacheable(),status:-100,headers:null,body:function(){var a=this.get("encodedBody");if(a&&this.get("isJSON")){try{a=SC.json.decode(a)}catch(b){return SC.Error.create({message:b.name+": "+b.message,label:"Response",errorValue:this})}}return a}.property("encodedBody").cacheable(),response:function(){return this.get("body")}.property("body").cacheable(),isCancelled:NO,timedOut:null,timeoutTimer:null,fire:function(){var a=this.get("request"),c=a?a.get("source"):null;if(c&&c.willSend){c.willSend(a,this)}a.freeze();if(!this.get("isCancelled")){this.invokeTransport()}var b=a.get("timeout");if(b){var d=SC.Timer.schedule({target:this,action:"timeoutReached",interval:b,repeats:NO});this.set("timeoutTimer",d)}if(!this.get("isCancelled")&&c&&c.didSend){c.didSend(a,this)}},invokeTransport:function(){this.receive(function(a){this.set("status",200)},this)},receive:function(e,a){if(!this.get("timedOut")){var d=this.get("timeoutTimer");if(d){d.invalidate()}this.set("timedOut",NO)}var b=this.get("request");var c=b?b.get("source"):null;SC.run(function(){if(c&&c.willReceive){c.willReceive(b,this)}e.call(a,!this.get("isCancelled"));if(!this.get("isCancelled")&&c&&c.didReceive){c.didReceive(b,this)}if(!this.get("isCancelled")){this.notify()}},this);SC.Request.manager.transportDidClose(this);return this},cancel:function(){if(!this.get("isCancelled")){this.set("isCancelled",YES);this.cancelTransport();SC.Request.manager.transportDidClose(this)}},timeoutReached:function(){if(this.get("timedOut")===null){this.set("timedOut",YES);this.cancelTransport();this.receive(function(b){if(!b){return}var a=SC.$error("HTTP Request timed out","Request",0);a.set("errorValue",this);this.set("isError",YES);this.set("errorObject",a);this.set("status",0)},this);return YES}return NO},cancelTransport:function(){},_notifyListeners:function(h,b){var j=h[b],g,f,a;if(!j){return NO}var d=NO;var e=j.length;for(var c=0;c<e;c++){var k=j[c];g=(k.args||[]).copy();g.unshift(this);f=k.target;a=k.action;if(SC.typeOf(a)===SC.T_STRING){a=f[a]}d=a.apply(f,g)}return d},notify:function(){var b=this.get("listeners"),a=this.get("status"),c=Math.floor(a/100)*100,d=NO;if(!b){return this}d=this._notifyListeners(b,a);if(!d&&c!==a){d=this._notifyListeners(b,c)}if(!d&&a!==0){d=this._notifyListeners(b,0)}return this},toString:function(){var a=arguments.callee.base.apply(this,arguments);return"%@<%@ %@, status=%@".fmt(a,this.get("type"),this.get("address"),this.get("status"))}});SC.XHRResponse=SC.Response.extend({headers:function(){var c=this.get("rawRequest"),b=c?c.getAllResponseHeaders():null,a={};if(!b){return a}b.split("\n").forEach(function(g){var d=g.indexOf(":"),e,f;if(d>=0){e=g.slice(0,d);f=g.slice(d+1).trim();a[e]=f}},this);return a}.property("status").cacheable(),header:function(a){var b=this.get("rawRequest");return b?b.getResponseHeader(a):null},encodedBody:function(){var a=this.get("rawRequest");if(!a){return null}if(this.get("isXML")){return a.responseXML}return a.responseText}.property("status").cacheable(),cancelTransport:function(){var a=this.get("rawRequest");if(a){a.abort()}this.set("rawRequest",null)},invokeTransport:function(){var d,n,b,g,h=this.get("request"),e,a,f,c;g=this.createRequest();this.set("rawRequest",g);f=!!h.get("isAsynchronous");if(f){if(window.XMLHttpRequestProgressEvent){n=h.get("listeners");if(n){for(var o in n){if(isNaN(parseInt(o,10))){b=n[o];for(var k=0,l=b.length;k<l;k++){d=b[k];var m=o.split(".");if(SC.none(m[1])){SC.Event.add(g,m[0],d.target,d.action,d.args)}else{SC.Event.add(g[m[0]],m[1],d.target,d.action,d.args)}}}}}SC.Event.add(g,"loadend",this,this.finishRequest)}else{if(window.XMLHttpRequest&&g.addEventListener){SC.Event.add(g,"readystatechange",this,this.finishRequest)}else{e=this;a=function(){if(!e){return null}var p=e.finishRequest();if(p){e=null}return p};g.onreadystatechange=a}}}g.open(this.get("type"),this.get("address"),f);c=this.getPath("request.headers");for(var j in c){g.setRequestHeader(j,c[j])}g.send(this.getPath("request.encodedBody"));if(!f){this.finishRequest()}return g},createRequest:function(){var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{try{a=new ActiveXObject("MSXML2.XMLHTTP.6.0")}catch(b){}try{if(!a){a=new ActiveXObject("MSXML2.XMLHTTP")}}catch(b){}}return a},finishRequest:function(o){var c,l,a,e=this.get("rawRequest"),h=e.readyState,f,m,d,b;if(h===4&&!this.get("timedOut")){this.receive(function(p){if(!p){return}d=-1;try{d=e.status||0}catch(s){}if((d<200)||(d>=300)){try{b=e.statusText||""}catch(q){b=""}m=SC.$error(b||"HTTP Request failed","Request",d);m.set("errorValue",this);this.set("isError",YES);this.set("errorObject",m)}this.set("status",d)},this);if(window.XMLHttpRequestProgressEvent){SC.Event.remove(e,"loadend",this,this.finishRequest);f=this.get("request");l=f.get("listeners");if(l){for(var n in l){if(isNaN(parseInt(n,10))){a=l[n];for(var g=0,j=a.length;g<j;g++){c=a[g];var k=n.split(".");if(SC.none(k[1])){SC.Event.remove(e,k[0],c.target,c.action,c.args)}else{SC.Event.remove(e[k[0]],k[1],c.target,c.action,c.args)}}}}}}else{if(window.XMLHttpRequest&&e.addEventListener){SC.Event.remove(e,"readystatechange",this,this.finishRequest)}else{e.onreadystatechange=null}}return YES}return NO}});sc_require("system/response");SC.Request=SC.Object.extend(SC.Copyable,SC.Freezable,{isAsynchronous:YES,isJSON:NO,isXML:NO,attachIdentifyingHeaders:YES,headers:function(){var a=this._headers;if(!a){a=this._headers={}}return a}.property().cacheable(),responseClass:SC.XHRResponse,source:null,address:null,type:"GET",timeout:null,body:null,encodedBody:function(){var a=this.get("body");if(a&&this.get("isJSON")){a=SC.json.encode(a)}return a}.property("isJSON","isXML","body").cacheable(),willSend:function(b,a){},didSend:function(b,a){},willReceive:function(b,a){},didReceive:function(b,a){},concatenatedProperties:"COPY_KEYS",COPY_KEYS:["attachIdentifyingHeaders","isAsynchronous","isJSON","isXML","address","type","timeout","body","responseClass","willSend","didSend","willReceive","didReceive"],copy:function(){var a={},d=this.COPY_KEYS,f=d.length,b,c,e;while(--f>=0){b=d[f];if(this.hasOwnProperty(b)){a[b]=this.get(b)}}if(this.hasOwnProperty("listeners")){a.listeners=SC.copy(this.get("listeners"))}if(this.hasOwnProperty("_headers")){a._headers=SC.copy(this._headers)}a.source=this.get("source")||this;return this.constructor.create(a)},header:function(a,b){var d,c;if(SC.typeOf(a)===SC.T_STRING){c=this._headers;if(arguments.length===1){return c?c[a]:null}else{this.propertyWillChange("headers");if(!c){c=this._headers={}}c[a]=b;this.propertyDidChange("headers");return this}}else{if(b===undefined){c=a;this.beginPropertyChanges();for(d in c){if(!c.hasOwnProperty(d)){continue}this.header(d,c[d])}this.endPropertyChanges();return this}}return this},clearHeaders:function(){this.propertyWillChange("headers");this._headers={};this.propertyDidChange("headers")},async:function(a){if(a===undefined){a=YES}return this.set("isAsynchronous",a)},timeoutAfter:function(a){return this.set("timeout",a)},json:function(a){if(a===undefined){a=YES}if(a){this.set("isXML",NO)}return this.set("isJSON",a)},xml:function(a){if(a===undefined){a=YES}if(a){this.set("isJSON",NO)}return this.set("isXML",a)},_prep:function(){var a=!!this.header("Content-Type");if(this.get("attachIdentifyingHeaders")){this.header("X-Requested-With","XMLHttpRequest");this.header("X-SproutCore-Version",SC.VERSION)}if(!a&&!!this.get("body")){if(this.get("isJSON")){this.header("Content-Type","application/json")}else{if(this.get("isXML")){this.header("Content-Type","text/xml")}}}return this},send:function(a){var b=this.get("timeout");if(b&&!this.get("isAsynchronous")){throw"Timeout values cannot be used with synchronous requests"}else{if(b===0){throw"The timeout value must either not be specified or must be greater than 0"}}if(a){this.set("body",a)}return SC.Request.manager.sendRequest(this.copy()._prep())},resend:function(){var a=this.get("source")?this:this.copy()._prep();return SC.Request.manager.sendRequest(a)},notify:function(e,d,c){var a;if(SC.typeOf(e)!==SC.T_NUMBER&&SC.typeOf(e)!==SC.T_STRING){a=SC.A(arguments).slice(2);c=d;d=e;e=0}else{a=SC.A(arguments).slice(3)}var b=this.get("listeners");if(!b){this.set("listeners",b={})}if(!b[e]){b[e]=[]}b[e].push({target:d,action:c,args:a});return this}});SC.Request.mixin({getUrl:function(a){return this.create().set("address",a).set("type","GET")},postUrl:function(b,a){var c=this.create().set("address",b).set("type","POST");if(a){c.set("body",a)}return c},deleteUrl:function(a){return this.create().set("address",a).set("type","DELETE")},putUrl:function(b,a){var c=this.create().set("address",b).set("type","PUT");if(a){c.set("body",a)}return c},patchUrl:function(b,a){var c=this.create().set("address",b).set("type","PATCH");if(a){c.set("body",a)}return c}});SC.Request.manager=SC.Object.create({maxRequests:6,inflight:[],pending:[],sendRequest:function(b){if(!b){return null}var a=b.get("responseClass").create({request:b});this.get("pending").pushObject(a);this.fireRequestIfNeeded();return a},cancel:function(b){var d=this.get("pending"),c=this.get("inflight"),a;if(d.indexOf(b)>=0){this.propertyWillChange("pending");d.removeObject(b);this.propertyDidChange("pending");return YES}else{if(c.indexOf(b)>=0){b.cancel();c.removeObject(b);this.fireRequestIfNeeded();return YES}}return NO},cancelAll:function(){if(this.get("pending").length||this.get("inflight").length){this.set("pending",[]);this.get("inflight").forEach(function(a){a.cancel()});this.set("inflight",[]);return YES}return NO},fireRequestIfNeeded:function(){var d=this.get("pending"),c=this.get("inflight"),a=this.get("maxRequests"),b;if((d.length>0)&&(c.length<a)){b=d.shiftObject();c.pushObject(b);b.fire()}},transportDidClose:function(a){this.get("inflight").removeObject(a);this.fireRequestIfNeeded()}});SC.FOCUS_ALL_CONTROLS=NO;SC.ready(function(){var a=SC.SAFARI_FOCUS_BEHAVIOR;if(a!==null&&a!==undefined){SC.FOCUS_ALL_CONTROLS=SC.SAFARI_FOCUS_BEHAVIOR}});SC.TreeItemContent={isTreeItemContent:YES,treeItemChildren:null,treeItemIsExpanded:YES,treeItemIsGrouped:NO,treeItemDisclosureState:function(b,a){return this.get("treeItemIsExpanded")?SC.BRANCH_OPEN:SC.BRANCH_CLOSED},treeItemCollapse:function(b,a){this.setIfChanged("treeItemIsExpanded",NO)},treeItemExpand:function(b,a){this.setIfChanged("treeItemIsExpanded",YES)},treeItemBranchIndexes:function(e,c){var d=this.get("treeItemChildren"),b,g,a,f;if(!d){return null}b=SC.IndexSet.create();g=d.get("length");for(a=0;a<g;a++){if(!(f=d.objectAt(a))){continue}if(!f.get("treeItemChildren")){continue}if(f.treeItemDisclosureState(this,a)!==SC.LEAF_NODE){b.add(a)}}return b.get("length")>0?b:null}};SC.BRANCH_OPEN=17;SC.BRANCH_CLOSED=18;SC.LEAF_NODE=32;SC.CollectionContent={isCollectionContent:YES,contentIndexIsSelected:function(b,c,a){var d=b.get("selection");return d?d.contains(c,a):NO},contentIndexIsEnabled:function(b,c,a){return b.get("isEnabled")},contentGroupIndexes:function(a,b){return null},contentIndexIsGroup:function(b,c,a){return NO},contentIndexOutlineLevel:function(b,c,a){return -1},contentIndexDisclosureState:function(b,c,a){return SC.LEAF_NODE},contentIndexExpand:function(b,c,a){SC.Logger.log("contentIndexExpand(%@, %@, %@)".fmt(b,c,a))},contentIndexCollapse:function(b,c,a){SC.Logger.log("contentIndexCollapse(%@, %@, %@)".fmt(b,c,a))}};sc_require("mixins/tree_item_content");sc_require("mixins/collection_content");SC.TreeItemObserver=SC.Object.extend(SC.Array,SC.CollectionContent,{item:null,delegate:null,parentObserver:null,parentItem:function(){var a=this.get("parentObserver");return a?a.get("item"):null}.property("parentObserver").cacheable(),index:null,outlineLevel:0,children:null,disclosureState:SC.BRANCH_OPEN,branchIndexes:function(){var e=this.get("item"),b,f,a,d,c;if(!e){return SC.IndexSet.EMPTY}else{if(e.isTreeItemContent){f=this.get("parentItem");a=this.get("index");return e.treeItemBranchIndexes(f,a)}else{d=this.get("children");if(!d){return null}c=SC.IndexSet.create();b=d.get("length");f=e;for(a=0;a<b;a++){if(!(e=d.objectAt(a))){continue}if(!this._computeChildren(e,f,a)){continue}if(this._computeDisclosureState(e,f,a)!==SC.LEAF_NODE){c.add(a)}}return c.get("length")>0?c:null}}}.property("children").cacheable(),isHeaderVisible:function(){return !!this.get("parentObserver")}.property("parentObserver").cacheable(),length:0,objectAt:function(f,c){var g=this.get("length"),j=this.get("item"),a=this._objectAtCache,h=f,e=0,d,b;if(f>=g){return undefined}if(this.get("isHeaderVisible")){if(f===0){return j}else{h--}}j=null;if(!a){a=this._objectAtCache=[]}if((j=a[f])!==undefined){return j}b=this.get("children");if(!b){return undefined}if(d=this.get("branchIndexes")){d.forEach(function(m){if(j||(m>h)){return}var l=this.branchObserverAt(m),k;if(!l){return}k=l.get("length");if(m+k>h){j=l.objectAt(h-m,c);h=-1}else{h-=k-1}},this)}if(h>=0){j=b.objectAt(h,c)}a[f]=j;return j},replace:function(a,b,k,d){var j=a,g=null,e,f,h;if(d===undefined){d=SC.DROP_BEFORE}if(this.get("isHeaderVisible")){j--}if(j<0){throw"Tree Item cannot replace itself"}if(e=this.get("branchIndexes")){e.forEach(function(l){if(g||(l>=j)){return}if(!(g=this.branchObserverAt(l))){return}f=g.get("length");if((l+f===j)&&d===SC.DROP_AFTER){j-=l}else{if(l+f>j){j-=l}else{j-=f-1;g=null}}},this)}if(g){g.replace(j,b,k,d);return this}h=j+b;if(b>1&&e){e.forEachIn(j,e.get("max")-j,function(l){if(l>h){return}if(!(g=this.branchObserverAt(l))){return}f=g.get("length");h-=f-1},this)}b=h-j;var c=this.get("children");if(!c){throw"cannot replace() tree item with no children"}if((b<0)||(h>c.get("length"))){throw"replace() range must lie within a single tree item"}c.replace(j,b,k,d);return this},observerContentDidChange:function(b,c,j){this.invalidateBranchObserversAt(b);this._objectAtCache=this._outlineLevelCache=null;this._disclosureStateCache=null;this._contentGroupIndexes=NO;this.notifyPropertyChange("branchIndexes");var d=this.get("length"),e=this._computeLength(),g=this.get("parentObserver"),f;if(d!==e){this.set("length",e)}if(!this._notifyParent){return this}if(g){f=SC.IndexSet.create(this.get("index"));g._childrenRangeDidChange(g.get("children"),null,"[]",f)}else{if(d===e){c=this.expandChildIndex(b+c);b=this.expandChildIndex(b);c=c-b;j=0}else{b=this.expandChildIndex(b);c=e-b;j=e-d}var h=c;var a=j+h;this.arrayContentDidChange(b,h,a)}},expandChildIndex:function(c){var b=c;if(this.get("isHeaderVisible")){c++}var a=this.get("branchIndexes");if(!a||a.get("length")===0){return b}a.forEachIn(0,c,function(d){b+=this.branchObserverAt(d).get("length")-1},this);return b},_contentGroupIndexes:NO,contentGroupIndexes:function(a,e){if(e!==this){return null}var c=this._contentGroupIndexes;if(c!==NO){return c}if(this.get("parentObserver")){return null}var d=this.get("item"),g,b,h,f;if(d&&d.isTreeItemContent){g=d.get("treeItemIsGrouped")}else{g=!!this.delegate.get("treeItemIsGrouped")}if(g){c=SC.IndexSet.create();b=this.get("branchIndexes");if(b){h=b.min();f=0;b.forEach(function(k){c.add(k+f,1);var j=this.branchObserverAt(k);if(j){f+=j.get("length")-1;h+=f}},this)}}else{c=null}this._contentGroupIndexes=c;return c},contentIndexIsGroup:function(b,d,a){var c=this.contentGroupIndexes(b,d);return c?c.contains(a):NO},contentIndexOutlineLevel:function(k,g,e){if(g!==this){return -1}var a=this._outlineLevelCache;if(a&&(a[e]!==undefined)){return a[e]}if(!a){a=this._outlineLevelCache=[]}var f=this.get("length"),l=e,d=0,h=null,c,b,j;if(e>=f){return -1}if(this.get("isHeaderVisible")){if(e===0){return a[0]=this.get("outlineLevel")-1}else{l--}}if(c=this.get("branchIndexes")){c.forEach(function(o){if((h!==null)||(o>l)){return}var n=this.branchObserverAt(o),m;if(!n){return}m=n.get("length");if(o+m>l){h=n.contentIndexOutlineLevel(k,n,l-o);l=-1}else{l-=m-1}},this)}if(l>=0){h=this.get("outlineLevel")}a[e]=h;return h},contentIndexDisclosureState:function(k,g,e){if(g!==this){return -1}var a=this._disclosureStateCache;if(a&&(a[e]!==undefined)){return a[e]}if(!a){a=this._disclosureStateCache=[]}var f=this.get("length"),l=e,d=0,h=null,c,b,j;if(e>=f){return SC.LEAF_NODE}if(this.get("isHeaderVisible")){if(e===0){return a[0]=this.get("disclosureState")}else{l--}}if(c=this.get("branchIndexes")){c.forEach(function(o){if((h!==null)||(o>l)){return}var n=this.branchObserverAt(o),m;if(!n){return}m=n.get("length");if(o+m>l){h=n.contentIndexDisclosureState(k,n,l-o);l=-1}else{l-=m-1}},this)}if(l>=0){h=SC.LEAF_NODE}a[e]=h;return h},contentIndexExpand:function(b,f,a){var c,g=a,d,e;if(f!==this){return}if(this.get("isHeaderVisible")){if(a===0){this._expand(this.get("item"));return}else{g--}}if(c=this.get("branchIndexes")){c.forEach(function(k){if(k>=g){return}var j=this.branchObserverAt(k),h;if(!j){return}h=j.get("length");if(k+h>g){j.contentIndexExpand(b,j,g-k);g=-1}else{g-=h-1}},this)}if(g>=0){d=this.get("children");e=d?d.objectAt(g):null;if(e){this._expand(e,this.get("item"),g)}}},contentIndexCollapse:function(b,f,a){var c,d,e,g=a;if(f!==this){return}if(this.get("isHeaderVisible")){if(a===0){this._collapse(this.get("item"));return}else{g--}}if(c=this.get("branchIndexes")){c.forEach(function(k){if(k>=g){return}var j=this.branchObserverAt(k),h;if(!j){return}h=j.get("length");if(k+h>g){j.contentIndexCollapse(b,j,g-k);g=-1}else{g-=h-1}},this)}if(g>=0){d=this.get("children");e=d?d.objectAt(g):null;if(e){this._collapse(e,this.get("item"),g)}}},branchObserverAt:function(d){var g=this._branchObserversByIndex,c=this._branchObserverIndexes,e,h,b,k,a,f,j;if(!g){g=this._branchObserversByIndex=[]}if(!c){c=this._branchObserverIndexes=SC.IndexSet.create()}if(e=g[d]){return e}a=this.get("children");k=a?a.objectAt(d):null;if(!k){return null}g[d]=e=SC.TreeItemObserver.create({item:k,delegate:this.get("delegate"),parentObserver:this,index:d,outlineLevel:this.get("outlineLevel")+1});c.add(d);return e},invalidateBranchObserversAt:function(c){var b=this._branchObserversByIndex,a=this._branchObserverIndexes;if(!b||b.length<=c){return this}if(c<0){c=0}a.forEachIn(c,a.get("max")-c,function(e){var d=b[e];if(d){d.destroy()}},this);b.length=c;return this},init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("item");if(!a){throw"SC.TreeItemObserver.item cannot be null"}a.addObserver("*",this,this._itemPropertyDidChange);this._itemPropertyDidChange(a,"*");this._notifyParent=YES},destroy:function(){this.invalidateBranchObserversAt(0);this._objectAtCache=null;this._notifyParent=NO;var c=this.get("item");if(c){c.removeObserver("*",this,this._itemPropertyDidChange)}var a=this._children,b=this._childrenRangeObserver;if(a&&b){a.removeRangeObserver(b)}this.set("length",0);arguments.callee.base.apply(this,arguments)},_itemPropertyDidChange:function(f,b){var a=this.get("children"),e=this.get("disclosureState"),d=this.get("item"),c;this.beginPropertyChanges();c=this._computeDisclosureState(d);if(e!==c){this.set("disclosureState",c)}c=this._computeChildren(d);if(a!==c){this.set("children",c)}this.endPropertyChanges()},_childrenDidChange:function(){var c=this.get("disclosureState"),d=c===SC.BRANCH_OPEN?this.get("children"):null,b=this._children,a=this._childrenRangeObserver;if(b===d){return this}if(a){b.removeRangeObserver(a)}if(d){this._childrenRangeObserver=d.addRangeObserver(null,this,this._childrenRangeDidChange)}else{this._childrenRangeObserver=null}this._children=d;this._childrenRangeDidChange(d,null,"[]",null)}.observes("children","disclosureState"),_childrenRangeDidChange:function(f,j,h,d){var a=this.get("children"),e=a?a.get("length"):0,c=d?d.get("min"):0,g=d?d.get("max"):e,b=this._childrenLen||0;this._childrenLen=e;this.observerContentDidChange(c,g-c,e-b)},_computeDisclosureState:function(d,e,b){var c,a;if(!d||!this._computeChildren(d)){return SC.LEAF_NODE}else{if(d.isTreeItemContent){if(e===undefined){e=this.get("parentItem")}if(b===undefined){b=this.get("index")}return d.treeItemDisclosureState(e,b)}else{c=this._treeItemIsExpandedKey;if(!c){a=this.get("delegate");c=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=c}return d.get(c)?SC.BRANCH_OPEN:SC.BRANCH_CLOSED}}},_collapse:function(d,e,b){var c,a;if(!d||!this._computeChildren(d)){return this}else{if(d.isTreeItemContent){if(e===undefined){e=this.get("parentItem")}if(b===undefined){b=this.get("index")}d.treeItemCollapse(e,b)}else{c=this._treeItemIsExpandedKey;if(!c){a=this.get("delegate");c=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=c}d.setIfChanged(c,NO)}}return this},_expand:function(d,e,b){var c,a;if(!d||!this._computeChildren(d)){return this}else{if(d.isTreeItemContent){if(e===undefined){e=this.get("parentItem")}if(b===undefined){b=this.get("index")}d.treeItemExpand(e,b)}else{c=this._treeItemIsExpandedKey;if(!c){a=this.get("delegate");c=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=c}d.setIfChanged(c,YES)}}return this},_computeChildren:function(c){var a,b;if(!c){return null}else{if(c.isTreeItemContent){return c.get("treeItemChildren")}else{b=this._treeItemChildrenKey;if(!b){a=this.get("delegate");b=a?a.get("treeItemChildrenKey"):"treeItemChildren";this._treeItemChildrenKey=b}return c.get(b)}}},_computeLength:function(){var b=this.get("isHeaderVisible")?1:0,d=this.get("disclosureState"),c=this.get("children"),a;if((d===SC.BRANCH_OPEN)&&c){b+=c.get("length");if(a=this.get("branchIndexes")){a.forEach(function(e){var f=this.branchObserverAt(e);b+=f.get("length")-1},this)}}return b}});sc_require("private/tree_item_observer");SC.TreeController=SC.ObjectController.extend(SC.SelectionSupport,{treeItemIsGrouped:NO,treeItemIsExpandedKey:"treeItemIsExpanded",treeItemChildrenKey:"treeItemChildren",arrangedObjects:function(){var a,b=this.get("content");if(b){a=SC.TreeItemObserver.create({item:b,delegate:this});a.bind("allowsSelection",this,"allowsSelection");a.bind("allowsMultipleSelection",this,"allowsMultipleSelection");a.bind("allowsEmptySelection",this,"allowsEmptySelection")}else{a=null}this._sctc_arrangedObjects=a;return a}.property().cacheable(),_sctc_invalidateArrangedObjects:function(){this.propertyWillChange("arrangedObjects");var a=this._sctc_arrangedObjects;if(a){a.destroy()}this._sctc_arrangedObjects=null;this.propertyDidChange("arrangedObjects")}.observes("content","treeItemIsExpandedKey","treeItemChildrenKey","treeItemIsGrouped"),_sctc_arrangedObjectsContentDidChange:function(){this.updateSelectionAfterContentChange()}.observes("*arrangedObjects.[]"),canSelectGroups:NO,firstSelectableObject:function(){var d=this.get("arrangedObjects"),c,b,a=0;if(!d){return null}if(this.get("canSelectGroups")){return d.get("firstObject")}c=d.contentGroupIndexes(null,d);b=d.get("length");while(c.contains(a)&&(a<b)){a++}return a>=b?null:d.objectAt(a)}.property()});SC.InlineTextFieldDelegate={editor:null,acquireEditor:function(a){var b=this.editor;if(b){if(b.get("isEditing")&&!b.commitEditing()&&!b.discardEditing()){return null}this.releaseEditor(b)}var c=a.exampleEditor?a.exampleEditor:SC.InlineTextFieldView,d=a.get("pane");b=this.editor=d.createChildView(c,{inlineEditorDelegate:this});d.appendChild(b);return b},releaseEditor:function(a){a.removeFromParent();this.editor=null;return YES}};SC.STRING_TITLEIZE_REGEXP=(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g);SC.STRING_HUMANIZE_REGEXP=(/[\-_]/g);SC.STRING_REGEXP_ESCAPED_REGEXP=(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g);SC.STRING_DASHERIZE_CACHE={top:"top",left:"left",right:"right",bottom:"bottom",width:"width",height:"height",minWidth:"min-width",maxWidth:"max-width"};SC.INFLECTION_CONSTANTS={PLURAL:[[/(quiz)$/i,"$1zes"],[/^(ox)$/i,"$1en"],[/([m|l])ouse$/i,"$1ice"],[/(matr|vert|ind)ix|ex$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/sis$/i,"ses"],[/([ti])um$/i,"$1a"],[/(buffal|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/,"s"]],SINGULAR:[[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/^(ox)en/i,"$1"],[/(alias|status)es$/i,"$1"],[/(octop|vir)i$/i,"$1us"],[/(cris|ax|test)es$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)es$/i,"$1"],[/([m|l])ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(^analy)ses$/i,"$1sis"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/s$/i,""]],IRREGULAR:[["move","moves"],["sex","sexes"],["child","children"],["man","men"],["person","people"]],UNCOUNTABLE:["sheep","fish","series","species","money","rice","information","info","equipment"]};SC.mixin(SC.String,{capitalizeEach:function(a){return a.replace(SC.STRING_TITLEIZE_REGEXP,function(c,b,d){return(d)?(b+d.toUpperCase()):b}).capitalize()},titleize:function(b){var a=b.replace(SC.STRING_DECAMELIZE_REGEXP,"$1_$2");return a.replace(SC.STRING_TITLEIZE_REGEXP,function(c,e,d){return d?" "+d.toUpperCase():" "}).capitalize()},classify:function(d){var a=d.replace(SC.STRING_TITLEIZE_REGEXP,function(e,g,f){return f?f.toUpperCase():""});var c=a.charAt(0),b=c.toUpperCase();return c!==b?b+a.slice(1):a},humanize:function(a){return SC.String.decamelize(a).replace(SC.STRING_HUMANIZE_REGEXP," ")},escapeForRegExp:function(a){return a.replace(SC.STRING_REGEXP_ESCAPED_REGEXP,"\\$1")},removeDiacritics:function(g){var a=SC.diacriticMappingTable;if(!a){SC.diacriticMappingTable={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"P","":"P","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"`","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"p","":"p","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z"};a=SC.diacriticMappingTable}var d,e,b="",f=g.length;for(var c=0;c<=f;++c){d=g.charAt(c);e=a[d];b+=e||d}return b},pluralize:function(g){var l,e,b=g.split(/\s/).pop(),h=g.replace(b,""),a=b.charAt(0).match(/[A-Z]/)?true:false;b=b.toLowerCase();for(l=0,e=SC.INFLECTION_CONSTANTS.UNCOUNTABLE.length;l<e;l++){var f=SC.INFLECTION_CONSTANTS.UNCOUNTABLE[l];if(b==f){return g.toString()}}for(l=0,e=SC.INFLECTION_CONSTANTS.IRREGULAR.length;l<e;l++){var c=SC.INFLECTION_CONSTANTS.IRREGULAR[l][0],k=SC.INFLECTION_CONSTANTS.IRREGULAR[l][1];if((b==c)||(b==k)){if(a){k=k.capitalize()}return h+k}}for(l=0,e=SC.INFLECTION_CONSTANTS.PLURAL.length;l<e;l++){var j=SC.INFLECTION_CONSTANTS.PLURAL[l][0],d=SC.INFLECTION_CONSTANTS.PLURAL[l][1];if(j.test(b)){return g.replace(j,d)}}},singularize:function(g){var l,e,b=g.split(/\s/).pop(),h=g.replace(b,""),a=b.charAt(0).match(/[A-Z]/)?true:false;b=b.toLowerCase();for(l=0,e=SC.INFLECTION_CONSTANTS.UNCOUNTABLE.length;l<e;l++){var f=SC.INFLECTION_CONSTANTS.UNCOUNTABLE[l];if(b==f){return g.toString()}}for(l=0,e=SC.INFLECTION_CONSTANTS.IRREGULAR.length;l<e;l++){var c=SC.INFLECTION_CONSTANTS.IRREGULAR[l][0],k=SC.INFLECTION_CONSTANTS.IRREGULAR[l][1];if((b==c)||(b==k)){if(a){c=c.capitalize()}return h+c}}for(l=0,e=SC.INFLECTION_CONSTANTS.SINGULAR.length;l<e;l++){var j=SC.INFLECTION_CONSTANTS.SINGULAR[l][0],d=SC.INFLECTION_CONSTANTS.SINGULAR[l][1];if(j.test(b)){return g.replace(j,d)}}}});SC.String.strip=SC.String.trim;sc_require("system/string");SC.supplement(String.prototype,{capitalizeEach:function(){return SC.String.capitalizeEach(this,arguments)},titleize:function(a){return SC.String.titleize(this,arguments)},classify:function(a){return SC.String.classify(this,arguments)},humanize:function(a){return SC.String.humanize(this,arguments)},escapeForRegExp:function(a){return SC.String.escapeForRegExp(this,arguments)},removeDiacritics:function(a){return SC.String.removeDiacritics(this,arguments)},trim:function(a){return SC.String.trim(this,arguments)},trimLeft:function(a){return SC.String.trimLeft(this,arguments)},trimRight:function(a){return SC.String.trimRight(this,arguments)},pluralize:function(a){return SC.String.pluralize(this,arguments)},singularize:function(a){return SC.String.singularize(this,arguments)}});SC.Gesture=SC.Object.extend({name:"gesture",touchIsInGesture:function(b,a){return NO},touchStart:function(a){},touchesDragged:function(a,b){},touchEnd:function(a){},start:function(){if(!this.get("isActive")){this.set("isActive",YES);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Start";if(this.view[a]){this.view[a].apply(this.view,b)}}},end:function(){if(this.get("isActive")){this.set("isActive",NO);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"End";if(this.view[a]){this.view[a].apply(this.view,b)}}},change:function(){if(this.get("isActive")){var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Changed";if(this.view[a]){this.view[a].apply(this.view,b)}}},cancel:function(){if(this.get("isActive")){this.set("isActive",NO);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Cancelled";if(this.view[a]){this.view[a].apply(this.view,b)}}},trigger:function(){var b=SC.$A(arguments);b.unshift(this);var a=this.name;if(this.view[a]){this.view[a].apply(this.view,b)}},take:function(a){a.isTaken=YES;if(SC.none(a.touchResponder)||a.touchResponder!==this){a.makeTouchResponder(this,YES)}},release:function(a){a.isTaken=NO;if(a.nextTouchResponder){a.makeTouchResponder(a.nextTouchResponder)}},discardTouch:function(a){a.isTaken=YES;a.makeTouchResponder(null)},statusForTouch:function(c){var b=SC.guidFor(c.view)+this.name;var a=c[b];if(!a){a=c[b]={}}return a},unassignedTouchDidStart:function(a){if(a.isTaken){return}if(this.touchIsInGesture(a,this.statusForTouch(a))){this.take(a)}},unassignedTouchesDidChange:function(a,b){b.forEach(function(c){if(c.isTaken){return}if(this.touchIsInGesture(c,this.statusForTouch(c))){this.take(c)}},this)},unassignedTouchDidEnd:function(a){},interestedInTouch:function(b){var a=this.statusForTouch(b);if(a.isInterested){return}a.isInterested=YES;b.isInteresting++},uninterestedInTouch:function(b){var a=this.statusForTouch(b);if(!a.isInterested){return}a.isInterested=NO;b.isInteresting--}});sc_require("system/gesture");SC.PinchGesture=SC.Gesture.extend({name:"pinch",acceptsMultitouch:YES,scale:1,unassignedTouchesDidChange:function(a,b){if(b.length==2){this.take(b[0]);this.take(b[1])}},touchStart:function(b){var a=b.touchesForResponder(this);if(!a||a.length===0){return YES}else{if(a.length==1){this.start([a[0],b]);return YES}else{return NO}}},touchesDragged:function(a,c){var d=c.firstObject(),b=d.averagedTouchesForView(this);if(b.touchCount==2){if(!this._startDistance){this._startDistance=b.d}this.scale=b.d/this._startDistance;this.change(c,this.scale)}},touchEnd:function(b){this._startDistance=null;var a=b.touchesForResponder(this);this.trigger(a,this.scale);this.end(a,this.scale);if(a){a.forEach(function(c){this.release(c)},this)}}});sc_require("system/gesture");SC.SWIPE_HORIZONTAL="X";SC.SWIPE_VERTICAL="Y";SC.SWIPE_ANY="XY";SC.SWIPE_LEFT="LEFT";SC.SWIPE_RIGHT="RIGHT";SC.SWIPE_UP="UP";SC.SWIPE_DOWN="DOWN";SC.SwipeGesture=SC.Gesture.extend({name:"swipe",acceptsMultitouch:YES,direction:SC.SWIPE_HORIZONTAL,currentDirection:null,startDistance:5,swipeDistance:40,tolerance:0.5,touchIsInGesture:function(j,g){if(!g.flunked){var k=this.get("direction"),e=this.get("currentDirection"),a=this.get("startDistance"),h=j.pageX-j.startX,f=j.pageY-j.startY,c=Math.abs(h),b=Math.abs(f);if(Math.abs(h)>a||Math.abs(f)>a){if(!e){if(k==SC.SWIPE_ANY){if(c>b){e=SC.SWIPE_HORIZONTAL}else{if(b>c){e=SC.SWIPE_VERTICAL}else{return NO}}}else{e=k}this.set("currentDirection",e)}var m=(e==SC.SWIPE_HORIZONTAL)?h:f,l=(e==SC.SWIPE_HORIZONTAL)?f:h;if(Math.abs(m)*this.get("tolerance")>Math.abs(l)){return YES}}}return NO},touchStart:function(e){var b=this.get("currentDirection"),c=e["page"+b]-e["start"+b],a;if(c<0){a=(b===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{a=(b===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}this.start(e,a,c);return YES},touchesDragged:function(k,e){var c=e.firstObject();var f=this.get("currentDirection"),a=(f===SC.SWIPE_HORIZONTAL?"Y":"X"),j=c["page"+f]-c["start"+f],g=c["page"+a]-c["start"+a],h;if(j<0){h=(f===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{h=(f===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}if(Math.abs(j)<this.get("startDistance")||Math.abs(j)*this.get("tolerance")<Math.abs(g)){this.release(c);var b=c.touchesForResponder(this);if(!b||b.length===0){this.cancel(c,h,j)}}else{this.change(c,h,j)}},touchEnd:function(h){var f=this.get("currentDirection"),e=(f===SC.SWIPE_HORIZONTAL?"Y":"X"),g=h["page"+f]-h["start"+f],b=h["page"+e]-h["start"+e],a;if(g<0){a=(f===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{a=(f===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}if(Math.abs(g)>this.get("swipeDistance")||Math.abs(g)*this.get("tolerance")<Math.abs(b)){this.trigger(h,a)}this.end(h,a,g);this.set("currentDirection",null);var c=h.touchesForResponder(this);if(c){c.forEach(function(d){this.release(d)},this)}},cancel:function(){arguments.callee.base.apply(this,arguments);this.set("currentDirection",null)}});sc_require("system/gesture");SC.TapGesture=SC.Gesture.extend({name:"tap",acceptsMultitouch:NO,_tapCount:null,_candidateTouch:null,_eventTimer:null,tapWiggle:10,tapDelay:200,touchIsInGesture:function(b,a){return !b.tapFlunked},touchStart:function(a){if(this._eventTimer){this._eventTimer.invalidate()}if(this._candidateTouch&&this._candidateTouch.touch.identifier!==a.identifier){this._cancelTap(a);return NO}this._candidateTouch={startTime:Date.now(),touch:a};this.start(a);return YES},touchesDragged:function(a,c){var e=c[0];var b=(c.length>1||!this._candidateTouch||e.identifier!==this._candidateTouch.touch.identifier);var d=this._calculateDragDistance(e)>this.get("tapWiggle");if(b||d){this._cancelTap(e)}},touchEnd:function(a){if(this._calculateDragDistance(a)>this.get("tapWiggle")||Date.now()-this._candidateTouch.startTime>this.get("tapDelay")){this._cancelTap(a)}else{this._addTap(a)}},_addTap:function(b){var a=this;if(this._eventTimer){this._eventTimer.invalidate()}this._tapCount=(this._tapCount||0)+1;this._candidateTouch=null;this._eventTimer=SC.Timer.schedule({target:a,action:function(){this._triggerTap(b)},interval:this.get("tapDelay")});this.change(b,this._tapCount);this.trigger(b,this._tapCount)},_cancelTap:function(a){a.tapFlunked=YES;this.release(a);this.cancel(a,this._tapCount);if(this._eventTimer){this._eventTimer.invalidate()}this._tapCount=null;this._candidateTouch=null;this._eventTimer=null},_triggerTap:function(a){this.end(a,this._tapCount);this._tapCount=null;this._candidateTouch=null;this._eventTimer=null},_calculateDragDistance:function(a){return Math.sqrt(Math.pow(a.pageX-a.startX,2)+Math.pow(a.pageY-a.startY,2))}});SC.AutoMixin={autoMixins:[],createChildView:function(b,c){if(!c){c={}}c.owner=c.parentView=this;c.isVisibleInWindow=this.get("isVisibleInWindow");if(!c.page){c.page=this.page}var a=this.get("autoMixins");a.push(c);b=b.create.apply(b,a);return b}};SC.mixin({_copy_computed_props:["maxWidth","maxHeight","paddingLeft","paddingRight","paddingTop","paddingBottom","fontFamily","fontSize","fontStyle","fontWeight","fontVariant","lineHeight","whiteSpace","letterSpacing","wordWrap"],stringFromLayout:function(e){var d=["maxHeight","maxWidth","minHeight","minWidth","centerY","centerX","width","height","bottom","right","top","left","zIndex","opacity","border","borderLeft","borderRight","borderTop","borderBottom"],a=[],c,b=d.length;while(--b>=0){c=d[b];if(e.hasOwnProperty(c)){a.push(c+":"+e[c])}}return"{"+a.join(", ")+"}"},heightForString:function(h,c,b,a,g){var e=this._heightCalcElement,f,j;if(!g){h=SC.RenderContext.escapeHTML(h)}f=(a&&SC.typeOf(a)===SC.T_ARRAY)?a.join(" "):"";if(!c){c=100}if(!e){e=this._heightCalcElement=document.createElement("div");document.body.insertBefore(e,null)}b=b+"; width: "+c+"px; left: "+(-1*c)+"px; position: absolute";var d=SC.$(e);d.attr("style",b);if(f!==""){d.attr("class",f)}e.innerHTML=h;j=e.clientHeight;e=null;return j},prepareStringMeasurement:function(o,a){var k=this._metricsCalculationElement,h,p,c,d;h=SC.A(a).join(" ");if(!k){var n=document.createElement("div");n.style.cssText="position:absolute; left:-10010px; top:-10px;width:10000px; height:0px; overflow:hidden;visibility:hidden;";k=this._metricsCalculationElement=document.createElement("div");n.appendChild(k);document.body.insertBefore(n,null)}d=SC.$(k);if(SC.typeOf(o)!=SC.T_STRING){var g=null;if(document.defaultView&&document.defaultView.getComputedStyle){g=document.defaultView.getComputedStyle(o,null)}else{g=o.currentStyle}var m=this._copy_computed_props;for(var j=0;j<m.length;j++){var b=m[j],f=g[b];k.style[b]=f}var l=k.style;if(l.font===""){var e="";if(l.fontStyle){e+=l.fontStyle+" "}if(l.fontVariant){e+=l.fontVariant+" "}if(l.fontWeight){e+=l.fontWeight+" "}if(l.fontSize){e+=l.fontSize}else{e+="10px"}if(l.lineHeight){e+="/"+l.lineHeight}e+=" ";if(l.fontFamily){e+=l.fontFamily}else{l+="sans-serif"}k.style.font=e}SC.mixin(k.style,{left:"0px",top:"0px",position:"absolute",bottom:"auto",right:"auto",width:"auto",height:"auto"});g=null}else{c=o;d.attr("style",c+"; position:absolute; left: 0px; top: 0px; bottom: auto; right: auto; width: auto; height: auto;")}k.className=h;k=null},teardownStringMeasurement:function(){var a=this._metricsCalculationElement;a.innerHTML="";a.className="";a.setAttribute("style","");a=null},measureString:function(c,b){var d=this._metricsCalculationElement,e=0;if(!d){throw"measureString requires a string measurement environment to be set up. Did you mean metricsForString?"}if(b){d.innerHTML=c}else{if(typeof d.innerText!="undefined"){d.innerText=c}else{d.textContent=c}}if(SC.browser.isIE){e=1}var a={width:d.clientWidth+e,height:d.clientHeight};if(SC.browser.isMozilla){a.width+=1}d=null;return a},metricsForString:function(c,d,e,b){SC.prepareStringMeasurement(d,e);var a=SC.measureString(c,b);SC.teardownStringMeasurement();return a}});sc_require("system/utils/string_measurement");SC.AutoResize={shouldAutoResize:YES,shouldMeasureSize:YES,shouldCacheSizes:NO,shouldResizeWidth:YES,shouldResizeHeight:NO,measuredSize:{width:0,height:0},maxWidth:null,maxHeight:null,shouldAutoFitText:NO,autoFitDiscreteFontSizes:NO,minFontSize:12,maxFontSize:20,calculatedFontSize:20,fontPropertyDidChange:function(){if(this.get("shouldAutoFitText")){this.invokeLast(this.fitTextToFrame)}}.observes("shouldAutoFitText","minFontSize","maxFontSize","measuredSize"),measuredSizeDidChange:function(){var c=this.get("measuredSize"),b=c.width,h=c.height,g,a,d=this.get("autoResizePadding")||0,f=this.get("maxWidth"),e=this.get("maxHeight");if(SC.typeOf(d)===SC.T_NUMBER){g=a=d}else{g=d.height;a=d.width}h+=g;b+=a;if(this.get("shouldAutoResize")){if(this.get("shouldResizeWidth")){if(f&&b>f){b=f}this.set("calculatedWidth",b);this.adjust("width",b)}if(this.get("shouldResizeHeight")){if(e&&h>e){h=e}this.set("calculatedHeight",h);this.adjust("height",h)}}}.observes("shouldAutoResize","measuredSize","autoResizePadding","maxWidth","minWidth","shouldResizeWidth","shouldResizeHeight"),initMixin:function(){},batchResizeId:null,scheduleMeasurement:function(){var a=this.get("batchResizeId");if(!this.get("shouldMeasureSize")||!this.get("isVisibleInWindow")||(this.get("autoResizeText")===this._lastMeasuredText&&a===this._lastMeasuredId)){return}SC.AutoResizeManager.scheduleMeasurementForView(this,a)}.observes("isVisibleInWindow","shouldMeasureSize","autoResizeText","batchResizeId"),_lastMeasuredText:null,_cachedMetrics:function(c,d){if(!this.get("shouldCacheSizes")){return}var b=SC.cacheSlotFor(this.get("batchResizeId")||this),a=this.get("autoResizeText");if(d){b[a]=d}else{d=b[a]}return d}.property("shouldCacheSizes","autoResizeText","batchResizeId").cacheable(),measureSize:function(d){var h,e=this.get("autoResizeLayer"),c=this.get("autoResizeText"),b=!this.get("escapeHTML"),g=this.get("batchResizeId"),a=this.get("_cachedMetrics"),f=this.get("maxFontSize");if(!e){return}if(a){h=a}else{if(SC.none(c)||c===""){h={width:0,height:0}}else{if(d){h=SC.measureString(c,b)}else{this.prepareLayerForStringMeasurement(e);h=SC.metricsForString(c,e,this.get("classNames"),b)}}}this.set("measuredSize",h);if(this.get("shouldCacheSizes")){this.setIfChanged("_cachedMetrics",h)}this._lastMeasuredText=c;this._lastMeasuredId=g;return h},prepareLayerForStringMeasurement:function(a){var b=this.get("maxFontSize");if(this.get("shouldAutoFitText")&&this.get("calculatedFontSize")!==b){a.style.fontSize=b+"px"}},viewDidResize:function(a){a();this.fontPropertyDidChange()}.enhance(),fitTextToFrame:function(){var s=this.get("autoResizeLayer");if(!s){return}var c=this.get("maxFontSize"),d=this.get("minFontSize");this.prepareLayerForStringMeasurement(s);var e=this.get("frame"),f=this.get("autoResizePadding")||0,k=e.width-1,g=e.height-1,q=this.get("measuredSize"),a=q.width,t=q.height;if(SC.typeOf(f)===SC.T_NUMBER){k-=f;g-=f}else{k-=f.width;g-=f.height}if(a<=k&&t<=g){return}if(this.get("autoFitDiscreteFontSizes")){h=d}else{var b=k/a,j=g/t,m=Math.floor(c*Math.min(b,j)),h,p=this.get("classNames"),o=!this.get("escapeHTML"),l=this.get("autoResizeText"),n;m=h=Math.min(c,Math.max(d,m));s.style.fontSize=m+"px";n=SC.metricsForString(l,s,p,o);if(n.width>k||n.height>g){for(m=m-1;m>=d;m--){s.style.fontSize=m+"px";n=SC.metricsForString(l,s,p,o);h=m;if(n.width<=k&&n.height<=g){break}}}else{if(n.width<k||n.height<g){for(m=m+1;m<=c;m++){s.style.fontSize=m+"px";n=SC.metricsForString(l,s,p,o);if(n.width<=k&&n.height<=g){h=m}if(n.width>=k||n.height>=g){break}}}}}s.style.fontSize=h+"px";this.set("calculatedFontSize",h)},applyAttributesToContext:function(b,a){b(a);if(this.get("shouldAutoFitText")){a.css("font-size",this.get("calculatedFontSize")+"px")}}.enhance(),didCreateLayer:function(a){a();this.scheduleMeasurement()}.enhance()};SC.AutoResizeManager={measurementQueue:SC.CoreSet.create(),scheduleMeasurementForView:function(a){this.measurementQueue.add(a);SC.RunLoop.currentRunLoop.invokeLast(this.doBatchResize)},cancelMeasurementForView:function(a,b){this.measurementQueue.remove(a)},doBatchResize:function(){if(this!==SC.AutoResizeManager){return SC.AutoResizeManager.doBatchResize()}var b,d,f,g=this.measurementQueue,h,c,e,a;while((a=g.get("length"))>0){h=NO;b=g[a-1].get("batchResizeId");for(e=a-1;e>=0;--e){d=g[e];if(d.get("batchResizeId")!==b){continue}if(d.get("isVisibleInWindow")&&d.get("shouldMeasureSize")&&(f=d.get("autoResizeLayer"))){c=d.get("autoResizeText");if(!SC.none(c)&&c!==""&&!d.get("_cachedMetrics")&&!h){d.prepareLayerForStringMeasurement(f);SC.prepareStringMeasurement(f,d.get("classNames"));h=YES}d.measureSize(YES)}g.remove(d);if(!b){break}}if(h){SC.teardownStringMeasurement()}}}};if(SC.Button){SC.Button.initMixin=function(){throw"SC.Button is deprecated as a mixin and is now a subclass of SC.TemplateView. Subclass SC.ButtonView instead."}}SC.ContentDisplay={concatenatedProperties:"contentDisplayProperties",displayProperties:["content"],contentDisplayProperties:[],initMixin:function(){this._display_contentDidChange()},destroyMixin:function(){if(!this._display_content){return}this._display_stopObservingContent(this._display_content);this._display_content=null},_display_beginObservingContent:function(a){var b=this._display_contentPropertyDidChange;if(SC.isArray(a)){a.invoke("addObserver","*",this,b)}else{if(a.addObserver){a.addObserver("*",this,b)}}},_display_stopObservingContent:function(a){var b=this._display_contentPropertyDidChange;if(SC.isArray(a)){a.invoke("removeObserver","*",this,b)}else{if(a.removeObserver){a.removeObserver("*",this,b)}}},_display_contentDidChange:function(d,a,c){if((c=this.get("content"))===this._display_content){return}var b=this._display_content;if(b){this._display_stopObservingContent(b)}b=this._display_content=c;if(b){this._display_beginObservingContent(b)}this.displayDidChange()}.observes("content","contentDisplayProperties"),_display_contentPropertyDidChange:function(e,c,d,b){if(c==="*"){this.displayDidChange()}else{var a=this.get("contentDisplayProperties");if(a&&a.indexOf(c)>=0){this.displayDidChange()}}}};SC.ContentValueSupport={hasContentValueSupport:YES,initMixin:function(){this._control_contentKeysDidChange()},value:null,content:null,contentKeys:null,_default_contentKeys:{contentValueKey:"value"},contentValueKey:null,contentPropertyDidChange:function(c,b){var a=this.get("contentKeys");if(a){var d;for(d in a){if(b==="*"||b===this.getDelegateProperty(d,this,this.get("displayDelegate"),a)){return this.updatePropertyFromContent(a[d],b,d,c)}}}else{return this.updatePropertyFromContent("value",b,"contentValueKey",c)}},updatePropertyFromContent:function(f,c,e,d){var a,b;if(e===undefined){e="content"+f.capitalize()+"Key"}if(this[e]){e=this.get(e)}else{if((a=this.get("displayDelegate"))&&(b=a[e])){e=a.get?a.get(e):b}else{return this}}if(c==="*"||c===e){if(d===undefined){d=this.get("content")}if(d){b=d.get?d.get(e):d[e]}else{b=null}this.setIfChanged(f,b)}return this},updateContentWithValueObserver:function(d,a){var f=this._reverseContentKeys;if(!a||a==="*"){for(a in f){this.updateContentWithValueObserver(this,a)}}var c=this.get(a);var b=this.get("content"),e=this.getDelegateProperty(f[a],this,this.displayDelegate);if(!e||!b){return this}if(typeof b.setIfChanged===SC.T_FUNCTION){b.setIfChanged(e,c)}else{if(b[e]!==c){b[e]=c}}},_control_content:null,_old_contentValueKeys:null,_old_contentKeys:null,_control_contentDidChange:function(h,l){var j=this.get("content"),b=this.get("contentKeys"),a,c=this._control_content,m=this._old_contentValueKeys,k=SC.typeOf(m),g=this.contentPropertyDidChange;if(c&&c.removeObserver&&m){if(k===SC.T_STRING){c.removeObserver(m,this,g);m=null}else{var d,e=m.get("length");for(d=0;d<e;d++){a=m[d];c.removeObserver(a,this,g)}m.clear()}}if(j&&j.addObserver){if(b){if(!m){m=SC.CoreSet.create()}for(a in b){a=this.getDelegateProperty(a,this,this.get("displayDelegate"));if(a){j.addObserver(a,this,g);m.add(a)}}}else{a=this.getDelegateProperty("contentValueKey",this,this.get("displayDelegate"));if(a){j.addObserver(a,this,g);if(m){m.add(a)}else{m=a}}}}this._control_content=j;this._old_contentValueKeys=m;l=(!l||l==="content")?"*":this.get(l);if(l){this.contentPropertyDidChange(j,l)}}.observes("content"),_old_contentKeys:null,_control_contentKeysDidChange:function(){var d,c={},a=this.get("contentKeys")||this._default_contentKeys,h,b=this._old_contentKeys,g=this._control_contentDidChange,e=this.updateContentWithValueObserver;for(d in b){h=b[d];this.removeObserver(h,this,e);this.removeObserver(d,this,g)}for(d in a){h=a[d];c[h]=d;this.addObserver(h,this,e);this.addObserver(d,this,g)}this._reverseContentKeys=c;this._old_contentKeys=a;this._control_contentDidChange()}.observes("contentKeys")};sc_require("mixins/content_value_support");sc_require("system/string");SC.AUTO_CONTROL_SIZE="__AUTO__";SC.JUMBO_CONTROL_SIZE="sc-jumbo-size";SC.HUGE_CONTROL_SIZE="sc-huge-size";SC.LARGE_CONTROL_SIZE="sc-large-size";SC.REGULAR_CONTROL_SIZE="sc-regular-size";SC.SMALL_CONTROL_SIZE="sc-small-size";SC.TINY_CONTROL_SIZE="sc-tiny-size";SC.Control=SC.mixin(SC.clone(SC.ContentValueSupport),{isControl:YES,isSelected:NO,isSelectedBindingDefault:SC.Binding.oneWay().bool(),isActive:NO,isActiveBindingDefault:SC.Binding.oneWay().bool(),fieldKey:null,fieldLabel:null,errorLabel:function(){var a,d,c,b;if(a=this.get("fieldLabel")){return a}d=this.get("fieldKey")||this.constructor.toString();c=d?SC.String.capitalize(SC.String.humanize(d)):"";b=SC.String.locWithDefault("FieldKey."+d,c);return SC.String.locWithDefault("ErrorLabel."+d,b)}.property("fieldLabel","fieldKey").cacheable(),controlSize:SC.REGULAR_CONTROL_SIZE,displayProperties:["isEnabled","isSelected","isActive","controlSize"],_CONTROL_TMP_CLASSNAMES:{},renderMixin:function(b,g){var d=this.get("isSelected"),c=!this.get("isEnabled"),e=this._CONTROL_TMP_CLASSNAMES;e.mixed=d===SC.MIXED_STATE;e.sel=d&&(d!==SC.MIXED_STATE);e.active=this.get("isActive");var f=this.get("controlSize");if(!f){f=SC.REGULAR_CONTROL_SIZE}if(g){b.setClass(e);if(!this.get("renderDelegate")){b.addClass(f)}}else{b.$().setClass(e);if(!this.get("renderDelegate")){b.$().addClass(f)}}if(!g&&this.$input){var a=this.$input();if(a.attr("type")!=="radio"){this.$input().attr("disabled",c)}}}});SC.Editable={isEditable:NO,isEditing:NO,beginEditing:function(){if(!this.get("isEditable")){return NO}if(this.get("isEditing")){return YES}this.beginPropertyChanges();this.set("isEditing",YES);this.becomeFirstResponder();this.endPropertyChanges();return YES},discardEditing:function(){return !this.get("isEditing")},commitEditing:function(){if(!this.get("isEditing")){return YES}this.set("isEditing",NO);this.resignFirstResponder();return YES}};SC.ALIGN_JUSTIFY="justify";SC.FlowedLayout={isFlowedLayout:YES,layoutDirection:SC.LAYOUT_HORIZONTAL,autoResize:YES,shouldResizeWidth:YES,shouldResizeHeight:YES,align:SC.ALIGN_LEFT,canWrap:YES,defaultFlowSpacing:{left:0,bottom:0,top:0,right:0},flowPadding:{left:0,bottom:0,right:0,top:0},_scfl_validFlowPadding:function(){var b=this.get("flowPadding")||{},a={};a.left=b.left||0;a.top=b.top||0;a.bottom=b.bottom||0;a.right=b.right||0;return a}.property("flowPadding").cacheable(),concatenatedProperties:["childMixins"],initMixin:function(){this._scfl_tileOnce()},_scfl_childViewsDidChange:function(a){this._scfl_tileOnce()}.observes("childViews"),_scfl_layoutPropertyDidChange:function(a){this._scfl_tileOnce()}.observes("layoutDirection","align","flowPadding","canWrap","defaultFlowSpacing","isVisibleInWindow"),layoutDidChangeFor:function(g){var b=g._scfl_lastLayout,a=g.get("layout"),d=g.get("frame");if(!b){return arguments.callee.base.apply(this,arguments)}var e=YES;if(b.left&&b.left!==a.left){e=NO}else{if(b.top&&b.top!==a.top){e=NO}else{if(!g.get("fillWidth")&&b.width&&b.width!==a.width){e=NO}else{if(!b.width&&!g.get("fillWidth")&&d.width!==g._scfl_lastFrame.width){e=NO}else{if(!g.get("fillHeight")&&b.height&&b.height!==a.height){e=NO}else{if(!b.height&&!g.get("fillHeight")&&d.height!==g._scfl_lastFrame.height){e=NO}}}}}}if(e){return arguments.callee.base.apply(this,arguments)}this._scfl_tileOnce();arguments.callee.base.apply(this,arguments)},observeChildLayout:function(a){if(a._scfl_isBeingObserved){return}a._scfl_isBeingObserved=YES;a.addObserver("flowSpacing",this,"_scfl_tileOnce");a.addObserver("isVisible",this,"_scfl_tileOnce");a.addObserver("useAbsoluteLayout",this,"_scfl_tileOnce");a.addObserver("calculatedWidth",this,"_scfl_tileOnce");a.addObserver("calculatedHeight",this,"_scfl_tileOnce");a.addObserver("startsNewRow",this,"_scfl_tileOnce");a.addObserver("isSpacer",this,"_scfl_tileOnce");a.addObserver("maxSpacerLength",this,"_scfl_tileOnce");a.addObserver("fillWidth",this,"_scfl_tileOnce");a.addObserver("fillHeight",this,"_scfl_tileOnce")},unobserveChildLayout:function(a){a._scfl_isBeingObserved=NO;a.removeObserver("flowSpacing",this,"_scfl_tileOnce");a.removeObserver("isVisible",this,"_scfl_tileOnce");a.removeObserver("useAbsoluteLayout",this,"_scfl_tileOnce");a.removeObserver("calculatedWidth",this,"_scfl_tileOnce");a.removeObserver("calculatedHeight",this,"_scfl_tileOnce");a.removeObserver("startsNewRow",this,"_scfl_tileOnce");a.removeObserver("isSpacer",this,"_scfl_tileOnce");a.removeObserver("maxSpacerLength",this,"_scfl_tileOnce");a.removeObserver("fillWidth",this,"_scfl_tileOnce");a.removeObserver("fillHeight",this,"_scfl_tileOnce")},shouldIncludeChildInFlow:function(a,b){return b.get("isVisible")&&!b.get("useAbsoluteLayout")},flowSpacingForChild:function(a,b){var c=b.get("flowSpacing");if(SC.none(c)){c=this.get("defaultFlowSpacing")}if(SC.none(c)){c=0}if(SC.typeOf(c)===SC.T_NUMBER){c={left:c,right:c,bottom:c,top:c}}else{c.left=c.left||0;c.right=c.right||0;c.top=c.top||0;c.bottom=c.bottom||0}return c},flowSizeForChild:function(a,d){var c=d.get("calculatedWidth"),g=d.get("calculatedHeight"),j=this.get("layoutDirection"),e={},h=d.get("frame"),b=d.get("layout");d._scfl_lastFrame=h;if(c){e.width=c}else{e.width=b.width||h.width}if(g){e.height=g}else{e.height=b.height||h.height}if(d.get("isSpacer")){e.maxSpacerLength=d.get("maxSpacerLength");if(j===SC.LAYOUT_HORIZONTAL){e.width=b.minWidth||0}else{e.height=b.minHeight||0}}if(j===SC.LAYOUT_HORIZONTAL&&d.get("fillHeight")){e.height=b.minHeight||0}else{if(j===SC.LAYOUT_VERTICAL&&d.get("fillWidth")){e.width=b.minWidth||0}}return e},clippingFrame:function(){return{left:0,top:0,width:this.get("calculatedWidth"),height:this.get("calculatedHeight")}}.property("calculatedWidth","calculatedHeight"),_scfl_maxCollapsedRowLength:0,_scfl_totalCollapsedRowSize:0,_scfl_calculatedSizeDidChange:function(){if(this.get("autoResize")){if(this.get("layoutDirection")==SC.LAYOUT_VERTICAL){if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_totalCollapsedRowSize"))}}else{if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_totalCollapsedRowSize"))}}}}.observes("autoResize","shouldResizeWidth","_scfl_maximumCollapsedRowLength","_scfl_totalCollapsedRowSize","shouldResizeHeight"),_scfl_createPlan:function(){var e=this.get("layoutDirection"),a=this.get("_scfl_validFlowPadding"),d=this.get("frame");var c=(e===SC.LAYOUT_VERTICAL);var b={rows:undefined,maximumCollapsedRowLength:0,totalCollapsedRowSize:0,isVertical:e===SC.LAYOUT_VERTICAL,isHorizontal:e===SC.LAYOUT_HORIZONTAL,flowPadding:a,planStartPadding:a[c?"left":"top"],planEndPadding:a[c?"right":"bottom"],rowStartPadding:a[c?"top":"left"],rowEndPadding:a[c?"bottom":"right"],maximumRowLength:undefined,fitToPlanSize:undefined,align:this.get("align")};if(c){b.maximumRowLength=d.height-b.rowStartPadding-b.rowEndPadding;b.fitToPlanSize=d.width-b.planStartPadding-b.planEndPadding}else{b.maximumRowLength=d.width-b.rowStartPadding-b.rowEndPadding;b.fitToPlanSize=d.height-b.planStartPadding-b.planEndPadding}return b},_scfl_distributeChildrenIntoRows:function(d){var b=this.get("childViews"),a,g,c=b.length,e=d.isVertical,j=[],f;f=-1;g=0;while(g<c&&g!==f){f=g;var h={plan:d,rowLength:undefined,rowSize:undefined,shouldExpand:undefined,items:undefined,position:undefined};g=this._scfl_distributeChildrenIntoRow(b,g,h);j.push(h)}d.rows=j},_scfl_distributeChildrenIntoRow:function(e,n,j){var p,v=e.length,b=j.plan,g,a,d,q=[],l=0,m=b.isVertical,k,f,c,o=this.get("canWrap"),h=NO,s=0,u=j.plan.maximumRowLength;for(p=n;p<v;p++){g=e[p];h=h||(q.length>0&&g.get("startsNewRow"));if(!this.shouldIncludeChildInFlow(p,g)){continue}a=this.flowSizeForChild(p,g);d=this.flowSpacingForChild(p,g);a.width+=d.left+d.right;a.height+=d.top+d.bottom;f=a[m?"height":"width"];if(!SC.none(a.maxSpacerLength)){c=a.maxSpacerLength+(m?d.top+d.bottom:d.left+d.right)}k=a[m?"width":"height"];if((h||(o&&l+f>u))&&q.length>0){break}var w={child:g,itemLength:f,maxSpacerLength:c,itemSize:k,spacing:d,position:undefined,fillRow:m?g.get("fillWidth"):g.get("fillHeight"),isSpacer:g.get("isSpacer"),left:undefined,top:undefined,width:undefined,height:undefined};q.push(w);l+=f;s=Math.max(f,s)}j.rowLength=l;var t=o?s:j.rowLength;j.plan.maximumCollapsedRowLength=Math.max(t,j.plan.maximumCollapsedRowLength);j.items=q;return p},_scfl_positionChildrenInRows:function(d){var c=d.rows,b=c.length,a;for(a=0;a<b;a++){this._scfl_positionChildrenInRow(c[a])}},_scfl_positionChildrenInRow:function(n){var g=n.items,e=g.length,k,m,d,l=0,a=0,c,f=n.plan.align,j=YES,b=0,h=NO;for(k=0;k<e;k++){m=g[k];if(m.isSpacer){a+=m.child.get("spaceUnits")||1}}if(f===SC.ALIGN_JUSTIFY){a+=e-1}c=Math.max(0,n.plan.maximumRowLength-n.rowLength)/a;while(c>0){for(k=0;k<e;k++){m=g[k];if(m.isSpacer){m.itemLength+=c*(m.child.get("spaceUnits")||1);if(m.itemLength>m.maxSpacerLength){b+=m.itemLength-m.maxSpacerLength;m.itemLength=m.maxSpacerLength}else{h=YES}}}if(!h){break}c=Math.round(b/a);b=0}d=0;if(a===0&&(f===SC.ALIGN_RIGHT||f===SC.ALIGN_BOTTOM)){d=n.plan.maximumRowLength-n.rowLength}else{if(a===0&&(f===SC.ALIGN_CENTER||f===SC.ALIGN_MIDDLE)){d=(n.plan.maximumRowLength/2)-(n.rowLength/2)}}d+=n.plan.rowStartPadding;for(k=0;k<e;k++){m=g[k];if(!m.fillRow){j=NO}l=Math.max(m.itemSize,l);m.position=d;d+=m.itemLength;if(f===SC.ALIGN_JUSTIFY&&k<e-1){d+=c}}n.shouldExpand=e>0?j:NO;n.rowLength=d-n.plan.rowStartPadding;n.rowSize=l;n.plan.totalCollapsedRowSize+=n.rowSize},_scfl_positionRows:function(d){var j=d.rows,c=j.length,f,h,b,a=0,g=0,e;for(f=0;f<c;f++){if(j[f].shouldExpand){a++}g+=j[f].rowSize}e=d.fitToPlanSize-g;b=d.planStartPadding;for(f=0;f<c;f++){h=j[f];if(h.shouldExpand&&e>0){h.rowSize+=e/a;a--}h.position=b;b+=h.rowSize}},_scfl_applyPlan:function(h){var o=h.rows,b,c,n,e=0,k=0,g,a,d,m,f,l,j=h.isVertical;c=o.length;for(b=0;b<c;b++){n=o[b];e=Math.max(e,n.rowLength);k+=n.rowSize;g=n.items;d=g.length;for(a=0;a<d;a++){m=g[a];m.child.beginPropertyChanges();l=m.fillRow?n.rowSize:m.itemSize;f={left:m.spacing.left+(j?n.position:m.position),top:m.spacing.top+(j?m.position:n.position),width:j?l:m.itemLength,height:j?m.itemLength:l};f.width-=m.spacing.left+m.spacing.right;f.height-=m.spacing.top+m.spacing.bottom;this.applyPlanToView(m.child,f);m.child._scfl_lastLayout=f;m.child.endPropertyChanges()}}k+=h.planStartPadding+h.planEndPadding;e+=h.rowStartPadding+h.rowEndPadding;this.beginPropertyChanges();this.set("calculatedHeight",j?e:k);this.set("calculatedWidth",j?k:e);this.set("_scfl_maximumCollapsedRowLength",h.maximumCollapsedRowLength);this.set("_scfl_totalCollapsedRowSize",h.totalCollapsedRowSize);this.endPropertyChanges()},applyPlanToView:function(a,b){a.adjust(b)},_scfl_tileOnce:function(){this.invokeLast(this._scfl_tile)},_scfl_tile:function(){if(!this.get("isVisibleInWindow")){return}var f=this._scfl_createPlan();this._scfl_distributeChildrenIntoRows(f);this._scfl_positionChildrenInRows(f);this._scfl_positionRows(f);this._scfl_applyPlan(f);this.setIfChanged("numberOfRows",f.rows.length);var d=this._scfl_isObserving||SC.CoreSet.create(),c=SC.CoreSet.create();var e=this.get("childViews"),b=e.length,a,g;for(a=0;a<b;a++){g=e[a];if(!d.contains(g)){this.observeChildLayout(g)}else{d.remove(g)}c.add(g)}b=d.length;for(a=0;a<b;a++){this.unobserveChildLayout(d[a])}},_scfl_frameDidChange:function(){var b=this.get("frame"),a=this._scfl_lastFrameSize||{};this._scfl_lastFrameSize=SC.clone(b);if(a.width==b.width&&a.height==b.height){return}this._scfl_tileOnce()}.observes("frame"),destroyMixin:function(){var c=this._scfl_isObserving;if(!c){return}var b=c.length,a;for(a=0;a<b;a++){this.unobserveChildLayout(c[a])}},reorder:function(b){if(!SC.typeOf(b)===SC.T_ARRAY){b=arguments}var c=b.length,d=this.childViews,a;this.beginPropertyChanges();while(c-->0){a=b[c];if(SC.typeOf(a)===SC.T_STRING){a=this.get(a)}d.removeObject(a);d.unshiftObject(a)}this.endPropertyChanges();this._scfl_childViewsDidChange();return this}};SC.Gesturable={concatenatedProperties:["gestures"],gestures:[],initMixin:function(){this.createGestures()},createGestures:function(){var e=this.get("gestures"),b,a=e.length,c,d=[];for(b=0;b<a;b++){if(SC.typeOf(e[b])===SC.T_STRING){c=this.get(e[b])}else{c=e[b]}if(!c){throw"Could not find gesture named '"+e[b]+"' on view."}if(c.isClass){c=c.create({view:this})}if(SC.typeOf(e[b])===SC.T_STRING){this[e[b]]=c}d.push(c)}this.set("gestures",d)},touchStart:function(a){this.gestureTouchStart(a)},touchesDragged:function(a,b){this.gestureTouchesDragged(a,b)},touchEnd:function(a){this.gestureTouchEnd(a)},gestureTouchStart:function(e){e.isInteresting=0;var d=this.get("gestures"),b,a=d.length,c;for(b=0;b<a;b++){c=d[b];c.unassignedTouchDidStart(e)}},gestureTouchesDragged:function(c,e){var f=this.get("gestures"),b,a=f.length,d;for(b=0;b<a;b++){d=f[b];d.unassignedTouchesDidChange(c,e)}},gestureTouchEnd:function(e){var d=this.get("gestures"),b,a=d.length,c;for(b=0;b<a;b++){c=d[b];c.unassignedTouchDidEnd(e)}}};SC.InlineEditable={isInlineEditable:YES,isEditable:YES,exampleEditor:SC.InlineTextFieldView,isEditing:NO,inlineEditorDelegate:SC.InlineTextFieldDelegate,_editor:null,beginEditing:function(){var a;a=this.delegateFor("inlineEditorShouldBeginEditing",this.inlineEditorDelegate);if(a&&!a.inlineEditorShouldBeginEditing(this,this.get("value"))){return NO}this._editor=this.invokeDelegateMethod(this.inlineEditorDelegate,"acquireEditor",this);if(this._editor){return this._editor.beginEditing(this)}else{return NO}},commitEditing:function(){return this._editor?this._editor.commitEditing():NO},discardEditing:function(){return this._editor?this._editor.discardEditing():NO},inlineEditorShouldBeginEditing:function(){return !this.get("isEditing")&&this.get("isEditable")},inlineEditorWillBeginEditing:function(b,c,a){b.set("value",this.get("value"))},inlineEditorDidBeginEditing:function(b,c,a){this.set("isEditing",YES)},inlineEditorWillCommmitEditing:function(b,c,a){if(this.inlineEditorWillEndEditing){this.inlineEditorWillEndEditing(b,c)}},inlineEditorDidCommitEditing:function(b,c,a){a.setIfChanged("value",c);if(this.inlineEditorDidEndEditing){this.inlineEditorDidEndEditing(b,c)}this._endEditing()},inlineEditorWillDiscardEditing:function(b,a){if(this.inlineEditorWillEndEditing){this.inlineEditorWillEndEditing(b,this.get("value"))}},inlineEditorDidDiscardEditing:function(b,a){if(this.inlineEditorDidEndEditing){this.inlineEditorDidEndEditing(b,this.get("value"))}this._endEditing()},_endEditing:function(){if(this._editor){this.invokeDelegateMethod(this.inlineEditorDelegate,"releaseEditor",this._editor);this._editor=null}this.set("isEditing",NO)}};SC.InlineEditor={isInlineEditor:YES,isEditing:NO,inlineEditorDelegate:null,_target:null,beginEditing:function(b){if(this.get("isEditing")||!b||!b.isInlineEditable){return NO}var a,c;c=this._target=b;a=this.delegateFor("inlineEditorWillBeginEditing",this.inlineEditorDelegate,c);if(a){a.inlineEditorWillBeginEditing(this,this.get("value"),c)}this.set("isEditing",YES);this.invokeLast(this._callDidBegin);this._didBeginInvoked=YES;return YES},_callDidBegin:function(){if(!this.get("isEditing")){return NO}this._didBeginInvoked=NO;var b=this._target,a;a=this.delegateFor("inlineEditorDidBeginEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidBeginEditing(this,this.get("value"),b)}},commitEditing:function(){if(!this.get("isEditing")){return NO}if(this._didBeginInvoked){this._callDidBegin()}var a,b=this._target;a=this.delegateFor("inlineEditorShouldCommitEditing",this.inlineEditorDelegate,b);if(a&&!a.inlineEditorShouldCommitEditing(this,this.get("value"),b)){return NO}a=this.delegateFor("inlineEditorWillCommitEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorWillCommitEditing(this,this.get("value"),b)}this._endEditing();a=this.delegateFor("inlineEditorDidCommitEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidCommitEditing(this,this.get("value"),b)}return YES},discardEditing:function(){if(!this.get("isEditing")){return NO}if(this._didBeginInvoked){this._callDidBegin()}var a,b=this._target;a=this.delegateFor("inlineEditorShouldDiscardEditing",this.inlineEditorDelegate,b);if(a&&!a.inlineEditorShouldDiscardEditing(this,b)){return NO}a=this.delegateFor("inlineEditorWillDiscardEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorWillDiscardEditing(this,b)}this._endEditing();a=this.delegateFor("inlineEditorDidDiscardEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidDiscardEditing(this,b)}return YES},_endEditing:function(){this.set("isEditing",NO);this._target=null}};SC.InlineEditorDelegate={acquireEditor:function(a){},releaseEditor:function(a){},inlineEditorShouldBeginEditing:function(a,b){},inlineEditorWillBeginEditing:function(b,c,a){},inlineEditorDidBeginEditing:function(b,c,a){},inlineEditorShouldCommitEditing:function(b,c,a){},inlineEditorWillCommitEditing:function(b,c,a){},inlineEditorDidCommitEditing:function(b,c,a){},inlineEditorShouldDiscardEditing:function(b,a){},inlineEditorWillDiscardEditing:function(b,a){},inlineEditorDidDiscardEditing:function(b,a){},inlineEditorWillEndEditing:function(b,c,a){},inlineEditorDidEndEditing:function(b,c,a){}};SC.SCALE_NONE="none";SC.FILL="fill";SC.FILL_PROPORTIONALLY="fillProportionally";SC.BEST_FIT="fitBest";SC.BEST_FIT_DOWN_ONLY="fitBestDown";SC.InnerFrame={align:SC.ALIGN_CENTER,innerFrameForSize:function(a,c,h,b){var e=this.get("align"),d=this.get("scale"),g,f,j;j={x:0,y:0,width:h,height:b};if(d===SC.FILL){return j}g=h/a;f=b/c;switch(d){case SC.FILL_PROPORTIONALLY:d=g>f?g:f;break;case SC.BEST_FIT:d=g<f?g:f;break;case SC.BEST_FIT_DOWN_ONLY:if((a>h)||(c>b)){d=g<f?g:f}else{d=1}break;case SC.SCALE_NONE:d=1;break;default:if(isNaN(window.parseFloat(d))||(window.parseFloat(d)<=0)){SC.Logger.warn("SC.InnerFrame: The scale '%@' was not understood.  Scale must be one of SC.FILL, SC.FILL_PROPORTIONALLY, SC.BEST_FIT, SC.BEST_FIT_DOWN_ONLY or a positive number greater than 0.00.".fmt(d));return j}}a*=d;c*=d;j.width=Math.round(a);j.height=Math.round(c);switch(e){case SC.ALIGN_LEFT:j.x=0;j.y=(b/2)-(c/2);break;case SC.ALIGN_RIGHT:j.x=h-a;j.y=(b/2)-(c/2);break;case SC.ALIGN_TOP:j.x=(h/2)-(a/2);j.y=0;break;case SC.ALIGN_BOTTOM:j.x=(h/2)-(a/2);j.y=b-c;break;case SC.ALIGN_TOP_LEFT:j.x=0;j.y=0;break;case SC.ALIGN_TOP_RIGHT:j.x=h-a;j.y=0;break;case SC.ALIGN_BOTTOM_LEFT:j.x=0;j.y=b-c;break;case SC.ALIGN_BOTTOM_RIGHT:j.x=h-a;j.y=b-c;break;default:if(e!==SC.ALIGN_CENTER&&e!==SC.ALIGN_MIDDLE){SC.Logger.warn("SC.InnerFrame: The align '%@' was not understood.  Align must be one of SC.ALIGN_CENTER/SC.ALIGN_MIDDLE, SC.ALIGN_LEFT, SC.ALIGN_RIGHT, SC.ALIGN_TOP, SC.ALIGN_BOTTOM, SC.ALIGN_TOP_LEFT, SC.ALIGN_TOP_RIGHT, SC.ALIGN_BOTTOM_LEFT or SC.ALIGN_BOTTOM_RIGHT.".fmt(e))}j.x=(h/2)-(a/2);j.y=(b/2)-(c/2)}return j},scale:SC.FILL};SC.StaticLayout={hasStaticLayout:YES};SC.Validatable={initMixin:function(){this._validatable_validatorDidChange()},validator:null,errorLabel:null,isValid:function(){return SC.typeOf(this.get("value"))!==SC.T_ERROR}.property("value"),ownerForm:null,performValidate:function(c){var a=SC.VALIDATE_OK;if(this._validator){var b=this.get("ownerForm");if(c){a=this._validator.validatePartial(b,this);if((a==SC.VALIDATE_NO_CHANGE)&&(this._validator.validateChange(b,this)==SC.VALIDATE_OK)){a=SC.VALIDATE_OK}}else{a=this._validator.validateChange(b,this)}}return a},performValidateSubmit:function(){return this._validator?this._validator.validateSubmit(this.get("ownerForm"),this):SC.VALIDATE_OK},performValidateKeyDown:function(a){var b=a.getCharString();if(!b){return this.needValidChar?NO:YES}return this._validator?this._validator.validateKeyDown(this.get("ownerForm"),this,b):YES},validatorObject:function(){return this._validator}.property(),validateSubmit:function(){return this.performValidateSubmit()},objectForFieldValue:function(b,a){return this._validator?this._validator.objectForFieldValue(b,this.get("ownerForm"),this):b},fieldValueForObject:function(a){return this._validator?this._validator.fieldValueForObject(a,this.get("ownerForm"),this):a},_validatable_displayObserver:function(){this.displayDidChange()}.observes("isValid"),renderMixin:function(a){a.setClass("invalid",!this.get("isValid"))},_validatable_validatorDidChange:function(){var a=this.get("ownerForm");var b=SC.Validator.findFor(a,this,this.get("validator"));if(b!=this._validator){this.propertyWillChange("validatorObject");if(this._validator){this._validator.detachFrom(a,this)}this._validator=b;if(this._validator){this._validator.attachTo(a,this)}this.propertyDidChange("validatorObject")}}.observes("validator","ownerForm")};SC.RenderDelegate={create:function(){var c=SC.beget(this);var b,a=arguments.length;for(b=0;b<a;b++){c.mixin(arguments[b])}return c},reopen:function(b){var c,a;for(c in b){a=b[c];if(!b.hasOwnProperty(c)){continue}if(typeof a==="function"&&a!==this[c]){a.base=this[c]||SC.K}if(a&&a.isEnhancement&&a!==this[c]){a=SC._enhance(this[c]||SC.K,a)}this[c]=a}},get:function(a){return this[a]},getPropertyFor:function(b,a){if(this[a+"For"]){return this[a+"For"](b,a)}return this[a]},className:undefined,render:function(b,a){},update:function(b,a){}};SC.RenderDelegate.extend=SC.RenderDelegate.create;SC.RenderDelegate.mixin=SC.RenderDelegate.reopen;sc_require("render_delegates/render_delegate");SC.BaseTheme.canvasImageRenderDelegate=SC.RenderDelegate.create({className:"canvasImage",render:function(d,b){var c=d.get("width")||0,a=d.get("height")||0;b.attr("width",c);b.attr("height",a)},update:function(a,e){var g=e[0],j=a.get("image"),d=a.get("frame"),m=d.width,k=d.height,l=a.get("innerFrame"),n=a.get("backgroundColor"),p=a.get("renderState"),b;var o=![l.x,l.y,l.width,l.height].isEqual(p._lastInnerFrameValues),h=![g.width,g.height].isEqual(p._lastElemSizeValues),f=a.didChangeFor("canvasImageRenderDelegate","backgroundColor"),c=a.didChangeFor("canvasImageRenderDelegate","image")||(j&&j.complete)!==p._lastImageComplete;if(h||o||f||c){if(g&&g.getContext){g.height=k;g.width=m;b=g.getContext("2d");b.clearRect(0,0,m,k);if(n){b.fillStyle=n;b.fillRect(0,0,m,k)}if(j&&j.complete){b.drawImage(j,Math.floor(l.x),Math.floor(l.y),Math.floor(l.width),Math.floor(l.height))}}p._lastInnerFrameValues=[l.x,l.y,l.width,l.height];p._lastElemSizeValues=[g.width,g.height];p._lastImageComplete=j&&j.complete}}});sc_require("render_delegates/render_delegate");SC.BaseTheme.containerRenderDelegate=SC.RenderDelegate.create({render:function(b,a){},update:function(){}});sc_require("render_delegates/render_delegate");SC.RenderDelegate.reopen({sizes:[SC.TINY_CONTROL_SIZE,SC.SMALL_CONTROL_SIZE,SC.REGULAR_CONTROL_SIZE,SC.LARGE_CONTROL_SIZE,SC.HUGE_CONTROL_SIZE,SC.JUMBO_CONTROL_SIZE],sizeFor:function(f){var e=f.get("controlSize"),c,b,a;if(e){if(!this[e]){this[e]={}}c=this[e];if(!c.name){c.name=e}return c}var d=f.get("frame");if(!d){c=this["sc-regular-size"];if(!c){c=this["sc-regular-size"]={}}if(!c.name){c.name="sc-regular-size"}return c}for(b=0;b<a;b++){key=sizes[b];c=this[key];if(!c){continue}if((c.width===undefined&&c.height===undefined&&c.minHeight===undefined&&c.minWidth===undefined&&c.maxHeight===undefined&&c.maxWidth===undefined)||(c.width!==undefined&&d.width!==c.width)||(c.minWidth!==undefined&&d.width<c.minWidth)||(c.maxWidth!==undefined&&d.width>c.maxWidth)||(c.height!==undefined&&d.height!==c.height)||(c.minHeight!==undefined&&d.height<c.minHeight)||(c.maxHeight!==undefined&&d.height<c.maxHeight)){continue}if(!c.name){c.name=key}return c}c=this["sc-regular-size"];if(!c){c=this["sc-regular-size"]={}}if(!c.name){c.name="sc-regular-size"}return c},addSizeClassName:function(c,b){var a=this.sizeFor(c);if(a){b.addClass(a.name)}},updateSizeClassName:function(c,a){var b=this.sizeFor(c);if(b){a.addClass(b.name)}},getPropertyFor:function(c,a){var b=this.sizeFor(c);if(b){if(b[a+"For"]){return b[a+"For"](c,a)}else{if(b[a]!==undefined){return b[a]}}}if(this[a+"For"]){return this[a+"For"]}return this[a]}});sc_require("render_delegates/render_delegate");SC.BaseTheme.imageRenderDelegate=SC.RenderDelegate.create({className:"image",render:function(f,c){var e=f.get("image"),b=f.get("imageValue"),d=f.get("type")||SC.IMAGE_TYPE_URL,a=f.get("toolTip");c=c.begin("img");c.attr("src",e.src);if(b&&d===SC.IMAGE_TYPE_CSS_CLASS){c.addClass(b);this._last_class=b}if(a){c.attr("title",a);c.attr("alt",a)}c.addStyle(this.imageStyles(f));c=c.end()},update:function(e,a){var d=e.get("image"),c=e.get("imageValue"),b=e.get("toolTip");a=a.find("img");a.attr("src",d.src);if(c!==this._last_class){a.setClass(this._last_class,NO)}if(c){a.addClass(c);this._last_class=c}if(b){a.attr("title",b);a.attr("alt",b)}a.css(this.imageStyles(e))},imageStyles:function(b){var a=b.get("innerFrame");return{position:"absolute",left:Math.round(a.x),top:Math.round(a.y),width:Math.round(a.width),height:Math.round(a.height)}}});sc_require("render_delegates/render_delegate");SC.BaseTheme.labelRenderDelegate=SC.RenderDelegate.create({className:"label",render:function(d,c){this.addSizeClassName(d,c);var a=d.get("toolTip");if(a){c.attr("title",a)}c.addStyle({fontWeight:d.get("fontWeight")||null,textAlign:d.get("textAlign")||null});c.setClass("ellipsis",d.get("needsEllipsis")||NO);c.setClass("icon",d.get("icon")||NO);var b=this.htmlForTitleAndIcon(d);c.push(b);d.get("renderState")._lastHTMLForTitleAndIcon=b},update:function(d,a){this.updateSizeClassName(d,a);a.css({fontWeight:d.get("fontWeight")||null,textAlign:d.get("textAlign")||null});var b=d.get("toolTip");if(b){a.attr("title",b)}else{a.removeAttr("title")}a.setClass("ellipsis",d.get("needsEllipsis")||NO);var c=this.htmlForTitleAndIcon(d);if(d.get("renderState")._lastHTMLForTitleAndIcon!==c){a.html(c);d.get("renderState")._lastHTMLForTitleAndIcon=c}},htmlForTitleAndIcon:function(e){var d=e.get("title"),c=e.get("hint"),b=e.get("escapeHTML"),a=e.get("icon")||"";if(d&&b){d=SC.RenderContext.escapeHTML(d)}if(b){c=SC.RenderContext.escapeHTML(c)}if(c&&!d){d="<span class='sc-hint'>"+c+"</span>"}if(a){if(a.indexOf("/")>=0){a='<img src="'+a+'" alt="" class="icon" />'}else{a='<img src="'+SC.BLANK_IMAGE_URL+'" alt="" class="icon '+a+'" />'}}return a+(SC.none(d)?"":d)}});sc_require("core");SC.Benchmark={verbose:NO,enabled:YES,events:{},stats:{},globalStartTime:null,addEvent:function(a,b){if(!b){b=new Date().getTime()}this.events[a]=b},start:function(b,a,e,d){if(!this.enabled){return}var f=(e||Date.now()),c;if(a){c=this._subStatFor(b,a)}else{c=this._statFor(b)}if(d&&c._starts.length>0){c._starts.push("ignore")}else{c._starts.push(f)}c._times.push({start:f,_subStats:{}});return b},end:function(c,b,f){var e;if(!this.enabled){return}if(b){e=this._subStatFor(c,b)}else{e=this._statFor(c)}var g=e._starts.pop();if(!g){SC.Logger.log('SC.Benchmark "%@" ended without a matching start.  No information was saved.'.fmt(c));return}if(g=="ignore"){return}var a=(f||Date.now());var d=a-g;e._times[e._times.length-1].end=a;e._times[e._times.length-1].dur=d;e.amt+=d;e.runs++;if(this.verbose){this.log(c)}},setGlobalStartTime:function(a){this.globalStartTime=a},bench:function(e,d,a){if(!d){d="bench%@".fmt(this._benchCount++)}if(!a){a=1}var b;while(--a>=0){var c=SC.Benchmark.start(d);b=e();SC.Benchmark.end(c)}return b},install:function(a,d,b){a["b__"+d]=a[d];var c=a["b__"+d];a[d]=function(){var f="%@(%@)".fmt(d,$A(arguments).join(", "));SC.Benchmark.start(f,b);var e=c.apply(this,arguments);SC.Benchmark.end(f);return e}},restore:function(a,b){a[b]=a["b__"+b]},report:function(c){if(c){return this._genReport(c)}var b=[];for(var a in this.stats){if(!this.stats.hasOwnProperty(a)){continue}b.push(this._genReport(a))}return b.join("\n")},timelineReport:function(a){a=(a)?"SproutCore Application":a;var b=[a,"User-Agent: %@".fmt(navigator.userAgent),"Report Generated: %@ (%@)".fmt(new Date().toString(),Date.now()),""];var d=this._compileChartData(true);for(var c=0;c<d.length;c++){if(d[c][4]){b.push(this._timelineGenSubReport(d[c]))}else{b.push(this._timelineGenReport(d[c]))}}return b.join("\n")},getTimelineChartContent:function(){var l=this._compileChartData(false);var g=l.length;if(g===0){return}var c=this.globalStartTime?this.globalStartTime:l[0][1];var d=l[g-1][2]-c;var n=25+g*30;var q=Math.ceil(d/200)+1;var s=q*50;var m=10,u=300;var o="<div class = 'sc-benchmark-timeline-chart' style = 'position:relative;'>";o+="<div class = 'sc-benchmark-top'></div>";for(var p=0;p<q;p++){o+="<div class = 'sc-benchmark-tick' style = '";o+="left: "+(m+p*50)+"px; ";o+="height: "+n+"px;";o+="'></div>";o+="<div class = 'sc-benchmark-tick-label' style = '";o+="left: "+(m+p*50)+"px; ";o+="'>"+(p*200)+"ms</div>"}for(p=0;p<g;p++){o+="<div class = 'sc-benchmark-row ";o+=(p%2===0)?"even":"odd";o+="' style = '";o+="top: "+(50+(p*30))+"px; ";o+="'></div>";var j=document.createElement("div");var f=l[p][1];var e=l[p][2];var a=l[p][3];o+="<div class = 'sc-benchmark-bar' style = '";o+="left:"+(m+((f-c)/4))+"px; width: "+((a/4))+"px;";o+="top: "+(28+(p*30))+"px;";o+="' title = 'start: "+(f-c)+" ms, end: "+(e-c)+" ms, duration: "+a+" ms'";o+=">";o+="&nbsp;"+l[p][0]+" <span class='sc-benchmark-emphasis'>";o+=a+"ms (start: "+(f-c)+"ms)";o+="</span>";o+="</div>"}var b=this.events,k=0;for(p in b){var h=b[p]-c;o+="<div class = 'sc-benchmark-event idx"+(k%10)+"' style = '";o+="left: "+(m+h/4)+"px; height: "+n+"px; top: 20px;";o+="' title = '"+p+": "+h+"'></div>";k++}o+="</div>";return{html:o,totalCapturedTime:d,pointsCaptured:g,width:s+m+u,height:n}},getTimelineChartView:function(){var a=SC.ScrollView.create({contentView:SC.StaticContentView.extend({}),reload:function(){var b=SC.Benchmark.getTimelineChartContent();this.contentView.set("content",b.html);this.contentView.adjust({width:b.width,height:b.height});this.chartContent=b;SC.RunLoop.invokeLater(SC.Benchmark,function(){this.contentView.notifyPropertyChange("frame")})}});a.reload();return a},timelineChart:function(a){SC.RunLoop.begin();var c=0;this.hideChart();var b=this.getTimelineChartView();var e=b.chartContent.pointsCaptured,d=b.chartContent.totalCapturedTime;this._benchmarkChart=SC.Pane.create({classNames:["sc-benchmark-pane"],layout:{left:20,right:20,bottom:20,top:20},childViews:["title","exit"],exit:SC.ButtonView.extend({layout:{right:20,top:20,width:100,height:30},title:"Hide Chart",target:this,action:"hideChart"}),title:SC.LabelView.extend({classNames:["sc-benchmark-title"],layout:{left:20,top:23,right:200,height:30},value:((a)?a:"SproutCore Application")+(" - Total Captured Time: "+d+" ms - Points Captured: "+e),fontWeight:"bold"})}).append();b.set("layout",{left:20,top:60,bottom:20,right:20});this._benchmarkChart.appendChild(b);SC.RunLoop.end()},hideChart:function(){if(this._benchmarkChart){this._benchmarkChart.remove();this._benchmarkChart=null}return YES},tryToPerform:function(b,a){if(this[b]){return this[b](a)}return NO},log:function(d){var c=this.report(d).split("\n"),b=c.length,a;for(a=0;a<b;a++){SC.Logger.log(c[a])}},startProfile:function(a){if(!this.enabled){return}SC.Logger.profile(a)},endProfile:function(a){if(!this.enabled){return}SC.Logger.profileEnd(a)},loadPreloadEvents:function(){var f=SC.benchmarkPreloadEvents,e=[],b,a,c;if(typeof webkitPerformnce!=="undefined"){SC.mixin(f,webkitPerformane.timing)}if(!this.globalStartTime){var d=["navigation","navigationStart","headStart"];a=d.length;for(b=0;b<a;b++){if(f[d[b]]){this.globalStartTime=f[d[b]];break}}}this.javascriptStartTime=f.headStart;SC.mixin(this.events,f);this._hasLoadedPreloadEvents=true},_loadBenchmarksFromEvents:function(){if(!this._hasLoadedPreloadEvents){this.loadPreloadEvents()}var b=this.events;for(var a in b){if(a.substr(-3)!=="End"){continue}var c=a.substr(0,a.length-3);if(!b[c+"Start"]){continue}SC.Benchmark.start(c,undefined,b[c+"Start"]);SC.Benchmark.end(c,undefined,b[c+"End"]);delete b[c+"Start"];delete b[c+"End"]}},_compileChartData:function(g){this._loadBenchmarksFromEvents();var l=[],a;for(var m in this.stats){var e=this.stats[m];for(var f=0;f<e._times.length;f++){var n=e._times[f];a=(e._times.length>1)?(f+1)+" - "+m:m;l.push([a,n.start,n.end,n.dur,false]);if(g){var b=n._subStats;for(var c in b){var h=b[c];for(var d=0;d<h._times.length;d++){var o=h._times[d];a=(h._times.length>1)?(d+1)+" - "+c:c;l.push([a,o.start,o.end,o.dur,true])}}}}}l.sort(function(k,j){if(k[1]<j[1]){return -1}else{if(k[1]==j[1]){if(k[3]&&!j[3]){return -1}if(!k[3]&&j[3]){return 1}return 0}}return 1});return l},_genReport:function(a){var b=this._statFor(a);var d=(b.runs>0)?(Math.floor(b.amt*1000/b.runs)/1000):0;var c=b._times[b._times.length-1];return"BENCH %@ msec: %@ (%@x); latest: %@".fmt(d,(b.name||a),b.runs,c.end-c.start)},_timelineGenReport:function(a){if(this.globalStartTime){return"BENCH start: %@ msec, duration: %@ msec,  %@".fmt((a[1]-this.globalStartTime),a[3],a[0])}else{return"BENCH duration: %@ msec, %@".fmt(a[3],a[0])}},_timelineGenSubReport:function(a){if(this.globalStartTime){return"   CHECKPOINT BENCH start: %@ msec, duration: %@ msec,  %@".fmt((a[1]-this.globalStartTime),a[3],a[0])}else{return"   CHECKPOINT BENCH duration: %@ msec, %@".fmt(a[3],a[0])}},_subStatFor:function(d,c){var e=this.stats[c]._times.length;if(e===0){return}var a=this.stats[c]._times[this.stats[c]._times.length-1]._subStats;var b=a[d];if(!b){a[d]={runs:0,amt:0,name:d,_starts:[],_times:[]};b=a[d]}return b},_statFor:function(b){var a=this.stats[b];if(!a){a=this.stats[b]={runs:0,amt:0,name:b,_starts:[],_times:[]};a=this.stats[b]}return a},reset:function(){this.stats={}},_bench:function(b,a){SC.Benchmark.bench(b,a,1)},_benchCount:1};SC.Benchmark=SC.Benchmark;SC.Cookie=SC.Object.extend({name:null,value:"",expires:null,path:null,domain:null,secure:NO,isCookie:YES,destroy:function(){this.set("expires",-1);this.write();arguments.callee.base.apply(this,arguments)},write:function(){var d=this.get("name"),f=this.get("value"),a=this.get("expires"),h=this.get("path"),e=this.get("domain"),g=this.get("secure"),b="",c;if(a){if(typeof a===SC.T_NUMBER){c=new Date();c.setTime(c.getTime()+(a*24*60*60*1000))}else{if(SC.DateTime&&a.get&&a.get("milliseconds")){c=new Date(a.get("milliseconds"))}else{if(a.toUTCString&&a.toUTCString.apply){c=a}}}if(c){b="; expires="+c.toUTCString()}}if(!SC.none(h)){b+="; path="+h}if(!SC.none(e)){b+="; domain="+e}if(g===YES){b+="; secure"}document.cookie=d+"="+encodeURIComponent(f)+b;return this}});SC.Cookie.mixin({find:function(a){if(document.cookie&&document.cookie!==""){var d=document.cookie.split(";");for(var c=0;c<d.length;c++){var b=SC.String.trim(String(d[c]));if(b.substring(0,a.length+1)===(a+"=")){return SC.Cookie.create({name:a,value:decodeURIComponent(b.substring(a.length+1))})}}}return null}});SC.CookieMonster={nomNomNom:function(b){var a=SC.kindOf(b,SC.Cookie);if(a){SC.Logger.log("YUM!");return b.destroy()}SC.Logger.error("Y U PASS ME NO COOKIE? %@",b);return NO}};SC.mixin(SC.$.fn,{setClass:function(d,c){if(SC.none(d)){return this}var e=SC.typeOf(d)!==SC.T_STRING,a=this._fixupClass,b;this.each(function(){if(this.nodeType!==1){return}var h=this.className.split(/\s+/),g=NO;if(e){for(var f in d){if(d.hasOwnProperty(f)){g=a(h,f,d[f])||g}}}else{g=a(h,d,c)}if(g){this.className=h.join(" ")}});return this},_fixupClass:function(d,a,c){var b=d.indexOf(a);if(c){if(b<0){d.push(a);return YES}}else{if(b>=0){d[b]=null;return YES}}return NO}});SC.ExceptionHandler={enabled:(SC.buildMode!=="debug"),handleException:function(a){if(this.isShowingErrorDialog){return NO}this._displayErrorDialog(a);return NO},_displayErrorDialog:function(b){var a=this._errorDialogHTMLForException(b),c=document.createElement("div");c.style.cssText="left: 0px; right: 0px; top: 0px; bottom: 0px; position: absolute; background-color: white; background-color: rgba(255,255,255,0.6); z-index:100;";c.innerHTML=a;document.body.appendChild(c);this.isShowingErrorDialog=YES},_errorDialogHTMLForException:function(b){var a;a=['<div id="sc-error-dialog" style="position: absolute; width: 500px; left: 50%; top: 50%; margin-left: -250px; background-color: white; border: 1px solid black; font-family: Monaco, monospace; font-size: 9px; letter-spacing: 1px; padding: 10px">',"An error has occurred which prevents the application from running:","<br><br>",b.message,'<div id="sc-error-dialog-reload-button" onclick="window.location.reload();" style="float: right; font-family: Monaco, monospace; font-size: 9px; letter-spacing: 1px; border: 1px solid black; padding: 3px; clear: both; margin-top: 20px; cursor: pointer;">',"Reload","</div>","</div>"];return a.join("")},isShowingErrorDialog:NO};SC.IMAGE_ABORTED_ERROR=SC.$error("SC.Image.AbortedError","Image",-100);SC.IMAGE_FAILED_ERROR=SC.$error("SC.Image.FailedError","Image",-101);SC.imageQueue=SC.Object.create({loadLimit:4,activeRequests:0,loadImage:function(a,e,f,d){var b=SC.typeOf(e);if(SC.none(f)&&SC.typeOf(e)===SC.T_FUNCTION){e=null;f=e}if(SC.typeOf(f)===SC.T_STRING){f=e[f]}if(SC.none(d)){d=SC.none(e)&&SC.none(f)}var c=this._imageEntryFor(a);if(c.status===this.IMAGE_LOADED){if(f){f.call(e||c.image,c.url,c.image)}}else{if(e||f){this._addCallback(c,e,f)}c.retainCount++;this._scheduleImageEntry(c,d)}},releaseImage:function(a,d,e){var c=this._imageEntryFor(a,NO);if(!c){return this}if(--c.retainCount<=0){this._deleteEntry(c)}else{if(d||e){var b=SC.typeOf(d);if(SC.none(e)&&SC.typeOf(d)===SC.T_FUNCTION){d=null;e=d}if(SC.typeOf(e)===SC.T_STRING){e=d[e]}this._removeCallback(c,d,e)}}},reloadImage:function(a){var b=this._imageEntryFor(a,NO);if(b&&b.status===this.IMAGE_LOADED){b.status=this.IMAGE_WAITING}},loadNextImage:function(){var c=null,a;if(this.get("activeRequests")>=this.get("loadLimit")){return}a=this._foregroundQueue;while(a.length>0&&!c){c=a.shift()}if(!c){a=this._backgroundQueue;while(a.length>0&&!c){c=a.shift()}}this.set("isLoading",!!c);if(c){var b=c.image;if(!b){return}$(b).bind("abort",this._imageDidAbort);$(b).bind("error",this._imageDidError);$(b).bind("load",this._imageDidLoad);b.src=c.url;this._loading.push(c);this.incrementProperty("activeRequests");this.loadNextImage()}},_imageEntryFor:function(c,a){if(a===undefined){a=YES}var d=this._images[c];if(!d&&a){var b=new Image();d=this._images[c]={url:c,status:this.IMAGE_WAITING,callbacks:[],retainCount:0,image:b};b.entry=d}else{if(d&&d.image===null){d.image=new Image();d.image.entry=d}}return d},_deleteEntry:function(a){this._unscheduleImageEntry(a);delete this._images[a.url]},_addCallback:function(c,d,e){var b=c.callbacks;var a=b.find(function(f){return f[0]===d&&f[1]===e},this);if(!a){b.push([d,e])}b=null;return this},_removeCallback:function(b,c,d){var a=b.callbacks;a.forEach(function(f,e){if(f[0]===c&&f[1]===d){a[e]=null}},this);a=null;return this},_scheduleImageEntry:function(d,c){var b=this._backgroundQueue;var e=this._foregroundQueue;if(d.status===this.IMAGE_LOADED){return this}if((d.status===this.IMAGE_QUEUED)&&!c&&d.isBackground){b[b.indexOf(d)]=null;d.status=this.IMAGE_WAITING}if(d.status!==this.IMAGE_QUEUED){var a=(c)?b:e;a.push(d);d.status=this.IMAGE_QUEUED;d.isBackground=c}if(!this.isLoading){this.invokeLater(this.loadNextImage,100)}this.set("isLoading",YES);return this},_unscheduleImageEntry:function(b){if(b.status!==this.IMAGE_QUEUED){return this}var a=b.isBackground?this._backgroundQueue:this._foregroundQueue;a[a.indexOf(b)]=null;if(this._loading.indexOf(b)>=0){if(a.image){a.image.abort()}this.imageStatusDidChange(b,this.ABORTED)}return this},_imageDidAbort:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.ABORTED)},this)},_imageDidError:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.ERROR)},this)},_imageDidLoad:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.LOADED)},this)},imageStatusDidChange:function(c,a){if(!c){return}var b=c.url;var d;switch(a){case this.LOADED:d=c.image;break;case this.ABORTED:d=SC.IMAGE_ABORTED_ERROR;break;case this.ERROR:d=SC.IMAGE_FAILED_ERROR;break;default:d=SC.IMAGE_FAILED_ERROR;break}c.callbacks.forEach(function(f){var g=f[0],h=f[1];h.call(g,b,d)},this);c.callbacks=[];c.status=(a===this.LOADED)?this.IMAGE_LOADED:this.IMAGE_WAITING;var e=c.image;if(e){e.onload=e.onerror=e.onabort=null;if(a!==this.LOADED){c.image=null}}this._loading[this._loading.indexOf(c)]=null;if(this._loading.length>this.loadLimit*2){this._loading=this._loading.compact()}this.decrementProperty("activeRequests");this.loadNextImage()},init:function(){arguments.callee.base.apply(this,arguments);this._images={};this._loading=[];this._foregroundQueue=[];this._backgroundQueue=[]},IMAGE_LOADED:"loaded",IMAGE_QUEUED:"queued",IMAGE_WAITING:"waiting",ABORTED:"aborted",ERROR:"error",LOADED:"loaded"});SC.Math=SC.Object.create({near:function(c,b,a){if(!a){a=0.00001}return Math.abs(c-b)<=a},round:function(d,a){if(!a){a=0}var b=Math.pow(10,a);if(a<0){var c=b.toString();b=c.substring(0,c.indexOf("1")+1)}d=d.valueOf();return Math.round(d*b)/b}});SC.Task=SC.Object.extend({run:function(a){}});sc_require("tasks/task");SC.LOG_MODULE_LOADING=YES;SC.Module=SC.Object.create({isModuleReady:function(a){var b=SC.MODULE_INFO[a];return b?!!b.isReady:NO},loadModule:function(b,g,a){var c=SC.MODULE_INFO[b],h,f,j=SC.A(arguments).slice(3),d=SC.LOG_MODULE_LOADING,k,e;if(a===undefined&&SC.typeOf(g)===SC.T_FUNCTION){a=g;g=null}if(d){SC.debug("SC.Module: Attempting to load '%@'",b)}if(!c){throw"SC.Module: could not find module '%@'".fmt(b)}c.isPrefetching=NO;if(c.isLoaded&&!c.isWaitingForRunLoop){if(d){SC.debug("SC.Module: Module '%@' already loaded.",b)}if(!this._dependenciesMetForModule(b)){this._addCallbackForModule(b,g,a,j);this._loadDependenciesForModule(b);return NO}if(c.source){if(d){SC.debug("SC.Module: Evaluating JavaScript for module '%@'.",b)}this._evaluateStringLoadedModule(c);this._addCallbackForModule(b,g,a,j);this.invokeLast(function(){c.isReady=YES;this._moduleDidBecomeReady(b)});return NO}if(a){if(SC.isReady){SC.Module._invokeCallback(b,g,a,j)}else{SC.ready(SC.Module,function(){SC.Module._invokeCallback(b,g,a,j)})}}return YES}else{if(c.isWaitingForRunLoop){this._addCallbackForModule(b,g,a,j)}else{if(d){SC.debug("SC.Module: Module '%@' is not loaded, loading now.",b)}this._addCallbackForModule(b,g,a,j);if(!c.isLoading){this._loadDependenciesForModule(b);this._loadCSSForModule(b);this._loadJavaScriptForModule(b);c.isLoading=YES}return NO}}},_addCallbackForModule:function(b,e,f,a){var c=SC.MODULE_INFO[b];var d=c.callbacks||[];if(f){d.push(function(){SC.Module._invokeCallback(b,e,f,a)})}c.callbacks=d},prefetchModule:function(a){var b=SC.MODULE_INFO[a];if(b.isLoading||b.isLoaded){return}if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Prefetching module '%@'.",a)}this._loadDependenciesForModule(a);this._loadCSSForModule(a);this._loadJavaScriptForModule(a);b.isLoading=YES;b.isPrefetching=YES},_executeLazilyInstantiatedModule:function(b,c,j){var h=SC.LAZY_INSTANTIATION[b];var g;var a;var k,d;if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Module '%@' is marked for lazy instantiation, instantiating it now",b)}d=h.length;for(k=0;k<d;k++){try{h[k]()}catch(f){SC.Logger.error("SC.Module: Failed to lazily instatiate entry for  '%@'".fmt(b))}}delete SC.LAZY_INSTANTIATION[b];g=this._targetForTargetName(c);a=this._methodForMethodNameInTarget(j,g);if(!a){throw"SC.Module: could not find callback for lazily instantiated module '%@'".fmt(b)}},_evaluateStringLoadedModule:function(b){var a=b.source;jQuery.globalEval(a);delete b.source;if(b.cssSource){var c=document.createElement("style");c.setAttribute("type","text/css");if(c.styleSheet){c.styleSheet.cssText=b.cssSource}else{var d=document.createTextNode(b.cssSource);c.appendChild(d)}document.getElementsByTagName("head")[0].appendChild(c)}b.isReady=YES},_loadCSSForModule:function(d){var f=document.getElementsByTagName("head")[0];var e=SC.MODULE_INFO[d];var h=e.styles||[];var b=h.length;var c;var g;var a;if(!f){f=document.documentElement}b=h.length;for(a=0;a<b;a++){c=h[a];if(c.length>0){if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Loading CSS file in '%@' -> '%@'",d,c)}g=document.createElement("link");g.setAttribute("href",c);g.setAttribute("rel","stylesheet");g.setAttribute("type","text/css");f.appendChild(g)}}g=null},_loadJavaScriptForModule:function(b){var c=SC.MODULE_INFO[b];var d;var a;var e=c.dependencies;var f=YES;if(e&&e.length>0){f=this._dependenciesMetForModule(b)}if(c.isPrefetched){a=c.stringURL}else{if(f){a=c.scriptURL}else{a=c.stringURL}}if(a.length>0){if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Loading JavaScript file in '%@' -> '%@'",b,a)}d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",a);if(SC.browser.isIE){d.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){SC.run(function(){SC.Module._moduleDidLoad(b)})}}}else{d.onload=function(){SC.run(function(){SC.Module._moduleDidLoad(b)})}}document.body.appendChild(d)}},_dependenciesMetForModule:function(c){var e=SC.MODULE_INFO[c].dependencies||[];var b,a=e.length;var f;var d;for(b=0;b<a;b++){f=e[b];d=SC.MODULE_INFO[f];if(!d){throw"SC.loadModule: Unable to find dependency %@ for module %@.".fmt(f,c)}if(!d.isReady){return NO}}return YES},_loadDependenciesForModule:function(a){var b=SC.MODULE_INFO[a];var e=SC.LOG_MODULE_LOADING;var j=b.dependencies||[];var f=YES;var g=j.length;var k;var d;var c;var h;for(k=0;k<g;k++){d=j[k];c=SC.MODULE_INFO[d];if(!c){throw"SC.Module: could not find required module '%@' for module '%@'".fmt(d,a)}else{if(c.isLoading){f=NO;h=c.dependents;if(!h){c.dependents=h=[]}h.push(a)}else{if(c.isReady){continue}else{f=NO;h=c.dependents;if(!h){c.dependents=h=[]}h.push(a);if(e){SC.debug("SC.Module: '%@' depends on '%@', loading dependency",a,d)}SC.Module.loadModule(d)}}}}},_invokeCallback:function(c,d,a,b){var g;var f;f=this._targetForTargetName(d);g=this._methodForMethodNameInTarget(a,f);if(!g){if(SC.LAZY_INSTANTIATION[c]){this._executeLazilyInstantiatedModule(c,d,a);f=this._targetForTargetName(d);g=this._methodForMethodNameInTarget(a,f)}else{throw"SC.Module: could not find callback for '%@'".fmt(c)}}if(!b){b=[]}b.unshift(c);var e=!!SC.RunLoop.currentRunLoop;if(e){SC.run(function(){g.apply(f,b)})}else{g.apply(f,b)}},_invokeCallbacksForModule:function(c){var e=SC.MODULE_INFO[c],d;if(!e){return}if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Module '%@' has completed loading, invoking callbacks.",c)}d=e.callbacks||[];for(var b=0,a=d.length;b<a;++b){d[b]()}},_evaluateAndInvokeCallbacks:function(a){var d=SC.MODULE_INFO;var b=d[a];var c=SC.LOG_MODULE_LOADING;if(c){SC.debug("SC.Module: Evaluating and invoking callbacks for '%@'.",a)}if(b.source){this._evaluateStringLoadedModule(b)}b.isWaitingForRunLoop=YES;this.invokeLast(function(){b.isReady=YES;this._moduleDidBecomeReady(a)})},_moduleDidBecomeReady:function(a){var c=SC.MODULE_INFO;var b=c[a];var d=SC.LOG_MODULE_LOADING;b.isWaitingForRunLoop=NO;if(SC.isReady){SC.Module._invokeCallbacksForModule(a);delete b.callbacks}else{SC.ready(SC,function(){SC.Module._invokeCallbacksForModule(a);delete b.callbacks})}var g=b.dependents||[];var e,j;for(var h=0,f=g.length;h<f;h++){e=g[h];j=c[e];if(j.isLoaded&&this._dependenciesMetForModule(e)){if(d){SC.debug("SC.Module: Now that %@ has loaded, all dependencies for a dependent %@ are met.",a,e)}this._evaluateAndInvokeCallbacks(e)}}},_moduleDidLoad:function(b){var c=SC.MODULE_INFO[b];var e=SC.LOG_MODULE_LOADING;var d;var f,a;if(e){SC.debug("SC.Module: Module '%@' finished loading.",b)}if(!c){if(e){SC.debug("SC._moduleDidLoad() called for unknown module '@'.",b)}c=SC.MODULE_INFO[b]={isLoaded:YES,isReady:YES};return}if(c.isLoaded){if(e){SC.debug("SC._moduleDidLoad() called more than once for module '%@'. Skipping.",b)}return}delete c.isLoading;c.isLoaded=YES;if(!c.isPrefetching){d=this._dependenciesMetForModule(b);if(d){this._evaluateAndInvokeCallbacks(b)}else{if(e){SC.debug("SC.Module: Dependencies for '%@' not met yet, waiting to evaluate.",b)}}}else{delete c.isPrefetching;if(e){SC.debug("SC.Module: Module '%@' was prefetched, not evaluating until needed.",b)}}},_targetForTargetName:function(a){if(SC.typeOf(a)===SC.T_STRING){return SC.objectForPropertyPath(a)}return a},_methodForMethodNameInTarget:function(a,b){if(SC.typeOf(a)===SC.T_STRING){return SC.objectForPropertyPath(a,b)}return a},methodsForSuspend:"loadModule _moduleDidLoad prefetchModule _moduleDidBecomeReady".w(),suspend:function(){this._suspendCount=(this._suspendCount||0)+1;if(this._suspendCount!==1){return}var a=this.get("methodsForSuspend"),e,d,c,b;for(b=0;c=a[b];b++){if(!this[e="__replacement_"+c+"__"]){(this[e]=function(){(this._bufferedCalls||(this._bufferedCalls=[])).push({method:arguments.callee.methodName,arguments:arguments})}).methodName=c}if(!this[d="__saved_"+c+"__"]){this[d]=this[c]}this[c]=this[e]}},resume:function(){this._suspendCount=(this._suspendCount||0)-1;if(this._suspendCount<0){SC.warn("SC.Module.resume() was called without SC.Module having been in a suspended state. Call aborted.");this._suspendCount=0;return}if(this._suspendCount>0){return}var a=this.get("methodsForSuspend"),d=this._bufferedCalls,c,b,f,e;for(b=0;(c=a[b]);b++){this[c]=this["__saved_"+c+"__"]}for(b=0;e=d&&d[b];b++){this[e.method].apply(this,e.arguments)}if(d){d.length=0}}});SC.ready(function(){var d=SC.MODULE_INFO;var b;var c;var a;for(b in d){c=d[b];if(c.isPrefetched){a=SC.Module.PrefetchModuleTask.create({prefetchedModuleName:b});SC.backgroundTaskQueue.push(a)}}});SC.Module.PrefetchModuleTask=SC.Task.extend({prefetchedModuleName:null,run:function(){SC.Module.prefetchModule(this.prefetchedModuleName)}});sc_require("tasks/task");SC.TaskQueue=SC.Task.extend({init:function(){var a=this;this._doIdleEntry=function(){a._idleEntry()};this._suspendCount=0;this._tasks=[]},runWhenIdle:NO,runLimit:50,interval:50,isRunning:NO,minimumIdleDuration:500,_tasks:null,hasTasks:function(){return this._tasks.length>0}.property("taskCount").cacheable(),taskCount:function(){return this._tasks.length}.property().cacheable(),push:function(a){this._tasks.push(a);this.notifyPropertyChange("taskCount")},next:function(){if(this._tasks.length<1){return null}var a=this._tasks.shift();this.notifyPropertyChange("taskCount");return a},suspend:function(){this._suspendCount++},resume:function(){this._suspendCount--;if(this._suspendCount<=0){this._setupIdle()}},_taskCountDidChange:function(){this._setupIdle()}.observes("taskCount"),_runWhenIdleDidChange:function(){this._setupIdle()}.observes("runWhenIdle"),_setupIdle:function(){if(!this._suspendCount&&this.get("runWhenIdle")&&!this._idleIsScheduled&&this.get("taskCount")>0){setTimeout(this._doIdleEntry,this.get("interval"));this._idleIsScheduled=YES}},_idleEntry:function(){this._idleIsScheduled=NO;var a=SC.RunLoop.lastRunLoopEnd;if(!this.get("runWhenIdle")&&!this._suspendCount){return}if(Date.now()-a>this.get("minimumIdleDuration")){SC.run(this.run,this);SC.RunLoop.lastRunLoopEnd=a}this._setupIdle()},run:function(a){this.set("isRunning",YES);if(!a){a=this.get("runLimit")}var b,c=Date.now();while(b=this.next()){b.run(this);if(Date.now()-c>a){break}}this.set("isRunning",NO)}});SC.backgroundTaskQueue=SC.TaskQueue.create({runWhenIdle:YES});SC.TextSelection=SC.Object.extend(SC.Copyable,SC.Freezable,{start:-1,end:-1,length:function(){var b=this.get("start");var a=this.get("end");if((b)===-1||(a===-1)){return -1}else{return a-b}}.property("start","end").cacheable(),init:function(){arguments.callee.base.apply(this,arguments);this.freeze()},copy:function(){return SC.TextSelection.create({start:this.get("start"),end:this.get("end")})},toString:function(){var a=this.get("length");if(a&&a>0){if(a===1){return"[%@ character selected: {%@, %@}]".fmt(a,this.get("start"),this.get("end"))}else{return"[%@ characters selected: {%@, %@}]".fmt(a,this.get("start"),this.get("end"))}}else{return"[no text selected; caret at %@]".fmt(this.get("start"))}}});SC.UserDefaults=SC.Object.extend({ready:NO,userDomain:null,appDomain:null,_defaults:null,_safari3DB:null,defaults:function(a){this._defaults=a;this.allPropertiesDidChange()},readDefault:function(j){var a,d,b,k,h,l,g;j=this._normalizeKeyName(j);b=this._userKeyName(j);if(this._written){d=this._written[b]}a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){k=document.body;try{k.load("SC.UserDefaults")}catch(c){SC.Logger.error("Couldn't load userDefaults in IE7: "+c.description)}}else{if(this.HTML5DB_noLocalStorage){g=this._safari3DB}else{k=window.localStorage;if(!k&&window.globalStorage){k=window.globalStorage[window.location.hostname]}}}if(k||g){h=["SC.UserDefaults",b].join("-at-");if(a){d=k.getAttribute(h.replace(/\W/gi,""))}else{if(g){d=this.dataHash[h]}else{d=k[h]}}if(!SC.none(d)){try{d=SC.json.decode(d)}catch(f){}}}l=this.delegate;if(l&&l.userDefaultsNeedsDefault){d=l.userDefaultsNeedsDefault(this,j,b)}if(SC.none(d)&&this._defaults){d=this._defaults[b]||this._defaults[j]}return d},writeDefault:function(l,j){var b,f,c,m,k,n,h;l=this._normalizeKeyName(l);f=this._userKeyName(l);c=this._written;if(!c){c=this._written={}}c[f]=j;b=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(b){m=document.body}else{if(this.HTML5DB_noLocalStorage){h=this._safari3DB}else{m=window.localStorage;if(!m&&window.globalStorage){m=window.globalStorage[window.location.hostname]}}}k=["SC.UserDefaults",f].join("-at-");if(m||h){var a=SC.json.encode(j);if(b){m.setAttribute(k.replace(/\W/gi,""),a);m.save("SC.UserDefaults")}else{if(h){var d=this;h.transaction(function(e){e.executeSql("delete from SCLocalStorage where key = ?",[k],function(){e.executeSql("insert into SCLocalStorage(key, value) VALUES ('"+k+"', '"+a+"');",[],d._nullDataHandler,d.killTransaction)})});this.dataHash[k]=a}else{try{m[k]=a}catch(g){SC.Logger.error("Failed using localStorage. "+g)}}}}n=this.delegate;if(n&&n.userDefaultsDidChange){n.userDefaultsDidChange(this,l,j,f)}return this},resetDefault:function(k){var b,a,f,c,l,j,h;b=this._normalizeKeyName(k);f=this._userKeyName(b);this.propertyWillChange(k);this.propertyWillChange(b);c=this._written;if(c){delete c[f]}a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){l=document.body}else{if(this.HTML5DB_noLocalStorage){h=this._safari3DB}else{l=window.localStorage;if(!l&&window.globalStorage){l=window.globalStorage[window.location.hostname]}}}j=["SC.UserDefaults",f].join("-at-");if(l){if(a){l.setAttribute(j.replace(/\W/gi,""),null);l.save("SC.UserDefaults")}else{if(h){var d=this;h.transaction(function(e){e.executeSql("delete from SCLocalStorage where key = ?",[j],null)});delete this.dataHash[j]}else{try{delete l[j]}catch(g){SC.Logger.warn("Deleting local storage encountered a problem. "+g)}}}}this.propertyDidChange(k);this.propertyDidChange(b);return this},unknownProperty:function(a,b){if(b===undefined){return this.readDefault(a)}else{this.writeDefault(a,b);return b}},_normalizeKeyName:function(a){if(a.indexOf(":")<0){var b=this.get("appDomain")||"app";a=[b,a].join(":")}return a},_userKeyName:function(b){var a=this.get("userDomain")||"(anonymous)";return[a,b].join("-at-")},_domainDidChange:function(){var a=NO;if(this.get("userDomain")!==this._scud_userDomain){this._scud_userDomain=this.get("userDomain");a=YES}if(this.get("appDomain")!==this._scud_appDomain){this._scud_appDomain=this.get("appDomain");a=YES}if(a){this.allPropertiesDidChange()}}.observes("userDomain","appDomain"),init:function(){arguments.callee.base.apply(this,arguments);var a;jQuery.readyWait++;if(SC.userDefaults&&SC.userDefaults.get("dataHash")){var g=SC.userDefaults.get("dataHash");if(g){this.dataHash=SC.userDefaults.get("dataHash")}}this._scud_userDomain=this.get("userDomain");this._scud_appDomain=this.get("appDomain");a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){document.body.addBehavior("#default#userData")}this.HTML5DB_noLocalStorage=SC.browser.isWebkit&&SC.browser.compare(SC.browser.engineVersion,"523")>0&&SC.browser.compare(SC.browser.engineVersion,"528")<0;if(this.HTML5DB_noLocalStorage){var b;try{if(!window.openDatabase){SC.Logger.error("Trying to load a database with safari version 3.1 to get SC.UserDefaults to work. You are either in a previous version or there is a problem with your browser.");return}else{var h="scdb",f="1.0",j="SproutCore database",k=65536;b=openDatabase(h,f,j,k)}}catch(d){SC.Logger.error("Trying to load a database with safari version 3.1 to get SC.UserDefaults to work. You are either in a previous version or there is a problem with your browser.");return}if(b){var c=this;b.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS SCLocalStorage(key TEXT NOT NULL PRIMARY KEY, value TEXT NOT NULL);",[],c._nullDataHandler,c.killTransaction)});b.transaction(function(e){e.parent=c;e.executeSql("SELECT * from SCLocalStorage;",[],function(q,n){var o={},p;for(var m=0,l=n.rows.length;m<l;m++){p=n.rows.item(m);o[p.key]=p.value}q.parent.dataHash=o;SC.run(function(){jQuery.ready(true)})},c.killTransaction)});this._safari3DB=b}}else{jQuery.ready(true)}},_killTransaction:function(b,a){return true},_nullDataHandler:function(b,a){}});SC.userDefaults=SC.UserDefaults.create();SC.mixin({convertHsvToHex:function(d,c,a){var b=SC.Color.hsvToRgb(d,c,a);return SC.Color.create({r:b[0],g:b[1],b:b[2]}).toHex()},convertHexToHsv:function(b){var a=SC.Color.from(b);return a&&SC.Color.rgbToHsv(a.r,a.g,a.b)},PARSE_COLOR_RGBRE:/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,PARSE_COLOR_HEXRE:/^\#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,expandColor:function(b){var c,e,d,a;c=this.parseColor(b);if(c){e=parseInt(c.slice(1,3),16);d=parseInt(c.slice(3,5),16);a=parseInt(c.slice(5,7),16);return[e,d,a]}},parseColor:function(d){var e=0,a="#",c,b;if(c=this.PARSE_COLOR_RGBRE.exec(d)){for(e=1;e<=3;e++){b=Math.max(0,Math.min(255,parseInt(c[e],0)));a+=this.toColorPart(b)}return a}if(c=this.PARSE_COLOR_HEXRE.exec(d)){if(c[1].length==3){for(e=0;e<3;e++){a+=c[1].charAt(e)+c[1].charAt(e)}return a}return"#"+c[1]}return false},toColorPart:function(a){if(a>255){a=255}var b=a.toString(16);if(a<16){return"0"+b}return b}});SC.mixin({_downloadFrames:0,download:function(d){var a=document.createElement("iframe"),c="DownloadFrame_"+this._downloadFrames;SC.$(a).attr("id",c);a.style.border="10px";a.style.width="0px";a.style.height="0px";a.style.position="absolute";a.style.top="-10000px";a.style.left="-10000px";if(!SC.browser.isSafari){SC.$(a).attr("src",d)}document.getElementsByTagName("body")[0].appendChild(a);if(SC.browser.isSafari){SC.$(a).attr("src",d)}this._downloadFrames=this._downloadFrames+1;if(!SC.browser.isSafari){var b=function(){document.body.removeChild(document.getElementById(c));c=null};b.invokeLater(null,2000)}a=null},getStyle:function(a,b){var c="";if(document.defaultView&&document.defaultView.getComputedStyle){c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b)}else{if(a.currentStyle){b=b.replace(/\-(\w)/g,function(d,e){return e.toUpperCase()});c=a.currentStyle[b]}}return c},uniJapaneseConvert:function(e){var a,c="",b,d;for(b=0,d=e.length;b<d;b++){a=e.charCodeAt(b);a=((a>=65281&&a<=65392)?a-65248:a);a=(a===12540?45:a);c=c+String.fromCharCode(a)}return c},pointInElement:function(b,g,c,f){var h,d,a,e;g=jQuery(g);c=c||"border";h=SC.offset(g,f);if(c==="padding"){d=g.innerWidth();a=g.innerHeight();h.x+=window.parseInt(g.css("border-left-width").replace("px",""));h.y+=window.parseInt(g.css("border-top-width").replace("px",""))}else{d=g.outerWidth(c==="margin");a=g.outerHeight(c==="margin");if(c==="margin"){h.x-=window.parseInt(g.css("margin-left").replace("px",""));h.y-=window.parseInt(g.css("margin-top").replace("px",""))}}e={x:h.x,y:h.y,width:d,height:a};return SC.pointInRect(b,e)},switchScale:function(){$("head meta[name=viewport]").remove();if(window.innerWidth===window.screen.width){$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=0" />')}else{$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=0" />')}}});SC.mixin({ZERO_RANGE:{start:0,length:0},RANGE_NOT_FOUND:{start:0,length:-1},valueInRange:function(b,a){return(b>=0)&&(b>=a.start)&&(b<(a.start+a.length))},minRange:function(a){return a.start},maxRange:function(a){return(a.length<0)?-1:(a.start+a.length)},unionRanges:function(c,b){if((c==null)||(c.length<0)){return b}if((b==null)||(b.length<0)){return c}var d=Math.min(c.start,b.start),a=Math.max(SC.maxRange(c),SC.maxRange(b));return{start:d,length:a-d}},intersectRanges:function(c,b){if((c==null)||(b==null)){return SC.RANGE_NOT_FOUND}if((c.length<0)||(b.length<0)){return SC.RANGE_NOT_FOUND}var d=Math.max(SC.minRange(c),SC.minRange(b)),a=Math.min(SC.maxRange(c),SC.maxRange(b));if(a<d){return SC.RANGE_NOT_FOUND}return{start:d,length:a-d}},subtractRanges:function(c,b){if((c==null)||(b==null)){return SC.RANGE_NOT_FOUND}if((c.length<0)||(b.length<0)){return SC.RANGE_NOT_FOUND}var a=Math.max(SC.minRange(c),SC.minRange(b)),d=Math.min(SC.maxRange(c),SC.maxRange(b));if(a<d){return SC.RANGE_NOT_FOUND}return{start:d,length:a-d}},cloneRange:function(a){return{start:a.start,length:a.length}},rangesEqual:function(b,a){if(b===a){return true}if(b==null){return a.length<0}if(a==null){return b.length<0}return(b.start==a.start)&&(b.length==a.length)}});SC.mixin({bestStringMetricsForMaxWidth:function(a,y,n,B,x){if(!y){SC.warn("When calling bestMetricsForWidth, the second argument, maxWidth, is required. There's no reason to call this without a maxWidth.");return undefined}y=Math.ceil(parseFloat(y));var C=arguments.callee,h=SC.typeOf(n||(n=""))!==SC.T_STRING,m=h?n.style.maxWidth:undefined,o=(!h||n.cacheableForMetrics)?SC.cacheSlotFor(n,B,x,a):undefined,s=h?(C._applyMaxToEl||(C._applyMaxToEl=function(G,l){G.style.maxWidth=l+"px";return G})):(C._applyMaxToStr||(C._applyMaxToStr=function(G,l){return G.replace(/max-width:[^;]*;/g,"")+" max-width:"+l+"px"})),v=h?(C._removeMaxFromEl||(C._removeMaxFromEl=function(l){l.style.maxWidth="none";return l})):(C._removeMaxFromStr||(C._removeMaxFromStr=function(l){return l.replace(/max-width:[^;]*;/g,"")+" max-width:none"})),p=false;if(o){o.list||(o.list=[{width:Infinity,height:0}]);for(var w=1,u=o.list.length,E,b,F;w<u&&!F;w++){E=o.list[w];b=o.list[w-1];if(!E||!E.width){continue}if(y>=E.width){if((b&&b.width)||(y<=E.maxWidth)){return E}F=E}}}var q=s(n,y),t=SC.metricsForString(a,q,B,x),z=t.height,d=o?o.parent.height||(o.parent.height=SC.metricsForString("W",q,B).height):SC.metricsForString("W",q,B).height,c=Math.round(z/d);if(p){c--;z=c*d}if(z>d){var g=p?Math.ceil(t.width*2.5):t.width,k=p?t.width:Math.floor(t.width/2.5),D,f=new Date()*1,j=0;while(g-k>1||(t.height>z&&!p)||(t.height<z&&p)){j++;D=(g+k)/2;q=s(q,D);t=SC.metricsForString(a,q,B,x);if(t.height>z){k=D}else{g=D}}t.width=Math.ceil(D);t.height=z;t.maxWidth=y;t.lineHeight=d;t.lines=c;t.searchPerformed=true;t.searchTime=new Date()*1-f;t.searchCount=j}else{if(p){t=SC.metricsForString(a,q=v(q),B,x)}t.maxWidth=y;t.lineHeight=d;t.lines=c;t.searchPerformed=false}t.browserCorrection=0;if(SC.browser.isIE){t.browserCorrection=1}if(SC.browser.isMozilla){t.browserCorrection=1}t.width=Math.min(y,t.width+t.browserCorrection);if(o){var e=o.list[c];if(e&&e.maxWidth<y){e.maxWidth=y}if(!e){e=o.list[c]=t}}if(h){q.style.maxWidth=m}F=p?F:t;return F},cacheSlotFor:function(){var e=arguments.callee.caller,f=e.cache||(e.cache={});if(!arguments[0]){return f}var b=(arguments[0] instanceof Array||arguments[0].callee)?arguments[0]:arguments,d=b.length,a,c;for(c=0;c<d;c++){if(typeof(a=b[c])==="object"){a=SC.guidFor(a)}f=f[a]||(f[a]={parent:f})}return f},cachedVersionOf:function(){var a=function(c){var b=function(){var d=SC.cacheSlotFor(arguments);return d.result||(d.result=arguments.callee.func.apply(this,arguments))};b.func=c;return b};return a(a)}()});sc_require("tasks/task");SC.didPreloadBundle=function(){};SC.PreloadBundleTask=SC.Task.extend({bundle:null,target:"SC",action:"preloaded",run:function(a){var b;if(b=this.get("bundle")){var c=Date.now();SC.Module.loadModule(this.get("bundle"),this.get("target"),this.get("action"))}}});sc_require("system/string");SC.VALIDATE_OK=YES;SC.VALIDATE_NO_CHANGE=NO;SC.Validator=SC.Object.extend({fieldValueForObject:function(b,c,a){return b},objectForFieldValue:function(c,b,a){return c},validate:function(a,b){return true},validateError:function(a,b){return SC.$error(SC.String.loc("Invalid.General(%@)",b.get("fieldValue")),b.get("fieldKey"))},validateChange:function(b,c,a){return this.validate(b,c)?SC.VALIDATE_OK:this.validateError(b,c)},validateSubmit:function(a,b){return this.validate(a,b)?SC.VALIDATE_OK:this.validateError(a,b)},validatePartial:function(a,b){if(!b.get("isValid")){return this.validate(a,b)?SC.VALIDATE_OK:this.validateError(a,b)}else{return SC.VALIDATE_NO_CHANGE}},validateKeyDown:function(b,c,a){return true},attachTo:function(a,b){},detachFrom:function(a,b){}});SC.Validator.mixin({OK:true,NO_CHANGE:false,findFor:function(e,g,f){var c;if(!f){return}if(f instanceof SC.Validator){c=f}else{if(f.isClass){c=f.create()}else{if(SC.typeOf(f)===SC.T_STRING){var b=null;var a=f.match(/^(.+)\[(.*)\]/);if(a){f=a[1];b=a[2]}f=SC.String.classify(f);var d=SC.Validator[f];if(SC.none(d)){throw"validator %@ not found for %@".fmt(f,g)}else{if(b){if(!e){throw"named validator (%@) could not be found for field %@ because the field does not belong to a form".fmt(b,g)}if(!e._validatorHash){e._validatorHash={}}c=(b)?e._validatorHash[b]:null;if(!c){c=d.create()}if(b){e._validatorHash[b]=c}}else{c=d.create()}}}}}return c},fieldValueForObject:function(a,b,c){if(this.prototype&&this.prototype.fieldValueForObject){return this.prototype.fieldValueForObject(a,b,c)}else{return null}},objectForFieldValue:function(b,a,c){if(this.prototype&&this.prototype.objectForFieldValue){return this.prototype.objectForFieldValue(b,a,c)}else{return null}}});sc_require("validators/validator");SC.Validator.CreditCard=SC.Validator.extend({fieldValueForObject:function(a,b,c){if(typeof(a)=="string"&&a.length==16){a=[a.slice(0,4),a.slice(4,8),a.slice(8,12),a.slice(12,16)].join(" ")}return a},objectForFieldValue:function(b,a,c){return b.replace(/[\s-\.\:]/g,"")},validate:function(a,b){return this.checkNumber(b.get("fieldValue"))},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.CreditCard(%@)",a),a)},validateKeyDown:function(b,c,a){return !!a.match(/[0-9\- ]/)},checkNumber:function(h){if(!h||h.length===0){return YES}h=h.replace(/[^0-9]/g,"");var a="0123456789";var g=h.length;var f=parseInt(h,0);var l=h.toString();l=l.replace(/^\s+|\s+$/g,"");var k=0;var n=true;var b=false;var m;var d;for(var c=0;c<g;c++){m=""+l.substring(c,c+1);if(a.indexOf(m)=="-1"){n=false}}if(!n){b=false}if((g===0)&&(b)){b=false}else{if(g>=15){for(var e=g;e>0;e--){d=parseInt(f,0)%10;d=parseInt(d,0);k+=d;e--;f=f/10;d=parseInt(f,0)%10;d=d*2;switch(d){case 10:d=1;break;case 12:d=3;break;case 14:d=5;break;case 16:d=7;break;case 18:d=9;break;default:d=d}f=f/10;k+=d}if((k%10)===0){b=true}else{b=false}}}return b}});sc_require("validators/validator");SC.Validator.Date=SC.Validator.extend({format:"%b %d, %Y %i:%M:%S %p",fieldValueForObject:function(a,b,e){var d=this.get("format"),c;if(SC.typeOf(a)===SC.T_NUMBER){c=SC.DateTime.create(a)}else{if(a instanceof Date){c=a.getTime()}}if(c){a=c.toFormattedString(d)}return a},objectForFieldValue:function(c,a,e){var d=this.get("format"),b;if(c){b=SC.DateTime.parse(c,d);c=b?b._ms:null}return c}});sc_require("validators/validator");SC.Validator.DateTime=SC.Validator.extend({format:"%d/%m/%Y",fieldValueForObject:function(a,b,c){if(SC.kindOf(a,SC.DateTime)){a=a.toFormattedString(this.get("format"))}else{a=null}return a},objectForFieldValue:function(b,a,c){if(b){b=SC.DateTime.parse(b,this.get("format"))}return b}});sc_require("validators/validator");SC.Validator.Email=SC.Validator.extend({validate:function(a,b){return(b.get("fieldValue")||"").match(/.+@.+\...+/)},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Email(%@)",a),a)}});SC.Validator.EmailOrEmpty=SC.Validator.Email.extend({validate:function(a,c){var b=c.get("fieldValue");return(b&&b.length>0)?b.match(/.+@.+\...+/):true}});sc_require("validators/validator");SC.Validator.NotEmpty=SC.Validator.extend({validate:function(a,c){var b=c.get("fieldValue");if(SC.none(b)){return NO}if(!SC.none(b.length)){return b.length>0}return YES},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.NotEmpty(%@)",SC.String.capitalize(a)),c.get("errorLabel"))}});sc_require("validators/validator");sc_require("system/utils/misc");SC.Validator.Number=SC.Validator.extend({places:0,fieldValueForObject:function(a,b,c){switch(SC.typeOf(a)){case SC.T_NUMBER:a=a.toFixed(this.get("places"));break;case SC.T_NULL:case SC.T_UNDEFINED:a="";break}return a},objectForFieldValue:function(c,b,d){var a;c=c.replace(/,/g,"");switch(SC.typeOf(c)){case SC.T_STRING:if(c.length===0){c=null}else{if(this.get("places")>0){c=parseFloat(c)}else{if(c.length===1&&c.match(/-/)){c=null}else{a=parseInt(c,0);if(isNaN(a)){c=SC.uniJapaneseConvert(c);c=parseInt(c,0);if(isNaN(c)){c=""}}else{c=a}}}}break;case SC.T_NULL:case SC.T_UNDEFINED:c=null;break}return c},validate:function(a,c){var b=c.get("fieldValue");return(b==="")||!(isNaN(b)||isNaN(parseFloat(b)))},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,c,a){if(!a){a=""}var d=c.$input().val();if(!d){d=""}d+=a;if(this.get("places")===0){if(a.length===0){return true}else{return d.match(/^[\-{0,1}]?[0-9,\0]*/)[0]===d}}else{if(a.length===0){return true}else{return d.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)?d.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)[0]===d:false}}}});sc_require("validators/validator");SC.Validator.Password=SC.Validator.extend({attachTo:function(a,b){arguments.callee.base.apply(this,arguments);if(!this.fields){this.fields=[]}this.fields.push(b)},validate:function(e){if(!this.fields||this.fields.length===0){return true}var d=false;var b=false;var a=true;var c=this.fields[0].get("fieldValue");this.fields.forEach(function(g){var f=g.get("fieldValue");if(f!=c){a=false}if(!f||f.length===0){d=true}if(f&&f.length>0){b=true}});if(e){return(b===false)?false:a}else{return(d===true)?true:a}},updateFields:function(c,b){if(!this.fields||this.fields.length===0){return true}var a=SC.String.loc("Invalid.Password");var d=this._field;this.fields.forEach(function(e){var g=(b)?null:((e==d)?a:"");c.setErrorFor(e,g)});return(b)?SC.VALIDATE_OK:a},validateChange:function(b,c,a){return this.updateFields(b,this.validate(false))},validateSubmit:function(a,b){return this.updateFields(a,this.validate(true))},validatePartial:function(b,c){var a=!this._field.get("isValid");if(a){return this.updateFields(b,this.validate(false))}else{return SC.VALIDATE_NO_CHANGE}}});sc_require("validators/validator");SC.Validator.PositiveInteger=SC.Validator.extend({defaultValue:null,fieldValueForObject:function(a,b,c){switch(SC.typeOf(a)){case SC.T_NUMBER:a=a.toFixed(0);break;case SC.T_NULL:case SC.T_UNDEFINED:a=this.get("defaultValue");break}return a},objectForFieldValue:function(b,a,c){b=b.replace(/,/g,"");switch(SC.typeOf(b)){case SC.T_STRING:if(b.length===0){b=this.get("defaultValue")}else{b=parseInt(b,0)}break;case SC.T_NULL:case SC.T_UNDEFINED:b=this.get("defaultValue");break}if(isNaN(b)){return this.get("defaultValue")}return b},validate:function(a,c){var b=c.get("fieldValue");return(b==="")||!isNaN(b)},validateError:function(b,c){var a=c.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,c,a){var d=c.$input().val();if(!d){d=""}d+=a;if(a.length===0){return true}else{return d.match(/^[0-9\0]*/)[0]===d}}});SC.ContainerView=SC.View.extend({classNames:["sc-container-view"],renderDelegateName:"containerRenderDelegate",nowShowing:null,contentView:null,contentViewBindingDefault:SC.Binding.single(),replaceContent:function(a){this.removeAllChildren();if(a){this.appendChild(a)}},createChildViews:function(){var a=this.get("contentView");if(a){a=this.contentView=this.createChildView(a);this.childViews=[a]}},awake:function(){arguments.callee.base.apply(this,arguments);var a=this.get("nowShowing");if(a&&a.length>0){this.nowShowingDidChange()}},nowShowingDidChange:function(){var c=this.get("nowShowing");if(c===SC.CONTENT_SET_DIRECTLY){return}var a=(this._instantiatedLastView===YES)?this.get("contentView"):null;this._instantiatedLastView=NO;if(SC.typeOf(c)===SC.T_STRING&&c.length>0){if(c.indexOf(".")>0){c=SC.objectForPropertyPath(c)}else{var b=this.getPath(c);c=SC.kindOf(b,SC.CoreView)?b:SC.objectForPropertyPath(c,this.get("page"))}}if(SC.typeOf(c)===SC.T_CLASS){if(c.kindOf(SC.CoreView)){c=this.createChildView(c);this._instantiatedLastView=YES}else{c=null}}if(c&&!(c instanceof SC.CoreView)){c=null}this.set("contentView",c);if(a){a.destroy()}}.observes("nowShowing"),contentViewDidChange:function(){this.replaceContent(this.get("contentView"))}.observes("contentView")});sc_require("mixins/validatable");SC.FieldView=SC.View.extend(SC.Control,SC.Validatable,{fieldValue:function(){var a=this.get("value");if(SC.typeOf(a)===SC.T_ERROR){a=a.get("errorValue")}return this.fieldValueForObject(a)}.property("value","validator").cacheable(),$input:function(){var a=this._inputElementTagName();return this.$(a).andSelf().filter(a)},_inputElementTagName:function(){return"input"},setFieldValue:function(b){if(SC.none(b)){b=""}var a=this.$input();if(a.val()!==b){a.val(b)}return this},getFieldValue:function(){return this.$input().val()},_field_fieldValueDidChange:function(a){SC.run(function(){this.fieldValueDidChange(NO)},this)},fieldValueDidChange:function(a){var c=this.getFieldValue();var b=this.objectForFieldValue(c,a);this.setIfChanged("value",b)},_field_valueDidChange:function(){this.setFieldValue(this.get("fieldValue"))}.observes("fieldValue"),didCreateLayer:function(){this.setFieldValue(this.get("fieldValue"));this._addChangeEvent()},willDestroyLayer:function(){SC.Event.remove(this.$input(),"change",this,this._field_fieldValueDidChange)},mouseDown:function(a){this._field_isMouseDown=YES;a.allowDefault();return YES},mouseExited:function(a){if(this._field_isMouseDown){this.set("isActive",NO)}a.allowDefault();return YES},mouseEntered:function(a){this.set("isActive",this._field_isMouseDown);a.allowDefault();return YES},mouseUp:function(a){if(this._field_isMouseDown){this.set("isActive",NO)}this._field_isMouseDown=NO;a.allowDefault();return YES},keyDown:function(b){if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(this.performValidateKeyDown(b)){this._isKeyDown=YES;b.allowDefault()}else{b.stop()}return YES},acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),_addChangeEvent:function(){SC.Event.add(this.$input(),"change",this,this._field_fieldValueDidChange)},_field_setFieldValue:function(b){this.propertyWillChange("fieldValue");if(this.fieldValueForObject){b=this.fieldValueForObject(b)}var a=this.setFieldValue(b);this.propertyDidChange("fieldValue");return a},_field_getFieldValue:function(){var a=this.getFieldValue();if(this.objectForFieldValue){a=this.objectForFieldValue(a)}return a}});SC.IMAGE_STATE_NONE="none";SC.IMAGE_STATE_LOADING="loading";SC.IMAGE_STATE_LOADED="loaded";SC.IMAGE_STATE_FAILED="failed";SC.IMAGE_TYPE_NONE="NONE";SC.IMAGE_TYPE_URL="URL";SC.IMAGE_TYPE_CSS_CLASS="CSS_CLASS";SC.BLANK_IMAGE_DATAURL="data:image/gif;base64,R0lGODlhAQABAJAAAP///wAAACH5BAUQAAAALAAAAAABAAEAAAICBAEAOw==";SC.BLANK_IMAGE_URL=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"8")<0?"../../../../system/steedos/4330/sproutcore/foundation/4330/en-us/source/resources/blank.gif":SC.BLANK_IMAGE_DATAURL;SC.BLANK_IMAGE=new Image();SC.BLANK_IMAGE.src=SC.BLANK_IMAGE_URL;SC.BLANK_IMAGE.width=SC.BLANK_IMAGE.height=1;SC.ImageView=SC.View.extend(SC.Control,SC.InnerFrame,{classNames:"sc-image-view",displayProperties:["frame","image","innerFrame","toolTip","imageValue","type"],renderDelegateName:function(){return(this.get("useCanvas")?"canvasImage":"image")+"RenderDelegate"}.property("useCanvas").cacheable(),tagName:function(){return this.get("useCanvas")?"canvas":"div"}.property("useCanvas").cacheable(),canLoadInBackground:NO,image:SC.BLANK_IMAGE,imageValue:function(){var a=this.get("value");return a&&a.isEnumerable?a.firstObject():a}.property("value").cacheable(),innerFrame:function(){var c=this.get("image"),b=c.width,a=c.height,d=this.get("frame");if(SC.none(d)){return{x:0,y:0,width:0,height:0}}return this.innerFrameForSize(b,a,d.width,d.height)}.property("align","image","scale","frame").cacheable(),localize:YES,status:SC.IMAGE_STATE_NONE,type:function(){var a=this.get("imageValue");if(SC.ImageView.valueIsUrl(a)){return SC.IMAGE_TYPE_URL}else{if(!SC.none(a)){return SC.IMAGE_TYPE_CSS_CLASS}}return SC.IMAGE_TYPE_NONE}.property("imageValue").cacheable(),useCanvas:function(){return SC.platform.supportsCanvas&&!this.get("useStaticLayout")&&this.get("type")!==SC.IMAGE_TYPE_CSS_CLASS}.property("useStaticLayout","type").cacheable(),useImageQueue:YES,value:null,viewDidResize:function(){var b=this.get("layer"),c,a;if(b){c=b.offsetWidth;a=b.offsetHeight;if(this._cachedWidth!==c||this._cachedHeight!==a){this.notifyPropertyChange("frame");this._cachedWidth=c;this._cachedHeight=a}}},init:function(){arguments.callee.base.apply(this,arguments);this._image_valueDidChange();if(this.get("useImageCache")!==undefined){SC.Logger.warn("%@ has useImageCache set, please set useImageQueue instead".fmt(this));this.set("useImageQueue",this.get("useImageCache"))}},layerDidChange:function(){if(this.get("useCanvas")){this.set("layerNeedsUpdate",YES)}}.observes("layer"),_image_valueDidChange:function(){var b=this.get("imageValue"),a=this.get("type");if(b!==this._iv_value){this._iv_value=b;this.set("image",SC.BLANK_IMAGE);if(a!==SC.IMAGE_TYPE_CSS_CLASS){this.set("status",SC.IMAGE_STATE_LOADING);if(!this._loadImageUsingCache()){this._loadImage()}}}}.observes("imageValue"),_loadImageUsingCache:function(){var c=this.get("imageValue"),b=this.get("type");if(b===SC.IMAGE_TYPE_URL&&this.get("useImageQueue")){var a=this.get("isVisibleInWindow")||this.get("canLoadInBackground");SC.imageQueue.loadImage(c,this,this._loadImageUsingCacheDidComplete,a);return YES}return NO},_loadImageUsingCacheDidComplete:function(a,c){var b=this.get("imageValue");if(b===a){if(SC.ok(c)){this.didLoad(c)}else{this.didError(c)}}},_loadImage:function(){var d=this.get("imageValue"),b=this.get("type"),c=this,f,a;if(b===SC.IMAGE_TYPE_URL){f=new Image();var e=function(){SC.run(function(){c._loadImageDidComplete(d,SC.$error("SC.Image.FailedError","Image",-101))})};var g=function(){SC.run(function(){c._loadImageDidComplete(d,f)})};a=$(f);a.bind("error",e);a.bind("abort",e);a.bind("load",g);f.src=d;return YES}return NO},_loadImageDidComplete:function(a,c){var b=this.get("imageValue");if(b===a){if(SC.ok(c)){this.didLoad(c)}else{this.didError(c)}}},didLoad:function(a){this.set("status",SC.IMAGE_STATE_LOADED);if(!a){a=SC.BLANK_IMAGE}this.set("image",a)},didError:function(a){this.set("status",SC.IMAGE_STATE_FAILED);this.set("image",SC.BLANK_IMAGE)}});SC.ImageView.valueIsUrl=function(a){return a&&SC.typeOf(a)===SC.T_STRING?a.indexOf("/")>=0:NO};sc_require("views/field");sc_require("system/text_selection");sc_require("mixins/static_layout");sc_require("mixins/editable");SC.TextFieldView=SC.FieldView.extend(SC.StaticLayout,SC.Editable,{classNames:["sc-text-field-view"],blurOnMouseDown:YES,triggerReturnInsertNewline:YES,isTextField:YES,applyImmediately:YES,commitOnBlur:YES,isPassword:NO,isTextArea:NO,focused:NO,hint:"",type:"text",isBrowserFocusable:YES,autoCorrect:YES,autoCapitalize:YES,formattedHint:function(){var a=this.get("hint");return typeof(a)==="string"&&this.get("localize")?SC.String.loc(a):a}.property("hint","localize").cacheable(),hintOnFocus:YES,localize:YES,isEditing:NO,defaultTabbingEnabled:YES,isContextMenuEnabled:YES,continuouslyUpdatesValue:null,allowsErrorAsValue:YES,leftAccessoryView:null,rightAccessoryView:null,spellCheckEnabled:YES,maxLength:5096,shouldRenderBorder:YES,supportsAutoResize:YES,autoResizeLayer:function(){return this.$input()[0]}.property("layer").cacheable(),autoResizeText:function(){return this.get("value")}.property("value").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",20),_hintON:YES,init:function(){var a=this.get("value");this._hintON=((!a||a&&a.length===0)&&!this.get("hintOnFocus"))?YES:NO;var b=this.get("continouslyUpdatesValue");if(b!==null&&b!==undefined){this.set("applyImmediately",b)}return arguments.callee.base.apply(this,arguments)},isEditable:YES,selection:function(m,k){var d=this.$input()[0],f,a,c;if(k===undefined){if(d){a=null;c=null;if(!d.value){a=c=0}else{try{if("selectionStart" in d){a=d.selectionStart}if("selectionEnd" in d){c=d.selectionEnd}}catch(g){return null}if(a===null||c===null){var l=document.selection;if(l){var j=l.type;if(j&&(j==="None"||j==="Text")){f=l.createRange();if(!this.get("isTextArea")){var b=f.text.length;a=Math.abs(f.moveStart("character",0-(d.value.length+1)));c=a+b}else{var h=f.duplicate();h.moveToElementText(d);h.setEndPoint("EndToStart",f);a=h.text.length;c=a+f.text.length}}}}}return SC.TextSelection.create({start:a,end:c})}else{return null}}else{if(!k||!k.kindOf||!k.kindOf(SC.TextSelection)){throw"When setting the selection, you must specify an SC.TextSelection instance."}if(d){if(d.setSelectionRange){d.setSelectionRange(k.get("start"),k.get("end"))}else{f=d.createTextRange();a=k.get("start");f.move("character",a);f.moveEnd("character",k.get("end")-a);f.select()}}return k}}.property("fieldValue").cacheable(),displayProperties:["isBrowserFocusable","formattedHint","fieldValue","isEditing","isEditable","leftAccessoryView","rightAccessoryView","isTextArea"],createChildViews:function(){arguments.callee.base.apply(this,arguments);this.accessoryViewObserver()},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),accessoryViewObserver:function(){var f,h=["leftAccessoryView","rightAccessoryView"],a=h.length,b,e,d,g;for(b=0;b<a;b++){e=h[b];d=this["_"+e];g=this.get(e);if(!(d&&g&&(d===g))){if(d){f=d.get("classNames");f=f.without("sc-text-field-accessory-view");d.set("classNames",f);this.removeChild(d);d=null;this["_"+e]=null}if(g){if(g.isClass){g=g.create({layoutView:this})}f=g.get("classNames");var c="sc-text-field-accessory-view";if(f.indexOf(c)<0){f=SC.clone(f);f.push(c);g.set("classNames",f)}this.appendChild(g);this["_"+e]=g}}}}.observes("leftAccessoryView","rightAccessoryView"),layoutChildViewsIfNeeded:function(a){if(!a){a=this.get("isVisibleInWindow")}if(a&&this.get("childViewsNeedLayout")){var b=this.get("rightAccessoryView");if(b&&b.get){var c=b.get("layout");if(c){c.left=null;if(!c.right){c.right=0}b.adjust(c)}}}arguments.callee.base.apply(this,arguments)},render:function(e,f){arguments.callee.base.apply(this,arguments);var a,d,c,b;a=this.get("fieldValue");if(SC.none(a)){a=""}a=String(a);e.setClass("not-empty",a.length>0);d=this._getAccessoryViewWidths();c=d.left;b=d.right;if(c){c+="px"}if(b){b+="px"}this._renderField(e,f,a,c,b)},_forceRenderFirstTime:NO,_renderFieldLikeFirstTime:function(){this.set("_forceRenderFirstTime",YES)}.observes("isTextArea"),_renderField:function(f,l,y,j,s){var t=this.get("formattedHint"),b=this.get("hintOnFocus"),o="",k=this.get("maxLength"),w=this.get("isTextArea"),E=this.get("isEnabled"),p=this.get("isEditable"),u=this.get("autoCorrect"),F=this.get("autoCapitalize"),m=this.get("isBrowserFocusable"),I="",e="",d="",H,z,g,D,c,n,h,a,x,v;f.setClass("text-area",w);a=SC.browser.isWebkit&&SC.browser.compare(SC.browser.engineVersion,"532")<0;f.setClass("oldWebKitFieldPadding",a);if(l||this._forceRenderFirstTime){this._forceRenderFirstTime=NO;x=E?(p?"":'readonly="readonly"'):'disabled="disabled"';H=this.get("layerId");I=this.get("spellCheckEnabled")?' spellcheck="true"':' spellcheck="false"';if(u!=null){d=" autocorrect="+(!u?'"off"':'"true"')}if(u!=null){e=" autocapitalize="+(!F?'"off"':'"true"')}if(m){v='tabindex="-1"'}if(SC.platform.input.placeholder&&!b){o=' placeholder="'+t+'"'}if(this.get("shouldRenderBorder")){f.push('<div class="border"></div>')}z="";if(j||s){z='style="';if(j){z+="left:"+j+";"}if(s){z+="right:"+s+";"}z+='"'}f.push('<div class="padding" '+z+">");y=this.get("escapeHTML")?SC.RenderContext.escapeHTML(y):y;if(this._hintON&&!SC.platform.input.placeholder&&(!y||(y&&y.length===0))){y=t;f.setClass("sc-hint",YES)}if(b){var B='<div aria-hidden="true" class="hint '+(w?"":"ellipsis")+'%@">'+t+"</div>";f.push(B.fmt(y?" sc-hidden":""))}h="field";if(w){f.push('<textarea aria-label="'+t+'" aria-multiline="true" class="'+h+'" name="'+H+'" '+x+o+I+d+v+e+' maxlength="'+k+'">'+y+"</textarea></div>")}else{g=this.get("type");if(this.get("isPassword")){g="password"}f.push('<input aria-label="'+t+'" class="'+h+'" type="'+g+'" name="'+H+'" '+x+' value="'+y+'"'+o+I+v+' maxlength="'+k+'" '+d+" "+e+"/></div>")}}else{var q=this.$input(),C=q[0],G=this.get("value");if(b){this.$(".hint")[0].innerHTML=t}else{if(!b){C.placeholder=t}}if(SC.browser.name===SC.BROWSER.ie&&SC.browser.version<=8&&!w){q.css("line-height",this.get("frame").height+"px")}if(!G||(G&&G.length===0)){if(this.get("isPassword")){C.type="password"}if(!SC.platform.input.placeholder&&this._hintON){if(!this.get("isFirstResponder")){f.setClass("sc-hint",YES);q.val(t)}else{f.setClass("sc-hint",NO);q.val("")}}}if(u!=null){q.attr("autoCorrect",!u?"off":"true")}else{q.attr("autoCorrect",null)}if(F!=null){q.attr("autoCapitalize",!F?"off":"true")}else{q.attr("autoCapitalize",null)}if(!b&&SC.platform.input.placeholder){q.attr("placeholder",t)}if(m){q.removeAttr("tabindex")}else{q.attr("tabindex","-1")}c=q[0];if(c){if(!E){c.disabled="true";c.readOnly=null}else{if(!p){c.disabled=null;c.readOnly="true"}else{c.disabled=null;c.readOnly=null}}n=c.parentNode.style;if(j){if(n.left!==j){n.left=j}}else{n.left=null}if(s){if(n.right!==s){n.right=s}}else{n.right=null}}}},_getAccessoryViewWidths:function(){var c={},k=["left","right"],d=k.length,f,g,l,j,a,h,e,b;for(f=0;f<d;f++){g=k[f];l=this["_"+g+"AccessoryView"];if(l&&l.isObservable){b=l.get("frame");if(b){a=b.width;if(a){h=l.get("layout");if(h){e=h[g];a+=e}c[g]=a}}}}return c},didCreateLayer:function(){arguments.callee.base.apply(this,arguments);if(!SC.platform.input.placeholder){this.invokeLast(this._setInitialPlaceHolderIE)}if(this.get("isTextArea")){this.invokeLast(this._addTextAreaEvents)}else{this._addTextAreaEvents();if(SC.browser.isMozilla){var a=this.$input();SC.Event.add(a,"keypress",this,this._firefox_dispatch_keypress)}}if(this.get("hintOnFocus")||(SC.browser.name===SC.BROWSER.ie&&SC.browser.version<=8&&!this.get("isTextArea"))){this.invokeLast(this._fixupTextLayout)}},_fixupTextLayout:function(){var a=this.get("frame").height;if(SC.browser.name===SC.BROWSER.ie&&SC.browser.version<=8&&!this.get("isTextArea")){this.$input().css("line-height",a+"px")}if(this.get("hintOnFocus")&&!this.get("isTextArea")){this.$(".hint").css("line-height",this.$(".hint").outerHeight()+"px")}},_setInitialPlaceHolderIE:function(){if(!SC.platform.input.placeholder&&this._hintON){var a=this.$input(),b=a.val();if(!b||(b&&b.length===0)){a.val(this.get("formattedHint"))}}},_addTextAreaEvents:function(){var a=this.$input();SC.Event.add(a,"focus",this,this._textField_fieldDidFocus);SC.Event.add(a,"blur",this,this._textField_fieldDidBlur);SC.Event.add(a,"select",this,this._textField_selectionDidChange);SC.Event.add(a,"input",this,this._textField_inputDidChange)},willDestroyLayer:function(){arguments.callee.base.apply(this,arguments);var a=this.$input();SC.Event.remove(a,"focus",this,this._textField_fieldDidFocus);SC.Event.remove(a,"blur",this,this._textField_fieldDidBlur);SC.Event.remove(a,"select",this,this._textField_selectionDidChange);SC.Event.remove(a,"keypress",this,this._firefox_dispatch_keypress);SC.Event.remove(a,"input",this,this._textField_inputDidChange)},_textField_fieldDidFocus:function(a){SC.run(function(){this.set("focused",YES);this.fieldDidFocus(a);var b=this.get("value");if(!SC.platform.input.placeholder&&((!b)||(b&&b.length===0))){this._hintON=NO}},this)},_textField_fieldDidBlur:function(a){SC.run(function(){this.set("focused",NO);this.fieldDidBlur(this._origEvent||a);var b=this.get("value");if(!SC.platform.input.placeholder&&!this.get("hintOnFocus")&&((!b)||(b&&b.length===0))){this._hintON=YES}},this)},fieldDidFocus:function(a){this.becomeFirstResponder();this.beginEditing(a);if(this._didHideInterceptForPane){this._didHideInterceptForPane.showTouchIntercept();this._didHideInterceptForPane=null}var b=this.get("pane");if(b&&b.get("hasTouchIntercept")){b.hideTouchIntercept();this._didHideInterceptForPane=this.get("pane")}},fieldDidBlur:function(a){this.resignFirstResponder(a);if(this.get("commitOnBlur")){this.commitEditing(a)}var b=this._didHideInterceptForPane;if(b){b.showTouchIntercept();b=null}},_field_fieldValueDidChange:function(a){if(this.get("focused")){SC.run(function(){this.fieldValueDidChange(NO)},this)}this.updateHintOnFocus()},_textField_inputDidChange:function(){var a=SC.empty(this._fieldValueDidChangeTimer)||!this._fieldValueDidChangeTimer.get("isValid");if(this.get("applyImmediately")&&a){this.invokeLater(this.fieldValueDidChange,10)}},updateHintOnFocus:function(){var a=this.get("hintOnFocus");if(!a){return}if(this.getFieldValue()){this.$(".hint").addClass("sc-hidden")}else{this.$(".hint").removeClass("sc-hidden")}}.observes("value"),_topOffsetForFirefoxCursorFix:3,_firefox_dispatch_keypress:function(a){var d=this.get("selection"),e=this.get("value"),c=e?e.length:0,b;if(!d||((d.get("length")===0&&(d.get("start")===0)||d.get("end")===c))){b=SC.RootResponder.responder;if(a.keyCode===9){return}b.keypress.call(b,a);a.stopPropagation()}},_textField_selectionDidChange:function(){this.notifyPropertyChange("selection")},didBecomeKeyResponderFrom:function(a){if(this.get("isVisibleInWindow")){var b=this.$input()[0];try{if(b){b.focus()}}catch(c){}if(!this._txtFieldMouseDown){this.invokeLast(this._selectRootElement)}}},_selectRootElement:function(){var b=this.$input()[0],a;if(b){a=SC.browser.os===SC.OS.mac&&SC.browser.compare(SC.browser.osVersion,"10.7")===0;if(!(SC.browser.name===SC.BROWSER.safari&&a&&SC.buildLocale==="ko-kr")){b.select()}}else{this._textField_selectionDidChange()}},didLoseKeyResponderTo:function(a){var b=this.$input()[0];if(b){b.blur()}this.invokeLater("scrollToOriginIfNeeded",100)},scrollToOriginIfNeeded:function(){var b=this.get("pane");if(!b){return}var a=b.get("firstResponder");if(!a||!a.get("isTextField")){document.body.scrollTop=document.body.scrollLeft=0}},keyDown:function(a){return this.interpretKeyEvents(a)||NO},insertText:function(c,a){var f=a.which,d=a.keyCode,b=false;if(!SC.platform.input.maxlength&&this.get("isTextArea")){var e=this.get("value");if(e&&((!SC.browser.isMozilla&&f>47)||(SC.browser.isMozilla&&((f>32&&f<43)||f>47)&&!(d>36&&d<41)))&&(e.length>=this.get("maxLength"))){b=true}}if((this.performValidateKeyDown(a)||SC.platform.touch)&&!b){this._isKeyDown=YES;a.allowDefault()}else{a.stop()}if(this.get("applyImmediately")){this._fieldValueDidChangeTimer=this.invokeLater(this.fieldValueDidChange,10)}return YES},insertTab:function(b){if(!this.get("defaultTabbingEnabled")){return NO}var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertNewline:function(a){if(this.get("isTextArea")){a.allowDefault();if(this.get("triggerReturnInsertNewline")){return YES}else{return NO}}return NO},deleteForward:function(a){a.allowDefault();return YES},deleteBackward:function(a){a.allowDefault();return YES},moveLeft:function(a){a.allowDefault();return YES},moveRight:function(a){a.allowDefault();return YES},selectAll:function(a){a.allowDefault();return YES},moveUp:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}return NO},moveDown:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}return NO},keyUp:function(a){if(SC.browser.isMozilla&&a.keyCode===SC.Event.KEY_RETURN){this.fieldValueDidChange()}this.notifyPropertyChange("selection");this._isKeyDown=NO;a.allowDefault();return YES},mouseDown:function(a){var b=this.get("fieldValue");this._txtFieldMouseDown=YES;this.becomeFirstResponder();if(!this.get("isEnabled")){a.stop();return YES}else{return arguments.callee.base.apply(this,arguments)}},mouseUp:function(a){this._txtFieldMouseDown=NO;this.notifyPropertyChange("selection");if(!this.get("isEnabled")){a.stop();return YES}return arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},mouseWheel:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}else{return NO}},selectStart:function(a){return YES},_inputElementTagName:function(){if(this.get("isTextArea")){return"textarea"}else{return"input"}},_valueObserver:function(){var b=this.get("value"),a;if(b&&b.length>0){this._hintON=NO;a=this.get("maxLength");if(!SC.platform.input.maxlength&&b.length>a){this.set("value",b.substr(0,a))}}else{if(!this.get("hintOnFocus")){this._hintON=YES}}}.observes("value")});sc_require("views/text_field");sc_require("system/utils/misc");sc_require("delegates/inline_text_field");sc_require("mixins/inline_editor");SC.InlineTextFieldView=SC.TextFieldView.extend(SC.InlineEditor,{classNames:["inline-editor"],_topOffsetForFirefoxCursorFix:0,blurOnMouseDown:YES,_updateViewStyle:function(b){var c="",a=SC.getStyle(b,"font-size");if(a&&a.length>0){c=c+"font-size: "+a+" !important; "}a=SC.getStyle(b,"font-family");if(a&&a.length>0){c=c+"font-family: "+a+" !important; "}a=SC.getStyle(b,"font-weight");if(a&&a.length>0){c=c+"font-weight: "+a+" !important; "}a=SC.getStyle(b,"z-index");if(a&&a.length>0){c=c+"z-index: "+a+" !important; "}a=SC.getStyle(b,"line-height");if(a&&a.length>0){c=c+"line-height: "+a+" !important; "}a=SC.getStyle(b,"text-align");if(a&&a.length>0){c=c+"text-align: "+a+" !important; "}a=SC.getStyle(b,"top-margin");if(a&&a.length>0){c=c+"top-margin: "+a+" !important; "}a=SC.getStyle(b,"bottom-margin");if(a&&a.length>0){c=c+"bottom-margin: "+a+" !important; "}a=SC.getStyle(b,"left-margin");if(a&&a.length>0){c=c+"left-margin: "+a+" !important; "}a=SC.getStyle(b,"right-margin");if(a&&a.length>0){c=c+"right-margin: "+a+" !important; "}return c},_updateViewPaddingStyle:function(b){var c="",a=SC.getStyle(b,"padding-top");if(a&&a.length>0){c=c+"top: "+a+" !important; "}a=SC.getStyle(b,"padding-bottom");if(a&&a.length>0){c=c+"bottom: "+a+" !important; "}a=SC.getStyle(b,"padding-left");if(a&&a.length>0){c=c+"left: "+a+" !important; "}a=SC.getStyle(b,"padding-right");if(a&&a.length>0){c=c+"right: "+a+" !important; "}return c},updateStyle:function(d){if(d.length){d=d[0]}var a=document.getElementById("sc-inline-text-field-style"),c=this._updateViewStyle(d),e=this._updateViewPaddingStyle(d),f=".inline-editor input{"+c+"}.inline-editor textarea{"+c+"}.inline-editor .padding{"+e+"}";if(!a){var b=document.getElementsByTagName("head")[0];a=document.createElement("style");a.type="text/css";a.media="screen";a.id="sc-inline-text-field-style";b.appendChild(a)}if(a.styleSheet){a.styleSheet.cssText=f}else{a.innerHTML=f}},positionOverTargetView:function(k,d,c,b,e){var g;if(!c){c=k.get("pane")}if(!e){e=k.$()[0]}if(!b){var h=k.get("frame");b=SC.offset(e);b.height=h.height;b.width=h.width}var j={},a=c.$()[0],f=k.get("layout");j.height=b.height;j.width=b.width;g=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(d&&f.left){j.left=b.x-f.left-a.offsetLeft-1;if(g){j.left--}}else{j.left=b.x-a.offsetLeft-1;if(g){j.left--}}if(d&&f.top){j.top=b.y-f.top-a.offsetTop;if(g){j.top=j.top-2}}else{j.top=b.y-a.offsetTop;if(g){j.top=j.top-2}}this.set("layout",j)},multiline:NO,isTextArea:function(){return this.get("multiline")}.property("multiline").cacheable(),beginEditing:function(b,a){if(!b(a)){return NO}var d=a.get("pane"),c=this.get("exampleElement");this.beginPropertyChanges();if(c){if(c.length){c=c[0]}}else{c=a.$()[0]}this.updateStyle(c);this.positionOverTargetView(a,this.get("isCollection"),d,this.get("exampleFrame"),c);this._previousFirstResponder=d?d.get("firstResponder"):null;this.becomeFirstResponder();this.endPropertyChanges();return YES}.enhance(),blurEditor:function(a){if(!this.get("isEditing")){return YES}return this.commitOnBlur?this.commitEditing():this.discardEditing()},_endEditing:function(b){var a=b();if(this.get("isFirstResponder")){var c=this.get("pane");if(c&&this._previousFirstResponder){c.makeFirstResponder(this._previousFirstResponder)}else{this.resignFirstResponder()}}this._previousFirstResponder=null;return a}.enhance(),mouseDown:function(a){arguments.callee.base.call(this,a);return this.get("isEditing")},touchStart:function(a){this.mouseDown(a)},keyDown:function(a){var b=this.interpretKeyEvents(a);this.fieldValueDidChange(true);return !b?NO:b},insertText:null,_scitf_blurInput:function(){var a=this.$input()[0];if(a){a.blur()}a=null},willRemoveFromParent:function(){return this._scitf_blurInput()},willLoseFirstResponder:function(b,a){if(b!==this){return}this._previousFirstResponder=null;this._origEvent=a;this._scitf_blurInput();return this.blurEditor(a)},cancel:function(){this.discardEditing();return YES},insertNewline:function(a){if(this.get("isTextArea")){return arguments.callee.base.apply(this,arguments)}else{this.commitEditing();return YES}},insertTab:function(a){var c=this.target;this.resignFirstResponder();this.commitEditing();if(c){var b=c.get("nextValidKeyView");if(b&&b.beginEditing){b.beginEditing()}}return YES},insertBacktab:function(a){var c=this.target;this.resignFirstResponder();this.commitEditing();if(c){var b=c.get("previousValidKeyView");if(b&&b.beginEditing){b.beginEditing()}}return YES}});SC.mixin(SC.InlineTextFieldView,{inlineEditorDelegate:SC.InlineTextFieldDelegate,label:null,editor:null,beginEditing:function(c){var a,d,b,e,f;if(SC.typeOf(c)===SC.T_HASH){b=c;if(!b.delegate||!b.exampleElement||!b.frame){SC.error("Delegate, exampleElement, and frame options are required.");return NO}c=b.delegate;e=b.value}else{e=c.get("value")}f=SC.beget(c);f.mixin({inlineEditorWillBeginEditing:function(){if(c.inlineEditorWillBeginEditing){c.inlineEditorWillBeginEditing.apply(c,arguments)}},inlineEditorDidBeginEditing:function(){if(c.inlineEditorDidBeginEditing){c.inlineEditorDidBeginEditing.apply(c,arguments)}},inlineEditorWillCommitEditing:function(h,j,g){if(c.inlineEditorWillCommitEditing){c.inlineEditorWillCommitEditing(h,j,g)}if(c.inlineEditorWillEndEditing){c.inlineEditorWillEndEditing(h,j)}},inlineEditorDidCommitEditing:function(h,j,g){if(c.inlineEditorDidCommitEditing){c.inlineEditorDidCommitEditing(h,j,g)}if(c.inlineEditorDidEndEditing){c.inlineEditorDidEndEditing(h,j)}SC.InlineTextFieldView._endEditing()},inlineEditorWillDiscardEditing:function(h,g){if(c.inlineEditorWillDiscardEditing){c.inlineEditorWillDiscardEditing(h,g)}if(c.inlineEditorWillEndEditing){c.inlineEditorWillEndEditing(h,this.get("value"))}},inlineEditorDidDiscardEditing:function(h,g){if(c.inlineEditorDidDiscardEditing){c.inlineEditorDidDiscardEditing(h,g)}if(c.inlineEditorDidEndEditing){c.inlineEditorDidEndEditing(h,this.get("value"))}SC.InlineTextFieldView._endEditing()}});if(c.inlineEditorShouldBeginEditing&&!c.inlineEditorShouldBeginEditing(c,e)){return NO}this.editor=d=this.inlineEditorDelegate.acquireEditor(c);d.set("value",e);if(b){d.set("exampleElement",b.exampleElement);d.set("exampleFrame",b.frame);d.set("multiline",b.multiline);d.set("escapeHTML",b.escapeHTML);d.set("isCollection",b.isCollection);d.set("commitOnBLur",b.commitOnBlur);d.set("validator",b.validator)}if(d){return d.beginEditing(f)}else{return NO}},commitEditing:function(){return this.inlineEditorDelegate.editor?this.inlineEditorDelegate.editor.commitEditing():NO},discardEditing:function(){return this.inlineEditorDelegate.editor?this.inlineEditorDelegate.editor.discardEditing():NO},_endEditing:function(){this.inlineEditorDelegate.releaseEditor(this.editor);this.editor=null}});sc_require("mixins/inline_editable");sc_require("mixins/inline_editor_delegate");sc_require("delegates/inline_text_field");SC.REGULAR_WEIGHT="normal";SC.BOLD_WEIGHT="bold";SC.LabelView=SC.View.extend(SC.Control,SC.InlineEditable,{classNames:["sc-label-view"],displayProperties:["displayTitle","displayHint","escapeHTML","textAlign","fontWeight","icon","needsEllipsis","toolTip"],inlineEditorDelegate:SC.InlineTextFieldDelegate,isEditable:NO,exampleEditor:SC.InlineTextFieldView,fontWeight:null,escapeHTML:YES,escapeHTMLBindingDefault:SC.Binding.oneWay().bool(),localize:NO,localizeBindingDefault:SC.Binding.oneWay().bool(),formatter:null,value:"",hint:null,hintEnabled:function(){return this.get("isEditable")}.property("isEditable").cacheable(),icon:null,textAlign:null,supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("displayTitle")}.property("displayTitle").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",10),renderDelegateName:"labelRenderDelegate",displayTitle:function(){var g,e;g=this.get("value");e=this.getDelegateProperty("formatter",this.displayDelegate);if(e){var f=(SC.typeOf(e)===SC.T_FUNCTION)?e(g,this):e.fieldValueForObject(g,this);if(!SC.none(f)){g=f}}if(SC.typeOf(g)===SC.T_ARRAY){var d=[];for(var b=0,c=g.get("length");b<c;b++){var a=g.objectAt(b);if(!SC.none(a)&&a.toString){a=a.toString()}d.push(a)}g=d.join(",")}if(!SC.none(g)&&g.toString){g=g.toString()}if(g&&this.getDelegateProperty("localize",this.displayDelegate)){g=SC.String.loc(g)}return g}.property("value","localize","formatter").cacheable(),displayHint:function(){var b=this.get("hint"),a=this.get("isEditable");if(a){if(b&&this.getDelegateProperty("localize",this.displayDelegate)){b=SC.String.loc(b)}}else{b=null}return b}.property("hint","localize","isEditable").cacheable(),hintValue:function(){var a=this.get("hint");return a}.property("hint").cacheable(),doubleClick:function(a){return this.beginEditing()},inlineEditorDidBeginEditing:function(b,c,d,a){this._oldOpacity=this.get("layout").opacity||1;this.adjust("opacity",0);b(c,d,a)}.enhance(),inlineEditorDidEndEditing:function(){this.adjust("opacity",this._oldOpacity);this._oldOpacity=null}});SC.allowsBackspaceToPreviousPage=NO;SC.HORIZONTAL_ORIENTATION="horizontal";SC.VERTICAL_ORIENTATION="vertical";SC.BORDER_BEZEL="sc-bezel-border";SC.BORDER_BLACK="sc-black-border";SC.BORDER_GRAY="sc-gray-border";SC.BORDER_TOP="sc-top-border";SC.BORDER_BOTTOM="sc-bottom-border";SC.BORDER_NONE=null;SC.Border={borderTop:0,borderRight:0,borderBottom:0,borderLeft:0,borderStyle:SC.BORDER_GRAY,hasBorder:YES,displayProperties:["borderStyle"],_BORDER_REGEXP:(/-border$/),initMixin:function(){this._sc_border_borderStyleDidChange();this._sc_border_borderDimensionsDidChange()},renderMixin:function(a,c){var b=this.get("borderStyle");if(b){if(this._BORDER_REGEXP.exec(b)){a.addClass(b)}else{a.addStyle("border","1px "+b+" solid")}}},_sc_border_borderStyleDidChange:function(){var a=this.get("borderStyle"),b=SC.Border.dimensions[a];if(b){this.beginPropertyChanges();this.set("borderTop",b);this.set("borderRight",b);this.set("borderBottom",b);this.set("borderLeft",b);this.endPropertyChanges()}},_sc_border_borderDimensionsDidChange:function(){var d=this.get("borderTop"),a=this.get("borderRight"),b=this.get("borderBottom"),c=this.get("borderLeft");this.adjust({borderTop:d,borderRight:a,borderBottom:b,borderLeft:c})}.observes("borderTop","borderRight","borderBottom","borderLeft")};SC.mixin(SC.Border,{dimensions:{"sc-bezel-border":1,"sc-black-border":1,"sc-gray-border":1,"sc-top-border":1,"sc-bottom-border":1}});SC.CollectionFastPath={initMixin:function(){this._indexMap={};this._viewMap={}},poolForExampleView:function(a){var b="_pool_"+SC.guidFor(a);if(!this[b]){this[b]=[]}return this[b]},createItemViewFromExampleView:function(c,b){var a=this.createItemView(c,null,b);if(a.isPoolable){a.owningPool=this.poolForExampleView(c)}a.createdFromExampleView=c;return a},configureItemView:function(b,a){b.beginPropertyChanges();b.setIfChanged("content",a.content);b.setIfChanged("contentIndex",a.contentIndex);b.setIfChanged("parentView",a.parentView);b.setIfChanged("layerId",a.layerId);b.setIfChanged("isEnabled",a.isEnabled);b.setIfChanged("isSelected",a.isSelected);b.setIfChanged("outlineLevel",a.outlineLevel);b.setIfChanged("layout",a.layout);b.setIfChanged("disclosureState",a.disclosureState);b.setIfChanged("isVisibleInWindow",a.isVisibleInWindow);b.setIfChanged("isGroupView",a.isGroupView);b.setIfChanged("page",this.page);b.endPropertyChanges()},wakePooledView:function(b,a){this.configureItemView(b,a);if(b.awakeFromPool){b.awakeFromPool(b.owningPool,this)}},allocateItemView:function(d,b){var a;if(d.prototype.isPoolable){var c=this.poolForExampleView(d);if(c.length>0){a=c.pop();this.wakePooledView(a,b)}}if(!a){a=this.createItemViewFromExampleView(d,b)}return a},releaseItemView:function(b){if(!b.isPoolable){b.destroy();return}var a=b.owningPool;a.push(b);if(b.hibernateInPool){b.hibernateInPool(a,this)}},contentIndexIsGroup:function(a,d,c){var e=this.get("contentDelegate");var b=this.get("_contentGroupIndexes"),f=NO;f=b&&b.contains(c);if(f){f=e.contentIndexIsGroup(this,this.get("content"),c)}return f},exampleViewForItem:function(f,d){var b=this.get("contentDelegate"),c=this.get("_contentGroupIndexes"),e,a,g=this.contentIndexIsGroup(this,this.get("content"),d);if(g){e=this.get("contentGroupExampleViewKey");if(e&&f){a=f.get(e)}if(!a){a=this.get("groupExampleView")||this.get("exampleView")}}else{e=this.get("contentExampleViewKey");if(e&&f){a=f.get(e)}if(!a){a=this.get("exampleView")}}return a},setAttributesForItem:function(f,d,c){var b=this.get("contentDelegate"),g=this.contentIndexIsGroup(this,this.get("content"),d),a=this.exampleViewForItem(f,d),e=this.get("content");c.createdFromExampleView=a;c.parentView=this.get("containerView")||this;c.contentIndex=d;c.owner=c.displayDelegate=this;c.content=f;c.page=this.page;c.layerId=this.layerIdFor(d);c.isEnabled=b.contentIndexIsEnabled(this,e,d);c.isSelected=b.contentIndexIsSelected(this,e,d);c.outlineLevel=b.contentIndexOutlineLevel(this,e,d);c.disclosureState=b.contentIndexDisclosureState(this,e,d);c.isVisibleInWindow=this.get("isVisibleInWindow");c.isGroupView=g;c.layout=this.layoutForContentIndex(d);if(!c.layout){c.layout=a.prototype.layout}},mappedViewsForItem:function(a,b){if(!b){b=this._viewMap}return b[SC.guidFor(a)]},mappedViewForItem:function(c,b,d){if(!d){d=this._viewMap}var a=d[SC.guidFor(c)];if(!a){return undefined}return a[b]},mapView:function(e,c,b,f){if(!f){f=this._viewMap}var d=SC.guidFor(e),a=f[d];if(!a){a=f[d]={_length:0}}a[c]=b;a._length++},unmapView:function(e,c,f){if(!f){f=this._viewMap}var d=SC.guidFor(e),a=f[d];if(!a){return}if(a[c]){var b=a[c];delete a[c];a._length--;if(a._length<=0){delete f[d]}}},itemViewForContentIndex:function(b){var d=this.get("content");if(!d){return}var c=d.objectAt(b);var e=this.exampleViewForItem(c,b),a=this._indexMap[b];if(a&&a.createdFromExampleView!==e){this.removeItemView(a);this.unmapView(c,b);a=null}if(!a){a=this.addItemView(e,c,b)}return a},nearestMappedViewIndexForItem:function(e,c,f){var b=this.mappedViewsForItem(e,f);if(!b){return null}var d=null,h=-1,g=0;for(var a in b){a=parseInt(a,10);if(isNaN(a)){continue}g=Math.abs(c-a);if(h<0||g<h){h=g;d=a}}return d},remapItemViews:function(b){var k=this._viewMap,a=(this._viewMap={}),j=(this._indexMap={}),l=[],h=this.get("content"),o;if(!h){return}var f=this._itemsToAdd;b.forEach(function(p){o=h.objectAt(p);var s=this.mappedViewsForItem(o,k);if(s){if(s[p]){var q=s[p];this.unmapView(o,p,k);this.mapView(o,p,q,a);j[p]=q}else{l.push(p)}}else{f.push(p)}},this);for(var n=0,g=l.length;n<g;n++){var m=l[n];o=h.objectAt(m);var e=this.nearestMappedViewIndexForItem(o,m,k),c;if(!SC.none(e)){c=this.mappedViewForItem(o,e,k);var d=this.exampleViewForItem(o,m);if(d===c.createdFromExampleView){this.unmapView(o,e,k);this.mapView(o,m,c,a);j[m]=c}else{f.push(m)}}else{f.push(m)}}return k},reloadIfNeeded:function(f,b){var d=this.get("content"),e;if(!f||!f.isIndexSet){f=this.get("nowShowing")}if(!b){e=this._invalidIndexes;if(!e||!this.get("isVisibleInWindow")){return this}this._invalidIndexes=NO;if(e.isIndexSet&&e.contains(f)){e=YES}if(this.willReload){this.willReload(e===YES?null:e)}}var g=this._itemsToAdd||(this._itemsToAdd=[]);var a=this.remapItemViews(f);this.processRemovals(a);if(e){this.processUpdates(e===YES?f:e)}this.processAdds();if(!b){this.clearDOMPools()}g.length=0;if(!b){var c=this.computeLayout();if(c){this.adjust(c)}if(this.didReload){this.didReload(e===YES?null:e)}}return this},processRemovals:function(c){var f=this.get("content");for(var d in c){var b=c[d];for(var e in b){e=parseInt(e,10);if(isNaN(e)){continue}var a=b[e];if(this._indexMap[e]===a){delete this._indexMap[e]}a._isInCollection=NO;this.removeItemView(a)}}},processUpdates:function(e){var b=this._itemsToUpdate,d=this.get("content"),c,a;e.forEach(function(f){c=d.objectAt(f);if(a=this.mappedViewForItem(c,f)){if(!a._isInCollection){return}var g=this.exampleViewForItem(c,f);this.updateItemView(a,g,c,f)}},this)},processAdds:function(){var f=this.get("content");var g=this._itemsToAdd,b,a=g.length,e,d;for(b=0;b<a;b++){e=g[b];d=f.objectAt(e);var h=this.exampleViewForItem(d,e);var c=this.addItemView(h,d,e)}},clearDOMPools:function(){var a=this._domPools||(this._domPools={});for(var b in a){this.clearDOMPool(a[b])}},domPoolSize:10,clearDOMPool:function(c){var b,a=c.length,d;for(b=this.domPoolSize;b<a;b++){d=c[b];this.removeChild(d);this.releaseItemView(d)}c.length=Math.min(c.length,this.domPoolSize)},domPoolForExampleView:function(d){var c=this._domPools||(this._domPools={}),a=SC.guidFor(d);var b=c[a];if(!b){b=c[a]=[]}return b},itemFromDOMPool:function(c){var b=this.domPoolForExampleView(c);if(b.length<1){return null}var a=b.shift();if(a.wakeFromDOMPool){a.wakeFromDOMPool()}return a},sendToDOMPool:function(a){var b=this.domPoolForExampleView(a.createdFromExampleView);b.push(a);var c=a.get("frame");a.adjust({top:-c.height});a.set("layerId",SC.guidFor(a));if(a.sleepInDOMPool){a.sleepInDOMPool()}},addItemView:function(e,d,c){var a,b=this._TMP_ATTRS||(this._TMP_ATTRS={});this.setAttributesForItem(d,c,b);if(a=this.itemFromDOMPool(e)){this.configureItemView(a,b);a._isInCollection=YES;this.mapView(d,c,a);this._indexMap[c]=a;return a}a=this.allocateItemView(e,b);this.appendChild(a);a._isInCollection=YES;this.mapView(d,c,a);this._indexMap[c]=a;return a},removeItemView:function(a){if(a.get("layerIsCacheable")){this.sendToDOMPool(a)}else{this.removeChild(a)}a._isInCollection=NO},updateItemView:function(d,e,c,b){if(!d.get("layerIsCacheable")||d.createdFromExampleView!==e){this.unmapView(d,b);delete this._indexMap[b];this.removeItemView(d,c,b);var f=this.addItemView(e,c,b)}else{var a=this._TMP_ATTRS||(this._TMP_ATTRS={});this.setAttributesForItem(c,b,a);this.configureItemView(d,a)}},_lastTopUpdate:0,_lastLeftUpdate:0,_tolerance:100,touchScrollDidChange:function(g,f){if(Date.now()-this._lastTouchScrollTime<25){return}var h=this.get("clippingFrame");var e=this._inScrollClippingFrame||(this._inScrollClippingFrame={x:0,y:0,width:0,height:0});e.x=h.x;e.y=h.y;e.width=h.width;e.height=h.height;e.x=g;e.y=f;var d=this.contentIndexesInRect(e);if(!d){return}var b=this.get("length"),a=d.get("max"),c=d.get("min");if(a>b||c<0){d=d.copy();d.remove(b,a-b).remove(c,0-c).freeze()}if(this._lastNowShowing){if(d.contains(this._lastNowShowing)&&this._lastNowShowing.contains(d)){return}}this._lastNowShowing=d;this.reloadIfNeeded(d,YES);this._lastTouchScrollTime=Date.now()}};SC.CollectionGroup={classNames:["sc-collection-group"]};SC.CollectionRowDelegate={isCollectionRowDelegate:YES,itemHeight:24,rowSpacing:0,rowPadding:0,rowHeight:function(b,c){var a=this.get("rowPadding");var d=this.get("itemHeight");if(c!==undefined){this.set("itemHeight",c-a*2);return c}return d+a*2}.property("itemHeight","rowPadding"),customRowHeightIndexes:null,contentIndexRowHeight:function(a,b,c){return this.get("rowHeight")}};SC.CollectionViewDelegate={isCollectionViewDelegate:YES,collectionViewSelectionForProposedSelection:function(a,b){return b},collectionViewShouldSelectIndexes:function(a,b,c){return b},collectionViewShouldDeselectIndexes:function(a,b){return b},collectionViewShouldDeleteIndexes:function(a,b){return b},collectionViewDeleteContent:function(a,c,b){if(!c){return NO}if(SC.typeOf(c.destroyAt)===SC.T_FUNCTION){c.destroyAt(b);a.selectPreviousItem(NO,1);return YES}else{if(SC.typeOf(c.removeAt)===SC.T_FUNCTION){c.removeAt(b);a.selectPreviousItem(NO,1);return YES}else{return NO}}},collectionViewShouldBeginDrag:function(a){return YES},collectionViewDragDataTypes:function(a){return[]},collectionViewDragDataForType:function(a,c,b){return null},collectionViewComputeDragOperations:function(a,b,c){return c},collectionViewValidateDragOperation:function(b,d,e,c,a){return(a&SC.DROP_ON)?SC.DRAG_NONE:e},collectionViewPerformDragOperation:function(b,d,e,c,a){return SC.DRAG_NONE},collectionViewDragViewFor:function(a,b){return null},ghostActsLikeCursor:NO};SC.NavigationBuilder={isNavigationBuilder:YES,navigationTransitions:NO,initMixin:function(){var b=SC.Animatable;if(b&&!this.isAnimatable){this.mixin(b)}else{if(!b){SC.Logger.error("SC.NavigationView and SC.NavigationBuilder require SC.Animatable to perform animations, but it is not present. Please ensure your app or framework references it.")}}var a=this.get("navigationTransitions");if(!a&&SC.Animatable){a={left:{duration:0.25,timing:SC.Animatable.TRANSITION_EASE_IN_OUT,action:"navigationBuildDidFinish"},transform:{duration:0.25,timing:SC.Animatable.TRANSITION_EASE_IN_OUT,action:"navigationBuildDidFinish"}}}if(SC.Animatable){SC.mixin(this.transitions,a)}},metrics:function(){var a=this.computeFrameWithParentFrame();return a},transform:function(a){if(SC.platform.supportsCSS3DTransforms){this.adjust("transform","translate3d("+a+"px,0px,0px)")}else{this.adjust("transform","translate("+a+"px,0px)")}},buildInNavigation:function(){var a=this.metrics();this.disableAnimation();this.transform(this.get("buildDirection")===SC.TO_LEFT?a.width:-a.width);this.enableAnimation();this.invokeLater("transform",10,0)},buildOutNavigation:function(){var a=this.metrics();this.transform(this.get("buildDirection")===SC.TO_LEFT?-a.width:a.width)},buildIn:function(){this.buildInNavigation()},buildOut:function(){this.buildOutNavigation()},resetBuild:function(){this.transform(0)},navigationBuildDidFinish:function(){if(this.isBuildingIn){this.buildInDidFinish()}else{if(this.isBuildingOut){this.buildOutDidFinish()}}}};SC.Scrollable={isScrollable:true,verticalLineScroll:20,horizontalLineScroll:20,verticalPageScroll:function(){return this.get("innerFrame").height}.property("innerFrame"),horizontalPageScroll:function(){return this.get("innerFrame").width}.property("innerFrame"),hasVerticalScroller:function(){return this.get("scrollFrame").height>this.get("innerFrame").height}.property("scrollFrame"),hasHorizontalScroller:function(){return this.get("scrollFrame").width>this.get("innerFrame").width}.property("scrollFrame"),scrollBy:function(a){var b=this.get("scrollFrame");var c=this.get("innerFrame");if(!this.get("hasVerticalScroller")){a.y=0}if(b.height<=c.height){a.y=0}if(!this.get("hasHorizontalScroller")){a.x=0}if(b.width<=c.width){a.x=0}var d={x:b.x-(a.x||0),y:b.y-(a.y||0)};this.set("scrollFrame",d);d=this.get("scrollFrame");return{x:d.x-b.x,y:d.y-b.y}},scrollTo:function(a,b){this.set("scrollFrame",{x:0-a,y:0-b})},scrollToVisible:function(b){var e=this.get("innerFrame");var d=this.get("scrollFrame");var a=this.convertFrameFromView(b.get("frame"),b);a.x-=(e.x+d.x);a.y-=(e.y+d.y);var c={x:0-d.x,y:0-d.y,width:e.width,height:e.height};c.y-=Math.max(0,SC.minY(c)-SC.minY(a));c.x-=Math.max(0,SC.minX(c)-SC.minX(a));c.y+=Math.max(0,SC.maxY(a)-SC.maxY(c));c.x+=Math.max(0,SC.maxX(a)-SC.maxX(c));this.scrollTo(c.x,c.y)},scrollDownLine:function(a){if(a===undefined){a=1}return this.scrollBy({y:this.get("verticalLineScroll")*a}).y},scrollUpLine:function(a){if(a===undefined){a=1}return 0-this.scrollBy({y:0-this.get("verticalLineScroll")*a}).y},scrollRightLine:function(a){if(a===undefined){a=1}return this.scrollTo({y:this.get("horizontalLineScroll")*a}).x},scrollLeftLine:function(a){if(a===undefined){a=1}return 0-this.scrollTo({y:0-this.get("horizontalLineScroll")*a}).x},scrollDownPage:function(a){if(a===undefined){a=1}return this.scrollBy({y:this.get("verticalPageScroll")*a}).y},scrollUpPage:function(a){if(a===undefined){a=1}return 0-this.scrollBy({y:0-this.get("verticalPageScroll")*a}).y},scrollRightPage:function(a){if(a===undefined){a=1}return this.scrollTo({y:this.get("horizontalPageScroll")*a}).x},scrollLeftPage:function(a){if(a===undefined){a=1}return 0-this.scrollTo({y:0-this.get("horizontalPageScroll")*a}).x}};SC.ModalPane=SC.Pane.extend({classNames:"sc-modal",_openPaneCount:0,paneWillAppend:function(e){var d;this._openPaneCount++;if(!this.get("isVisibleInWindow")){this.append()}var c=SC.RootResponder.responder.panes;for(var b=0,a=c.length;b<a;b++){d=c[b];if(d!==e){this._hideShowTextfields(d,NO)}}return this},paneDidRemove:function(e){var d;this._openPaneCount--;var c=SC.RootResponder.responder.panes;for(var b=0,a=c.length;b<a;b++){d=c[b];if(d!==e){this._hideShowTextfields(d,YES)}}if(this._openPaneCount<=0){this._openPaneCount=0;if(this.get("isVisibleInWindow")){this.remove()}}},_hideShowTextfields:function(c,b){var a;for(a in SC.View.views){a=SC.View.views[a];if(a!==c&&a.get("pane")===c&&a.get("isTextField")){if(b){if(a._scmp_isBrowserFocusable!==undefined){b=a._scmp_isBrowserFocusable;delete a._scmp_isBrowserFocusable}}else{a._scmp_isBrowserFocusable=a.get("isBrowserFocusable")}a.set("isBrowserFocusable",b)}}},mouseDown:function(b){var a=this.get("owner");if(a&&a.modalPaneDidClick){a.modalPaneDidClick(b)}},touchStart:function(a){this.mouseDown(a)}});sc_require("panes/modal");SC.PanelPane=SC.Pane.extend({isPanelPane:YES,classNames:["sc-panel"],acceptsKeyPane:YES,ariaRole:"dialog",ariaLabel:null,ariaLabelledBy:null,ariaDescribedBy:null,isModal:YES,modalPane:SC.ModalPane.extend({classNames:"for-sc-panel"}),contentView:null,contentViewBindingDefault:SC.Binding.single(),replaceContent:function(a){this.removeAllChildren();if(a){this.appendChild(a)}},createChildViews:function(){var a=this.contentView;if(a){a=this.contentView=this.createChildView(a);this.childViews=[a]}},contentViewDidChange:function(){this.replaceContent(this.get("contentView"))}.observes("contentView"),renderDelegateName:"panelRenderDelegate",_modalPane:function(){var a=this.get("modalPane");if(a&&a.isClass){a=a.create({owner:this});this.set("modalPane",a)}return a},appendTo:function(a){var b;if(!this.get("isVisibleInWindow")&&this.get("isModal")&&(b=this._modalPane())){this._isShowingModal=YES;b.paneWillAppend(this)}return arguments.callee.base.apply(this,arguments)},remove:function(){var b,a=arguments.callee.base.apply(this,arguments);if(this._isShowingModal){this._isShowingModal=NO;if(b=this._modalPane()){b.paneDidRemove(this)}}return a},destroy:function(){var a=this.get("modalPane");if(a&&!a.isClass){a.destroy()}arguments.callee.base.apply(this,arguments)},_isModalDidChange:function(){var b,a=this.get("isModal");if(a){if(!this._isShowingModal&&this.get("isVisibleInWindow")&&(b=this._modalPane())){this._isShowingModal=YES;b.paneWillAppend(this)}}else{if(this._isShowingModal&&(b=this._modalPane())){this._isShowingModal=NO;b.paneDidRemove(this)}}}.observes("isModal"),paneDidAttach:function(){var a=arguments.callee.base.apply(this,arguments);this.becomeKeyPane();return a},displayProperties:["ariaLabel","ariaLabelledBy","ariaDescribedBy"]});SC.TOGGLE_BEHAVIOR="toggle";SC.PUSH_BEHAVIOR="push";SC.TOGGLE_ON_BEHAVIOR="on";SC.TOGGLE_OFF_BEHAVIOR="off";SC.HOLD_BEHAVIOR="hold";SC.ButtonView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-button-view"],themeName:"square",value:null,toggleOnValue:YES,toggleOffValue:NO,localize:NO,localizeBindingDefault:SC.Binding.bool(),title:"",tooltip:"",contentTitleKey:null,icon:null,contentIconKey:null,needsEllipsis:YES,displayTitle:function(){var a=this.get("title");return(a&&this.get("localize"))?SC.String.loc(a):(a||"")}.property("title","localize").cacheable(),keyEquivalent:null,buttonBehavior:SC.PUSH_BEHAVIOR,holdInterval:100,isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),isCancel:NO,isCancelBindingDefault:SC.Binding.oneWay().bool(),action:null,target:null,supportFocusRing:NO,supportsAutoResize:YES,autoResizeLayer:function(){var a=this.invokeRenderDelegateMethod("getRenderedAutoResizeLayer",this.$());return a||this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("displayTitle")}.property("displayTitle").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",10),_labelMinWidthIE7:0,triggerActionAfterDelay:function(a){if(!this.get("isEnabled")){return NO}this.set("isActive",YES);this.invokeLater("triggerAction",200,a);return YES},triggerAction:function(a){this._action(a,YES);this.didTriggerAction();this.set("isActive",NO)},didTriggerAction:function(){},init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("keyEquivalent");if(a){this._defaultKeyEquivalent=a}if(!SC.none(this.get("value"))){this._button_valueDidChange()}},ariaRole:"button",displayProperties:["icon","displayTitle","value","displayToolTip","isDefault","isCancel","escapeHTML","needsEllipsis","tooltip","supportFocusRing","buttonBehavior"],renderDelegateName:"buttonRenderDelegate",contentKeys:{contentValueKey:"value",contentTitleKey:"title",contentIconKey:"icon"},_button_displayObserver:function(){this.displayDidChange()}.observes("title","icon","value"),performKeyEquivalent:function(c,b){if(!this.get("isVisibleInWindow")){return NO}if(!this.get("isEnabled")){return NO}var a=this.get("keyEquivalent");if(a){if(a===c){return this.triggerAction(b)}}else{if((this.get("isDefault")&&(c==="return"))||(this.get("isCancel")&&(c==="escape"))){return this.triggerAction(b)}}return NO},computeIsSelectedForValue:function(d){var b=this.get("toggleOnValue"),c,a;if(SC.typeOf(d)===SC.T_ARRAY){if(d.length===1){c=(d[0]==b)}else{c=null;d.find(function(e){a=(e==b);if(c===null){c=a}else{if(a!==c){c=SC.MIXED_STATE}}return c===SC.MIXED_STATE})}}else{if(d===SC.MIXED_STATE){c=SC.MIXED_STATE}else{c=(d===b)}}return c},_button_valueDidChange:function(){var b=this.get("value"),a=this.computeIsSelectedForValue(b);this.set("isSelected",a)}.observes("value"),_button_isSelectedDidChange:function(){var c=this.get("isSelected"),b=this.computeIsSelectedForValue(this.get("value"));if((c!==SC.MIXED_STATE)&&(b!==c)){var a=(c)?"toggleOnValue":"toggleOffValue";this.set("value",this.get(a))}}.observes("isSelected"),_defaultKeyEquivalent:null,_isDefaultOrCancelDidChange:function(){var b=!!this.get("isDefault"),a=!b&&this.get("isCancel");if(b){this.set("keyEquivalent","return")}else{if(a){this.set("keyEquivalent","escape")}else{this.set("keyEquivalent",this._defaultKeyEquivalent)}}}.observes("isDefault","isCancel"),mouseDown:function(a){var b=this.get("buttonBehavior");if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;if(b===SC.HOLD_BEHAVIOR){this._action(a)}else{if(!this._isFocused&&(b!==SC.PUSH_BEHAVIOR)){this._isFocused=YES;this.becomeFirstResponder()}}return YES},mouseExited:function(a){if(this._isMouseDown){this.set("isActive",NO)}return YES},mouseEntered:function(a){if(this._isMouseDown){this.set("isActive",YES)}return YES},mouseUp:function(b){if(this._isMouseDown){this.set("isActive",NO)}this._isMouseDown=false;if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){var a=this.$().within(b.target);if(a&&this.get("isEnabled")){this._action(b)}}return YES},touchStart:function(b){var a=this.get("buttonBehavior");if(!this.get("isEnabled")){return YES}this.set("isActive",YES);if(a===SC.HOLD_BEHAVIOR){this._action(b)}else{if(!this._isFocused&&(a!==SC.PUSH_BEHAVIOR)){this._isFocused=YES;this.becomeFirstResponder()}}b.preventDefault();return YES},touchesDragged:function(a,b){if(!this.touchIsInBoundary(a)){if(!this._touch_exited){this.set("isActive",NO)}this._touch_exited=YES}else{if(this._touch_exited){this.set("isActive",YES)}this._touch_exited=NO}a.preventDefault();return YES},touchEnd:function(a){this._touch_exited=NO;this.set("isActive",NO);if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.touchIsInBoundary(a)&&this.get("isEnabled")){this._action()}}a.preventDefault();return YES},keyDown:function(b){if(!this.get("isEnabled")){return YES}if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(b.which===13||b.which===32){this.triggerActionAfterDelay(b);return YES}b.allowDefault();return NO},_action:function(a,c){switch(this.get("buttonBehavior")){case SC.TOGGLE_BEHAVIOR:var b=this.get("isSelected");if(b){this.set("value",this.get("toggleOffValue"))}else{this.set("value",this.get("toggleOnValue"))}break;case SC.TOGGLE_ON_BEHAVIOR:this.set("value",this.get("toggleOnValue"));break;case SC.TOGGLE_OFF_BEHAVIOR:this.set("value",this.get("toggleOffValue"));break;case SC.HOLD_BEHAVIOR:this._runHoldAction(a,c);break;default:this._runAction(a)}},_runAction:function(a){var c=this.get("action"),d=this.get("target")||null,b;if(c){if(c&&(SC.typeOf(c)===SC.T_FUNCTION)){this.action(a);return}else{b=this.getPath("pane.rootResponder");if(b){b.sendAction(c,d,this,this.get("pane"),null,this)}}}},_runHoldAction:function(a,b){if(this.get("isActive")){this._runAction();if(!b){SC.RunLoop.begin();this.invokeLater("_runHoldAction",this.get("holdInterval"),a);SC.RunLoop.end()}}},didBecomeKeyResponderFrom:function(a){if(!this._isFocused){this._isFocused=YES;this.becomeFirstResponder();if(this.get("isVisibleInWindow")){this.$().focus()}}},willLoseKeyResponderTo:function(a){if(this._isFocused){this._isFocused=NO}},didAppendToDocument:function(){if(SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0&&this.get("useStaticLayout")){var e=this.get("layout"),d=this.$(),a=0;if(d&&d[0]&&(a=d[0].clientWidth)&&a!==0&&this._labelMinWidthIE7===0){var c=this.$(".sc-button-label"),h=parseInt(c.css("paddingRight"),0),b=parseInt(c.css("paddingLeft"),0),g=parseInt(c.css("marginRight"),0),f=parseInt(c.css("marginLeft"),0);if(g=="auto"){SC.Logger.log(g+","+f+","+h+","+b)}if(!h&&isNaN(h)){h=0}if(!b&&isNaN(b)){b=0}if(!g&&isNaN(g)){g=0}if(!f&&isNaN(f)){f=0}this._labelMinWidthIE7=a-(h+b)-(g+f);c.css("minWidth",this._labelMinWidthIE7+"px")}else{this.invokeLater(this.didAppendToDocument,1)}}}});SC.ButtonView.CLICK_AND_HOLD_DELAY=SC.browser.isIE?600:300;SC.REGULAR_BUTTON_HEIGHT=24;sc_require("panes/panel");sc_require("views/button");SC.BUTTON1_STATUS="button1";SC.BUTTON2_STATUS="button2";SC.BUTTON3_STATUS="button3";SC.AlertPane=SC.PanelPane.extend({classNames:["sc-alert"],ariaRole:"alertdialog",delegate:null,icon:"sc-icon-alert-48",message:"",ariaLabel:function(){return this.get("message")}.property("message").cacheable(),description:"",displayDescription:function(){var a=this.get("description");if(!a||a.length===0){return a}a=SC.RenderContext.escapeHTML(a);return'<p class="description">'+a.split("\n").join('</p><p class="description">')+"</p>"}.property("description").cacheable(),caption:"",displayCaption:function(){var a=this.get("caption");if(!a||a.length===0){return a}a=SC.RenderContext.escapeHTML(a);return'<p class="caption">'+a.split("\n").join('</p><p class="caption">')+"</p>"}.property("caption").cacheable(),button1:SC.outlet("contentView.childViews.1.childViews.1"),button2:SC.outlet("contentView.childViews.1.childViews.0"),button3:SC.outlet("contentView.childViews.2.childViews.0"),buttonThreeWrapper:SC.outlet("contentView.childViews.2"),layout:{top:0.3,centerX:0,width:500},contentView:SC.View.extend({useStaticLayout:YES,layout:{left:0,right:0,top:0,height:"auto"},childViews:[SC.View.extend(SC.StaticLayout,{classNames:["info"],render:function(a,c){var b=this.get("pane");if(b.get("icon")=="blank"){a.addClass("plain")}a.push('<img src="'+SC.BLANK_IMAGE_URL+'" class="icon '+b.get("icon")+'" />');a.begin("h1").attr("class","header").text(b.get("message")||"").end();a.push(b.get("displayDescription")||"");a.push(b.get("displayCaption")||"");a.push('<div class="separator"></div>')}}),SC.View.extend({layout:{bottom:13,height:24,right:18,width:466},childViews:["cancelButton","okButton"],classNames:["text-align-right"],cancelButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},isCancel:YES,action:"dismiss",isVisible:NO}),okButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},isDefault:YES,action:"dismiss",isVisible:NO})}),SC.View.extend({layout:{bottom:13,height:24,left:18,width:150},childViews:[SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},action:"dismiss",isVisible:NO})]})]}),dismiss:function(b){var a=this.delegate,c,d,e;if(a&&a.alertPaneDidDismiss){a.alertPaneDidDismiss(this,b.get("actionKey"))}if(d=(b&&b.get("customAction"))){if(SC.typeOf(d)===SC.T_FUNCTION){d.call(d)}else{c=this.getPath("pane.rootResponder");if(c){e=b.get("customTarget");c.sendAction(d,e||a,this,this,null,this)}}}this.remove()},alertInfoDidChange:function(){var a=this.getPath("contentView.childViews.0");if(a){a.displayDidChange()}}.observes("icon","message","displayDescription","displayCaption")});SC.AlertPane.mixin({show:function(f){f=SC.AlertPane._argumentsCall.apply(this,arguments);var a=this.create(f),k=0,g=f.buttons,e,h,b,d,c;if(g){g.forEach(function(l){k++;if(!l){return}e=a.get("button%@".fmt(k));h=l.title;b=l.action;d=l.target;c=f.themeName||"capsule";e.set("title".fmt(k),h);if(b){e.set("customAction".fmt(k),b)}if(d){e.set("customTarget".fmt(k),d)}e.set("isVisible",!!h);e.set("themeName",c)})}else{e=a.get("button1");e.set("title","OK");e.set("isVisible",YES)}var j=a.append();a.adjust("height",a.childViews[0].$().height());a.updateLayout();return j},warn:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-alert-48";return this.show(a)},info:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-info-48";return this.show(a)},error:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-error-48";return this.show(a)},plain:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="blank";return this.show(a)},_argumentsCall:function(b){var a=b;if(SC.typeOf(b)!==SC.T_HASH){var c=this._normalizeArguments(arguments);a={message:c[0],description:c[1],caption:c[2],delegate:c[7],icon:(c[6]||"sc-icon-alert-48"),themeName:"capsule"};if(SC.typeOf(c[3])===SC.T_STRING||SC.typeOf(c[4])===SC.T_STRING||SC.typeOf(c[5])===SC.T_STRING){a.buttons=[{title:c[3]},{title:c[4]},{title:c[5]}]}}return a},_normalizeArguments:function(b){b=SC.A(b);var a=b.length,c=b[a-1];if(SC.typeOf(c)!==SC.T_STRING){b[a-1]=null}else{c=null}b[7]=c;return b}});sc_require("panes/panel");SC.PalettePane=SC.PanelPane.extend({classNames:["sc-palette"],isModal:NO,modalPane:SC.ModalPane,isAnchored:NO,_mouseOffsetX:null,_mouseOffsetY:null,mouseDown:function(a){var b=this.get("frame");this._mouseOffsetX=b?(b.x-a.pageX):0;this._mouseOffsetY=b?(b.y-a.pageY):0;return YES},mouseDragged:function(a){if(!this.isAnchored){this.set("layout",{width:this.layout.width,height:this.layout.height,left:this._mouseOffsetX+a.pageX,top:this._mouseOffsetY+a.pageY});this.updateLayout()}return YES},touchStart:function(a){return this.mouseDown(a)},touchesDragged:function(a){return this.mouseDragged(a)}});sc_require("panes/palette");SC.PICKER_MENU="menu";SC.PICKER_FIXED="fixed";SC.PICKER_POINTER="pointer";SC.PICKER_MENU_POINTER="menu-pointer";SC.POINTER_LAYOUT=["perfectRight","perfectLeft","perfectTop","perfectBottom"];SC.PickerPane=SC.PalettePane.extend({classNames:["sc-picker"],isAnchored:YES,isModal:YES,pointerPos:"perfectRight",pointerPosX:0,pointerPosY:0,anchorElement:null,anchorCached:null,preferType:null,preferMatrix:null,pointerOffset:null,extraRightOffset:0,removeTarget:null,removeAction:null,repositionOnWindowResize:YES,_anchorView:null,_anchorHTMLElement:null,popup:function(c,b,d,a){if(c){if(c.isView){this._anchorView=c;this._setupScrollObservers(c)}else{this._anchorHTMLElement=c}}this.beginPropertyChanges();if(b){this.set("preferType",b)}if(d){this.set("preferMatrix",d)}if(a){this.set("pointerOffset",a)}this.endPropertyChanges();this.positionPane();this._hideOverflow();return this.append()},positionPane:function(f){f=f&&this.get("anchorCached");var b=f?this.get("anchorCached"):this.get("anchorElement"),c=this.get("preferType"),d=this.get("preferMatrix"),e=this.get("layout"),a;if(b){if(!f){b=this.computeAnchorRect(b);this.set("anchorCached",b)}if(b.x===0&&b.y===0){return}a=SC.cloneRect(b);if(c){switch(c){case SC.PICKER_MENU:case SC.PICKER_FIXED:if(!d||d.length!==3){this.set("preferMatrix",[1,4,3])}a.x+=((this.preferMatrix[2]===0)?a.width:0)+this.preferMatrix[0];a.y+=((this.preferMatrix[2]===3)?a.height:0)+this.preferMatrix[1];break;default:a.y+=a.height;break}}else{a.y+=a.height}a=this.fitPositionToScreen(a,this.get("frame"),b);this.adjust({width:a.width,height:a.height,left:a.x,top:a.y})}else{this.adjust({width:e.width,height:e.height,centerX:0,centerY:0})}this.updateLayout();return this},computeAnchorRect:function(c){var e,b,d,a=SC.RootResponder.responder.computeWindowSize();if(c.getBoundingClientRect){e=c.getBoundingClientRect();b={x:e.left,y:e.top,width:e.width,height:e.height};if(b.width===undefined||b.height===undefined){d=SC.$(c);b.width=d.outerWidth();b.height=d.outerHeight()}}else{b=SC.offset(c);d=SC.$(c);b.width=d.outerWidth();b.height=d.outerHeight()}b.height=(a.height-b.y)<b.height?(a.height-b.y):b.height;if(!SC.browser.isIE&&window.scrollX>0||window.scrollY>0){b.x+=window.scrollX;b.y+=window.scrollY}else{if(SC.browser.isIE&&(document.documentElement.scrollTop>0||document.documentElement.scrollLeft>0)){b.x+=document.documentElement.scrollLeft;b.y+=document.documentElement.scrollTop}}return b},fitPositionToScreen:function(h,c,b){var a=SC.RootResponder.responder.computeWindowSize(),g={x:0,y:0,width:a.width,height:a.height};var d=SC.RootResponder.responder.mainPane;if(d){var e=d.layout.minWidth,f=d.layout.minHeight;if(e&&g.width<e){g.width=d.layout.minWidth}if(f&&g.height<f){g.height=d.layout.minHeight}}c.x=h.x;c.y=h.y;if(this.preferType){switch(this.preferType){case SC.PICKER_MENU:c=this.fitPositionToScreenMenu(g,c,this.get("isSubMenu"));break;case SC.PICKER_MENU_POINTER:this.setupPointer(b);c=this.fitPositionToScreenMenuPointer(g,c,b);break;case SC.PICKER_POINTER:this.setupPointer(b);c=this.fitPositionToScreenPointer(g,c,b);break;case SC.PICKER_FIXED:break;default:break}}else{c=this.fitPositionToScreenDefault(g,c,b)}this.displayDidChange();return c},fitPositionToScreenDefault:function(c,d,b){if(SC.maxX(d)>c.width){var e=Math.max(SC.maxX(b),d.width);d.x=Math.min(e,c.width)-d.width}if(SC.minX(d)<0){d.x=SC.minX(Math.max(b,0));if(SC.maxX(d)>c.width){d.x=Math.max(0,c.width-d.width)}}if(SC.maxY(d)>c.height){e=Math.max((b.y-d.height),0);if(e>c.height){d.y=Math.max(0,c.height-d.height)}else{d.y=e}}if(SC.minY(d)<0){e=Math.min(SC.maxY(b),(c.height-b.height));d.y=Math.max(e,0)}return d},fitPositionToScreenMenu:function(c,b,a){if(a){b.x-=this.get("submenuOffsetX");b.y-=Math.floor(this.get("menuHeightPadding")/2)}if((b.x+b.width)>(c.width-20)){if(a){b.x=b.x-(b.width*2)}else{b.x=c.width-b.width-20}}if(b.x<7){b.x=7}if(b.y<7){b.height+=b.y;b.y=7}if(b.height+b.y+35>=c.height){if(b.height+50>=c.height){b.y=SC.MenuPane.VERTICAL_OFFSET;b.height=c.height-(SC.MenuPane.VERTICAL_OFFSET*2)}else{b.y+=(c.height-(b.height+b.y+35))}}return b},fitPositionToScreenMenuPointer:function(c,d,b){d=this.fitPositionToScreenPointer(c,d,b);if(d.height+d.y+35>=c.height){d.height=c.height-d.y-(SC.MenuPane.VERTICAL_OFFSET*2)}return d},fitPositionToScreenPointer:function(o,l,n){var h=[this.pointerOffset[0],this.pointerOffset[1],this.pointerOffset[2],this.pointerOffset[3]];var e=[[n.x+n.width+h[0],n.y+parseInt(n.height/2,0)-40],[n.x-l.width+h[1],n.y+parseInt(n.height/2,0)-40],[n.x+parseInt((n.width/2)-(l.width/2),0),n.y-l.height+h[2]],[n.x+parseInt((n.width/2)-(l.width/2),0),n.y+n.height+h[3]]];var c=[[n.x+n.width+l.width+h[0],n.y+parseInt(n.height/2,0)+l.height-24],[n.x+h[1],n.y+parseInt(n.height/2,0)+l.height-24],[n.x+parseInt((n.width/2)-(l.width/2),0)+l.width,n.y+h[2]],[n.x+parseInt((n.width/2)-(l.width/2),0)+l.width,n.y+n.height+l.height+h[3]]];var g=[[e[0][1]>0?0:0-e[0][1],c[0][0]<o.width?0:c[0][0]-o.width,c[0][1]<o.height?0:c[0][1]-o.height,e[0][0]>0?0:0-e[0][0]],[e[1][1]>0?0:0-e[1][1],c[1][0]<o.width?0:c[1][0]-o.width,c[1][1]<o.height?0:c[1][1]-o.height,e[1][0]>0?0:0-e[1][0]],[e[2][1]>0?0:0-e[2][1],c[2][0]<o.width?0:c[2][0]-o.width,c[2][1]<o.height?0:c[2][1]-o.height,e[2][0]>0?0:0-e[2][0]],[e[3][1]>0?0:0-e[3][1],c[3][0]<o.width?0:c[3][0]-o.width,c[3][1]<o.height?0:c[3][1]-o.height,e[3][0]>0?0:0-e[3][0]]];var d=this.preferMatrix;if(d[4]===-1){l.x=n.x+parseInt(n.width/2,0);l.y=n.y+parseInt(n.height/2,0)-parseInt(l.height/2,0);this.set("pointerPos",SC.POINTER_LAYOUT[0]+" fallback");this.set("pointerPosY",parseInt(l.height/2,0)-40)}else{l.x=e[d[4]][0];l.y=e[d[4]][1];this.set("pointerPos",SC.POINTER_LAYOUT[d[4]]);this.set("pointerPosY",0)}this.set("pointerPosX",0);for(var j=0,b,k=SC.POINTER_LAYOUT.length;j<k;j++){b=d[j];if(g[b][0]===0&&g[b][1]===0&&g[b][2]===0&&g[b][3]===0){if(d[4]!==b){l.x=e[b][0];l.y=e[b][1];this.set("pointerPosY",0);this.set("pointerPos",SC.POINTER_LAYOUT[b])}j=SC.POINTER_LAYOUT.length}else{if((b===0||b===1)&&g[b][0]===0&&g[b][1]===0&&g[b][2]<l.height-91&&g[b][3]===0){if(d[4]!==b){l.x=e[b][0];this.set("pointerPos",SC.POINTER_LAYOUT[b])}l.y=e[b][1]-g[b][2];this.set("pointerPosY",g[b][2]);j=SC.POINTER_LAYOUT.length}else{if((b===0||b===1)&&g[b][0]===0&&g[b][1]===0&&g[b][2]<=l.height-51&&g[b][3]===0){if(d[4]!==b){l.x=e[b][0]}l.y=e[b][1]-(l.height-51);this.set("pointerPosY",(l.height-53));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-low");j=SC.POINTER_LAYOUT.length}else{if((b===2||b===3)&&g[b][0]===0&&g[b][1]<=parseInt(l.width/2,0)-this.get("extraRightOffset")&&g[b][2]===0&&g[b][3]===0){if(d[4]!==b){l.y=e[b][1]}l.x=e[b][0]-(parseInt(l.width/2,0)-this.get("extraRightOffset"));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-right");j=SC.POINTER_LAYOUT.length}else{if((b===2||b===3)&&g[b][0]===0&&g[b][1]===0&&g[b][2]===0&&g[b][3]<=parseInt(l.width/2,0)-this.get("extraRightOffset")){if(d[4]!==b){l.y=e[b][1]}l.x=e[b][0]+(parseInt(l.width/2,0)-this.get("extraRightOffset"));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-left");j=SC.POINTER_LAYOUT.length}}}}}}return l},setupPointer:function(f){var g=this.pointerOffset,e=SC.PickerPane;if(!g||g.length!==4){if(this.get("preferType")==SC.PICKER_MENU_POINTER){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:this.set("pointerOffset",e.TINY_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",e.TINY_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.SMALL_CONTROL_SIZE:this.set("pointerOffset",e.SMALL_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",e.SMALL_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.REGULAR_CONTROL_SIZE:this.set("pointerOffset",e.REGULAR_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",e.REGULAR_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.LARGE_CONTROL_SIZE:this.set("pointerOffset",e.LARGE_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",e.LARGE_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.HUGE_CONTROL_SIZE:this.set("pointerOffset",e.HUGE_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",e.HUGE_PICKER_MENU_EXTRA_RIGHT_OFFSET);break}}else{var d=(f.width<16)?((f.width<4)?9:6):0,b=(f.height<16)?((f.height<4)?9:6):0,c=e.PICKER_POINTER_OFFSET;var h=[c[0]+d,c[1]-d,c[2]-b,c[3]+b];this.set("pointerOffset",h);this.set("extraRightOffset",e.PICKER_EXTRA_RIGHT_OFFSET)}}if(!this.preferMatrix||this.preferMatrix.length!==5){this.set("preferMatrix",this.get("preferType")===SC.PICKER_MENU_POINTER?[3,2,1,0,3]:[0,1,2,3,2])}},displayProperties:["preferType","pointerPos","pointerPosY"],renderDelegateName:"pickerRenderDelegate",modalPaneDidClick:function(a){var d=this.get("frame"),e=this.get("removeTarget")||null,c=this.get("removeAction"),b=this.get("rootResponder");if(!this.clickInside(d,a)){if(c){b.sendAction(c,e,this,this,null,this)}else{this.remove()}return YES}return NO},mouseDown:function(a){return this.modalPaneDidClick(a)},clickInside:function(b,a){return SC.pointInRect({x:a.pageX,y:a.pageY},b)},windowSizeDidChange:function(b,a){if(this.repositionOnWindowResize){this.positionPane()}},remove:function(){if(this.get("isVisibleInWindow")&&this.get("isPaneAttached")){this._withdrawOverflowRequest()}this._removeScrollObservers();return arguments.callee.base.apply(this,arguments)},anchorElement:function(a,b){var c;if(b===undefined){c=this._anchorView;return c?c.get("layer"):this._anchorHTMLElement}else{if(!b){throw"You must set 'anchorElement' to either a view or a DOM element"}else{if(b.isView){this._anchorView=b;this._anchorHTMLElement=null}else{this._anchorView=null;this._anchorHTMLElement=b}}}}.property("layer").cacheable(),_hideOverflow:function(){var b=SC.$(document.body),a=SC.$(".sc-main"),d=parseInt(a.css("minWidth"),0),e=parseInt(a.css("minHeight"),0),c=SC.RootResponder.responder.get("currentWindowSize");if(c.width>=d&&c.height>=e){SC.bodyOverflowArbitrator.requestHidden(this)}},_withdrawOverflowRequest:function(){SC.bodyOverflowArbitrator.withdrawRequest(this)},_getScrollViewOfView:function(b){var a=b;while(YES){if(!a){return null}if(a.isScrollable){return a}a=a.get("parentView")}},_setupScrollObservers:function(b){var a=this._getScrollViewOfView(b);if(a){a.addObserver("horizontalScrollOffset",this,this._scrollOffsetDidChange);a.addObserver("verticalScrollOffset",this,this._scrollOffsetDidChange);this._scrollView=a}},_removeScrollObservers:function(){var a=this._scrollView;if(a){a.removeObserver("horizontalScrollOffset",this,this._scrollOffsetDidChange);a.removeObserver("verticalScrollOffset",this,this._scrollOffsetDidChange)}},_scrollOffsetDidChange:function(){this.positionPane()}});SC.PickerPane.PICKER_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.PICKER_EXTRA_RIGHT_OFFSET=20;SC.PickerPane.TINY_PICKER_MENU_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.TINY_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.PickerPane.SMALL_PICKER_MENU_POINTER_OFFSET=[9,-9,-8,8];SC.PickerPane.SMALL_PICKER_MENU_EXTRA_RIGHT_OFFSET=11;SC.PickerPane.REGULAR_PICKER_MENU_POINTER_OFFSET=[9,-9,-12,12];SC.PickerPane.REGULAR_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.PickerPane.LARGE_PICKER_MENU_POINTER_OFFSET=[9,-9,-16,16];SC.PickerPane.LARGE_PICKER_MENU_EXTRA_RIGHT_OFFSET=17;SC.PickerPane.HUGE_PICKER_MENU_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.HUGE_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.SeparatorView=SC.View.extend({classNames:["sc-separator-view"],tagName:"span",layoutDirection:SC.LAYOUT_HORIZONTAL,render:function(a,b){if(b){a.push("<span></span>")}a.addClass(this.get("layoutDirection"))}});sc_require("views/button");sc_require("views/separator");SC.MenuItemView=SC.View.extend(SC.ContentDisplay,{classNames:["sc-menu-item"],displayProperties:["title","isEnabled","isSeparator","isChecked"],ariaRole:"menuitem",escapeHTML:YES,acceptsFirstResponder:YES,blocksIEDeactivate:YES,isContextMenuEnabled:NO,content:null,isSeparator:function(){return this.getContentProperty("itemSeparatorKey")===YES}.property("content").cacheable(),isEnabled:function(){return this.getContentProperty("itemIsEnabledKey")!==NO&&this.getContentProperty("itemSeparatorKey")!==YES}.property("content.isEnabled").cacheable(),isChecked:function(){return this.getContentProperty("itemCheckboxKey")}.property(),subMenu:function(){var c=this.get("content"),b,a;if(!c){return null}a=this.get("parentMenu");b=c.get(a.itemSubMenuKey);if(b){if(SC.kindOf(b,SC.MenuPane)){b.set("isModal",NO);b.set("isSubMenu",YES);b.set("parentMenu",a);return b}else{return SC.MenuPane.create({layout:{width:200},items:b,isModal:NO,isSubMenu:YES,parentMenu:a,controlSize:a.get("controlSize"),exampleView:a.get("exampleView")})}}return null}.property("content").cacheable(),hasSubMenu:function(){return !!this.get("subMenu")}.property("subMenu").cacheable(),init:function(){arguments.callee.base.apply(this,arguments);this.contentDidChange()},render:function(b,h){var c=this.get("content"),a,f,e=this.get("parentMenu"),d=this.get("itemWidth")||e.layout.width,g=this.get("itemHeight")||SC.DEFAULT_MENU_ITEM_HEIGHT;this.set("itemWidth",d);this.set("itemHeight",g);if(this.get("isSeparator")){b.attr("role","separator")}else{if(this.get("isChecked")){b.attr("role","menuitemcheckbox");b.attr("aria-checked",true)}}b=b.begin("a").addClass("menu-item");if(this.get("isSeparator")){b.push('<span class="separator"></span>');b.addClass("disabled")}else{f=c.get(e.itemIconKey);if(f){this.renderImage(b,f);b.addClass("has-icon")}f=this.get("title");if(SC.typeOf(f)!==SC.T_STRING){f=f.toString()}this.renderLabel(b,f);if(this.get("isChecked")){b.push('<div class="checkbox"></div>')}if(this.get("hasSubMenu")){this.renderBranch(b)}f=this.getContentProperty("itemShortCutKey");if(f){this.renderShortcut(b,f)}}b=b.end()},renderImage:function(b,d){var a,c;if(d&&SC.ImageView.valueIsUrl(d)){a=d;c=""}else{c=d;a=SC.BLANK_IMAGE_URL}b.begin("img").addClass("image").addClass(c).attr("src",a).end()},renderLabel:function(b,a){if(this.get("escapeHTML")){a=SC.RenderContext.escapeHTML(a)}b.push("<span class='value ellipsis'>"+a+"</span>")},renderBranch:function(a){a.push('<span class="has-branch"></span>')},renderShortcut:function(b,a){b.push('<span class = "shortcut">'+a+"</span>")},showSubMenu:function(){var a=this.get("subMenu");if(a){a.set("mouseHasEntered",NO);a.popup(this,[0,0,0])}this._subMenuTimer=null},title:function(){var b=this.getContentProperty("itemTitleKey"),a=this.getPath("parentMenu.localize");if(a&&b){b=SC.String.loc(b)}return b||""}.property("content.title").cacheable(),getContentProperty:function(b){var a=this.get("content"),c=this.get("parentMenu");if(a){return a.get(c.get(b))}},mouseUp:function(b){var a;a=this.getPath("parentMenu.rootMenu.targetMenuItem");if(a){a.performAction()}return YES},performAction:function(){if(!this.get("isEnabled")){this.getPath("parentMenu.rootMenu").remove();return YES}if(this.get("hasSubMenu")){return NO}var b=this.getContentProperty("itemDisableMenuFlashKey"),a;if(b){this.sendAction()}else{this._flashCounter=0;a=this.getPath("parentMenu.rootMenu");a._isFlashing=YES;this.invokeLater(this.flashHighlight,25);this.invokeLater(this.sendAction,150)}return YES},sendAction:function(){var c=this.getContentProperty("itemActionKey"),d=this.getContentProperty("itemTargetKey"),b=this.getPath("parentMenu.rootMenu"),a;this.getPath("parentMenu.rootMenu").remove();b._isFlashing=NO;c=(c===undefined)?b.get("action"):c;d=(d===undefined)?b.get("target"):d;b.set("selectedItem",this.get("content"));if(SC.typeOf(c)===SC.T_FUNCTION){c.apply(d,[b])}else{a=this.getPath("pane.rootResponder")||SC.RootResponder.responder;if(a){a.sendAction(c,d,b)}}},flashHighlight:function(){var a=this._flashCounter,b=this.$();if(a%2===0){b.addClass("focus")}else{b.removeClass("focus")}if(a<=2){this.invokeLater(this.flashHighlight,50);this._flashCounter++}},mouseDown:function(a){return YES},mouseEntered:function(a){var c=this.get("parentMenu"),b=c.get("rootMenu");if(b._isFlashing){return}c.set("mouseHasEntered",YES);this.set("mouseHasEntered",YES);c.set("currentMenuItem",this);if(this.get("isEnabled")){this.becomeFirstResponder()}if(this.get("hasSubMenu")){this._subMenuTimer=this.invokeLater(this.showSubMenu,100)}return YES},mouseExited:function(a){var b,c;if(this.get("hasSubMenu")){c=this._subMenuTimer;if(c){c.invalidate()}else{this.invokeLater(this.checkMouseLocation,100)}}else{b=this.get("parentMenu");if(b.get("currentMenuItem")===this){b.set("currentMenuItem",null)}}return YES},touchStart:function(a){this.mouseEntered(a);return YES},touchEnd:function(a){return this.mouseUp(a)},touchEntered:function(a){return this.mouseEntered(a)},touchExited:function(a){return this.mouseExited(a)},checkMouseLocation:function(){var b=this.get("subMenu"),c=this.get("parentMenu"),a,d;if(!b.get("mouseHasEntered")){a=c.get("currentMenuItem");if(a===this||a===null){d=c.get("previousMenuItem");if(d){d.resignFirstResponder()}this.resignFirstResponder();b.remove()}}},moveUp:function(b,a){var c=this.get("parentMenu");if(c){c.moveUp(this)}return YES},moveDown:function(b,a){var c=this.get("parentMenu");if(c){c.moveDown(this)}return YES},moveRight:function(b,a){this.showSubMenu();return YES},insertText:function(b,a){var c=this.get("parentMenu");if(c){c.insertText(b,a)}},keyDown:function(a){return this.interpretKeyEvents(a)},keyUp:function(a){return YES},cancel:function(a){this.getPath("parentMenu.rootMenu").remove();return YES},didBecomeFirstResponder:function(a){if(a!==this){return}var b=this.get("parentMenu");if(b){b.set("currentSelectedMenuItem",this)}},willLoseFirstResponder:function(a){if(a!==this){return}var b=this.get("parentMenu");if(b){b.set("currentSelectedMenuItem",null);b.set("previousSelectedMenuItem",this)}},insertNewline:function(b,a){this.mouseUp(a)},closeParent:function(){this.$().removeClass("focus");var a=this.get("parentMenu");if(a){a.remove()}},clickInside:function(b,a){return SC.pointInRect({x:a.pageX,y:a.pageY},b)},contentDidChange:function(){var b=this.get("content"),a=this._content;if(b===a){return}var c=this.contentPropertyDidChange;if(a&&a.removeObserver){a.removeObserver("*",this,c)}this._content=b;if(b&&b.addObserver){b.addObserver("*",this,c)}this.contentPropertyDidChange(b,"*")}.observes("content"),contentPropertyDidChange:function(g,j){var b=this.get("parentMenu");if(!b){return}var a=SC.MenuItemView._contentPropertyToMenuItemPropertyMapping,h=SC.keys(a),e,f,d,c;if(j==="*"){for(e=0,f=h.length;e<f;++e){d=h[e];c=a[d];this.notifyPropertyChange(c)}}else{for(e=0,f=h.length;e<f;++e){d=h[e];if(b.get(d)===j){c=a[d];this.notifyPropertyChange(c)}}}}});SC.MenuItemView._contentPropertyToMenuItemPropertyMapping={itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemSeparatorKey:"isSeparator",itemSubMenuKey:"subMenu"};sc_require("panes/picker");sc_require("views/menu_item");SC.MenuPane=SC.PickerPane.extend({classNames:["sc-menu"],ariaRole:"menu",items:[],controlSize:SC.REGULAR_CONTROL_SIZE,itemHeight:SC.propertyFromRenderDelegate("itemHeight",20),itemSeparatorHeight:SC.propertyFromRenderDelegate("itemSeparatorHeight",9),menuHeight:0,menuHeightPadding:SC.propertyFromRenderDelegate("menuHeightPadding",6),submenuOffsetX:SC.propertyFromRenderDelegate("submenuOffsetX",2),selectedItem:null,exampleView:SC.MenuItemView,anchor:null,isSubMenu:NO,localize:YES,acceptsMenuPane:YES,isContextMenuEnabled:NO,popup:function(b,c){var a;this.beginPropertyChanges();if(b){if(b.isView){this._anchorView=b;this._setupScrollObservers(b)}else{this._anchorHTMLElement=b}}if(c){this.set("preferMatrix",c)}this.adjust("height",this.get("menuHeight"));this.positionPane();this.set("defaultResponder",this);this.endPropertyChanges();this._hideOverflow();this.append()},remove:function(){var a=this.get("parentMenu");this.set("currentMenuItem",null);this.closeOpenMenus();this.resignMenuPane();if(a){a.becomeMenuPane()}return arguments.callee.base.apply(this,arguments)},itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemValueKey:"value",itemIconKey:"icon",itemHeightKey:"height",itemSubMenuKey:"subMenu",itemSeparatorKey:"isSeparator",itemTargetKey:"target",itemActionKey:"action",itemCheckboxKey:"checkbox",itemShortCutKey:"shortcut",itemKeyEquivalentKey:"keyEquivalent",itemDisableMenuFlashKey:"disableMenuFlash",itemLayerIdKey:"layerId",itemExampleViewKey:"exampleView",menuItemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemSeparatorKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemHeightKey","itemSubMenuKey","itemKeyEquivalentKey","itemTargetKey","itemLayerIdKey"],preferType:SC.PICKER_MENU,isModal:YES,_menuView:null,init:function(){return arguments.callee.base.apply(this,arguments)},displayProperties:["controlSize"],renderDelegateName:"menuRenderDelegate",createChildViews:function(){var b,a,c;b=this._menuScrollView=this.createChildView(SC.MenuScrollView,{borderStyle:SC.BORDER_NONE,controlSize:this.get("controlSize")});a=this._menuView=SC.View.create({parentViewDidResize:function(){this.notifyPropertyChange("frame")},viewDidResize:function(){}});c=this.get("menuItemViews");a.set("layout",{top:0,left:0,height:this.get("menuHeight")});a.replaceAllChildren(c);b.set("contentView",a);this.childViews=[b];return this},paneDidAttach:function(){var a=(this.rootResponder=SC.RootResponder.responder);a.panes.add(this);this.set("currentWindowSize",a.computeWindowSize());this.set("isPaneAttached",YES);this.parentViewDidChange();this._notifyDidAppendToDocument();this.becomeMenuPane();return this},becomeMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(this)}return this},resignMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(null)}return this},menuItemViews:function(){return this.createMenuItemViews()}.property("displayItems").cacheable(),createMenuItemViews:function(){var j=[],s=this.get("displayItems"),a=this.get("exampleView"),v,d,m,l,e,q,o,g,b,k,t,c,f,n,h,p,x,w,u;if(!s){return j}o=this.get("itemHeightKey");g=this.get("itemSeparatorKey");l=this.get("itemExampleViewKey");b=this.get("itemHeight");f=this.get("itemKeyEquivalentKey");k=this.get("itemSeparatorHeight");x=this.get("itemLayerIdKey");c=Math.floor(this.get("menuHeightPadding")/2);t=c;h=this.menuItemKeys.map(SC._menu_fetchKeys,this);u=s.get("length");for(p=0;p<u;p++){v=s[p];q=v.get(o);if(!q){q=v.get(g)?k:b}w={layout:{height:q,top:t},contentDisplayProperties:h,content:v,parentMenu:this};if(v.get(x)){w.layerId=v.get(x)}e=v.get(l);if(e){d=e}else{d=a}m=this._menuView.createChildView(d,w);j[p]=m;t+=q;n=v.get(f);if(n){if(SC.typeOf(n)===SC.T_ARRAY){n.forEach(function(y){this._keyEquivalents[y]=m},this)}else{this._keyEquivalents[n]=m}}}this.set("menuHeight",t+c);return j},menuItemViewForContentIndex:function(a){var b=this.get("menuItemViews");if(!b){return undefined}return b.objectAt(a)},_keyEquivalents:{},rootMenu:function(){if(this.get("isSubMenu")){return this.getPath("parentMenu.rootMenu")}return this}.property("isSubMenu").cacheable(),windowSizeDidChange:function(b,a){this.remove();return arguments.callee.base.apply(this,arguments)},displayItems:function(){var d=this.get("items"),c=this.get("localize"),h=this.get("itemHeight"),b,e=[],a,f,g;if(!d){return null}b=d.get("length");for(a=0;a<b;a++){f=d.objectAt(a);if(!f){continue}g=SC.typeOf(f);if(g===SC.T_STRING){f=SC.Object.create({title:f,value:f,isEnabled:YES})}else{if(g===SC.T_HASH){f=SC.Object.create(f)}else{if(g===SC.T_ARRAY){f=this.convertArrayMenuItemToObject(f)}}}f.contentIndex=a;e.push(f)}return e}.property("items").cacheable(),_sc_menu_itemsDidChange:function(){var a=this.get("menuItemViews");this._menuView.replaceAllChildren(a);this._menuView.adjust("height",this.get("menuHeight"))}.observes("items"),convertArrayMenuItemToObject:function(f){SC.Logger.warn("Support for Array-based menu items has been deprecated.  Please update your menus to use a hash.");var e,c=SC._menu_fetchKeys,b=SC._menu_fetchItem,h,d=SC.Object.create(),a,g;e=this.menuItemKeys.map(c,this);d[e[0]]=f[0];d[e[1]]=f[1];d[e[2]]=f[2];d[e[3]]=f[3];d[e[4]]=f[4];d[e[5]]=f[5];d[e[6]]=f[6];d[e[7]]=f[7];d[e[8]]=f[8];d[e[9]]=f[9];d[e[10]]=f[10];d[e[11]]=f[11];d[e[12]]=f[12];return d},currentMenuItem:function(a,b){if(b!==undefined){if(this._currentMenuItem!==null){this.set("previousMenuItem",this._currentMenuItem)}this._currentMenuItem=b;this.setPath("rootMenu.targetMenuItem",b);return b}return this._currentMenuItem}.property().cacheable(),_sc_menu_currentMenuItemDidChange:function(){var a=this.get("currentMenuItem"),b=this.get("previousMenuItem");if(b){if(b.get("hasSubMenu")&&a===null){}else{b.resignFirstResponder();this.closeOpenMenusFor(b)}}if(a&&a.get("isEnabled")){a.scrollToVisible()}}.observes("currentMenuItem"),closeOpenMenusFor:function(a){if(!a){return}var b=a.get("parentMenu");while(b&&a){b=a.get("subMenu");if(b){b.remove();a.resignFirstResponder();a=b.get("previousMenuItem")}}},closeOpenMenus:function(){this.closeOpenMenusFor(this.get("previousMenuItem"))},mouseDown:function(a){this.modalPaneDidClick(a);return YES},mouseEntered:function(a){this.set("mouseHasEntered",YES)},keyUp:function(a){var b=this.interpretKeyEvents(a);return !b?NO:b},moveUp:function(){var c=this.get("currentMenuItem"),d=this.get("menuItemViews"),b,e,a;if(!c){a=d.get("length")-1}else{b=c.getPath("content.contentIndex");if(b===0){return YES}a=b-1}while(a>=0){if(d[a].get("isEnabled")){this.set("currentMenuItem",d[a]);d[a].becomeFirstResponder();break}a--}return YES},moveDown:function(){var d=this.get("currentMenuItem"),e=this.get("menuItemViews"),b=e.get("length"),c,f,a;if(!d){a=0}else{c=d.getPath("content.contentIndex");if(c===b){return YES}a=c+1}while(a<b){if(e[a].get("isEnabled")){this.set("currentMenuItem",e[a]);e[a].becomeFirstResponder();break}a++}return YES},moveToBeginningOfDocument:function(){var c=this.get("menuItemViews"),b=c.get("length"),a=0;while(a<b){if(c[a].get("isEnabled")){this.set("currentMenuItem",c[a]);c[a].becomeFirstResponder();break}++a}return YES},moveToEndOfDocument:function(){var c=this.get("menuItemViews"),b=c.get("length"),a=b-1;while(a>=0){if(c[a].get("isEnabled")){this.set("currentMenuItem",c[a]);c[a].becomeFirstResponder();break}--a}return YES},pageDown:function(){var c=this.get("currentMenuItem"),h,e=this.get("menuItemViews"),b=e.get("length"),a=0,g,d=0,f;if(this._menuScrollView&&this._menuScrollView.verticalScrollerView2){if(c){a=c.getPath("content.contentIndex")}g=a;f=this._menuScrollView.get("verticalPageScroll");for(a;a<b;a++){h=e[a];d+=h.get("layout").height;if(d>f){break}else{if(h.get("isEnabled")){g=a}}}h=e[g];this.set("currentMenuItem",h);h.becomeFirstResponder()}else{this.moveToEndOfDocument()}return YES},pageUp:function(){var c=this.get("currentMenuItem"),h,e=this.get("menuItemViews"),b=e.get("length"),a=b-1,g,d=0,f;if(this._menuScrollView&&this._menuScrollView.verticalScrollerView){if(c){a=c.getPath("content.contentIndex")}g=a;f=this._menuScrollView.get("verticalPageScroll");for(a;a>=0;a--){h=e[a];d+=h.get("layout").height;if(d>f){break}else{if(h.get("isEnabled")){g=a}}}h=e[g];this.set("currentMenuItem",h);h.becomeFirstResponder()}else{this.moveToBeginningOfDocument()}return YES},insertText:function(b,a){var d=this._timer,c=this._keyBuffer;if(d){d.invalidate()}d=this._timer=SC.Timer.schedule({target:this,action:"clearKeyBuffer",interval:500,isPooled:NO});c=c||"";c+=b.toUpperCase();this.selectMenuItemForString(c);this._keyBuffer=c;return YES},performKeyEquivalent:function(d,a,b){if(!b&&!this.get("isVisibleInWindow")){return NO}var c=this._keyEquivalents[d];if(c){c.performAction(YES);return YES}if(d==="escape"||d==="return"){this.remove();return YES}return NO},selectMenuItemForString:function(c){var d=this.get("menuItemViews"),f,g,b,a,e;if(!d){return}e=c.length;a=d.get("length");for(b=0;b<a;b++){f=d.objectAt(b);g=f.get("title");if(!g){continue}g=g.replace(/ /g,"").substr(0,e).toUpperCase();if(g===c){this.set("currentMenuItem",f);f.becomeFirstResponder();break}}},clearKeyBuffer:function(){this._keyBuffer=""},modalPaneDidClick:function(a){this.remove();return YES}});SC._menu_fetchKeys=function(a){return this.get(a)};SC._menu_fetchItem=function(a){if(!a){return null}return this.get?this.get(a):this[a]};SC.MenuPane.VERTICAL_OFFSET=23;sc_require("panes/panel");SC.SheetPane=SC.PanelPane.extend({classNames:["sc-sheet"],modalPane:SC.ModalPane,transitionDuration:200,_state:"NO_VIEW",init:function(){arguments.callee.base.apply(this,arguments);if(SC.Animatable){SC.SheetPane.ANIMATABLE_AVAILABLE=YES;this.mixin(SC.Animatable);if(!this.transitions){this.transitions={}}if(!this.transitions.top){this.transitions.top={duration:this.transitionDuration===200?0.3:this.transitionDuration/1000,action:"_complete",target:this}}}},append:function(){var a=this.get("layout");if(!a.height||!a.top){a=SC.View.convertLayoutToAnchoredLayout(a,this.computeParentDimensions())}a.top=-1*a.height;if(this.disableAnimation){this.disableAnimation()}this.adjust(a);this.updateLayout();if(this.enableAnimation){this.enableAnimation()}return arguments.callee.base.apply(this,arguments)},remove:function(){var b=this,a=arguments;this.invokeLater(function(){a.callee.base.apply(b,a)},this.transitionDuration);this.slideUp();return this},paneDidAttach:function(){var a=arguments.callee.base.apply(this,arguments);this.slideDown();return a},slideDown:function(){this._state=SC.SheetPane.ANIMATING;this._direction=SC.SheetPane.SLIDE_DOWN;if(SC.SheetPane.ANIMATABLE_AVAILABLE){this.transitions.top.timing=SC.Animatable.TRANSITION_EASE_OUT;this.adjust("top",0)}else{this._start=Date.now();this._end=this._start+this.get("transitionDuration");this.tick()}},slideUp:function(){this._state=SC.SheetPane.ANIMATING;this._direction=SC.SheetPane.SLIDE_UP;if(SC.SheetPane.ANIMATABLE_AVAILABLE){var a=this.get("layout");this.transitions.top.timing=SC.Animatable.TRANSITION_EASE_IN;this.adjust("top",-1*a.height)}else{this._start=Date.now();this._end=this._start+this.get("transitionDuration");this.tick()}},_complete:function(){var a=this._direction;if(a===SC.SheetPane.SLIDE_DOWN){if(!SC.SheetPane.ANIMATABLE_AVAILABLE){this.adjust("top",0)}this.adjust({centerX:0,left:null});if(SC.browser.isMozilla){this.parentViewDidChange()}}else{var b=this.get("layout");if(!SC.SheetPane.ANIMATABLE_AVAILABLE){this.adjust("top",-1*b.height)}}this._state=SC.SheetPane.READY;this.updateLayout()},blurTo:function(a){this.setFirstResponder("")},tick:function(){this._timer=null;var b=Date.now();var e=(b-this._start)/(this._end-this._start),g=this,a=this._direction,c=this.get("layout"),d,f;if(e<0){e=0}if(e>=1){this._complete();return this}f=Math.floor(c.height*e);if(a==SC.SheetPane.SLIDE_DOWN){g.adjust("top",0-(c.height-f))}else{if(a==SC.SheetPane.SLIDE_UP){g.adjust("top",0-f)}}this._timer=this.invokeLater(this.tick,20);g.updateLayout();return this}});SC.SheetPane.mixin({ANIMATABLE_AVAILABLE:NO,NO_VIEW:"NO_VIEW",ANIMATING:"ANIMATING",READY:"READY",SLIDE_DOWN:"SLIDEDOWN",SLIDE_UP:"SLIDEUP"});SC.BaseTheme.buttonRenderDelegate=SC.RenderDelegate.create({className:"button","sc-small-size":{height:18,autoResizePadding:{width:15,height:0}},"sc-regular-size":{height:24,autoResizePadding:{width:20,height:0}},"sc-huge-size":{height:30,autoResizePadding:{width:30,height:0}},"sc-jumbo-size":{height:44,autoResizePadding:{width:50,height:0}},render:function(a,f){this.addSizeClassName(a,f);var e,b=a.get("toolTip"),g=a.get("isSelected")||NO,k=a.get("isActive")||NO,h=a.get("isDefault")||NO,j=a.get("isCancel")||NO,d=(a.get("buttonBehavior")===SC.TOGGLE_BEHAVIOR),c=SC.guidFor(a)+"-label";f.setClass({icon:!!a.get("icon"),def:h,cancel:j&&!h,active:k,sel:g});if(b){f.attr("title",b);f.attr("alt",b)}this.includeSlices(a,f,SC.THREE_SLICE);if(a.get("isSegment")){f.attr("aria-selected",g.toString())}else{if(d){f.attr("aria-pressed",k.toString())}}f.attr("aria-labelledby",c);f=f.begin("label").addClass("sc-button-label").id(c);a.get("theme").labelRenderDelegate.render(a,f);f=f.end();if(a.get("supportFocusRing")){f=f.begin("div").addClass("focus-ring");this.includeSlices(a,f,SC.THREE_SLICE);f=f.end()}},update:function(e,a){var d=(e.get("buttonBehavior")===SC.TOGGLE_BEHAVIOR);this.updateSizeClassName(e,a);if(e.get("isActive")){a.addClass("active")}var c=e.get("isDefault"),b=e.get("isCancel");if(e.get("isSegment")){a.attr("aria-selected",e.get("isSelected").toString())}else{if(d){a.attr("aria-pressed",e.get("isActive").toString())}}a.attr("title",e.get("toolTip"));a.setClass("icon",!!e.get("icon"));a.setClass("def",!!c);a.setClass("cancel",!!b&&!c);e.get("theme").labelRenderDelegate.update(e,a.find("label"))},getRenderedAutoResizeLayer:function(a,b){return b.find(".sc-button-label")[0]}});SC.BaseTheme.checkboxRenderDelegate=SC.RenderDelegate.create({className:"checkbox",render:function(a,c){this.addSizeClassName(a,c);var e=a.get("theme"),f,b;b=SC.guidFor(a)+"-label";var d=a.get("isSelected")||NO;var j=a.get("isActive");var h=!a.get("isEnabled");var g;if(d===SC.MIXED_STATE){g="mixed"}else{if(d){g="true"}else{g="false"}}c.attr("role","checkbox");c.attr("aria-checked",g);c.attr("aria-labelledby",b);c.setClass({sel:d,active:j,disabled:h});c.push('<span class = "button"></span>');c=c.begin("span").addClass("label").id(b);e.labelRenderDelegate.render(a,c);c=c.end()},update:function(g,c){this.updateSizeClassName(g,c);var f=g.get("theme");var d=g.get("isSelected");var e=g.get("isActive");var b=!g.get("isEnabled");var a;if(d===SC.MIXED_STATE){a="mixed"}else{if(d){a="true"}else{a="false"}}c.attr("aria-checked",a);f.labelRenderDelegate.update(g,c.find("span.label"));c.setClass({sel:d,active:e,disabled:b})}});SC.BaseTheme.collectionRenderDelegate=SC.RenderDelegate.create({className:"collection",render:function(b,a){a.setClass("focus",b.get("hasFirstResponder"));a.setClass("disabled",!b.get("isEnabled"));a.setClass("active",b.get("isActive"))},update:function(b,a){a.setClass("focus",b.get("hasFirstResponder"));a.setClass("disabled",!b.get("isEnabled"));a.setClass("active",b.get("isActive"))}});SC.BaseTheme.disclosureRenderDelegate=SC.RenderDelegate.create({className:"disclosure",render:function(g,a){this.addSizeClassName(g,a);var f=g.get("theme"),d=g.get("value"),b=["sc-button-label","sc-disclosure-label"];var e=SC.guidFor(g)+"-label";a.attr("aria-expanded",d);a.attr("aria-labelledby",e);if(g.get("isSelected")){a.addClass("sel")}var c="";c+=g.get("isSelected")?"open":"closed";if(g.get("isActive")){c+=" active"}a.push('<img src = "'+SC.BLANK_IMAGE_URL+'" class = "disclosure button '+c+'" />');a=a.begin("span").addClass(b).id(e);f.labelRenderDelegate.render(g,a);a=a.end()},update:function(d,a){this.updateSizeClassName(d,a);var c=d.get("theme"),b=d.get("value");a.attr("aria-expanded",b);if(d.get("isSelected")){a.addClass("sel")}a.find("img").setClass({open:d.get("isSelected"),closed:!d.get("isSelected"),active:d.get("isActive")});c.labelRenderDelegate.update(d,a.find("span.sc-disclosure-label"))}});SC.THREE_SLICE=["left","middle","right"];SC.NINE_SLICE=["top-left","top","top-right","left","middle","right","bottom-left","bottom","bottom-right"];SC.RenderDelegate.reopen({includeSlices:function(e,c,d){for(var b=0,a=d.length;b<a;b++){c.push('<div class="'+d[b]+'"></div>')}}});SC.BaseTheme.imageButtonRenderDelegate=SC.RenderDelegate.create({className:"image-button",render:function(d,b){var c=d.get("image"),a=d.get("toolTip");this.addSizeClassName(d,b);b.addClass("no-min-width");if(a){b.attr("title",a);b.attr("alt",a)}if(c){b.push("<div class='img "+c+"'></div>")}else{b.push("<div class='img'></div>")}},update:function(d,b){var c,a;this.updateSizeClassName(d,b);if(d.didChangeFor("imageButtonRenderDelegate","toolTip")){a=d.get("toolTip");b.attr("title",a);b.attr("alt",a)}c=d.get("image");if(c&&d.didChangeFor("imageButtonRenderDelegate","image")){b.children()[0].className="img "+c}}});SC.BaseTheme.MASTER_DETAIL_DIVIDER_WIDTH=1;SC.BaseTheme.masterDetailRenderDelegate=SC.RenderDelegate.create({className:"master-detail",dividerWidth:1,render:function(b,a){a.setClass("round-toolbars",SC.platform.touch)},update:function(b,a){a.setClass("round-toolbars",SC.platform.touch)}});SC.BaseTheme.panelRenderDelegate=SC.RenderDelegate.create({className:"panel",render:function(e,b){b=b.begin("div").addClass("panel-background");this.includeSlices(e,b,SC.NINE_SLICE);b=b.end();var a=e.get("ariaLabel"),c=e.get("ariaLabelledBy"),d=e.get("ariaDescribedBy");if(a){b.attr("aria-label",a)}if(c){b.attr("aria-labelledby",c)}if(d){b.attr("aria-describedby",d)}},update:function(e,c){var a=e.get("ariaLabel"),b=e.get("ariaLabelledBy"),d=e.get("ariaDescribedBy");if(a){c.attr("aria-label",a)}if(b){c.attr("aria-labelledby",b)}if(d){c.attr("aria-describedby",d)}}});sc_require("render_delegates/panel");SC.BaseTheme.pickerRenderDelegate=SC.RenderDelegate.create({className:"picker",render:function(f,c){var a=f.get("theme").panelRenderDelegate;a.render(f,c);var b=f.get("preferType");var e=f.get("pointerPos");var d=f.get("pointerPosY");if(b==SC.PICKER_POINTER||b==SC.PICKER_MENU_POINTER){c.push('<div class="sc-pointer '+e+'" style="margin-top: '+d+'px"></div>');c.addClass(e)}},update:function(g,f){var a=g.get("theme").panelRenderDelegate;a.update(g,f);var b=g.get("preferType");var e=g.get("pointerPos");var d=g.get("pointerPosY");if(b==SC.PICKER_POINTER||b==SC.PICKER_MENU_POINTER){var c=f.find(".sc-pointer");c.attr("class","sc-pointer "+e);c.attr("style","margin-top: "+d+"px");f.addClass(e)}}});sc_require("render_delegates/picker");SC.BaseTheme.menuRenderDelegate=SC.BaseTheme.pickerRenderDelegate.create({className:"menu",render:function(c,b,a){this.addSizeClassName(b,a);c(b,a)}.enhance(),update:function(c,b,a){this.updateSizeClassName(b,a);c(b,a)}.enhance(),itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:6,menuWidthPadding:50,minimumMenuWidth:50,submenuOffsetX:2,verticalOffset:23,"sc-tiny-size":{itemHeight:10,itemSeparatorHeight:2,menuHeightPadding:2,submenuOffsetX:0},"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:4,submenuOffsetX:2},"sc-large-size":{itemHeight:60,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4},"sc-huge-size":{itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:0,submenuOffsetX:0}});SC.BaseTheme.popupButtonRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({render:function(b,a){a.attr("aria-haspopup","true");arguments.callee.base.apply(this,arguments)},update:function(b,a){arguments.callee.base.apply(this,arguments)}});SC.BaseTheme.PROGRESS_OFFSET=0.5;SC.BaseTheme.PROGRESS_OFFSET_RANGE=42;SC.BaseTheme.progressRenderDelegate=SC.RenderDelegate.create({className:"progress",render:function(h,c){this.addSizeClassName(h,c);var a=h.get("isIndeterminate"),g=h.get("theme"),b=h.get("maximum"),e=h.get("minimum"),d=h.get("ariaValue");var f;if(a){f=1}else{f=h.get("value")}c.attr("aria-valuemax",b);c.attr("aria-valuemin",e);c.attr("aria-valuenow",d);c.attr("aria-valuetext",d);c.setClass({indeterminate:a,running:h.get("isRunning")&&a,disabled:!h.get("isEnabled"),"sc-empty":(f<=0),"sc-complete":(f>=1&&!a)});c=c.begin("div").addClass("track");this.includeSlices(h,c,SC.THREE_SLICE);c=c.end();c=c.begin("div").addClass("content");c.css("width",(f*100)+"%");this.includeSlices(h,c,SC.THREE_SLICE);c=c.end()},update:function(a,b){this.updateSizeClassName(a,b);var e=a.get("theme"),j,k=a.get("maximum"),f=a.get("minimum"),c=a.get("ariaValue"),d=a.get("isIndeterminate"),l=a.get("isRunning"),h=a.get("isEnabled"),g=a.get("isVisibleInWindow");b.attr("aria-valuemax",k);b.attr("aria-valuemin",f);b.attr("aria-valuenow",c);b.attr("aria-valuetext",c);if(d){j=1}else{j=a.get("value")}b.setClass({indeterminate:d,running:l&&d,disabled:!h,"sc-empty":(j<=0),"sc-complete":(j>=1&&!d)});b.find(".content").css("width",(j*100)+"%");if(!SC.platform.supportsCSSTransitions){if(!this._queue[b[0].id]){this._queue[b[0].id]={offset:0,element:SC.$(b).find(".content .middle"),shouldAnimate:false}}if(d&&l&&g){this._queue[b[0].id].shouldAnimate=true;this.animate(a)}else{if(!d){this._queue[b[0].id].element.css("background-position","")}else{this._queue[b[0].id].shouldAnimate=false}}}},_queue:{},_animating:false,animate:function(b){var a=this;if(this._animating){return}function c(){var h,e,f,d=a._queue,k=0,g;var j;for(j in d){if(d.hasOwnProperty(j)){g=d[j];if(g.shouldAnimate){a._animating=true;k++;e=g.offset||0;h=(e+SC.BaseTheme.PROGRESS_OFFSET)%SC.BaseTheme.PROGRESS_OFFSET_RANGE;f=Math.round(h);if(f>Math.round(e)){g.element.css("background-position",f+"px 0px")}g.offset=h}}}if(k===0){a._animating=false}else{window.requestAnimationFrame(c)}}c()}});SC.BaseTheme.radioRenderDelegate=SC.RenderDelegate.create({className:"radio",render:function(f,b){if(f){this.addSizeClassName(f,b);var e=f.get("theme");var a=f.get("isSelected"),c=f.get("width"),d=SC.guidFor(f)+"-label";b.setClass({active:f.get("isActive"),mixed:f.get("isMixed"),sel:f.get("isSelected"),disabled:!f.get("isEnabled")});b.attr("role","radio");b.attr("aria-checked",a);b.attr("aria-labelledby",d);b.attr("aria-disabled",f.get("isEnabled")?"false":"true");if(c){b.css("width",c)}b.push('<span class = "button"></span>');b=b.begin("span").addClass("sc-button-label").id(d);e.labelRenderDelegate.render(f,b);b=b.end()}else{b.begin("span").removeClass("sc-button-label")}},update:function(f,a){this.updateSizeClassName(f,a);var e=f.get("theme");var b=f.get("isSelected"),c=f.get("width"),d=f.get("value");a.setClass({active:f.get("isActive"),mixed:f.get("isMixed"),sel:f.get("isSelected"),disabled:!f.get("isEnabled")});a.attr("aria-disabled",f.get("isEnabled")?"false":"true");a.attr("aria-checked",b);a.css("width",c?c:null);e.labelRenderDelegate.update(f,a.find(".sc-button-label"))}});SC.BaseTheme.radioGroupRenderDelegate=SC.RenderDelegate.create({className:"radio-group",render:function(h,e){this.addSizeClassName(h,e);var g=h.get("theme"),d=SC.guidFor(this),c=h.get("items"),b,a=c.length,f;e.addClass(h.get("layoutDirection"));e.attr("role","radiogroup");e.attr("aria-disabled",h.get("isEnabled")?"false":"true");for(b=0;b<a;b++){f=c[b];e=e.begin("div").addClass("radio-"+b).attr("index",b).addClass(g.classNames).addClass(g.radioRenderDelegate.className).addClass("sc-radio-button");g.radioRenderDelegate.render(f,e);e=e.end()}if(!a){g.radioRenderDelegate.render(null,e)}h.get("renderState").radioCount=b},update:function(a,d){this.updateSizeClassName(a,d);var e=a.get("theme"),b=SC.guidFor(this),g=a.get("items"),h,f=g.length,j;d.addClass(a.get("layoutDirection"));d.attr("aria-disabled",a.get("isEnabled")?"false":"true");if(a.get("renderState").radioCount!==f){var c=SC.RenderContext(d[0]);this.render(a,c);c.update();return}for(h=0;h<f;h++){j=g[h];e.radioRenderDelegate.update(j,d.find(".radio-"+h))}},updateRadioAtIndex:function(d,a,b){var c=d.get("items")[b];d.get("theme").radioRenderDelegate.update(c,a.find(".radio-"+b))},indexForEvent:function(d,b,a){var c=$(a.target).closest(".sc-radio-button").attr("index");if(isNaN(c)){return undefined}return parseInt(c,0)}});SC.BaseTheme.segmentRenderDelegate=SC.RenderDelegate.create({className:"segment",render:function(e,b){var c=e.get("theme"),d,a;a={"sc-first-segment":e.get("isFirstSegment"),"sc-middle-segment":e.get("isMiddleSegment"),"sc-last-segment":e.get("isLastSegment"),"sc-overflow-segment":e.get("isOverflowSegment"),vertical:e.get("layoutDirection")!==SC.LAYOUT_HORIZONTAL};if(!SC.none(e.get("index"))){a["sc-segment-"+e.get("index")]=YES}b.setClass(a);d=c.buttonRenderDelegate;d.render(e,b)},update:function(e,a){var c=e.get("theme"),d,b={};b={"sc-first-segment":e.get("isFirstSegment"),"sc-middle-segment":e.get("isMiddleSegment"),"sc-last-segment":e.get("isLastSegment"),"sc-overflow-segment":e.get("isOverflowSegment")||NO,vertical:e.get("layoutDirection")!==SC.LAYOUT_HORIZONTAL};if(!SC.none(e.get("index"))){b["sc-segment-"+e.get("index")]=YES}a.setClass(b);d=c.buttonRenderDelegate;d.update(e,a)}});SC.BaseTheme.segmentedRenderDelegate=SC.RenderDelegate.create({className:"segmented",render:function(b,a){this.addSizeClassName(b,a);a.addStyle("text-align",b.get("align"))},update:function(b,a){this.updateSizeClassName(b,a);a.css("text-align",b.get("align"))}});SC.BaseTheme.sliderRenderDelegate=SC.RenderDelegate.create({className:"slider",render:function(f,c){this.addSizeClassName(f,c);var b=SC.BLANK_IMAGE_URL,a=f.get("maximum"),e=f.get("minimum"),d=f.get("ariaValue");c.attr("aria-valuemax",a);c.attr("aria-valuemin",e);c.attr("aria-valuenow",d);if(e!==0||a!==100){c.attr("aria-valuetext",d)}c.attr("aria-orientation","horizontal");c=c.begin("span").addClass("track");this.includeSlices(f,c,SC.THREE_SLICE);c.push('<img src="'+b+'" class="sc-handle" style="left: '+f.get("value")+'%" /></span>');c=c.end();f.get("renderState")._cachedHandle=null},update:function(h,b){this.updateSizeClassName(h,b);var a=h.get("maximum"),d=h.get("minimum"),c=h.get("ariaValue");b.attr("aria-valuemax",a);b.attr("aria-valuemin",d);b.attr("aria-valuenow",c);if(d!==0||a!==100){b.attr("aria-valuetext",c)}b.attr("aria-orientation","horizontal");if(h.didChangeFor("sliderRenderDelegate","value")){var f=h.get("renderState")._cachedHandle;if(!f){f=h.get("renderState")._cachedHandle=b.find(".sc-handle")}var g=h.get("frame"),e=h.get("value");f.css("left",e+"%")}}});SC.BaseTheme.SourceList=SC.BaseTheme.subtheme("source-list");SC.BaseTheme.toolbarRenderDelegate=SC.RenderDelegate.create({className:"toolbar",render:function(b,a){},update:function(){}});SC.BaseTheme.wellRenderDelegate=SC.RenderDelegate.create({className:"well",render:function(b,a){this.includeSlices(b,a,SC.NINE_SLICE)},update:function(){}});SC.BaseTheme.workspaceRenderDelegate=SC.RenderDelegate.create({className:"workspace",render:function(){},update:function(){}});SC.DRAG_LINK=4;SC.DRAG_COPY=1;SC.DRAG_MOVE=2;SC.DRAG_NONE=0;SC.DRAG_ANY=15;SC.DRAG_DATA=8;SC.DRAG_AUTOSCROLL_ZONE_THICKNESS=20;SC.View.reopen({init:function(a){a();if(this.get("isDropTarget")){SC.Drag.addDropTarget(this)}if(this.get("isScrollable")){SC.Drag.addScrollableView(this)}}.enhance(),destroy:function(a){if(this.get("isDropTarget")){SC.Drag.removeDropTarget(this)}if(this.get("isScrollable")){SC.Drag.removeScrollableView(this)}return a()}.enhance()});SC.Drag=SC.Object.extend({source:null,ghostView:null,ghostActsLikeCursor:NO,dragView:null,ghost:YES,sourceIsDraggable:YES,slideBack:YES,ghostOffset:{x:0,y:0},location:{},dataTypes:function(){if(this.dataSource){return this.dataSource.get("dragDataTypes")||[]}var d=this.data;if(d){var a=[];for(var b in d){if(d.hasOwnProperty(b)){a.push(b)}}return a}var c=this.get("source");if(c&&c.dragDataTypes){return c.get("dragDataTypes")||[]}return[]}.property().cacheable(),hasDataType:function(a){return(this.get("dataTypes").indexOf(a)>=0)},dataForType:function(a){if(this.dataSource){return this.dataSource.dragDataForType(this,a)}else{if(this.data){return this.data[a]}else{var b=this.get("source");if(b&&SC.typeOf(b.dragDataForType)===SC.T_FUNCTION){return b.dragDataForType(this,a)}else{return null}}}},dataSource:null,data:null,allowedDragOperations:SC.DRAG_ANY,_dragInProgress:YES,_dragViewWasVisible:null,startDrag:function(){if(this.get("sourceIsDraggable")){this._createGhostView()}var h=this.event;var e={x:h.pageX,y:h.pageY};this.set("location",e);if(this.get("sourceIsDraggable")){var b=this._getDragView();var j=b.get("parentView");var g=j?j.convertFrameToView(b.get("frame"),null):b.get("frame");if(this.get("ghost")){this._dragViewWasVisible=b.get("isVisible");b.set("isVisible",NO)}if(this.ghostActsLikeCursor){this.ghostOffset={x:14,y:14}}else{this.ghostOffset={x:(e.x-g.x),y:(e.y-g.y)}}if(!this._ghostViewHidden){this._positionGhostView(h)}if(h.makeTouchResponder){var k=this;SC.Timer.schedule({target:h,action:function(){if(!h.hasEnded){h.makeTouchResponder(k,YES)}},interval:1})}else{this.ghostView.rootResponder.dragDidStart(this,h)}}var a=this.source;if(a&&a.dragDidBegin){a.dragDidBegin(this,e)}var c=this._dropTargets();for(var f=0,d=c.length;f<d;f++){c[f].tryToPerform("dragStarted",this,h)}},cancelDrag:function(){var b=this._lastTarget,c=this.get("location");if(b&&b.dragExited){b.dragExited(this,this._lastMouseDraggedEvent)}if(this.get("sourceIsDraggable")){this._destroyGhostView();if(this.get("ghost")){if(this._dragViewWasVisible){this._getDragView().set("isVisible",YES)}this._dragViewWasVisible=null}}var a=this.source;if(a&&a.dragDidEnd){a.dragDidEnd(this,c,SC.DRAG_NONE)}this._lastTarget=null;this._dragInProgress=NO},touchStart:function(a){return YES},mouseDragged:function(a){var b=this._autoscroll(a);var f=this.get("location");if(!b&&(a.pageX===f.x)&&(a.pageY===f.y)){return}f={x:a.pageX,y:a.pageY};this.set("location",f);this._lastMouseDraggedEvent=a;var d=this.source;var c=this._lastTarget;var e=this._findDropTarget(a);var g=SC.DRAG_NONE;while(e&&(e!==c)&&(g===SC.DRAG_NONE)){if(e&&d&&d.dragSourceOperationMaskFor){g=d.dragSourceOperationMaskFor(this,e)}else{g=SC.DRAG_ANY}if((g!==SC.DRAG_NONE)&&e&&e.computeDragOperations){g=g&e.computeDragOperations(this,a,g)}else{g=SC.DRAG_NONE}if(g===SC.DRAG_NONE){e=this._findNextDropTarget(e)}}if(e!==c){this.allowedDragOperations=g}if(e!==c){if(c&&c.dragExited){c.dragExited(this,a)}if(e){if(e.dragEntered){e.dragEntered(this,a)}if(e.dragUpdated){e.dragUpdated(this,a)}}this._lastTarget=e}else{if(e&&e.dragUpdated){e.dragUpdated(this,a)}}if(d&&d.dragDidMove){d.dragDidMove(this,f)}if(this.get("sourceIsDraggable")&&!this._ghostViewHidden){this._positionGhostView(a)}},touchesDragged:function(a){this.mouseDragged(a)},mouseUp:function(m){var g={x:m.pageX,y:m.pageY},h=this._lastTarget,d=this.allowedDragOperations;this.set("location",g);try{if(h&&h.acceptDragOperation&&h.acceptDragOperation(this,d)){d=h.performDragOperation?h.performDragOperation(this,d):SC.DRAG_NONE}else{d=SC.DRAG_NONE}}catch(j){SC.Logger.error("Exception in SC.Drag.mouseUp(acceptDragOperation|performDragOperation): %@".fmt(j))}try{if(h&&h.dragExited){h.dragExited(this,m)}}catch(k){SC.Logger.error("Exception in SC.Drag.mouseUp(target.dragExited): %@".fmt(k))}var c=this._dropTargets();for(var l=0,f=c.length;l<f;l++){try{c[l].tryToPerform("dragEnded",this,m)}catch(b){SC.Logger.error("Exception in SC.Drag.mouseUp(dragEnded on %@): %@".fmt(c[l],b))}}if(this.get("sourceIsDraggable")){this._destroyGhostView();if(this.get("ghost")){if(this._dragViewWasVisible){this._getDragView().set("isVisible",YES)}this._dragViewWasVisible=null}}var a=this.source;if(a&&a.dragDidEnd){a.dragDidEnd(this,g,d)}this._lastTarget=null;this._dragInProgress=NO},touchEnd:function(a){this.mouseUp(a)},_getDragView:function(){if(!this.dragView){if(!this.source||!this.source.isView){throw"Source can't be used as dragView, because it's not a view."}this.dragView=this.source}return this.dragView},_createGhostView:function(){var c=this,b=this._getDragView(),d=b.get("frame"),a;a=this.ghostView=SC.Pane.create({classNames:["sc-ghost-view"],layout:{top:d.y,left:d.x,width:d.width,height:d.height},owner:this,didCreateLayer:function(){if(b){var e=b.get("layer");if(e){e=e.cloneNode(true);e.style.top="0px";e.style.left="0px";this.get("layer").appendChild(e)}}}});a.append()},_positionGhostView:function(a){var c=this.get("location");c.x-=this.ghostOffset.x;c.y-=this.ghostOffset.y;var b=this.ghostView;if(b){b.adjust({top:c.y,left:c.x});b.invokeOnce("updateLayout")}},_ghostViewHidden:NO,hideGhostView:function(){if(this.ghostView&&!this._ghostViewHidden){this.ghostView.remove();this._ghostViewHidden=YES}},unhideGhostView:function(){if(this._ghostViewHidden){this._ghostViewHidden=NO;this._createGhostView()}},_destroyGhostView:function(){if(this.ghostView){this.ghostView.remove();this.ghostView=null;this._ghostViewHidden=NO}},_dropTargets:function(){if(this._cachedDropTargets){return this._cachedDropTargets}var b=[];var d=SC.Drag._dropTargets;for(var c in d){if(d.hasOwnProperty(c)){b.push(d[c])}}var f={};var e=SC.Drag._dropTargets;var a=function(g){if(!g){return 0}var j=SC.guidFor(g);var h=f[j];if(!h){h=1;while(g=g.get("parentView")){if(e[SC.guidFor(g)]!==undefined){h=h+1}if(g.isPane&&g.isMainPane){h=h+10000}}f[j]=h}return h};b.sort(function(h,g){if(h===g){return 0}h=a(h);g=a(g);return(h>g)?-1:1});this._cachedDropTargets=b;return b},_findDropTarget:function(c){var g={x:c.pageX,y:c.pageY};var e,f;var d=this._dropTargets();for(var b=0,a=d.length;b<a;b++){e=d[b];if(!e.get("isVisibleInWindow")){continue}f=e.convertFrameToView(e.get("clippingFrame"),null);if(SC.pointInRect(g,f)){return e}}return null},_findNextDropTarget:function(a){var b=SC.Drag._dropTargets;while(a=a.get("parentView")){if(b[SC.guidFor(a)]){return a}}return null},_autoscroll:function(m){if(!m){m=this._lastAutoscrollEvent}if(!this._dragInProgress){return NO}var g=m?{x:m.pageX,y:m.pageY}:this.get("location"),h=this._findScrollableView(g),n=null,l,c,d,j,b,a,e;while(h&&!n){l=h.get("canScrollVertical")?1:0;c=h.get("canScrollHorizontal")?1:0;if(l||c){a=h.get("containerView");if(a){e=h.convertFrameToView(a.get("frame"),null)}else{l=c=0}}if(l){j=SC.maxY(e);d=j-SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(g.y>=d&&g.y<=j){l=1}else{d=SC.minY(e);j=d+SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(g.y>=d&&g.y<=j){l=-1}else{l=0}}}if(c){j=SC.maxX(e);d=j-SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(g.x>=d&&g.x<=j){c=1}else{d=SC.minX(e);j=d+SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(g.x>=d&&g.x<=j){c=-1}else{c=0}}}if(l||c){n=h}else{h=this._findNextScrollableView(h)}}if(n&&(this._lastScrollableView===n)){if((Date.now()-this._hotzoneStartTime)>100){this._horizontalScrollAmount*=1.05;this._verticalScrollAmount*=1.05}}else{this._lastScrollableView=n;this._horizontalScrollAmount=15;this._verticalScrollAmount=15;this._hotzoneStartTime=(n)?Date.now():null;c=l=0}if(n&&(c||l)){var k={x:c*this._horizontalScrollAmount,y:l*this._verticalScrollAmount};n.scrollBy(k)}if(n){if(m){this._lastAutoscrollEvent={pageX:m.pageX,pageY:m.pageY}}this.invokeLater(this._autoscroll,100,null);return YES}else{this._lastAutoscrollEvent=null;return NO}},_scrollableViews:function(){if(this._cachedScrollableView){return this._cachedScrollableView}var a=[];var c=SC.Drag._scrollableViews;for(var b in c){if(c.hasOwnProperty(b)){a.push(c[b])}}a=a.sort(function(f,d){var e=f;while(e=e.get("parentView")){if(d===e){return -1}}return 1});this._cachedScrollableView=a;return a},_findScrollableView:function(f){var c=this._scrollableViews(),b=c?c.length:0,d,e,a;for(a=0;a<b;a++){d=c[a];if(!d.get("isVisibleInWindow")){continue}e=d.convertFrameToView(d.get("clippingFrame"),null);if(SC.pointInRect(f,e)){return d}}return null},_findNextScrollableView:function(a){var b=SC.Drag._scrollableViews;while(a=a.get("parentView")){if(b[SC.guidFor(a)]){return a}}return null}});SC.Drag.mixin({start:function(b){var a=this.create(b);a.startDrag();return a},_dropTargets:{},_scrollableViews:{},addDropTarget:function(a){this._dropTargets[SC.guidFor(a)]=a},removeDropTarget:function(a){delete this._dropTargets[SC.guidFor(a)]},addScrollableView:function(a){this._scrollableViews[SC.guidFor(a)]=a},removeScrollableView:function(a){delete this._scrollableViews[SC.guidFor(a)]}});SC.UndoManager=SC.Object.extend({undoActionName:function(){return this.undoStack?this.undoStack.name:null}.property("undoStack"),redoActionName:function(){return this.redoStack?this.redoStack.name:null}.property("redoStack"),canUndo:function(){return this.undoStack!=null}.property("undoStack"),canRedo:function(){return this.redoStack!=null}.property("redoStack"),undo:function(){this._undoOrRedo("undoStack","isUndoing")},redo:function(){this._undoOrRedo("redoStack","isRedoing")},isUndoing:NO,isRedoing:NO,groupingLevel:0,registerUndo:function(b,a){this.beginUndoGroup(a);this._activeGroup.actions.push(b);this.endUndoGroup(a)},beginUndoGroup:function(b){if(this._activeGroup){this.groupingLevel++}else{var a=this.isUndoing?"redoStack":"undoStack";this._activeGroup={name:b,actions:[],prev:this.get(a)};this.set(a,this._activeGroup);this.groupingLevel=1}},endUndoGroup:function(a){if(!this._activeGroup){raise("endUndoGroup() called outside group.")}if(this.groupingLevel>1){this.groupingLevel--}else{this._activeGroup=null;this.groupingLevel=0}this.propertyDidChange(this.isUndoing?"redoStack":"undoStack")},setActionName:function(a){if(!this._activeGroup){raise("setActionName() called outside group.")}this._activeGroup.name=a},_activeGroup:null,undoStack:null,redoStack:null,_undoOrRedo:function(a,c){if(this._activeGroup){return false}if(this.get(a)==null){return true}this.set(c,true);var e=this.get(a);this.set(a,e.prev);var b;var d=e.actions.length>1;if(d){this.beginUndoGroup(e.name)}while(b=e.actions.pop()){b()}if(d){this.endUndoGroup(e.name)}this.set(c,false)}});SC.CheckboxView=SC.ButtonView.extend(SC.StaticLayout,{classNames:["sc-checkbox-view","sc-checkbox-control"],ariaRole:"checkbox",themeName:null,renderDelegateName:"checkboxRenderDelegate",needsEllipsis:NO,acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),_toggleValue:function(){var a=this.get("value")===this.get("toggleOnValue");this.set("value",a?this.get("toggleOffValue"):this.get("toggleOnValue"))},mouseDown:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-checkbox-view")){return YES}this.set("isActive",YES);this._isMouseDown=YES;if(a&&this.get("acceptsFirstResponder")){a.allowDefault()}return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-checkbox-view")){return YES}this.set("isActive",NO);this._isMouseDown=NO;if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.$().within(a.target)){this._toggleValue();this._action(a)}}return YES},keyDown:function(b){if(!this.get("isEnabled")){return YES}if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(b.which===13||b.which===32){this._toggleValue();if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.$().within(b.target)){this._action(b)}}return YES}b.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)}});SC.LIST_ITEM_ACTION_CANCEL="sc-list-item-cancel-action";SC.LIST_ITEM_ACTION_REFRESH="sc-list-item-cancel-refresh";SC.LIST_ITEM_ACTION_EJECT="sc-list-item-cancel-eject";SC.ListItemView=SC.View.extend(SC.InlineEditable,SC.Control,{classNames:["sc-list-item-view"],displayProperties:["disclosureState","escapeHTML","isDropTarget"],content:null,contentIndex:null,hasContentIcon:NO,hasContentRightIcon:NO,hasContentBranch:NO,contentCheckboxKey:null,icon:null,isDropTarget:NO,contentIconKey:null,rightIcon:null,contentRightIconKey:null,contentValueKey:null,escapeHTML:YES,contentUnreadCountKey:null,contentIsBranchKey:null,outlineIndent:16,outlineLevel:0,disclosureState:SC.LEAF_NODE,validator:null,contentKeys:{contentValueKey:"title",contentCheckboxKey:"checkbox",contentIconKey:"icon",contentRightIconKey:"rightIcon",contentUnreadCountKey:"count",contentIsBranchKey:"branch"},contentPropertyDidChange:function(){if(this.get("contentIsEditable")!==this.contentIsEditable()){this.notifyPropertyChange("contentIsEditable")}this.displayDidChange()},contentIsEditable:function(){var a=this.get("content");return a&&(a.get?a.get("isEditable")!==NO:NO)}.property("content").cacheable(),inlineEditorDelegate:SC.InlineTextFieldDelegate,$label:function(){return this.$("label")},_isInsideElementWithClassName:function(e,a){var c=this.get("layer");if(!c){return NO}var d=SC.$(a.target);var b=NO;while(!b&&d.length>0&&(d[0]!==c)){if(d.hasClass(e)){b=YES}d=d.parent()}d=c=null;return b},_isInsideCheckbox:function(b){var a=this.displayDelegate;var c=this.getDelegateProperty("contentCheckboxKey",a);return c&&this._isInsideElementWithClassName("sc-checkbox-view",b)},_isInsideDisclosure:function(a){if(this.get("disclosureState")===SC.LEAF_NODE){return NO}return this._isInsideElementWithClassName("sc-disclosure-view",a)},_isInsideRightIcon:function(c){var b=this.displayDelegate;var a=this.getDelegateProperty("hasContentRightIcon",b)||!SC.none(this.rightIcon);return a&&this._isInsideElementWithClassName("right-icon",c)},mouseDown:function(a){if(!this.get("contentIsEditable")){return NO}if(this._isInsideCheckbox(a)){this._addCheckboxActiveState();this._isMouseDownOnCheckbox=YES;this._isMouseInsideCheckbox=YES;return YES}else{if(this._isInsideDisclosure(a)){this._addDisclosureActiveState();this._isMouseDownOnDisclosure=YES;this._isMouseInsideDisclosure=YES;return YES}else{if(this._isInsideRightIcon(a)){this._addRightIconActiveState();this._isMouseDownOnRightIcon=YES;this._isMouseInsideRightIcon=YES;return YES}}}return NO},mouseUp:function(h){var c=NO,j,d,b,a,g,f;if(this._isMouseDownOnCheckbox){if(this._isInsideCheckbox(h)){j=this.displayDelegate;d=this.getDelegateProperty("contentCheckboxKey",j);b=this.get("content");if(b&&b.get){var e=b.get(d);e=(e===SC.MIXED_STATE)?YES:!e;b.set(d,e);this.displayDidChange()}}this._removeCheckboxActiveState();c=YES}else{if(this._isMouseDownOnDisclosure){if(this._isInsideDisclosure(h)){a=this.get("disclosureState");g=this.get("contentIndex");f=(!SC.none(g))?SC.IndexSet.create(g):null;j=this.get("displayDelegate");if(a===SC.BRANCH_OPEN){if(f&&j&&j.collapse){j.collapse(f)}else{this.set("disclosureState",SC.BRANCH_CLOSED)}this.displayDidChange()}else{if(a===SC.BRANCH_CLOSED){if(f&&j&&j.expand){j.expand(f)}else{this.set("disclosureState",SC.BRANCH_OPEN)}this.displayDidChange()}}}this._removeDisclosureActiveState();c=YES}else{if(this._isMouseDownOnRightIcon){this._removeRightIconActiveState();c=YES}}}this._isMouseInsideCheckbox=this._isMouseDownOnCheckbox=NO;this._isMouseDownOnDisclosure=this._isMouseInsideDisclosure=NO;this._isMouseInsideRightIcon=this._isMouseDownOnRightIcon=NO;return c},mouseMoved:function(a){if(this._isMouseDownOnCheckbox&&this._isInsideCheckbox(a)){this._addCheckboxActiveState();this._isMouseInsideCheckbox=YES}else{if(this._isMouseDownOnCheckbox){this._removeCheckboxActiveState();this._isMouseInsideCheckbox=NO}else{if(this._isMouseDownOnDisclosure&&this._isInsideDisclosure(a)){this._addDisclosureActiveState();this._isMouseInsideDisclosure=YES}else{if(this._isMouseDownOnDisclosure){this._removeDisclosureActiveState();this._isMouseInsideDisclosure=NO}else{if(this._isMouseDownOnRightIcon&&this._isInsideRightIcon(a)){this._addRightIconActiveState();this._isMouseInsideRightIcon=YES}else{if(this._isMouseDownOnRightIcon){this._removeRightIconActiveState();this._isMouseInsideRightIcon=NO}}}}}}return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},touchEntered:function(a){return this.mouseEntered(a)},touchExited:function(a){return this.mouseExited(a)},_addCheckboxActiveState:function(){if(this.get("isEnabled")){if(this._checkboxRenderDelegate){var a=this._checkboxRenderSource;a.set("isActive",YES);this._checkboxRenderDelegate.update(a,this.$(".sc-checkbox-view"))}else{this.$(".sc-checkbox-view").addClass("active")}}},_removeCheckboxActiveState:function(){if(this._checkboxRenderer){var a=this._checkboxRenderSource;a.set("isActive",NO);this._checkboxRenderDelegate.update(a,this.$(".sc-checkbox-view"))}else{this.$(".sc-checkbox-view").removeClass("active")}},_addDisclosureActiveState:function(){if(this.get("isEnabled")){if(this._disclosureRenderDelegate){var a=this._disclosureRenderSource;a.set("isActive",YES);this._disclosureRenderDelegate.update(a,this.$(".sc-disclosure-view"))}else{this.$(".sc-disclosure-view").addClass("active")}}},_removeDisclosureActiveState:function(){if(this._disclosureRenderer){var a=this._disclosureRenderSource;a.set("isActive",NO);this._disclosureRenderDelegate.update(a,this.$(".sc-disclosure-view"))}else{this.$(".sc-disclosure-view").addClass("active")}},_addRightIconActiveState:function(){this.$("img.right-icon").setClass("active",YES)},_removeRightIconActiveState:function(){this.$("img.right-icon").removeClass("active")},contentHitTest:function(b){var a=this.displayDelegate;var c=this.getDelegateProperty("contentValueKey",a);if(!c){return NO}var e=this.$label()[0];if(!e){return NO}var f=b.target,d=this.get("layer");while(f&&(f!==d)&&(f!==window)){if(f===e){return YES}f=f.parentNode}return NO},beginEditing:function(d,c){var f=this.$label(),e=this.get("parentView");if(c&&this.scrollToVisible()){var b=this.get("owner"),a=this.get("contentIndex");this.invokeLast(function(){var g=b.itemViewForContentIndex(a);if(g&&g.beginEditing){g.beginEditing(NO)}});return YES}else{if(!e||!f||f.get("length")===0){return NO}else{return d()}}}.enhance(),inlineEditorWillBeginEditing:function(d,p,o){var q=this.get("content"),j=this.get("displayDelegate"),h=this.getDelegateProperty("contentValueKey",j),k=this.get("parentView"),a=this.$label(),e=this.get("validator"),t,l,g,b,m,c,n,u,s,w;l=(h&&q)?(q.get?q.get(h):q[h]):q;t=this.computeFrameWithParentFrame(null);c=this._oldLineHeight=a.css("lineHeight");b=a.css("fontSize");m=this.$().css("top");if(m){m=parseInt(m.substring(0,m.length-2),0)}else{m=0}u=0;if(b&&c){s=b*1.5;if(s<c){a.css({lineHeight:"1.5"});u=(c-s)/2}else{oldLineHeight=null}}a=a[0];g=SC.offset(a);t.x=g.x;t.y=g.y+m+u;t.height=a.offsetHeight;t.width=a.offsetWidth;n=this.get("escapeHTML");d.set({value:l,exampleFrame:t,exampleElement:a,multiline:NO,isCollection:YES,validator:e,escapeHTML:n})},inlineEditorShouldBeginEditing:function(a){return YES},inlineEditorDidBeginEditing:function(b,d,e,a){b(d,e,a);var c=this.$label();this._oldOpacity=c.css("opacity");c.css("opacity",0);if(this._oldLineHeight){c.css({lineHeight:this._oldLineHeight})}}.enhance(),inlineEditorDidCommitEditing:function(d,f,c){var e=this.get("content");var a=this.displayDelegate;var b=this.getDelegateProperty("contentValueKey",a);if(b&&e){if(e.set){e.set(b,f)}else{e[b]=f}}else{this.set("content",f)}this.displayDidChange();this._endEditing()},_endEditing:function(a){this.$label().css("opacity",this._oldOpacity);a()}.enhance(),render:function(c,a){var f=this.get("content"),n=this.displayDelegate,b=this.get("outlineLevel"),e=this.get("outlineIndent"),m,k,j,o=[];o.push((this.get("contentIndex")%2===0)?"even":"odd");c.setClass("disabled",!this.get("isEnabled"));c.setClass("drop-target",this.get("isDropTarget"));j=c.begin("div").addClass("sc-outline");if(b>=0&&e>0){j.addStyle("left",e*(b+1))}k=this.get("disclosureState");if(k!==SC.LEAF_NODE){this.renderDisclosure(j,k);o.push("has-disclosure")}m=this.getDelegateProperty("contentCheckboxKey",n);if(m){k=f?(f.get?f.get(m):f[m]):NO;if(k!==null){this.renderCheckbox(j,k);o.push("has-checkbox")}}if(this.getDelegateProperty("hasContentIcon",n)){m=this.getDelegateProperty("contentIconKey",n);k=(m&&f)?(f.get?f.get(m):f[m]):null;if(k){this.renderIcon(j,k);o.push("has-icon")}}else{if(this.get("icon")){k=this.get("icon");this.renderIcon(j,k);o.push("has-icon")}}m=this.getDelegateProperty("contentValueKey",n);k=(m&&f)?(f.get?f.get(m):f[m]):f;if(k&&SC.typeOf(k)!==SC.T_STRING){k=k.toString()}if(this.get("escapeHTML")){k=SC.RenderContext.escapeHTML(k)}this.renderLabel(j,k);if(this.getDelegateProperty("hasContentRightIcon",n)){m=this.getDelegateProperty("contentRightIconKey",n);k=(m&&f)?(f.get?f.get(m):f[m]):null;this.renderRightIcon(j,k);o.push("has-right-icon")}m=this.getDelegateProperty("contentUnreadCountKey",n);k=(m&&f)?(f.get?f.get(m):f[m]):null;if(!SC.none(k)&&(k!==0)){this.renderCount(j,k);var d=["zero","one","two","three","four","five"];var l=k.toString().length;var h=d.length;var g=(l<h)?d[l]:d[h-1];o.push("has-count "+g+"-digit")}m=this.getDelegateProperty("listItemActionProperty",n);k=(m&&f)?(f.get?f.get(m):f[m]):null;if(k){this.renderAction(j,k);o.push("has-action")}if(this.getDelegateProperty("hasContentBranch",n)){m=this.getDelegateProperty("contentIsBranchKey",n);k=(m&&f)?(f.get?f.get(m):f[m]):NO;this.renderBranch(j,k);o.push("has-branch")}c.addClass(o);c=j.end()},renderDisclosure:function(a,d){var c=this.get("theme").disclosureRenderDelegate;a=a.begin("div").addClass("sc-disclosure-view").addClass("sc-regular-size").addClass(this.get("theme").classNames).addClass(c.get("className"));var b=this._disclosureRenderSource;if(!b){this._disclosureRenderSource=b=SC.Object.create({renderState:{},theme:this.get("theme")})}b.set("isSelected",d===SC.BRANCH_OPEN).set("isEnabled",this.get("isEnabled")).set("title","");c.render(b,a);a=a.end();this._disclosureRenderDelegate=c},renderCheckbox:function(a,d){var c=this.get("theme").checkboxRenderDelegate;a=a.begin("div").addClass("sc-checkbox-view").addClass("sc-regular-size").addClass(this.get("theme").classNames).addClass(c.get("className"));var b=this._checkboxRenderSource;if(!b){b=this._checkboxRenderSource=SC.Object.create({renderState:{},theme:this.get("theme")})}b.set("isSelected",d&&(d!==SC.MIXED_STATE)).set("isEnabled",this.get("isEnabled")&&this.get("contentIsEditable")).set("isActive",this._checkboxIsActive).set("title","");c.render(b,a);a=a.end();this._checkboxRenderDelegate=c},renderIcon:function(c,e){var b=null,d=null,a=[];if(e&&SC.ImageView.valueIsUrl(e)){b=e;d=""}else{d=e;b=SC.BLANK_IMAGE_URL}a.push(d,"icon");c.begin("img").addClass(a).attr("src",b).end()},renderLabel:function(b,a){b.push("<label>",a||"","</label>")},renderRightIcon:function(c,e){var b=null,d=null,a=[];if(e&&SC.ImageView.valueIsUrl(e)){b=e;d=""}else{d=e;b=SC.BLANK_IMAGE_URL}a.push("right-icon",d);c.begin("img").addClass(a).attr("src",b).end()},renderCount:function(a,b){a.push('<span class="count"><span class="inner">',b.toString(),"</span></span>")},renderAction:function(a,b){a.push('<img src="',SC.BLANK_IMAGE_URL,'" class="action" />')},renderBranch:function(c,b){var a=[];a.push("branch",b?"branch-visible":"branch-hidden");c.begin("span").addClass(a).push("&nbsp;").end()}});SC.ListItemView._deprecatedRenderWarningHasBeenIssued=false;sc_require("mixins/collection_view_delegate");sc_require("views/list_item");SC.DRAG_REORDER=16;SC.BENCHMARK_RELOAD=NO;SC.CollectionView=SC.View.extend(SC.CollectionViewDelegate,SC.CollectionContent,{classNames:["sc-collection-view"],displayProperties:["hasFirstResponder","isEnabled","isActive"],renderDelegateName:"collectionRenderDelegate",ACTION_DELAY:200,useFastPath:NO,content:null,contentBindingDefault:SC.Binding.multiple(),length:0,nowShowing:function(){return this.computeNowShowing()}.property("length","clippingFrame").cacheable(),selection:null,isSelectable:YES,isSelectableBindingDefault:SC.Binding.bool(),isEnabled:YES,isEnabledBindingDefault:SC.Binding.bool(),isEditable:YES,isEditableBindingDefault:SC.Binding.bool(),canReorderContent:NO,canReorderContentBindingDefault:SC.Binding.bool(),canDeleteContent:NO,canDeleteContentBindingDefault:SC.Binding.bool(),canEditContent:NO,canEditContentBindingDefault:SC.Binding.bool(),isDropTarget:NO,useToggleSelection:NO,actOnSelect:NO,selectOnMouseDown:YES,exampleView:SC.ListItemView,contentExampleViewKey:null,groupExampleView:null,contentGroupExampleViewKey:null,action:null,target:null,contentValueKey:null,acceptsFirstResponder:NO,isActive:NO,calculatedHeight:0,calculatedWidth:0,computeLayout:function(){return null},layoutForContentIndex:function(a){return null},allContentIndexes:function(){return SC.IndexSet.create(0,this.get("length")).freeze()}.property("length").cacheable(),contentIndexesInRect:function(a){return null},computeNowShowing:function(){var c=this.contentIndexesInRect(this.get("clippingFrame"));if(!c){c=this.get("allContentIndexes")}else{var b=this.get("length"),a=c.get("max");if(a>b){c=c.copy().remove(b,a-b).freeze()}}return c},showInsertionPoint:function(a,b){},hideInsertionPoint:function(){},delegate:null,selectionDelegate:function(){var a=this.get("delegate"),b=this.get("content");return this.delegateFor("isCollectionViewDelegate",a,b)}.property("delegate","content").cacheable(),contentDelegate:function(){var a=this.get("delegate"),b=this.get("content");return this.delegateFor("isCollectionContent",a,b)}.property("delegate","content").cacheable(),_contentGroupIndexes:function(){return this.get("contentDelegate").contentGroupIndexes(this,this.get("content"))}.property("contentDelegate","content").cacheable(),contentRangeDidChange:function(d,b,c,a){if(!b&&(c==="[]")){this.notifyPropertyChange("_contentGroupIndexes");this.reload(a)}else{this.contentPropertyDidChange(b,c,a)}},contentPropertyDidChange:function(c,b,a){},updateContentRangeObserver:function(){var d=this.get("nowShowing"),a=this._cv_contentRangeObserver,c=this.get("content");if(!c){return}if(a){c.updateRangeObserver(a,d)}else{var b=this.contentRangeDidChange;a=c.addRangeObserver(d,this,b,null);this._cv_contentRangeObserver=a}},removeContentRangeObserver:function(){var b=this.get("content"),a=this._cv_contentRangeObserver;if(a){if(b){b.removeRangeObserver(a)}this._cv_contentRangeObserver=null}},contentLengthDidChange:function(){var a=this.get("content");this.set("length",a?a.get("length"):0);this.computeLayout()},_cv_contentDidChange:function(){var b=this.get("content"),a=this.contentLengthDidChange;if(b===this._content){return}this.removeContentRangeObserver();if(this._content){this._content.removeObserver("length",this,a)}this._content=b;if(b){b.addObserver("length",this,a)}this.contentLengthDidChange();this.contentRangeDidChange(b,null,"[]",null)}.observes("content"),_invalidIndexes:NO,reload:function(a){var b=this._invalidIndexes;if(a&&b!==YES){if(b){b.add(a)}else{b=this._invalidIndexes=a.clone()}}else{this._invalidIndexes=YES}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}return this},reloadIfNeeded:function(){var y=this._invalidIndexes;if(!y||!this.get("isVisibleInWindow")){return this}this._invalidIndexes=NO;var v=this.get("content"),w,x,n,B=this.computeLayout(),z=SC.BENCHMARK_RELOAD,c=this.get("nowShowing"),C=this._sc_itemViews,o=this.get("containerView")||this,a,s,u,t,l,p,h,q,e,m,k,D,d,b,g,j,f;if(y.isIndexSet&&y.contains(c)){y=YES}if(this.willReload){this.willReload(y===YES?null:y)}a=this.get("exampleView");u=a?a.isReusableInCollections:NO;s=this.get("groupExampleView");t=s?s.isReusableInCollections:NO;if(y.isIndexSet){if(z){SC.Benchmark.start(z="%@#reloadIfNeeded (Partial)".fmt(this),YES)}p=[];h=[];q=[];y.forEach(function(E){n=C?C[E]:null;if(c.contains(E)){if(n&&n.parentView===o){h.push(E)}else{q.push(E)}}else{if(n&&n.parentView===o){p.push(E)}}},this);for(w=0,x=p.length;w<x;++w){m=p[w];n=C?C[m]:null;delete C[m];g=this.get("contentDelegate");j=this.get("_contentGroupIndexes");f=j&&j.contains(m);if(f){f=g.contentIndexIsGroup(this,v,m)}l=f?t:u;if(l){b=f?this._GROUP_VIEW_POOL:this._VIEW_POOL;b.push(n);n.destroyLayer()}D=n.get("layer");if(D&&D.parentNode){D.parentNode.removeChild(D)}o.removeChild(n);if(!l){n.destroy()}}for(w=0,x=h.length;w<x;++w){m=h[w];n=C?C[m]:null;k=this.itemViewForContentIndex(m,YES);n.destroyLayer();o.replaceChild(k,n)}for(w=0,x=q.length;w<x;++w){m=q[w];k=this.itemViewForContentIndex(m,YES);o.insertBefore(k,null)}if(z){SC.Benchmark.end(z)}}else{if(z){SC.Benchmark.start(z="%@#reloadIfNeeded (Full)".fmt(this),YES)}if(C){C.length=0}e=o.get("childViews");if(e){e=e.copy()}o.beginPropertyChanges();if(this.willRemoveAllChildren){this.willRemoveAllChildren()}o.destroyLayer().removeAllChildren();if(e){for(w=0,x=e.length;w<x;++w){k=e[w];f=k.get("isGroupView");l=f?t:u;if(l){b=f?this._GROUP_VIEW_POOL:this._VIEW_POOL;b.push(k);k.destroyLayer()}else{k.destroy()}}}e=[];c.forEach(function(E){e.push(this.itemViewForContentIndex(E,YES))},this);o.set("childViews",e);o.replaceLayer();o.endPropertyChanges();if(z){SC.Benchmark.end(z)}}if(B){this.adjust(B)}if(this.didReload){this.didReload(y===YES?null:y)}return this},_TMP_ATTRS:{},_COLLECTION_CLASS_NAMES:["sc-collection-item"],_GROUP_COLLECTION_CLASS_NAMES:["sc-collection-item","sc-group-item"],_VIEW_POOL:null,_GROUP_VIEW_POOL:null,itemViewForContentIndex:function(m,a){var x;var w=this._sc_itemViews;if(!w){w=this._sc_itemViews=[]}else{if(!a&&(x=w[m])){return x}}var o=this.get("content"),q=o.objectAt(m),h=this.get("contentDelegate"),k=this.get("_contentGroupIndexes"),j=NO,y,l,s,f,t,d,b,c,v,g,e,p,u;j=k&&k.contains(m);if(j){j=h.contentIndexIsGroup(this,o,m)}if(j){y=this.get("contentGroupExampleViewKey");if(y&&q){l=q.get(y)}if(!l){l=this.get("groupExampleView")||this.get("exampleView")}t="_GROUP_VIEW_POOL"}else{y=this.get("contentExampleViewKey");if(y&&q){l=q.get(y)}if(!l){l=this.get("exampleView")}t="_VIEW_POOL"}c=this.get("containerView")||this;f=this.layerIdFor(m);v=h.contentIndexIsEnabled(this,o,m);g=h.contentIndexIsSelected(this,o,m);e=h.contentIndexOutlineLevel(this,o,m);p=h.contentIndexDisclosureState(this,o,m);u=this.isVisibleInWindow;s=this.layoutForContentIndex(m);if(l&&l.isReusableInCollections){d=this[t];if(!d){d=this[t]=[]}if(d.length>0){x=d.pop();b=x.prepareForReuse;if(b){b.call(x)}x.beginPropertyChanges();x.set("contentIndex",m);x.set("layerId",f);x.set("isEnabled",v);x.set("isSelected",g);x.set("outlineLevel",e);x.set("disclosureState",p);x.set("isVisibleInWindow",u);x.set("parentView",c);SC.View.views[f]=x;if(s){x.set("layout",s)}else{x.set("layout",l.prototype.layout)}x.set("content",q);x.endPropertyChanges()}}if(!x){var n=this._TMP_ATTRS;n.contentIndex=m;n.content=q;n.owner=n.displayDelegate=this;n.parentView=c;n.page=this.page;n.layerId=f;n.isEnabled=v;n.isSelected=g;n.outlineLevel=e;n.disclosureState=p;n.isGroupView=j;n.isVisibleInWindow=u;if(j){n.classNames=this._GROUP_COLLECTION_CLASS_NAMES}else{n.classNames=this._COLLECTION_CLASS_NAMES}if(s){n.layout=s}else{delete n.layout}x=this.createItemView(l,m,n)}w[m]=x;return x},itemViewForContentObject:function(a){return this.itemViewForContentIndex(this.get("content").indexOf(a))},_TMP_LAYERID:[],createItemView:function(c,a,b){return c.create(b)},layerIdFor:function(a){var b=this._TMP_LAYERID;b[0]=SC.guidFor(this);b[1]=a;return b.join("-")},contentIndexForLayerId:function(c){if(!c||!(c=c.toString())){return null}var b=this._baseLayerId;if(!b){b=this._baseLayerId=SC.guidFor(this)+"-"}if((c.length<=b.length)||(c.indexOf(b)!==0)){return null}var a=Number(c.slice(c.lastIndexOf("-")+1));return isNaN(a)?null:a},itemViewForEvent:function(k){var d=this.getPath("pane.rootResponder");if(!d){return null}var c=SC.guidFor(this)+"-",a=c.length,e=k.target,g=this.get("layer"),f=null,b,j,h;while(e&&e!==document&&e!==g){b=e?SC.$(e).attr("id"):null;if(b&&(f=this.contentIndexForLayerId(b))!==null){break}e=e.parentNode}if(f===null||(e===g)){e=g=null;return null}if(f>=this.get("length")){throw"layout for item view %@ was found when item view does not exist (%@)".fmt(b,this)}return this.itemViewForContentIndex(f)},expand:function(b){if(!b){return this}var a=this.get("contentDelegate"),c=this.get("content");b.forEach(function(d){var e=a.contentIndexDisclosureState(this,c,d);if(e===SC.BRANCH_CLOSED){a.contentIndexExpand(this,c,d)}},this);return this},collapse:function(b){if(!b){return this}var a=this.get("contentDelegate"),c=this.get("content");b.forEach(function(d){var e=a.contentIndexDisclosureState(this,c,d);if(e===SC.BRANCH_OPEN){a.contentIndexCollapse(this,c,d)}},this);return this},_cv_selectionDidChange:function(){var c=this.get("selection"),b=this._cv_selection,a=this._cv_selectionContentDidChange;if(c===b){return}if(b){b.removeObserver("[]",this,a)}if(c){c.addObserver("[]",this,a)}this._cv_selection=c;this._cv_selectionContentDidChange()}.observes("selection"),_cv_selectionContentDidChange:function(){var c=this.get("selection"),b=this._cv_selindexes,a=this.get("content"),d;this._cv_selindexes=c?c.frozenCopy():null;if(b){b=b.indexSetForSource(a)}if(c){c=c.indexSetForSource(a)}if(c&&b){d=c.without(b).add(b.without(c))}else{d=c||b}if(d&&d.get("length")>0){this.reloadSelectionIndexes(d)}},_invalidSelection:NO,reloadSelectionIndexes:function(a){var b=this._invalidSelection;if(a&&(b!==YES)){if(b){b.add(a)}else{b=this._invalidSelection=a.copy()}}else{this._invalidSelection=YES}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadSelectionIndexesIfNeeded)}return this},reloadSelectionIndexesIfNeeded:function(){var e=this._invalidSelection;if(!e||!this.get("isVisibleInWindow")){return this}var d=this.get("nowShowing"),b=this._invalidIndexes,a=this.get("content"),c=this.get("selection");this._invalidSelection=NO;if(b===YES||!d){return this}if(e===YES){e=d}if(b&&b.isIndexSet){e=e.without(b)}e.forEach(function(f){if(!d.contains(f)){return}var g=this.itemViewForContentIndex(f,NO);if(g){g.set("isSelected",c?c.contains(a,f):NO)}},this);return this},select:function(c,f){var d=this.get("content"),a=this.get("selectionDelegate"),b=this.get("_contentGroupIndexes"),e;if(!this.get("isSelectable")||!this.get("isEnabled")){return this}if(SC.typeOf(c)===SC.T_NUMBER){c=SC.IndexSet.create(c,1)}if(c&&c.get("length")>0){if(b&&b.get("length")>0){c=c.copy().remove(b)}c=a.collectionViewShouldSelectIndexes(this,c,f);if(!c||c.get("length")===0){return this}}else{c=null}if(f&&(e=this.get("selection"))){e=e.copy()}else{e=SC.SelectionSet.create()}if(c&&c.get("length")>0){if(c.get("length")===1){e.addObject(d.objectAt(c.get("firstObject")))}else{e.add(d,c)}}e=a.collectionViewSelectionForProposedSelection(this,e);if(!e){e=SC.SelectionSet.create()}this._selectionAnchor=null;this.set("selection",e.freeze());return this},deselect:function(b){var d=this.get("selection"),c=this.get("content"),a=this.get("selectionDelegate");if(!this.get("isSelectable")||!this.get("isEnabled")){return this}if(!d||d.get("length")===0){return this}if(SC.typeOf(b)===SC.T_NUMBER){b=SC.IndexSet.create(b,1)}b=a.collectionViewShouldDeselectIndexes(this,b);if(!b||b.get("length")===0){return this}d=d.copy().remove(c,b);d=a.collectionViewSelectionForProposedSelection(this,d);if(!d){d=SC.SelectionSet.create()}this.set("selection",d.freeze());return this},_findNextSelectableItemFromIndex:function(h,a){var c=this.get("length"),d=SC.IndexSet.create(),e=this.get("content"),j=this.get("selectionDelegate"),g=this.get("_contentGroupIndexes"),f,b;if(!g&&(j.collectionViewShouldSelectIndexes===this.collectionViewShouldSelectIndexes)){return h}while(h<c){if(!g||!g.contains(h)){d.add(h);f=j.collectionViewShouldSelectIndexes(this,d);if(f&&f.get("length")>=1){return h}d.remove(h)}h++}if(a===undefined){b=this.get("selection");a=b?b.get("max"):-1}return a},_findPreviousSelectableItemFromIndex:function(b,h){var c=SC.IndexSet.create(),f=this.get("content"),a=this.get("selectionDelegate"),e=this.get("_contentGroupIndexes"),d;if(SC.none(b)){b=-1}if(!e&&(a.collectionViewShouldSelectIndexes===this.collectionViewShouldSelectIndexes)){return b}while(b>=0){if(!e||!e.contains(b)){c.add(b);d=a.collectionViewShouldSelectIndexes(this,c);if(d&&d.get("length")>=1){return b}c.remove(b)}b--}if(h===undefined){var g=this.get("selection");h=g?g.get("min"):-1}if(SC.none(h)){h=-1}return h},selectPreviousItem:function(h,b){if(SC.none(b)){b=1}if(SC.none(h)){h=false}var f=this.get("selection"),e=this.get("content");if(f){f=f.indexSetForSource(e)}var g=f?f.get("min"):-1,a=f?f.get("max")-1:-1,d=this._selectionAnchor;if(SC.none(d)){d=g}if(h){if(a>d){a=a-b}else{g=this._findPreviousSelectableItemFromIndex(g-b)}if(SC.none(g)||(g<0)){g=0}if(!e.objectAt(g)){g=f?f.get("min"):-1}if(a<g){a=g}}else{g=this._findPreviousSelectableItemFromIndex(g-b);if(SC.none(g)||(g<0)){g=0}if(!e.objectAt(g)){g=f?f.get("min"):-1}a=g;d=null}var c=g;f=SC.IndexSet.create(g,a+1-g);this.scrollToContentIndex(c);this.select(f);this._selectionAnchor=d;return this},selectNextItem:function(h,j){if(SC.none(j)){j=1}if(SC.none(h)){h=false}var b=this.get("selection"),g=this.get("content");if(b){b=b.indexSetForSource(g)}var a=b?b.get("min"):-1,d=b?b.get("max")-1:-1,e=this._selectionAnchor,c=this.get("length");if(SC.none(e)){e=a}if(h){if(a<e){a=a+j}else{d=this._findNextSelectableItemFromIndex(d+j,d)}if(d>=c){d=c-1}if(!g.objectAt(d)){d=b?b.get("max")-1:-1}if(a>d){a=d}}else{d=this._findNextSelectableItemFromIndex(d+j,d);if(d>=c){d=c-1}if(!g.objectAt(d)){d=b?b.get("max")-1:-1}a=d;e=null}var f=d;b=SC.IndexSet.create(a,d-a+1);this.scrollToContentIndex(f);this.select(b);this._selectionAnchor=e;return this},deleteSelection:function(){if(!this.get("canDeleteContent")){return NO}var d=this.get("selection"),c=this.get("content"),a=this.get("selectionDelegate"),b=d&&c?d.indexSetForSource(c):null;if(!c||!b||b.get("length")===0){return NO}b=a.collectionViewShouldDeleteIndexes(this,b);if(!b||b.get("length")===0){return NO}a.collectionViewDeleteContent(this,this.get("content"),b);return YES},scrollToContentIndex:function(b){var a=this.itemViewForContentIndex(b);if(a){this.scrollToItemView(a)}return this},scrollToItemView:function(a){if(a){a.scrollToVisible()}return this},keyDown:function(a){var b=this.interpretKeyEvents(a);return !b?NO:b},keyUp:function(){return true},insertText:function(b,a){if(b===" "){var c=this.get("selection");if(c&&c.get("length")>0){this.invokeLater(this._cv_action,0,null,a)}return YES}else{return NO}},selectAll:function(a){var b=this.get("content"),c=b?SC.IndexSet.create(0,b.get("length")):null;this.select(c,NO);return YES},deselectAll:function(){var a=this.get("content"),b=a?SC.IndexSet.create(0,a.get("length")):null;this.deselect(b,NO);return YES},deleteBackward:function(a){return this.deleteSelection()},deleteForward:function(a){return this.deleteSelection()},moveDown:function(b,a){this.selectNextItem(false,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveUp:function(b,a){this.selectPreviousItem(false,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveLeft:function(l){if(l.ctrlKey||l.metaKey){return NO}if((this.get("itemsPerRow")||1)>1){this.selectPreviousItem(false,1);this._cv_performSelectAction(null,l,this.ACTION_DELAY)}else{var c=this.get("selection"),j=this.get("content"),g=c?c.indexSetForSource(j):null;if(g){var m=undefined,f=false,h=undefined;if(g.get("length")===1){h=g.get("firstObject");m=this.get("contentDelegate");var b=m.contentIndexDisclosureState(this,j,h);if(b!==SC.BRANCH_OPEN){f=true}}if(f){var a=m.contentIndexOutlineLevel(this,j,h)-1;if(a>=0){var e=-1;while(e<0){var d=this._findPreviousSelectableItemFromIndex(h-1);if(d<0){return false}h=d;var k=m.contentIndexOutlineLevel(this,j,h);if(k===a){e=d}}if(e!==-1){this.select(h)}}}else{this.collapse(g)}}}return true},moveRight:function(a){if(a.ctrlKey||a.metaKey){return NO}if((this.get("itemsPerRow")||1)>1){this.selectNextItem(false,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}else{var d=this.get("selection"),c=this.get("content"),b=d?d.indexSetForSource(c):null;if(b){this.expand(b)}}return true},moveDownAndModifySelection:function(b,a){this.selectNextItem(true,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveUpAndModifySelection:function(b,a){this.selectPreviousItem(true,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveLeftAndModifySelection:function(b,a){if((this.get("itemsPerRow")||1)>1){this.selectPreviousItem(true,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}return true},moveRightAndModifySelection:function(b,a){if((this.get("itemsPerRow")||1)>1){this.selectNextItem(true,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}return true},insertNewline:function(d,c){var b=this.get("isEditable")&&this.get("canEditContent"),g,f,h,a,e;if(b){g=this.get("selection");f=this.get("content");if(g&&g.get("length")===1){h=g.indexSetForSource(f);a=h?h.get("min"):-1;b=a>=0}}if(b){e=this.itemViewForContentIndex(a);b=e&&SC.typeOf(e.beginEditing)===SC.T_FUNCTION}if(b){this.scrollToContentIndex(a);e=this.itemViewForContentIndex(a);e.beginEditing()}else{this.invokeLater(this._cv_action,0,e,null)}return YES},insertTab:function(b){var a=this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertBacktab:function(b){var a=this.get("previousValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},mouseDown:function(k){var g=this.get("content");if(!g){return this.get("isSelectable")}var h=this.itemViewForEvent(k),e=h?h.get("contentIndex"):-1,c,d,b,a,l,f=NO,j=g.get("allowsMultipleSelection");if(!this.get("isEnabled")){return e>-1}if(!this.get("isSelectable")){return NO}this.becomeFirstResponder();if(this.get("useToggleSelection")){if(this.get("selectOnMouseDown")){if(!h){return}b=this.get("selection");a=b&&b.containsObject(h.get("content"));if(a){this.deselect(e)}else{if(!j){this.select(e,NO);f=YES}else{this.select(e,YES);f=YES}}if(f&&this.get("actOnSelect")){this._cv_performSelectAction(h,k)}}return YES}if(!h){if(this.get("allowDeselectAll")){this.select(null,false)}return YES}b=this.get("selection");if(b){b=b.indexSetForSource(g)}c=this.mouseDownInfo={event:k,itemView:h,contentIndex:e,at:Date.now()};a=b?b.contains(e):NO;c.modifierKeyPressed=l=k.ctrlKey||k.metaKey;if(l&&a){c.shouldDeselect=e>=0}else{if(k.shiftKey&&b&&b.get("length")>0&&j){b=this._findSelectionExtendedByShift(b,e);d=this._selectionAnchor;this.select(b);this._selectionAnchor=d}else{if(!l&&a){c.shouldReselect=e>=0}else{if((k.shiftKey||l)&&!j){this.select(null,false)}if(this.get("selectOnMouseDown")){this.select(e,l)}else{c.shouldSelect=e>=0}}}}c.previousContentIndex=e;return YES},mouseUp:function(j){var k=this.itemViewForEvent(j),d=this.mouseDownInfo,f=this.get("content"),e=k?k.get("contentIndex"):-1,c,a,b,g,l,h=f.get("allowsMultipleSelection");if(!this.get("isEnabled")){return e>-1}if(!this.get("isSelectable")){return NO}if(this.get("useToggleSelection")){if(!k||this.get("selectOnMouseDown")){return NO}c=this.get("selection");a=c&&c.containsObject(k.get("content"));if(a){this.deselect(e)}else{if(!h){this.select(e,NO)}else{this.select(e,YES)}}}else{if(d){l=d.contentIndex;e=(k)?k.get("contentIndex"):-1;if(d.shouldSelect){this.select(l,d.modifierKeyPressed)}if(d.shouldDeselect){this.deselect(l)}if(d.shouldReselect){b=this.get("isEditable")&&this.get("canEditContent");if(b){c=this.get("selection");b=c&&(c.get("length")===1)}if(b){g=this.itemViewForContentIndex(l);b=g&&(!g.contentHitTest||g.contentHitTest(j));b=(b&&g.beginEditing)?g.beginEditing():NO}if(!b){if(this._cv_reselectTimer){this._cv_reselectTimer.invalidate()}this._cv_reselectTimer=this.invokeLater(this.select,300,l,false)}}this._cleanupMouseDown()}}this._cv_performSelectAction(k,j,0,j.clickCount);return NO},_cleanupMouseDown:function(){var b=this.mouseDownInfo,a;if(b){for(a in b){if(!b.hasOwnProperty(a)){continue}delete b[a]}}this.mouseDownInfo=null},mouseMoved:function(c){var a=this.itemViewForEvent(c),b=this._lastHoveredItem;if(a!==b){if(b&&b.mouseExited){b.mouseExited(c)}if(a&&a.mouseEntered){a.mouseEntered(c)}}this._lastHoveredItem=a;if(a&&a.mouseMoved){a.mouseMoved(c)}return YES},mouseExited:function(b){var a=this._lastHoveredItem;this._lastHoveredItem=null;if(a&&a.mouseExited){a.mouseExited(b)}return YES},touchStart:function(d,a){var b=this.itemViewForEvent(d),c=b?b.get("contentIndex"):-1;if(!this.get("isEnabled")){return c>-1}this.becomeFirstResponder();this._touchSelectedView=b;if(!this.get("useToggleSelection")){if(this.selection&&this.selection.firstObject()){selectedItemView=this.itemViewForContentObject(this.selection.firstObject());if((c!=-1)&&(selectedItemView.get("contentIndex")!=c)){selectedItemView.set("isSelected",NO)}}if(b&&!b.get("isSelected")){b.set("isSelected",YES)}}return YES},touchesDragged:function(a,b){b.forEach(function(c){if(Math.abs(c.pageX-c.startX)>5||Math.abs(c.pageY-c.startY)>5){c.makeTouchResponder(c.nextTouchResponder)}},this)},touchEnd:function(f){var b=this._touchSelectedView,e=b?b.get("contentIndex"):-1,a=NO,c,d=this.getPath("content.allowsMultipleSelection");if(!this.get("isEnabled")){return e>-1}if(e>-1){if(this.get("useToggleSelection")){c=this.get("selection");a=c&&c.containsObject(b.get("content"))}if(a){this.deselect(e)}else{this.select(e,d?YES:NO);this._cv_performSelectAction(b,f,0)}}this._touchSelectedView=null},touchCancelled:function(a){if(this._touchSelectedView){this._touchSelectedView.set("isSelected",NO);this._touchSelectedView=null}},_findSelectionExtendedByShift:function(e,h){if(!e||e.get("length")===0){return SC.IndexSet.create(h)}var d=this.get("content"),g=d.get("length")-1,c=e.get("min"),a=e.get("max")-1,f=this.mouseDownInfo,b=this._selectionAnchor;if(SC.none(b)){b=-1}if(h<c){c=h;if(b<0){this._selectionAnchor=b=a}}else{if(h>a){a=h;if(b<0){this._selectionAnchor=b=c}}else{if(h>=c&&h<=a){if(b<0){this._selectionAnchor=b=c}if(h===b){c=a=h}else{if(h>b){c=b;a=h}else{if(h<b){c=h;a=b}}}}}}return SC.IndexSet.create(c,a-c+1)},reorderDataType:function(){return"SC.CollectionView.Reorder."+SC.guidFor(this)}.property().cacheable(),dragContent:null,proposedInsertionIndex:null,proposedDropOperation:null,mouseDragged:function(h){var j=this.get("selectionDelegate"),e=this.get("content"),a=this.get("selection"),c=this.mouseDownInfo,f=this.get("_contentGroupIndexes"),d,b,g;if(!c||c.contentIndex<0){return YES}if((Date.now()-c.at)<123){return YES}if(j.collectionViewShouldBeginDrag(this)){if(!this.get("selectOnMouseDown")){d=SC.IndexSet.create(c.contentIndex)}else{d=a?a.indexSetForSource(e):null}if(d&&f&&f.get("length")>0){d=d.copy().remove(f);if(d.get("length")===0){d=null}else{d.freeze()}}if(!d){return YES}else{d=d.frozenCopy()}d={content:e,indexes:d};this.set("dragContent",d);b=this.get("dragDataTypes");if(b&&b.get("length")>0){g=j.collectionViewDragViewFor(this,d.indexes);if(!g){g=this._cv_dragViewFor(d.indexes)}g.createLayer();SC.Drag.start({event:c.event,source:this,dragView:g,ghost:NO,ghostActsLikeCursor:j.ghostActsLikeCursor,slideBack:YES,dataSource:this});this._cleanupMouseDown();this._lastInsertionIndex=null}else{this.set("dragContent",null)}return YES}},_cv_dragViewFor:function(f){var c=this.get("nowShowing").without(f),d=this.get("layer").cloneNode(false),b=SC.View.create({layer:d,parentView:this}),a=0,e;c=this.get("nowShowing").without(c);SC.$(d).css("backgroundColor","transparent").css("border","none").css("top",0).css("left",0);c.forEach(function(j){var k=this.itemViewForContentIndex(j),g,h;if(k){g=k.get("isSelected");k.set("isSelected",NO);k.updateLayerIfNeeded();h=k.get("layer");if(h){h=h.cloneNode(true)}k.set("isSelected",g);k.updateLayerIfNeeded()}if(h){d.appendChild(h);e=k.get("layout");if(e.height+e.top>a){a=e.height+e.top}}h=null},this);b.set("layout",{height:a});d=null;return b},dragDataTypes:function(){var a=this.get("selectionDelegate"),b=a.collectionViewDragDataTypes(this),c;if(this.get("canReorderContent")){b=b?b.copy():[];c=this.get("reorderDataType");if(b.indexOf(c)<0){b.push(c)}}return b?b:[]}.property(),dragDataForType:function(c,b){if(this.get("canReorderContent")){if(b===this.get("reorderDataType")){return this.get("dragContent")}}var a=this.get("selectionDelegate");return a.collectionViewDragDataForType(this,c,b)},computeDragOperations:function(c,b){var d=SC.DRAG_NONE,a=this.get("selectionDelegate");if(this.get("canReorderContent")){if(c.get("dataTypes").indexOf(this.get("reorderDataType"))>=0){d=SC.DRAG_REORDER}}d=a.collectionViewComputeDragOperations(this,c,d);if(d&SC.DRAG_REORDER){d=SC.DRAG_MOVE}return d},_computeDropOperationState:function(c,m,e){var g=this.convertFrameFromView(c.get("location"),null),l=SC.DROP_BEFORE,n=this.get("selectionDelegate"),d=this.get("canReorderContent"),o,h,a,j,f,b;var k=this.insertionIndexForLocation(g,SC.DROP_ON);if(SC.typeOf(k)===SC.T_ARRAY){l=k[1];k=k[0]}if(l===SC.DROP_ON){this.set("proposedInsertionIndex",k);this.set("proposedDropOperation",l);b=n.collectionViewValidateDragOperation(this,c,e,k,l);k=this.get("proposedInsertionIndex");l=this.get("proposedDropOperation");this._dropInsertionIndex=this._dropOperation=null;if(b!==SC.DRAG_NONE){return[k,l,b]}else{l=SC.DROP_BEFORE;k=this.insertionIndexForLocation(g,SC.DROP_BEFORE);if(SC.typeOf(k)===SC.T_ARRAY){l=k[1];k=k[0]}}}if((k>=0)&&d&&(l!==SC.DROP_ON)){o=c.dataForType(this.get("reorderDataType"));if(o){h=this.get("content");if(l===SC.DROP_BEFORE){a=o.indexes.contains(k-1);j=o.indexes.contains(k)}else{a=o.indexes.contains(k);j=o.indexes.contains(k-1)}if(a&&j){if(SC.none(this._lastInsertionIndex)){if(l===SC.DROP_BEFORE){while((k>=0)&&o.indexes.contains(k)){k--}}else{f=h?h.get("length"):0;while((k<f)&&o.indexes.contains(k)){k++}}}else{k=this._lastInsertionIndex}}if(k>=0){e=SC.DRAG_REORDER}}}this.set("proposedInsertionIndex",k);this.set("proposedDropOperation",l);e=n.collectionViewValidateDragOperation(this,c,e,k,l);k=this.get("proposedInsertionIndex");l=this.get("proposedDropOperation");this._dropInsertionIndex=this._dropOperation=null;return[k,l,e]},dragUpdated:function(f,b){var h=f.get("allowedDragOperations"),g=this._computeDropOperationState(f,b,h),a=g[0],c=g[1],e=g[2];if(e!==SC.DRAG_NONE){if((this._lastInsertionIndex!==a)||(this._lastDropOperation!==c)){var d=this.itemViewForContentIndex(a);this.showInsertionPoint(d,c)}this._lastInsertionIndex=a;this._lastDropOperation=c}else{this.hideInsertionPoint();this._lastInsertionIndex=this._lastDropOperation=null}return(e&SC.DRAG_REORDER)?SC.DRAG_MOVE:e},dragExited:function(){this.hideInsertionPoint();this._lastInsertionIndex=this._lastDropOperation=null},acceptDragOperation:function(a,b){return YES},performDragOperation:function(e,g){var a=this._computeDropOperationState(e,null,g),l=a[0],k=a[1],h=a[2],m=this.get("selectionDelegate"),c,n,d,j,b,f;if(h&SC.DRAG_REORDER){g=(g&SC.DRAG_MOVE)?SC.DRAG_REORDER:SC.DRAG_NONE}else{g=g&h}if(g===SC.DRAG_NONE){return g}c=m.collectionViewPerformDragOperation(this,e,g,l,k);if((c===SC.DRAG_NONE)&&(g&SC.DRAG_REORDER)){d=e.dataForType(this.get("reorderDataType"));if(!d){return SC.DRAG_NONE}j=this.get("content");f=d.indexes;if(f.get("length")===1){if(((k===SC.DROP_BEFORE)||(k===SC.DROP_AFTER))&&(f.get("min")===l)){return SC.DRAG_MOVE}}j.beginPropertyChanges();n=[];d.indexes.forEach(function(o){n.push(j.objectAt(o))},this);if(k===SC.DROP_AFTER){l++}j.replace(l,0,n,k);b=0;if(k===SC.DROP_AFTER){l--}d.indexes.forEach(function(o){if(o<l){j.removeAt(o-b);b++}else{j.removeAt(o-b+n.length)}},this);this.select(SC.IndexSet.create(l,n.length));j.endPropertyChanges();g=SC.DRAG_MOVE}return g},collectionViewShouldBeginDrag:function(a){return this.get("canReorderContent")},insertionIndexForLocation:function(a,b){return -1},_cv_isVisibleInWindowDidChange:function(){if(this.get("isVisibleInWindow")){if(this._invalidIndexes){this.invokeOnce(this.reloadIfNeeded)}if(this._invalidSelection){this.invokeOnce(this.reloadSelectionIndexesIfNeeded)}}}.observes("isVisibleInWindow"),collectionViewShouldSelectItem:function(a,b){return this.get("isSelectable")},_TMP_DIFF1:SC.IndexSet.create(),_TMP_DIFF2:SC.IndexSet.create(),_cv_nowShowingDidChange:function(){var b=this.get("nowShowing"),a=this._sccv_lastNowShowing,d,e,c;if(a!==b){if(a&&b){e=this._TMP_DIFF1.add(a).remove(b);c=this._TMP_DIFF2.add(b).remove(a);d=e.add(c)}else{d=a||b}}if(d&&d.get("length")>0){this._sccv_lastNowShowing=b?b.frozenCopy():null;this.updateContentRangeObserver();this.reload(d)}if(e){e.clear()}if(c){c.clear()}}.observes("nowShowing"),init:function(){arguments.callee.base.apply(this,arguments);if(this.useFastPath){this.mixin(SC.CollectionFastPath)}if(this.get("canReorderContent")){this._cv_canReorderContentDidChange()}this._sccv_lastNowShowing=this.get("nowShowing").clone();if(this.content){this._cv_contentDidChange()}if(this.selection){this._cv_selectionDidChange()}},_cv_canReorderContentDidChange:function(){if(this.get("canReorderContent")){if(!this.get("isDropTarget")){this.set("isDropTarget",YES)}SC.Drag.addDropTarget(this)}}.observes("canReorderContent"),_cv_performSelectAction:function(b,d,c,a){var e;if(c===undefined){c=0}if(a===undefined){a=1}if((a>1)||this.get("actOnSelect")){if(this._cv_reselectTimer){this._cv_reselectTimer.invalidate()}e=this.get("selection");e=e?e.toArray():[];if(this._cv_actionTimer){this._cv_actionTimer.invalidate()}this._cv_actionTimer=this.invokeLater(this._cv_action,c,b,d,e)}},_cv_action:function(b,a,c){var d=this.get("action");var e=this.get("target")||null;this._cv_actionTimer=null;if(d){if(SC.typeOf(d)===SC.T_FUNCTION){return this.action(b,a)}var f=this.get("pane");if(f){f.rootResponder.sendAction(d,e,this,f,c)}}else{if(!b){return}else{if(SC.typeOf(b._action)==SC.T_FUNCTION){return b._action(a)}else{if(SC.typeOf(b.action)==SC.T_FUNCTION){return b.action(a)}}}}}});SC.DateFieldView=SC.TextFieldView.extend({value:null,showDate:YES,showTime:NO,formatTime:"%I:%M %p",formatDate:"%d/%m/%Y",formatDateTime:"%d/%m/%Y %I:%M %p",_dtConstants:["%a","%b","%d","%H","%I","%j","%m","%M","%p","%S","%U","%W","%y","%Y"],_wtConstants:[3,3,2,2,2,3,2,2,2,2,2,2,2,4],activeSelection:0,format:function(){var a=this.get("showTime");var b=this.get("showDate");if(a===YES&&b===YES){return this.get("formatDateTime")}if(a===YES){return this.get("formatTime")}return this.get("formatDate")}.property("showTime","showDate").cacheable(),validator:function(){return SC.Validator.DateTime.extend({format:this.get("format")})}.property("format").cacheable(),tabsSelections:function(){var f=[];var d=this.get("format");var j=this.get("_dtConstants");var b=this.get("_wtConstants");if(SC.empty(d)){throw"The format string is empty, and must be a valid string."}var g,k,c,e=0,a=0,h=0;while(e<d.length&&d.indexOf("%",e)!==-1){g=d.indexOf("%",e);k=d.substring(g,g+2);e=g+2;c=j.indexOf(k);if(c===-1){throw"SC.DateFieldView: The format's key '%@' is not supported.".fmt(k)}a=a+g-h;f.push(SC.Object.create({key:k,textSelection:SC.TextSelection.create({start:a,end:a+b[c]})}));a=a+b[c];h=e}g=k=c=null;return f}.property("format").cacheable(),updateTextSelectionObserver:function(){var a=this.get("activeSelection");var b=this.get("tabsSelections");if(this.get("isEditing")){this.selection(null,b[a].get("textSelection"))}}.observes("activeSelection","value"),updateValue:function(b,c){var e=(c===0)?-1:1;var d=this.get("value"),a;switch(b){case"%a":case"%d":case"%j":this.set("value",d.advance({day:e}));break;case"%b":case"%m":this.set("value",d.advance({month:e}));break;case"%H":case"%I":this.set("value",d.advance({hour:e}));break;case"%M":this.set("value",d.advance({minute:e}));break;case"%p":a=d.get("hour")>=12?-12:12;this.set("value",d.advance({hour:a}));break;case"%S":this.set("value",d.advance({second:e}));break;case"%U":this.set("value",d.advance({week1:e}));break;case"%W":this.set("value",d.advance({week0:e}));break;case"%y":case"%Y":this.set("value",d.advance({year:e}));break}},_selectRootElement:function(){},keyDown:function(a){if(this.interpretKeyEvents(a)){a.stop();return YES}return arguments.callee.base.apply(this,arguments)},ctrl_a:function(){return YES},moveUp:function(b){var a=this.get("activeSelection");var c=this.get("tabsSelections");this.updateValue(c[a].get("key"),1);return YES},moveDown:function(b){var a=this.get("activeSelection");var c=this.get("tabsSelections");this.updateValue(c[a].get("key"),0);return YES},insertText:function(a){return YES},moveRight:function(a){var c=this.get("tabsSelections");var b=this.get("activeSelection")+1;if(b===c.length){b=0}this.set("activeSelection",b);return YES},moveLeft:function(a){var c=this.get("tabsSelections");var b=this.get("activeSelection")-1;if(b===-1){b=c.length-1}this.set("activeSelection",b);return YES},insertTab:function(a){var c=this.get("tabsSelections");var b=this.get("activeSelection")+1;if(b<c.length){this.set("activeSelection",b);return YES}return NO},insertBacktab:function(a){var b=this.get("activeSelection")-1;if(b!==-1){this.set("activeSelection",b);return YES}return NO},mouseUp:function(b){var c=arguments.callee.base.apply(this,arguments);var e=this.get("selection");if(SC.none(e)){this.set("activeSelection",0)}else{var h=e.get("start");var g=this.get("tabsSelections");var a=g.length,f;for(var d=0;d<a;d++){f=g[d].get("textSelection");if(h>=f.get("start")&&h<=f.get("end")){this.set("activeSelection",d)}}}return c},deleteBackward:function(a){return YES},deleteForward:function(a){return YES}});SC.DisclosureView=SC.ButtonView.extend({classNames:["sc-disclosure-view"],renderDelegateName:"disclosureRenderDelegate",buttonBehavior:SC.TOGGLE_BEHAVIOR,toggleOnValue:YES,toggleOffValue:NO,valueBindingDefault:SC.Binding.bool(),keyDown:function(a){if(a.which===37||a.which===38){this.set("value",this.get("toggleOffValue"));return YES}if(a.which===39||a.which===40){this.set("value",this.get("toggleOnValue"));return YES}arguments.callee.base.apply(this,arguments)}});sc_require("views/collection");sc_require("mixins/collection_row_delegate");SC.ListView=SC.CollectionView.extend(SC.CollectionRowDelegate,{classNames:["sc-list-view"],acceptsFirstResponder:YES,showAlternatingRows:NO,render:function(a,b){a.setClass("alternating",this.get("showAlternatingRows"));return arguments.callee.base.apply(this,arguments)},rowDelegate:function(){var a=this.delegate,b=this.get("content");return this.delegateFor("isCollectionRowDelegate",a,b)}.property("delegate","content").cacheable(),_sclv_rowDelegateDidChange:function(){var d=this._sclv_rowDelegate,b=this.get("rowDelegate"),c=this._sclv_rowHeightDidChange,a=this._sclv_customRowHeightIndexesDidChange;if(d===b){return this}this._sclv_rowDelegate=b;if(d){d.removeObserver("rowHeight",this,c);d.removeObserver("customRowHeightIndexes",this,a)}if(!b){throw"Internal Inconsistancy: ListView must always have CollectionRowDelegate"}b.addObserver("rowHeight",this,c);b.addObserver("customRowHeightIndexes",this,a);this._sclv_rowHeightDidChange()._sclv_customRowHeightIndexesDidChange();return this}.observes("rowDelegate"),_sclv_rowHeightDidChange:function(){var b=this.get("rowDelegate"),a=b.get("rowHeight"),c;if(a===this._sclv_rowHeight){return this}this._sclv_rowHeight=a;c=SC.IndexSet.create(0,this.get("length"));this.rowHeightDidChangeForIndexes(c);return this},_sclv_customRowHeightIndexesDidChange:function(){var a=this.get("rowDelegate"),b=a.get("customRowHeightIndexes"),d=this._sclv_customRowHeightIndexes,c=this._sclv_customRowHeightIndexesContentDidChange;if((b===d)||(d&&d.isEqual(b))){return this}if(d&&this._sclv_isObservingCustomRowHeightIndexes){d.removeObserver("[]",this,c)}if(this._sclv_isObservingCustomRowHeightIndexes=b&&!b.get("isFrozen")){b.addObserver("[]",this,c)}this._sclv_customRowHeightIndexesContentDidChange();return this},_sclv_customRowHeightIndexesContentDidChange:function(){var a=this.get("rowDelegate"),b=a.get("customRowHeightIndexes"),c=this._sclv_customRowHeightIndexes,d;if(b&&c){d=b.copy().add(c)}else{d=b||c}this._sclv_customRowHeightIndexes=b?b.frozenCopy():null;this.rowHeightDidChangeForIndexes(d);return this},rowOffsetForContentIndex:function(h){if(h===0){return 0}var k=this.get("rowDelegate"),a=k.get("rowHeight"),f,e,c,b,j,g,d;e=h*a;f=this.get("rowSpacing");if(f){e+=h*f}if(k.customRowHeightIndexes&&(c=k.get("customRowHeightIndexes"))){b=this._sclv_offsetCache;if(!b){b=[];j=g=0;c.forEach(function(l){j+=this.rowHeightForContentIndex(l)-a;b[l+1]=j;g=l},this);this._sclv_max=g+1;this._sclv_offsetCache=b}j=b[h];if(j===undefined){j=b[h]=b[h-1];if(j===undefined){g=this._sclv_max;if(h<g){g=c.indexBefore(h)+1}j=b[h]=b[g]||0}}e+=j}return e},rowHeightForContentIndex:function(a){var b=this.get("rowDelegate"),e,c,f,d;if(b.customRowHeightIndexes&&(d=b.get("customRowHeightIndexes"))){c=this._sclv_heightCache;if(!c){c=[];f=this.get("content");d.forEach(function(g){c[g]=b.contentIndexRowHeight(this,f,g)},this);this._sclv_heightCache=c}e=c[a];if(e===undefined){e=b.get("rowHeight")}}else{e=b.get("rowHeight")}return e},rowHeightDidChangeForIndexes:function(b){var a=this.get("length");this._sclv_heightCache=this._sclv_offsetCache=null;if(b&&b.isIndexSet){b=b.get("min")}this.reload(SC.IndexSet.create(b,a-b));return this},_sclv_lengthDidChange:function(){this.adjust(this.computeLayout())}.observes("length"),computeLayout:function(){var a=this._sclv_layout;if(!a){a=this._sclv_layout={}}a.minHeight=this.rowOffsetForContentIndex(this.get("length"));this.set("calculatedHeight",a.minHeight);return a},layoutForContentIndex:function(b){var a=this.get("rowDelegate");return{top:this.rowOffsetForContentIndex(b),height:this.rowHeightForContentIndex(b)-a.get("rowPadding")*2,left:0,right:0}},contentIndexesInRect:function(h){var a=this.get("rowDelegate").get("rowHeight"),g=SC.minY(h),b=SC.maxY(h),j=h.height||0,f=this.get("length"),e,c,d;c=(g-(g%a))/a;e=this.rowOffsetForContentIndex(c);while(c>0&&e>g){c--;e-=this.rowHeightForContentIndex(c)}e+=this.rowHeightForContentIndex(c);while(c<f&&e<=g){c++;e+=this.rowHeightForContentIndex(c)}if(c<0){c=0}if(c>=f){c=f}d=c+((j-(j%a))/a);if(d>f){d=f}e=this.rowOffsetForContentIndex(d);while(d>=c&&e>=b){d--;e-=this.rowHeightForContentIndex(d)}e+=this.rowHeightForContentIndex(d);while(d<f&&e<b){d++;e+=this.rowHeightForContentIndex(d)}d++;if(d<c){d=c}if(d>f){d=f}return SC.IndexSet.create(c,d-c)},insertionPointView:SC.View.extend({classNames:"sc-list-insertion-point",render:function(a,b){if(b){a.push('<div class="anchor"></div>')}}}),showInsertionPoint:function(g,f){var h=this._insertionPointView;if(!h){h=this._insertionPointView=this.get("insertionPointView").create()}var d=g.get("contentIndex"),e=this.get("length"),c=SC.clone(g.get("layout")),a=g.get("outlineLevel"),b=g.get("outlineIndent")||0,j;if((d>=e)&&d>0){j=this.itemViewForContentIndex(e-1);if(j.get("isGroupView")){a=1;b=j.get("outlineIndent")}}if(SC.none(a)){a=-1}if(f&SC.DROP_ON){if(g!==this._lastDropOnView){this.hideInsertionPoint();g.set("isDropTarget",YES);this._lastDropOnView=g}}else{if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}if(f&SC.DROP_AFTER){c.top+=c.height}c.height=2;c.right=0;c.left=((a+1)*b)+12;delete c.width;h.set("layout",c);this.appendChild(h)}},hideInsertionPoint:function(){if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}var a=this._insertionPointView;if(a){a.removeFromParent().destroy()}this._insertionPointView=null},insertionIndexForLocation:function(g,l){var b={x:g.x,y:g.y,width:1,height:1},f=this.contentIndexesInRect(b),h=f.get("min"),j=this.get("length"),c,m,n,e,p,d,o,k,a;if(SC.none(h)||h<0){if((j===0)||(g.y<=this.rowOffsetForContentIndex(0))){h=0}else{if(g.y>=this.rowOffsetForContentIndex(j)){h=j}}}c=this.rowOffsetForContentIndex(h);m=c+this.rowHeightForContentIndex(h);if(l==SC.DROP_ON){if(this.get("isEditable")){n=Math.min(Math.floor((m-c)*0.2),5)}else{n=0}if(g.y>=(c+n)||g.y<=(m+n)){return[h,SC.DROP_ON]}}if(h>0){k=this.itemViewForContentIndex(h-1);o=(k?k.get("outlineIndent"):0)||0;d=k?k.get("outlineLevel"):0;if(h<j){k=this.itemViewForContentIndex(h);e=k?k.get("outlineLevel"):0;p=(k?k.get("outlineIndent"):0)||0;p*=e}else{e=k.get("isGroupView")?1:0;p=o*e}o*=d;if((e!==d)&&(p!==o)){if(o>p){h--;l=SC.DROP_AFTER}}}if(l===SC.DROP_BEFORE){k=(h<j)?this.itemViewForContentIndex(h):null;if(!k||k.get("isGroupView")){if(h>0){k=this.itemViewForContentIndex(h-1);if(!k.get("isGroupView")||(k.get("disclosureState")===SC.BRANCH_OPEN)){h=h-1;l=SC.DROP_AFTER}else{h=-1}}else{h=-1}}if(h<0){l=SC.DRAG_NONE}}return[h,l]},mouseWheel:function(a){var b=SC.InlineTextFieldView.editor;if(b&&b.get("isEditing")){if(b.get("delegate").get("displayDelegate")===this){SC.InlineTextFieldView.commitEditing()}}return NO},init:function(){arguments.callee.base.apply(this,arguments);this._sclv_rowDelegateDidChange()}});sc_require("views/list");SC.GridView=SC.ListView.extend({classNames:["sc-grid-view"],layout:{left:0,right:0,top:0,bottom:0},rowHeight:48,columnWidth:64,exampleView:SC.LabelView,insertionOrientation:SC.HORIZONTAL_ORIENTATION,itemsPerRow:function(){var b=this.get("frame"),a=this.get("columnWidth")||0;return(a<=0)?1:Math.floor(b.width/a)}.property("frame","columnWidth").cacheable(),contentIndexesInRect:function(e){var d=this.get("rowHeight")||48,b=this.get("itemsPerRow"),c=Math.floor(SC.minY(e)/d)*b,a=Math.ceil(SC.maxY(e)/d)*b;return SC.IndexSet.create(c,a-c)},layoutForContentIndex:function(g){var d=this.get("rowHeight")||48,a=this.get("frame").width,b=this.get("itemsPerRow"),e=Math.floor(a/b),f=Math.floor(g/b),c=g-(b*f);return{left:c*e,top:f*d,height:d,width:e}},computeLayout:function(){var e=this.get("content"),d=(e)?e.get("length"):0,c=this.get("rowHeight")||48,a=this.get("itemsPerRow"),f=Math.ceil(d/a);var b=this._cachedLayoutHash;if(!b){b=this._cachedLayoutHash={}}b.minHeight=f*c;this.calculatedHeight=b.minHeight;return b},insertionPointClass:SC.View.extend({classNames:["grid-insertion-point"],render:function(a,b){if(b){a.push('<span class="anchor"></span>')}}}),showInsertionPoint:function(c,e){if(!c){return}if(e&SC.DROP_ON){if(c!==this._lastDropOnView){this.hideInsertionPoint();c.set("isDropTarget",YES);this._lastDropOnView=c}}else{if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}if(!this._insertionPointView){this._insertionPointView=this.insertionPointClass.create()}var b=this._insertionPointView;var a=c.get("frame");var d={height:a.height-6,x:a.x,y:a.y+6,width:0};if(!SC.rectsEqual(b.get("frame"),d)){b.set("frame",d)}if(b.parentNode!==c.parentNode){c.parentNode.appendChild(b)}}},hideInsertionPoint:function(){if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}var a=this._insertionPointView;if(a){a.removeFromParent().destroy()}this._insertionPointView=null},insertionIndexForLocation:function(d,k){var e=this.get("frame"),g=this.get("clippingFrame"),l=this.get("itemsPerRow"),a=Math.floor(e.width/l),n=Math.floor((d.y-e.y-g.y)/this.get("rowHeight"));var j=SC.DROP_BEFORE,c=(d.x-e.x-g.x),b=Math.floor(c/a),m=(c/a)-b;if(k===SC.DROP_ON){if(m>0.8){b++}if((m>=0.2)&&(m<=0.8)){j=SC.DROP_ON}}else{if(m>0.45){b++}}var h=(n*l)+b;return[h,j]},_gv_frameDidChange:function(){var e=this.get("frame"),c;c=e.width;if(this._lastFrameWidth&&c!==this._lastFrameWidth){this.notifyPropertyChange("itemsPerRow");var a,b,d=this.get("nowShowing");d.forEach(function(f){b=this.itemViewForContentIndex(f);b.adjust(this.layoutForContentIndex(f))},this)}this._lastFrameWidth=c}.observes("frame")});SC.ImageButtonView=SC.ButtonView.extend({classNames:["sc-image-button-view"],themeName:null,renderDelegateName:"imageButtonRenderDelegate",displayProperties:["image"],image:null});SC.ANCHOR_TOP={top:0};SC.ANCHOR_LEFT={left:0};SC.ANCHOR_TOP_LEFT={top:0,left:0};SC.ANCHOR_BOTTOM={bottom:0};SC.ANCHOR_RIGHT={right:0};SC.ANCHOR_BOTTOM_RIGHT={bottom:0,right:0};SC.ToolbarView=SC.View.extend({classNames:["sc-toolbar-view"],ariaRole:"toolbar",renderDelegateName:"toolbarRenderDelegate",anchorLocation:null,layout:{left:0,height:32,right:0},init:function(){if(this.anchorLocation){this.layout=SC.merge(this.layout,this.anchorLocation)}arguments.callee.base.apply(this,arguments)}});sc_require("views/toolbar");SC.WorkspaceView=SC.View.extend({classNames:["sc-workspace-view"],displayProperties:["hasTopToolbar","hasBottomToolbar"],renderDelegateName:"workspaceRenderDelegate",topToolbar:SC.ToolbarView.extend(),bottomToolbar:null,contentView:SC.View.extend(),autoResizeToolbars:NO,defaultToolbarSize:44,largeToolbarSize:44,smallToolbarSize:30,toolbarSize:function(){if(!this.get("autoResizeToolbars")){return this.get("defaultToolbarSize")}if(this.get("orientation")===SC.HORIZONTAL_ORIENTATION){return this.get("smallToolbarSize")}return this.get("largeToolbarSize")}.property("autoHideMaster","orientation"),orientation:function(){var a=this.get("frame");if(a.width>a.height){return SC.HORIZONTAL_ORIENTATION}else{return SC.VERTICAL_ORIENTATION}}.property("frame").cacheable(),masterIsHidden:NO,masterIsHiddenDidChange:function(){var a,b=this.get("masterIsHidden");if(a=this.get("topToolbar")){a.set("masterIsHidden",b)}if(a=this.get("bottomToolbar")){a.set("masterIsHidden",b)}}.observes("masterIsHidden"),_scmd_tilePropertyDidChange:function(){this.invokeOnce("_scws_tile")}.observes("toolbarSize"),createChildViews:function(){arguments.callee.base.apply(this,arguments);var a=this.get("topToolbar");if(a){a=this.topToolbar=this.activeTopToolbar=this.createChildView(a);this.appendChild(a)}var c=this.get("bottomToolbar");if(c){c=this.bottomToolbar=this.activeBottomToolbar=this.createChildView(c);this.appendChild(c)}var b=this.get("contentView");b=this.contentView=this.activeContentView=this.createChildView(b);this.appendChild(b);this.invokeOnce("_scws_tile")},_scws_tile:function(){var b=0,e=0,a=this.get("topToolbar"),f=this.get("bottomToolbar"),d=this.get("contentView"),c=this.get("toolbarSize");if(a){a.set("layout",{left:0,right:0,top:0,height:c});b+=c}if(f){f.set("layout",{left:0,right:0,bottom:0,height:c});e+=c}this.contentView.set("layout",{left:0,right:0,top:b,bottom:e})},hasTopToolbar:function(){if(this.get("topToolbar")){return YES}return NO}.property("topToolbar").cacheable(),hasBottomToolbar:function(){if(this.get("bottomToolbar")){return YES}return NO}.property("bottomToolbar").cacheable(),childDidChange:function(){this._scws_tile()},activeTopToolbar:null,activeBottomToolbar:null,activeContentView:null,topToolbarDidChange:function(){var b=this.activeTopToolbar,a=this.get("topToolbar");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeTopToolbar=a;this.invokeLast("childDidChange")}.observes("topToolbar"),bottomToolbarDidChange:function(){var b=this.activeBottomToolbar,a=this.get("bottomToolbar");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeBottomToolbar=a;this.invokeLast("childDidChange")}.observes("bottomToolbar"),contentViewDidChange:function(){var b=this.activeContentView,a=this.get("contentView");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeContentView=a;this.invokeLast("childDidChange")}.observes("contentView")});sc_require("views/workspace");sc_require("views/toolbar");SC.MasterDetailView=SC.View.extend({classNames:["sc-master-detail-view"],renderDelegateName:"masterDetailRenderDelegate",masterView:SC.WorkspaceView.extend({topToolbar:SC.ToolbarView.extend({}),contentView:SC.View.extend({backgroundColor:"white"})}),detailView:SC.WorkspaceView.extend({topToolbar:SC.ToolbarView.extend({childViews:["showHidePicker"],showHidePicker:SC.ButtonView.extend({layout:{left:7,centerY:0,height:30,width:100},controlSize:SC.AUTO_CONTROL_SIZE,title:"Picker",action:"toggleMasterPicker",isVisible:NO,isVisibleBinding:".parentView.masterIsHidden"})})}),autoHideMaster:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),masterWidth:250,dividerWidth:SC.propertyFromRenderDelegate("dividerWidth",1),masterIsHidden:function(){if(!this.get("autoHideMaster")){return NO}if(this.get("orientation")===SC.HORIZONTAL_ORIENTATION){return NO}return YES}.property("autoHideMaster","orientation"),orientation:SC.VERTICAL_ORIENTATION,_scmd_frameDidChange:function(){var b=this.get("frame"),a;if(b.width>b.height){a=SC.HORIZONTAL_ORIENTATION}else{a=SC.VERTICAL_ORIENTATION}this.setIfChanged("orientation",a)}.observes("frame"),init:function(){arguments.callee.base.apply(this,arguments);this._scmd_frameDidChange();this._scmd_masterIsHiddenDidChange()},toggleMasterPicker:function(a){if(!this.get("masterIsHidden")){return}if(this._picker&&this._picker.get("isVisibleInWindow")){this.hideMasterPicker()}else{this.showMasterPicker(a)}},showMasterPicker:function(b){if(this._picker&&this._picker.get("isVisibleInWindow")){return}if(!this._picker){var a=this.get("pickerPane");this._picker=a.create({})}this._picker.set("contentView",this.get("masterView"));this._picker.set("extraRightOffset",this.get("pointerDistanceFromEdge"));this.showPicker(this._picker,b)},hideMasterPicker:function(){if(this._picker&&this._picker.get("isVisibleInWindow")){this.hidePicker(this._picker)}},showPicker:function(b,a){b.popup(a,SC.PICKER_POINTER,[3,0,1,2,3],[9,-9,-18,18])},hidePicker:function(a){a.remove()},pickerPane:SC.PickerPane.extend({layout:{width:250,height:480},themeName:"popover"}),_picker:null,pointerDistanceFromEdge:46,_scmd_masterIsHiddenDidChange:function(){var a=this.get("masterIsHidden");this.get("masterView").set("masterIsHidden",a);this.get("detailView").set("masterIsHidden",a)}.observes("masterIsHidden"),_scmd_orientationDidChange:function(){this.invokeOnce("_scmd_tile")}.observes("orientation"),_scmd_retileProperties:function(){this.invokeOnce("_scmd_tile")}.observes("masterIsHidden","masterWidth"),createChildViews:function(){var b=this.get("masterView");b=this.masterView=this.createChildView(b);var a=this.get("detailView");a=this.detailView=this.createChildView(a);this.appendChild(a);this.invokeOnce("_scmd_tile")},_masterIsDrawn:NO,_scmd_tile:function(){var b=!this.get("masterIsHidden");var e=this.get("masterWidth"),d=this.get("masterView"),c=this.get("detailView");if(b){this.hideMasterPicker();if(!this._masterIsDrawn){if(this._picker){this._picker.set("contentView",null)}this.appendChild(d);this._masterIsDrawn=YES}d.set("layout",{left:0,top:0,bottom:0,width:e});var a=this.get("dividerWidth");c.set("layout",{left:e+a,right:0,top:0,bottom:0})}else{if(this._masterIsDrawn){this.removeChild(d);this._masterIsDrawn=NO}c.set("layout",{left:0,right:0,top:0,bottom:0})}}});SC.ScrollerView=SC.View.extend({classNames:["sc-scroller-view"],displayProperties:["thumbPosition","thumbLength","isEnabled","controlsHidden"],ariaRole:"scrollbar",shouldScrollToClick:NO,_touchScrollValue:NO,value:function(a,c){var b=this.get("minimum");if(c!==undefined){this._scs_value=c}c=this._scs_value||b;return Math.max(Math.min(c,this.get("maximum")),b)}.property("maximum","minimum").cacheable(),displayValue:function(){var a;if(this.get("_touchScrollValue")){a=this.get("_touchScrollValue")}else{a=this.get("value")}return a}.property("value","_touchScrollValue").cacheable(),proportion:0,maximum:100,minimum:0,isEnabled:function(a,b){if(b!==undefined){this._scsv_isEnabled=b}if(this._scsv_isEnabled!==undefined){return this._scsv_isEnabled}return this.get("proportion")<1}.property("proportion").cacheable(),_scsv_isEnabled:undefined,layoutDirection:SC.LAYOUT_VERTICAL,hasButtons:YES,scrollbarThickness:14,capLength:18,capOverlap:14,buttonLength:41,buttonOverlap:11,minimumThumbLength:20,render:function(c,a){var j="vertical",b={},l="",q=this.get("parentView"),h=this.get("layoutDirection"),e,n,g,f,o,m,k,d,p;switch(h){case SC.LAYOUT_VERTICAL:b["sc-vertical"]=YES;break;case SC.LAYOUT_HORIZONTAL:b["sc-horizontal"]=YES;j="horizontal";break}b.disabled=!this.get("isEnabled");b["controls-hidden"]=this.get("controlsHidden");c.setClass(b);n=this.get("thumbLength");e=this.get("thumbPosition");if(a){this._thumbPosition=null;this._thumbSize=null;c.push('<div class="track"></div>','<div class="cap"></div>');this.renderButtons(c,this.get("hasButtons"));this.renderThumb(c,h,n,e);c.attr("aria-orientation",j);c.attr("aria-valuemax",this.get("maximum"));c.attr("aria-valuemin",this.get("minimum"));c.attr("aria-valuenow",this.get("value"));c.attr("aria-controls",q.getPath("contentView.layerId"))}else{if(this.get("controlsHidden")){return}f=this.$(".thumb");this.adjustThumb(f,e,n);c.attr("aria-valuenow",this.get("value"))}},renderThumb:function(d,e,b,c){var a;if(e===SC.LAYOUT_HORIZONTAL){a="width: "+b+"px; left: "+c+"px;"}else{a="height: "+b+"px; top: "+c+"px;"}d.push('<div class="thumb" style="%@">'.fmt(a),'<div class="thumb-center"></div>','<div class="thumb-top"></div>','<div class="thumb-bottom"></div></div>')},renderButtons:function(b,a){if(a){b.push('<div class="button-bottom"></div><div class="button-top"></div>')}else{b.push('<div class="endcap"></div>')}},touchScrollDidStart:function(a){this.set("_touchScrollValue",a)},touchScrollDidEnd:function(a){this.set("_touchScrollValue",NO)},touchScrollDidChange:function(a){this.set("_touchScrollValue",a)},adjustThumb:function(b,a,c){this.adjustThumbPosition(b,a);this.adjustThumbSize(b,c)},adjustThumbPosition:function(b,a){if(this._thumbPosition===a){return}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:b.css("top",a);break;case SC.LAYOUT_HORIZONTAL:b.css("left",a);break}this._thumbPosition=a},adjustThumbSize:function(a,b){if(this._thumbSize===b){return}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:a.css("height",Math.max(b,this.get("minimumThumbLength")));break;case SC.LAYOUT_HORIZONTAL:a.css("width",Math.max(b,this.get("minimumThumbLength")));break}this._thumbSize=b},trackLength:function(){var a=this.get("scrollerLength");a-=this.capLength-this.capOverlap;a-=this.buttonLength-this.buttonOverlap;return a}.property("scrollerLength").cacheable(),scrollerLength:function(){switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:return this.get("frame").height;case SC.LAYOUT_HORIZONTAL:return this.get("frame").width}return 0}.property("frame").cacheable(),thumbLength:function(){var a;a=Math.floor(this.get("trackLength")*this.get("proportion"));a=isNaN(a)?0:a;return Math.max(a,this.get("minimumThumbLength"))}.property("trackLength","proportion").cacheable(),thumbPosition:function(){var g=this.get("displayValue"),c=this.get("maximum"),b=this.get("trackLength"),d=this.get("thumbLength"),f=this.get("capLength"),e=this.get("capOverlap"),a;a=(g/c)*(b-d);a+=f-e;return Math.floor(isNaN(a)?0:a)}.property("displayValue","maximum","trackLength","thumbLength").cacheable(),controlsHidden:function(){return this.get("proportion")>=1}.property("proportion").cacheable(),valueForPosition:function(g){var b=this.get("maximum"),a=this.get("trackLength"),c=this.get("thumbLength"),f=this.get("capLength"),d=this.get("capOverlap"),e;e=g-(f-d);e=e/(a-c);e=e*b;return e},mouseDown:function(k){if(!this.get("isEnabled")){return NO}this._altIsDown=k.altKey;this._shiftIsDown=k.shiftKey;var e=k.target,c=this.get("thumbPosition"),j,d,g,f=this.get("scrollerLength");if(e.className.indexOf("thumb")>=0){d=this.convertFrameFromView({x:k.pageX,y:k.pageY});d.x-=c;d.y-=c;this._thumbDragging=YES;this._thumbOffset=d;this._mouseDownLocation={x:k.pageX,y:k.pageY};this._thumbPositionAtDragStart=this.get("thumbPosition");this._valueAtDragStart=this.get("value")}else{if(e.className.indexOf("button-top")>=0){this.decrementProperty("value",(this._altIsDown?f:30));this.makeButtonActive(".button-top");this.startMouseDownTimer("scrollUp");this._isScrollingUp=YES}else{if(e.className.indexOf("button-bottom")>=0){this.incrementProperty("value",(this._altIsDown?f:30));this.makeButtonActive(".button-bottom");this.startMouseDownTimer("scrollDown");this._isScrollingDown=YES}else{var m=this.get("shouldScrollToClick");if(k.altKey){m=!m}var a=this.get("trackLength"),h=this.get("thumbLength"),b=this.convertFrameFromView({x:k.pageX,y:k.pageY}),l;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:this._mouseDownLocation=l=b.y;break;case SC.LAYOUT_HORIZONTAL:this._mouseDownLocation=l=b.x;break}if(m){this.set("value",this.valueForPosition(l-(h/2)));c=this.get("thumbPosition");this._thumbDragging=YES;this._thumbOffset={x:b.x-c,y:b.y-c};this._mouseDownLocation={x:k.pageX,y:k.pageY};this._thumbPositionAtDragStart=c;this._valueAtDragStart=this.get("value")}else{if(l<c){this.decrementProperty("value",f);this.startMouseDownTimer("page")}else{this.incrementProperty("value",f);this.startMouseDownTimer("page")}}}}}return YES},mouseUp:function(a){var c=this._scs_buttonActive,b=NO,d;if(c){c.removeClass("active");b=YES}d=this._mouseDownTimer;if(d){d.invalidate();this._mouseDownTimer=null}this._thumbDragging=NO;this._isScrollingDown=NO;this._isScrollingUp=NO;return b},mouseDragged:function(n){var l,b,m,c,j=n.target,e=this._thumbPositionAtDragStart,g=this._isScrollingUp,p=this._isScrollingDown,d=this._scs_buttonActive,a;if(this._thumbDragging){switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:m=(n.pageY-this._mouseDownLocation.y);break;case SC.LAYOUT_HORIZONTAL:m=(n.pageX-this._mouseDownLocation.x);break}if(n.altKey){if(!this._altIsDown||(this._shiftIsDown!==n.shiftKey)){e=this._thumbPositionAtDragStart=e+m;m=0;this._mouseDownLocation={x:n.pageX,y:n.pageY};this._valueAtDragStart=this.get("value")}if(n.shiftKey){m=-m}this.set("value",Math.round(this._valueAtDragStart+m*2))}else{c=e+m;b=this.get("trackLength")-this.get("thumbLength");this.set("value",Math.round((c/b)*this.get("maximum")))}}else{if(g||p){var o=NO,f=NO;var k=this.$(".button-top")[0].getBoundingClientRect();var h=this.$(".button-bottom")[0].getBoundingClientRect();switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:if(n.clientY<k.bottom){o=YES}else{f=YES}break;case SC.LAYOUT_HORIZONTAL:if(n.clientX<k.right){o=YES}else{f=YES}break}if((o||f)&&o!==g){if(d){d.removeClass("active")}this._mouseDownTimerAction=o?"scrollUp":"scrollDown";if(o){this.makeButtonActive(".button-top")}else{if(f){this.makeButtonActive(".button-bottom")}}this._isScrollingUp=o;this._isScrollingDown=f}}}this._altIsDown=n.altKey;this._shiftIsDown=n.shiftKey;return YES},startMouseDownTimer:function(b,a){var c;this._mouseDownTimerAction=b;this._mouseDownTimer=SC.Timer.schedule({target:this,action:this.mouseDownTimerDidFire,interval:a?0:300})},mouseDownTimerDidFire:function(){var d=this.get("scrollerLength"),a=SC.device.get("mouseLocation"),c=this.get("thumbPosition"),b=this.get("thumbLength"),e=50;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:a=this.convertFrameFromView(a).y;break;case SC.LAYOUT_HORIZONTAL:a=this.convertFrameFromView(a).x;break}switch(this._mouseDownTimerAction){case"scrollDown":this.incrementProperty("value",this._altIsDown?d:30);break;case"scrollUp":this.decrementProperty("value",this._altIsDown?d:30);break;case"page":e=150;if(a<c){this.decrementProperty("value",d)}else{if(a>c+b){this.incrementProperty("value",d)}}}this._mouseDownTimer=SC.Timer.schedule({target:this,action:this.mouseDownTimerDidFire,interval:e})},makeButtonActive:function(a){this._scs_buttonActive=this.$(a).addClass("active")}});SC.TouchScrollerView=SC.ScrollerView.extend({classNames:["sc-touch-scroller-view"],scrollbarThickness:12,capLength:5,capOverlap:0,hasButtons:NO,buttonOverlap:36,adjustThumb:function(d,b,f){var c=this.$(".thumb-inner");var a=this.get("scrollerLength")-this.capLength,e=this.get("minimum")+this.capLength;if(b+f>a){b=Math.min(a-20,b);f=a-b}if(b<e){f-=e-b;b=e}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:if(this._thumbPosition!==b){d.css("-webkit-transform","translate3d(0px,"+b+"px,0px)")}if(this._thumbSize!==f){c.css("-webkit-transform","translate3d(0px,"+Math.round(f-1044)+"px,0px)")}break;case SC.LAYOUT_HORIZONTAL:if(this._thumbPosition!==b){d.css("-webkit-transform","translate3d("+b+"px,0px,0px)")}if(this._thumbSize!==f){c.css("-webkit-transform","translate3d("+Math.round(f-1044)+"px,0px,0px)")}break}this._thumbPosition=b;this._thumbSize=f;arguments.callee.base.apply(this,arguments)},render:function(c,a){var b=[],e,k,g,f,l,j,h,d,m;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:b.push("sc-vertical");break;case SC.LAYOUT_HORIZONTAL:b.push("sc-horizontal");break}if(!this.get("isEnabled")){b.push("disabled")}if(this.get("controlsHidden")){b.push("controls-hidden")}c.addClass(b);k=this.get("thumbLength");e=this.get("thumbPosition");if(a){this._thumbPosition=null;this._thumbSize=null;c.push('<div class="track"></div><div class="cap"></div>');this.renderButtons(c,this.get("hasButtons"));this.renderThumb(c,this.get("layoutDirection"),k)}else{if(this.get("controlsHidden")){return}f=this.$(".thumb");this.adjustThumb(f,e,k)}},renderThumb:function(b,c,a){a-=1044;c=(c===SC.LAYOUT_HORIZONTAL?"X":"Y");b.push('<div class="thumb"><div class="thumb-top"></div><div class="thumb-clip">'+'<div class="thumb-inner" style="-webkit-transform: translate%@(%@px);">'.fmt(c,a)+'<div class="thumb-center"></div><div class="thumb-bottom"></div></div></div></div>')}});sc_require("views/scroller");SC.NORMAL_SCROLL_DECELERATION=0.95;SC.FAST_SCROLL_DECELERATION=0.85;SC.ScrollView=SC.View.extend({classNames:["sc-scroll-view"],isScrollable:YES,contentView:null,horizontalAlign:SC.ALIGN_LEFT,verticalAlign:SC.ALIGN_TOP,horizontalScrollOffset:function(b,d){if(d!==undefined){var c=this.minimumHorizontalScrollOffset(),a=this.get("maximumHorizontalScrollOffset");this._scroll_horizontalScrollOffset=Math.max(c,Math.min(a,d))}return this._scroll_horizontalScrollOffset||0}.property().cacheable(),verticalScrollOffset:function(b,d){if(d!==undefined){var c=this.get("minimumVerticalScrollOffset"),a=this.get("maximumVerticalScrollOffset");this._scroll_verticalScrollOffset=Math.max(c,Math.min(a,d))}return this._scroll_verticalScrollOffset||0}.property().cacheable(),maximumScrollOffset:function(b,a,c){if(b>=a){return b-a}if(c===SC.ALIGN_LEFT||c===SC.ALIGN_TOP){return 0}else{if(c===SC.ALIGN_MIDDLE||c===SC.ALIGN_CENTER){return 0-Math.round((a-b)/2)}else{return 0-(a-b)}}},minimumScrollOffset:function(b,a,c){if(b>a){return 0}if(c===SC.ALIGN_LEFT||c===SC.ALIGN_TOP){return 0}else{if(c===SC.ALIGN_MIDDLE||c===SC.ALIGN_CENTER){return 0-Math.round((a-b)/2)}else{return 0-(a-b)}}},maximumHorizontalScrollOffset:function(){var c=this.get("contentView");var b=c?c.get("frame").width:0,a=c?c.get("calculatedWidth"):0;if(a){b=c.calculatedWidth}b*=this._scale;var d=this.get("containerView").get("frame").width;if(!this.get("canScrollHorizontal")){b=Math.min(b,d)}return this.maximumScrollOffset(b,d,this.get("horizontalAlign"))}.property(),maximumVerticalScrollOffset:function(){var a=this.get("contentView"),c=(a&&a.get("frame"))?a.get("frame").height:0,b=a?a.get("calculatedHeight"):0;if(b){c=b}c*=this._scale;var d=this.get("containerView").get("frame").height;if(!this.get("canScrollVertical")){c=Math.min(c,d)}return this.maximumScrollOffset(c,d,this.get("verticalAlign"))}.property(),minimumHorizontalScrollOffset:function(){var c=this.get("contentView");var b=c?c.get("frame").width:0,a=c?c.get("calculatedWidth"):0;if(a){b=a}b*=this._scale;var d=this.get("containerView").get("frame").width;if(!this.get("canScrollHorizontal")){b=Math.min(b,d)}return this.minimumScrollOffset(b,d,this.get("horizontalAlign"))}.property(),minimumVerticalScrollOffset:function(){var a=this.get("contentView");var c=(a&&a.get("frame"))?a.get("frame").height:0,b=a?a.get("calculatedHeight"):0;if(b){c=a.calculatedHeight}c*=this._scale;var d=this.get("containerView").get("frame").height;if(!this.get("canScrollVertical")){c=Math.min(c,d)}return this.minimumScrollOffset(c,d,this.get("verticalAlign"))}.property(),verticalLineScroll:20,horizontalLineScroll:20,verticalPageScroll:function(){return this.get("frame").height}.property("frame"),horizontalPageScroll:function(){return this.get("frame").width}.property("frame"),hasHorizontalScroller:YES,horizontalScrollerView:SC.ScrollerView,horizontalTouchScrollerView:SC.TouchScrollerView,isHorizontalScrollerVisible:YES,canScrollHorizontal:function(){return !!(this.get("hasHorizontalScroller")&&this.get("horizontalScrollerView")&&this.get("isHorizontalScrollerVisible"))}.property("isHorizontalScrollerVisible").cacheable(),autohidesHorizontalScroller:YES,hasVerticalScroller:YES,verticalScrollerView:SC.ScrollerView,verticalTouchScrollerView:SC.TouchScrollerView,isVerticalScrollerVisible:YES,canScrollVertical:function(){return !!(this.get("hasVerticalScroller")&&this.get("verticalScrollerView")&&this.get("isVerticalScrollerVisible"))}.property("isVerticalScrollerVisible").cacheable(),autohidesVerticalScroller:YES,verticalScrollerBottom:0,verticalOverlay:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),horizontalOverlay:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),verticalScrollerLayout:null,horizontalScrollerLayout:null,containerView:SC.ContainerView.extend({}),scrollTo:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){b=a.y;a=a.x}if(!SC.none(a)){this.set("horizontalScrollOffset",a)}if(!SC.none(b)){this.set("verticalScrollOffset",b)}return this},scrollBy:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){b=a.y;a=a.x}a=(a)?this.get("horizontalScrollOffset")+a:null;b=(b)?this.get("verticalScrollOffset")+b:null;return this.scrollTo(a,b)},scrollToVisible:function(b){if(arguments.length===0){return arguments.callee.base.apply(this,arguments)}var c=this.get("contentView");if(!c){return NO}var a=b.get("frame");if(!a){return NO}a=c.convertFrameFromView(a,b.get("parentView"));return this.scrollToRect(a)},scrollToRect:function(b){var a=SC.cloneRect(this.get("containerView").get("frame"));a.x=this.get("horizontalScrollOffset");a.y=this.get("verticalScrollOffset");var d=a.x,c=a.y;a.y-=Math.max(0,SC.minY(a)-SC.minY(b));a.x-=Math.max(0,SC.minX(a)-SC.minX(b));a.y+=Math.max(0,SC.maxY(b)-SC.maxY(a));a.x+=Math.max(0,SC.maxX(b)-SC.maxX(a));if((d!==a.x)||(c!==a.y)){this.scrollTo(a.x,a.y);return YES}else{return NO}},scrollDownLine:function(a){if(a===undefined){a=1}return this.scrollBy(null,this.get("verticalLineScroll")*a)},scrollUpLine:function(a){if(a===undefined){a=1}return this.scrollBy(null,0-this.get("verticalLineScroll")*a)},scrollRightLine:function(a){if(a===undefined){a=1}return this.scrollTo(this.get("horizontalLineScroll")*a,null)},scrollLeftLine:function(a){if(a===undefined){a=1}return this.scrollTo(0-this.get("horizontalLineScroll")*a,null)},scrollDownPage:function(a){if(a===undefined){a=1}return this.scrollBy(null,this.get("verticalPageScroll")*a)},scrollUpPage:function(a){if(a===undefined){a=1}return this.scrollBy(null,0-(this.get("verticalPageScroll")*a))},scrollRightPage:function(a){if(a===undefined){a=1}return this.scrollBy(this.get("horizontalPageScroll")*a,null)},scrollLeftPage:function(a){if(a===undefined){a=1}return this.scrollBy(0-(this.get("horizontalPageScroll")*a),null)},tile:function(){var c=this.get("hasHorizontalScroller")?this.get("horizontalScrollerView"):null;var h=c&&this.get("isHorizontalScrollerVisible");var k=this.get("hasVerticalScroller")?this.get("verticalScrollerView"):null;var f=k&&this.get("isVerticalScrollerVisible");var e=this.get("containerView");var n={left:0,top:0};var m,g,b,o,d,a;var j=((h)?c.get("scrollbarThickness"):0);var l=(f)?k.get("scrollbarThickness"):0;if(h){a=this.get("horizontalScrollerLayout");g={left:(a?a.left:0),bottom:(a?a.bottom:0),right:(a?a.right+l-1:l-1),height:j};c.set("layout",g);o=this.get("horizontalOverlay");n.bottom=o?0:(g.bottom+j)}else{n.bottom=0}if(c){c.set("isVisible",h)}if(f){j=j+this.get("verticalScrollerBottom");d=this.get("verticalScrollerLayout");g={top:(d?d.top:0),bottom:(d?d.bottom+j:j),right:(d?d.right:0),width:l};k.set("layout",g);b=this.get("verticalOverlay");n.right=b?0:(g.right+l)}else{n.right=0}if(k){k.set("isVisible",f)}e.adjust(n)},scrollerVisibilityDidChange:function(){this.tile()}.observes("isVerticalScrollerVisible","isHorizontalScrollerVisible"),_scroll_wheelDeltaX:0,_scroll_wheelDeltaY:0,mouseWheel:function(a){var c=this.get("horizontalScrollOffset"),f=this.get("maximumHorizontalScrollOffset"),e=this.get("maximumVerticalScrollOffset"),b=NO,d=this.get("verticalScrollOffset");b=((this.get("canScrollHorizontal")&&(a.wheelDeltaX<0&&c>0)||(a.wheelDeltaX>0&&c<f))||(this.get("canScrollVertical")&&(a.wheelDeltaY<0&&d>0)||(a.wheelDeltaY>0&&d<e)));if(b){this._scroll_wheelDeltaX+=a.wheelDeltaX;this._scroll_wheelDeltaY+=a.wheelDeltaY;this.invokeLater(this._scroll_mouseWheel,10)}return b},_scroll_mouseWheel:function(){this.scrollBy(this._scroll_wheelDeltaX,this._scroll_wheelDeltaY);if(SC.WHEEL_MOMENTUM&&this._scroll_wheelDeltaY>0){this._scroll_wheelDeltaY=Math.floor(this._scroll_wheelDeltaY*0.95);this._scroll_wheelDeltaY=Math.max(this._scroll_wheelDeltaY,0);this.invokeLater(this._scroll_mouseWheel,10)}else{if(SC.WHEEL_MOMENTUM&&this._scroll_wheelDeltaY<0){this._scroll_wheelDeltaY=Math.ceil(this._scroll_wheelDeltaY*0.95);this._scroll_wheelDeltaY=Math.min(this._scroll_wheelDeltaY,0);this.invokeLater(this._scroll_mouseWheel,10)}else{this._scroll_wheelDeltaY=0;this._scroll_wheelDeltaX=0}}},canScale:NO,_scale:1,scale:function(a,b){if(b!==undefined){this._scale=Math.min(Math.max(this.get("minimumScale"),b),this.get("maximumScale"))}return this._scale}.property().cacheable(),minimumScale:0.25,maximumScale:2,autoScaleRange:NO,_scale_css:"",updateScale:function(b){var a=this.get("contentView");if(!a){return}if(a.isScalable){this.get("contentView").applyScale(b);this._scale_css=""}else{this._scale_css="scale3d("+b+", "+b+", 1)"}},acceptsMultitouch:YES,decelerationRate:SC.NORMAL_SCROLL_DECELERATION,alwaysBounceHorizontal:NO,alwaysBounceVertical:YES,delaysContentTouches:YES,_touchScrollDidChange:function(){if(this.get("contentView").touchScrollDidChange){this.get("contentView").touchScrollDidChange(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidChange){this.verticalScrollerView.touchScrollDidChange(this._scroll_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidChange){this.horizontalScrollerView.touchScrollDidChange(this._scroll_horizontalScrollOffset)}},_touchScrollDidStart:function(){if(this.get("contentView").touchScrollDidStart){this.get("contentView").touchScrollDidStart(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidStart){this.verticalScrollerView.touchScrollDidStart(this._touch_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidStart){this.horizontalScrollerView.touchScrollDidStart(this._touch_horizontalScrollOffset)}},_touchScrollDidEnd:function(){if(this.get("contentView").touchScrollDidEnd){this.get("contentView").touchScrollDidEnd(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidEnd){this.verticalScrollerView.touchScrollDidEnd(this._touch_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidEnd){this.horizontalScrollerView.touchScrollDidEnd(this._touch_horizontalScrollOffset)}},_applyCSSTransforms:function(b){var a="";this.updateScale(this._scale);a+="translate3d("+-this._scroll_horizontalScrollOffset+"px, "+-Math.round(this._scroll_verticalScrollOffset)+"px,0) ";a+=this._scale_css;if(b){var c=b.style;c.webkitTransform=a;c.webkitTransformOrigin="top left"}},captureTouch:function(a){return YES},touchGeneration:0,touchStart:function(b){var a=++this.touchGeneration;if(!this.tracking&&this.get("delaysContentTouches")){this.invokeLater(this.beginTouchesInContent,150,a)}else{if(!this.tracking){this.invokeLater(this.beginTouchesInContent,1,a)}}this.beginTouchTracking(b,YES);return YES},beginTouchesInContent:function(b){if(b!==this.touchGeneration){return}var c=this.touch,a;if(c&&this.tracking&&!this.dragging&&!c.touch.scrollHasEnded&&!c.touch.hasEnded){c.touch.captureTouch(this,YES);if(!c.touch.touchResponder){c.touch.makeTouchResponder(this)}else{if(c.needsScrollEnd){this._touchScrollDidEnd()}}}},beginTouchTracking:function(f,s){var q=f.averagedTouchesForView(this,s);var k=this._scroll_verticalScrollOffset||0,a=this._scroll_horizontalScrollOffset||0,m=a,l=k,e=NO,p=0,t=0,o,j;if(this.touch&&this.touch.timeout){clearTimeout(this.touch.timeout);this.touch.timeout=null;m=this.touch.startClipOffset.x;l=this.touch.startClipOffset.y;e=YES}j=this.get("contentView");if(j){o=j.get("frame");p=o.width;t=o.height}if(j.calculatedWidth&&j.calculatedWidth!==0){p=j.calculatedWidth}if(j.calculatedHeight&&j.calculatedHeight!==0){t=j.calculatedHeight}var g=this.get("containerView").get("frame"),h=g.width,n=g.height;var b=this.convertFrameToView(this.get("frame"),null),d=(a+(q.x-b.x))/this._scale,c=(k+(q.y-b.y))/this._scale;this.touch={startTime:f.timeStamp,notCalculated:YES,enableScrolling:{x:p*this._scale>h||this.get("alwaysBounceHorizontal"),y:t*this._scale>n||this.get("alwaysBounceVertical")},scrolling:{x:NO,y:NO},enableBouncing:SC.platform.bounceOnScroll,startClipOffset:{x:m,y:l},lastScrollOffset:{x:a,y:k},startTouchOffset:{x:q.x,y:q.y},scrollVelocity:{x:0,y:0},startTouchOffsetInContent:{x:d,y:c},containerSize:{width:h,height:n},contentSize:{width:p,height:t},startScale:this._scale,startDistance:q.d,canScale:this.get("canScale")&&SC.platform.pinchToZoom,minimumScale:this.get("minimumScale"),maximumScale:this.get("maximumScale"),globalFrame:b,layer:j.get("layer"),resistanceCoefficient:0.998,resistanceAsymptote:320,decelerationFromEdge:0.05,accelerationToEdge:0.1,scrollTolerance:{x:15,y:15},scaleTolerance:5,secondaryScrollTolerance:30,scrollLock:500,decelerationRate:this.get("decelerationRate"),lastEventTime:f.timeStamp,touch:(s?f:(this.touch?this.touch.touch:null)),needsScrollEnd:e};if(!this.tracking){this.tracking=YES;this.dragging=NO}},_adjustForEdgeResistance:function(f,d,b,c,a){var e;if(f<d){e=f-d}else{if(f>b){e=b-f}else{return f}}e=Math.pow(c,Math.abs(e))*a;if(f<d){e=e-a}else{e=-e+a}return Math.min(Math.max(d,f),b)+e},touchesDragged:function(a,c){if(SC.browser.isiOS){window.focus();$(".field").blur()}var b=a.averagedTouchesForView(this);this.updateTouchScroll(b.x,b.y,b.d,a.timeStamp)},updateTouchScroll:function(l,k,e,h){var g=this.touch,a=l-g.globalFrame.x,n=k-g.globalFrame.y,x,o,y,p,F,D,c=g.scrolling,t=this.get("horizontalAlign"),m=this.get("verticalAlign");var d=((this._scroll_horizontalScrollOffset||0)+a)/this._scale,b=((this._scroll_verticalScrollOffset||0)+n)/this._scale;var C=d-g.startTouchOffsetInContent.x,B=b-g.startTouchOffsetInContent.y;var j=g.dragging;if(!c.x&&Math.abs(C)>g.scrollTolerance.x&&g.enableScrolling.x){j=YES;c.x=YES;g.scrollTolerance.y=g.secondaryScrollTolerance;g.startTouchOffset.x=l;C=0}if(!c.y&&Math.abs(B)>g.scrollTolerance.y&&g.enableScrolling.y){j=YES;c.y=YES;g.scrollTolerance.x=g.secondaryScrollTolerance;g.startTouchOffset.y=k;B=0}if(j&&!g.dragging){g.dragging=YES;this.dragging=YES;this._touchScrollDidStart()}if(!c.x&&!c.y&&!g.canScale){return}if(c.x&&!c.y){if(C>g.scrollLock&&!c.y){g.enableScrolling.y=NO}}if(c.y&&!c.x){if(B>g.scrollLock&&!c.x){g.enableScrolling.x=NO}}if(g.canScale){var s=g.startDistance,z=e-s;if(Math.abs(z)>g.scaleTolerance){c.y=YES;c.x=YES;var E=g.startScale*(e/Math.max(s,50));var u=this._adjustForEdgeResistance(E,g.minimumScale,g.maximumScale,g.resistanceCoefficient,g.resistanceAsymptote);this.dragging=YES;this._scale=u;var w=d*this._scale,v=b*this._scale}}F=this.minimumScrollOffset(g.contentSize.width*this._scale,g.containerSize.width,t);D=this.minimumScrollOffset(g.contentSize.height*this._scale,g.containerSize.height,m);p=this.maximumScrollOffset(g.contentSize.width*this._scale,g.containerSize.width,t);o=this.maximumScrollOffset(g.contentSize.height*this._scale,g.containerSize.height,m);y=g.startTouchOffsetInContent.x*this._scale-a;x=g.startTouchOffsetInContent.y*this._scale-n;if(g.enableBouncing){y=this._adjustForEdgeResistance(y,F,p,g.resistanceCoefficient,g.resistanceAsymptote);x=this._adjustForEdgeResistance(x,D,o,g.resistanceCoefficient,g.resistanceAsymptote)}else{y=Math.max(F,Math.min(p,y));x=Math.max(D,Math.min(o,x))}if(c.x){this._scroll_horizontalScrollOffset=y}if(c.y){this._scroll_verticalScrollOffset=x}this._applyCSSTransforms(g.layer);this._touchScrollDidChange();if(h-g.lastEventTime>=1||g.notCalculated){g.notCalculated=NO;var f=this._scroll_horizontalScrollOffset;var q=this._scroll_verticalScrollOffset;g.scrollVelocity.x=((f-g.lastScrollOffset.x)/Math.max(1,h-g.lastEventTime));g.scrollVelocity.y=((q-g.lastScrollOffset.y)/Math.max(1,h-g.lastEventTime));g.lastScrollOffset.x=f;g.lastScrollOffset.y=q;g.lastEventTime=h}},touchEnd:function(c){var a=this.touch,b=c.averagedTouchesForView(this);c.scrollHasEnded=YES;if(b.touchCount>0){this.beginTouchTracking(c,NO)}else{if(this.dragging){a.dragging=NO;a.lastEventTime=c.timeStamp;this.startDecelerationAnimation()}else{if(a.needsScrollEnd){this._touchScrollDidEnd()}c.captureTouch(this,YES);if(c.touchResponder&&c.touchResponder!==this){c.end()}else{if(!c.touchResponder||c.touchResponder===this){if(c.nextTouchResponder){c.makeTouchResponder(c.nextTouchResponder)}}else{}}this.touch=null}this.tracking=NO;this.dragging=NO}},touchCancelled:function(c){var a=this.touch,b=c.averagedTouchesForView(this);if(!this.touch||!this.touch.timeout){this.beginPropertyChanges();this.set("scale",this._scale);this.set("verticalScrollOffset",this._scroll_verticalScrollOffset);this.set("horizontalScrollOffset",this._scroll_horizontalScrollOffset);this.endPropertyChanges();this.tracking=NO;if(this.dragging){this._touchScrollDidEnd()}this.dragging=NO;this.touch=null}},startDecelerationAnimation:function(a){var b=this.touch;b.decelerationVelocity={x:b.scrollVelocity.x*10,y:b.scrollVelocity.y*10};this.decelerateAnimation()},bouncyBounce:function(c,e,d,f,g,b,a){if(e<d){if(c<0){c=c+((d-e)*g)}else{c=Math.min((d-e)*b+a,d-e-0.01)}}else{if(e>f){if(c>0){c=c-((e-f)*g)}else{c=-Math.min((e-f)*b+a,e-f-0.01)}}}return c},decelerateAnimation:function(){var c=this.touch,B=this._scale,o=c.contentSize,p=c.containerSize,n=this.get("horizontalAlign"),e=this.get("verticalAlign"),z=this.minimumScrollOffset(o.width*this._scale,p.width,n),y=this.minimumScrollOffset(o.height*this._scale,p.height,e),j=this.maximumScrollOffset(o.width*this._scale,p.width,n),h=this.maximumScrollOffset(o.height*this._scale,p.height,e),a=Date.now(),f=Math.max(a-c.lastEventTime,1),v=this._scroll_horizontalScrollOffset+c.decelerationVelocity.x*(f/10),s=this._scroll_verticalScrollOffset+c.decelerationVelocity.y*(f/10);var u=c.decelerationFromEdge,w=c.accelerationToEdge;var m=!c.enableBouncing,l=!c.enableBouncing;if(v>=z&&v<=j){m=YES}if(s>=y&&s<=h){l=YES}v/=this._scale;s/=this._scale;var k=0;k=this.bouncyBounce(k,B,c.minimumScale,c.maximumScale,u,w,0);this._scale=B=B+k;v*=this._scale;s*=this._scale;z=this.minimumScrollOffset(o.width*this._scale,p.width,n);y=this.minimumScrollOffset(o.height*this._scale,p.height,e);j=this.maximumScrollOffset(o.width*this._scale,p.width,n);h=this.maximumScrollOffset(o.height*this._scale,p.height,e);if(m&&(v<z||v>j)){v=Math.max(z,Math.min(v,j));c.decelerationVelocity.x=0}if(l&&(s<y||s>h)){s=Math.max(y,Math.min(s,h));c.decelerationVelocity.y=0}this._scroll_horizontalScrollOffset=v;this._scroll_verticalScrollOffset=s;this._applyCSSTransforms(c.layer);this._touchScrollDidChange();var x=c.decelerationRate,b=Math.pow(x,(f/10));c.decelerationVelocity.y*=b;c.decelerationVelocity.x*=b;c.decelerationVelocity.x=this.bouncyBounce(c.decelerationVelocity.x,v,z,j,u,w,0.3);c.decelerationVelocity.y=this.bouncyBounce(c.decelerationVelocity.y,s,y,h,u,w,0.3);var q=Math.abs(c.decelerationVelocity.x),d=Math.abs(c.decelerationVelocity.y);if(d<0.05&&q<0.05&&Math.abs(k)<0.05){c.timeout=null;this.touch=null;this._touchScrollDidEnd();this.beginPropertyChanges();this.set("scale",this._scale);this.set("verticalScrollOffset",this._scroll_verticalScrollOffset);this.set("horizontalScrollOffset",this._scroll_horizontalScrollOffset);this.endPropertyChanges();return}var g=this;c.lastEventTime=Date.now();this.touch.timeout=setTimeout(function(){SC.run(g.decelerateAnimation(),g)},30)},createChildViews:function(){var b=[],a;if(SC.none(a=this.containerView)){a=SC.ContainerView}b.push(this.containerView=this.createChildView(a,{contentView:this.contentView,isScrollContainer:YES}));this.contentView=this.containerView.get("contentView");a=SC.platform.touch?this.get("horizontalTouchScrollerView"):this.get("horizontalScrollerView");if(a){if(this.get("hasHorizontalScroller")){a=this.horizontalScrollerView=this.createChildView(a,{layoutDirection:SC.LAYOUT_HORIZONTAL,valueBinding:"*owner.horizontalScrollOffset"});b.push(a)}else{this.horizontalScrollerView=null}}a=SC.platform.touch?this.get("verticalTouchScrollerView"):this.get("verticalScrollerView");if(a){if(this.get("hasVerticalScroller")){a=this.verticalScrollerView=this.createChildView(a,{layoutDirection:SC.LAYOUT_VERTICAL,valueBinding:"*owner.verticalScrollOffset"});b.push(a)}else{this.verticalScrollerView=null}}this.childViews=b;this.contentViewDidChange();this.tile()},init:function(){arguments.callee.base.apply(this,arguments);this._scroll_contentView=this.get("contentView");var a=this._scroll_contentView;if(a){a.addObserver("frame",this,this.contentViewFrameDidChange);a.addObserver("calculatedWidth",this,this.contentViewFrameDidChange);a.addObserver("calculatedHeight",this,this.contentViewFrameDidChange)}if(this.get("isVisibleInWindow")){this._scsv_registerAutoscroll()}},_scsv_registerAutoscroll:function(){if(this.get("isVisibleInWindow")){SC.Drag.addScrollableView(this)}else{SC.Drag.removeScrollableView(this)}}.observes("isVisibleInWindow"),contentViewDidChange:function(){var d=this.get("contentView"),a=this._scroll_contentView,b=this.contentViewFrameDidChange,c=this.contentViewLayerDidChange;if(d!==a){if(a){a.removeObserver("calculatedWidth",this,this.contentViewFrameDidChange);a.removeObserver("calculatedHeight",this,this.contentViewFrameDidChange);a.removeObserver("frame",this,b);a.removeObserver("layer",this,c)}this._scroll_contentView=d;if(d){d.addObserver("frame",this,b);d.addObserver("calculatedWidth",this,this.contentViewFrameDidChange);d.addObserver("calculatedHeight",this,this.contentViewFrameDidChange);d.addObserver("layer",this,c)}this.containerView.set("contentView",d);this.contentViewFrameDidChange()}}.observes("contentView"),render:function(a,b){this.invokeLast(this.adjustElementScroll);if(b){a.push('<div class="corner"></div>')}return arguments.callee.base.apply(this,arguments)},oldMaxHOffset:0,oldMaxVOffset:0,contentViewFrameDidChange:function(b){var p=this.get("contentView"),m=(p)?p.get("frame"):null,h=this._scale,c=0,s=0,k,j,n,t,o;if(!p||!m){return}c=p.get("calculatedWidth")||m.width||0;s=p.get("calculatedHeight")||m.height||0;c*=h;s*=h;if(!b&&(c===this._scroll_contentWidth)&&(s===this._scroll_contentHeight)){return}this._scroll_contentWidth=c;this._scroll_contentHeight=s;k=this.getPath("containerView.frame");j=k.width;n=k.height;if(this.get("hasHorizontalScroller")&&(p=this.get("horizontalScrollerView"))){if(this.get("autohidesHorizontalScroller")){this.set("isHorizontalScrollerVisible",c>j)}p.setIfChanged("maximum",c-j);p.setIfChanged("proportion",j/c)}if(this.get("hasVerticalScroller")&&(p=this.get("verticalScrollerView"))){if(this.get("autohidesVerticalScroller")){this.set("isVerticalScrollerVisible",s>n)}p.setIfChanged("maximum",s-n);p.setIfChanged("proportion",n/s)}if(!this.get("isVerticalScrollerVisible")&&(this.get("verticalScrollOffset")!==0)&&this.get("autohidesVerticalScroller")){this.set("verticalScrollOffset",0)}if(!this.get("isHorizontalScrollerVisible")&&(this.get("horizontalScrollOffset")!==0)&&this.get("autohidesHorizontalScroller")){this.set("horizontalScrollOffset",0)}var q=this.get("maximumVerticalScrollOffset"),l=this.get("verticalScrollOffset"),g=this.get("maximumHorizontalScrollOffset"),a=this.get("horizontalScrollOffset"),e=q<l,d=g<a;if(e||d){this.forceDimensionsRecalculation(d,e,l,a)}this.notifyPropertyChange("maximumVerticalScrollOffset");this.notifyPropertyChange("maximumHorizontalScrollOffset")},frameDidChange:function(){this.contentViewFrameDidChange(YES)}.observes("frame"),contentViewLayerDidChange:function(){if(this._verticalScrollOffset!==0){this._verticalScrollOffset=-1}if(this._horizontalScrollOffset!==0){this._horizontalScrollOffset=-1}this.invokeLast(this.adjustElementScroll)},_scroll_horizontalScrollOffsetDidChange:function(){this.invokeLast(this.adjustElementScroll)}.observes("horizontalScrollOffset"),_scroll_verticalScrollOffsetDidChange:function(){this.invokeLast(this.adjustElementScroll)}.observes("verticalScrollOffset"),adjustElementScroll:function(){var a=this.get("containerView"),d=this.get("contentView"),c=this.get("verticalScrollOffset"),b=this.get("horizontalScrollOffset");if(d){if(SC.platform.touch){this._applyCSSTransforms(d.get("layer"))}if(d._viewFrameDidChange){d._viewFrameDidChange()}}if(a&&!SC.platform.touch){a=a.$()[0];if(a){if(c!==this._verticalScrollOffset){a.scrollTop=c;this._verticalScrollOffset=c}if(b!==this._horizontalScrollOffset){a.scrollLeft=b;this._horizontalScrollOffset=b}}}},forceDimensionsRecalculation:function(b,c,e,a){var f=a;var d=e;this.scrollTo(0,0);if(b&&c){this.scrollTo(this.get("maximumHorizontalScrollOffset"),this.get("maximumVerticalScrollOffset"))}if(b&&!c){this.scrollTo(this.get("maximumHorizontalScrollOffset"),d)}if(!b&&c){this.scrollTo(f,this.get("maximumVerticalScrollOffset"))}},_scroll_verticalScrollOffset:0,_scroll_horizontalScrollOffset:0});sc_require("views/scroll");SC.MenuScrollerView=SC.ScrollerView.extend({classNames:["sc-menu-scroller-view"],scrollDown:NO,value:function(a,c){if(c!==undefined){this._value=c}else{var b=this._value||0;return Math.min(b,this.get("maximum"))}}.property("maximum").cacheable(),maximum:0,isEnabled:YES,layoutDirection:SC.LAYOUT_VERTICAL,verticalLineScroll:20,ownerScrollValueKey:function(){return"verticalScrollOffset"}.property("layoutDirection").cacheable(),init:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.TINY_SCROLLER_THICKNESS);break;case SC.SMALL_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.SMALL_SCROLLER_THICKNESS);break;case SC.REGULAR_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.REGULAR_SCROLLER_THICKNESS);break;case SC.LARGE_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.LARGE_SCROLLER_THICKNESS);break;case SC.HUGE_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.HUGE_SCROLLER_THICKNESS);break}return arguments.callee.base.apply(this,arguments)},render:function(a,c){a.addClass("sc-vertical");a.addClass(this.get("controlSize"));if(c){var b=this.get("scrollDown")?"arrowDown":"arrowUp";a.push('<span class="scrollArrow '+b+'">&nbsp;</span>')}a.setClass("disabled",!this.get("isEnabled"))},didCreateLayer:function(){},willDestroyLayer:function(){var a=this._sc_scroller_scrollDidChange;SC.Event.remove(this.$(),"scroll",this,a)},mouseEntered:function(a){this.set("isMouseOver",YES);this._invokeScrollOnMouseOver()},mouseExited:function(a){this.set("isMouseOver",NO)},_sc_scroller_valueDidChange:function(){}.observes("value"),_sc_scroller_armScrollTimer:function(){if(!this._sc_scrollTimer){SC.RunLoop.begin();var a=this._sc_scroller_scrollDidChange;this._sc_scrollTimer=this.invokeLater(a,50);SC.RunLoop.end()}},_sc_scroller_scrollDidChange:function(){var b=Date.now(),d=this._sc_lastScroll,c=this.get("layer"),a=0;if(d&&(b-d)<50){return this._sc_scroller_armScrollTimer()}this._sc_scrollTimer=null;this._sc_lastScroll=b;SC.RunLoop.begin();if(!this.get("isEnabled")){return}this._sc_scrollValue=a=c.scrollTop;this.set("value",a);SC.RunLoop.end()},_scrollMenu:function(){var b=this.get("value"),a;if(this.get("scrollDown")){a=b+this.verticalLineScroll;if(a<=this.get("maximum")){this.set("value",a)}}else{a=b-this.verticalLineScroll;if(a>=0){this.set("value",a)}else{if(b<=this.verticalLineScroll&&b>0){this.set("value",0)}}}return YES},_invokeScrollOnMouseOver:function(){this._scrollMenu();if(this.get("isMouseOver")){this.invokeLater(this._invokeScrollOnMouseOver,50)}}});SC.MenuScrollerView.REGULAR_SCROLLER_THICKNESS=18;SC.MenuScrollerView.TINY_SCROLLER_THICKNESS=10;SC.MenuScrollerView.SMALL_SCROLLER_THICKNESS=14;SC.MenuScrollerView.LARGE_SCROLLER_THICKNESS=23;SC.MenuScrollerView.HUGE_SCROLLER_THICKNESS=26;SC.MenuScrollView=SC.ScrollView.extend({classNames:["sc-menu-scroll-view"],maximumHorizontalScrollOffset:0,hasHorizontalScroller:NO,horizontalScrollerView:SC.MenuScrollerView,isHorizontalScrollerVisible:NO,canScrollHorizontal:NO,autohidesHorizontalScroller:NO,hasVerticalScroller:YES,verticalScrollerView:SC.MenuScrollerView,verticalScrollerView2:SC.MenuScrollerView,isVerticalScrollerVisible:YES,canScrollVertical:YES,autohidesVerticalScroller:YES,verticalScrollerBottom:0,controlSize:SC.REGULAR_CONTROL_SIZE,containerView:SC.ContainerView,scrollToVisible:function(b){if(arguments.length===0){return arguments.callee.base.apply(this,arguments)}var e=this.get("contentView");if(!e){return NO}var a=b.get("frame");if(!a){return NO}a=e.convertFrameFromView(a,b.get("parentView"));var c=this.get("verticalScrollerView2");if(c&&c.get("isVisible")){a.height+=c.get("frame").height}var d=this.get("verticalScrollerView");if(d&&d.get("isVisible")){a.top-=d.get("frame").height}return this.scrollToRect(a)},tile:function(){var g,u,h,b,s,j,c;g=this.get("hasVerticalScroller");u=g?this.get("verticalScrollerView"):null;h=g?this.get("verticalScrollerView2"):null;b=u&&this.get("isVerticalScrollerVisible");s=this.get("containerView");j={left:0,top:0};if(b){c=0;var a=u.get("scrollerThickness")||h.get("scrollerThickness");var k=this.get("contentView"),p,q=(k)?k.get("frame"):null,l=(q)?q.height:0,t=this.containerView.$()[0],m=this.get("verticalScrollOffset"),e={height:0,top:0,right:0,left:0},o={height:a,top:0,right:0,left:0},d={height:a,bottom:0,right:0,left:0},n={height:0,bottom:0,right:0,left:0};if(t){c=t.offsetHeight}if(m===0){j.top=0;j.bottom=a;u.set("layout",e);h.set("layout",d)}else{if(m>=(l-c-a)){j.top=a;j.bottom=0;u.set("layout",o);h.set("layout",n)}else{j.top=a;j.bottom=a;u.set("layout",o);h.set("layout",d)}}}if(u){u.set("isVisible",b);h.set("isVisible",b)}s.set("layout",j)},scrollerVisibilityDidChange:function(){this.tile()}.observes("isVerticalScrollerVisible","isHorizontalScrollerVisible","verticalScrollOffset"),createChildViews:function(){var c=[],b,a,d=this.get("controlSize");if(SC.none(b=this.containerView)){b=SC.ContainerView}c.push(this.containerView=this.createChildView(b,{contentView:this.contentView}));this.contentView=this.containerView.get("contentView");if((b=this.verticalScrollerView)&&(a=this.verticalScrollerView2)){if(this.get("hasVerticalScroller")){b=this.verticalScrollerView=this.createChildView(b,{layout:{top:0,left:0,right:0},controlSize:d,valueBinding:"*owner.verticalScrollOffset"});c.push(b);a=this.verticalScrollerView2=this.createChildView(a,{scrollDown:YES,layout:{bottom:0,left:0,right:0},controlSize:d,valueBinding:"*owner.verticalScrollOffset"});c.push(a)}else{this.verticalScrollerView=null;this.verticalScrollerView2=null}}this.childViews=c;this.contentViewFrameDidChange();this.tile()},init:function(){arguments.callee.base.apply(this,arguments);this._scroll_contentView=this.get("contentView");var a=this._scroll_contentView;if(a){a.addObserver("frame",this,this.contentViewFrameDidChange)}if(this.get("isVisibleInWindow")){this._scsv_registerAutoscroll()}},_scsv_registerAutoscroll:function(){if(this.get("isVisibleInWindow")){SC.Drag.addScrollableView(this)}else{SC.Drag.removeScrollableView(this)}}.observes("isVisibleInWindow"),contentViewFrameDidChange:function(){var c=this.get("contentView"),b,h=(c)?c.get("frame"):null,e=(h)?h.width:0,a=(h)?h.height:0,j=this.get("frame"),d,g;this._scroll_contentWidth=e;this._scroll_contentHeight=a;if(this.get("hasVerticalScroller")&&(c=this.get("verticalScrollerView"))&&(b=this.get("verticalScrollerView2"))){a-=1;if(this.get("autohidesVerticalScroller")){this.set("isVerticalScrollerVisible",a>j.height)}a-=this.get("verticalScrollerBottom");d=0;g=this.containerView.$()[0];if(g){d=g.offsetHeight}a=a-d;c.setIfChanged("maximum",a);b.setIfChanged("maximum",a)}},_scroll_horizontalScrollOffsetDidChange:function(){},_scroll_verticalScrollOffsetDidChange:function(){var b=this.get("verticalScrollOffset");var a=this.get("contentView");if(a){a.$().css("top",(0-b)+"px")}}.observes("verticalScrollOffset")});sc_require("views/workspace");SC.TO_LEFT="TOLEFT";SC.TO_RIGHT="TORIGHT";SC.NavigationView=SC.WorkspaceView.extend({_views:null,_current:null,navigationContentView:SC.View,init:function(){arguments.callee.base.apply(this,arguments);this._views=[]},createChildViews:function(){arguments.callee.base.apply(this,arguments);var a=this.get("navigationContentView");if(a.isClass){a=this.createChildView(a)}this._defaultContent=this.navigationContentView=a;this.contentView.appendChild(a)},changeNavigationContent:function(a){var c=null,b=null;if(a){c=a.get("topToolbar");b=a.get("bottomToolbar")}if(c&&c.isClass){a.set("topToolbar",c=c.create())}if(b&&b.isClass){a.set("bottomToolbar",b=b.create())}this.beginPropertyChanges();this._current=a;this.set("navigationContentView",a?a:this._defaultContent);this.set("topToolbar",c);this.set("bottomToolbar",b);this.endPropertyChanges()},push:function(a){this._currentDirection=this._current?SC.TO_LEFT:null;if(this._current){this._views.push(this._current)}this.changeNavigationContent(a)},pop:function(){this._currentDirection=SC.TO_RIGHT;var a=this._views.pop();this.changeNavigationContent(a)},popToView:function(b){this._currentDirection=SC.TO_RIGHT;var d=this._views,a=d.length-1,c=d[a];while(c&&c!==b){this._views.pop();a--;c=d[a]}this.changeNavigationContent(c)},topToolbarDidChange:function(){var b=this.activeTopToolbar,a=this.get("topToolbar");if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.buildOutChild(b)}else{this.removeChild(b)}}if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.buildInChild(a)}else{this.appendChild(a)}}this.activeTopToolbar=a;this.invokeOnce("childDidChange")}.observes("topToolbar"),bottomToolbarDidChange:function(){var b=this.activeBottomToolbar,a=this.get("bottomToolbar");if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.buildOutChild(b)}else{this.removeChild(b)}}if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.buildInChild(a)}else{this.appendChild(a)}}this.activeBottomToolbar=a;this.invokeOnce("childDidChange")}.observes("topToolbar"),contentViewDidChange:function(){var b=this.activeNavigationContentView,a=this.get("navigationContentView");if(!a.isNavigationBuilder){a.mixin(SC.NavigationBuilder)}this._pendingBuildOut=b;this._pendingBuildIn=a;this.activeNavigationContentView=a;this.invokeOnce("childDidChange")}.observes("navigationContentView"),childDidChange:function(){var a=this._pendingBuildIn,b=this._pendingBuildOut;if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.contentView.buildOutChild(b)}else{this.contentView.removeChild(b)}}this._scws_tile();if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.contentView.buildInChild(a)}else{this.contentView.appendChild(a)}}}});sc_require("views/toolbar");SC.NavigationBarView=SC.ToolbarView.extend(SC.Gesturable,{init:function(){arguments.callee.base.apply(this,arguments);if(!SC.Animatable){SC.Logger.error("NavigationBarView requires SC.Animatable. Please make your app or framework require the animation framework. CRASH.")}},mixinAnimatable:function(){this.mixin(SC.Animatable);this.transitions=this.navigationTransitions},navigationTransitions:{opacity:{duration:0.25,action:"didFinishTransition"}},style:{opacity:1},gestures:["swipeGesture"],swipeGesture:SC.SwipeGesture,swipe:function(d,h,f){var e=(f===SC.SWIPE_LEFT)?"isSwipeLeft":"isSwipeRight",c=this.get("childViews"),g,b,a=c.get("length");for(b=0;b<a;b++){g=c[b];if(g.get(e)){h.makeTouchResponder(g);h.end();return}}},resetBuild:function(){if(!this.isAnimatable){this.mixinAnimatable()}},didFinishTransition:function(){if(this.isBuildingIn){this.buildInDidFinish()}else{if(this.isBuildingOut){this.buildOutDidFinish()}}},preBuildIn:function(){this.disableAnimation();this.adjust("opacity",0).updateLayout();this.enableAnimation();var c=this.get("childViews"),d,b,a=c.get("length");for(b=0;b<a;b++){d=c[b];if(d.disableNavigationTransition){continue}if(!d._nv_mixedIn){this.mixinNavigationChild(d)}d.disableAnimation();d.transform(this.buildDirection===SC.TO_LEFT?100:-100);d.enableAnimation()}},buildIn:function(){this.preBuildIn();this.invokeLater("startBuildIn",10)},startBuildIn:function(){this.adjust("opacity",1);var c=this.get("childViews"),d,b,a=c.get("length");for(b=0;b<a;b++){d=c[b];if(d.disableNavigationTransition){continue}d.transform(0)}},buildOut:function(){this.adjust("opacity",0);var c=this.get("childViews"),d,b,a=c.get("length");for(b=0;b<a;b++){d=c[b];if(d.disableNavigationTransition){continue}if(!d._nv_mixedIn){this.mixinNavigationChild(d)}d.transform(this.buildDirection===SC.TO_LEFT?-100:100)}},mixinNavigationChild:function(a){if(a.isAnimatable){return}a.mixin(SC.Animatable);a.mixin({transitions:{transform:{timing:SC.Animatable.TRANSITION_EASE_IN_OUT,duration:0.25}},naturalLayout:a.get("layout"),transform:function(b){if(SC.platform.supportsCSS3DTransforms){this.adjust("transform","translate3d("+b+"px,0px,0px)")}else{this.adjust("transform","translate("+b+"px,0px)")}}});a._nv_mixedIn=YES}});sc_require("views/button");SC.PopupButtonView=SC.ButtonView.extend({classNames:["sc-popup-button"],renderDelegateName:"popupButtonRenderDelegate",preferMatrix:null,menu:null,shouldLoadInBackground:NO,init:function(){arguments.callee.base.apply(this,arguments);this._setupMenu();if(this.get("shouldLoadInBackground")){SC.backgroundTaskQueue.push(SC.PopupButtonMenuLoader.create({popupButton:this}))}},_setupMenu:function(){var a=this.get("instantiatedMenu");if(this.isActiveBinding){this.isActiveBinding.disconnect()}this.isActiveBinding=null;if(a&&!a.isClass){this.isActiveBinding=this.bind("isActive",a,"isVisibleInWindow")}},_popup_menuDidChange:function(){this._setupMenu()}.observes("menu"),isActive:NO,_instantiateMenu:function(){var a=this.get("menu");if(!a||!a.isClass){return}this.menu=a.create();this._setupMenu()},instantiatedMenu:function(){var a=this.get("menu");if(a&&a.isClass){this._instantiateMenu();a=this.get("menu")}return a}.property("menu").cacheable(),action:function(a){var b=this.get("instantiatedMenu");if(!b){return NO}b.popup(this,this.get("preferMatrix"));return YES},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this._isMouseDown=YES;this._action();this._menuRenderedTimestamp=0;var b=this;setTimeout(function(){SC.run(function(){b._menuRenderedTimestamp=Date.now()})},1);this.becomeFirstResponder();return YES},mouseUp:function(b){var d=new Date().getTime(),c=this._menuRenderedTimestamp,e=this.get("instantiatedMenu"),f=SC.platform.touch,a;if(c===0){c=Date.now()}if(e){a=e.getPath("rootMenu.targetMenuItem");if(a){if(!a.performAction()){e.remove()}}else{if(!f&&(d-c>SC.ButtonView.CLICK_AND_HOLD_DELAY)){e.remove()}}}this._isMouseDown=NO;arguments.callee.base.apply(this,arguments);return YES},mouseExited:function(a){return YES},performKeyEquivalent:function(b,a){if(!this.get("isEnabled")){return NO}var c=this.get("instantiatedMenu");return(!!c&&c.performKeyEquivalent(b,a,YES))}});SC.PopupButtonMenuLoader=SC.Task.extend({popupButton:null,run:function(){if(this.popupButton){this.popupButton._instantiateMenu()}}});SC.ProgressView=SC.View.extend(SC.Control,{classNames:["sc-progress-view"],displayProperties:["displayValue","ariaValue","minimum","maximum","isEnabled","isIndeterminate","isRunning","isVisibleInWindow"],renderDelegateName:"progressRenderDelegate",value:0.5,valueBindingDefault:SC.Binding.single().notEmpty(),displayValue:function(){var b=this.get("minimum")||0,c=this.get("maximum")||1,a=this.get("value")||0;a=(a-b)/(c-b);if(a>1){a=1}if(isNaN(a)){a=0}if(a<b){a=0}if(a>c){a=1}return a}.property("value","maximum","minimum").cacheable(),ariaRole:"progressbar",ariaValue:function(){return this.get("value")}.property("value").cacheable(),minimum:0,minimumBindingDefault:SC.Binding.single().notEmpty(),contentMinimumKey:null,maximum:1,maximumBindingDefault:SC.Binding.single().notEmpty(),contentMaximumKey:null,isIndeterminate:NO,isIndeterminateBindingDefault:SC.Binding.bool(),isRunning:NO,isRunningBindingDefault:SC.Binding.bool(),contentIsIndeterminateKey:null,contentPropertyDidChange:function(c,a){var b=this.get("content");this.beginPropertyChanges().updatePropertyFromContent("value",a,"contentValueKey",b).updatePropertyFromContent("minimum",a,"contentMinimumKey",b).updatePropertyFromContent("maximum",a,"contentMaximumKey",b).updatePropertyFromContent("isIndeterminate",a,"contentIsIndeterminateKey",b).endPropertyChanges()},didCreateLayer:function(){if(this.get("isIndeterminate")&&this.get("isRunning")&&this.get("isVisibleInWindow")){this.displayDidChange()}}});SC.RadioView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-radio-view"],ariaRole:"radiogroup",displayProperties:["displayItems","isEnabled","layoutDirection"],renderDelegateName:"radioGroupRenderDelegate",itemAriaLabeledByKey:null,itemAriaLabelKey:null,value:null,layoutDirection:SC.LAYOUT_VERTICAL,escapeHTML:YES,items:[],itemTitleKey:null,itemWidthKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemsDidChange:function(){if(this._items){this._items.removeObserver("[]",this,this.itemContentDidChange)}this._items=this.get("items");if(this._items){this._items.addObserver("[]",this,this.itemContentDidChange)}this.itemContentDidChange()}.observes("items"),itemContentDidChange:function(){this._renderAsFirstTime=YES;this.notifyPropertyChange("displayItems")},displayItems:function(){var l=this.get("items"),q=this.get("value"),h=SC.isArray(q),f=this.get("localize"),d=this.get("itemTitleKey"),e=this.get("itemValueKey"),p=this.get("itemWidthKey"),c=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,k=this.get("itemIsEnabledKey"),y=this.get("itemIconKey"),g=this.get("itemAriaLabeledByKey"),B=this.get("itemAriaLabelKey"),x=this._displayItems||[],s=(l)?l.get("length"):0,v,z,m,n,j,w,u,o,b,a,t;for(j=0;j<s;j++){v=l.objectAt(j);if(SC.typeOf(v)===SC.T_ARRAY){z=v[0];n=v[1]}else{if(v){if(d){z=v.get?v.get(d):v[d]}else{z=(v.toString)?v.toString():null}if(p&&c){m=v.get?v.get(p):v[p]}if(e){n=v.get?v.get(e):v[e]}else{n=v}if(k){w=v.get?v.get(k):v[k]}else{w=YES}if(y){u=v.get?v.get(y):v[y]}else{u=null}if(g){a=v.get?v.get(g):v[g]}else{a=null}if(B){t=v.get?v.get(B):v[B]}else{t=null}}else{z=n=u=null;w=NO}}w=w&&this.get("isEnabled");if(v){o=(h)?(q.indexOf(n)>=0):(q===n)}else{o=NO}if(f){z=SC.String.loc(z)}x.push(SC.Object.create({title:z,icon:u,width:m,value:n,isEnabled:w,isSelected:(h&&q.indexOf(n)>=0&&q.length===1)||(q===n),isMixed:(h&&q.indexOf(n)>=0),isActive:this._activeRadioButton===j,theme:this.get("theme"),renderState:{}}))}return x}.property("isEnabled","value","items","itemTitleKey","itemWidthKey","itemValueKey","itemIsEnabledKey","localize","itemIconKey","itemAriaLabeledByKey","itemAriaLabelKey").cacheable(),mouseDown:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-radio-button")){return YES}var d=this.get("renderDelegate"),c=this.get("renderDelegateProxy"),f=this.$(),b=d.indexForEvent(c,f,a);this._activeRadioButton=b;if(b!==undefined){var e=this.get("displayItems")[b];if(e.get("isEnabled")){e.set("isActive",YES);d.updateRadioAtIndex(c,f,b)}}a.allowDefault();return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-radio-button")){return YES}var d=this.get("renderDelegate"),c=this.get("renderDelegateProxy"),f=this.$(),g=this.get("displayItems"),b=d.indexForEvent(c,f,a);if(this._activeRadioButton!==undefined&&b!==this._activeRadioButton){g[this._activeRadioButton].set("isActive",NO);d.updateRadioAtIndex(c,f,this._activeRadioButton)}this._activeRadioButton=undefined;if(b!==undefined){var e=this.get("displayItems")[b];if(e.get("isEnabled")){e.set("isActive",NO);d.updateRadioAtIndex(c,f,b);this.set("value",e.value)}}a.allowDefault();return YES},keyDown:function(j){if(!this.get("isEnabled")){return YES}if(j.which===9||j.keyCode===9){var h=j.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(h){h.becomeFirstResponder()}else{j.allowDefault()}return YES}if(j.which>=37&&j.which<=40){var g=this.get("renderDelegate"),f=this.get("renderDelegateProxy"),c=this.$(),e=this.get("displayItems"),b=this.get("value");for(var d=0,a=e.length;d<a;d++){if(b===e[d].value){break}}if(j.which===37||j.which===38){if(d<=0){d=e.length-1}else{d--}}if(j.which===39||j.which===40){if(d>=e.length-1){d=0}else{d++}}g.updateRadioAtIndex(f,c,d);this.set("value",e[d].value)}j.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)}});SC.SceneView=SC.ContainerView.extend({scenes:["master","detail"],nowShowing:null,transitionDuration:200,_state:"NO_VIEW",replaceContent:function(a){if(a&&this._state===this.READY){this.animateScene(a)}else{this.replaceScene(a)}return this},replaceScene:function(c){var d=this._targetView,e=this.STANDARD_LAYOUT,b=this.get("scenes"),a=b?b.indexOf(this.get("nowShowing")):-1;this._targetView=c;this._targetIndex=a;if(this._timer){this._timer.invalidate()}this._leftView=this._rightView=this._start=this._end=null;this._timer=null;this.removeAllChildren();if(d){d.set("layout",e)}if(c){c.set("layout",e)}if(c){this.appendChild(c)}this._state=c?this.READY:this.NO_VIEW},animateScene:function(b){var c=this._targetView,f=this._targetIndex,a=this.get("scenes"),e=a?a.indexOf(this.get("nowShowing")):-1,d;if(f<0||e<0||f===e){return this.replaceScene(b)}this._targetView=b;this._targetIndex=e;if(e>f){this._leftView=c;this._rightView=b;this._target=-1}else{this._leftView=b;this._rightView=c;this._target=1}this.removeAllChildren();if(c){this.appendChild(c)}if(b){this.appendChild(b)}this._start=Date.now();this._end=this._start+this.get("transitionDuration");this._state=this.ANIMATING;this.tick()},tick:function(){this._timer=null;var a=Date.now(),d=(a-this._start)/(this._end-this._start),g=this._target,f=this._leftView,b=this._rightView,c,e;if(d<0){d=0}if(!this.get("isVisibleInWindow")||(d>=1)){return this.replaceScene(this._targetView)}c=SC.clone(this.get("frame"));e=Math.floor(c.width*d);if(g>0){c.left=0-(c.width-e);f.set("layout",c);c=SC.clone(c);c.left=e;b.set("layout",c)}else{c.left=0-e;f.set("layout",c);c=SC.clone(c);c.left=c.width-e;b.set("layout",c)}this._timer=this.invokeLater(this.tick,20);return this},NO_VIEW:"NO_VIEW",ANIMATING:"ANIMATING",READY:"READY",STANDARD_LAYOUT:{top:0,left:0,bottom:0,right:0}});SC.SegmentView=SC.View.extend(SC.Control,{ariaRole:"button",isSegment:YES,classNames:["sc-segment-view"],toolTip:null,isEnabled:YES,isActive:NO,isSelected:NO,layoutDirection:SC.LAYOUT_HORIZONTAL,controlSize:null,supportFocusRing:NO,displayProperties:["icon","displayTitle","value","displayToolTip","isDefault","isCancel","width","isSegment","isFirstSegment","isMiddleSegment","isLastSegment","isOverflowSegment","index","layoutDirection"],renderDelegateName:"segmentRenderDelegate",useStaticLayout:YES,title:"",value:null,icon:null,localize:NO,keyEquivalent:null,escapeHTML:YES,needsEllipsis:YES,displayTitle:function(){var a=this.get("title");if(this.get("localize")){a=SC.String.loc(a)}return a}.property("title","localize").cacheable(),width:null,localItem:null,widthDidChange:function(){this.adjust("width",this.get("width"))}.observes("width"),updateItem:function(d,c){var g=d.get("itemKeys"),f,a=d.get("viewKeys"),e,b;for(b=g.get("length")-1;b>=0;b--){f=d.get(g.objectAt(b));e=a.objectAt(b);if(!SC.none(c.get(f))){this.set(e,c.get(f))}}this.set("localItem",c)}});sc_require("views/segment");SC.SegmentedView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled").cacheable(),ariaRole:"group",classNames:["sc-segmented-view"],theme:"square",value:null,isEnabled:YES,allowsEmptySelection:NO,allowsMultipleSelection:NO,selectSegmentWhenTriggeringAction:NO,localize:YES,align:SC.ALIGN_CENTER,layoutDirection:SC.LAYOUT_HORIZONTAL,items:null,itemTitleKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemWidthKey:null,itemActionKey:null,itemTargetKey:null,itemLayerIdKey:null,itemKeyEquivalentKey:null,shouldHandleOverflow:YES,overflowTitle:"&raquo;",overflowToolTip:"More&hellip;",overflowIcon:null,segmentViewClass:SC.SegmentView,itemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemWidthKey","itemToolTipKey","itemKeyEquivalentKey","itemLayerIdKey"],viewKeys:["title","value","isEnabled","icon","width","toolTip","keyEquivalent","layerId"],init:function(){arguments.callee.base.apply(this,arguments);var d=this.get("overflowTitle"),a=this.get("overflowToolTip"),b=this.get("overflowIcon"),c;c=this.get("segmentViewClass").create({controlSize:this.get("controlSize"),localize:this.get("localize"),title:d,toolTip:a,icon:b,isLastSegment:YES,isOverflowSegment:YES,layoutDirection:this.get("layoutDirection"),isVisible:this.get("shouldHandleOverflow")});this.set("overflowView",c);this.appendChild(c);this.itemsDidChange()},shouldHandleOverflowDidChange:function(){if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}else{this.get("overflowView").set("isVisible",NO)}}.observes("shouldHandleOverflow"),itemsDidChange:function(){var m=this.get("items")||[],s,c,h,o=this.get("childViews"),k,d=o.lastObject(),p=this.get("value"),b,q=this.get("itemKeys"),a,n=this.get("viewKeys"),f,l=this.get("segmentViewClass"),g,e;if(o.get("length")-1>m.get("length")){for(g=o.get("length")-2;g>=m.get("length");g--){k=o.objectAt(g);c=k.get("localItem");if(c instanceof SC.Object){for(e=q.get("length")-1;e>=0;e--){a=this.get(q.objectAt(e));if(a){c.removeObserver(a,this,this.itemContentDidChange)}}}if(SC.isArray(p)){p.removeObject(c)}else{if(p===c){p=null}}this.removeChild(k)}this.set("value",p)}else{if(o.get("length")-1<m.get("length")){for(g=o.get("length")-1;g<m.get("length");g++){k=l.create({controlSize:this.get("controlSize"),localize:this.get("localize"),layoutDirection:this.get("layoutDirection")});this.insertBefore(k,d)}}}o=this.get("childViews");for(g=0;g<m.get("length");g++){c=m.objectAt(g);k=o.objectAt(g);h=k.get("localItem");if(h instanceof SC.Object&&!m.contains(h)){for(e=q.get("length")-1;e>=0;e--){a=this.get(q.objectAt(e));if(a){h.removeObserver(a,this,this.itemContentDidChange)}}}if(SC.none(c)){continue}if(SC.typeOf(c)===SC.T_STRING){c=SC.Object.create({title:c.humanize().titleize(),value:c});this.set("itemTitleKey","title");this.set("itemValueKey","value")}else{if(SC.typeOf(c)===SC.T_HASH){c=SC.Object.create(c)}else{if(c instanceof SC.Object){for(e=q.get("length")-1;e>=0;e--){a=this.get(q.objectAt(e));if(a){c.removeObserver(a,this,this.itemContentDidChange);c.addObserver(a,this,this.itemContentDidChange,g)}}}else{SC.Logger.error("SC.SegmentedView items may be Strings, Objects (ie. Hashes) or SC.Objects only")}}}b=NO;if(SC.isArray(p)?p.indexOf(c.get(this.get("itemValueKey")))>=0:p===c.get(this.get("itemValueKey"))){b=YES}k.set("isSelected",b);k.set("index",g);k.set("isFirstSegment",g===0);k.set("isMiddleSegment",g<m.get("length")-1&&g>0);k.set("isLastSegment",g===m.get("length")-1);k.updateItem(this,c)}if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}}.observes("*items.[]"),itemContentDidChange:function(e,d,b,c){var a=this.get("items"),f=this.get("childViews"),g;g=f.objectAt(c);if(g){g.updateItem(this,e)}else{SC.Logger.warn("Item content change was observed on item without matching segment child view.")}if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}},viewDidResize:function(){var b=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,a=b?this.$().width():this.$().height();if(this.get("shouldHandleOverflow")&&(this.isOverflowing||a<=this.cachedMinimumDim)){this.adjustOverflow()}},isVisibleInWindowDidChange:function(){if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}}.observes("isVisibleInWindow"),remeasure:function(){if(!this.get("shouldHandleOverflow")){return}var a=this.get("renderDelegate"),d=this.get("childViews"),c;if(this.get("isVisibleInWindow")){c=d.lastObject();c.set("isVisible",YES);for(var b=d.get("length")-1;b>=0;b--){d.objectAt(b).set("isVisible",YES)}this.cachedDims=this.segmentDimensions();this.cachedOverflowDim=this.overflowSegmentDim();this.adjustOverflow()}},adjustOverflow:function(){if(!this.get("shouldHandleOverflow")){return}var f=this.get("childViews"),e,h=this.get("value"),b=f.lastObject(),g=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,k=g?this.$().width():this.$().height(),d=0,j,a,c;this.isOverflowing=NO;b.set("isSelected",NO);this.overflowItems=[];a=this.cachedDims.length;for(c=0;c<a;c++){e=f.objectAt(c);d+=this.cachedDims[c];j=(c===a-1)?d:d+this.cachedOverflowDim;if(j>k){overflowItem={};localItem=e.get("localItem");overflowItem[this.get("itemTitleKey")]=localItem.get(this.get("itemTitleKey"));overflowItem[this.get("itemIconKey")]=localItem.get(this.get("itemIconKey"));overflowItem[this.get("itemIsEnabledKey")]=localItem.get(this.get("itemIsEnabledKey"));overflowItem[this.get("itemKeyEquivalentKey")]=localItem.get(this.get("itemKeyEquivalentKey"));overflowItem[this.get("itemValueKey")]=localItem.get(this.get("itemValueKey"));this.overflowItems.pushObject(overflowItem);this.isOverflowing=YES;e.set("isVisible",NO);if(c===0){b.set("isFirstSegment",YES)}if(SC.isArray(h)?h.indexOf(e.get("value"))>=0:h===e.get("value")){b.set("isSelected",YES)}}else{e.set("isVisible",YES);if(c===0){b.set("isFirstSegment",NO)}}}if(this.isOverflowing){b.set("isVisible",YES)}else{b.set("isVisible",NO)}this.cachedMinimumDim=d+this.cachedOverflowDim},segmentDimensions:function(){var b=this.get("childViews"),a,e,h=[],g=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL;for(var c=0,d=b.length;c<d-1;c++){a=b[c];e=a.get("frame");h[c]=g?e.width:e.height}return h},overflowSegmentDim:function(){var b=this.get("childViews"),a,c,d=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL;a=b.length&&b[b.length-1];if(a){c=a.get("frame");return d?c.width:c.height}return 0},indexForClientPosition:function(b,h){var d=this.get("childViews"),g,e,c,f,a;a={x:b,y:h};for(e=0,g=d.length;e<g;e++){c=d[e];f=c.get("layer").getBoundingClientRect();f={x:f.left,y:f.top,width:(f.right-f.left),height:(f.bottom-f.top)};if(SC.pointInRect(a,f)){return e}}return -1},displayProperties:["align"],renderDelegateName:"segmentedRenderDelegate",displayItemIndexForEvent:function(b){var c=this.get("renderDelegate");var a=b.clientX;var f=b.clientY;if(a===0&&f===0){var d=b.target;if(d){var e=SC.offset(d);a=e.x+Math.round(d.offsetWidth/2);f=e.y+Math.round(d.offsetHeight/2)}}if(c&&c.indexForClientPosition){return c.indexForClientPosition(this,a,f)}return this.indexForClientPosition(b.clientX,b.clientY)},keyDown:function(c){var g,h,d,e,f,b;if(c.which===9||c.keyCode===9){var a=c.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{c.allowDefault()}return YES}if(!this.get("allowsMultipleSelection")){g=this.get("childViews");e=g.get("length");f=this.get("value");b=SC.isArray(f);if(c.which===39||c.which===40){if(f){for(d=0;d<e-2;d++){h=g.objectAt(d);if(b?(f.indexOf(h.get("value"))>=0):(h.get("value")===f)){this.triggerItemAtIndex(d+1)}}}else{this.triggerItemAtIndex(0)}return YES}else{if(c.which===37||c.which===38){if(f){for(d=1;d<e-1;d++){h=g.objectAt(d);if(b?(f.indexOf(h.get("value"))>=0):(h.get("value")===f)){this.triggerItemAtIndex(d-1)}}}else{this.triggerItemAtIndex(e-2)}return YES}}}return NO},mouseDown:function(a){var c=this.get("childViews"),e,d=c.get("length")-1,b;if(!this.get("isEnabled")){return YES}b=this.displayItemIndexForEvent(a);if(b>=0){e=c.objectAt(b);if(e.get("isEnabled")){e.set("isActive",YES)}this.activeChildView=e;if(b===d){this.showOverflowMenu()}else{this._isMouseDown=YES}}return YES},mouseUp:function(a){var c,b;b=this.displayItemIndexForEvent(a);if(this._isMouseDown&&(b>=0)){this.triggerItemAtIndex(b);c=this.activeChildView;if(c){c.set("isActive",NO);this.activeChildView=null}}this._isMouseDown=NO;return YES},mouseMoved:function(a){var d=this.get("childViews"),e=d.get("length")-1,c,f,b;if(this._isMouseDown){b=this.displayItemIndexForEvent(a);c=this.activeChildView;f=d.objectAt(b);if(f&&f!==c){if(c){c.set("isActive",NO)}if(f.get("isEnabled")){f.set("isActive",YES)}this.activeChildView=f;if(b===e){this.showOverflowMenu();this._isMouseDown=NO}}}return YES},mouseEntered:function(a){var c=this.get("childViews"),e,d=c.get("length")-1,b;if(this._isMouseDown){b=this.displayItemIndexForEvent(a);if(b===d){this.showOverflowMenu();this._isMouseDown=NO}else{if(b>=0){e=c.objectAt(b);if(e.get("isEnabled")){e.set("isActive",YES)}this.activeChildView=e}}}return YES},mouseExited:function(a){var b;if(this._isMouseDown){b=this.activeChildView;if(b){b.set("isActive",NO)}this.activeChildView=null}return YES},touchStart:function(e){var b=this.get("childViews"),d,c=b.get("length")-1,a;if(!this.get("isEnabled")){return YES}a=this.displayItemIndexForEvent(e);if(a>=0){d=b.objectAt(a);d.set("isActive",YES);this.activeChildView=d;if(a===c){this.showOverflowMenu()}else{this._isTouching=YES}}return YES},touchEnd:function(c){var b,a;a=this.displayItemIndexForEvent(c);if(this._isTouching&&(a>=0)){this.triggerItemAtIndex(a);b=this.activeChildView;b.set("isActive",NO);this.activeChildView=null;this._isTouching=NO}return YES},touchesDragged:function(a,e){var h=this.touchIsInBoundary(a),d=this.get("childViews"),f=d.get("length")-1,c,g,b;if(h){if(!this._isTouching){this._touchDidEnter(a)}b=this.displayItemIndexForEvent(a);c=this.activeChildView;g=d[b];if(g&&g!==c){if(c){c.set("isActive",NO)}g.set("isActive",YES);this.activeChildView=g;if(b===f){this.showOverflowMenu();this._isMouseDown=NO}}}else{if(this._isTouching){this._touchDidExit(a)}}this._isTouching=h;return YES},_touchDidExit:function(a){var b;if(this.isTouching){b=this.activeChildView;b.set("isActive",NO);this.activeChildView=null}return YES},_touchDidEnter:function(a){var c=this.get("childViews"),e,d=c.get("length")-1,b;b=this.displayItemIndexForEvent(a);if(b===d){this.showOverflowMenu();this._isTouching=NO}else{if(b>=0){e=c.objectAt(b);e.set("isActive",YES);this.activeChildView=e}}return YES},triggerItemAtIndex:function(j){var l=this.get("childViews"),g,b,m,c,h,f;g=l.objectAt(j);if(!g.get("isEnabled")){return this}h=this.get("allowsEmptySelection");f=this.get("allowsMultipleSelection");b=g.get("value");m=c=this.get("value");if(SC.empty(m)){m=[]}else{if(!SC.isArray(m)){m=[m]}}if(!f){if(h&&(m.get("length")===1)&&(m.objectAt(0)===b)){m=[]}else{m=[b]}}else{if(m.indexOf(b)>=0){if(m.get("length")>1||(m.objectAt(0)!==b)||h){m=m.without(b)}}else{m=m.concat([b])}}switch(m.get("length")){case 0:m=null;break;case 1:m=m.objectAt(0);break;default:break}var o=this.get("itemActionKey"),a=this.get("itemTargetKey"),e,k=null,d=this.getPath("pane.rootResponder"),n;if(o&&(n=this.get("items").objectAt(j))){e=n.get?n.get(o):n[o];if(a){k=n.get?n.get(a):n[a]}if(d){d.sendAction(e,k,this,this.get("pane"),m)}}if(c!==undefined&&(!e||this.get("selectSegmentWhenTriggeringAction"))){this.set("value",m)}e=this.get("action");if(e&&d){d.sendAction(e,this.get("target"),this,this.get("pane"),m)}},selectOverflowItem:function(b){var a=b.get("selectedItem");this.triggerItemAtIndex(a.get("index"));b.removeObserver("selectedItem",this,"selectOverflowItem");this.activeChildView.set("isActive",NO);this.activeChildView=null},showOverflowMenu:function(){var f=this.get("childViews"),b=f.get("length")-1,o=this.overflowItems,k,j,e,h;k=o.get("length");j=f.get("length")-1-k;h=this.get("value");e=SC.isArray(h);for(var c=0;c<k;c++){var n=o.objectAt(c),l=this.get("itemValueKey");if(e?h.indexOf(n[l])>=0:h===n[l]){n.isChecked=YES}else{n.isChecked=NO}n.index=j+c}var m=this;var a=SC.MenuPane.create({layout:{width:200},items:o,itemTitleKey:this.get("itemTitleKey"),itemIconKey:this.get("itemIconKey"),itemIsEnabledKey:this.get("itemIsEnabledKey"),itemKeyEquivalentKey:this.get("itemKeyEquivalentKey"),itemCheckboxKey:"isChecked",modalPaneDidClick:function(){arguments.callee.base.apply(this,arguments);this.removeObserver("selectedItem",m,"selectOverflowItem");m.activeChildView.set("isActive",NO);m.activeChildView=null}});var d=this.get("layer");var g=d.childNodes[d.childNodes.length-1];a.popup(g);a.addObserver("selectedItem",this,"selectOverflowItem")},valueDidChange:function(){var d=this.get("value"),c,f=this.get("childViews"),g=Infinity,e=f.lastObject(),h,a;if(this.overflowItems){c=this.overflowItems.get("length");g=f.get("length")-1-c;e.set("isSelected",NO)}for(var b=f.get("length")-2;b>=0;b--){h=f.objectAt(b);if(SC.isArray(d)?d.indexOf(h.get("value"))>=0:d===h.get("value")){h.set("isSelected",YES);if(b>=g){e.set("isSelected",YES)}}else{h.set("isSelected",NO)}}}.observes("value")});sc_require("views/button");SC.SelectView=SC.ButtonView.extend({acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),escapeHTML:YES,escapeHTMLBindingDefault:SC.Binding.oneWay().bool(),items:[],itemsBindingDefault:SC.Binding.multiple(),itemTitleKey:null,itemSortKey:null,itemValueKey:null,itemIconKey:null,itemSeparatorKey:"separator",itemIsEnabledKey:"isEnabled",localize:YES,disableSort:YES,classNames:["sc-select-view"],menu:null,_itemList:[],_itemIdx:null,value:null,checkboxEnabled:YES,showCheckbox:YES,emptyName:null,_defaultVal:null,_defaultTitle:null,_defaultIcon:null,theme:"popup",displayProperties:["icon","value","controlSize","items","escapeHTML","emptyName"],preferMatrix:null,CUSTOM_MENU_ITEM_HEIGHT:20,isActiveBinding:"*menu.isVisibleInWindow",isDefaultPosition:NO,lastMenuWidth:null,exampleView:null,customViewMenuOffsetWidth:0,needsEllipsis:YES,menuPaneHeightPadding:0,menuItemPadding:35,isContextMenuEnabled:NO,supportFocusRing:YES,leftAlign:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:return SC.SelectView.TINY_OFFSET_X;case SC.SMALL_CONTROL_SIZE:return SC.SelectView.SMALL_OFFSET_X;case SC.REGULAR_CONTROL_SIZE:return SC.SelectView.REGULAR_OFFSET_X;case SC.LARGE_CONTROL_SIZE:return SC.SelectView.LARGE_OFFSET_X;case SC.HUGE_CONTROL_SIZE:return SC.SelectView.HUGE_OFFSET_X}return 0}.property("controlSize"),sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("itemSortKey")||this.get("itemTitleKey");b=b.sort(function(d,c){if(a){d=d.get?d.get(a):d[a];c=c.get?c.get(a):c[a]}return(d<c)?-1:((d>c)?1:0)})}return b},render:function(b,g){arguments.callee.base.apply(this,arguments);var s,d,m,t,v,B,h,f,y,j,p,a,o,e,l,z,u,q,w,n,k,x,c;m=this.get("items")||[];m=this.sortObjects(m);t=m.length;v=this.get("itemTitleKey");B=this.get("itemIconKey");h=this.get("itemValueKey");f=this.get("itemSeparatorKey");y=this.get("showCheckbox");k=this.get("itemIsEnabledKey");s=this.get("escapeHTML");j=this.get("value");p=this.get("localize");o=[];e=YES;l=0;x=this.get("emptyName");if(!SC.none(x)){x=p?SC.String.loc(x):x;x=s?SC.RenderContext.escapeHTML(x):x;w=SC.Object.create({separator:NO,title:x,icon:null,value:null,isEnabled:YES,checkbox:NO,target:this,action:"displaySelectedItem"});if(SC.none(j)){this.set("title",x)}o.push(w)}m.forEach(function(C){if(C||C===0){a=f?(C.get?C.get(f):C[f]):NO;if(!a){z=v?(C.get?C.get(v):C[v]):C.toString();z=p?SC.String.loc(z):z;u=B?(C.get?C.get(B):C[B]):null;if(SC.none(C[B])){u=null}q=h?(C.get?C.get(h):C[h]):C;if(!SC.none(j)&&!SC.none(q)){c=false;if(SC.kindOf(j,SC.Record)&&SC.kindOf(q,SC.Record)){c=j.get("storeKey")===q.get("storeKey")}if(j===q||c){this.set("title",z);this.set("icon",u)}}if(q===this.get("value")){this.set("_itemIdx",l);e=!y?NO:YES}else{e=NO}n=(C.get?C.get(k):C[k]);if(NO!==n){n=YES}if(SC.none(this._defaultVal)&&n){this._defaultVal=q;this._defaultTitle=z;this._defaultIcon=u}}w=SC.Object.create({separator:a,title:z,icon:u,value:q,isEnabled:n,checkbox:e,target:this,action:"displaySelectedItem"});o.push(w)}l+=1},this);this.set("_itemList",o);if(o.length==0&&this.get("value")==""){this.set("title","")}if(g){this.invokeLast(function(){var C=this.get("value");if(SC.none(C)){if(SC.none(x)){this.set("value",this._defaultVal);this.set("title",this._defaultTitle);this.set("icon",this._defaultIcon)}else{this.set("title",x)}}})}this.changeSelectPreferMatrix(this.get("_itemIdx"))},_action:function(m){var j,a,k,l,s,o,B,e,z,c,n,u,p,x,f,g,b,y,h,t;j=this.$(".sc-button-label")[0];var C=SC.SelectView.MENU_WIDTH_OFFSET;if(!this.get("isDefaultPosition")){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:C+=SC.SelectView.TINY_POPUP_MENU_WIDTH_OFFSET;break;case SC.SMALL_CONTROL_SIZE:C+=SC.SelectView.SMALL_POPUP_MENU_WIDTH_OFFSET;break;case SC.REGULAR_CONTROL_SIZE:C+=SC.SelectView.REGULAR_POPUP_MENU_WIDTH_OFFSET;break;case SC.LARGE_CONTROL_SIZE:C+=SC.SelectView.LARGE_POPUP_MENU_WIDTH_OFFSET;break;case SC.HUGE_CONTROL_SIZE:C+=SC.SelectView.HUGE_POPUP_MENU_WIDTH_OFFSET;break}}a=this.get("layer").offsetWidth+C;a=this.get("layer").offsetWidth;k=j.scrollWidth;l=this.get("lastMenuWidth");if(k){s=j.offsetWidth;if(k&&s){a=a+k-s}}if(!l||(a>l)){l=a}o=this.get("_itemList");var v=this.get("customViewClassName");var q=this.get("customViewMenuOffsetWidth");var d="sc-view sc-pane sc-panel sc-palette sc-picker sc-menu select-button sc-scroll-view sc-menu-scroll-view sc-container-view menuContainer sc-button-view sc-menu-item sc-regular-size";d=v?(d+" "+v):d;SC.prepareStringMeasurement("",d);for(n=0,y=o.length;n<y;++n){z=o.objectAt(n);B=SC.measureString(z.title).width;if(!e||(B>e)){e=B}}SC.teardownStringMeasurement();l=(e+this.menuItemPadding>l)?e+this.menuItemPadding:l;var w=SC.RootResponder.responder.get("currentWindowSize").width;if(l>w){l=(w-25)}this.set("lastMenuWidth",l);u=this.get("value");p=this.get("_itemList");x=this.get("controlSize");f=this.get("menuPaneHeightPadding");t=this.get("escapeHTML");g=this.get("exampleView")||SC.MenuItemView.extend({escapeHTML:t});b=SC.MenuPane.create({classNames:["select-button"],items:p,exampleView:g,isEnabled:YES,menuHeightPadding:f,preferType:SC.PICKER_MENU,itemHeightKey:"height",layout:{width:l},controlSize:x,itemWidth:l});if(!b){return NO}b.popup(this,this.preferMatrix);this.set("menu",b);h=this._itemIdx;if(!SC.empty(h)&&h>-1){g=b.menuItemViewForContentIndex(h);if(g){g.becomeFirstResponder()}}this.set("isActive",YES);return YES},displaySelectedItem:function(a){var b=a.get("selectedItem");this.set("value",b.get("value"));this.set("title",b.get("title"));this.set("_itemIdx",b.get("contentIndex"))},changeSelectPreferMatrix:function(){var c=0,g=0;switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:c=SC.SelectView.TINY_OFFSET_Y;g=SC.MenuPane.TINY_MENU_ITEM_HEIGHT;break;case SC.SMALL_CONTROL_SIZE:c=SC.SelectView.SMALL_OFFSET_Y;g=SC.MenuPane.SMALL_MENU_ITEM_HEIGHT;break;case SC.REGULAR_CONTROL_SIZE:c=SC.SelectView.REGULAR_OFFSET_Y;g=SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT;break;case SC.LARGE_CONTROL_SIZE:c=SC.SelectView.LARGE_OFFSET_Y;g=SC.MenuPane.LARGE_MENU_ITEM_HEIGHT;break;case SC.HUGE_CONTROL_SIZE:c=SC.SelectView.HUGE_OFFSET_Y;g=SC.MenuPane.HUGE_MENU_ITEM_HEIGHT;break}var e=c,b=this.get("_itemIdx"),a=this.get("leftAlign"),f,d;if(this.get("isDefaultPosition")){f=[1,0,3];this.set("preferMatrix",f)}else{if(b){e=b*g+c}d=[a,-e,2];this.set("preferMatrix",d)}},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;this.becomeFirstResponder();this._action();return YES},mouseUp:function(b){var d=this.get("menu"),a,c;if(d){a=d.getPath("rootMenu.targetMenuItem");if(a&&d.get("mouseHasEntered")){if(!a.performAction()){d.remove()}}else{if(b.timeStamp-this._mouseDownTimestamp>400){d.remove()}}}this._isMouseDown=NO;this.set("isActive",NO);return YES},mouseExited:function(){return YES},keyDown:function(a){if(this.interpretKeyEvents(a)){return YES}else{return arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(a){if(a){if((a.keyCode===38||a.keyCode===40)){this._action()}else{if(a.keyCode===27){this.resignFirstResponder()}}}return arguments.callee.base.apply(this,arguments)},_button_isSelectedDidChange:function(){}.observes("isSelected")});SC.SelectView.TINY_OFFSET_X=0;SC.SelectView.TINY_OFFSET_Y=0;SC.SelectView.TINY_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectView.SMALL_OFFSET_X=-18;SC.SelectView.SMALL_OFFSET_Y=3;SC.SelectView.SMALL_POPUP_MENU_WIDTH_OFFSET=7;SC.SelectView.REGULAR_OFFSET_X=-17;SC.SelectView.REGULAR_OFFSET_Y=0;SC.SelectView.REGULAR_POPUP_MENU_WIDTH_OFFSET=4;SC.SelectView.LARGE_OFFSET_X=-17;SC.SelectView.LARGE_OFFSET_Y=6;SC.SelectView.LARGE_POPUP_MENU_WIDTH_OFFSET=3;SC.SelectView.HUGE_OFFSET_X=0;SC.SelectView.HUGE_OFFSET_Y=0;SC.SelectView.HUGE_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectView.MENU_WIDTH_OFFSET=-2;sc_require("views/button");SC.SelectButtonView=SC.ButtonView.extend({init:function(){arguments.callee.base.apply(this,arguments)},escapeHTML:YES,objects:[],objectsBindingDefault:SC.Binding.multiple(),nameKey:null,sortKey:null,valueKey:null,iconKey:null,isEnabledKey:"isEnabled",localize:YES,disableSort:YES,classNames:["select-button"],menu:null,itemList:[],itemIdx:null,value:null,checkboxEnabled:YES,separatorPosition:null,_defaultVal:null,_defaultTitle:null,_defaultIcon:null,theme:"popup",displayProperties:["icon","value","controlSize","objects","objects.[]"],preferMatrix:null,SELECT_BUTTON_SPRITE_WIDTH:28,isActiveBinding:"*menu.isVisibleInWindow",isDefaultPosition:NO,lastMenuWidth:null,customView:null,customViewClassName:null,customViewMenuOffsetWidth:0,needsEllipsis:YES,menuPaneHeightPadding:0,supportFocusRing:YES,isContextMenuEnabled:NO,leftAlign:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:return SC.SelectButtonView.TINY_OFFSET_X;case SC.SMALL_CONTROL_SIZE:return SC.SelectButtonView.SMALL_OFFSET_X;case SC.REGULAR_CONTROL_SIZE:return SC.SelectButtonView.REGULAR_OFFSET_X;case SC.LARGE_CONTROL_SIZE:return SC.SelectButtonView.LARGE_OFFSET_X;case SC.HUGE_CONTROL_SIZE:return SC.SelectButtonView.HUGE_OFFSET_X}return 0}.property("controlSize"),sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("sortKey")||this.get("nameKey");b=b.sort(function(d,c){if(a){d=d.get?d.get(a):d[a];c=c.get?c.get(a):c[a]}return(d<c)?-1:((d>c)?1:0)})}return b},render:function(b,e){arguments.callee.base.apply(this,arguments);var c,a,o,q,v,f,t,g,m,u,l,d,j,w,p,n,s,k,h;c=this.layout.width;if(e&&c){this.adjust({width:c-this.SELECT_BUTTON_SPRITE_WIDTH})}a=this.get("objects");a=this.sortObjects(a);o=a.length;q=this.get("nameKey");v=this.get("iconKey");f=this.get("valueKey");h=this.get("isEnabledKey");t=this.get("checkboxEnabled");g=this.get("value");m=this.get("localize");u=this.get("separatorPosition");l=[];d=YES;j=0;a.forEach(function(x){if(x){w=q?(x.get?x.get(q):x[q]):x.toString();w=m?SC.String.loc(w):w;p=v?(x.get?x.get(v):x[v]):null;if(SC.none(x[v])){p=null}n=(f)?(x.get?x.get(f):x[f]):x;if(!SC.none(g)&&!SC.none(n)){if(this._equals(g,n)){this.set("title",w);this.set("icon",p)}}if(this._equals(n,this.get("value"))){if(u>0&&u<o&&j>=o-u){j++}this.set("itemIdx",j);d=!t?NO:YES}else{d=NO}k=(h)?(x.get?x.get(h):x[h]):x;if(NO!==k){k=YES}if(j===0){this._defaultVal=n;this._defaultTitle=w;this._defaultIcon=p}var y=SC.Object.create({title:w,icon:p,value:n,isEnabled:k,checkbox:d,target:this,action:"displaySelectedItem"});l.push(y)}j+=1;if(u&&j===(o-u)){var z=SC.Object.create({separator:YES});l.push(z)}this.set("itemList",l)},this);if(e){b.attr("aria-haspopup","true");this.invokeLast(function(){var x=this.get("value");if(SC.none(x)){this.set("value",this._defaultVal);this.set("title",this._defaultTitle);this.set("icon",this._defaultIcon)}})}this.changeSelectButtonPreferMatrix(this.itemIdx)},_equals:function(b,a){var c=YES;if(b&&SC.typeOf(b)===SC.T_HASH&&a&&SC.typeOf(a)===SC.T_HASH){for(var d in b){if(b[d]!==a[d]){c=NO}}}else{c=(b===a)}return c},_action:function(p){var j,a,m,n,v,s,D,e,C,c,q,w,t,z,f,g,o,b,B,h,l,E,k;j=this.$(".sc-button-label")[0];E=SC.SelectButtonView.MENU_WIDTH_OFFSET;if(!this.get("isDefaultPosition")){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:E+=SC.SelectButtonView.TINY_POPUP_MENU_WIDTH_OFFSET;break;case SC.SMALL_CONTROL_SIZE:E+=SC.SelectButtonView.SMALL_POPUP_MENU_WIDTH_OFFSET;break;case SC.REGULAR_CONTROL_SIZE:E+=SC.SelectButtonView.REGULAR_POPUP_MENU_WIDTH_OFFSET;break;case SC.LARGE_CONTROL_SIZE:E+=SC.SelectButtonView.LARGE_POPUP_MENU_WIDTH_OFFSET;break;case SC.HUGE_CONTROL_SIZE:E+=SC.SelectButtonView.HUGE_POPUP_MENU_WIDTH_OFFSET;break}}a=this.get("layer").offsetWidth+E;m=j.scrollWidth;n=this.get("lastMenuWidth");if(m){v=j.offsetWidth;if(m&&v){a=a+m-v}}if(!n||(a>n)){n=a}s=this.get("itemList");var x=this.get("customViewClassName"),u=this.get("customViewMenuOffsetWidth"),d="sc-view sc-pane sc-panel sc-palette sc-picker sc-menu select-button menu sc-scroll-view sc-menu-scroll-view sc-container-view sc-menu-item menu-item value sc-regular-size";d=x?(d+" "+x):d;h=(this.get("customView")||SC.MenuItemView).create();l=h.get("escapeHTML");k=document.body;for(q=0,B=s.length;q<B;++q){C=s.objectAt(q);c=document.createElement("div");c.style.cssText="top:-10000px; left: -10000px;  position: absolute;";c.className=d;c.innerHTML=l?SC.RenderContext.escapeHTML(C.title):C.title;k.appendChild(c);D=c.offsetWidth+u;if(!e||(D>e)){e=D}k.removeChild(c)}e=(e>n)?e:n;var y=SC.RootResponder.responder.get("currentWindowSize").width;if(e>y){e=(y-25)}this.set("lastMenuWidth",n);w=this.get("value");t=this.get("itemList");z=this.get("controlSize");g=this.get("customView");o=g?g:SC.MenuItemView;b=SC.MenuPane.create({classNames:["select-button"],items:t,exampleView:o,isEnabled:YES,preferType:SC.PICKER_MENU,itemHeightKey:"height",layout:{width:e},controlSize:z,itemWidth:n,performKeyEquivalent:function(G,F){switch(G){case"tab":case"shift_tab":return YES;default:return arguments.callee.base.apply(this,arguments)}}});if(!b){return NO}b.popup(this,this.preferMatrix);this.set("menu",b);g=b.menuItemViewForContentIndex(this.get("itemIdx"));b.set("currentMenuItem",g);if(g){g.becomeFirstResponder()}this.set("isActive",YES);return YES},displaySelectedItem:function(a){var b=this.getPath("menu.selectedItem");if(!b){return NO}this.set("value",b.get("value"));this.set("title",b.get("title"));this.set("itemIdx",b.get("contentIndex"));return YES},changeSelectButtonPreferMatrix:function(){var b=0,h=0,d=0,e=0,j,f;switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:b=SC.SelectButtonView.TINY_OFFSET_Y;h=SC.MenuPane.TINY_MENU_ITEM_HEIGHT;d=SC.MenuPane.TINY_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.SMALL_CONTROL_SIZE:b=SC.SelectButtonView.SMALL_OFFSET_Y;h=SC.MenuPane.SMALL_MENU_ITEM_HEIGHT;d=SC.MenuPane.SMALL_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.REGULAR_CONTROL_SIZE:b=SC.SelectButtonView.REGULAR_OFFSET_Y;h=SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT;d=SC.MenuPane.REGULAR_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.LARGE_CONTROL_SIZE:b=SC.SelectButtonView.LARGE_OFFSET_Y;h=SC.MenuPane.LARGE_MENU_ITEM_HEIGHT;d=SC.MenuPane.LARGE_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.HUGE_CONTROL_SIZE:b=SC.SelectButtonView.HUGE_OFFSET_Y;h=SC.MenuPane.HUGE_MENU_ITEM_HEIGHT;d=SC.MenuPane.HUGE_MENU_ITEM_SEPARATOR_HEIGHT;break}var g=b,a=this.get("itemIdx"),l=this.get("leftAlign"),k,c;if(this.get("isDefaultPosition")){k=[1,0,3];this.set("preferMatrix",k)}else{if(a){g=a*h+b;j=this.get("separatorPosition");f=this.get("objects").length;if(j>0&&j<f&&a>=f-j){e=h-d;g-=e}}c=[l,-g,2];this.set("preferMatrix",c)}},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;this.becomeFirstResponder();this._action();this._menuRenderedTimestamp=0;var b=this;setTimeout(function(){SC.run(function(){b._menuRenderedTimestamp=Date.now()})},1);return YES},_recordMouseDownTimestamp:function(){this._menuRenderedTimestamp=new Date().getTime()},mouseUp:function(b){var d=new Date().getTime(),c=this._menuRenderedTimestamp,e=this.get("menu"),f=SC.platform.touch,a;if(c===0){c=Date.now()}if(e){a=e.getPath("rootMenu.targetMenuItem");if(a&&a.get("mouseHasEntered")){if(!a.performAction()){e.remove()}}else{if(!f&&(d-c>SC.ButtonView.CLICK_AND_HOLD_DELAY)){if(!e.get("mouseHasEntered")&&!this.get("isDefaultPosition")){a=e.get("currentMenuItem");if(a&&!a.performAction()){e.remove()}}else{e.remove()}}}}this._isMouseDown=NO;this.set("isActive",NO);return YES},mouseExited:function(){return YES},keyDown:function(a){if(this.interpretKeyEvents(a)){return YES}else{return arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(a){if(a){if((a.keyCode===38||a.keyCode===40)){this._action()}else{if(a.keyCode===27){this.resignFirstResponder()}}}return arguments.callee.base.apply(this,arguments)},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),insertTab:function(b){var a=this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertBacktab:function(b){var a=this.get("previousValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},_button_isSelectedDidChange:function(){}.observes("isSelected"),didAppendToDocument:function(){}});SC.SelectButtonView.TINY_OFFSET_X=0;SC.SelectButtonView.TINY_OFFSET_Y=0;SC.SelectButtonView.TINY_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectButtonView.SMALL_OFFSET_X=-18;SC.SelectButtonView.SMALL_OFFSET_Y=3;SC.SelectButtonView.SMALL_POPUP_MENU_WIDTH_OFFSET=7;SC.SelectButtonView.REGULAR_OFFSET_X=-17;SC.SelectButtonView.REGULAR_OFFSET_Y=3;SC.SelectButtonView.REGULAR_POPUP_MENU_WIDTH_OFFSET=4;SC.SelectButtonView.LARGE_OFFSET_X=-17;SC.SelectButtonView.LARGE_OFFSET_Y=6;SC.SelectButtonView.LARGE_POPUP_MENU_WIDTH_OFFSET=3;SC.SelectButtonView.HUGE_OFFSET_X=0;SC.SelectButtonView.HUGE_OFFSET_Y=0;SC.SelectButtonView.HUGE_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectButtonView.MENU_WIDTH_OFFSET=-2;SC.MenuPane.TINY_MENU_ITEM_HEIGHT=10;SC.MenuPane.TINY_MENU_ITEM_SEPARATOR_HEIGHT=2;SC.MenuPane.TINY_MENU_HEIGHT_PADDING=2;SC.MenuPane.TINY_SUBMENU_OFFSET_X=0;SC.MenuPane.SMALL_MENU_ITEM_HEIGHT=16;SC.MenuPane.SMALL_MENU_ITEM_SEPARATOR_HEIGHT=7;SC.MenuPane.SMALL_MENU_HEIGHT_PADDING=4;SC.MenuPane.SMALL_SUBMENU_OFFSET_X=2;SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT=22;SC.MenuPane.REGULAR_MENU_ITEM_SEPARATOR_HEIGHT=9;SC.MenuPane.REGULAR_MENU_HEIGHT_PADDING=6;SC.MenuPane.REGULAR_SUBMENU_OFFSET_X=2;SC.MenuPane.LARGE_MENU_ITEM_HEIGHT=31;SC.MenuPane.LARGE_MENU_ITEM_SEPARATOR_HEIGHT=20;SC.MenuPane.LARGE_MENU_HEIGHT_PADDING=0;SC.MenuPane.LARGE_SUBMENU_OFFSET_X=4;SC.MenuPane.HUGE_MENU_ITEM_HEIGHT=20;SC.MenuPane.HUGE_MENU_ITEM_SEPARATOR_HEIGHT=9;SC.MenuPane.HUGE_MENU_HEIGHT_PADDING=0;SC.MenuPane.HUGE_SUBMENU_OFFSET_X=0;SC.SelectFieldView=SC.FieldView.extend({displayProperties:["objects","nameKey","valueKey","isEnabled"],acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),tagName:"select",classNames:["sc-select-field-view"],objects:[],objectsBindingDefault:SC.Binding.multiple(),nameKey:null,sortKey:null,valueKey:null,emptyName:null,localize:NO,cpDidChange:YES,disableSort:NO,validateMenuItem:function(b,a){return YES},sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("sortKey")||this.get("nameKey");if(a){b=b.sortProperty(a)}else{b=b.sort(function(d,c){if(a){d=d.get?d.get(a):d[a];c=c.get?c.get(a):c[a]}return(d<c)?-1:((d>c)?1:0)})}}return b},render:function(c,a){if(a||this.get("cpDidChange")){this.set("cpDidChange",NO);var f=this.get("nameKey");var k=this.get("valueKey");var j=this.get("objects");var b=this.get("value");var d,g;if(!this.get("isEnabled")){c.attr("disabled","disabled")}var h=this.get("localize");if(!k&&b){b=SC.guidFor(b)}if((b===null)||(b==="")){b="***"}if(j){j=this.sortObjects(j);if(!a){g=this.$input()[0];if(!g){return}g.innerHTML=""}var e=this.get("emptyName");if(e){if(h){e=SC.String.loc(e)}if(a){c.push('<option value="***">'+e+"</option>",'<option disabled="disabled"></option>')}else{d=document.createElement("option");d.value="***";d.innerHTML=e;g.appendChild(d);d=document.createElement("option");d.disabled="disabled";g.appendChild(d)}}j.forEach(function(o,n){if(o){var m=f?(o.get?o.get(f):o[f]):o.toString();if(h){m=SC.String.loc(m)}var p=(k)?(o.get?o.get(k):o[k]):o;if(!e&&n===0&&b==="***"){this.set("value",p)}if(p!==null&&p!==undefined){p=(SC.guidFor(p))?SC.guidFor(p):p.toString()}var l=(this.validateMenuItem&&this.validateMenuItem(p,m))?"":'disabled="disabled" ';if(a){c.push("<option "+l+'value="'+p+'">'+m+"</option>")}else{d=document.createElement("option");d.value=p;d.innerHTML=m;if(l.length>0){d.disable="disabled"}g.appendChild(d)}}else{if(a){c.push('<option disabled="disabled"></option>')}else{d=document.createElement("option");d.disabled="disabled";g.appendChild(d)}}},this);this.setFieldValue(b)}else{this.set("value",null)}}else{this.$().prop("disabled",!this.get("isEnabled"))}},_objectsObserver:function(){this.set("cpDidChange",YES)}.observes("objects"),_objectArrayObserver:function(){this.set("cpDidChange",YES);this.propertyDidChange("objects")}.observes("*objects.[]"),_nameKeyObserver:function(){this.set("cpDidChange",YES)}.observes("nameKey"),_valueKeyObserver:function(){this.set("cpDidChange",YES)}.observes("valueKey"),_isEnabledObserver:function(){this.set("cpDidChange",YES)}.observes("isEnabled"),$input:function(){return this.$()},mouseDown:function(a){if(!this.get("isEnabled")){a.stop();return YES}else{return arguments.callee.base.apply(this,arguments)}},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},getFieldValue:function(){var f=arguments.callee.base.apply(this,arguments);var c=this.get("valueKey");var e=this.get("objects");var d=null;var a;if(f=="***"){f=null}else{if(f&&e){var g=(SC.typeOf(e.length)===SC.T_FUNCTION)?e.length():e.length;while(!d&&(--g>=0)){a=e.objectAt?e.objectAt(g):e[g];if(a===null||a===undefined){continue}if(c){a=(a.get)?a.get(c):a[c]}var b=(a!==null&&a!==undefined)?(SC.guidFor(a)?SC.guidFor(a):a.toString()):null;if(f==b){d=a}}}}return(c||d)?d:f},setFieldValue:function(a){if(SC.none(a)){a="***"}else{a=((a!==null&&a!==undefined)?(SC.guidFor(a)?SC.guidFor(a):a.toString()):null)}this.$input().val(a);return this},fieldDidFocus:function(){var a=this.get("isFocused");if(!a){this.set("isFocused",true)}},fieldDidBlur:function(){var a=this.get("isFocused");if(a){this.set("isFocused",false)}},_isFocusedObserver:function(){this.$().setClass("focus",this.get("isFocused"))}.observes("isFocused"),didCreateLayer:function(){var a=this.$input();if(this.get("isEnabled")===false){this.$()[0].disabled=true}SC.Event.add(a,"blur",this,this.fieldDidBlur);SC.Event.add(a,"focus",this,this.fieldDidFocus);SC.Event.add(a,"change",this,this._field_fieldValueDidChange)},willDestroyLayer:function(){var a=this.$input();SC.Event.remove(a,"focus",this,this.fieldDidFocus);SC.Event.remove(a,"blur",this,this.fieldDidBlur);SC.Event.remove(a,"change",this,this._field_fieldValueDidChange)}});SC.SliderView=SC.View.extend(SC.Control,{classNames:"sc-slider-view",ariaRole:"slider",value:0.5,valueBindingDefault:SC.Binding.single().notEmpty(),minimum:0,minimumBindingDefault:SC.Binding.single().notEmpty(),contentMinimumKey:null,maximum:1,maximumBindingDefault:SC.Binding.single().notEmpty(),contentMaximumKey:null,step:0.1,displayProperties:["displayValue","ariaValue","minimum","maximum","step","frame"],ariaValue:function(){return this.get("value")}.property("value").cacheable(),renderDelegateName:"sliderRenderDelegate",displayValue:function(){var b=this.get("minimum"),a=this.get("maximum"),d=this.get("value"),c=this.get("step");d=Math.min(Math.max(d,b),a);if(!SC.none(c)&&c!==0){d=Math.round(d/c)*c}if(d!==0){d=Math.floor((d-b)/(a-b)*100)}return d}.property("value","minimum","maximum","step").cacheable(),_isMouseDown:NO,mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;return this._triggerHandle(a,YES)},mouseDragged:function(a){return this._isMouseDown?this._triggerHandle(a):YES},mouseUp:function(a){if(this._isMouseDown){this.set("isActive",NO)}var b=this._isMouseDown?this._triggerHandle(a):YES;this._isMouseDown=NO;return b},mouseWheel:function(b){if(!this.get("isEnabled")){return YES}var d=this.get("minimum"),a=this.get("maximum"),e=this.get("step"),c=this.get("value")+((b.wheelDeltaX+b.wheelDeltaY)*e),f=Math.round(c/e)*e;if(c<d){this.setIfChanged("value",d)}else{if(c>a){this.setIfChanged("value",a)}else{this.setIfChanged("value",c)}}return YES},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},touchesDragged:function(a){return this.mouseDragged(a)},_triggerHandle:function(j,e){var a=this.get("frame").width,c=this.get("minimum"),f=this.get("maximum"),b=this.get("step"),h=this.get("value"),d;if(e){d=this.convertFrameFromView({x:j.pageX}).x;this._evtDiff=j.pageX-d}else{d=j.pageX-this._evtDiff}d=Math.max(0,Math.min(d/a,1));if(e){var g=this.get("value");g=(g-c)/(f-c);if(Math.abs(g*a-d*a)<16){this._offset=g-d}else{this._offset=0}}d=Math.max(0,Math.min(d+this._offset,1));d=c+((f-c)*d);if(b!==0){d=Math.round(d/b)*b}if(Math.abs(h-d)>=0.01){this.set("value",d)}return YES},acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),keyDown:function(h){if(h.which===9||h.keyCode===9){var f=h.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(f){f.becomeFirstResponder()}else{h.allowDefault()}return YES}if(h.which>=33&&h.which<=40){var d=this.get("minimum"),g=this.get("maximum"),b=this.get("step"),j=g-d,a=0,c,e=this.get("value");if(h.which===37||h.which===38||h.which===34){if(b===0){if(j<100){a=e-1}else{c=Math.abs(j/100);if(c<2){c=2}a=e-c}}else{a=e-b}}if(h.which===39||h.which===40||h.which===33){if(b===0){if(j<100){a=e+2}else{c=Math.abs(j/100);if(c<2){c=2}a=e+c}}else{a=e+b}}if(h.which===36){a=g}if(h.which===35){a=d}if(a>=d&&a<=g){this.set("value",a)}}else{h.allowDefault();return NO}return YES},contentKeys:{contentValueKey:"value",contentMinimumKey:"minimum",contentMaximumKey:"maximum",contentIsIndeterminateKey:"isIndeterminate"}});sc_require("mixins/collection_group");sc_require("views/disclosure");SC.SourceListGroupView=SC.View.extend(SC.Control,SC.CollectionGroup,{classNames:["sc-source-list-group"],content:null,isGroupVisible:YES,hasGroupTitle:YES,groupTitleKey:null,groupVisibleKey:null,render:function(a,b){a.push('<div role="button" class="sc-source-list-label sc-disclosure-view sc-button-view button disclosure no-disclosure">','<img src="'+SC.BLANK_IMAGE_URL+'" class="button" />','<span class="label"></span></div>')},createChildViews:function(){},contentPropertyDidChange:function(f,c){var e=this.get("content");var h=this.outlet("labelView");if(e===null){h.setIfChanged("isVisible",NO);this.setIfChanged("hasGroupTitle",NO);return}else{h.setIfChanged("isVisible",YES);this.setIfChanged("hasGroupTitle",YES)}var b=this.getDelegateProperty("groupTitleKey",this.displayDelegate);if((c=="*")||(b&&(c==b))){var g=(e&&e.get&&b)?e.get(b):e;if(g!=this._title){this._title=g;if(g){g=g.capitalize()}h.set("title",g)}}var d=this.getDelegateProperty("groupVisibleKey",this.displayDelegate);if((c=="*")||(d&&(c==d))){if(d){h.removeClassName("no-disclosure");var a=(e&&e.get)?!!e.get(d):YES;if(a!=this.get("isGroupVisible")){this.set("isGroupVisible",a);h.set("value",a)}}else{h.addClassName("no-disclosure")}}},disclosureValueDidChange:function(c){if(c==this.get("isGroupVisible")){return}var b=this.get("content");var a=this.getDelegateProperty("groupVisibleKey",this.displayDelegate);if(b&&b.set&&a){b.set(a,c)}this.set("isGroupVisible",c);if(this.owner&&this.owner.updateChildren){this.owner.updateChildren(true)}},labelView:SC.DisclosureView.extend({value:YES,_valueObserver:function(){if(this.owner){this.owner.disclosureValueDidChange(this.get("value"))}}.observes("value")})});sc_require("views/list");sc_require("views/source_list_group");SC.SourceListView=SC.ListView.extend({theme:"source-list",classNames:["sc-source-list"],rowHeight:32,selectOnMouseDown:NO,actOnSelect:YES});SC.SplitDividerView=SC.View.extend({classNames:["sc-split-divider-view"],mouseDown:function(a){var b=this.get("splitView");return(b)?b.mouseDownInThumbView(a,this):arguments.callee.base.apply(this,arguments)},doubleClick:function(a){var b=this.get("splitView");return(b)?b.doubleClickInThumbView(a,this):arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)}});sc_require("views/split_divider");SC.RESIZE_BOTH="resize-both";SC.RESIZE_TOP_LEFT="resize-top-left";SC.RESIZE_BOTTOM_RIGHT="resize-bottom-right";SC.SplitView=SC.View.extend({classNames:["sc-split-view"],displayProperties:["layoutDirection"],delegate:null,layoutDirection:SC.LAYOUT_HORIZONTAL,canCollapseViews:YES,autoresizeBehavior:SC.RESIZE_BOTTOM_RIGHT,defaultThickness:0.5,topLeftMinThickness:null,topLeftMaxThickness:null,bottomRightMinThickness:null,bottomRightMaxThickness:null,dividerThickness:null,isSplitView:YES,topLeftView:SC.View,dividerView:SC.SplitDividerView,bottomRightView:SC.View,topLeftThickness:function(){var a=this.get("topLeftView");return a?this.thicknessForView(a):0}.property("topLeftView").cacheable(),bottomRightThickness:function(){var a=this.get("bottomRightView");return a?this.thicknessForView(a):0}.property("bottomRightView").cacheable(),thumbViewCursor:null,canCollapseView:function(a){return this.invokeDelegateMethod(this.delegate,"splitViewCanCollapse",this,a)},thicknessForView:function(a){var c=this.get("layoutDirection"),b=a.get("frame");return(c===SC.LAYOUT_HORIZONTAL)?b.width:b.height},createChildViews:function(){var e=[],c=["topLeftView","dividerView","bottomRightView"],b=c.length,a,d;for(d=0;d<b;++d){if(a=this.get(c[d])){a=this[c[d]]=this.createChildView(a,{layoutView:this,rootElementPath:[d]});e.push(a)}}this.set("childViews",e);return this},updateChildLayout:function(){var b=this.get("topLeftView"),c=this.get("bottomRightView"),j=this.get("dividerView"),e=this.get("autoresizeBehavior"),k=this.get("layoutDirection"),a=this.get("frame"),d=this._desiredTopLeftThickness,l=this.get("dividerThickness"),h=(k===SC.LAYOUT_HORIZONTAL)?a.width:a.height,m=h-l-d,g,f;l=(!SC.none(l))?l:7;f=b.get("isCollapsed")||NO;b.setIfChanged("isVisible",!f);g=SC.clone(b.get("layout"));if(k===SC.LAYOUT_HORIZONTAL){g.top=0;g.left=0;g.bottom=0;switch(e){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:g.right=m+l;delete g.width;break;case SC.RESIZE_BOTTOM_RIGHT:delete g.right;delete g.height;g.width=d;break}}else{g.top=0;g.left=0;g.right=0;switch(e){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:g.bottom=m+l;delete g.height;break;case SC.RESIZE_BOTTOM_RIGHT:g.height=d;delete g.bottom;delete g.width;break}}b.set("layout",g);if(j){g=SC.clone(j.get("layout"));if(k===SC.LAYOUT_HORIZONTAL){g.width=l;g.top=0;g.bottom=0;delete g.height;switch(e){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:g.right=m;delete g.left;delete g.centerX;delete g.centerY;break;case SC.RESIZE_BOTTOM_RIGHT:g.left=d;delete g.right;delete g.centerX;delete g.centerY;break}}else{g.height=l;g.left=0;g.right=0;delete g.width;switch(e){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:g.bottom=m;delete g.top;delete g.centerX;delete g.centerY;break;case SC.RESIZE_BOTTOM_RIGHT:g.top=d;delete g.bottom;delete g.centerX;delete g.centerY;break}}j.set("layout",g)}f=c.get("isCollapsed")||NO;c.setIfChanged("isVisible",!f);g=SC.clone(c.get("layout"));if(k===SC.LAYOUT_HORIZONTAL){g.top=0;g.bottom=0;g.right=0;switch(e){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_BOTTOM_RIGHT:g.left=d+l;delete g.width;break;case SC.RESIZE_TOP_LEFT:g.width=m;delete g.left;break}}else{g.left=0;g.right=0;g.bottom=0;switch(e){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_BOTTOM_RIGHT:g.top=d+l;delete g.height;break;case SC.RESIZE_TOP_LEFT:delete g.top;g.height=m;break}}c.set("layout",g);this.notifyPropertyChange("topLeftThickness").notifyPropertyChange("bottomRightThickness")},renderLayout:function(b,a){if(a||this._recalculateDivider){var f=this.get("layoutDirection"),c=this.get("frame"),e=this.$(),j=this.get("defaultThickness"),d=this.get("autoresizeBehavior"),h=this.get("dividerThickness"),g;if(!this.get("thumbViewCursor")){this.set("thumbViewCursor",SC.Cursor.create())}h=!SC.none(h)?h:7;if(this._recalculateDivider===undefined&&j<1){this._recalculateDivider=YES}else{if(this._recalculateDivider){this._recalculateDivider=NO}}if(e[0]){g=(f===SC.LAYOUT_HORIZONTAL)?e[0].offsetWidth:e[0].offsetHeight}else{g=(f===SC.LAYOUT_HORIZONTAL)?c.width:c.height}if(SC.none(j)||(j>0&&j<1)){j=Math.floor((g-(h))*(j||0.5))}if(d===SC.RESIZE_BOTTOM_RIGHT){this._desiredTopLeftThickness=j}else{this._desiredTopLeftThickness=g-h-j}this._topLeftView=this.get("topLeftView");this._bottomRightView=this.get("bottomRightView");this._topLeftViewThickness=this.thicknessForView(this.get("topLeftView"));this._bottomRightThickness=this.thicknessForView(this.get("bottomRightView"));this._dividerThickness=this.get("dividerThickness");this._layoutDirection=this.get("layoutDirection");this._updateTopLeftThickness(0);this._setCursorStyle();this.updateChildLayout()}arguments.callee.base.apply(this,arguments)},render:function(a,b){arguments.callee.base.apply(this,arguments);if(this._inLiveResize){this._setCursorStyle()}if(this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){a.addClass("sc-horizontal")}else{a.addClass("sc-vertical")}},mouseDownInThumbView:function(a,c){var b=this.getPath("pane.rootResponder");if(!b){return NO}b.dragDidStart(this);this._mouseDownX=a.pageX;this._mouseDownY=a.pageY;this._thumbView=c;this._topLeftView=this.get("topLeftView");this._bottomRightView=this.get("bottomRightView");this._topLeftViewThickness=this.thicknessForView(this.get("topLeftView"));this._bottomRightThickness=this.thicknessForView(this.get("bottomRightView"));this._dividerThickness=this.get("dividerThickness");this._layoutDirection=this.get("layoutDirection");this.beginLiveResize();this._inLiveResize=YES;return YES},mouseDragged:function(a){var b=(this._layoutDirection===SC.LAYOUT_HORIZONTAL)?a.pageX-this._mouseDownX:a.pageY-this._mouseDownY;this._updateTopLeftThickness(b);return YES},mouseUp:function(a){if(this._inLiveResize===YES){this._thumbView=null;this._inLiveResize=NO;this.endLiveResize();return YES}this._setCursorStyle();return NO},touchesDragged:function(a){return this.mouseDragged(a)},touchEnd:function(a){return this.mouseUp(a)},doubleClickInThumbView:function(b,d){var a=this._topLeftView,c=a.get("isCollapsed")||NO;if(!c&&!this.canCollapseView(a)){a=this._bottomRightView;c=a.get("isCollapsed")||NO;if(!c&&!this.canCollapseView(a)){return NO}}if(!c){this._uncollapsedThickness=this.thicknessForView(a);if(a===this._topLeftView){this._updateTopLeftThickness(this.topLeftThickness()*-1)}else{this._updateBottomRightThickness(this.bottomRightThickness()*-1)}if(!a.get("isCollapsed")){this._uncollapsedThickness=null}}else{if(a===this._topLeftView){this._updateTopLeftThickness(this._uncollapsedThickness)}else{this._updateBottomRightThickness(this._uncollapsedThickness)}a._uncollapsedThickness=null}this._setCursorStyle();return true},_updateTopLeftThickness:function(e){var a=this._topLeftView,c=this._bottomRightView,f=this.thicknessForView(a),g=this.thicknessForView(c),k=this._dividerThickness,j=0,b=this._topLeftViewThickness+e,n=this._layoutDirection,p=this.canCollapseView(c),m=b,l=this.get("topLeftMaxThickness"),d=this.get("topLeftMinThickness"),o,h,q;if(!a.get("isCollapsed")){j+=f}if(!c.get("isCollapsed")){j+=g}if(!SC.none(l)){m=Math.min(l,m)}if(!SC.none(d)){m=Math.max(d,m)}l=this.get("bottomRightMaxThickness");d=this.get("bottomRightMinThickness");o=j-m;if(!SC.none(l)){o=Math.min(l,o)}if(!SC.none(d)){o=Math.max(d,o)}m=j-o;m=this.invokeDelegateMethod(this.delegate,"splitViewConstrainThickness",this,a,m);m=Math.min(m,j);m=Math.max(0,m);h=a.get("collapseAtThickness");if(!h){h=0}q=c.get("collapseAtThickness");q=SC.none(q)?j:(j-q);if((b<=h)&&this.canCollapseView(a)){l=c.get("maxThickness");if(!l||(k+j)<=l){m=0}}else{if(b>=q&&this.canCollapseView(c)){l=a.get("maxThickness");if(!l||(k+j)<=l){m=j}}}if(m!=this.thicknessForView(a)){this._desiredTopLeftThickness=m;a.set("isCollapsed",m===0);c.set("isCollapsed",m>=j);this.updateChildLayout();this.displayDidChange()}},_updateBottomRightThickness:function(e){var a=this._topLeftView,c=this._bottomRightView,f=this.thicknessForView(a),g=this.thicknessForView(c),k=this._dividerThickness,j=0,b=this._topLeftViewThickness+e,n=this._layoutDirection,p=this.canCollapseView(c),m=b,l=this.get("topLeftMaxThickness"),d=this.get("topLeftMinThickness"),o,h,q;if(!a.get("isCollapsed")){j+=f}if(!c.get("isCollapsed")){j+=g}if(!SC.none(l)){m=Math.min(l,m)}if(!SC.none(d)){m=Math.max(d,m)}l=this.get("bottomRightMaxThickness");d=this.get("bottomRightMinThickness");o=j-m;if(!SC.none(l)){o=Math.min(l,o)}if(!SC.none(d)){o=Math.max(d,o)}m=j-o;m=this.invokeDelegateMethod(this.delegate,"splitViewConstrainThickness",this,a,m);m=Math.min(m,j);m=Math.max(0,m);h=a.get("collapseAtThickness");if(!h){h=0}q=c.get("collapseAtThickness");q=SC.none(q)?j:(j-q);if((b<=h)&&this.canCollapseView(a)){l=c.get("maxThickness");if(!l||(k+j)<=l){m=0}}else{if(b>=q&&this.canCollapseView(c)){l=a.get("maxThickness");if(!l||(k+j)<=l){m=j}}}if(m!=this.thicknessForView(a)){this._desiredTopLeftThickness=m;a.set("isCollapsed",m===0);c.set("isCollapsed",m>=j);this.updateChildLayout();this.displayDidChange()}},_setCursorStyle:function(){var e=this._topLeftView,f=this._bottomRightView,b=this.get("thumbViewCursor"),c=this.thicknessForView(e),d=this.thicknessForView(f),a=this.get("dividerView");this._layoutDirection=this.get("layoutDirection");if(e.get("isCollapsed")||c===this.get("topLeftMinThickness")||d==this.get("bottomRightMaxThickness")){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"e-resize":"s-resize")}else{if(f.get("isCollapsed")||c===this.get("topLeftMaxThickness")||d==this.get("bottomRightMinThickness")){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"w-resize":"n-resize")}else{if(SC.browser.isIE){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"e-resize":"n-resize")}else{b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"ew-resize":"ns-resize")}}}a.set("cursor",b);if(this._inLiveResize){this.set("cursor",b)}}.observes("layoutDirection"),splitViewCanCollapse:function(b,a){if(b.get("canCollapseViews")===NO){return NO}if(a.get("canCollapse")===NO){return NO}return YES},splitViewConstrainThickness:function(c,a,b){return b},_forceSplitCalculation:function(){this.updateLayout()}.observes("*pane.isPaneAttached"),viewDidResize:function(){arguments.callee.base.apply(this,arguments);this.notifyPropertyChange("topLeftThickness").notifyPropertyChange("bottomRightThickness")}.observes("layout")});SC.mixin(SC.View.prototype,{splitView:function(){var a=this;while(a&&!a.isSplitView){a=a.get("parentView")}return a}.property("parentView").cacheable()});sc_require("views/collection");SC.StackedView=SC.CollectionView.extend({classNames:["sc-stacked-view"],layout:{top:0,left:0,right:0,height:1},computeNowShowing:function(a){return this.get("allContentIndexes")},updateHeight:function(a){if(a){this._updateHeight()}else{this.invokeLast(this._updateHeight)}return this},_updateHeight:function(){var e=this.get("childViews"),b=e.get("length"),c,d,a;if(b===0){a=1}else{c=e.objectAt(b-1);d=c?c.get("layer"):null;a=d?(d.offsetTop+d.offsetHeight):1;d=null}this.adjust("height",a)},didReload:function(a){return this.updateHeight()},didCreateLayer:function(){return this.updateHeight()}});SC.StaticContentView=SC.View.extend(SC.StaticLayout,{classNames:["sc-static-content-view"],displayProperties:["content"],content:null,contentLayoutDidChange:function(){this._viewFrameDidChange()},useStaticLayout:YES,frame:function(){var a=this.get("layer"),b;if(!a){return{x:0,y:0,width:0,height:0}}if(a.getBoundingClientRect&&!SC.browser.isIE8OrLower){b=a.getBoundingClientRect();return{x:0,y:0,width:b.width,height:b.height}}else{return{x:0,y:0,width:a.clientWidth,height:a.clientHeight}}}.property("content").cacheable(),parentViewDidResize:function(){this.contentLayoutDidChange()},didUpdateLayer:function(){this.contentLayoutDidChange()},render:function(a,c){var b=this.get("content");a.push(b||"")},touchStart:function(a){a.allowDefault();return YES},touchEnd:function(a){a.allowDefault();return YES}});sc_require("views/segmented");SC.TOP_LOCATION="top";SC.TOP_TOOLBAR_LOCATION="top-toolbar";SC.BOTTOM_LOCATION="bottom";SC.TabView=SC.View.extend({classNames:["sc-tab-view"],displayProperties:["nowShowing"],nowShowing:null,items:[],isEnabled:YES,itemTitleKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemWidthKey:null,itemToolTipKey:null,tabHeight:SC.REGULAR_BUTTON_HEIGHT,tabLocation:SC.TOP_LOCATION,userDefaultKey:null,_tab_nowShowingDidChange:function(){var a=this.get("nowShowing");this.get("containerView").set("nowShowing",a);this.get("segmentedView").set("value",a);return this}.observes("nowShowing"),_tab_saveUserDefault:function(){var a=this.get("nowShowing");var b=this.get("userDefaultKey");if(b){SC.userDefaults.set([b,"nowShowing"].join(":"),a)}}.observes("nowShowing"),_tab_itemsDidChange:function(){this.get("segmentedView").set("items",this.get("items"));return this}.observes("items"),init:function(){arguments.callee.base.apply(this,arguments);this._tab_nowShowingDidChange()._tab_itemsDidChange()},awake:function(){arguments.callee.base.apply(this,arguments);var a=this.get("userDefaultKey");if(a){a=[a,"nowShowing"].join(":");var b=SC.userDefaults.get(a);if(!SC.none(b)){this.set("nowShowing",b)}}},createChildViews:function(){var e=[],d,c,b=this.get("tabLocation"),a=this.get("tabHeight"),f=this.get("controlSize");if(b===SC.TOP_LOCATION){c={top:a/2+1,left:0,right:0,bottom:0,border:1}}else{if(b===SC.TOP_TOOLBAR_LOCATION){c={top:a+1,left:0,right:0,bottom:0,border:1}}else{c={top:0,left:0,right:0,bottom:(a/2)-1,border:1}}}d=this.containerView.extend({layout:c,ariaRole:"tabpanel"});this.containerView=this.createChildView(d);c=(b===SC.TOP_LOCATION||b===SC.TOP_TOOLBAR_LOCATION)?{height:a,left:0,right:0,top:0}:{height:a,left:0,right:0,bottom:0};this.segmentedView=this.get("segmentedView").extend({layout:c,controlSize:f,_sc_tab_segmented_valueDidChange:function(){var g=this.get("parentView");if(g){g.set("nowShowing",this.get("value"))}}.observes("value"),init:function(){var g=this.get("parentView");if(g){SC._TAB_ITEM_KEYS.forEach(function(h){this[h]=g.get(h)},this)}return arguments.callee.base.apply(this,arguments)}});this.segmentedView=this.createChildView(this.segmentedView);e.push(this.segmentedView);e.push(this.containerView);this.set("childViews",e);return this},containerView:SC.ContainerView.extend({renderDelegateName:"wellRenderDelegate"}),segmentedView:SC.SegmentedView});SC._TAB_ITEM_KEYS=["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemWidthKey","itemToolTipKey","itemActionKey","itemTargetKey"];SC.ThumbView=SC.View.extend({classNames:["sc-thumb-view"],isEnabled:YES,isEnabledBindingDefault:SC.Binding.bool(),prepareContext:function(a,c){var b=this.get("splitView");if(b){this.set("cursor",b.get("thumbViewCursor"))}return arguments.callee.base.apply(this,arguments)},mouseDown:function(a){if(!this.get("isEnabled")){return NO}var b=this.get("splitView");return(b)?b.mouseDownInThumbView(a,this):arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)}});SC.WebView=SC.View.extend(SC.Control,{classNames:"sc-web-view",displayProperties:["value","shouldAutoResize"],shouldAutoResize:NO,render:function(a,d){var c=this.get("value"),b;if(d){a.push('<iframe src="'+c+'" style="position: absolute; width: 100%; height: 100%; border: 0px; margin: 0px; padding: 0px;"></iframe>')}else{if(c!==this._lastSrc){b=this.$("iframe");b.attr("src","javascript:;");b.attr("src",c)}}this._lastSrc=c},didCreateLayer:function(){var a=this.$("iframe");SC.Event.add(a,"load",this,this.iframeDidLoad)},willDestroyLayer:function(){var a=this.$("iframe");SC.Event.remove(a,"load",this,this.iframeDidLoad)},iframeDidLoad:function(){if(this.get("shouldAutoResize")===YES){var a;var c=this.$("iframe")[0];if(c&&c.contentWindow){a=c.contentWindow;if(a&&a.document&&a.document.documentElement){var b=a.document.documentElement;if(!SC.browser.isIE){this.$().width(b.scrollWidth);this.$().height(b.scrollHeight)}else{this.$().width(b.scrollWidth+12);this.$().height(b.scrollHeight+5)}}}}}});SC.WELL_CONTAINER_PADDING=15;SC.WellView=SC.ContainerView.extend({classNames:"sc-well-view",contentLayout:{top:SC.WELL_CONTAINER_PADDING,bottom:SC.WELL_CONTAINER_PADDING,left:SC.WELL_CONTAINER_PADDING,right:SC.WELL_CONTAINER_PADDING},renderDelegateName:"wellRenderDelegate",createChildViews:function(){var a=this.get("contentView");if(a){a=this.contentView=this.createChildView(a);a.set("layout",this.contentLayout);this.childViews=[a]}},contentViewDidChange:function(){var a=this.get("contentView");a.set("layout",this.contentLayout);this.replaceContent(a)}.observes("contentView")});SC.MIXED_STATE="__MIXED__";SC.DataSource=SC.Object.extend({fetch:function(a,b){return NO},retrieveRecords:function(a,c,b){return this._handleEach(a,c,this.retrieveRecord,b)},commitRecords:function(c,b,g,f,h){var e,a,d;if(b.length>0){d=this.createRecords.call(this,c,b,h)}if(g.length>0){e=this.updateRecords.call(this,c,g,h);d=SC.none(d)?e:(d===e)?d:SC.MIXED_STATE}if(f.length>0){a=this.destroyRecords.call(this,c,f,h);d=SC.none(d)?a:(d===a)?d:SC.MIXED_STATE}return d||NO},cancel:function(a,b){return NO},updateRecords:function(a,b,c){return this._handleEach(a,b,this.updateRecord,null,c)},createRecords:function(a,b,c){return this._handleEach(a,b,this.createRecord,null,c)},destroyRecords:function(a,b,c){return this._handleEach(a,b,this.destroyRecord,null,c)},_handleEach:function(h,e,c,a,b){var f=e.length,j,g,k,d;for(j=0;j<f;j++){d=a?a[j]:b;k=c.call(this,h,e[j],d);if(g===undefined){g=k}else{if(g===YES){g=(k===YES)?YES:SC.MIXED_STATE}else{if(g===NO){g=(k===NO)?NO:SC.MIXED_STATE}}}}return !SC.none(g)?g:null},updateRecord:function(a,b,c){return NO},retrieveRecord:function(a,b,c){return NO},createRecord:function(a,b,c){return NO},destroyRecord:function(a,b,c){return NO}});sc_require("data_sources/data_source");SC.CascadeDataSource=SC.DataSource.extend({dataSources:null,from:function(a){var b=this.get("dataSources");if(!b){this.set("dataSources",b=[])}b.push(a);return this},fetch:function(c,g){var e=this.get("dataSources"),b=e?e.length:0,d=NO,h,f,a;for(a=0;(d!==YES)&&a<b;a++){f=e.objectAt(a);h=f.fetch?f.fetch.apply(f,arguments):NO;d=this._handleResponse(d,h)}return d},retrieveRecords:function(h,d,b){var c=this.get("dataSources"),e=c?c.length:0,f=NO,j,a,g;for(g=0;(f!==YES)&&g<e;g++){a=c.objectAt(g);j=a.retrieveRecords.apply(a,arguments);f=this._handleResponse(f,j)}return f},commitRecords:function(k,c,h,e,d){var b=this.get("dataSources"),f=b?b.length:0,g=NO,l,a,j;for(j=0;(g!==YES)&&j<f;j++){a=b.objectAt(j);l=a.commitRecords.apply(a,arguments);g=this._handleResponse(g,l)}return g},cancel:function(c,f){var e=this.get("dataSources"),b=e?e.length:0,d=NO,h,g,a;for(a=0;(d!==YES)&&a<b;a++){g=e.objectAt(a);h=g.cancel.apply(g,arguments);d=this._handleResponse(d,h)}return d},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("dataSources"),a=b?b.get("length"):0,c;while(--a>=0){c=b[a];if(SC.typeOf(c)===SC.T_STRING){b[a]=this.get(c)}}},_handleResponse:function(b,a){if(a===YES){return YES}else{if(b===NO){return(a===NO)?NO:SC.MIXED_STATE}else{return SC.MIXED_STATE}}}});sc_require("core");sc_require("models/record");SC.Query=SC.Object.extend(SC.Copyable,SC.Freezable,{isQuery:YES,conditions:null,orderBy:null,recordType:null,recordTypes:null,expandedRecordTypes:function(){var b=SC.CoreSet.create(),a,c;if(a=this.get("recordType")){this._scq_expandRecordType(a,b)}else{if(a=this.get("recordTypes")){a.forEach(function(d){this._scq_expandRecordType(d,b)},this)}else{this._scq_expandRecordType(SC.Record,b)}}c=SC.Query._scq_queriesWithExpandedRecordTypes;if(!c){c=SC.Query._scq_queriesWithExpandedRecordTypes=SC.CoreSet.create()}c.add(this);return b.freeze()}.property("recordType","recordTypes").cacheable(),_scq_expandRecordType:function(b,a){if(a.contains(b)){return}a.add(b);if(SC.typeOf(b)===SC.T_STRING){b=SC.objectForPropertyPath(b)}b.subclasses.forEach(function(c){this._scq_expandRecordType(c,a)},this)},parameters:null,location:"local",scope:null,isRemote:function(){return this.get("location")===SC.Query.REMOTE}.property("location").cacheable(),isLocal:function(){return this.get("location")===SC.Query.LOCAL}.property("location").cacheable(),isEditable:NO,contains:function(a,d){var e,b=YES;if(e=this.get("recordTypes")){b=e.find(function(f){return SC.kindOf(a,f)})}else{if(e=this.get("recordType")){b=SC.kindOf(a,e)}}if(!b){return NO}var c=this.get("scope");if(c&&!c.contains(a)){return NO}if(!this._isReady){this.parse()}if(!this._isReady){return NO}if(d===undefined){d=this.parameters||this}return this._tokenTree.evaluate(a,d)},containsRecordTypes:function(a){var b=this.get("recordType");if(b){return !!a.find(function(c){return SC.kindOf(c,b)})}else{if(b=this.get("recordTypes")){return !!b.find(function(c){return !!a.find(function(d){return SC.kindOf(d,c)})})}else{return YES}}},compare:function(g,d){var c=0,f,b,a,h,e;if(g===d){return 0}if(!this._isReady){this.parse()}if(!this._isReady){return SC.compare(g.get("storeKey"),d.get("storeKey"))}b=this._order;if(SC.typeOf(b)===SC.T_FUNCTION){c=b.call(null,g,d)}else{a=b?b.length:0;for(h=0;c===0&&(h<a);h++){f=b[h].propertyName;e=/\./.test(f)?"getPath":"get";if(SC.Query.comparisons[f]){c=SC.Query.comparisons[f](g[e](f),d[e](f))}else{c=SC.compare(g[e](f),d[e](f))}if((c!==0)&&b[h].descending){c=(-1)*c}}}if(c!==0){return c}else{return SC.compare(g.get("storeKey"),d.get("storeKey"))}},_isReady:NO,parse:function(){var c=this.get("conditions"),d=this.get("queryLanguage"),b,a;b=this._tokenList=this.tokenizeString(c,d);a=this._tokenTree=this.buildTokenTree(b,d);this._order=this.buildOrder(this.get("orderBy"));this._isReady=!!a&&!a.error;if(a&&a.error){throw a.error}return this._isReady},queryWithScope:function(c){var b=SC.keyFor("__query__",SC.guidFor(this)),a=c[b];if(!a){c[b]=a=this.copy();a.set("scope",c);a.freeze()}return a},copyKeys:["conditions","orderBy","recordType","recordTypes","parameters","location","scope"],concatenatedProperties:["copyKeys"],copy:function(){var d={},c=this.get("copyKeys"),f=c?c.length:0,b,e,a;while(--f>=0){b=c[f];e=this.get(b);if(e!==undefined){d[b]=e}}a=this.constructor.create(d);d=null;return a},queryLanguage:{UNKNOWN:{firstCharacter:/[^\s'"\w\d\(\)\{\}]/,notAllowed:/[\-\s'"\w\d\(\)\{\}]/},PROPERTY:{firstCharacter:/[a-zA-Z_]/,notAllowed:/[^a-zA-Z_0-9\.]/,evalType:"PRIMITIVE",evaluate:function(e,b){var f=this.tokenValue.split(".");var a=f.length;if(a<2){return e.get(this.tokenValue)}var c=e;for(var d=0;d<a;d++){if(!c){return}if(c.get){c=c.get(f[d])}else{c=c[f[d]]}}return c}},NUMBER:{firstCharacter:/[\d\-]/,notAllowed:/[^\d\-\.]/,format:/^-?\d+$|^-?\d+\.\d+$/,evalType:"PRIMITIVE",evaluate:function(b,a){return parseFloat(this.tokenValue)}},STRING:{firstCharacter:/['"]/,delimited:true,evalType:"PRIMITIVE",evaluate:function(b,a){return this.tokenValue}},PARAMETER:{firstCharacter:/\{/,lastCharacter:"}",delimited:true,evalType:"PRIMITIVE",evaluate:function(b,a){return a[this.tokenValue]}},"%@":{rememberCount:true,reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return a[this.tokenValue]}},OPEN_PAREN:{firstCharacter:/\(/,singleCharacter:true},CLOSE_PAREN:{firstCharacter:/\)/,singleCharacter:true},AND:{reservedWord:true,leftType:"BOOLEAN",rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return d&&b}},OR:{reservedWord:true,leftType:"BOOLEAN",rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return d||b}},NOT:{reservedWord:true,rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(c,a){var b=this.rightSide.evaluate(c,a);return !b}},"=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.isEqual(d,b)}},"!=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return !SC.isEqual(d,b)}},"<":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)==-1}},"<=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)!=1}},">":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)==1}},">=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return SC.compare(d,b)!=-1}},BEGINS_WITH:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var b=this.leftSide.evaluate(c,a);var d=this.rightSide.evaluate(c,a);return(b&&b.indexOf(d)===0)}},ENDS_WITH:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,b){var c=this.leftSide.evaluate(d,b);var a=this.rightSide.evaluate(d,b);return(c&&c.length>=a.length&&c.lastIndexOf(a)===(c.length-a.length))}},CONTAINS:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(e,a){var d=this.leftSide.evaluate(e,a)||[];var g=this.rightSide.evaluate(e,a);var c=SC.typeOf(d);if(c===SC.T_STRING){return(d.indexOf(g)!==-1)}else{if(c===SC.T_ARRAY||d.toArray){if(c!==SC.T_ARRAY){d=d.toArray()}var f=false;var b=0;while(f===false&&b<d.length){if(g==d[b]){f=true}b++}return f}}}},ANY:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var f=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);var e=false;var c=0;while(e===false&&c<b.length){if(f==b[c]){e=true}c++}return e}},MATCHES:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(c,a){var d=this.leftSide.evaluate(c,a);var b=this.rightSide.evaluate(c,a);return b.test(d)}},TYPE_IS:{reservedWord:true,rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var c=SC.Store.recordTypeFor(d.storeKey);var b=this.rightSide.evaluate(d,a);var e=SC.objectForPropertyPath(b);return c==e}},"null":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return null}},"undefined":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return undefined}},"false":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return false}},"true":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return true}},YES:{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return true}},NO:{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return false}}},tokenizeString:function(v,p){var j=[],s=null,g=null,f=null,u=null,a=null,h=null,d=null,w=null,q=false,b=false,l=false,m=false,n={};function e(x,c){g=p[x];if(g.format&&!g.format.test(c)){x="UNKNOWN"}if(g.delimited){m=true}if(!g.delimited){for(var t in p){if(p[t].reservedWord&&t==c){x=t}}}g=p[x];if(g&&g.rememberCount){if(!n[x]){n[x]=0}c=n[x];n[x]+=1}j.push({tokenType:x,tokenValue:c});a=null;h=null;d=null}if(!v){return[]}var k=v.length;for(var o=0;o<k;o++){q=(o===k-1);s=v.charAt(o);m=false;if(a){g=p[a];b=g.delimited?s===w:g.notAllowed.test(s);if(!b){d+=s}if(b||q){e(a,d)}if(q&&!b){m=true}}if(!a&&!m){for(f in p){g=p[f];if(g.firstCharacter&&g.firstCharacter.test(s)){a=f}}if(a){g=p[a];d=s;if(g.delimited){d="";if(g.lastCharacter){w=g.lastCharacter}else{w=s}}if(g.singleCharacter||q){e(a,d)}}}}return j},buildTokenTree:function(k,a){var o=k.slice();var q=0;var t=[];var c=false;var p=[];if(!k||k.length===0){return{evaluate:function(){return true}}}function s(l){var x=l;if(x<0){return false}var w=a[o[x].tokenType];if(!w){p.push("logic for token '"+o[x].tokenType+"' is not defined");return false}o[x].evaluate=w.evaluate;return w}function b(x,l){var y=l;var w=s(y);if(!w){return false}if(x=="left"){return w.leftType}if(x=="right"){return w.rightType}}function n(l){var x=l;var w=s(x);if(!w){return false}else{return w.evalType}}function f(l){o.splice(l,1);if(l<=q){q--}}function u(l){var w=l||q;if(w>0){return true}else{return false}}function j(l){var w=l;if(w<0){return true}return(b("left",w)&&!o[w].leftSide)||(b("right",w)&&!o[w].rightSide)}function h(w,x){var l=(x<w)?"left":"right";if(w<0||x<0){return false}if(!b(l,w)){return false}if(!n(x)){return false}if(b(l,w)==n(x)){return true}else{return false}}function m(l){var w=l;if(!j(w)){return false}if(!u(w)){return false}if(h(w,w-1)){return true}else{return false}}function d(l){var w=l;if(j(w)){return false}if(!u(w)){return false}if(!j(w-1)){return false}if(h(w-1,w)){return true}else{return false}}function g(l){var w=l;if(w<1){return false}o[w].leftSide=o[w-1];f(w-1)}function v(l){var w=l;if(w<1){return false}o[w-1].rightSide=o[w];f(w)}function e(l){f(l);f(t.pop())}for(q=0;q<o.length;q++){c=false;if(o[q].tokenType=="UNKNOWN"){p.push("found unknown token: "+o[q].tokenValue)}if(o[q].tokenType=="OPEN_PAREN"){t.push(q)}if(o[q].tokenType=="CLOSE_PAREN"){e(q)}if(m(q)){g(q)}if(d(q)){v(q);c=true}if(c){q--}}if(o.length==1){o=o[0]}else{p.push("string did not resolve to a single tree")}if(p.length>0){return{error:p.join(",\n"),tree:o}}else{return o}},buildOrder:function(a){if(!a){return[]}else{if(SC.typeOf(a)===SC.T_FUNCTION){return a}else{var d=a.split(",");for(var b=0;b<d.length;b++){var c=d[b];c=c.replace(/^\s+|\s+$/,"");c=c.replace(/\s+/,",");c=c.split(",");d[b]={propertyName:c[0]};if(c[1]&&c[1]=="DESC"){d[b].descending=true}}return d}}}});SC.Query.mixin({LOCAL:"local",REMOTE:"remote",storeKeyFor:function(a){return a?a.get("storeKey"):null},containsRecords:function(g,e,d){var f=[];for(var b=0,a=e.get("length");b<a;b++){var c=e.objectAt(b);if(c&&g.contains(c)){f.push(c.get("storeKey"))}}f=SC.Query.orderStoreKeys(f,g,d);return f},orderStoreKeys:function(c,d,a){if(c){var b=c.sort(function(f,e){return SC.Query.compareStoreKeys(d,a,f,e)})}return c},compareStoreKeys:function(f,c,e,d){var b=c.materializeRecord(e),a=c.materializeRecord(d);return f.compare(b,a)},build:function(h,c,g,d){var a=null,f,b,j,e;if(c&&c.isQuery){if(c.get("location")===h){return c}else{return c.copy().set("location",h).freeze()}}if(typeof c===SC.T_STRING){f=SC.objectForPropertyPath(c);if(!f){throw"%@ did not resolve to a class".fmt(c)}c=f}else{if(c&&c.isEnumerable){f=[];c.forEach(function(k){if(typeof k===SC.T_STRING){k=SC.objectForPropertyPath(k)}if(!k){throw"cannot resolve record types: %@".fmt(c)}f.push(k)},this);c=f}else{if(!c){c=SC.Record}}}if(d===undefined){d=null}if(g===undefined){g=null}if(!d&&(typeof g!==SC.T_STRING)){a=g;g=null}if(!d&&!a){e=SC.Query._scq_recordTypeCache;if(!e){e=SC.Query._scq_recordTypeCache={}}b=e[h];if(!b){b=e[h]={}}if(c.isEnumerable){j=c.map(function(l){return SC.guidFor(l)});j=j.sort().join(":")}else{j=SC.guidFor(c)}if(g){j=[j,g].join("::")}f=b[j];if(!f){if(c.isEnumerable){a={recordTypes:c.copy()}}else{a={recordType:c}}a.location=h;a.conditions=g;f=b[j]=SC.Query.create(a).freeze()}}else{if(!a){a={}}if(!a.location){a.location=h}if(c&&c.isEnumerable){a.recordTypes=c}else{a.recordType=c}if(g){a.conditions=g}if(d){a.parameters=d}f=SC.Query.create(a).freeze()}return f},local:function(c,a,b){return this.build(SC.Query.LOCAL,c,a,b)},remote:function(c,a,b){return this.build(SC.Query.REMOTE,c,a,b)},_scq_didDefineRecordType:function(){var a=SC.Query._scq_queriesWithExpandedRecordTypes;if(a){a.forEach(function(b){b.notifyPropertyChange("expandedRecordTypes")},this);a.clear()}}});SC.Query.comparisons={};SC.Query.registerComparison=function(a,b){SC.Query.comparisons[a]=b};SC.Query.registerQueryExtension=function(b,a){SC.Query.prototype.queryLanguage[b]=a};SC.Q=SC.Query.from;sc_require("system/query");SC.Record=SC.Object.extend({isRecord:YES,isParentRecord:NO,primaryKey:"guid",id:function(a,b){if(b!==undefined){this.writeAttribute(this.get("primaryKey"),b);return b}else{return SC.Store.idFor(this.storeKey)}}.property("storeKey").cacheable(),status:function(){return this.store.readStatus(this.storeKey)}.property("storeKey").cacheable(),store:null,storeKey:null,isDestroyed:function(){return !!(this.get("status")&SC.Record.DESTROYED)}.property("status").cacheable(),isEditable:function(a,b){if(b!==undefined){this._screc_isEditable=b}if(this.get("status")&SC.Record.READY){return this._screc_isEditable}else{return NO}}.property("status").cacheable(),_screc_isEditable:YES,isLoaded:function(){var b=SC.Record,a=this.get("status");return !((a===b.EMPTY)||(a===b.BUSY_LOADING)||(a===b.ERROR))}.property("status").cacheable(),relationships:null,attributes:function(){var a=this.get("store"),b=this.storeKey;return a.readEditableDataHash(b)}.property(),readOnlyAttributes:function(){var a=this.get("store"),c=this.storeKey,b=a.readDataHash(c);if(b){b=SC.clone(b,YES)}return b}.property(),nestedRecordNamespace:null,isNestedRecord:function(){var c=this.get("store"),d,b=this.get("storeKey"),a=c.parentStoreKeyExists(b);d=a?YES:NO;return d}.property().cacheable(),parentRecord:function(){var a=this.storeKey,b=this.get("store");return b.materializeParentRecord(a)}.property(),refresh:function(e,g){var c=this.get("store"),f,d,b=this.get("storeKey"),a=c.parentStoreKeyExists();d=e||(SC.none(e)&&SC.none(a));if(d){c.refreshRecord(null,null,b,g)}else{if(a){f=c.materializeRecord(a);f.refresh(e,g)}}return this},destroy:function(e){var c=this.get("store"),f,d,b=this.get("storeKey"),a=c.parentStoreKeyExists();d=e||(SC.none(e)&&SC.none(a));if(d){c.destroyRecord(null,null,b);this.notifyPropertyChange("status");this.propagateToAggregates()}else{if(a){f=c.materializeRecord(a);f.destroy(e)}}return this},recordDidChange:function(a){var b=this.get("parentRecord");if(b){b.recordDidChange()}this.get("store").recordDidChange(null,null,this.get("storeKey"),a);this.notifyPropertyChange("status");this.propagateToAggregates();return this},toJSON:function(){return this.get("attributes")},_editLevel:0,beginEditing:function(){this._editLevel++;return this},endEditing:function(a){if(--this._editLevel<=0){this._editLevel=0;this.recordDidChange(a)}return this},readAttribute:function(c){var a=this.get("store"),d=this.storeKey;var b=a.readDataHash(d);return b?b[c]:undefined},writeAttribute:function(c,f,e){var a=this.get("store"),d=this.storeKey,b;b=a.readEditableDataHash(d);if(!b){throw SC.Record.BAD_STATE_ERROR}if(f!==b[c]){if(!e){this.beginEditing()}b[c]=f;if(c===this.get("primaryKey")){SC.Store.replaceIdFor(d,f);this.propertyDidChange("id")}if(!e){this.endEditing(c)}else{a.dataHashDidChange(d,null,undefined,c)}}return this},propagateToAggregates:function(){var n=this.get("storeKey"),d=SC.Store.recordTypeFor(n),f=d.__sc_aggregate_keys,l,g,m,b,c,k;if(!f){f=[];for(m in this){b=this[m];if(b&&b.isRecordAttribute&&b.aggregate===YES){f.push(m)}}d.__sc_aggregate_keys=f}var j=SC.Record,a=j.DIRTY,e=j.READY_NEW,o=j.DESTROYED,p=j.READY_CLEAN,h;h=function(v){var q,s,t,u;if(v){q=this.get("status");if((q&a)||(q&e)||(q&o)){s=v.get("store");t=v.get("storeKey");u=s.peekStatus(t);if(u===p){v.get("store").recordDidChange(v.constructor,null,v.get("storeKey"),null,YES)}}}};for(l=0,g=f.length;l<g;++l){m=f[l];c=this.get(m);k=SC.kindOf(c,SC.ManyArray)?c:[c];k.forEach(h,this)}},storeDidChangeProperties:function(a,b){if(a){this.notifyPropertyChange("status")}else{if(b){this.beginPropertyChanges();b.forEach(function(e){this.notifyPropertyChange(e)},this);this.notifyPropertyChange("status");this.endPropertyChanges()}else{this.allPropertiesDidChange()}var d=this.relationships,c=d?d.length:0;while(--c>=0){d[c].recordPropertyDidChange(b)}}},normalize:function(a){var c=this.primaryKey,b=this.get("id"),f=this.get("store"),e=this.get("storeKey"),j={},t,p,d,s,k,q,m,g,o,h,n;var l=f.readEditableDataHash(e)||{};l[c]=b;s=f.readDataHash(e);for(t in this){p=this[t];if(p){d=p.typeClass;if(d){h=p.get("key")||t;j[h]=YES;m=SC.typeOf(d.call(p))===SC.T_CLASS;g=p.isNestedRecordTransform;if(!m&&!g){k=this.get(t);if(k!==undefined&&(k!==null||a)){n=this[t];if(SC.instanceOf(n,SC.RecordAttribute)){k=n.fromType(this,t,k)}l[h]=k}else{if(!a){j[h]=NO}}}else{if(g){k=this.get(t);if(k&&k.normalize){k.normalize()}}else{if(m){k=s[h];if(k!==undefined){l[h]=k}else{o=p.get("defaultValue");if(SC.typeOf(o)===SC.T_FUNCTION){l[h]=o(this,t,o)}else{l[h]=o}}}}}}}}for(t in l){if(!j[t]){SC.debug("%@:  Deleting key from underlying data hash due to normalization:  %@",this,t);delete l[t]}}return this},unknownProperty:function(b,d){if(d!==undefined){var c=this.get("storeKey"),e=SC.Store.recordTypeFor(c);if(e.ignoreUnknownProperties===YES){this[b]=d;return d}var a=this.get("primaryKey");this.writeAttribute(b,d);if(b===a){SC.Store.replaceIdFor(c,d)}}return this.readAttribute(b)},commitRecord:function(g,e,h){var c=this.get("store"),f,d,b=this.get("storeKey"),a=c.parentStoreKeyExists();d=e||(SC.none(e)&&SC.none(a));if(d){c.commitRecord(undefined,undefined,this.get("storeKey"),g,h)}else{if(a){f=c.materializeRecord(a);f.commitRecord(g,e,h)}}return this},isError:function(){return !!(this.get("status")&SC.Record.ERROR)}.property("status").cacheable(),errorValue:function(){return this.get("isError")?SC.val(this.get("errorObject")):null}.property("isError").cacheable(),errorObject:function(){if(this.get("isError")){var a=this.get("store");return a.readError(this.get("storeKey"))||SC.Record.GENERIC_ERROR}else{return null}}.property("isError").cacheable(),set:function(a,c){var b=this[a];if(b&&b.isProperty&&b.get&&!b.get("isEditable")){return this}return arguments.callee.base.apply(this,arguments)},toString:function(){var a=this.get("store").readDataHash(this.get("storeKey"));return"%@(%@) %@".fmt(this.constructor.toString(),SC.inspect(a),this.statusString())},statusString:function(){var b=[],a=this.get("status");for(var c in SC.Record){if(c.match(/[A-Z_]$/)&&SC.Record[c]===a){b.push(c)}}return b.join(" ")},registerNestedRecord:function(f,e,g){var c,d=this.get("storeKey"),b,a,h;if(SC.none(g)){g=e}if(f&&f.get&&f.get("isRecord")){a=f}else{h=this._materializeNestedRecordType(f,e);a=this.createNestedRecord(h,f,d,g)}if(a){this.isParentRecord=YES;c=this.get("store");b=a.get("storeKey");c.registerChildToParent(d,b,g)}return a},unregisterNestedRecord:function(d){var b,a,c;c=this.get("store");b=this.getPath(d);a=b.get("storeKey");c.unregisterChildFromParent(a)},_materializeNestedRecordType:function(d,c){var a,e,b;if(SC.typeOf(d)===SC.T_HASH){a=this.get("nestedRecordNamespace");if(d.type&&!SC.none(a)){e=a[d.type]}}if(!e&&c&&this[c]){e=this[c].get("typeClass")}if(!e||!SC.kindOf(e,SC.Record)){throw"SC.Child: Error during transform: Invalid record type."}return e},createNestedRecord:function(b,e,g,j){var h=this.get("store"),a,c,d,f=null;e=e||{};if(SC.none(h)){throw"Error: during the creation of a child record: NO STORE ON PARENT!"}a=e[b.prototype.primaryKey];if(!a){this.generateIdForChild(f)}if(!a){a=g+"."+j}c=h.storeKeyExists(b,a);if(c){h.writeDataHash(c,e);f=h.materializeRecord(c)}else{f=h.createRecord(b,e,a)}return f},_nestedRecordKey:0,generateIdForChild:function(a){}});SC.Record.mixin({ignoreUnknownProperties:NO,CLEAN:1,DIRTY:2,EMPTY:256,ERROR:4096,READY:512,READY_CLEAN:513,READY_DIRTY:514,READY_NEW:515,DESTROYED:1024,DESTROYED_CLEAN:1025,DESTROYED_DIRTY:1026,BUSY:2048,BUSY_LOADING:2052,BUSY_CREATING:2056,BUSY_COMMITTING:2064,BUSY_REFRESH:2080,BUSY_REFRESH_CLEAN:2081,BUSY_REFRESH_DIRTY:2082,BUSY_DESTROYING:2112,BAD_STATE_ERROR:SC.$error("Internal Inconsistency"),RECORD_EXISTS_ERROR:SC.$error("Record Exists"),NOT_FOUND_ERROR:SC.$error("Not found "),BUSY_ERROR:SC.$error("Busy"),GENERIC_ERROR:SC.$error("Generic Error"),_nextChildKey:0,attr:function(a,b){return SC.RecordAttribute.attr(a,b)},fetch:function(b,a){return SC.FetchedAttribute.attr(b,a)},toMany:function(d,b){b=b||{};var c=b.nested||b.isNested;var a;this._throwUnlessRecordTypeDefined(d,"toMany");if(c){a=SC.ChildrenAttribute.attr(d,b)}else{a=SC.ManyAttribute.attr(d,b)}return a},toOne:function(d,b){b=b||{};var c=b.nested||b.isNested;var a;this._throwUnlessRecordTypeDefined(d,"toOne");if(c){a=SC.ChildAttribute.attr(d,b)}else{a=SC.SingleAttribute.attr(d,b)}return a},_throwUnlessRecordTypeDefined:function(b,a){if(!b){throw"Attempted to create "+a+" attribute with undefined recordType. Did you forget to sc_require a dependency?"}},storeKeysById:function(){var b=SC.keyFor("storeKey",SC.guidFor(this)),a=this[b];if(!a){a=this[b]={}}return a},storeKeyFor:function(c){var b=this.storeKeysById(),a=b[c];if(!a){a=SC.Store.generateStoreKey();SC.Store.idsByStoreKey[a]=c;SC.Store.recordTypesByStoreKey[a]=this;b[c]=a}return a},storeKeyExists:function(c){var b=this.storeKeysById(),a=b[c];return a},find:function(a,b){return a.find(this,b)},extend:function(){var a=SC.Object.extend.apply(this,arguments);if(SC.Query){SC.Query._scq_didDefineRecordType(a)}return a}});sc_require("data_sources/data_source");sc_require("models/record");SC.FixturesDataSource=SC.DataSource.extend({simulateRemoteResponse:NO,latency:50,cancel:function(a,b){return NO},fetch:function(a,b){if(b.get("location")!==SC.Query.LOCAL){throw SC.$error("SC.Fixture data source can only fetch local queries")}if(!b.get("recordType")&&!b.get("recordTypes")){throw SC.$error("SC.Fixture data source can only fetch queries with one or more record types")}if(this.get("simulateRemoteResponse")){this.invokeLater(this._fetch,this.get("latency"),a,b)}else{this._fetch(a,b)}},_fetch:function(a,c){var d=c.get("recordType"),b=c.get("recordTypes")||[d];b.forEach(function(e){if(SC.typeOf(e)===SC.T_STRING){e=SC.objectForPropertyPath(e)}if(e){this.loadFixturesFor(a,e)}},this);a.dataSourceDidFetchQuery(c)},retrieveRecords:function(a,c){var d=this.get("latency"),b=this.hasFixturesFor(c);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._retrieveRecords,d,a,c)}else{this._retrieveRecords(a,c)}return b},_retrieveRecords:function(a,b){b.forEach(function(d){var c=[],g=SC.Store.recordTypeFor(d),f=a.idFor(d),e=this.fixtureForStoreKey(a,d);c.push(d);a.dataSourceDidComplete(d,e,f)},this)},updateRecords:function(a,c,e){var d=this.get("latency"),b=this.hasFixturesFor(c);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._updateRecords,d,a,c)}else{this._updateRecords(a,c)}return b},_updateRecords:function(a,b){b.forEach(function(c){var d=a.readDataHash(c);this.setFixtureForStoreKey(a,c,d);a.dataSourceDidComplete(c)},this)},createRecords:function(a,b,d){var c=this.get("latency");if(this.get("simulateRemoteResponse")){this.invokeLater(this._createRecords,c,a,b)}else{this._createRecords(a,b)}return YES},_createRecords:function(a,b){b.forEach(function(e){var g=a.idFor(e),f=a.recordTypeFor(e),d=a.readDataHash(e),c=this.fixturesFor(f);if(!g){g=this.generateIdFor(f,d,a,e)}this._invalidateCachesFor(f,e,g);c[g]=d;a.dataSourceDidComplete(e,null,g)},this)},destroyRecords:function(a,c,e){var d=this.get("latency"),b=this.hasFixturesFor(c);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._destroyRecords,d,a,c)}else{this._destroyRecords(a,c)}return b},_destroyRecords:function(a,b){b.forEach(function(d){var f=a.idFor(d),e=a.recordTypeFor(d),c=this.fixturesFor(e);this._invalidateCachesFor(e,d,f);if(f){delete c[f]}a.dataSourceDidDestroy(d)},this)},loadFixturesFor:function(a,g,c){var b=[],e,d,f;e=this.fixturesFor(g);for(d in e){f=g.storeKeyFor(d);if(a.peekStatus(f)===SC.Record.EMPTY){b.push(e[d])}if(c){c.push(f)}}if(b&&b.length>0){a.loadRecords(g,b)}return this},generateIdFor:function(d,b,a,c){return"@id%@".fmt(SC.Store.generateStoreKey())},fixtureForStoreKey:function(a,c){var e=a.idFor(c),d=a.recordTypeFor(c),b=this.fixturesFor(d);return b?b[e]:null},setFixtureForStoreKey:function(a,d,c){var f=a.idFor(d),e=a.recordTypeFor(d),b=this.fixturesFor(e);this._invalidateCachesFor(e,d,f);b[f]=c;return this},fixturesFor:function(h){if(!this._fixtures){this._fixtures={}}var f=this._fixtures[SC.guidFor(h)];if(f){return f}var e=h?h.FIXTURES:null,b=e?e.length:0,c=h?h.prototype.primaryKey:"guid",a,d,g;this._fixtures[SC.guidFor(h)]=f={};for(a=0;a<b;a++){d=e[a];g=d[c];if(!g){g=this.generateIdFor(h,d)}f[g]=d}return f},fixturesLoadedFor:function(c){if(!this._fixtures){return NO}var a=[],b=this._fixtures[SC.guidFor(c)];return b?YES:NO},reset:function(){this._fixtures=null;return this},hasFixturesFor:function(b){var a=NO;b.forEach(function(d){if(a!==SC.MIXED_STATE){var e=SC.Store.recordTypeFor(d),c=e?e.FIXTURES:null;if(c&&c.length&&c.length>0){if(a===NO){a=YES}}else{if(a===YES){a=SC.MIXED_STATE}}}},this);return a},_invalidateCachesFor:function(d,b,c){var a=this._storeKeyCache;if(a){delete a[SC.guidFor(d)]}return this}});SC.Record.fixtures=SC.FixturesDataSource.create();SC.RelationshipSupport={_srs_inverseDidRelinquishRelationships:function(d,c,a,b){c.forEach(function(e){this._srs_inverseDidRelinquishRelationship(d,e,a,b)},this)},_srs_inverseDidRelinquishRelationship:function(h,g,f,b){var e=h.storeKeyFor(g),c=this.readDataHash(e),a=f.inverse,d=h.prototype;if(!c||!a){return}if(SC.instanceOf(d[a],SC.SingleAttribute)){delete c[a]}else{if(SC.instanceOf(d[a],SC.ManyAttribute)&&SC.typeOf(c[a])===SC.T_ARRAY){c[a].removeObject(b)}}this.pushRetrieve(h,g,c,undefined,true)},_srs_inverseDidAddRelationships:function(d,c,a,b){c.forEach(function(e){this._srs_inverseDidAddRelationship(d,e,a,b)},this)},_srs_inverseDidAddRelationship:function(b,a,j,l){var k=b.storeKeyFor(a),g=this.readDataHash(k),d=this.peekStatus(k),f=b.prototype,h=j.inverse,m=f[h],c=f[f.primaryKey],e=false;m=(m&&m.get&&m.get("key")||m.key)||h;if((d===SC.Record.EMPTY)&&(SC.typeOf(j.lazilyInstantiate)===SC.T_FUNCTION&&j.lazilyInstantiate()||SC.typeOf(j.lazilyInstantiate)!==SC.T_FUNCTION&&j.lazilyInstantiate)){if(!SC.none(c)&&c.typeClass&&SC.typeOf(c.typeClass())===SC.T_CLASS){e=true}g={};g[f.primaryKey]=a}if(!g||!h){return}if(SC.instanceOf(f[h],SC.SingleAttribute)){g[m]=l}else{if(SC.instanceOf(f[h],SC.ManyAttribute)){g[m]=g[m]||[];if(g[m].indexOf(l)<0){g[m].push(l)}}}this.pushRetrieve(b,a,g,undefined,!e)},_srs_pushIterator:function(d,b,j,f){var e=d.prototype,g,c,h,a;if(typeof j==="undefined"){j=d.storeKeyFor(b)}c=this.readDataHash(j)||{};for(h in e){g=e[h];if(g&&g.typeClass&&g.inverse&&g.isMaster){a=g.typeClass();if(SC.typeOf(a)!==SC.T_CLASS){continue}f.apply(this,[a,c,g,g.get&&g.get("key")||h])}}},pushDestroy:function(a,e,d,c){var b;this._srs_pushIterator(e,d,c,function(f,g,j,h){b=[g[h]||null].flatten().compact().uniq();this._srs_inverseDidRelinquishRelationships(f,b,j,d)});return a(e,d,c)}.enhance(),pushRetrieve:function(b,h,g,c,e,f){if(!f){var d,a;this._srs_pushIterator(h,g,e,function(j,k,m,l){d=[k[l]||null].flatten().compact().uniq();a=[c[l]||null].flatten().compact().uniq();this._srs_inverseDidRelinquishRelationships(j,d.filter(function(n){return a.indexOf(n)===-1}),m,g);this._srs_inverseDidAddRelationships(j,a,m,g)})}e=e||h.storeKeyFor(g);return b(h,g,c,e)}.enhance()};sc_require("models/record");SC.RecordAttribute=SC.Object.extend({isRecordAttribute:YES,defaultValue:null,type:String,key:null,isRequired:NO,isEditable:YES,useIsoDate:YES,aggregate:NO,lazilyInstantiate:NO,typeClass:function(){var a=this.get("type");if(SC.typeOf(a)===SC.T_STRING){a=SC.requiredObjectForPropertyPath(a)}return a}.property("type").cacheable(),transform:function(){var a=this.get("typeClass")||String,c=SC.RecordAttribute.transforms,b;while(a&&!(b=c[SC.guidFor(a)])){if(a.superclass.hasOwnProperty("create")){a=a.superclass}else{a=SC.T_FUNCTION}}return b}.property("typeClass").cacheable(),toType:function(e,j,h){var c=this.get("transform"),g=this.get("typeClass"),b;if(c&&c.to){h=c.to(h,this,g,e,j);if(!SC.none(h)&&(b=c.observesChildren)){var d,f=b.length,a={record:e,key:j};for(d=0;d<f;d++){h.addObserver(b[d],this,this._SCRA_childObserver,a)}}}return h},_SCRA_childObserver:function(d,b,c,a){this.call(a.record,a.key,d);a.record.notifyPropertyChange(a.key)},fromType:function(a,c,e){var b=this.get("transform"),d=this.get("typeClass");if(b&&b.from){e=b.from(e,this,d,a,c)}return e},call:function(a,b,c){var d=this.get("key")||b,e;if((c!==undefined)&&this.get("isEditable")){e=this.fromType(a,b,c);a.writeAttribute(d,e)}c=a.readAttribute(d);if(SC.none(c)&&(c=this.get("defaultValue"))){if(typeof c===SC.T_FUNCTION){c=c(a,b,this)}}c=this.toType(a,b,c);return c},apply:function(b,a){return this.call.apply(b,a)},isProperty:YES,isCacheable:YES,dependentKeys:[],init:function(){arguments.callee.base.apply(this,arguments);this.cacheKey="__cache__recattr__"+SC.guidFor(this);this.lastSetValueKey="__lastValue__recattr__"+SC.guidFor(this)}});SC.RecordAttribute.mixin({attr:function(a,b){if(!b){b={}}if(!b.type){b.type=a||String}return this.create(b)},transforms:{},registerTransform:function(a,b){SC.RecordAttribute.transforms[SC.guidFor(a)]=b}});SC.RecordAttribute.registerTransform(Boolean,{to:function(a){return SC.none(a)?null:!!a}});SC.RecordAttribute.registerTransform(Number,{to:function(a){return SC.none(a)?null:Number(a)}});SC.RecordAttribute.registerTransform(String,{to:function(a){if(!(typeof a===SC.T_STRING)&&!SC.none(a)&&a.toString){a=a.toString()}return a}});SC.RecordAttribute.registerTransform(Array,{to:function(a){if(!SC.isArray(a)&&!SC.none(a)){a=[]}return a},observesChildren:["[]"]});SC.RecordAttribute.registerTransform(Object,{to:function(a){if(!(typeof a==="object")&&!SC.none(a)){a={}}return a}});SC.RecordAttribute.registerTransform(SC.Record,{to:function(e,a,d,c){var b=c.get("store");if(SC.none(e)||(e==="")){return null}else{return b.find(d,e)}},from:function(a){return a?a.get("id"):null}});SC.RecordAttribute.registerTransform(SC.T_FUNCTION,{to:function(e,a,d,c){d=d.apply(c);var b=c.get("store");return b.find(d,e)},from:function(a){return a.get("id")}});SC.RecordAttribute.registerTransform(Date,{to:function(j,a){if(SC.none(j)){return j}var c;j=j.toString()||"";if(a.get("useIsoDate")){var e="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",h=j.match(new RegExp(e)),g=0,b=new Date(h[1],0,1),f;if(h[3]){b.setMonth(h[3]-1)}if(h[5]){b.setDate(h[5])}if(h[7]){b.setHours(h[7])}if(h[8]){b.setMinutes(h[8])}if(h[10]){b.setSeconds(h[10])}if(h[12]){b.setMilliseconds(Number("0."+h[12])*1000)}if(h[14]){g=(Number(h[16])*60)+Number(h[17]);g*=((h[15]==="-")?1:-1)}g-=b.getTimezoneOffset();f=(Number(b)+(g*60*1000));c=new Date();c.setTime(Number(f))}else{c=new Date(Date.parse(j))}return c},_dates:{},_zeropad:function(a){return((a<0)?"-":"")+((a<10)?"0":"")+Math.abs(a)},from:function(b){if(SC.none(b)){return null}var a=this._dates[b.getTime()];if(a){return a}var d=this._zeropad,c=0-b.getTimezoneOffset()/60;c=(c===0)?"Z":"%@:00".fmt(d(c));this._dates[b.getTime()]=a="%@-%@-%@T%@:%@:%@%@".fmt(d(b.getFullYear()),d(b.getMonth()+1),d(b.getDate()),d(b.getHours()),d(b.getMinutes()),d(b.getSeconds()),c);return a}});if(SC.DateTime&&!SC.RecordAttribute.transforms[SC.guidFor(SC.DateTime)]){SC.RecordAttribute.registerTransform(SC.DateTime,{to:function(c,a){if(a.get("useUnixTime")){if(SC.typeOf(c)===SC.T_STRING){c=parseInt(c)}if(isNaN(c)||SC.typeOf(c)!==SC.T_NUMBER){c=0}return SC.DateTime.create({milliseconds:c*1000,timezone:0})}if(SC.none(c)||SC.instanceOf(c,SC.DateTime)){return c}if(SC.none(c)||SC.instanceOf(c,Date)){return SC.DateTime.create(c.getTime())}var b=a.get("format");return SC.DateTime.parse(c,b?b:SC.DateTime.recordFormat)},from:function(b,a){if(SC.none(b)){return b}if(a.get("useUnixTime")){return b.get("milliseconds")/1000}var c=a.get("format");return b.toFormattedString(c?c:SC.DateTime.recordFormat)}})}SC.RecordAttribute.registerTransform(SC.Set,{to:function(e,a,d,b,c){return SC.Set.create(e)},from:function(e,a,d,b,c){return e.toArray()},observesChildren:["[]"]});sc_require("models/record");sc_require("models/record_attribute");SC.ChildAttribute=SC.RecordAttribute.extend({isNestedRecordTransform:YES,toType:function(b,d,e){var c=null,a,f=this.get("typeClass");if(!b){throw"SC.Child: Error during transform: Unable to retrieve parent record."}if(!SC.none(e)){c=b.registerNestedRecord(e,d)}return c},fromType:function(b,e,f){var a,c,d;if(b){if(b.readAttribute(e)){b.unregisterNestedRecord(e)}if(SC.none(f)){b.writeAttribute(e,f);d=f}else{d=b.registerNestedRecord(f,e);if(d){a=d.get("storeKey");c=d.get("store");b.writeAttribute(e,c.readDataHash(a))}else{if(f){b.writeAttribute(e,f)}}}}return d},call:function(a,b,c){var d=this.get("key")||b;if(c!==undefined){c=this.fromType(a,b,c)}else{c=a.readAttribute(d);if(SC.none(c)&&(c=this.get("defaultValue"))){if(typeof c===SC.T_FUNCTION){c=this.defaultValue(a,b,this);if(a.attributes()){a.writeAttribute(d,c,true)}}}else{c=this.toType(a,b,c)}}return c}});sc_require("models/record");SC.ChildRecord=SC.Record.extend({});SC.ChildRecord.extend=function(){return SC.Record.extend.apply(this,arguments)};SC.ChildArray=SC.Object.extend(SC.Enumerable,SC.Array,{defaultRecordType:null,record:null,propertyName:null,children:null,store:function(){return this.getPath("record.store")}.property("record").cacheable(),storeKey:function(){return this.getPath("record.storeKey")}.property("record").cacheable(),readOnlyChildren:function(){return this.get("record").readAttribute(this.get("propertyName"))}.property(),editableChildren:function(){var a=this.get("store"),d=this.get("storeKey"),c=this.get("propertyName"),b,e;b=a.readEditableProperty(d,c);if(!b){e=a.readEditableDataHash(d);b=e[c]=[]}return b}.property(),length:function(){var a=this.get("readOnlyChildren");return a?a.length:0}.property("readOnlyChildren"),objectAt:function(b){var g=this._records,e=this.get("readOnlyChildren"),h,c,d=this.get("propertyName"),f=this.get("record");var a=e?e.length:0;if(!e){return undefined}if(g&&(c=g[b])){return c}if(!g){this._records=g=[]}if(b>=a){return undefined}h=e.objectAt(b);if(!h){return undefined}g[b]=c=f.registerNestedRecord(h,d,d+"."+b);return c},replace:function(k,a,j){var b=this.get("editableChildren"),g=j?(j.get?j.get("length"):j.length):0,f=this.get("record"),d,e=this.get("propertyName"),h,c;d=this._processRecordsToHashes(j);if(d!==this._prevChildren){this._performRecordPropertyChange(null,false)}b.replace(k,a,d);f.recordDidChange(e);return this},_processRecordsToHashes:function(c){var b,a;c=c||[];c.forEach(function(e,d){if(e.isNestedRecord){b=e.get("store");a=e.storeKey;c[d]=b.readDataHash(a)}});return c},normalize:function(){this.forEach(function(b,a){if(b.normalize){b.normalize()}})},recordPropertyDidChange:function(a){this._performRecordPropertyChange(a,true);return this},_performRecordPropertyChange:function(e,h){if(e&&!e.contains(this.get("propertyName"))){return this}var b=this.get("readOnlyChildren"),a=0,c=0;var d=this._prevChildren,g=this._childrenContentDidChange;h=SC.none(h)?true:h;if(b===d){return this}if(d){d.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:g});a=d.get("length")}if(b){b.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:g});c=b.get("length")}this._prevChildren=b;if(h){this.arrayContentWillChange(0,a,c);this._childrenContentDidChange(0,a,c)}return this},_childrenContentDidChange:function(c,a,b){this._records=null;this.arrayContentDidChange(c,a,b)},init:function(){arguments.callee.base.apply(this,arguments);this.recordPropertyDidChange()}});sc_require("models/record");sc_require("models/record_attribute");sc_require("models/child_attribute");sc_require("system/child_array");SC.ChildrenAttribute=SC.ChildAttribute.extend({toType:function(b,d,e){var g=this.get("key")||d,f=SC.keyFor("__kidsArray__",SC.guidFor(this)),c=b[f],h=this.get("typeClass"),a;if(!c){c=SC.ChildArray.create({record:b,propertyName:g,defaultRecordType:h});b[f]=c;a=b.get("relationships");if(!a){b.set("relationships",a=[])}a.push(c)}return c},fromType:function(b,e,f){var a,c,g=SC.keyFor("__kidsArray__",SC.guidFor(this)),d=b[g];if(b){b.writeAttribute(e,f);if(d){d=d.recordPropertyDidChange()}}return d},call:function(a,c,d){var e=this.get("key")||c,b,f=SC.keyFor("__kid__",SC.guidFor(this));if(d!==undefined){d=this.fromType(a,c,d)}else{d=a.readAttribute(e);if(SC.none(d)&&(d=this.get("defaultValue"))){if(typeof d===SC.T_FUNCTION){d=this.defaultValue(a,c,this);if(a.attributes()){if(d instanceof Array){d=this.toType(a,c,d).replace(0,d.length,d)}else{a.writeAttribute(e,d,true)}}}}else{d=this.toType(a,c,d)}}return d}});sc_require("models/record");sc_require("models/record_attribute");SC.FetchedAttribute=SC.RecordAttribute.extend({paramValueKey:"link",paramOwnerKey:"owner",paramRelKey:"rel",queryKey:null,isEditable:NO,toType:function(d,j,g){var h=d.get("store");if(!h){return null}var b=this.get("paramValueKey"),a=this.get("paramOwnerKey"),f=this.get("paramRelKey"),e=this.get("queryKey")||this.get("typeClass"),c={};if(b){c[b]=g}if(a){c[a]=d}if(f){c[f]=this.get("key")||j}return h.findAll(e,c)},fromType:function(a,b,c){return c}});SC.ManyArray=SC.Object.extend(SC.Enumerable,SC.Array,{recordType:null,record:null,propertyName:null,manyAttribute:null,store:function(){return this.get("record").get("store")}.property("record").cacheable(),storeKey:function(){return this.get("record").get("storeKey")}.property("record").cacheable(),readOnlyStoreIds:function(){return this.get("record").readAttribute(this.get("propertyName"))}.property(),editableStoreIds:function(){var a=this.get("store"),d=this.get("storeKey"),c=this.get("propertyName"),b,e;b=a.readEditableProperty(d,c);if(!b){e=a.readEditableDataHash(d);b=e[c]=[]}if(b!==this._prevStoreIds){this.recordPropertyDidChange()}return b}.property(),isEditable:function(){var a=this.manyAttribute;return a?a.get("isEditable"):NO}.property("manyAttribute").cacheable(),inverse:function(){var a=this.manyAttribute;return a?a.get("inverse"):null}.property("manyAttribute").cacheable(),isMaster:function(){var a=this.manyAttribute;return a?a.get("isMaster"):null}.property("manyAttribute").cacheable(),orderBy:function(){var a=this.manyAttribute;return a?a.get("orderBy"):null}.property("manyAttribute").cacheable(),length:function(){var a=this.get("readOnlyStoreIds");return a?a.get("length"):0}.property("readOnlyStoreIds"),objectAt:function(a){var g=this._records,f=this.get("readOnlyStoreIds"),c=this.get("store"),h=this.get("recordType"),e,d,b;if(!f||!c){return undefined}if(g&&(d=g[a])){return d}if(!g){this._records=g=[]}b=f.objectAt(a);if(b){e=c.storeKeyFor(h,b);if(c.readStatus(e)===SC.Record.EMPTY){c.retrieveRecord(h,null,e)}g[a]=d=c.materializeRecord(e)}return d},replace:function(n,d,m){if(!this.get("isEditable")){throw"%@.%@[] is not editable".fmt(this.get("record"),this.get("propertyName"))}var c=this.get("editableStoreIds"),k=m?(m.get?m.get("length"):m.length):0,h=this.get("record"),e=this.get("propertyName"),g,a,b,f,l,j;a=[];for(g=0;g<k;g++){a[g]=m.objectAt(g).get("id")}f=this.get("inverse");if(f&&d>0){b=SC.ManyArray._toRemove;if(b){SC.ManyArray._toRemove=null}else{b=[]}for(g=0;g<d;g++){b[g]=this.objectAt(n+g)}}c.replace(n,d,a);if(f){for(g=0;g<d;g++){j=b[g];l=j?j[f]:null;if(l&&l.inverseDidRemoveRecord){l.inverseDidRemoveRecord(j,f,h,e)}}if(b){b.length=0;if(!SC.ManyArray._toRemove){SC.ManyArray._toRemove=b}}for(g=0;g<k;g++){j=m.objectAt(g);l=j?j[f]:null;if(l&&l.inverseDidAddRecord){l.inverseDidAddRecord(j,f,h,e)}}}if(h&&(!f||this.get("isMaster"))){h.recordDidChange(e)}this.enumerableContentDidChange(n,d,k-d);return this},removeInverseRecord:function(c){if(!c){return this}var e=c.get("id"),d=this.get("editableStoreIds"),a=(d&&e)?d.indexOf(e):-1,b;if(a>=0){d.removeAt(a);if(this.get("isMaster")&&(b=this.get("record"))){b.recordDidChange(this.get("propertyName"))}}return this},addInverseRecord:function(d){if(!d){return this}var e=this.get("editableStoreIds"),f=this.get("orderBy"),b=e.get("length"),a,c;if(f){a=this._findInsertionLocation(d,0,b,f)}else{a=b}e.insertAt(a,d.get("id"));if(this.get("isMaster")&&(c=this.get("record"))){c.recordDidChange(this.get("propertyName"))}return this},_findInsertionLocation:function(g,d,c,f){var b=d+Math.floor((c-d)/2),e=this.objectAt(b),a=this._compare(g,e,f);if(a<0){if(b===0){return b}else{return this._findInsertionLocation(g,0,b-1,f)}}else{if(a>0){if(b>=c){return b+1}else{return this._findInsertionLocation(g,b+1,c,f)}}else{return b}}},_compare:function(f,e,j){var h=SC.typeOf(j),g,d,c;if(h===SC.T_FUNCTION){g=j(f,e)}else{if(h===SC.T_STRING){g=SC.compare(f,e)}else{c=j.get("length");g=0;for(d=0;(g===0)&&(d<c);d++){g=SC.compare(f,e)}}}return g},recordPropertyDidChange:function(d){if(d&&!d.contains(this.get("propertyName"))){return this}var g=this.get("readOnlyStoreIds"),a,b;var c=this._prevStoreIds,e=this._storeIdsContentDidChange;if(g===c){return this}if(c){c.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:e});a=c.get("length")}else{a=0}if(g){g.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:e});b=g.get("length")}else{b=0}this.arrayContentWillChange(0,a,b);this._prevStoreIds=g;this._storeIdsContentDidChange(0,a,b)},_storeIdsContentDidChange:function(c,a,b){this._records=null;this.arrayContentDidChange(c,a,b)},unknownProperty:function(b,c){var a;if(SC.typeOf(b)===SC.T_STRING){a=this.reducedProperty(b,c)}return a===undefined?arguments.callee.base.apply(this,arguments):a},init:function(){arguments.callee.base.apply(this,arguments);this.recordPropertyDidChange()}});sc_require("models/record");sc_require("models/record_attribute");sc_require("system/many_array");SC.ManyAttribute=SC.RecordAttribute.extend({inverse:null,isMaster:YES,orderBy:null,toType:function(b,d,f){var e=this.get("typeClass"),h=this.get("key")||d,g=SC.keyFor("__manyArray__",SC.guidFor(this)),c=b[g],a;if(!c){c=SC.ManyArray.create({recordType:e,record:b,propertyName:h,manyAttribute:this});b[g]=c;a=b.get("relationships");if(!a){b.set("relationships",a=[])}a.push(c)}return c},fromType:function(b,e,f){var c=[];if(!SC.isArray(f)){throw"Expects toMany attribute to be an array"}var a=f.get("length");for(var d=0;d<a;d++){c[d]=f.objectAt(d).get("id")}return c},inverseDidRemoveRecord:function(a,b,c,d){var e=a.get(b);if(e){e.removeInverseRecord(c)}},inverseDidAddRecord:function(a,b,c,d){var e=a.get(b);if(e){e.addInverseRecord(c)}}});sc_require("models/record");sc_require("models/record_attribute");SC.SingleAttribute=SC.RecordAttribute.extend({inverse:null,isMaster:YES,call:function(c,j,b){var a=this.get("key")||j,h,g,k,f,e,d;if(b!==undefined&&this.get("isEditable")){if(b&&!SC.kindOf(b,SC.Record)){throw"%@ is not an instance of SC.Record".fmt(b)}h=this.get("inverse");if(h){k=this._scsa_call(c,j)}d=this.fromType(c,j,b);c.writeAttribute(a,d,!this.get("isMaster"));e=b;if(h&&(k!==b)){if(k&&(f=k[h])){f.inverseDidRemoveRecord(k,h,c,j)}if(b&&(f=b[h])){f.inverseDidAddRecord(b,h,c,j)}}}else{e=this._scsa_call(c,j,b)}return e},_scsa_call:SC.RecordAttribute.prototype.call,inverseDidRemoveRecord:function(c,f,g,h){var b=this.get("inverse"),e=this._scsa_call(c,f),d=this.get("isMaster"),a;c.writeAttribute(this.get("key")||f,null,!d);c.notifyPropertyChange(f);if((e!==g)||(h!==b)){if(e&&(a=e[b])){a.inverseDidRemoveRecord(e,b,c,f)}}},inverseDidAddRecord:function(a,h,c,g){var e=this.get("inverse"),j=this._scsa_call(a,h),f=this.get("isMaster"),d,b;b=this.fromType(a,h,c);a.writeAttribute(this.get("key")||h,b,!f);a.notifyPropertyChange(h);if((j!==c)||(g!==e)){if(j&&(d=j[e])){d.inverseDidRemoveRecord(j,e,a,h)}}}});sc_require("models/record");SC.Store=SC.Object.extend({name:null,nestedStores:null,dataSource:null,isNested:NO,commitRecordsAutomatically:NO,from:function(a){this.set("dataSource",a);return this},_getDataSource:function(){var a=this.get("dataSource");if(typeof a===SC.T_STRING){a=SC.requiredObjectForPropertyPath(a);if(a.isClass){a=a.create()}this.set("dataSource",a)}return a},cascade:function(a){var b=SC.A(arguments);a=SC.CascadeDataSource.create({dataSources:b});return this.from(a)},chain:function(b,c){if(!b){b={}}b.parentStore=this;if(c){if(SC.typeOf(c)!=="class"){throw new Error("%@ is not a valid class".fmt(c))}if(!SC.kindOf(c,SC.NestedStore)){throw new Error("%@ is not a type of SC.NestedStore".fmt(c))}}else{c=SC.NestedStore}b.childRecords=this.childRecords?SC.clone(this.childRecords):{};b.parentRecords=this.parentRecords?SC.clone(this.parentRecords):{};var a=c.create(b),d=this.nestedStores;if(!d){d=this.nestedStores=[]}d.push(a);return a},willDestroyNestedStore:function(a){if(this.nestedStores){this.nestedStores.removeObject(a)}return this},hasNestedStore:function(a){while(a&&(a!==this)){a=a.get("parentStore")}return a===this},dataHashes:null,statuses:null,revisions:null,editables:null,changelog:null,recordErrors:null,queryErrors:null,childRecords:null,parentRecords:null,storeKeyEditState:function(b){var c=this.editables,a=this.locks;return(c&&c[b])?SC.Store.EDITABLE:SC.Store.LOCKED},readDataHash:function(a){return this.dataHashes[a]},readEditableDataHash:function(b){var a=this.dataHashes[b];if(!a){return a}var c=this.editables;if(!c){c=this.editables=[]}if(!c[b]){c[b]=1;a=this.dataHashes[b]=SC.clone(a,YES)}return a},readEditableProperty:function(c,a){var e=this.readEditableDataHash(c),d=this.editables[c],b=e[a];if(d===1){d=this.editables[c]={}}if(!d[a]){b=e[a];if(b&&b.isCopyable){b=e[a]=b.copy(YES)}d[a]=YES}return b},writeDataHash:function(c,e,a){if(e){this.dataHashes[c]=e}if(a){this.statuses[c]=a}var d=this.editables;if(!d){d=this.editables=[]}d[c]=1;var b=this;this._propagateToChildren(c,function(f){b.writeDataHash(f,null,a)});return this},removeDataHash:function(b,a){this.dataHashes[b]=null;this.statuses[b]=a||SC.Record.EMPTY;var c=this.editables;if(c){c[b]=0}return this},readStatus:function(a){this.readDataHash(a);return this.statuses[a]||SC.Record.EMPTY},peekStatus:function(a){return this.statuses[a]||SC.Record.EMPTY},writeStatus:function(b,a){return this.writeDataHash(b,null,a)},dataHashDidChange:function(e,b,a,h){if(!b){b=SC.Store.generateStoreKey()}var c,f,g,j;c=SC.typeOf(e)===SC.T_ARRAY;if(c){f=e.length}else{f=1;j=e}var d=this;for(g=0;g<f;g++){if(c){j=e[g]}this.revisions[j]=b;this._notifyRecordPropertyChange(j,a,h);this._propagateToChildren(j,function(k){d.dataHashDidChange(k,null,a,h)})}return this},_notifyRecordPropertyChange:function(n,e,m){var a=this.records,g=this.get("nestedStores"),h=SC.Store,c,b,f,l,k,d,o;f=g?g.length:0;for(l=0;l<f;l++){k=g[l];d=k.peekStatus(n);b=k.storeKeyEditState(n);if(b===h.INHERITED){k._notifyRecordPropertyChange(n,e,m)}else{if(d&SC.Record.BUSY){if(k.get("hasChanges")){throw h.CHAIN_CONFLICT_ERROR}k.reset()}}}var j=this.recordPropertyChanges;if(!j){j=this.recordPropertyChanges={storeKeys:SC.CoreSet.create(),records:SC.CoreSet.create(),hasDataChanges:SC.CoreSet.create(),propertyForStoreKeys:{}}}j.storeKeys.add(n);if(a&&(c=a[n])){j.records.push(n);if(!e){j.hasDataChanges.push(n)}if(m){if(!(o=j.propertyForStoreKeys[n])){o=j.propertyForStoreKeys[n]=SC.CoreSet.create()}if(o!=="*"){o.add(m)}}else{j.propertyForStoreKeys[n]="*"}}this.invokeOnce(this.flush);return this},flush:function(){if(!this.recordPropertyChanges){return this}var j=this.recordPropertyChanges,h=j.storeKeys,m=j.hasDataChanges,a=j.records,f=j.propertyForStoreKeys,d=SC.CoreSet.create(),c,b,e,k,g,l,n;h.forEach(function(o){if(a.contains(o)){e=m.contains(o)?NO:YES;c=this.records[o];n=f?f[o]:null;if(n==="*"){n=null}a.remove(o);if(c){c.storeDidChangeProperties(e,n)}}b=SC.Store.recordTypeFor(o);d.add(b)},this);if(h.get("length")>0){this._notifyRecordArrays(h,d)}h.clear();m.clear();a.clear();this.recordPropertyChanges.propertyForStoreKeys={};return this},reset:function(){this.dataHashes={};this.revisions={};this.statuses={};this.chainedChanges=this.locks=this.editables=null;this.changelog=null;this.recordErrors=null;this.queryErrors=null;var c=this.get("dataSource");if(c&&c.reset){c.reset()}var a=this.records,b;if(a){for(b in a){if(!a.hasOwnProperty(b)){continue}this._notifyRecordPropertyChange(parseInt(b,10),NO)}}this.set("hasChanges",NO)},commitChangesFromNestedStore:function(j,u,d){if(!d){this._verifyLockRevisions(u,j.locks)}var p=u.length,o,f,c,l,e,b,h,a,q,s,g,m,k;b=this.revisions;c=this.dataHashes;l=this.statuses;e=this.editables;h=this.parentRecords?this.parentRecords:this.parentRecords={};a=this.childRecords?this.childRecords:this.childRecords={};if(!e){e=this.editables=[]}q=j.dataHashes;g=j.revisions;s=j.statuses;m=j.parentRecords||{};k=j.childRecords||{};for(o=0;o<p;o++){f=u[o];c[f]=q[f];l[f]=s[f];b[f]=g[f];h[f]=m[f];a[f]=k[f];e[f]=0;this._notifyRecordPropertyChange(f,NO)}var n=this.changelog,t=j.changelog;if(t){if(!n){n=this.changelog=SC.CoreSet.create()}n.addEach(t)}this.changelog=n;if(!this.get("parentStore")){this.flush()}return this},_verifyLockRevisions:function(f,h){var a=f.length,c=this.revisions,e,g,d,b;if(h&&c){for(e=0;e<a;e++){g=f[e];d=h[g]||1;b=c[g]||1;if(d<b){throw SC.Store.CHAIN_CONFLICT_ERROR}}}return this},find:function(b,a){if(SC.typeOf(b)===SC.T_STRING){b=SC.objectForPropertyPath(b)}if((arguments.length===1)&&!(b&&b.get&&b.get("isRecord"))){if(!b){throw new Error("SC.Store#find() must pass recordType or query")}if(!b.isQuery){b=SC.Query.local(b)}return this._findQuery(b,YES,YES)}else{return this._findRecord(b,a)}},findAll:function(c,a,b){SC.Logger.warn("SC.Store#findAll() will be removed in a future version of SproutCore.  Use SC.Store#find() instead");if(!c||!c.isQuery){c=SC.Query.local(c,a,b)}return this._findQuery(c,YES,YES)},_findQuery:function(f,a,e){var b=this._scst_recordArraysByQuery,d=SC.guidFor(f),c,g;if(!b){b=this._scst_recordArraysByQuery={}}c=b[d];if(!c&&a){b[d]=c=SC.RecordArray.create({store:this,query:f});g=this.get("recordArrays");if(!g){this.set("recordArrays",g=SC.Set.create())}g.add(c);if(e){this.refreshQuery(f)}}this.flush();return c},_findRecord:function(c,b){var a;if(c&&c.get&&c.get("isRecord")){a=c.get("storeKey")}else{a=b?c.storeKeyFor(b):null}if(a&&(this.readStatus(a)===SC.Record.EMPTY)){a=this.retrieveRecord(c,b)}return a?this.materializeRecord(a):null},recordArrayWillDestroy:function(b){var a=this._scst_recordArraysByQuery,c=this.get("recordArrays");if(a){delete a[SC.guidFor(b.get("query"))]}if(c){c.remove(b)}return this},refreshQuery:function(d){if(!d){throw new Error("refreshQuery() requires a query")}var a=this._scst_recordArraysByQuery,c=a?a[SC.guidFor(d)]:null,b=this._getDataSource();if(b&&b.fetch){if(c){c.storeWillFetchQuery(d)}b.fetch.call(b,this,d)}return this},_notifyRecordArrays:function(b,a){var c=this.get("recordArrays");if(!c){return this}c.forEach(function(d){if(d){d.storeDidChangeStoreKeys(b,a)}},this);return this},recordsFor:function(f){var d=[],a=f.storeKeysById(),e,c,b;for(e in a){c=a[e];if(this.readStatus(c)!==SC.RECORD_EMPTY){d.push(c)}}if(d.length>0){b=SC.RecordArray.create({store:this,storeKeys:d})}else{b=d}return b},_TMP_REC_ATTRS:{},materializeRecord:function(d){var a=this.records,c,e,b;if(!a){a=this.records={}}c=a[d];if(c){return c}e=SC.Store.recordTypeFor(d);if(!e){return null}b=this._TMP_REC_ATTRS;b.storeKey=d;b.store=this;c=a[d]=e.create(b);return c},createRecord:function(d,f,b){var n,m,o,e,l=SC.Record,h,k,j;f=(f?f:{});if(!b&&(n=d.prototype.primaryKey)){b=f[n];k=d.prototype[n]?d.prototype[n].defaultValue:null;if(!b&&SC.typeOf(k)===SC.T_FUNCTION){b=f[n]=k()}}o=b?d.storeKeyFor(b):SC.Store.generateStoreKey();e=this.readStatus(o);if((e&l.BUSY)||(e&l.READY)||(e===l.DESTROYED_DIRTY)){throw b?l.RECORD_EXISTS_ERROR:l.BAD_STATE_ERROR}else{if(!b&&(e===SC.DESTROYED_CLEAN||e===SC.ERROR)){throw l.BAD_STATE_ERROR}}this.writeDataHash(o,f,l.READY_NEW);SC.Store.replaceRecordTypeFor(o,d);this.dataHashDidChange(o);j=this.materializeRecord(o);m=d.prototype;for(var a in m){var g=m[a];if(g&&g.isRecordAttribute){var c=g.key||a;if(!f.hasOwnProperty(c)){if(f.hasOwnProperty(a)){f[c]=f[a];delete f[a]}else{k=g.defaultValue;if(k){if(SC.typeOf(k)===SC.T_FUNCTION){f[c]=SC.copy(k(j,c),YES)}else{f[c]=SC.copy(k,YES)}}}}else{if(c!==a&&f.hasOwnProperty(a)){delete f[a]}}}}h=this.changelog;if(!h){h=SC.Set.create()}h.add(o);this.changelog=h;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}if(j){j.propagateToAggregates()}return j},createRecords:function(d,j,a){var g=[],c,b,e,f=j.length,h;e=SC.typeOf(d)===SC.T_ARRAY;if(!e){c=d}for(h=0;h<f;h++){if(e){c=d[h]||SC.Record}b=a?a[h]:undefined;g.push(this.createRecord(c,j[h],b))}return g},unloadRecord:function(g,f,e,c){if(e===undefined){e=g.storeKeyFor(f)}var b=this.readStatus(e),a=SC.Record;c=c||a.EMPTY;if((b===a.BUSY_DESTROYING)||(b&a.DESTROYED)){return this}else{if(b&a.BUSY){throw a.BUSY_ERROR}else{b=c}}this.removeDataHash(e,b);this.dataHashDidChange(e);var d=this;this._propagateToChildren(e,function(h){d.unloadRecord(null,null,h,c)});return this},unloadRecords:function(d,a,g,e){var h,f,j,b,c,k;if(g===undefined){f=SC.typeOf(d)===SC.T_ARRAY;if(!f){c=d}if(a===undefined){h=f?d.length:1;for(j=0;j<h;j++){if(f){c=d[j]}g=this.storeKeysFor(c);this.unloadRecords(undefined,undefined,g,e)}}else{h=a.length;for(j=0;j<h;j++){if(f){c=d[j]||SC.Record}b=a?a[j]:undefined;this.unloadRecord(c,b,undefined,e)}}}else{h=g.length;for(j=0;j<h;j++){k=g?g[j]:undefined;this.unloadRecord(undefined,undefined,k,e)}}return this},destroyRecord:function(g,f,e){if(e===undefined){e=g.storeKeyFor(f)}var b=this.readStatus(e),c,a=SC.Record;if((b===a.BUSY_DESTROYING)||(b&a.DESTROYED)){return this}else{if(b===a.EMPTY){throw a.NOT_FOUND_ERROR}else{if(b&a.BUSY){throw a.BUSY_ERROR}else{if(b===a.READY_NEW){b=a.DESTROYED_CLEAN}else{b=a.DESTROYED_DIRTY}}}}this.writeStatus(e,b);this.dataHashDidChange(e);c=this.changelog;if(!c){c=this.changelog=SC.Set.create()}((b&a.DIRTY)?c.add(e):c.remove(e));this.changelog=c;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}var d=this;this._propagateToChildren(e,function(h){d.destroyRecord(null,null,h)});return this},destroyRecords:function(d,a,f){var g,e,h,b,c,j;if(f===undefined){g=a.length;e=SC.typeOf(d)===SC.T_ARRAY;if(!e){c=d}for(h=0;h<g;h++){if(e){c=d[h]||SC.Record}b=a?a[h]:undefined;this.destroyRecord(c,b,undefined)}}else{g=f.length;for(h=0;h<g;h++){j=f?f[h]:undefined;this.destroyRecord(undefined,undefined,j)}}return this},registerChildToParent:function(c,g,f){var e,b,d,h,a;b=this.childRecords||{};e=this.parentRecords||{};d=b[g];if(d){h=e[d];delete h[g]}a=e[c]||{};a[g]=f||YES;e[c]=a;b[g]=c;this.writeStatus(g,this.statuses[c]);this.childRecords=b;this.parentRecords=e},unregisterChildFromParent:function(c){var a,b;a=this.childRecords;b=a[c];if(b){delete this.parentRecords[b][c]}this.removeDataHash(c);delete this.records[c];delete a[c]},materializeParentRecord:function(c){var b,a;if(SC.none(c)){return null}a=this.childRecords;b=a?this.childRecords[c]:null;if(SC.none(b)){return null}return this.materializeRecord(b)},parentStoreKeyExists:function(b){if(SC.none(b)){return}var a=this.childRecords||{};return a[b]},_propagateToChildren:function(d,c){if(SC.none(this.parentRecords)){return}var b=this.parentRecords[d]||{};if(SC.none(c)){return}for(var a in b){if(b.hasOwnProperty(a)){c(parseInt(a,10))}}},recordDidChange:function(h,g,f,d,c){if(f===undefined){f=h.storeKeyFor(g)}var b=this.readStatus(f),e,a=SC.Record;if(b&a.BUSY){throw a.BUSY_ERROR}else{if(!(b&a.READY)){throw a.NOT_FOUND_ERROR}else{if(b!=a.READY_NEW){this.writeStatus(f,a.READY_DIRTY)}}}this.dataHashDidChange(f,null,c,d);e=this.changelog;if(!e){e=this.changelog=SC.Set.create()}e.add(f);this.changelog=e;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}return this},recordsDidChange:function(d,a,f){var g,e,h,b,c,j;if(f===undefined){g=a.length;e=SC.typeOf(d)===SC.T_ARRAY;if(!e){c=d}for(h=0;h<g;h++){if(e){c=d[h]||SC.Record}b=a?a[h]:undefined;j=f?f[h]:undefined;this.recordDidChange(c,b,j)}}else{g=f.length;for(h=0;h<g;h++){j=f?f[h]:undefined;this.recordDidChange(undefined,undefined,j)}}return this},retrieveRecords:function(f,n,b,c,s){var m=this._getDataSource(),h=SC.typeOf(f)===SC.T_ARRAY,l=SC.typeOf(s)===SC.T_ARRAY,p=(!b)?n.length:b.length,t=[],q=SC.Store.generateStoreKey(),g=SC.Record,a,k,e,o,j,d;if(!h){a=f}for(k=0;k<p;k++){if(b){e=b[k]}else{if(h){a=f[k]}e=a.storeKeyFor(n[k])}d=l?s[k]:s;o=this.readStatus(e);if((o==g.EMPTY)||(o==g.ERROR)||(o==g.DESTROYED_CLEAN)){this.writeStatus(e,g.BUSY_LOADING);this.dataHashDidChange(e,q,YES);t.push(e);this._setCallbackForStoreKey(e,d,l,b)}else{if(c){if(o&g.READY){this.writeStatus(e,g.BUSY_REFRESH|(o&3));this.dataHashDidChange(e,q,YES);t.push(e);this._setCallbackForStoreKey(e,d,l,b)}else{if((o==g.BUSY_DESTROYING)||(o==g.BUSY_CREATING)||(o==g.BUSY_COMMITTING)){throw g.BUSY_ERROR}else{if(o==g.DESTROYED_DIRTY){throw g.BAD_STATE_ERROR}}}}}}j=NO;if(m){j=m.retrieveRecords.call(m,this,t,n)}if(!j){p=t.length;q=SC.Store.generateStoreKey();for(k=0;k<p;k++){e=t[k];o=this.readStatus(e);if(o===g.BUSY_LOADING){this.writeStatus(e,g.ERROR);this.dataHashDidChange(e,q,YES)}else{if(o&g.BUSY_REFRESH){this.writeStatus(e,g.READY|(o&3));this.dataHashDidChange(e,q,YES)}}}t.length=0}return t},_TMP_RETRIEVE_ARRAY:[],_callback_queue:{},_setCallbackForStoreKey:function(d,e,b,c){var a=this._callback_queue;if(b){a[d]={callback:e,otherKeys:c}}else{a[d]=e}},_retreiveCallbackForStoreKey:function(c){var a=this._callback_queue,e=a[c],d,b;if(e){if(SC.typeOf(e)===SC.T_FUNCTION){e.call();delete a[c]}else{if(SC.typeOf(e)==SC.T_HASH){e.completed=YES;b=e.storeKeys;b.forEach(function(f){if(!a[f].completed){d=YES}});if(d){e.callback.call();b.forEach(function(f){delete a[f]})}}}}},_cancelCallback:function(b){var a=this._callback_queue;if(a[b]){delete a[b]}},retrieveRecord:function(g,f,b,c,e){var d=this._TMP_RETRIEVE_ARRAY,a;if(b){d[0]=b;b=d;f=null}else{d[0]=f;f=d}a=this.retrieveRecords(g,f,b,c,e);d.length=0;return a[0]},refreshRecord:function(d,c,a,b){return !!this.retrieveRecord(d,c,a,YES,b)},refreshRecords:function(b,c,d,e){var a=this.retrieveRecords(b,c,d,YES,e);return a&&a.length>0},commitRecords:function(f,o,b,s,v){var n=this._getDataSource(),h=SC.typeOf(f)===SC.T_ARRAY,l=SC.typeOf(v)===SC.T_ARRAY,c=[],k=[],m=[],t=SC.Store.generateStoreKey(),g=SC.Record,a,j,e,p,w,u,q,d;if(!f&&!o&&!b){b=this.changelog}q=b?b.get("length"):(o?o.get("length"):0);for(j=0;j<q;j++){if(b){e=b[j]}else{if(h){a=f[j]||SC.Record}else{a=f}e=a.storeKeyFor(o[j])}d=l?v[j]:v;p=this.readStatus(e);if(p==g.ERROR){throw g.NOT_FOUND_ERROR}else{if(p==g.READY_NEW){this.writeStatus(e,g.BUSY_CREATING);this.dataHashDidChange(e,t,YES);c.push(e);this._setCallbackForStoreKey(e,d,l,b)}else{if(p==g.READY_DIRTY){this.writeStatus(e,g.BUSY_COMMITTING);this.dataHashDidChange(e,t,YES);k.push(e);this._setCallbackForStoreKey(e,d,l,b)}else{if(p==g.DESTROYED_DIRTY){this.writeStatus(e,g.BUSY_DESTROYING);this.dataHashDidChange(e,t,YES);m.push(e);this._setCallbackForStoreKey(e,d,l,b)}else{if(p==g.DESTROYED_CLEAN){this.dataHashDidChange(e,t,YES)}}}}}}if(n&&(q>0||s)){u=n.commitRecords.call(n,this,c,k,m,s)}if(u&&!f&&!o){if(b===this.changelog){this.changelog=null}else{this.changelog.removeEach(b)}}return u},commitRecord:function(g,f,b,c,e){var d=this._TMP_RETRIEVE_ARRAY,a;if(f===undefined&&b===undefined){return NO}if(b!==undefined){d[0]=b;b=d;f=null}else{d[0]=f;f=d}a=this.commitRecords(g,f,b,c,e);d.length=0;return a},cancelRecords:function(e,b,j){var a=this._getDataSource(),g=SC.typeOf(e)===SC.T_ARRAY,l=SC.Record,k=[],f,h,m,c,d,n;h=(j===undefined)?b.length:j.length;for(m=0;m<h;m++){if(g){d=e[m]||SC.Record}else{d=e||SC.Record}c=b?b[m]:undefined;if(j===undefined){n=d.storeKeyFor(c)}else{n=j?j[m]:undefined}if(n){f=this.readStatus(n);if((f==l.EMPTY)||(f==l.ERROR)){throw l.NOT_FOUND_ERROR}k.push(n);this._cancelCallback(n)}}if(a){a.cancel.call(a,this,k)}return this},cancelRecord:function(e,d,b){var c=this._TMP_RETRIEVE_ARRAY,a;if(b!==undefined){c[0]=b;b=c;d=null}else{c[0]=d;d=c}a=this.cancelRecords(e,d,b);c.length=0;return this},loadRecord:function(g,d,f){var a=SC.Record,c,b,e;g=g||SC.Record;b=g.prototype.primaryKey;f=f||d[b];c=e=g.storeKeyFor(f);if(this.readStatus(e)&a.BUSY){this.dataSourceDidComplete(e,d,f)}else{this.pushRetrieve(g,f,d,e)}return c},loadRecords:function(d,n,a){var f=SC.typeOf(d)===SC.T_ARRAY,g=n.get("length"),h=[],j=SC.Record,c,b,l,k,e,m;if(!f){c=d||SC.Record;l=c.prototype.primaryKey}for(k=0;k<g;k++){e=n.objectAt(k);if(f){c=d.objectAt(k)||SC.Record;l=c.prototype.primaryKey}b=(a)?a.objectAt(k):e[l];h[k]=this.loadRecord(c,e,b)}return h},readError:function(a){var b=this.recordErrors;return b?b[a]:undefined},readQueryError:function(a){var b=this.queryErrors;return b?b[SC.guidFor(a)]:undefined},dataSourceDidCancel:function(c){var b=this.readStatus(c),a=SC.Record;if(!(b&a.BUSY)){throw a.BAD_STATE_ERROR}switch(b){case a.BUSY_LOADING:b=a.EMPTY;break;case a.BUSY_CREATING:b=a.READY_NEW;break;case a.BUSY_COMMITTING:b=a.READY_DIRTY;break;case a.BUSY_REFRESH_CLEAN:b=a.READY_CLEAN;break;case a.BUSY_REFRESH_DIRTY:b=a.READY_DIRTY;break;case a.BUSY_DESTROYING:b=a.DESTROYED_DIRTY;break;default:throw a.BAD_STATE_ERROR}this.writeStatus(c,b);this.dataHashDidChange(c,null,YES);this._cancelCallback(c);return this},dataSourceDidComplete:function(g,f,e){var c=this.readStatus(g),b=SC.Record,d;if(!(c&b.BUSY)){throw b.BAD_STATE_ERROR}if(c===b.BUSY_DESTROYING){throw b.BAD_STATE_ERROR}else{c=b.READY_CLEAN}this.writeStatus(g,c);if(f){this.writeDataHash(g,f,c)}if(e){SC.Store.replaceIdFor(g,e)}d=f||e?NO:YES;this.dataHashDidChange(g,null,d);var a=this.materializeRecord(g);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(g);return this},dataSourceDidDestroy:function(d){var c=this.readStatus(d),b=SC.Record;if(!(c&b.BUSY)){throw b.BAD_STATE_ERROR}else{c=b.DESTROYED_CLEAN}this.removeDataHash(d,c);this.dataHashDidChange(d);var a=this.materializeRecord(d);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(d);return this},dataSourceDidError:function(e,d){var c=this.readStatus(e),f=this.recordErrors,b=SC.Record;if(!(c&b.BUSY)){throw b.BAD_STATE_ERROR}else{c=b.ERROR}if(d&&d.isError){if(!f){f=this.recordErrors=[]}f[e]=d}this.writeStatus(e,c);this.dataHashDidChange(e,null,YES);var a=this.materializeRecord(e);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(e);return this},pushRetrieve:function(f,e,c,d){var b=SC.Record,a;if(d===undefined){d=f.storeKeyFor(e)}a=this.readStatus(d);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.READY_CLEAN;if(c===undefined){this.writeStatus(d,a)}else{this.writeDataHash(d,c,a)}if(e&&this.idFor(d)!==e){SC.Store.replaceIdFor(d,e)}this.dataHashDidChange(d);return d}return NO},pushDestroy:function(e,d,c){var b=SC.Record,a;if(c===undefined){c=e.storeKeyFor(d)}a=this.readStatus(c);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.DESTROYED_CLEAN;this.removeDataHash(c,a);this.dataHashDidChange(c);return c}return NO},pushError:function(g,f,c,d){var b=SC.Record,a,e=this.recordErrors;if(d===undefined){d=g.storeKeyFor(f)}a=this.readStatus(d);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.ERROR;if(c&&c.isError){if(!e){e=this.recordErrors=[]}e[d]=c}this.writeStatus(d,a);this.dataHashDidChange(d,null,YES);return d}return NO},loadQueryResults:function(c,a){if(c.get("location")===SC.Query.LOCAL){throw new Error("Cannot load query results for a local query")}var b=this._findQuery(c,YES,NO);if(b){b.set("storeKeys",a)}this.dataSourceDidFetchQuery(c);return this},dataSourceDidFetchQuery:function(a){return this._scstore_dataSourceDidFetchQuery(a,YES)},_scstore_dataSourceDidFetchQuery:function(d,a){var c=this._findQuery(d,a,NO),b=this.get("nestedStores"),e=b?b.get("length"):0;if(c){c.storeDidFetchQuery(d)}while(--e>=0){b[e]._scstore_dataSourceDidFetchQuery(d,NO)}return this},dataSourceDidCancelQuery:function(a){return this._scstore_dataSourceDidCancelQuery(a,YES)},_scstore_dataSourceDidCancelQuery:function(d,a){var c=this._findQuery(d,a,NO),b=this.get("nestedStores"),e=b?b.get("length"):0;if(c){c.storeDidCancelQuery(d)}while(--e>=0){b[e]._scstore_dataSourceDidCancelQuery(d,NO)}return this},dataSourceDidErrorQuery:function(b,a){var c=this.queryErrors;if(a&&a.isError){if(!c){c=this.queryErrors={}}c[SC.guidFor(b)]=a}return this._scstore_dataSourceDidErrorQuery(b,YES)},_scstore_dataSourceDidErrorQuery:function(d,a){var c=this._findQuery(d,a,NO),b=this.get("nestedStores"),e=b?b.get("length"):0;if(c){c.storeDidErrorQuery(d)}while(--e>=0){b[e]._scstore_dataSourceDidErrorQuery(d,NO)}return this},init:function(){arguments.callee.base.apply(this,arguments);this.reset()},toString:function(){var b=this.get("name");if(!b){return arguments.callee.base.apply(this,arguments)}else{var a=arguments.callee.base.apply(this,arguments);return"%@ (%@)".fmt(b,a)}},idFor:function(a){return SC.Store.idFor(a)},recordTypeFor:function(a){return SC.Store.recordTypeFor(a)},storeKeyFor:function(b,a){return b.storeKeyFor(a)},storeKeyExists:function(b,a){return b.storeKeyExists(a)},storeKeysFor:function(f){var a=[],e=f&&f.isEnumerable,c,d,b;if(!this.statuses){return a}for(d in SC.Store.recordTypesByStoreKey){c=SC.Store.recordTypesByStoreKey[d];if(e){b=f.contains(c)}else{b=c===f}if(b&&this.statuses[d]){a.push(parseInt(d,10))}}return a},storeKeys:function(){var a=[],b;if(!this.statuses){return a}for(b in this.statuses){if(this.statuses[b]!=SC.Record.EMPTY){a.push(parseInt(b,10))}}return a},statusString:function(a){var b=this.materializeRecord(a);return b.statusString()}});SC.Store.mixin({CHAIN_CONFLICT_ERROR:new Error("Nested Store Conflict"),NO_PARENT_STORE_ERROR:new Error("Parent Store Required"),NESTED_STORE_UNSUPPORTED_ERROR:new Error("Unsupported In Nested Store"),NESTED_STORE_RETRIEVE_DIRTY_ERROR:new Error("Cannot Retrieve Dirty Record in Nested Store"),EDITABLE:"editable",LOCKED:"locked",INHERITED:"inherited",idsByStoreKey:[],recordTypesByStoreKey:{},queriesByStoreKey:[],nextStoreKey:1,generateStoreKey:function(){return this.nextStoreKey++},idFor:function(a){return this.idsByStoreKey[a]},queryFor:function(a){return this.queriesByStoreKey[a]},recordTypeFor:function(a){return this.recordTypesByStoreKey[a]},replaceIdFor:function(c,a){var d=this.idsByStoreKey[c],e,b;if(d!==a){e=this.recordTypeFor(c);if(!e){throw new Error("replaceIdFor: storeKey %@ does not exist".fmt(c))}this.idsByStoreKey[c]=a;b=e.storeKeysById();delete b[d];b[a]=c}return this},replaceRecordTypeFor:function(a,b){this.recordTypesByStoreKey[a]=b;return this}});SC.Store.prototype.nextStoreIndex=1;SC.Store._getDefaultStore=function(){var a=this._store;if(!a){this._store=a=SC.Store.create()}return a};SC.Store.updateRecords=function(f,g,h,c){SC.Logger.warn("SC.Store.updateRecords() is deprecated.  Use loadRecords() instead");var d=this._getDefaultStore(),b=f.length,a,e;if(!h){h=[];for(a=0;a<b;a++){h[a]=f[a].recordType}}e=d.loadRecords(h,f);b=e.length;for(a=0;a<b;a++){e[a]=d.materializeRecord(e[a])}return e};SC.Store.find=function(a,b){return this._getDefaultStore().find(b,a)};SC.Store.findAll=function(a,b){return this._getDefaultStore().findAll(a,b)};sc_require("system/store");SC.NestedStore=SC.Store.extend({hasChanges:NO,parentStore:null,isNested:YES,lockOnRead:YES,locks:null,chainedChanges:null,find:function(a){if(a&&a.isQuery&&a.get("location")!==SC.Query.LOCAL){throw"SC.Store#find() can only accept LOCAL queries in nested stores"}return arguments.callee.base.apply(this,arguments)},commitChanges:function(b){if(this.get("hasChanges")){var a=this.get("parentStore");a.commitChangesFromNestedStore(this,this.chainedChanges,b)}this.reset();return this},discardChanges:function(){var c,f;if((c=this.records)&&(f=this.locks)){var b=this.get("parentStore"),h=b.revisions;var g=this.revisions,e,d,a;for(e in c){if(!c.hasOwnProperty(e)){continue}if(!(d=f[e])){continue}a=h[e];if((a!==d)||(g[e]>a)){this._notifyRecordPropertyChange(parseInt(e,10))}}}this.reset();this.flush();return this},destroy:function(){this.discardChanges();var a=this.get("parentStore");if(a){a.willDestroyNestedStore(this)}arguments.callee.base.apply(this,arguments);return this},reset:function(){var c,d,a;var b=this.get("parentStore");if(!b){throw SC.Store.NO_PARENT_STORE_ERROR}this.dataHashes=SC.beget(b.dataHashes);this.revisions=SC.beget(b.revisions);this.statuses=SC.beget(b.statuses);this.childRecords=b.childRecords?SC.beget(b.childRecords):{};this.parentRecords=b.parentRecords?SC.beget(b.parentRecords):{};this.chainedChanges=this.locks=this.editables=null;this.changelog=null;this.set("hasChanges",NO)},refreshQuery:function(b){var a=this.get("parentStore");if(a){a.refreshQuery(b)}return this},readError:function(b){var a=this.get("parentStore");return a?a.readError(b):null},readQueryError:function(b){var a=this.get("parentStore");return a?a.readQueryError(b):null},storeKeyEditState:function(b){var c=this.editables,a=this.locks;return(c&&c[b])?SC.Store.EDITABLE:(a&&a[b])?SC.Store.LOCKED:SC.Store.INHERITED},_lock:function(k){var l=this.locks,f,h,d,a,m,g,e,j;if(l&&l[k]){return this}if(!l){l=this.locks=[]}h=this.editables;if(h){h[k]=0}var b=this.get("parentStore"),c;while(b&&(c=b.storeKeyEditState(k))===SC.Store.INHERITED){b=b.get("parentStore")}if(b&&c===SC.Store.EDITABLE){d=this.childRecords[k];if(d){this._lock(d);a=this.parentRecords[d];if(a){m=a[k];g=m?SC.tupleForPropertyPath(m,this.dataHashes[d]):null;if(g){e=g[0];j=g[1]}this.dataHashes[k]=e&&j?e[j]:null}}else{this.dataHashes[k]=SC.clone(b.dataHashes[k],YES)}if(!h){h=this.editables=[]}h[k]=1}else{this.dataHashes[k]=b.dataHashes[k]}this.statuses[k]=this.statuses[k];f=this.revisions[k]=this.revisions[k];l[k]=f||1;return this},readDataHash:function(a){if(this.get("lockOnRead")){this._lock(a)}return this.dataHashes[a]},readEditableDataHash:function(a){this._lock(a);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(d,f,b){var c=this.locks,g=NO,a;if(f){this.dataHashes[d]=f}else{this._lock(d);g=YES}if(b){this.statuses[d]=b}else{if(!g){this.statuses[d]=(this.statuses[d]||SC.Record.READY_NEW)}}if(!g){a=this.revisions[d]=this.revisions[d];if(!c){c=this.locks=[]}if(!c[d]){c[d]=a||1}}var e=this.editables;if(!e){e=this.editables=[]}e[d]=1;return this},removeDataHash:function(c,a){var b=this.locks;if(!b){b=this.locks=[]}if(!b[c]){b[c]=this.revisions[c]||1}return arguments.callee.base.apply(this,arguments)},dataHashDidChange:function(d,b,a,h){if(!b){b=SC.Store.generateStoreKey()}var c,e,g,j;c=SC.typeOf(d)===SC.T_ARRAY;if(c){e=d.length}else{e=1;j=d}var f=this.chainedChanges;if(!f){f=this.chainedChanges=SC.Set.create()}for(g=0;g<e;g++){if(c){j=d[g]}this._lock(j);this.revisions[j]=b;f.add(j);this._notifyRecordPropertyChange(j,a,h)}this.setIfChanged("hasChanges",YES);return this},commitChangesFromNestedStore:function(e,f,a){arguments.callee.base.apply(this,arguments);var b=this.get("parentStore"),h=b.revisions,c;var k=this.locks,g=this.chainedChanges,d,j;if(!k){k=this.locks=[]}if(!g){g=this.chainedChanges=SC.Set.create()}d=f.length;for(c=0;c<d;c++){j=f[c];if(!k[j]){k[j]=h[j]||1}g.add(j)}this.setIfChanged("hasChanges",g.get("length")>0);this.flush();return this},queryFor:function(c,a,b){return this.get("parentStore").queryFor(c,a,b)},findAll:function(e,b,d,c,a){if(!a){a=this}return this.get("parentStore").findAll(e,b,d,c,a)},retrieveRecords:function(f,n,b,c){var a=this.get("parentStore"),l,d,q,p=(!b)?n.length:b.length,j=SC.Record,o;if(c){for(l=0;l<p;l++){d=!b?a.storeKeyFor(f,n[l]):b[l];o=this.peekStatus(d);if(o&j.DIRTY){throw SC.Store.NESTED_STORE_RETRIEVE_DIRTY_ERROR}else{var g=this.dataHashes,k=this.revisions,h=this.statuses,m=this.editables,t=this.locks;var e=NO;var s=NO;if(g&&g.hasOwnProperty(d)){delete g[d];e=YES}if(k&&k.hasOwnProperty(d)){delete k[d];e=YES}if(m){delete m[d]}if(t){delete t[d]}if(h&&h.hasOwnProperty(d)){delete h[d];if(!e){s=YES}e=YES}if(e){this._notifyRecordPropertyChange(d,s)}}}}return a.retrieveRecords(f,n,b,c)},commitRecords:function(a,b,c){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},commitRecord:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},cancelRecords:function(a,b,c){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},cancelRecord:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidCancel:function(a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidComplete:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidDestroy:function(a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidError:function(b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushRetrieve:function(d,c,a,b){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushDestroy:function(c,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushError:function(d,c,a,b){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR}});sc_require("models/record");SC.RecordArray=SC.Object.extend(SC.Enumerable,SC.Array,{store:null,query:null,storeKeys:null,status:SC.Record.EMPTY,isEditable:function(){var a=this.get("query");return a?a.get("isEditable"):YES}.property("query").cacheable(),length:function(){this.flush();var a=this.get("storeKeys");return a?a.get("length"):0}.property("storeKeys").cacheable(),_scra_records:null,objectAt:function(a){this.flush();var f=this._scra_records,e=this.get("storeKeys"),b=this.get("store"),d,c;if(!e||!b){return undefined}if(f&&(c=f[a])){return c}if(!f){this._scra_records=f=[]}d=e.objectAt(a);if(d){if(b.peekStatus(d)===SC.Record.EMPTY){b.retrieveRecord(null,null,d)}f[a]=c=b.materializeRecord(d)}return c},forEach:function(h,d){this.flush();var e=this._scra_records,b=this.get("storeKeys"),f=this.get("store"),c=b?b.get("length"):0,g,j,a;if(!b||!f){return this}if(!e){e=this._scra_records=[]}if(!d){d=this}for(g=0;g<c;g++){a=e[g];if(!a){a=e[g]=f.materializeRecord(b.objectAt(g))}h.call(d,a,g,this)}return this},replace:function(b,g,f){this.flush();var e=this.get("storeKeys"),a=f?(f.get?f.get("length"):f.length):0,c,d;if(!e){throw"Unable to edit an SC.RecordArray that does not have its storeKeys property set."}if(!this.get("isEditable")){throw SC.RecordArray.NOT_EDITABLE}d=[];for(c=0;c<a;c++){d[c]=f.objectAt(c).get("storeKey")}e.replace(b,g,d);return this},contains:function(a){return this.indexOf(a)>=0},indexOf:function(b,a){if(!SC.kindOf(b,SC.Record)){SC.Logger.warn("Using indexOf on %@ with an object that is not an SC.Record".fmt(b));return -1}this.flush();var d=b.get("storeKey"),c=this.get("storeKeys");return c?c.indexOf(d,a):-1},lastIndexOf:function(b,a){if(!SC.kindOf(b,SC.Record)){SC.Logger.warn("Using lastIndexOf on %@ with an object that is not an SC.Record".fmt(b));return -1}this.flush();var d=b.get("storeKey"),c=this.get("storeKeys");return c?c.lastIndexOf(d,a):-1},add:function(a){if(!SC.kindOf(a,SC.Record)){return this}if(this.indexOf(a)<0){this.pushObject(a)}return this},remove:function(a){if(!SC.kindOf(a,SC.Record)){return this}this.removeObject(a);return this},find:function(a,b,c){if(b&&b.isQuery){return this.get("store").find(b.queryWithScope(this))}else{return a.apply(this,SC.$A(arguments).slice(1))}}.enhance(),refresh:function(){this.get("store").refreshQuery(this.get("query"));return this},reload:function(){this.flush(YES);return this},destroy:function(){if(!this.get("isDestroyed")){this.get("store").recordArrayWillDestroy(this)}arguments.callee.base.apply(this,arguments)},storeWillFetchQuery:function(c){var b=this.get("status"),a=SC.Record;if((b===a.EMPTY)||(b===a.ERROR)){b=a.BUSY_LOADING}if(b&a.READY){b=a.BUSY_REFRESH}this.setIfChanged("status",b);return this},storeDidFetchQuery:function(a){this.setIfChanged("status",SC.Record.READY_CLEAN);return this},storeDidCancelQuery:function(c){var b=this.get("status"),a=SC.Record;if(b===a.BUSY_LOADING){b=a.EMPTY}else{if(b===a.BUSY_REFRESH){b=a.READY_CLEAN}}this.setIfChanged("status",b);return this},storeDidErrorQuery:function(a){this.setIfChanged("status",SC.Record.ERROR);return this},storeDidChangeStoreKeys:function(b,a){var c=this.get("query");if(c.get("location")!==SC.Query.LOCAL){return this}if(!c.containsRecordTypes(a)){return this}var d=this._scq_changedStoreKeys;if(!d){d=this._scq_changedStoreKeys=SC.IndexSet.create()}d.addEach(b);this.set("needsFlush",YES);if(this.get("storeKeys")){this.flush()}return this},flush:function(a){if(this._insideFlush){this.set("needsFlush",YES);return this}if(!this.get("needsFlush")&&!a){return this}this.set("needsFlush",NO);var k=this.get("query"),n=this.get("store");if(!n||!k||k.get("location")!==SC.Query.LOCAL){return this}this._insideFlush=YES;var h=this.get("storeKeys"),f=this._scq_changedStoreKeys,g=NO,l=SC.Record,q=[],b=new Date(),d,e,c,s,p,j;var m=h;if(h&&!a){if(f){f.forEach(function(t){if(q.length>0||new Date()-b>SC.RecordArray.QUERY_MATCHING_THRESHOLD){q.push(t);return}e=n.peekStatus(t);if(!(e&l.EMPTY)&&!((e&l.DESTROYED)||(e===l.BUSY_DESTROYING))){d=n.materializeRecord(t);j=!!(d&&k.contains(d))}else{j=NO}if(j){if(h.indexOf(t)<0){if(!g){h=h.copy()}h.pushObject(t)}}else{if(h.indexOf(t)>=0){if(!g){h=h.copy()}h.removeObject(t)}}},this);g=YES}}else{if(p=k.get("scope")){s=p.flush().get("storeKeys")}else{if(c=k.get("expandedRecordTypes")){s=SC.IndexSet.create();c.forEach(function(t){s.addEach(n.storeKeysFor(t))})}}h=[];s.forEach(function(t){if(q.length>0||new Date()-b>SC.RecordArray.QUERY_MATCHING_THRESHOLD){q.push(t);return}e=n.peekStatus(t);if(!(e&l.EMPTY)&&!((e&l.DESTROYED)||(e===l.BUSY_DESTROYING))){d=n.materializeRecord(t);if(d&&k.contains(d)){h.push(t)}}});g=YES}if(q.length>0){var o=this;window.setTimeout(function(){SC.run(function(){if(!o||o.get("isDestroyed")){return}o.set("needsFlush",YES);o._scq_changedStoreKeys=SC.IndexSet.create().addEach(q);o.flush()})},1)}if(f){f.clear()}if(g){if(h&&(h===m)){h=h.copy()}h=SC.Query.orderStoreKeys(h,k,n);if(SC.compare(m,h)!==0){this.set("storeKeys",SC.clone(h))}}this._insideFlush=NO;return this},needsFlush:YES,isError:function(){return !!(this.get("status")&SC.Record.ERROR)}.property("status").cacheable(),errorValue:function(){return this.get("isError")?SC.val(this.get("errorObject")):null}.property("isError").cacheable(),errorObject:function(){if(this.get("isError")){var a=this.get("store");return a.readQueryError(this.get("query"))||SC.Record.GENERIC_ERROR}else{return null}}.property("isError").cacheable(),propertyWillChange:function(b){if(b==="storeKeys"){var c=this.get("storeKeys");var a=c?c.get("length"):0;this.arrayContentWillChange(0,a,0)}return arguments.callee.base.apply(this,arguments)},_storeKeysDidChange:function(){var e=this.get("storeKeys");var d=this._prevStoreKeys,b,c,g=this._storeKeysContentDidChange,a=this._storeKeysStateDidChange;if(e===d){return}if(d){d.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:this._storeKeysContentDidChange});b=d.get("length")}else{b=0}this._prevStoreKeys=e;if(e){e.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:this._storeKeysContentDidChange});c=e.get("length")}else{c=0}this._storeKeysContentDidChange(0,b,c)}.observes("storeKeys"),addArrayObservers:function(){this.flush();return SC.Array.addArrayObservers.apply(this,arguments)},_storeKeysContentDidChange:function(c,a,b){if(this._scra_records){this._scra_records.length=0}this.arrayContentDidChange(c,a,b)},init:function(){arguments.callee.base.apply(this,arguments);this._storeKeysDidChange()}});SC.RecordArray.mixin({NOT_EDITABLE:SC.Error.desc("SC.RecordArray is not editable"),QUERY_MATCHING_THRESHOLD:100});Function.prototype.handleEvents=function(){this.isEventHandler=YES;this.events=arguments;return this};Function.prototype.stateObserves=function(){this.isStateObserveHandler=YES;this.args=SC.A(arguments);return this};SC.StatechartDelegate={isStatechartDelegate:YES,statechartUpdateLocationForState:function(b,a,c){SC.routes.set("location",a)},statechartAcquireLocationForState:function(a,b){return SC.routes.get("location")},statechartBindStateToRoute:function(b,d,a,c){SC.routes.add(a,d,c)},statechartShouldStateHandleTriggeredRoute:function(a,c,b){return YES},statechartStateCancelledHandlingTriggeredRoute:function(a,c,b){}};SC.StatePathMatcher=SC.Object.extend({state:null,expression:null,tokens:null,init:function(){arguments.callee.base.apply(this,arguments);this._parseExpression()},_parseExpression:function(){var h=this.expression?this.expression.split("."):[],b=h.length,f=0,c,e=null,d,g=[];for(;f<b;f+=1){c=h[f];if(c.indexOf("~")>=0){c=c.split("~");if(c.length>2){throw"Invalid use of '~' at part %@".fmt(f)}d=SC.StatePathMatcher._ExpandToken.create({start:c[0],end:c[1]})}else{if(c==="this"){if(g.length>0){throw"Invalid use of 'this' at part %@".fmt(f)}d=SC.StatePathMatcher._ThisToken.create()}else{d=SC.StatePathMatcher._BasicToken.create({value:c})}}d.owner=this;g.push(d)}this.set("tokens",g);var a=SC.clone(g);this._chain=e=a.pop();while(d=a.pop()){e.nextToken=d;e=d}},lastPart:function(){var c=this.get("tokens"),a=c?c.length:0,b=a>0?c[a-1]:null;return b.get("lastPart")}.property("tokens").cacheable(),match:function(a){this._stack=a.split(".");if(SC.empty(a)||SC.typeOf(a)!==SC.T_STRING){return NO}return this._chain.match()},_pop:function(){this._lastPopped=this._stack.pop();return this._lastPopped}});SC.StatePathMatcher._Token=SC.Object.extend({type:null,owner:null,nextToken:null,lastPart:null,match:function(){return NO}});SC.StatePathMatcher._BasicToken=SC.StatePathMatcher._Token.extend({type:"basic",value:null,lastPart:function(){return this.value}.property("value").cacheable(),match:function(){var a=this.owner._pop(),b=this.nextToken;if(this.value!==a){return NO}return b?b.match():YES}});SC.StatePathMatcher._ExpandToken=SC.StatePathMatcher._Token.extend({type:"expand",start:null,end:null,lastPart:function(){return this.end}.property("end").cacheable(),match:function(){var d=this.start,a=this.end,b,c=this.nextToken;b=this.owner._pop();if(b!==a){return NO}while(b=this.owner._pop()){if(b===d){return c?c.match():YES}}return NO}});SC.StatePathMatcher._ThisToken=SC.StatePathMatcher._Token.extend({type:"this",lastPart:"this",match:function(){var e=this.owner.state,c=e.get("substates"),a=c.length,d=0,b;b=this.owner._lastPopped;if(!b||this.owner._stack.length!==0){return NO}for(;d<a;d+=1){if(c[d].get("name")===b){return YES}}return NO}});SC.Async=SC.Object.extend({func:null,arg1:null,arg2:null,tryToPerform:function(d){var c=this.get("func"),b=this.get("arg1"),a=this.get("arg2"),e=SC.typeOf(c);if(e===SC.T_STRING){d.tryToPerform(c,b,a)}else{if(e===SC.T_FUNCTION){c.apply(d,[b,a])}}}});SC.Async.mixin({perform:function(c,b,a){return SC.Async.create({func:c,arg1:b,arg2:a})}});SC.State=SC.Object.extend({name:null,parentState:null,historyState:null,initialSubstate:null,substatesAreConcurrent:NO,substates:null,statechart:null,stateIsInitialized:NO,currentSubstates:null,enteredSubstates:null,representRoute:null,trace:function(){var a=this.getPath("statechart.statechartTraceKey");return this.getPath("statechart.%@".fmt(a))}.property().cacheable(),owner:function(){var c=this.get("statechart"),b=c?c.get("statechartOwnerKey"):null,a=c?c.get(b):null;return a?a:c}.property().cacheable(),statechartDelegate:function(){return this.getPath("statechart.statechartDelegate")}.property().cacheable(),location:function(b,c){var d=this.get("statechart"),a=this.get("statechartDelegate");if(c!==undefined){a.statechartUpdateLocationForState(d,c,this)}return a.statechartAcquireLocationForState(d,this)}.property().idempotent(),init:function(){arguments.callee.base.apply(this,arguments);this._registeredEventHandlers={};this._registeredStringEventHandlers={};this._registeredRegExpEventHandlers=[];this._registeredStateObserveHandlers={};this._registeredSubstatePaths={};this._registeredSubstates=[];this._isEnteringState=NO;this._isExitingState=NO;var b=this.get("statechart"),c=b?b.get("statechartOwnerKey"):null,a=b?b.get("statechartTraceKey"):null;if(b){b.addObserver(c,this,"_statechartOwnerDidChange");b.addObserver(a,this,"_statechartTraceDidChange")}},destroy:function(){var c=this.get("statechart"),d=c?c.get("statechartOwnerKey"):null,a=c?c.get("statechartTraceKey"):null;if(c){c.removeObserver(d,this,"_statechartOwnerDidChange");c.removeObserver(a,this,"_statechartTraceDidChange")}var b=this.get("substates");if(b){b.forEach(function(e){e.destroy()})}this._teardownAllStateObserveHandlers();this.set("substates",null);this.set("currentSubstates",null);this.set("enteredSubstates",null);this.set("parentState",null);this.set("historyState",null);this.set("initialSubstate",null);this.set("statechart",null);this.notifyPropertyChange("trace");this.notifyPropertyChange("owner");this._registeredEventHandlers=null;this._registeredStringEventHandlers=null;this._registeredRegExpEventHandlers=null;this._registeredStateObserveHandlers=null;this._registeredSubstatePaths=null;this._registeredSubstates=null;arguments.callee.base.apply(this,arguments)},initState:function(){if(this.get("stateIsInitialized")){return}this._registerWithParentStates();this._setupRouteHandling();var l=null,k=null,b=null,m=[],j=NO,h=this.get("initialSubstate"),f=this.get("substatesAreConcurrent"),d=this.get("statechart"),c=0,g=0,e=NO,a=null;this.set("substates",m);if(SC.kindOf(h,SC.HistoryState)&&h.isClass){a=this.createSubstate(h);this.set("initialSubstate",a);if(SC.none(a.get("defaultState"))){this.stateLogError("Initial substate is invalid. History state requires the name of a default state to be set");this.set("initialSubstate",null);a=null}}for(l in this){k=this[l];e=SC.typeOf(k)===SC.T_FUNCTION;if(e&&k.isEventHandler){this._registerEventHandler(l,k);continue}if(e&&k.isStateObserveHandler){this._registerStateObserveHandler(l,k);continue}if(e&&k.statePlugin){k=k.apply(this)}if(SC.kindOf(k,SC.State)&&k.isClass&&this[l]!==this.constructor){b=this._addSubstate(l,k);if(l===h){this.set("initialSubstate",b);j=YES}else{if(a&&a.get("defaultState")===l){a.set("defaultState",b);j=YES}}}}if(!SC.none(h)&&!j){this.stateLogError("Unable to set initial substate %@ since it did not match any of state's %@ substates".fmt(h,this))}if(m.length===0){if(!SC.none(h)){this.stateLogWarning("Unable to make %@ an initial substate since state %@ has no substates".fmt(h,this))}}else{if(m.length>0){b=this._addEmptyInitialSubstateIfNeeded();if(!b&&h&&f){this.set("initialSubstate",null);this.stateLogWarning("Can not use %@ as initial substate since substates are all concurrent for state %@".fmt(h,this))}}}this.notifyPropertyChange("substates");this.set("currentSubstates",[]);this.set("enteredSubstates",[]);this.set("stateIsInitialized",YES)},_setupRouteHandling:function(){var b=this.get("representRoute"),c=this.get("statechart"),a=this.get("statechartDelegate");if(!b){return}if(this.get("isConcurrentState")){this.stateLogError("State %@ cannot handle route '%@' since state is concurrent".fmt(this,b));return}a.statechartBindStateToRoute(c,this,b,this.routeTriggered)},routeTriggered:function(f){if(this._isEnteringState){return}var e=this.get("statechart"),b=this.get("statechartDelegate"),d=this.get("location");var a={state:this,location:d,params:f,handler:this.routeTriggered};var c=this.createStateRouteHandlerContext(a);if(b.statechartShouldStateHandleTriggeredRoute(e,this,c)){if(this.get("trace")&&d){this.stateLogTrace("will handle route '%@'".fmt(d))}this.handleTriggeredRoute(c)}else{b.statechartStateCancelledHandlingTriggeredRoute(e,this,c)}},createStateRouteHandlerContext:function(a){return SC.StateRouteHandlerContext.create(a)},handleTriggeredRoute:function(a){this.gotoState(this,a)},_addEmptyInitialSubstateIfNeeded:function(){var c=this.get("initialSubstate"),b=this.get("substatesAreConcurrent");if(c||b){return null}var a=this.createSubstate(SC.EmptyState);this.set("initialSubstate",a);this.get("substates").push(a);this[a.get("name")]=a;a.initState();this.stateLogWarning("state %@ has no initial substate defined. Will default to using an empty state as initial substate".fmt(this));return a},_addSubstate:function(c,d,a){var b=this.get("substates");a=SC.clone(a)||{};a.name=c;d=this.createSubstate(d,a);b.push(d);this[c]=d;d.initState();return d},addSubstate:function(c,e,b){if(SC.empty(c)){this.stateLogError("Can not add substate. name required");return null}if(this[c]!==undefined){this.stateLogError("Can not add substate '%@'. Already a defined property".fmt(c));return null}if(!this.get("stateIsInitialized")){this.stateLogError("Can not add substate '%@'. this state is not yet initialized".fmt(c));return null}var a=arguments.length;if(a===1){e=SC.State}else{if(a===2&&SC.typeOf(e)===SC.T_HASH){b=e;e=SC.State}}var d=SC.kindOf(e,SC.State)&&e.isClass;if(!d){this.stateLogError("Can not add substate '%@'. must provide a state class".fmt(c));return null}e=this._addSubstate(c,e,b);this._addEmptyInitialSubstateIfNeeded();this.notifyPropertyChange("substates");return e},createSubstate:function(b,a){a=a||{};return b.create({parentState:this,statechart:this.get("statechart")},a)},_registerEventHandler:function(b,e){var d=e.events,f=null,a=d.length,c=0;this._registeredEventHandlers[b]=e;for(;c<a;c+=1){f=d[c];if(SC.typeOf(f)===SC.T_STRING){this._registeredStringEventHandlers[f]={name:b,handler:e};continue}if(f instanceof RegExp){this._registeredRegExpEventHandlers.push({name:b,handler:e,regexp:f});continue}this.stateLogError("Invalid event %@ for event handler %@ in state %@".fmt(f,b,this))}},_registerStateObserveHandler:function(d,f){var e=0,c=f.args,b=c.length,a,g=YES;for(;e<b;e+=1){a=c[e];if(SC.typeOf(a)!==SC.T_STRING||SC.empty(a)){this.stateLogError("Invalid argument %@ for state observe handler %@ in state %@".fmt(a,d,this));g=NO}}if(!g){return}this._registeredStateObserveHandlers[d]=f.args},_registerWithParentStates:function(){var a=this.get("parentState");while(!SC.none(a)){a._registerSubstate(this);a=a.get("parentState")}},_registerSubstate:function(b){var c=b.pathRelativeTo(this);if(SC.none(c)){return}this._registeredSubstates.push(b);var a=this._registeredSubstatePaths;if(a[b.get("name")]===undefined){a[b.get("name")]={}}var d=a[b.get("name")];d[c]=b},pathRelativeTo:function(b){var c=this.get("name"),a=this.get("parentState");while(!SC.none(a)&&a!==b){c="%@.%@".fmt(a.get("name"),c);a=a.get("parentState")}if(a!==b&&b!==this){this.stateLogError("Can not generate relative path from %@ since it not a parent state of %@".fmt(b,this));return null}return c},getSubstate:function(f,h,e){if(!f){return null}var b=SC.typeOf(f);if(b===SC.T_OBJECT){return this._registeredSubstates.indexOf(f)>-1?f:null}if(b!==SC.T_STRING){this.stateLogError("Can not find matching subtype. value must be an object or string: %@".fmt(f));return null}var d=SC.StatePathMatcher.create({state:this,expression:f}),c=[],g;if(d.get("tokens").length===0){return null}var k=this._registeredSubstatePaths[d.get("lastPart")];if(!k){return this._notifySubstateNotFound(h,e,f)}for(g in k){if(d.match(g)){c.push(k[g])}}if(c.length===1){return c[0]}if(c.length>1){var j=[];for(g in k){j.push(g)}if(h){return this._notifySubstateNotFound(h,e,f,j)}var a="Can not find substate matching '%@' in state %@. Ambiguous with the following: %@";this.stateLogError(a.fmt(f,this.get("fullPath"),j.join(", ")))}return this._notifySubstateNotFound(h,e,f)},_notifySubstateNotFound:function(d,c,b,a){return d?d.call(c||this,this,b,a):null},getState:function(a){if(a===this.get("name")){return this}if(SC.kindOf(a,SC.State)){return a}return this.getSubstate(a,this._handleSubstateNotFound)},_handleSubstateNotFound:function(d,c,a){var b=this.get("parentState");if(b){return b.getState(c)}if(a){var e="Can not find state matching '%@'. Ambiguous with the following: %@";this.stateLogError(e.fmt(c,a.join(", ")))}return null},gotoState:function(c,a){var b=this.getState(c);if(!b){var d="can not go to state %@ from state %@. Invalid value.";this.stateLogError(d.fmt(c,this));return}var e=this.findFirstRelativeCurrentState(b);this.get("statechart").gotoState(b,e,false,a)},gotoHistoryState:function(d,a,b){var c=this.getState(d);if(!c){var e="can not go to history state %@ from state %@. Invalid value.";this.stateLogError(e.fmt(d,this));return}var f=this.findFirstRelativeCurrentState(c);this.get("statechart").gotoHistoryState(c,f,a,b)},resumeGotoState:function(){this.get("statechart").resumeGotoState()},stateIsCurrentSubstate:function(a){if(SC.typeOf(a)===SC.T_STRING){a=this.get("statechart").getState(a)}var b=this.get("currentSubstates");return !!b&&b.indexOf(a)>=0},stateIsEnteredSubstate:function(b){if(SC.typeOf(b)===SC.T_STRING){b=this.get("statechart").getState(b)}var a=this.get("enteredSubstates");return !!a&&a.indexOf(b)>=0},isRootState:function(){return this.getPath("statechart.rootState")===this}.property(),isCurrentState:function(){return this.stateIsCurrentSubstate(this)}.property("currentSubstates").cacheable(),isConcurrentState:function(){return this.getPath("parentState.substatesAreConcurrent")}.property(),isEnteredState:function(){return this.stateIsEnteredSubstate(this)}.property("enteredSubstates").cacheable(),hasSubstates:function(){return this.getPath("substates.length")>0}.property("substates"),hasCurrentSubstates:function(){var a=this.get("currentSubstates");return !!a&&a.get("length")>0}.property("currentSubstates").cacheable(),hasEnteredSubstates:function(){var a=this.get("enteredSubstates");return !!a&&a.get("length")>0}.property("enteredSubstates").cacheable(),findFirstRelativeCurrentState:function(b){if(this.get("isCurrentState")){return this}var a=this.get("currentSubstates")||[],d=a.get("length"),c=this.get("parentState");if(d===0){return c?c.findFirstRelativeCurrentState():null}if(d>1){b=this.getSubstate(b);if(b){return b.findFirstRelativeCurrentState()}}return a[0]},reenter:function(){if(this.get("isEnteredState")){this.gotoState(this)}else{SC.Logger.error("Can not re-enter state %@ since it is not an entered state in the statechart".fmt(this))}},tryToHandleEvent:function(a,e,d){var c=this.get("trace"),h=this.get("statechart"),g;if(this._registeredEventHandlers[a]){this.stateLogWarning("state %@ can not handle event '%@' since it is a registered event handler".fmt(this,a));return NO}if(this._registeredStateObserveHandlers[a]){this.stateLogWarning("state %@ can not handle event '%@' since it is a registered state observe handler".fmt(this,a));return NO}if(SC.typeOf(this[a])===SC.T_FUNCTION){if(c){this.stateLogTrace("will handle event '%@'".fmt(a))}h.stateWillTryToHandleEvent(this,a,a);g=(this[a](e,d)!==NO);h.stateDidTryToHandleEvent(this,a,a,g);return g}var j=this._registeredStringEventHandlers[a];if(j){if(c){this.stateLogTrace("%@ will handle event '%@'".fmt(j.name,a))}h.stateWillTryToHandleEvent(this,a,j.name);g=(j.handler.call(this,a,e,d)!==NO);h.stateDidTryToHandleEvent(this,a,j.name,g);return g}var f=this._registeredRegExpEventHandlers.length,b=0;for(;b<f;b+=1){j=this._registeredRegExpEventHandlers[b];if(a.match(j.regexp)){if(c){this.stateLogTrace("%@ will handle event '%@'".fmt(j.name,a))}h.stateWillTryToHandleEvent(this,a,j.name);g=(j.handler.call(this,a,e,d)!==NO);h.stateDidTryToHandleEvent(this,a,j.name,g);return g}}if(SC.typeOf(this["unknownEvent"])===SC.T_FUNCTION){if(c){this.stateLogTrace("unknownEvent will handle event '%@'".fmt(a))}h.stateWillTryToHandleEvent(this,a,"unknownEvent");g=(this.unknownEvent(a,e,d)!==NO);h.stateDidTryToHandleEvent(this,a,"unknownEvent",g);return g}return NO},enterState:function(a){},stateWillBecomeEntered:function(a){this._isEnteringState=YES},stateDidBecomeEntered:function(a){this._setupAllStateObserveHandlers();this._isEnteringState=NO},exitState:function(a){},stateWillBecomeExited:function(a){this._isExitingState=YES;this._teardownAllStateObserveHandlers()},stateDidBecomeExited:function(a){this._isExitingState=NO},_setupAllStateObserveHandlers:function(){this._configureAllStateObserveHandlers("addObserver")},_teardownAllStateObserveHandlers:function(){this._configureAllStateObserveHandlers("removeObserver")},_configureAllStateObserveHandlers:function(b){var g,h,f,a,j,d,c,e;for(g in this._registeredStateObserveHandlers){h=this._registeredStateObserveHandlers[g];for(c=0;c<h.length;c+=1){j=h[c];d=g;a=j.indexOf(".");if(a<0){this[b](j,this,d)}else{if(j.indexOf("*")===0){this[b](j.slice(1),this,d)}else{e=null;if(a===0){e=this;j=j.slice(1)}else{if(a===4&&j.slice(0,5)==="this."){e=this;j=j.slice(5)}else{if(a<0&&j.length===4&&j==="this"){e=this;j=""}}}SC.Observers[b](j,this,d,e)}}}}},performAsync:function(c,b,a){return SC.Async.perform(c,b,a)},respondsToEvent:function(d){if(this._registeredEventHandlers[d]){return false}if(SC.typeOf(this[d])===SC.T_FUNCTION){return true}if(this._registeredStringEventHandlers[d]){return true}if(this._registeredStateObserveHandlers[d]){return false}var a=this._registeredRegExpEventHandlers.length,b=0,c;for(;b<a;b+=1){c=this._registeredRegExpEventHandlers[b];if(d.match(c.regexp)){return true}}return SC.typeOf(this["unknownEvent"])===SC.T_FUNCTION},fullPath:function(){var a=this.getPath("statechart.rootState");if(!a){return this.get("name")}return this.pathRelativeTo(a)}.property("name","parentState").cacheable(),toString:function(){return this.get("fullPath")},_enteredSubstatesDidChange:function(){this.notifyPropertyChange("enteredSubstates")}.observes("*enteredSubstates.[]"),_currentSubstatesDidChange:function(){this.notifyPropertyChange("currentSubstates")}.observes("*currentSubstates.[]"),_statechartTraceDidChange:function(){this.notifyPropertyChange("trace")},_statechartOwnerDidChange:function(){this.notifyPropertyChange("owner")},stateLogTrace:function(b){var a=this.get("statechart");a.statechartLogTrace("%@: %@".fmt(this,b))},stateLogWarning:function(b){var a=this.get("statechart");a.statechartLogWarning(b)},stateLogError:function(b){var a=this.get("statechart");a.statechartLogError(b)}});SC.State.plugin=function(c){var a=SC.A(arguments);a.shift();var b=function(){var d=SC.objectForPropertyPath(c);if(!d){console.error("SC.State.plugin: Unable to determine path %@".fmt(c));return undefined}if(!d.isClass||!d.kindOf(SC.State)){console.error("SC.State.plugin: Unable to extend. %@ must be a class extending from SC.State".fmt(c));return undefined}return d.extend.apply(d,a)};b.statePlugin=YES;return b};SC.State.design=SC.State.extend;sc_require("system/state");SC.EMPTY_STATE_NAME="__EMPTY_STATE__";SC.EmptyState=SC.State.extend({name:SC.EMPTY_STATE_NAME,enterState:function(){var a="No initial substate was defined for state %@. Entering default empty state";this.stateLogWarning(a.fmt(this.get("parentState")))}});sc_require("system/state");SC.HistoryState=SC.Object.extend({isRecursive:NO,defaultState:null,statechart:null,parentState:null,state:function(){var b=this.get("defaultState"),a=this.getPath("parentState.historyState");return !!a?a:b}.property().cacheable(),parentHistoryStateDidChange:function(){this.notifyPropertyChange("state")}.observes("*parentState.historyState")});SC.StateRouteHandlerContext=SC.Object.extend({state:null,location:null,params:null,handler:null,retry:function(){var b=this.get("state"),c=this.get("params"),a=this.get("handler");if(SC.typeOf(a)===SC.T_STRING){a=b[a]}if(SC.typeOf(a)===SC.T_FUNCTION){a.apply(b,[c])}}});sc_require("system/state");sc_require("mixins/statechart_delegate");SC.StatechartManager={isResponderContext:YES,isStatechart:YES,statechartIsInitialized:NO,name:null,rootState:null,rootStateExample:SC.State,initialState:null,statesAreConcurrent:NO,monitorIsActive:NO,monitor:null,statechartTraceKey:"trace",trace:NO,statechartOwnerKey:"owner",owner:null,autoInitStatechart:YES,suppressStatechartWarnings:NO,delegate:null,statechartDelegate:function(){var a=this.get("delegate");return this.delegateFor("isStatechartDelegate",a)}.property("delegate"),initMixin:function(){if(this.get("autoInitStatechart")){this.initStatechart()}},destroyMixin:function(){var b=this.get("rootState"),a=this.get("statechartTraceKey");this.removeObserver(a,this,"_statechartTraceDidChange");b.destroy();this.set("rootState",null)},initStatechart:function(){if(this.get("statechartIsInitialized")){return}this._gotoStateLocked=NO;this._sendEventLocked=NO;this._pendingStateTransitions=[];this._pendingSentEvents=[];this.sendAction=this.sendEvent;if(this.get("monitorIsActive")){this.set("monitor",SC.StatechartMonitor.create({statechart:this}))}var a=this.get("statechartTraceKey");this.addObserver(a,this,"_statechartTraceDidChange");this._statechartTraceDidChange();var d=this.get("allowStatechartTracing"),c=this.get("rootState"),e;if(d){this.statechartLogTrace("BEGIN initialize statechart")}if(!c){c=this._constructRootStateClass()}else{if(SC.typeOf(c)===SC.T_FUNCTION&&c.statePlugin){c=c.apply(this)}}if(!(SC.kindOf(c,SC.State)&&c.isClass)){e="Unable to initialize statechart. Root state must be a state class";this.statechartLogError(e);throw e}c=this.createRootState(c,{statechart:this,name:SC.ROOT_STATE_NAME});this.set("rootState",c);c.initState();if(SC.kindOf(c.get("initialSubstate"),SC.EmptyState)){e="Unable to initialize statechart. Root state must have an initial substate explicilty defined";this.statechartLogError(e);throw e}if(!SC.empty(this.get("initialState"))){var b="initialState";this.set(b,c.get(this.get(b)))}this.set("statechartIsInitialized",YES);this.gotoState(c);if(d){this.statechartLogTrace("END initialize statechart")}},createRootState:function(b,a){if(!a){a={}}b=b.create(a);return b},currentStates:function(){return this.getPath("rootState.currentSubstates")}.property().cacheable(),firstCurrentState:function(){var a=this.get("currentStates");return a?a.objectAt(0):null}.property("currentStates").cacheable(),currentStateCount:function(){return this.getPath("currentStates.length")}.property("currentStates").cacheable(),stateIsCurrentState:function(a){return this.get("rootState").stateIsCurrentSubstate(a)},enteredStates:function(){return this.getPath("rootState.enteredSubstates")}.property().cacheable(),stateIsEntered:function(a){return this.get("rootState").stateIsEnteredSubstate(a)},doesContainState:function(a){return !SC.none(this.getState(a))},getState:function(b){var a=this.get("rootState");return a===b?a:a.getSubstate(b)},gotoState:function(b,l,m,c){if(!this.get("statechartIsInitialized")){this.statechartLogError("can not go to state %@. statechart has not yet been initialized".fmt(b));return}if(this.get("isDestroyed")){this.statechartLogError("can not go to state %@. statechart is destroyed".fmt(this));return}var j=this._processGotoStateArgs(arguments);b=j.state;l=j.fromCurrentState;m=j.useHistory;c=j.context;var o=null,k=[],n=[],f=this.get("allowStatechartTracing"),a=this.get("rootState"),h=b,e=l,d;b=this.getState(b);if(SC.none(b)){this.statechartLogError("Can not to goto state %@. Not a recognized state in statechart".fmt(h));return}if(this._gotoStateLocked){this._pendingStateTransitions.push({state:b,fromCurrentState:l,useHistory:m,context:c});return}this._gotoStateLocked=YES;if(l){l=this.getState(l);if(SC.none(l)||!l.get("isCurrentState")){d="Can not to goto state %@. %@ is not a recognized current state in statechart";this.statechartLogError(d.fmt(h,e));this._gotoStateLocked=NO;return}}else{l=b.findFirstRelativeCurrentState();if(!l){l=this.get("firstCurrentState")}}if(f){this.statechartLogTrace("BEGIN gotoState: %@".fmt(b));d="starting from current state: %@";d=d.fmt(l?l:"---");this.statechartLogTrace(d);d="current states before: %@";d=d.fmt(this.getPath("currentStates.length")>0?this.get("currentStates"):"---");this.statechartLogTrace(d)}if(!SC.none(l)){k=this._createStateChain(l)}n=this._createStateChain(b);o=this._findPivotState(k,n);if(o){if(f){this.statechartLogTrace("pivot state = %@".fmt(o))}if(o.get("substatesAreConcurrent")&&o!==b){this.statechartLogError("Can not go to state %@ from %@. Pivot state %@ has concurrent substates.".fmt(b,l,o));this._gotoStateLocked=NO;return}}var g=[];this._traverseStatesToExit(k.shift(),k,o,g);if(o!==b){this._traverseStatesToEnter(n.pop(),n,o,m,g)}else{this._traverseStatesToExit(o,[],null,g);this._traverseStatesToEnter(o,null,null,m,g)}this._gotoStateActions=g;this._executeGotoStateActions(b,g,null,c)},gotoStateActive:function(){return this._gotoStateLocked}.property(),gotoStateSuspended:function(){return this._gotoStateLocked&&!!this._gotoStateSuspendedPoint}.property(),resumeGotoState:function(){if(!this.get("gotoStateSuspended")){this.statechartLogError("Can not resume goto state since it has not been suspended");return}var a=this._gotoStateSuspendedPoint;this._executeGotoStateActions(a.gotoState,a.actions,a.marker,a.context)},_executeGotoStateActions:function(g,f,b,c){var e=null,a=f.length,d=null;b=SC.none(b)?0:b;for(;b<a;b+=1){this._currentGotoStateAction=e=f[b];switch(e.action){case SC.EXIT_STATE:d=this._exitState(e.state,c);break;case SC.ENTER_STATE:d=this._enterState(e.state,e.currentState,c);break}if(SC.kindOf(d,SC.Async)){this._gotoStateSuspendedPoint={gotoState:g,actions:f,marker:b+1,context:c};d.tryToPerform(e.state);return}}this.beginPropertyChanges();this.notifyPropertyChange("currentStates");this.notifyPropertyChange("enteredStates");this.endPropertyChanges();if(this.get("allowStatechartTracing")){this.statechartLogTrace("current states after: %@".fmt(this.get("currentStates")));this.statechartLogTrace("END gotoState: %@".fmt(g))}this._cleanupStateTransition()},_cleanupStateTransition:function(){this._currentGotoStateAction=null;this._gotoStateSuspendedPoint=null;this._gotoStateActions=null;this._gotoStateLocked=NO;this._flushPendingStateTransition()},_exitState:function(d,b){var c;if(d.get("currentSubstates").indexOf(d)>=0){c=d.get("parentState");while(c){c.get("currentSubstates").removeObject(d);c=c.get("parentState")}}c=d;while(c){c.get("enteredSubstates").removeObject(d);c=c.get("parentState")}if(this.get("allowStatechartTracing")){this.statechartLogTrace("<-- exiting state: %@".fmt(d))}d.set("currentSubstates",[]);d.stateWillBecomeExited(b);var a=this.exitState(d,b);d.stateDidBecomeExited(b);if(this.get("monitorIsActive")){this.get("monitor").pushExitedState(d)}d._traverseStatesToExit_skipState=NO;return a},exitState:function(b,a){return b.exitState(a)},_enterState:function(d,e,b){var c=d.get("parentState");if(c&&!d.get("isConcurrentState")){c.set("historyState",d)}if(e){c=d;while(c){c.get("currentSubstates").pushObject(d);c=c.get("parentState")}}c=d;while(c){c.get("enteredSubstates").pushObject(d);c=c.get("parentState")}if(this.get("allowStatechartTracing")){this.statechartLogTrace("--> entering state: %@".fmt(d))}d.stateWillBecomeEntered(b);var a=this.enterState(d,b);d.stateDidBecomeEntered(b);if(this.get("monitorIsActive")){this.get("monitor").pushEnteredState(d)}return a},enterState:function(b,a){if(b.enterStateByRoute&&SC.kindOf(a,SC.StateRouteHandlerContext)){return b.enterStateByRoute(a)}else{return b.enterState(a)}},gotoHistoryState:function(f,e,c,d){if(!this.get("statechartIsInitialized")){this.statechartLogError("can not go to state %@'s history state. Statechart has not yet been initialized".fmt(f));return}var b=this._processGotoStateArgs(arguments);f=b.state;e=b.fromCurrentState;c=b.useHistory;d=b.context;f=this.getState(f);if(!f){this.statechartLogError("Can not to goto state %@'s history state. Not a recognized state in statechart".fmt(f));return}var a=f.get("historyState");if(!c){if(a){this.gotoState(a,e,d)}else{this.gotoState(f,e,d)}}else{this.gotoState(f,e,YES,d)}},sendEvent:function(b,g,f){if(this.get("isDestroyed")){this.statechartLogError("can send event %@. statechart is destroyed".fmt(b));return}var c=NO,l=NO,h=this.get("currentStates").slice(),k={},j=0,e=0,a=null,d=this.get("allowStatechartTracing");if(this._sendEventLocked||this._goStateLocked){this._pendingSentEvents.push({event:b,arg1:g,arg2:f});return}this._sendEventLocked=YES;if(d){this.statechartLogTrace("BEGIN sendEvent: '%@'".fmt(b))}j=h.get("length");for(;e<j;e+=1){l=NO;a=h[e];if(!a.get("isCurrentState")){continue}while(!l&&a){if(!k[a.get("fullPath")]){l=a.tryToHandleEvent(b,g,f);k[a.get("fullPath")]=YES}if(!l){a=a.get("parentState")}else{c=YES}}}this._sendEventLocked=NO;if(d){if(!c){this.statechartLogTrace("No state was able handle event %@".fmt(b))}this.statechartLogTrace("END sendEvent: '%@'".fmt(b))}var m=this._flushPendingSentEvents();return c?this:(m?this:null)},stateWillTryToHandleEvent:function(c,b,a){this._stateHandleEventInfo={state:c,event:b,handler:a}},stateDidTryToHandleEvent:function(c,b,a,d){this._stateHandleEventInfo=null},_createStateChain:function(b){var a=[];while(b){a.push(b);b=b.get("parentState")}return a},_findPivotState:function(c,b){if(c.length===0||b.length===0){return null}var a=c.find(function(e,d){if(b.indexOf(e)>=0){return YES}});return a},_traverseStatesToExit:function(b,k,d,h){if(!b||b===d){return}var e=this.get("allowStatechartTracing");if(b.get("substatesAreConcurrent")){var f=0,g=b.get("currentSubstates"),j=g.length,c=null;for(;f<j;f+=1){c=g[f];if(c._traverseStatesToExit_skipState===YES){continue}var a=this._createStateChain(c);this._traverseStatesToExit(a.shift(),a,b,h)}}h.push({action:SC.EXIT_STATE,state:b});if(b.get("isCurrentState")){b._traverseStatesToExit_skipState=YES}this._traverseStatesToExit(k.shift(),k,d,h)},_traverseStatesToEnter:function(b,e,j,g,d){if(!b){return}var c=this.get("allowStatechartTracing");if(j){if(b!==j){this._traverseStatesToEnter(e.pop(),e,j,g,d)}else{this._traverseStatesToEnter(e.pop(),e,null,g,d)}}else{if(!e||e.length===0){var h={action:SC.ENTER_STATE,state:b,currentState:NO};d.push(h);var f=b.get("initialSubstate"),a=b.get("historyState");if(b.get("substatesAreConcurrent")){this._traverseConcurrentStatesToEnter(b.get("substates"),null,g,d)}else{if(b.get("hasSubstates")&&a&&g){this._traverseStatesToEnter(a,null,null,g,d)}else{if(f){if(SC.kindOf(f,SC.HistoryState)){if(!g){g=f.get("isRecursive")}f=f.get("state")}this._traverseStatesToEnter(f,null,null,g,d)}else{h.currentState=YES}}}}else{if(e.length>0){d.push({action:SC.ENTER_STATE,state:b});var k=e.pop();this._traverseStatesToEnter(k,e,null,g,d);if(b.get("substatesAreConcurrent")){this._traverseConcurrentStatesToEnter(b.get("substates"),k,g,d)}}}}},respondsTo:function(d){var b=this.get("currentStates"),a=b.get("length"),c=0,e=null;for(;c<a;c+=1){e=b.objectAt(c);while(e){if(e.respondsToEvent(d)){return true}e=e.get("parentState")}}return SC.typeOf(this[d])===SC.T_FUNCTION},tryToPerform:function(d,c,b){if(!this.respondsTo(d)){return NO}if(SC.typeOf(this[d])===SC.T_FUNCTION){var a=this[d](c,b);if(a!==NO){return YES}}return !!this.sendEvent(d,c,b)},invokeStateMethod:function(k,j,c){if(k==="unknownEvent"){this.statechartLogError("can not invoke method unkownEvent");return}j=SC.A(arguments);j.shift();var f=j.length,m=f>0?j[f-1]:null,l=SC.typeOf(m)===SC.T_FUNCTION?j.pop():null,e=this.get("currentStates"),d=0,b=null,h={},a,n=undefined,g=0;f=e.get("length");for(;d<f;d+=1){b=e.objectAt(d);while(b){if(h[b.get("fullPath")]){break}h[b.get("fullPath")]=YES;a=b[k];if(SC.typeOf(a)===SC.T_FUNCTION&&!a.isEventHandler){n=a.apply(b,j);if(l){l.call(this,b,n)}g+=1;break}b=b.get("parentState")}}return g===1?n:undefined},_traverseConcurrentStatesToEnter:function(d,c,f,b){var e=0,a=d.length,g=null;for(;e<a;e+=1){g=d[e];if(g!==c){this._traverseStatesToEnter(g,null,null,f,b)}}},_flushPendingStateTransition:function(){if(!this._pendingStateTransitions){this.statechartLogError("Unable to flush pending state transition. _pendingStateTransitions is invalid");return}var a=this._pendingStateTransitions.shift();if(!a){return}this.gotoState(a.state,a.fromCurrentState,a.useHistory,a.context)},_flushPendingSentEvents:function(){var a=this._pendingSentEvents.shift();if(!a){return null}return this.sendEvent(a.event,a.arg1,a.arg2)},_monitorIsActiveDidChange:function(){if(this.get("monitorIsActive")&&SC.none(this.get("monitor"))){this.set("monitor",SC.StatechartMonitor.create())}}.observes("monitorIsActive"),_processGotoStateArgs:function(b){var d={state:null,fromCurrentState:null,useHistory:false,context:null},a=null,c=null;b=SC.$A(b);b=b.filter(function(e){return !(e===undefined)});a=b.length;if(a<1){return d}d.state=b[0];if(a===2){c=b[1];switch(SC.typeOf(c)){case SC.T_BOOL:d.useHistory=c;break;case SC.T_HASH:case SC.T_OBJECT:if(!SC.kindOf(c,SC.State)){d.context=c}break;default:d.fromCurrentState=c}}else{if(a===3){c=b[1];if(SC.typeOf(c)===SC.T_BOOL){d.useHistory=c;d.context=b[2]}else{d.fromCurrentState=c;c=b[2];if(SC.typeOf(c)===SC.T_BOOL){d.useHistory=c}else{d.context=c}}}else{d.fromCurrentState=b[1];d.useHistory=b[2];d.context=b[3]}}return d},_constructRootStateClass:function(){var d="rootStateExample",e=this.get(d),b=this.get("initialState"),c=this.get("statesAreConcurrent"),a=0,j,g,f,h={};if(SC.typeOf(e)===SC.T_FUNCTION&&e.statePlugin){e=e.apply(this)}if(!(SC.kindOf(e,SC.State)&&e.isClass)){this._logStatechartCreationError("Invalid root state example");return null}if(c&&!SC.empty(b)){this._logStatechartCreationError("Can not assign an initial state when states are concurrent")}else{if(c){h.substatesAreConcurrent=YES}else{if(SC.typeOf(b)===SC.T_STRING){h.initialSubstate=b}else{this._logStatechartCreationError("Must either define initial state or assign states as concurrent");return null}}}for(j in this){if(j===d){continue}g=this[j];f=SC.typeOf(g)===SC.T_FUNCTION;if(f&&g.statePlugin){g=g.apply(this)}if(SC.kindOf(g,SC.State)&&g.isClass&&this[j]!==this.constructor){h[j]=g;a+=1}}if(a===0){this._logStatechartCreationError("Must define one or more states");return null}return e.extend(h)},_logStatechartCreationError:function(a){SC.Logger.error("Unable to create statechart for %@: %@.".fmt(this,a))},statechartLogTrace:function(a){SC.Logger.info("%@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogError:function(a){SC.Logger.error("ERROR %@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogWarning:function(a){if(this.get("suppressStatechartWarnings")){return}SC.Logger.warn("WARN %@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogPrefix:function(){var b=SC._object_className(this.constructor),a=this.get("name"),c;if(SC.empty(a)){c="%@<%@>".fmt(b,SC.guidFor(this))}else{c="%@<%@, %@>".fmt(b,a,SC.guidFor(this))}return c}.property().cacheable(),allowStatechartTracing:function(){var a=this.get("statechartTraceKey");return this.get(a)}.property().cacheable(),_statechartTraceDidChange:function(){this.notifyPropertyChange("allowStatechartTracing")},details:function(){var b={initialized:this.get("statechartIsInitialized")};if(this.get("name")){b.name=this.get("name")}if(!this.get("statechartIsInitialized")){return b}b["current-states"]=[];this.get("currentStates").forEach(function(f){b["current-states"].push(f.get("fullPath"))});var a={active:this.get("gotoStateActive"),suspended:this.get("gotoStateSuspended")};if(this._gotoStateActions){a["transition-sequence"]=[];var e=this._gotoStateActions,c=function(g){var f=g.action===SC.ENTER_STATE?"enter":"exit";return"%@ %@".fmt(f,g.state.get("fullPath"))};e.forEach(function(f){a["transition-sequence"].push(c(f))});a["current-transition"]=c(this._currentGotoStateAction)}b["state-transition"]=a;if(this._stateHandleEventInfo){var d=this._stateHandleEventInfo;b["handling-event"]={state:d.state.get("fullPath"),event:d.event,handler:d.handler}}else{b["handling-event"]=false}return b}.property(),toStringWithDetails:function(){var b="",c=this.toString(),a=this.get("details");b+=c+"\n";b+=this._hashToString(a,2);return b},_hashToString:function(d,a){var e="";for(var b in d){var c=d[b];if(c instanceof Array){e+=this._arrayToString(b,c,a)+"\n"}else{if(c instanceof Object){e+="%@%@:\n".fmt(" ".mult(a),b);e+=this._hashToString(c,a+2)}else{e+="%@%@: %@\n".fmt(" ".mult(a),b,c)}}}return e},_arrayToString:function(b,d,a){if(d.length===0){return"%@%@: []".fmt(" ".mult(a),b)}var c="%@%@: [\n".fmt(" ".mult(a),b);d.forEach(function(f,e){c+="%@%@\n".fmt(" ".mult(a+2),f)},this);c+=" ".mult(a)+"]";return c}};SC.mixin(SC.StatechartManager,SC.StatechartDelegate,SC.DelegateSupport);SC.ROOT_STATE_NAME="__ROOT_STATE__";SC.EXIT_STATE=0;SC.ENTER_STATE=1;SC.Statechart=SC.Object.extend(SC.StatechartManager,{autoInitStatechart:NO});SC.Statechart.design=SC.Statechart.extend;var Handlebars={};Handlebars.VERSION="1.0.beta.2";Handlebars.helpers={};Handlebars.partials={};Handlebars.registerHelper=function(b,c,a){if(a){c.not=a}this.helpers[b]=c};Handlebars.registerPartial=function(a,b){this.partials[a]=b};Handlebars.registerHelper("helperMissing",function(a){if(arguments.length===2){return undefined}else{throw new Error("Could not find property '"+a+"'")}});Handlebars.registerHelper("blockHelperMissing",function(f,d){var a=d.inverse||function(){},h=d.fn;var c="";var g=Object.prototype.toString.call(f);if(g==="[object Function]"){f=f()}if(f===true){return h(this)}else{if(f===false||f==null){return a(this)}else{if(g==="[object Array]"){if(f.length>0){for(var e=0,b=f.length;e<b;e++){c=c+h(f[e])}}else{c=a(this)}return c}else{return h(f)}}}});Handlebars.registerHelper("each",function(f,d){var g=d.fn,a=d.inverse;var c="";if(f&&f.length>0){for(var e=0,b=f.length;e<b;e++){c=c+g(f[e])}}else{c=a(this)}return c});Handlebars.registerHelper("if",function(b,a){if(!b||Handlebars.Utils.isEmpty(b)){return a.inverse(this)}else{return a.fn(this)}});Handlebars.registerHelper("unless",function(c,b){var d=b.fn,a=b.inverse;b.fn=a;b.inverse=d;return Handlebars.helpers["if"].call(this,c,b)});Handlebars.registerHelper("with",function(b,a){return a.fn(b)});Handlebars.registerHelper("log",function(a){Handlebars.log(a)});var handlebars=(function(){var f={trace:function c(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function b(g,k,l,o,n,j,m){var h=j.length-1;switch(n){case 1:return j[h-1];break;case 2:this.$=new o.ProgramNode(j[h-2],j[h]);break;case 3:this.$=new o.ProgramNode(j[h]);break;case 4:this.$=new o.ProgramNode([]);break;case 5:this.$=[j[h]];break;case 6:j[h-1].push(j[h]);this.$=j[h-1];break;case 7:this.$=new o.InverseNode(j[h-2],j[h-1],j[h]);break;case 8:this.$=new o.BlockNode(j[h-2],j[h-1],j[h]);break;case 9:this.$=j[h];break;case 10:this.$=j[h];break;case 11:this.$=new o.ContentNode(j[h]);break;case 12:this.$=new o.CommentNode(j[h]);break;case 13:this.$=new o.MustacheNode(j[h-1][0],j[h-1][1]);break;case 14:this.$=new o.MustacheNode(j[h-1][0],j[h-1][1]);break;case 15:this.$=j[h-1];break;case 16:this.$=new o.MustacheNode(j[h-1][0],j[h-1][1]);break;case 17:this.$=new o.MustacheNode(j[h-1][0],j[h-1][1],true);break;case 18:this.$=new o.PartialNode(j[h-1]);break;case 19:this.$=new o.PartialNode(j[h-2],j[h-1]);break;case 20:break;case 21:this.$=[[j[h-2]].concat(j[h-1]),j[h]];break;case 22:this.$=[[j[h-1]].concat(j[h]),null];break;case 23:this.$=[[j[h-1]],j[h]];break;case 24:this.$=[[j[h]],null];break;case 25:j[h-1].push(j[h]);this.$=j[h-1];break;case 26:this.$=[j[h]];break;case 27:this.$=j[h];break;case 28:this.$=new o.StringNode(j[h]);break;case 29:this.$=new o.IntegerNode(j[h]);break;case 30:this.$=new o.BooleanNode(j[h]);break;case 31:this.$=new o.HashNode(j[h]);break;case 32:j[h-1].push(j[h]);this.$=j[h-1];break;case 33:this.$=[j[h]];break;case 34:this.$=[j[h-2],j[h]];break;case 35:this.$=[j[h-2],new o.StringNode(j[h])];break;case 36:this.$=[j[h-2],new o.IntegerNode(j[h])];break;case 37:this.$=[j[h-2],new o.BooleanNode(j[h])];break;case 38:this.$=new o.IdNode(j[h]);break;case 39:j[h-2].push(j[h]);this.$=j[h-2];break;case 40:this.$=[j[h]];break}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function d(h,g){throw new Error(h)},parse:function e(q){var y=this,m=[0],I=[null],t=[],J=this.table,h="",s=0,G=0,k=0,o=2,v=1;this.lexer.setInput(q);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var j=this.lexer.yylloc;t.push(j);if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function x(p){m.length=m.length-2*p;I.length=I.length-p;t.length=t.length-p}function w(){var p;p=y.lexer.lex()||1;if(typeof p!=="number"){p=y.symbols_[p]||p}return p}var F,B,l,E,K,u,D={},z,H,g,n;while(true){l=m[m.length-1];if(this.defaultActions[l]){E=this.defaultActions[l]}else{if(F==null){F=w()}E=J[l]&&J[l][F]}if(typeof E==="undefined"||!E.length||!E[0]){if(!k){n=[];for(z in J[l]){if(this.terminals_[z]&&z>2){n.push("'"+this.terminals_[z]+"'")}}var C="";if(this.lexer.showPosition){C="Parse error on line "+(s+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+n.join(", ")}else{C="Parse error on line "+(s+1)+": Unexpected "+(F==1?"end of input":("'"+(this.terminals_[F]||F)+"'"))}this.parseError(C,{text:this.lexer.match,token:this.terminals_[F]||F,line:this.lexer.yylineno,loc:j,expected:n})}if(k==3){if(F==v){throw new Error(C||"Parsing halted.")}G=this.lexer.yyleng;h=this.lexer.yytext;s=this.lexer.yylineno;j=this.lexer.yylloc;F=w()}while(1){if((o.toString()) in J[l]){break}if(l==0){throw new Error(C||"Parsing halted.")}x(1);l=m[m.length-1]}B=F;F=o;l=m[m.length-1];E=J[l]&&J[l][o];k=3}if(E[0] instanceof Array&&E.length>1){throw new Error("Parse Error: multiple actions possible at state: "+l+", token: "+F)}switch(E[0]){case 1:m.push(F);I.push(this.lexer.yytext);t.push(this.lexer.yylloc);m.push(E[1]);F=null;if(!B){G=this.lexer.yyleng;h=this.lexer.yytext;s=this.lexer.yylineno;j=this.lexer.yylloc;if(k>0){k--}}else{F=B;B=null}break;case 2:H=this.productions_[E[1]][1];D.$=I[I.length-H];D._$={first_line:t[t.length-(H||1)].first_line,last_line:t[t.length-1].last_line,first_column:t[t.length-(H||1)].first_column,last_column:t[t.length-1].last_column};u=this.performAction.call(D,h,G,s,this.yy,E[1],I,t);if(typeof u!=="undefined"){return u}if(H){m=m.slice(0,-1*H*2);I=I.slice(0,-1*H);t=t.slice(0,-1*H)}m.push(this.productions_[E[1]][0]);I.push(D.$);t.push(D._$);g=J[m[m.length-2]][m[m.length-1]];m.push(g);break;case 3:return true}}return true}};var a=(function(){var k=({EOF:1,parseError:function m(p,o){if(this.yy.parseError){this.yy.parseError(p,o)}else{throw new Error(p)}},setInput:function(o){this._input=o;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};return this},input:function(){var p=this._input[0];this.yytext+=p;this.yyleng++;this.match+=p;this.matched+=p;var o=p.match(/\n/);if(o){this.yylineno++}this._input=this._input.slice(1);return p},unput:function(o){this._input=o+this._input;return this},more:function(){this._more=true;return this},pastInput:function(){var o=this.matched.substr(0,this.matched.length-this.match.length);return(o.length>20?"...":"")+o.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var o=this.match;if(o.length<20){o+=this._input.substr(0,20-o.length)}return(o.substr(0,20)+(o.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var o=this.pastInput();var p=new Array(o.length+1).join("-");return o+this.upcomingInput()+"\n"+p+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var t,q,p,o;if(!this._more){this.yytext="";this.match=""}var u=this._currentRules();for(var s=0;s<u.length;s++){q=this._input.match(this.rules[u[s]]);if(q){o=q[0].match(/\n.*/g);if(o){this.yylineno+=o.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-1:this.yylloc.last_column+q[0].length};this.yytext+=q[0];this.match+=q[0];this.matches=q;this.yyleng=this.yytext.length;this._more=false;this._input=this._input.slice(q[0].length);this.matched+=q[0];t=this.performAction.call(this,this.yy,this,u[s],this.conditionStack[this.conditionStack.length-1]);if(t){return t}else{return}}}if(this._input===""){return this.EOF}else{this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function g(){var o=this.next();if(typeof o!=="undefined"){return o}else{return this.lex()}},begin:function h(o){this.conditionStack.push(o)},popState:function n(){return this.conditionStack.pop()},_currentRules:function l(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}});k.performAction=function j(t,p,s,o){var q=o;switch(s){case 0:this.begin("mu");if(p.yytext){return 14}break;case 1:return 14;break;case 2:return 24;break;case 3:return 16;break;case 4:return 20;break;case 5:return 19;break;case 6:return 19;break;case 7:return 23;break;case 8:return 23;break;case 9:p.yytext=p.yytext.substr(3,p.yyleng-5);this.begin("INITIAL");return 15;break;case 10:return 22;break;case 11:return 34;break;case 12:return 33;break;case 13:return 33;break;case 14:return 36;break;case 15:break;case 16:this.begin("INITIAL");return 18;break;case 17:this.begin("INITIAL");return 18;break;case 18:p.yytext=p.yytext.substr(1,p.yyleng-2).replace(/\\"/g,'"');return 28;break;case 19:return 30;break;case 20:return 30;break;case 21:return 29;break;case 22:return 33;break;case 23:p.yytext=p.yytext.substr(1,p.yyleng-2);return 33;break;case 24:return"INVALID";break;case 25:return 5;break}};k.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,/^[a-zA-Z0-9_$-]+(?=[=}\s/.])/,/^\[.*\]/,/^./,/^$/];k.conditions={mu:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:false},INITIAL:{rules:[0,1,25],inclusive:true}};return k})();f.lexer=a;return f})();Handlebars.Parser=handlebars;Handlebars.parse=function(a){Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(a)};Handlebars.print=function(a){return new Handlebars.PrintVisitor().accept(a)};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(b,a){}};Handlebars.log=function(b,a){Handlebars.logger.log(b,a)};(function(){Handlebars.AST={};Handlebars.AST.ProgramNode=function(c,b){this.type="program";this.statements=c;if(b){this.inverse=new Handlebars.AST.ProgramNode(b)}};Handlebars.AST.MustacheNode=function(d,c,b){this.type="mustache";this.id=d[0];this.params=d.slice(1);this.hash=c;this.escaped=!b};Handlebars.AST.PartialNode=function(c,b){this.type="partial";this.id=c;this.context=b};var a=function(b,c){if(b.original!==c.original){throw new Handlebars.Exception(b.original+" doesn't match "+c.original)}};Handlebars.AST.BlockNode=function(c,b,d){a(c.id,d);this.type="block";this.mustache=c;this.program=b};Handlebars.AST.InverseNode=function(c,b,d){a(c.id,d);this.type="inverse";this.mustache=c;this.program=b};Handlebars.AST.ContentNode=function(b){this.type="content";this.string=b};Handlebars.AST.HashNode=function(b){this.type="hash";this.pairs=b};Handlebars.AST.IdNode=function(f){this.type="ID";this.original=f.join(".");var d=[],g=0;for(var e=0,b=f.length;e<b;e++){var c=f[e];if(c===".."){g++}else{if(c==="."||c==="this"){this.isScoped=true}else{d.push(c)}}}this.parts=d;this.string=d.join(".");this.depth=g;this.isSimple=(d.length===1)&&(g===0)};Handlebars.AST.StringNode=function(b){this.type="STRING";this.string=b};Handlebars.AST.IntegerNode=function(b){this.type="INTEGER";this.integer=b};Handlebars.AST.BooleanNode=function(b){this.type="BOOLEAN";this.bool=b};Handlebars.AST.CommentNode=function(b){this.type="comment";this.comment=b}})();Handlebars.Exception=function(b){var a=Error.prototype.constructor.apply(this,arguments);for(var c in a){if(a.hasOwnProperty(c)){this[c]=a[c]}}};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(a){this.string=a};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};(function(){var c={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var d=/&(?!\w+;)|[<>"'`]/g;var b=/[&<>"'`]/;var a=function(e){return c[e]||"&amp;"};Handlebars.Utils={escapeExpression:function(e){if(e instanceof Handlebars.SafeString){return e.toString()}else{if(e==null||e===false){return""}}if(!b.test(e)){return e}return e.replace(d,a)},isEmpty:function(e){if(typeof e==="undefined"){return true}else{if(e===null){return true}else{if(e===false){return true}else{if(Object.prototype.toString.call(e)==="[object Array]"&&e.length===0){return true}else{return false}}}}}}})();Handlebars.Compiler=function(){};Handlebars.JavaScriptCompiler=function(){};(function(f,e){f.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16};f.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1};f.DISASSEMBLE_MAP={};for(var h in f.OPCODE_MAP){var g=f.OPCODE_MAP[h];f.DISASSEMBLE_MAP[g]=h}f.multiParamSize=function(j){return f.MULTI_PARAM_OPCODES[f.DISASSEMBLE_MAP[j]]};f.prototype={compiler:f,disassemble:function(){var u=this.opcodes,s,n;var q=[],w,m,x;for(var t=0,o=u.length;t<o;t++){s=u[t];if(s==="DECLARE"){m=u[++t];x=u[++t];q.push("DECLARE "+m+" = "+x)}else{w=f.DISASSEMBLE_MAP[s];var v=f.multiParamSize(s);var k=[];for(var p=0;p<v;p++){n=u[++t];if(typeof n==="string"){n='"'+n.replace("\n","\\n")+'"'}k.push(n)}w=w+" "+k.join(" ");q.push(w)}}return q.join("\n")},guid:0,compile:function(j,l){this.children=[];this.depths={list:[]};this.options=l;var m=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(m){for(var k in m){this.options.knownHelpers[k]=m[k]}}return this.program(j)},accept:function(j){return this[j.type](j)},program:function(m){var k=m.statements,o;this.opcodes=[];for(var n=0,j=k.length;n<j;n++){o=k[n];this[o.type](o)}this.isSimple=j===1;this.depths.list=this.depths.list.sort(function(p,l){return p-l});return this},compileProgram:function(m){var j=new this.compiler().compile(m,this.options);var n=this.guid++;this.usePartial=this.usePartial||j.usePartial;this.children[n]=j;for(var o=0,k=j.depths.list.length;o<k;o++){depth=j.depths.list[o];if(depth<2){continue}else{this.addDepth(depth-1)}}return n},block:function(p){var m=p.mustache;var o,q,k,l;var n=this.setupStackForMustache(m);var j=this.compileProgram(p.program);if(p.program.inverse){l=this.compileProgram(p.program.inverse);this.declare("inverse",l)}this.opcode("invokeProgram",j,n.length,!!m.hash);this.declare("inverse",null);this.opcode("append")},inverse:function(l){var k=this.setupStackForMustache(l.mustache);var j=this.compileProgram(l.program);this.declare("inverse",j);this.opcode("invokeProgram",null,k.length,!!l.mustache.hash);this.opcode("append")},hash:function(n){var m=n.pairs,p,o;this.opcode("push","{}");for(var k=0,j=m.length;k<j;k++){p=m[k];o=p[1];this.accept(o);this.opcode("assignToHash",p[0])}},partial:function(j){var k=j.id;this.usePartial=true;if(j.context){this.ID(j.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",k.original);this.opcode("append")},content:function(j){this.opcode("appendContent",j.string)},mustache:function(j){var k=this.setupStackForMustache(j);this.opcode("invokeMustache",k.length,j.id.original,!!j.hash);if(j.escaped){this.opcode("appendEscaped")}else{this.opcode("append")}},ID:function(m){this.addDepth(m.depth);this.opcode("getContext",m.depth);this.opcode("lookupWithHelpers",m.parts[0]||null,m.isScoped||false);for(var k=1,j=m.parts.length;k<j;k++){this.opcode("lookup",m.parts[k])}},STRING:function(j){this.opcode("pushString",j.string)},INTEGER:function(j){this.opcode("push",j.integer)},BOOLEAN:function(j){this.opcode("push",j.bool)},comment:function(){},pushParams:function(l){var j=l.length,k;while(j--){k=l[j];if(this.options.stringParams){if(k.depth){this.addDepth(k.depth)}this.opcode("getContext",k.depth||0);this.opcode("pushStringParam",k.string)}else{this[k.type](k)}}},opcode:function(j,m,l,k){this.opcodes.push(f.OPCODE_MAP[j]);if(m!==undefined){this.opcodes.push(m)}if(l!==undefined){this.opcodes.push(l)}if(k!==undefined){this.opcodes.push(k)}},declare:function(j,k){this.opcodes.push("DECLARE");this.opcodes.push(j);this.opcodes.push(k)},addDepth:function(j){if(j===0){return}if(!this.depths[j]){this.depths[j]=true;this.depths.list.push(j)}},setupStackForMustache:function(j){var k=j.params;this.pushParams(k);if(j.hash){this.hash(j.hash)}this.ID(j.id);return k}};e.prototype={nameLookup:function(l,j,k){if(/^[0-9]+$/.test(j)){return l+"["+j+"]"}else{if(e.isValidJavaScriptVariableName(j)){return l+"."+j}else{return l+"['"+j+"']"}}},appendToBuffer:function(j){if(this.environment.isSimple){return"return "+j+";"}else{return"buffer += "+j+";"}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(j,k,m,l){this.environment=j;this.options=k||{};this.name=this.environment.name;this.isChild=!!m;this.context=m||{programs:[],aliases:{self:"this"},registers:{list:[]}};this.preamble();this.stackSlot=0;this.stackVars=[];this.compileChildren(j,k);var o=j.opcodes,n;this.i=0;for(b=o.length;this.i<b;this.i++){n=this.nextOpcode(0);if(n[0]==="DECLARE"){this.i=this.i+2;this[n[1]]=n[2]}else{this.i=this.i+n[1].length;this[n[0]].apply(this,n[1])}}return this.createFunctionContext(l)},nextOpcode:function(t){var p=this.environment.opcodes,o=p[this.i+t],m,q;var s,k;if(o==="DECLARE"){m=p[this.i+1];q=p[this.i+2];return["DECLARE",m,q]}else{m=f.DISASSEMBLE_MAP[o];s=f.multiParamSize(o);k=[];for(var l=0;l<s;l++){k.push(p[this.i+l+1+t])}return[m,k]}},eat:function(j){this.i=this.i+j.length},preamble:function(){var j=[];if(!this.isChild){var k=this.namespace;var l="helpers = helpers || "+k+".helpers;";if(this.environment.usePartial){l=l+" partials = partials || "+k+".partials;"}j.push(l)}else{j.push("")}if(!this.environment.isSimple){j.push(", buffer = "+this.initializeBuffer())}else{j.push("")}this.lastContext=0;this.source=j},createFunctionContext:function(p){var q=this.stackVars;if(!this.isChild){q=q.concat(this.context.registers.list)}if(q.length>0){this.source[1]=this.source[1]+", "+q.join(", ")}if(!this.isChild){var k=[];for(var o in this.context.aliases){this.source[1]=this.source[1]+", "+o+"="+this.context.aliases[o]}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.source.push("return buffer;")}var s=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var n=0,j=this.environment.depths.list.length;n<j;n++){s.push("depth"+this.environment.depths.list[n])}if(p){s.push(this.source.join("\n  "));return Function.apply(this,s)}else{var m="function "+(this.name||"")+"("+s.join(",")+") {\n  "+this.source.join("\n  ")+"}";Handlebars.log(Handlebars.logger.DEBUG,m+"\n\n");return m}},appendContent:function(j){this.source.push(this.appendToBuffer(this.quotedString(j)))},append:function(){var j=this.popStack();this.source.push("if("+j+" || "+j+" === 0) { "+this.appendToBuffer(j)+" }");if(this.environment.isSimple){this.source.push("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){var k=this.nextOpcode(1),j="";this.context.aliases.escapeExpression="this.escapeExpression";if(k[0]==="appendContent"){j=" + "+this.quotedString(k[1][0]);this.eat(k)}this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+j))},getContext:function(j){if(this.lastContext!==j){this.lastContext=j}},lookupWithHelpers:function(l,m){if(l){var j=this.nextStack();this.usingKnownHelper=false;var k;if(!m&&this.options.knownHelpers[l]){k=j+" = "+this.nameLookup("helpers",l,"helper");this.usingKnownHelper=true}else{if(m||this.options.knownHelpersOnly){k=j+" = "+this.nameLookup("depth"+this.lastContext,l,"context")}else{k=j+" = "+this.nameLookup("helpers",l,"helper")+" || "+this.nameLookup("depth"+this.lastContext,l,"context")}}k+=";";this.source.push(k)}else{this.pushStack("depth"+this.lastContext)}},lookup:function(k){var j=this.topStack();this.source.push(j+" = ("+j+" === null || "+j+" === undefined || "+j+" === false ? "+j+" : "+this.nameLookup(j,k,"context")+");")},pushStringParam:function(j){this.pushStack("depth"+this.lastContext);this.pushString(j)},pushString:function(j){this.pushStack(this.quotedString(j))},push:function(j){this.pushStack(j)},invokeMustache:function(l,k,j){this.populateParams(l,this.quotedString(k),"{}",null,j,function(m,o,n){if(!this.usingKnownHelper){this.context.aliases.helperMissing="helpers.helperMissing";this.context.aliases.undef="void 0";this.source.push("else if("+n+"=== undef) { "+m+" = helperMissing.call("+o+"); }");if(m!==n){this.source.push("else { "+m+" = "+n+"; }")}}})},invokeProgram:function(l,m,k){var j=this.programExpression(this.inverse);var n=this.programExpression(l);this.populateParams(m,null,n,j,k,function(o,q,p){if(!this.usingKnownHelper){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";this.source.push("else { "+o+" = blockHelperMissing.call("+q+"); }")}})},populateParams:function(p,k,u,q,y,x){var l=y||this.options.stringParams||q||this.options.data;var j=this.popStack(),w;var n=[],m,o,v;if(l){this.register("tmp1",u);v="tmp1"}else{v="{ hash: {} }"}if(l){var t=(y?this.popStack():"{}");this.source.push("tmp1.hash = "+t+";")}if(this.options.stringParams){this.source.push("tmp1.contexts = [];")}for(var s=0;s<p;s++){m=this.popStack();n.push(m);if(this.options.stringParams){this.source.push("tmp1.contexts.push("+this.popStack()+");")}}if(q){this.source.push("tmp1.fn = tmp1;");this.source.push("tmp1.inverse = "+q+";")}if(this.options.data){this.source.push("tmp1.data = data;")}n.push(v);this.populateCall(n,j,k||j,x)},populateCall:function(m,p,o,j){var l=["depth0"].concat(m).join(", ");var n=["depth0"].concat(o).concat(m).join(", ");var k=this.nextStack();if(this.usingKnownHelper){this.source.push(k+" = "+p+".call("+l+");")}else{this.context.aliases.functionType='"function"';this.source.push("if(typeof "+p+" === functionType) { "+k+" = "+p+".call("+l+"); }")}j.call(this,k,n,p);this.usingKnownHelper=false},invokePartial:function(j){this.pushStack("self.invokePartial("+this.nameLookup("partials",j,"partial")+", '"+j+"', "+this.popStack()+", helpers, partials);")},assignToHash:function(j){var k=this.popStack();var l=this.topStack();this.source.push(l+"['"+j+"'] = "+k+";")},compiler:e,compileChildren:function(j,n){var p=j.children,s,q;for(var o=0,k=p.length;o<k;o++){s=p[o];q=new this.compiler();this.context.programs.push("");var m=this.context.programs.length;s.index=m;s.name="program"+m;this.context.programs[m]=q.compile(s,n,this.context)}},programExpression:function(k){if(k==null){return"self.noop"}var p=this.environment.children[k],o=p.depths.list;var n=[p.index,p.name,"data"];for(var m=0,j=o.length;m<j;m++){depth=o[m];if(depth===1){n.push("depth0")}else{n.push("depth"+(depth-1))}}if(o.length===0){return"self.program("+n.join(", ")+")"}else{n.shift();return"self.programWithDepth("+n.join(", ")+")"}},register:function(j,k){this.useRegister(j);this.source.push(j+" = "+k+";")},useRegister:function(j){if(!this.context.registers[j]){this.context.registers[j]=true;this.context.registers.list.push(j)}},pushStack:function(j){this.source.push(this.nextStack()+" = "+j+";");return"stack"+this.stackSlot},nextStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(j){return'"'+j.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};var a=("break case catch continue default delete do else finally for function if in instanceof new return switch this throw try typeof var void while with null true false").split(" ");var d=e.RESERVED_WORDS={};for(var c=0,b=a.length;c<b;c++){d[a[c]]=true}e.isValidJavaScriptVariableName=function(j){if(!e.RESERVED_WORDS[j]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(j)){return true}return false}})(Handlebars.Compiler,Handlebars.JavaScriptCompiler);Handlebars.precompile=function(d,c){c=c||{};var b=Handlebars.parse(d);var a=new Handlebars.Compiler().compile(b,c);return new Handlebars.JavaScriptCompiler().compile(a,c)};Handlebars.compile=function(b,a){a=a||{};var d;function c(){var g=Handlebars.parse(b);var f=new Handlebars.Compiler().compile(g,a);var e=new Handlebars.JavaScriptCompiler().compile(f,a,undefined,true);return Handlebars.template(e)}return function(f,e){if(!d){d=c()}return d.call(this,f,e)}};Handlebars.VM={template:function(a){var b={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(d,e,f){var c=this.programs[d];if(f){return Handlebars.VM.program(e,f)}else{if(c){return c}else{c=this.programs[d]=Handlebars.VM.program(e);return c}}},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(d,c){c=c||{};return a.call(b,Handlebars,d,c.helpers,c.partials,c.data)}},programWithDepth:function(b,d,c){var a=Array.prototype.slice.call(arguments,2);return function(f,e){e=e||{};return b.apply(this,[f,e.data||d].concat(a))}},program:function(a,b){return function(d,c){c=c||{};return a(d,c.data||b)}},noop:function(){return""},invokePartial:function(a,b,d,e,c){if(a===undefined){throw new Handlebars.Exception("The partial "+b+" could not be found")}else{if(a instanceof Function){return a(d,{helpers:e,partials:c})}else{if(!Handlebars.compile){throw new Handlebars.Exception("The partial "+b+" could not be compiled when running in vm mode")}else{c[b]=Handlebars.compile(a);return c[b](d,{helpers:e,partials:c})}}}}};Handlebars.template=Handlebars.VM.template;sc_require("handlebars");SC.Handlebars={};SC.Handlebars.Compiler=function(){};SC.Handlebars.Compiler.prototype=SC.beget(Handlebars.Compiler.prototype);SC.Handlebars.Compiler.prototype.compiler=SC.Handlebars.Compiler;SC.Handlebars.JavaScriptCompiler=function(){};SC.Handlebars.JavaScriptCompiler.prototype=SC.beget(Handlebars.JavaScriptCompiler.prototype);SC.Handlebars.JavaScriptCompiler.prototype.compiler=SC.Handlebars.JavaScriptCompiler;SC.Handlebars.JavaScriptCompiler.prototype.nameLookup=function(c,a,b){if(b==="context"){return"SC.get("+c+", "+this.quotedString(a)+")"}else{return Handlebars.JavaScriptCompiler.prototype.nameLookup.call(this,c,a,b)}};SC.Handlebars.Compiler.prototype.mustache=function(a){if(a.params.length||a.hash){return Handlebars.Compiler.prototype.mustache.call(this,a)}else{var b=new Handlebars.AST.IdNode(["bind"]);if(a.escaped){a.hash=a.hash||new Handlebars.AST.HashNode([]);a.hash.pairs.push(["escaped",new Handlebars.AST.StringNode("true")])}a=new Handlebars.AST.MustacheNode([b].concat([a.id]),a.hash,!a.escaped);return Handlebars.Compiler.prototype.mustache.call(this,a)}};SC.Handlebars.compile=function(e){var c=Handlebars.parse(e);var d={data:true,stringParams:true};var b=new SC.Handlebars.Compiler().compile(c,d);var a=new SC.Handlebars.JavaScriptCompiler().compile(b,d,undefined,true);return Handlebars.template(a)};Handlebars.registerHelper("helperMissing",function(c,b){var a;a="%@ Handlebars error: Could not find property '%@' on object %@.";throw a.fmt(b.data.view,c,this)});sc_require("ext/handlebars");(function(){var a=function(m,n,j,b){var e=n.data,k=n.fn,d=n.inverse,l=e.view;if(this.isObservable){var f=l.createChildView(SC._BindableSpan,{preserveContext:j,shouldDisplayFunc:b,displayTemplate:k,inverseTemplate:d,property:m,previousContext:this,tagName:(n.hash.tagName||"span"),isEscaped:n.hash.escaped});var h,g;l.get("childViews").push(f);h=function(){if(f.get("layer")){f.rerender()}else{this.removeObserver(m,g)}};g=function(){this.invokeOnce(h)};this.addObserver(m,g);var c=f.renderContext(f.get("tagName"));f.renderToContext(c);return new Handlebars.SafeString(c.join())}else{return SC.getPath(this,m)}};Handlebars.registerHelper("bind",function(c,b){return a.call(this,c,b,false,function(d){return !SC.none(d)})});Handlebars.registerHelper("boundIf",function(c,b){if(b){return a.call(this,c,b,true,function(d){if(SC.typeOf(d)===SC.T_ARRAY){if(d.length!==0){return true}return false}else{return !!d}})}else{throw"Cannot use boundIf helper without a block."}})})();Handlebars.registerHelper("with",function(b,a){return Handlebars.helpers.bind.call(a.contexts[0],b,a)});Handlebars.registerHelper("if",function(b,a){return Handlebars.helpers.boundIf.call(a.contexts[0],b,a)});Handlebars.registerHelper("unless",function(c,b){var d=b.fn,a=b.inverse;b.fn=a;b.inverse=d;return Handlebars.helpers.boundIf.call(b.contexts[0],c,b)});Handlebars.registerHelper("bindAttr",function(f){var e=f.hash;var b=f.data.view;var d=[];var c=jQuery.uuid++;var h=e["class"];if(h!=null){var a=SC.Handlebars.bindClasses(this,h,b,c);d.push('class="'+a.join(" ")+'"');delete e["class"]}var g=SC.keys(e);g.forEach(function(j){var n=e[j];var m=this.getPath(n);var l,k;l=function l(){var o=this.getPath(n);var q=b.$("[data-handlebars-id='"+c+"']");if(q.length===0){this.removeObserver(n,k);return}var p=q.attr(j);if(o===NO&&p){q.removeAttr(j)}else{if(o===YES&&p!==j){q.attr(j,j)}else{if(p!==o){q.attr(j,o)}}}};k=function(){this.invokeOnce(l)};this.addObserver(n,k);if(m===YES){m=j}if(m!==NO){if(SC.typeOf(m)===SC.T_STRING){m=m.replace(/"/g,"&quot;")}d.push(j+'="'+m+'"')}},this);d.push('data-handlebars-id="'+c+'"');return new Handlebars.SafeString(d.join(" "))});SC.Handlebars.bindClasses=function(b,h,g,a){var f=[],e,j,c;var d=function(k){var l=b.getPath(k);if(l===YES){return SC.String.dasherize(k.split(".").get("lastObject"))}else{if(l!==NO&&l!==undefined&&l!==null){return l}else{return null}}};h.split(" ").forEach(function(n){var m;var l,k;l=function(){e=d(n);c=a?g.$("[data-handlebars-id='"+a+"']"):g.$();if(c.length===0){b.removeObserver(n,k)}else{if(m){c.removeClass(m)}if(e){c.addClass(e);m=e}else{m=null}}};k=function(){this.invokeOnce(l)};b.addObserver(n,k);j=d(n);if(j){f.push(j);m=j}});return f};sc_require("ext/handlebars");Handlebars.registerHelper("collection",function(l,m){var k=m.fn;var f=m.data;var d=m.inverse;var e=m.hash;var g,a;g=l?SC.getPath(this,l)||SC.getPath(l):SC.TemplateCollectionView;var j={};if(e){var c={},h;for(var b in e){if(e.hasOwnProperty(b)){h=b.match(/^item(.)(.*)$/);if(h){c[h[1].toLowerCase()+h[2]]=e[b];delete e[b]}}}j=SC.clone(e);j.itemViewOptions=c}if(k){j.itemViewTemplate=k}if(d){j.inverseTemplate=d}if(g.isClass){a=g.extend(j)}else{a=SC.mixin(g,j)}m.fn=function(){return""};return Handlebars.helpers.view.call(this,a,m)});Handlebars.registerHelper("each",function(b,a){a.hash.contentBinding=SC.Binding.from("*"+b,this).oneWay();a.hash.itemContextProperty="content";return Handlebars.helpers.collection.call(this,null,a)});sc_require("ext/handlebars");Handlebars.registerHelper("loc",function(a){return SC.String.loc(a)});sc_require("ext/handlebars");SC.Handlebars.ViewHelper=SC.Object.create({helper:function(m,n,o){var c=o.inverse;var e=o.data;var k=e.view;var j=o.fn;var d=o.hash;var b;if(n.isClass||n.isObject){b=n;if(!b){throw"Null or undefined object was passed to the #view helper. Did you mean to pass a property path string?"}}else{if(n.charAt(0)==="."){b=SC.objectForPropertyPath(n.slice(1),k)}else{b=SC.getPath(m,n);if(!b){b=SC.getPath(n)}}if(!b){throw"Unable to find view at path '"+n+"'"}}if(d.id){d.layerId=d.id}var l={id:d.id,"class":d["class"],classBinding:d.classBinding};delete d.id;delete d["class"];delete d.classBinding;if(b.isClass){b=b.extend(d)}else{SC.mixin(b,d)}var g=e.view;var h=g.get("childViews");var f=g.createChildView(b);if(j){f.template=j}h.pushObject(f);var a=SC.RenderContext(f.get("tagName"));this.applyAttributes(l,f,a);f.applyAttributesToContext(a);f.render(a,YES);return new Handlebars.SafeString(a.join())},applyAttributes:function(a,f,b){var e=a.id;var d=a["class"];if(d){b.addClass(d.split(" "))}if(e){f.set("layerId",e);b.id(e)}var c=a.classBinding;if(c){SC.Handlebars.bindClasses(f,c,f).forEach(function(g){b.setClass(g,YES)})}}});Handlebars.registerHelper("view",function(b,a){return SC.Handlebars.ViewHelper.helper(this,b,a)});sc_require("handlebars");sc_require("ext/handlebars");sc_require("ext/handlebars/bind");sc_require("ext/handlebars/collection");sc_require("ext/handlebars/localization");sc_require("ext/handlebars/view");SC.TEMPLATES=SC.Object.create();SC.TemplateView=SC.CoreView.extend({acceptsFirstResponder:YES,templateName:null,templates:SC.TEMPLATES,template:function(b,d){if(d!==undefined){return d}var a=this.get("templateName"),c=this.get("templates").get(a);if(!c){return function(){return""}}return c}.property("templateName").cacheable(),context:function(a,b){if(b!==undefined){return b}return this}.property().cacheable(),render:function(b){var e,a,c=this.get("template"),d=this.get("context");this._didRenderChildViews=YES;e={view:this,isRenderData:true};a=c(d,{data:e});b.push(a)},update:function(){},mouseDown:function(){if(this.mouseUp){return YES}return NO}});sc_require("views/template");SC.Button=SC.TemplateView.extend(SC.ActionSupport,{classNames:["sc-button"],mouseDown:function(){this.set("isActive",true);this._isMouseDown=YES},mouseExited:function(){this.set("isActive",false)},mouseEntered:function(){if(this._isMouseDown){this.set("isActive",true)}},rootResponder:function(){var a=this.get("pane");return a.get("rootResponder")}.property("pane").cacheable(),mouseUp:function(a){if(this.get("isActive")){this.fireAction();this.set("isActive",false)}this._isMouseDown=NO},touchStart:function(a){this.mouseDown(a)},touchEnd:function(a){this.mouseUp(a)}});sc_require("views/template");SC.Checkbox=SC.TemplateView.extend({title:null,value:null,displayTitle:function(){var a=this.get("title");return a?SC.String.loc(a):null}.property("title").cacheable(),classNames:["sc-checkbox"],template:SC.Handlebars.compile('<label><input type="checkbox">{{displayTitle}}</label>'),didCreateLayer:function(){var a=this;this.$("input").bind("change",function(){a.domValueDidChange(this)})},domValueDidChange:function(a){this.set("value",$(a).prop("checked"))},value:function(a,b){if(b!==undefined){this.$("input").prop("checked",b)}else{b=this.$("input").prop("checked")}return b}.property()});SC.CheckboxSupport={didCreateLayer:function(){this.$("input").change(jQuery.proxy(function(){SC.RunLoop.begin();this.notifyPropertyChange("value");SC.RunLoop.end()},this))},value:function(a,b){if(b!==undefined){this.$("input").prop("checked",b)}else{b=this.$("input").prop("checked")}return b}.property().idempotent()};sc_require("views/template");SC.TextFieldSupport={$input:function(){return this.$("input")},_value:null,value:function(b,c){var a=this.$input();if(c!==undefined){if(this._value!==c){this._value=c}if(a.val()!==c){a.val(c)}}else{if(a.length>0){c=this._value=a.val()}else{c=this._value}}return c}.property().idempotent(),didCreateLayer:function(){var b=this.$input(),a=this;b.val(this._value);if(SC.browser.isIE){SC.Event.add(b,"focusin",this,this.focusIn);SC.Event.add(b,"focusout",this,this.focusOut)}else{SC.Event.add(b,"focus",this,this.focusIn);SC.Event.add(b,"blur",this,this.focusOut)}},willDestroyLayerMixin:function(){var a=this.$input();if(SC.browser.isIE){SC.Event.remove(a,"focusin",this,this.focusIn);SC.Event.remove(a,"focusout",this,this.focusOut)}else{SC.Event.remove(a,"focus",this,this.focusIn);SC.Event.remove(a,"blur",this,this.focusOut)}},focusIn:function(a){this.becomeFirstResponder();this.tryToPerform("focus",a)},focusOut:function(a){this.resignFirstResponder();this.tryToPerform("blur",a)},touchStart:function(a){a.allowDefault();return YES},touchEnd:function(a){a.allowDefault();return YES},willLoseFirstResponder:function(){this.notifyPropertyChange("value")},domValueDidChange:function(a){this.set("value",a.val())},keyUp:function(a){this.domValueDidChange(this.$input());if(a.keyCode===SC.Event.KEY_RETURN){return this.tryToPerform("insertNewline",a)}else{if(a.keyCode===SC.Event.KEY_ESC){return this.tryToPerform("cancel",a)}}},selectStart:function(){return true}};SC.TextField=SC.TemplateView.extend(SC.TextFieldSupport,{classNames:["sc-text-field"],isMultiline:NO,template:function(){return SC.Handlebars.compile(this.get("isMultiline")?"<textarea></textarea>":'<input type="text">')}.property("isMultiline").cacheable(),$input:function(){var a=this.get("isMultiline")?"textarea":"input";return this.$(a)}});SC.TemplatePane=SC.Object.extend({});SC.TemplatePane.mixin({append:function(a){var b=SC.MainPane.extend({childViews:["contentView"],contentView:SC.TemplateView.design(a),touchStart:function(c){c.allowDefault()},touchesDragged:function(c,d){c.allowDefault()},touchEnd:function(c){c.allowDefault()}});b=b.create().append();b.awake();return b}});sc_require("views/template");SC._BindableSpan=SC.TemplateView.extend({tagName:"span",shouldDisplayFunc:null,preserveContext:NO,displayTemplate:null,inverseTemplate:null,property:null,render:function(d){var h=this.get("isEscaped");var a=this.get("shouldDisplayFunc"),f=this.get("property"),e=this.get("preserveContext"),b=this.get("previousContext");var c=this.get("inverseTemplate"),g=this.get("displayTemplate");var j;if(f===""){j=b}else{j=b.getPath(f)}if(a(j)){this.set("template",g);if(e){this.set("context",b)}else{if(g){this.set("context",j)}else{if(j==null){j=""}else{j=String(j)}if(h){j=Handlebars.Utils.escapeExpression(j)}d.push(j);return}}}else{if(c){this.set("template",c);if(e){this.set("context",b)}else{this.set("context",j)}}else{this.set("template",function(){return""})}}return arguments.callee.base.apply(this,arguments)},rerender:function(){var b,a,e,f;e=this.get("childViews");a=e.get("length");for(b=a-1;b>=0;b--){f=e[b];f.$().remove();f.removeFromParent();f.destroy()}var c=this.renderContext(this.get("tagName"));var d;this.renderToContext(c);d=c.element();this.$().replaceWith(d);this.set("layer",d);this._notifyDidCreateLayer()}});sc_require("views/template");SC.TemplateCollectionView=SC.TemplateView.extend({tagName:"ul",content:null,template:SC.Handlebars.compile(""),emptyView:null,init:function(){var a=arguments.callee.base.apply(this,arguments);this._sctcv_contentDidChange();return a},didCreateLayer:function(){if(this._sctcv_layerCreated){return}this._sctcv_layerCreated=true;var a=this.get("content");if(a){this.arrayContentDidChange(0,0,a.get("length"))}},itemView:"SC.TemplateView",itemViewTemplate:null,itemViewTemplateName:null,inverseTemplate:function(b,d){if(d!==undefined){return d}var a=this.get("inverseTemplateName"),c=this.get("templates").get(a);if(!c){return function(){return""}}return c}.property("inverseTemplateName").cacheable(),inverseTemplateName:null,itemContext:null,itemViewClass:function(){var c=this.get("itemView");var a=this.get("itemViewTemplate");var d=this.get("itemViewTemplateName");var b={};if(SC.typeOf(c)===SC.T_STRING){c=SC.objectForPropertyPath(c)}if(!a&&d){a=this.get("templates").get(d)}if(a){b.template=a}if(c.prototype.tagName===SC.TemplateView.prototype.tagName){b.tagName=this.get("itemTagName")}return c.extend(b)}.property("itemView").cacheable(),_sctcv_contentDidChange:function(){this.$().empty();var c=this._content,a=0;var d=this.get("content"),b=0;if(c){c.removeArrayObservers({target:this,willChange:"arrayContentWillChange",didChange:"arrayContentDidChange"});a=c.get("length")}if(d){d.addArrayObservers({target:this,willChange:"arrayContentWillChange",didChange:"arrayContentDidChange"});b=d.get("length")}this.arrayContentWillChange(0,a,b);this._content=this.get("content");this.arrayContentDidChange(0,a,b)}.observes("content"),arrayContentWillChange:function(h,d,f){var c=this.get("emptyView");if(c){c.$().remove();c.removeFromParent()}var e=this.get("childViews"),g,b,a;a=e.get("length");for(b=h+d-1;b>=h;b--){g=e[b];if(g){g.$().remove();g.removeFromParent();g.destroy()}}},arrayContentDidChange:function(e,m,v){if(!this.get("layer")){return}var n=this.get("content"),f=this.get("itemViewClass"),p=this.get("childViews"),a=[],t,u,h,q,g,s,l,k,o;if(n){var j=n.slice(e,e+v);h=this.get("itemViewOptions")||{};q=this.$();g=q.find("li")[e-1]||null;o=j.get("length");var d={id:h.id,"class":h["class"],classBinding:h.classBinding};t=function(w){arguments.callee.base.apply(this,arguments);SC.Handlebars.ViewHelper.applyAttributes(d,this,w)};h=SC.clone(h);delete h.id;delete h["class"];delete h.classBinding;for(k=0;k<o;k++){s=j.objectAt(k);u=this.createChildView(f.extend(h,{content:s,render:t,tagName:h.tagName||f.prototype.tagName}));var c=u.get("contextProperty");if(c){u.set("context",u.get(c))}l=u.createLayer().$();if(!g){q.append(l)}else{l.insertAfter(g)}g=l;a.push(u)}p.replace(e,0,a)}var b=this.get("inverseTemplate");if(p.get("length")===0&&b){u=this.createChildView(SC.TemplateView.extend({template:b,content:this}));this.set("emptyView",u);u.createLayer().$().appendTo(q);this.childViews=[u]}this.invokeLast("invalidateFrame")},itemTagName:function(){switch(this.get("tagName")){case"dl":return"dt";case"ul":case"ol":return"li";case"table":case"thead":case"tbody":case"tfoot":return"tr";case"select":return"option";default:return SC.TemplateView.prototype.tagName}}.property("tagName"),invalidateFrame:function(){this.notifyPropertyChange("frame")}});
/*!
 * ==========================================================================
 * SproutCore -- JavaScript Application Framework
 * Copyright 2008-2011 Apple Inc. All rights reserved.
 * Copyright 2006-2011, Strobe Inc. and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a 
 * copy of this software and associated documentation files (the "Software"), 
 * to deal in the Software without restriction, including without limitation 
 * the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the 
 * Software is furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in 
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE 
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
 * DEALINGS IN THE SOFTWARE.
 * 
 * SproutCore and the SproutCore logo are trademarks of Strobe Inc.
 * 
 * For more information about SproutCore, visit http://www.sproutcore.com
 * 
 * ==========================================================================
 */
CW=SC.Object.create({NAMESPACE:"CW",VERSION:"1.0.0",isMobile:function(){if(SC.browser.isiPhone||SC.browser.isiPod){return true}if(SC.browser.isAndroid){return true}return false}.property().cacheable(),isiPad:function(){return SC.browser.isiPad}.property().cacheable(),isApp:function(){if(window.location.search.indexOf("phonegap=1")>=0){return true}else{return false}}.property().cacheable(),isiOSApp:function(){if(!SC.browser.isiOS){return false}if(window.location.search.indexOf("phonegap=1")>=0){return true}return false}.property().cacheable(),isAndroidApp:function(){if(!SC.browser.isAndroid){return false}if(window.location.search.indexOf("phonegap=1")>=0){return true}return false}.property().cacheable(),apps:function(){var b=window.URI.parseQuery(window.URI().query());var a;if(b.apps){return b.apps.split(",")}else{return["workflow","chat","admin"]}}.property().cacheable(),isShell:function(){if(window.location.search.indexOf("shell=1")>=0){return true}else{return false}}.property().cacheable(),});CW.mixin({upperCaseUUID:function(){return this.UUID().toString().toUpperCase()},UUID:function(){var c,f="89ab",e=[];for(c=0;c<36;c+=1){e[c]=(Math.random()*16|0).toString(16)}e[8]=e[13]=e[18]=e[23]="-";e[14]="4";e[19]=f.charAt(Math.random()*4|0);return e.join("")},invertArray:function(h){if(!h){CW.fatalError("invertArray():  You must specify an array to invert")}var k,g,j,f={};for(k=0,g=h.length;k<g;++k){j=h[k];f[j]=true}return f},invertArrayWithOrder:function(h){if(!h){CW.fatalError("invertArrayWithOrder():  You must specify an array to invert")}var k,g,j,f={};for(k=0,g=h.length;k<g;++k){j=h[k];f[j]=k}return f},invertHash:function(h,f){if(!h){CW.fatalError("invertHash():  You must specify an hash to invert")}var k,j,g=[];if(f){for(k in h){j=h[k];if(j){g.push(parseInt(k,10))}}}else{for(k in h){j=h[k];if(j){g.push(k)}}}return g},combineHashes:function(g,h){var f=SC.clone(g),e;for(e in h){f[e]=h[e]}return f},hashDifferencesBreakdown:function(F,G,x){if(!F||!G){CW.fatalError("hashDifferencesBreakdown() must be called with two hashes")}if(F===G){CW.fatalError("hashDifferencesBreakdown() must be called with two different hashes")}var y=[],I=[],s=[],H=[];var w,t,D,C;if(x){w=this.invertArray(x)}var J=CW.getSimpleTypes(),u={},z,B,v,E;for(t in F){u[t]=true;if(w&&w[t]){continue}z=F[t];B=G[t];if(B===undefined){s.push(t)}else{v=(z===B);if(!v){E=SC.typeOf(z);if(J[E]){v=false}else{v=CW.valuesAreEqual(z,B,E)}}if(v){y.push(t)}else{I.push(t)}}}for(t in G){if(!u[t]){H.push(t)}}return{equal:y,different:I,firstHashOnly:s,secondHashOnly:H}},valuesAreEqual:function(s,t,v,x){if(s===t){return true}if(!v){v=SC.typeOf(s)}var C=CW.getSimpleTypes();if(C[v]){return false}else{if(!x){x=SC.typeOf(t)}if(v!==x){return false}else{if(v===SC.T_DATE){return s.getTime()===t.getTime()}else{if(v===SC.T_REGEXP){return s.toString()===t.toString()}else{if(v===SC.T_HASH){var B=0,o,p,q,u;for(o in s){++B;p=s[o];q=t[o];if(p!==q){u=SC.typeOf(p);if(C[u]){return false}else{if(!CW.valuesAreEqual(p,q,u)){return false}}}}for(o in t){--B}return(B===0)}else{if(v===SC.T_ARRAY){var y=s.length;var z=t.length;if(y!==z){return false}for(var w=(y-1);w>=0;--w){p=s[w];q=t[w];if(p!==q){u=SC.typeOf(p);if(C[u]){return false}else{if(!CW.valuesAreEqual(p,q,u)){return false}}}}return true}else{CW.fatalError("Unsupported type for CW.valuesAreEqual:  '%@'".fmt(v))}}}}}}},getSimpleTypes:function(){var b=CW._simpleTypes;if(!b){b=CW._simpleTypes={};b[SC.T_STRING]=true;b[SC.T_NUMBER]=true;b[SC.T_BOOL]=true;b[SC.T_UNDEFINED]=true;b[SC.T_NULL]=true}return b},getUrlParameters:function(c){if(!c){c=location.search}var d=new URI.parse(c);return d.query?URI.parseQuery(d.query):{}},escapeRegexCharacters:function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")},formatNumber:function(o,j,k){if(SC.none(o)){return""}if(!j){j=","}if(!k){k="."}o=o.toString();var m=o.split("."),n=m[0],l=m[1],p=/(\d+?)(?=(?:\d{3})+$)/g,q="$1"+j;n=n.replace(p,q);if(l){return n+k+l}else{return n}},preloadTargetImages:function(f){if(SC.APP_IMAGE_ASSETS){for(var d=0,e=SC.APP_IMAGE_ASSETS.length;d<e;d++){if(!f||SC.APP_IMAGE_ASSETS[d].indexOf(f)!==-1){SC.imageQueue.loadImage(SC.APP_IMAGE_ASSETS[d])}}}}});SC.ready(function(){setTimeout(function(){CW.preloadTargetImages()},2000)});sc_require("core");sc_require("system/utils");CW.mixin({fatalError:function(f,e){var g=this.recordStack(YES,YES),h;if(f instanceof Error){h=f}else{h=new Error(f)}if(e){SC.mixin(h,e)}h.recordedStack=g;throw h},recordStack:function(C,D){if(D||!this.get("hasSymbolicated")){try{this.symbolicate()}catch(w){}}var t=arguments.callee,B=t?t.caller:null,x=0,s=[],E={},u,v,j,z,y,e;if(B&&C){B=B.caller}while(B&&x<26){u=B.displayName;if(!u){u=B.name}if(!u){u=B.toString()}if(u.length>150){u=u.substring(0,150)}j={func:u};v=B["arguments"];if(v){z=[];for(y=0;y<5;++y){e=v[y];if(e){if(e.toString){e=e.toString()}else{e="(argument without .toString() method)"}}z.push(e)}j.args=z}s[x++]=j;if(E[u]){s[x++]="(Because "+u+" was called recursively, no more of the stack is available)";break}E[u]=true;B=B.caller}return s},hasSymbolicated:NO,namespacesToSymbolicate:["SC"],symbolicate:function(){if(!SC.Object.toString()){SC.warn("Cannot yet properly symbolicate because SproutCore is not yet in a position to provide class names");return}if(!this.hasSymbolicated){this.hasSymbolicated=true}if(!SC||!SC.typeOf){return}this._symbolicateClassAndSubclasses(SC.Object);var C=this.namespacesToSymbolicate,B=CW.invertArray(C),q,s,z,p,y,x,u,v,e,t;if(!C){return}for(q in window){if(B[q]){continue}s=q.charAt(0);if(s.toUpperCase()===s){try{u=window[q];if(u&&u.isObject){C.push(q)}}catch(w){}}}for(y=0,x=C.length;y<x;++y){z=C[y];p=window[z];for(q in p){if(!p.hasOwnProperty(q)){continue}u=p[q];if(!u){continue}if(u instanceof Function){if(!u.displayName){v=z+"."+q;u.displayName=v}}else{if(u instanceof Object&&!u.isClass){for(e in u){if(!u.hasOwnProperty(e)){continue}t=u[e];if(t instanceof Function){if(!t.displayName){v=z+"."+q+"."+e;t.displayName=v}}}}}}}},_symbolicateClassAndSubclasses:function(k){var m=k.toString(),n,l,q,o,p,j;if(!m){return}for(n in k){if(!k.hasOwnProperty(n)){continue}l=k[n];if(l instanceof Function){if(!l.displayName){q=m+"."+n;l.displayName=q}}}o=k.prototype;for(n in o){if(!o.hasOwnProperty(n)){continue}l=o[n];if(l instanceof Function){if(!l.displayName){q=m+"#"+n;l.displayName=q}}}p=k.subclasses;for(n in p){j=p[n];if(j&&j.isClass){this._symbolicateClassAndSubclasses(j)}}}});CW.mixin({encodeBase64:function(x){var B=this._b64,w=0,p=0,y="",z=[],C,D,E,s,t,u,v,q;if(!x){return x}x=this.encodeUTF8(x+"");do{C=x.charCodeAt(w++);D=x.charCodeAt(w++);E=x.charCodeAt(w++);q=C<<16|D<<8|E;s=q>>18&63;t=q>>12&63;u=q>>6&63;v=q&63;z[p++]=B.charAt(s)+B.charAt(t)+B.charAt(u)+B.charAt(v)}while(w<x.length);y=z.join("");switch(x.length%3){case 1:y=y.slice(0,-2)+"==";break;case 2:y=y.slice(0,-1)+"=";break}return y},decodeBase64:function(u){var x="",v=0,w=this._b64,m,o,q,n,p,s,t;u=u.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(v<u.length){n=w.indexOf(u.charAt(v++));p=w.indexOf(u.charAt(v++));s=w.indexOf(u.charAt(v++));t=w.indexOf(u.charAt(v++));m=(n<<2)|(p>>4);o=((p&15)<<4)|(s>>2);q=((s&3)<<6)|t;x+=String.fromCharCode(m);if(s!==64){x+=String.fromCharCode(o)}if(t!==64){x+=String.fromCharCode(q)}}x=this.decodeUTF8(x);return x},encodeUTF8:function(k){k=k.replace(/\r\n/g,"\n");var c="",j,g,h;for(j=0,g=k.length;j<g;++j){h=k.charCodeAt(j);if(h<128){c+=String.fromCharCode(h)}else{if((h>127)&&(h<2048)){c+=String.fromCharCode((h>>6)|192);c+=String.fromCharCode((h&63)|128)}else{c+=String.fromCharCode((h>>12)|224);c+=String.fromCharCode(((h>>6)&63)|128);c+=String.fromCharCode((h&63)|128)}}}return c},decodeUTF8:function(j){var o="",m=0,k,l,n,c;k=l=n=c=0;while(m<j.length){k=j.charCodeAt(m);if(k<128){o+=String.fromCharCode(k);m++}else{if((k>191)&&(k<224)){n=j.charCodeAt(m+1);o+=String.fromCharCode(((k&31)<<6)|(n&63));m+=2}else{n=j.charCodeAt(m+1);c=j.charCodeAt(m+2);o+=String.fromCharCode(((k&15)<<12)|((n&63)<<6)|(c&63));m+=3}}}return o},_b64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="});(function(){var B,q="",x,o,z;String.cssWidthData={};var y=String.cssWidthData;var w=function w(){if(!o.parentNode){document.body.appendChild(o)}};String.removeWidthContainer=function(){if(o.parentNode){document.body.removeChild(o)}};var C=String.removeWidthContainer;String.prototype.calculatedWidth=function p(a,b){if(a===undefined){a=""}if(a!==q){q=a;B.style.cssText=a||""}w();B.innerHTML=(function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}).apply(this);return B.offsetWidth};String.prototype.cachedWidth=function u(b,c){var a=b||"nocss";if(!c){c=y[a]}if(!c){y[a]=c={}}var e=c[this];if(e!==undefined){return e}var d;c[this]=d=this.calculatedWidth(b,c);return d};String.prototype.truncateMiddle=function t(b,c){if(b>=this.length){return this}if(c===undefined){c=""}var a=Math.floor(b)/2;return this.substring(0,a)+c+this.substring(this.length-(b-a))};String.prototype.truncateEnd=function s(a,b){if(a>=this.length){return this}if(b===undefined){b=""}return this.substring(0,(a-b.length))+b};String.prototype.truncateStart=function s(a,b){if(a>=this.length){return this}if(b===undefined){b=""}return this.substring(b+(a-b.length),a)};String.prototype.truncateToWidth=function v(d,e,E,c){var k=0;var g,l,a,h=undefined,n=undefined,j=0,b,f,m;if(!(c instanceof Function)){c=String.prototype.truncateEnd}b=d/"i".cachedWidth(E);j=d/"W".cachedWidth(E);f=this.calculatedWidth(E);a=g=this;m=f<d;while(!m){k++;if((j===h&&b===n)||f==d){m=true;continue}h=j;n=b;l=Math.floor((j+b)/2);a=c.call(g,l,e);f=a.calculatedWidth(E);if(f<d){j=l}else{b=l}}return a};B=String.wcon=document.createElement("span");if(!SC.browser.isIE){x=document.createElement("div");x.style.position="absolute";x.style.left="-1000px";x.style.top="-1000px";x.style.visibility="hidden";x.appendChild(B)}if(SC.browser.isIE){o=B}else{o=x}})();CW.ButtonKeyHandlingHelpers={isDefault:NO,isCancel:NO,keyHandlersDidChange:function(){var e=null,f=this.get("isDefault"),d=this.get("isCancel");if(f){this.registerKeyboardShortcut("return",this,this.triggerActionFromKeyboardShortcut)}else{this.deregisterKeyboardShortcut("return")}if(d){this.registerKeyboardShortcut("escape",this,this.triggerActionFromKeyboardShortcut)}else{this.deregisterKeyboardShortcut("escape")}}.observes("isDefault","isCancel"),initMixin:function(){if(this.get("isDefault")){this.registerKeyboardShortcut("return",this,this.triggerActionFromKeyboardShortcut)}if(this.get("isCancel")){this.registerKeyboardShortcut("escape",this,this.triggerActionFromKeyboardShortcut)}},triggerActionFromKeyboardShortcut:function(b){this.triggerAction();return YES}};SC.time=function(d){var c=SC.beget(fn);c.value=d;return c};(function(){var b=new Date();SC.mixin(SC.time,{month:function(d,a){b.setTime(d);if(a===undefined){return b.getMonth()}b.setMonth(a);return b.getTime()},utc:function(a){b.setTime(a);return a+(b.getTimezoneOffset()*60*1000)},local:function(a){b.setTime(a);return a-(b.getTimezoneOffset()*60*1000)},parse:function(a){},format:function(a){}})})();SC.time.fmt=SC.time.format;SC.time.fn={done:function(){return this.value}};"month day year".split(" ").forEach(function(b){SC.time.fn[b]=function(a){if(a===undefined){return SC.time[b](this.value)}else{this.value=SC.time[b](this.value,a);return this}}});var MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function LZ(b){return(b<0||b>9?"":"0")+b}SC.Locale.define("en",{longMonthNames:"January February March April May".split(" "),shortMonthNames:[],shortDateFormat:"dd/mm/yy",longDateFormat:""});SC.mixin(Date,{isDate:function(f,d){var e=Date.getDateFromFormat(f,d);if(e===0){return false}return true},compareDates:function(k,j,m,l){var g=Date.getDateFromFormat(k,j);var h=Date.getDateFromFormat(m,l);if(g===0||h===0){return -1}else{if(g>h){return 1}}return 0},getDateFromFormat:function(c,F){c=c+"";F=F+"";var x=0;var K=0;var D="";var P="";var y="";var N,O;var S=new Date();var M=S.getFullYear();var B=S.getMonth()+1;var C=1;var R=S.getHours();var E=S.getMinutes();var I=S.getSeconds();var L="";var H=SC.Locale.currentLocale;while(K<F.length){D=F.charAt(K);P="";while((F.charAt(K)==D)&&(K<F.length)){P+=F.charAt(K++)}if(P==="yyyy"||P==="yy"||P==="y"){if(P==="yyyy"){N=4;O=4}if(P==="yy"){N=2;O=2}if(P==="y"){N=2;O=4}M=Date._getInt(c,x,N,O);if(M===null){return 0}x+=M.length;if(M.length===2){if(M>70){M=1900+(M-0)}else{M=2000+(M-0)}}}else{if(P==="MMM"||P==="NNN"){B=0;for(var G=0;G<MONTH_NAMES.length;G++){var Q=MONTH_NAMES[G];if(c.substring(x,x+Q.length).toLowerCase()==Q.toLowerCase()){if(P==="MMM"||(P==="NNN"&&G>11)){B=G+1;if(B>12){B-=12}x+=Q.length;break}}}if((B<1)||(B>12)){return 0}}else{if(P==="EE"||P==="E"){for(G=0;G<DAY_NAMES.length;G++){var J=DAY_NAMES[G];if(c.substring(x,x+J.length).toLowerCase()==J.toLowerCase()){x+=J.length;break}}}else{if(P==="MM"||P==="M"){B=Date._getInt(c,x,P.length,2);if(B===null||(B<1)||(B>12)){return 0}x+=B.length}else{if(P==="dd"||P==="d"){C=Date._getInt(c,x,P.length,2);if(C===null||(C<1)||(C>31)){return 0}x+=C.length}else{if(P==="hh"||P==="h"){R=Date._getInt(c,x,P.length,2);if(R===null||(R<1)||(R>12)){return 0}x+=R.length}else{if(P==="HH"||P==="H"){R=Date._getInt(c,x,P.length,2);if(R===null||(R<0)||(R>23)){return 0}x+=R.length}else{if(P==="KK"||P==="K"){R=Date._getInt(c,x,P.length,2);if(R===null||(R<0)||(R>11)){return 0}x+=R.length}else{if(P==="kk"||P==="k"){R=Date._getInt(c,x,P.length,2);if(R===null||(R<1)||(R>24)){return 0}x+=R.length;R--}else{if(P==="mm"||P==="m"){E=Date._getInt(c,x,P.length,2);if(E===null||(E<0)||(E>59)){return 0}x+=E.length}else{if(P==="ss"||P==="s"){I=Date._getInt(c,x,P.length,2);if(I===null||(I<0)||(I>59)){return 0}x+=I.length}else{if(P==="a"){if(c.substring(x,x+2).toLowerCase()==="am"){L="AM"}else{if(c.substring(x,x+2).toLowerCase()==="pm"){L="PM"}else{return 0}}x+=2}else{if(c.substring(x,x+P.length)!=P){return 0}else{x+=P.length}}}}}}}}}}}}}}if(x!==c.length){return 0}if(B===2){if(((M%4===0)&&(M%100!==0))||(M%400===0)){if(C>29){return 0}}else{if(C>28){return 0}}}if((B===4)||(B===6)||(B===9)||(B===11)){if(C>30){return 0}}if(R<12&&L=="PM"){R=R-0+12}else{if(R>11&&L=="AM"){R-=12}}var T=new Date(M,B-1,C,R,E,I);return T.getTime()},parseDate:function(s){var n=(arguments.length==2)?arguments[1]:false,j=["E NNN dd HH:mm:ss UTC yyyy","y-M-d","y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d","d MMM y","d.MMM.y","y MMM d","y.MMM.d"],p=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"],d=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"],q=n?j.concat(d,p):j.concat(p,d),m=null;m=0;var t=new Date().getTime();switch(s.toLowerCase()){case SC.String.loc("yesterday"):m=t-(24*60*60*1000);break;case SC.String.loc("today"):case SC.String.loc("now"):m=t;break;case SC.String.loc("tomorrow"):m=t+(24*60*60*1000);break}if(m>0){return new Date(m)}for(var o=0;o<q.length;o++){m=Date.getDateFromFormat(s,q[o]);if(m===0){m=Date.getDateFromFormat(s,q[o]+" H:m:s")}if(m===0){m=Date.getDateFromFormat(s,q[o]+" h:m:s a")}if(m!==0){return new Date(m)}}return null},_isInteger:function(f){var d="1234567890";for(var e=0;e<f.length;e++){if(d.indexOf(f.charAt(e))==-1){return false}}return true},_getInt:function(j,l,k,m){for(var h=m;h>=k;h--){var g=j.substring(l,l+h);if(g.length<k){return null}if(Date._isInteger(g)){return g}}return null}});SC.mixin(Date.prototype,{format:function(K){K=K+"";var k=this;var aa="";var H=0;var s="";var ae="";var ab=k.getFullYear()+"";var ad=k.getMonth()+1;var E=k.getDate();var Y=k.getDay();var Z=k.getHours();var m=k.getMinutes();var V=k.getSeconds();var R,M,ag,S,h,af,Q,T,X,W,c,d,ac,ah,U;var y={};if(ab.length<4){ab=""+(ab-0+1900)}y.y=""+ab;y.yyyy=ab;y.yy=ab.substring(2,4);y.M=ad;y.MM=LZ(ad);y.MMM=MONTH_NAMES[ad-1];y.NNN=MONTH_NAMES[ad+11];y.d=E;y.dd=LZ(E);y.E=DAY_NAMES[Y+7];y.EE=DAY_NAMES[Y];y.H=Z;y.HH=LZ(Z);if(Z===0){y.h=12}else{if(Z>12){y.h=Z-12}else{y.h=Z}}y.hh=LZ(y.h);if(Z>11){y.K=Z-12}else{y.K=Z}y.k=Z+1;y.KK=LZ(y.K);y.kk=LZ(y.k);if(Z>11){y.a="PM"}else{y.a="AM"}y.m=m;y.mm=LZ(m);y.s=V;y.ss=LZ(V);while(H<K.length){s=K.charAt(H);ae="";while((K.charAt(H)==s)&&(H<K.length)){ae+=K.charAt(H++)}if(!SC.none(y[ae])){aa=aa+y[ae]}else{aa=aa+ae}}return aa},utcFormat:function(){var b=new Date(this.getTime()+(this.getTimezoneOffset()*60*1000));return b.format("E NNN dd HH:mm:ss UTC yyyy")}});sc_require("core");CW.DATE_ONLY=0;CW.DATE_TIME=1;CW.DATE_TIME_TO_MIDNIGHT=3;CW.DATE_TIME_SEC=4;CW.DAY_MIN_DUR=1440;CW.DAY_MILLIS_DUR=86400000;CW.Date={value:null,dateType:CW.DATE_ONLY,timeFormat:null,fullDateFormat:null,dateFormat:null,_dateObj:null,_timezoneOffset:0,incrementSeconds:function(b){this.seconds(this.seconds()+b);return this},incrementMinutes:function(b){this.minutes(this.minutes()+b);return this},incrementHours:function(b){this.hours(this.hours()+b);return this},incrementDate:function(b){this.date(this.date()+b);return this},incrementMonth:function(b){this.month(this.month()+b);return this},incrementYear:function(b){this.year(this.year()+b);return this},now:function(){this._dateObj=new Date();var d=this._dateObj.getTime(),c=this._dateObj.getTimezoneOffset()*60000;this._dateObj.setTime(d-c);this._dateObj._isUsingUTC=true;this._dateComponentDidChange();return this},dateComponent:function(){var b=this.value;return b?b[0]:null},date:function(b){if(b!==undefined){this._dateObj.setUTCDate(b);return this._dateComponentDidChange()}else{return this.value[3]}},dateObject:function(){return this._dateObj},day:function(){return this._dateObj.getUTCDay()},fullYear:function(b){if(b!==undefined){this._dateObj.setUTCFullYear(b);return this._dateComponentDidChange()}else{return this.value[1]}},hours:function(b){if(b!==undefined){this._dateObj.setUTCHours(b);return this._dateComponentDidChange()}else{return this.value[4]}},minutes:function(b){if(b!==undefined){this._dateObj.setUTCMinutes(b);return this._dateComponentDidChange()}else{return this.value[5]}},seconds:function(b){if(this.dateType===CW.DATE_TIME_SEC){if(b!==undefined){this._dateObj.setUTCSeconds(b);return this._dateComponentDidChange()}else{return this.value[6]}}return 0},month:function(b){if(b!==undefined){this._dateObj.setUTCMonth(b);return this._dateComponentDidChange()}else{return this._dateObj.getUTCMonth()}},time:function(b){if(b!==undefined){this._dateObj.setTime(b);return this._dateComponentDidChange()}else{return this._dateObj.getTime()}},timezoneOffset:function(b){if(b!==undefined){this.set("_timezoneOffset",b);return this._dateComponentDidChange()}else{return this.get("_timezoneOffset")}},year:function(b){return this.fullYear(b)},changeDateType:function(b){if(b===this.dateType){return this}if(b===CW.DATE_ONLY||b===CW.DATE_TIME||b===CW.DATE_TIME_TO_MIDNIGHT||b===CW.DATE_TIME_SEC){this.dateType=b;this._dateComponentDidChange()}else{CW.fatalError("You must provide a valid date type.")}return this},weekNumber:function(t){t=(t?t:this._dateObj);var s=new Date(t.getUTCFullYear(),0,1),o=1,m=s.getUTCDay()-o,l=Math.floor((t.getTime()-s.getTime())/CW.DAY_MILLIS_DUR)+1,v,p,u,q,n;m=m>=0?m:m+7;if(m<4){v=Math.floor((l+m-1)/7)+1;if(v>52){p=new Date(t.getUTCFullYear()+1,0,1);u=p.getUTCDay()-o;u=u>=0?u:u+7;v=u<4?1:53}}else{q=Math.floor((l+m-1)/7);v=q===0?53:q}n=t.getUTCFullYear();if(v===53&&t.getUTCMonth()===0){n--}else{if(v===1&&t.getUTCMonth()===11){n++}}return[n,v]},weekNumberToDate:function(p,o){p=parseInt(p,0);o=parseInt(o,0);var l=new Date(o,0,10,12,0,0);var j=new Date(o,0,4,12,0,0);var m=new Date(j.getTime()-l.getUTCDay()*CW.DAY_MILLIS_DUR);var k=new Date(m.getTime()+(p-1)*604800000);var n=new Date(k.getTime()+518400000);var q=[k,n];return q},dateRangeOfWeek:function(){var k=this._dateObj;var g=k.getUTCDay(),f;if(g===0){f=6}else{f=g+1}var h=new Date(k.valueOf());h.setDate(k.getUTCDate()-f);var j=new Date(k.valueOf());j.setDate(k.getUTCDate()+(7-k.getUTCDay()));return[h,j]},daysInMonth:function(){var f=this.year(),e=this.month(),d=[31,28,31,30,31,30,31,31,30,31,30,31];return(e===1&&((f%4===0&&f%100!==0)||f%400===0))?29:d[e]},toTimeString:function(b){if(b){return this.format(b)}else{if(this.timeFormat){return this.format(this.timeFormat)}}return this._dateObj.toString().substr(16,5)},toString:function(c){if(c){return this.format(c)}else{if(this.fullDateFormat){return this.format(this.fullDateFormat)}else{var d=this._dateObj;if(d){return d.toString()}else{return"null"}}}},toDateString:function(b){if(b){return this.format(b)}else{if(this.dateFormat){return this.format(this.dateFormat)}}return this._dateObj.toString().substr(0,15)},parse:function(d){var c=this._dateObj;if(SC.typeOf(d)===SC.T_ARRAY){if(!isNaN(d[3])){c.setUTCDate(d[3])}if(!isNaN(d[1])){c.setUTCFullYear(d[1])}if(!isNaN(d[2])){c.setUTCMonth(d[2]-1)}if(!isNaN(d[3])&&d[3]!==c.getUTCDate()){c.setUTCDate(d[3])}if(this.dateType===CW.DATE_ONLY){c.setUTCHours(12);c.setUTCMinutes(0)}else{if(!isNaN(d[4])){c.setUTCHours(d[4])}if(!isNaN(d[5])){c.setUTCMinutes(d[5])}if(this.dateType===CW.DATE_TIME_SEC){if(!isNaN(d[6])){c.setUTCSeconds(d[6])}}}}else{if(d&&d.getTime){if(d._isUsingUTC){c.setUTCFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate());c.setUTCHours(d.getUTCHours());c.setUTCMinutes(d.getUTCMinutes());if(this.dateType===CW.DATE_TIME_SEC){c.setUTCSeconds(d.getUTCSeconds())}}else{c.setUTCFullYear(d.getFullYear(),d.getMonth(),d.getDate());c.setUTCHours(d.getHours());c.setUTCMinutes(d.getMinutes());if(this.dateType===CW.DATE_TIME_SEC){c.setUTCSeconds(d.getSeconds())}}}}if(this.dateType!==CW.DATE_TIME_SEC){c.setUTCSeconds(0)}c.setUTCMilliseconds(0);c._isUsingUTC=true;this._dateObj=c;this._dateComponentDidChange();return this},format:function(M,K){M+="";if(K){M=M.loc()}var m=this._dateObj,U=this.value||{},ab=M.length,ai="",V=0,s="",am="",aj=U[1]+"",al=U[2],E=U[3],ag=m.getUTCDay(),ah=U[4],H=U[5],ad=m.getUTCSeconds(),Z,X,ao,aa,k,an,W,Y,af,ae,d,h,ak,ap,ac,c,y;if(aj.length<3){if(aj>=0&&aj<=28){aj=""+(aj+2000)}else{if(aj>=28&&aj<=99){aj=""+(aj+1900)}}}U.y=""+aj;U.yyyy=aj;U.yy=aj.substring(2,4);U.M=al;U.MM=LZ(al);U.MMM=MONTH_NAMES[al-1];U.NNN=MONTH_NAMES[al+11];U.d=E;U.dd=LZ(E);U.E=DAY_NAMES[ag+7];U.EE=DAY_NAMES[ag];U.H=ah;U.HH=LZ(ah);if(ah===0){U.h=12}else{if(ah>12){U.h=ah-12}else{U.h=ah}}U.hh=LZ(U.h);if(ah>11){U.K=ah-12}else{U.K=ah}U.k=ah+1;U.KK=LZ(U.K);U.kk=LZ(U.k);if(ah>11){U.a="SC.Date.Period.PM".loc()}else{U.a="SC.Date.Period.AM".loc()}U.m=H;U.mm=LZ(H);U.s=ad;U.ss=LZ(ad);while(V<ab){s=M.charAt(V);am="";while((M.charAt(V)==s)&&(V<ab)){am+=M.charAt(V++)}c=U[am];if(!SC.none(c)){y=c.toString().loc();ai+=y?y:c}else{ai+=am}}return ai},done:function(){if(CW.Date._pool.indexOf(this)===-1){CW.Date._pool.push(this)}this.timeFormat=this.fullTimeFormat=this.dateFormat=null;return SC.clone(this.value)},components:function(){return SC.clone(this.value)},clone:function(b){return CW.Date.create(SC.clone(this.value),(b)?b:this.dateType)},setValue:function(b){this.value=SC.clone(b);this._dateComponentDidChange()},_dateComponentDidChange:function(){var d=[0,0,0,0,0,0,0];var c=this._dateObj;d[1]=c.getUTCFullYear();d[2]=c.getUTCMonth()+1;d[3]=c.getUTCDate();d[0]=parseInt(d[1]+((d[2]<10)?"0":"")+d[2]+((d[3]<10)?"0":"")+d[3],0);if(this.dateType!==CW.DATE_ONLY){d[4]=c.getUTCHours();d[5]=c.getUTCMinutes();if(this.dateType===CW.DATE_TIME_SEC){d[6]=c.getUTCSeconds()}else{d[6]=(this.dateType===CW.DATE_TIME_TO_MIDNIGHT)?CW.DAY_MIN_DUR-(d[4]*60+d[5]):d[4]*60+d[5]}}this.value=d;return this}};SC.mixin(CW.Date,{_pool:[],parseDate:function(e,d){var f=new Date();if(SC.typeOf(e)!==SC.T_ARRAY){return f}f.setUTCFullYear(e[1]);f.setUTCMonth(e[2]);f.setUTCDate(e[3]);if(!d){f.setUTCHours(e[4]);f.setUTCMinutes(e[5])}f.setUTCSeconds(0);f.setUTCMilliseconds(0);return f},dateComponentsEqual:function(a,b){if(SC.typeOf(a)!==SC.T_ARRAY&&SC.typeOf(b)===SC.T_ARRAY){return NO}else{return(a[0]===b[0])}},datesEqual:function(b,h){if(b===h){return YES}var g=SC.typeOf(b),a=SC.typeOf(h);if(g!==a){return NO}else{return(b.value[0]===h.value[0])}},dateTimesEqual:function(a,b){if(SC.typeOf(a)!==SC.T_ARRAY&&SC.typeOf(b)===SC.T_ARRAY){return NO}else{return(a[0]===b[0]&&a[4]===b[4]&&a[5]===b[5])}},create:function(f,d){var e;if(CW.Date._pool.length>0){e=CW.Date._pool.pop();e.value=null;e.dateType=CW.DATE_ONLY}else{e=SC.beget(CW.Date)}e._dateObj=new Date();e._dateObj._isUsingUTC=true;if(f&&SC.typeOf(f)===SC.T_NUMBER){d=f;f=null}if(d!==undefined){e.dateType=d}e.parse(f);return e},createFromDateObject:function(f,d){var e;if(SC.typeOf(f)===SC.T_HASH){if(CW.Date._pool.length>0){e=CW.Date._pool.pop();e.value=null;e.dateType=CW.DATE_ONLY}else{e=SC.beget(CW.Date)}e._dateObj=f;e.dateType=d||CW.DATE_ONLY}},createFromDateComponent:function(m){if(!m){CW.fatalError("createFromDateComponent():  No date component was specified")}var l=Math.floor(m/10000),j=Math.floor(m/100)-(l*100),h=m-(l*10000)-(j*100),k=[m,l,j,h],g=CW.Date.create(k,CW.DATE_ONLY);return g},areDatesInRange:function(f,g,h,e){if(!f||!g){return NO}if(g[0]===h[0]&&g[6]===1440){return NO}return((f[0]>=h[0]&&f[0]<=e[0])||(g[0]>=h[0]&&g[0]<=e[0])||(f[0]<=h[0]&&g[0]>=e[0]))},compareDates:function(m,h,j){if(!m||!h){return m||h}var k,l,n,o;k=m._dateObj?m.components():m;l=h._dateObj?h.components():h;if(k[0]<l[0]){return(j?h:m)}else{if(k[0]===l[0]){n=k[4]*60+k[5];o=l[4]*60+l[5];if(n<o){return(j?h:m)}else{if(n>o){return(j?m:h)}else{return null}}}else{return(j?m:h)}}},greaterThan:function(f,d){if(SC.typeOf(f)===SC.T_ARRAY){f=CW.Date.create(f)}if(SC.typeOf(d)===SC.T_ARRAY){d=CW.Date.create(d)}var e=this.compareDates(f,d,YES);if(e===f){return YES}else{return NO}}});CW.DateFormatter=function(e,g){var f=e.dateObject(),h=new Date(f.getTime());if(f._isUsingUTC){h.setMinutes(h.getMinutes()+h.getTimezoneOffset())}return SC.DateFormatter(h,g)};CW.DateParser={parseDate:function(N,ab,L,Z){var ac,c,Q,M,J,R,T,K,ae,V,ad,P,ag,ah,U,I,O=["Sunday".loc().toLowerCase(),"Monday".loc().toLowerCase(),"Tuesday".loc().toLowerCase(),"Wednesday".loc().toLowerCase(),"Thursday".loc().toLowerCase(),"Friday".loc().toLowerCase()],b=N.toLowerCase(),S,a,W,Y,aa,af=SC.Locale.currentLocale.language,X;if(!isNaN(N)&&parseInt(N,10)>31){ac=CW.Date.create(ab);I=N.length;if(I===2){if(!L){c=parseInt(N.charAt(0),10)-1;Q=parseInt(N.charAt(1),10)}else{c=parseInt(N.charAt(1),10)-1;Q=parseInt(N.charAt(0),10)}M=new Date().getFullYear()}else{if(I===3){P=N;J=parseInt(N.charAt(0),10);K=parseInt(N.substr(0,2),10);ae=parseInt(N.substr(1,2),10);T=parseInt(N.charAt(2),10);if(!L){c=(K<=12)?(K-1):(J-1);Q=(K<=12)?T:ae}else{c=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}M=new Date().getFullYear()}else{if(I===4){ag=N;J=parseInt(N.charAt(0),10);K=parseInt(N.substr(0,2),10);V=parseInt(N.substr(2,2),10);R=parseInt(N.charAt(1),10);if(!L){c=(K<=12&&V<=31)?(K-1):(J-1);Q=(K<=12&&V<=31)?V:R;M=(K<=12&&V<=31)?new Date().getFullYear():2000+V}else{c=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}}else{if(I===5){ah=parseInt(N,10).toString();J=parseInt(N.charAt(0),10);K=parseInt(N.substr(0,2),10);ae=parseInt(N.substr(1,2),10);U=parseInt(N.substr(3,2),10);T=parseInt(N.substr(2,1),10);if(!L){c=(K<=12)?(K-1):(J-1);Q=(K<=12)?T:ae}else{c=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}M=2000+U}else{if(I>=6&&I<=8){K=parseInt(N.substr(0,2),10);V=parseInt(N.substr(2,2),10);T=parseInt(N.charAt(2),10);U=parseInt(N.substr(3,2),10);ad=parseInt(N.substr(4),10);if(!(I===6&&V===20)&&!(I===7&&U===20)){c=(K<=12)?(K-1):((V<=12&&K>=1&&K<=31)?(V-1):-1);Q=(V>=1&&V<=31&&c===(K-1))?V:((K>=1&&K<=31&&c===(V-1))?K:-1);M=I>6?ad:2000+ad}else{if(I===6&&V===20){if(!L){c=J-1;Q=R}else{c=R-1;Q=J}}else{if(I===7&&U===20){if(!L){c=(K<=12)?(K-1):(J-1);Q=(K<=12)?T:ae}else{c=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}}}}}}}}}if(c<0||c>=12||Q<1||Q>31||M<0){ac=null}else{ac._dateObj.set({month:c,day:Q,year:M});ac._dateComponentDidChange()}}else{if(!isNaN(N)&&(X=parseInt(N,10))<31&&X<31){ac=CW.Date.create();ac._dateObj=Date.parse(N);ac._dateComponentDidChange()}}return ac}};CW.FakeReply=SC.Object.extend({isFakeReply:YES,shouldProcessRequestNormally:NO,applyToBackgroundRequests:NO,status:undefined,statusText:undefined,responseText:undefined,urlFilter:undefined,delay:undefined,readyState:undefined,getAllResponseHeaders:function(){return null},abort:function(){},toString:function(){if(this.get("shouldProcessRequestNormally")){return"will be sent normally"}else{var l=[],m=CW.FakeReply.allowableCreationParams,g,h,j,k;for(g=0,h=m.length;g<h;++g){j=m[g];k=this.get(j);if(k!==undefined){if(j==="applyToBackgroundRequests"&&!k){continue}if(SC.typeOf(k)===SC.T_STRING){l.push("%@=%@".fmt(j,k))}else{l.push("%@=%@".fmt(j,k))}}}return l.join(",  ")}}});SC.mixin(CW.FakeReply,{allowableCreationParams:["applyToBackgroundRequests","status","statusText","responseText","responseHash","urlFilter","delay"],_allowableCreationParamsHash:null,createFakeReply:function(B){var s=CW.FakeReply,u=s._allowableCreationParamsHash,C,E,y,x;if(!u){u=s._allowableCreationParamsHash={};E=s.allowableCreationParams;for(y=0,x=E.length;y<x;++y){C=E[y];u[C]=YES}}if(B===null){return s.create({shouldProcessRequestNormally:YES})}else{if(!B){CW.fatalError("You must specify params for the fake reply")}}var t=NO;for(C in B){if(!u[C]){if(console.error){console.error("Fake reply has an unrecognized parameter %@:".fmt(C),B)}t=YES}}if(t){CW.fatalError("Unrecognized parameter in fake reply")}var q=0;var z=B.status;if(z===undefined){if(console.error){console.error("Fake reply does not include a status:",B)}++q}else{if(!z){if(console.error){console.error("Fake reply has an invalid status of 0:",B)}++q}}var v=B.responseText,D=B.responseHash;if(v===undefined&&!D){v=B.responseText="Fake reply with status "+z}else{if(v!==undefined&&D){if(console.error){console.error("Fake reply has both a responseText and a responseHash:",B)}++q}else{if(v!==undefined&&SC.typeOf(v)!==SC.T_STRING){if(console.error){console.error("Fake reply has an invalid responseText (it should be a string):",B)}++q}else{if(D&&SC.typeOf(D)!==SC.T_HASH){if(console.error){console.error("Fake reply has an invalid responseHash (it should be a hash):",B)}++q}}}}var e=B.urlFilter;if(e&&!(e instanceof RegExp)){if(SC.typeOf(e)===SC.T_STRING){B.urlFilter=new RegExp(e)}else{if(console.error){console.error("Fake reply has an invalid urlFilter (it should be a string or a RegExp instance):",B)}++q}}if(D&&q===0){delete B.responseHash;try{B.responseText=SC.json.encode(D)}catch(w){if(console.error){console.error("There was an error encoding JSON from the responseHash:  "+w+",  fake reply:",B)}++q}}if(q===1){CW.fatalError("There was one error with the fake reply parameters")}else{if(q>0){CW.fatalError("There were %@ errors with the fake reply parameters".fmt(q))}else{return s.create(B)}}}});sc_require("core");sc_require("core_error_handling");sc_require("system/fake_reply");CW.mixin({requestLoggingLevel:null,fakeReplyQueue:null,addFakeReply:function(t,p){if(SC.typeOf(t)!==SC.T_ARRAY){t=SC.$A(t)}var e=CW.FakeReply,s=[],x,v,y,B;for(x=0,v=t.length;x<v;++x){y=t[x];B=null;try{B=e.createFakeReply(y)}catch(u){}if(B){s.push(B)}}var w=t.length,q=s.length;if(w!==q){var z=w-q;if(z===1){CW.fatalError("Errors prevented your fake reply from being added.  The fake reply queue was not changed.")}else{CW.fatalError("Errors prevented %@ of your %@ fake replies from being added.  The fake reply queue was not changed.".fmt(z,w))}}var C=this.get("fakeReplyQueue");if(!C){C=[];this.set("fakeReplyQueue",C)}C.beginPropertyChanges();for(x=0,v=s.length;x<v;++x){B=s[x];C.pushObject(B)}C.endPropertyChanges();if(!p){console.log("The fake reply queue is now:");this.listFakeReplyQueue()}},listFakeReplyQueue:function(){var f=this.get("fakeReplyQueue");if(!f){console.log("(no fake reply queue)")}else{var h=[],k,g,j;for(k=0,g=f.length;k<g;++k){j=f[k];h.push("[%@]  %@".fmt(k,j))}console.log(h.join("\n"))}},_recordingCount:0,_logRequestIfAppropriateFor:function(q){if(!q){CW.fatalError("_logRequestIfAppropriateFor():  A response must be specified")}var n=this.get("requestLoggingLevel"),t=++this._recordingCount,p,v,u,s,m,o,l;if(n){q._recordingID=t;q._sentAt=new Date();p=q.get("request");v=p.get("type");u=p.getFullAddress();s=this._sortAndStringifyHeaders(p.get("headers"));m=p.get("cookies");if(p.get("bodyShouldBeLogged")){o=p.get("encodedBody");if(!o){o="(empty)"}}else{o="(omitted)"}l="-->  Request "+t+":   "+v+" to "+u+",  headers: "+s+(m?",  cookies: "+m:"")+",  body: "+o;SC.Logger._handleMessage(n,NO,l)}},_logResponseIfAppropriate:function(w){if(!w){CW.fatalError("_logResponseIfAppropriateFor():  A response must be specified")}var q=this.get("requestLoggingLevel"),s=new Date(),C,x,B,p,y,v,z,u,e;if(q){C=w._recordingID;x=w._sentAt;B=w._receivedAtWhileSuspended;p=w.get("timedOut");if(p){y="  (timed out)"}else{if(B){y=x?("  ("+(B-x)+"ms, suspended for "+(s-B)+"ms)"):"  (unknown)"}else{y=x?("  ("+(s-x)+"ms)"):"  (unknown)"}}v=w.get("status");try{z=this._sortAndStringifyHeaders(w.get("headers"))}catch(t){}if(w.get("bodyShouldBeLogged")){u=w.get("encodedBody");if(!u){u="(empty)"}}else{u="(omitted)"}e="<--  Response "+C+":  "+v+y+",  headers: "+z+"  body: "+u;SC.Logger._handleMessage(q,NO,e)}},_sortAndStringifyHeaders:function(l){var k,m,h,o,j,n=[];for(k in l){n.push(k)}n.sort();h="";for(o=0,j=n.length;o<j;++o){k=n[o];m=l[k];if(o!==0){h+=", "}h+=k+"="+m}return h}});CW.Response=SC.XHRResponse.extend({bodyShouldBeLogged:function(){var b=this.get("status");return(!SC.none(b)&&b!==200)}.property("status"),fakeReply:null,overallTimeoutTimer:null,addedToOutgoingQueueTimestamp:null,getFullAddress:function(){return this.get("request").getFullAddress()},notify:function(){var f=arguments.callee.base.apply(this,arguments),d=CW.RequestManagement,e;if(d){e=d.sharedInstance()}if(e){e.removeOutstandingResponse(this)}return f},fire:function(j){var g=this.get("request"),k=g?g.get("source"):null;if(k&&k.willSend){k.willSend(g,this)}g.freeze();if(!this.get("isCancelled")){this.invokeTransport(j)}var f=g.get("timeout");if(f){var h=SC.Timer.schedule({target:this,action:"timeoutReached",interval:f,repeats:NO});this.set("timeoutTimer",h)}if(!this.get("isCancelled")&&k&&k.didSend){k.didSend(g,this)}},timeoutReached:function(){var b=this.get("timeoutTimer");if(b){b.invalidate()}b=this.get("overallTimeoutTimer");if(b){b.invalidate()}return arguments.callee.base.apply(this,arguments)},receive:function(f,e){var d=this.get("overallTimeoutTimer");if(d){d.invalidate()}return arguments.callee.base.apply(this,arguments)},invokeTransport:function(){var k=this.get("fakeReply"),g;if(k){this.set("rawRequest",k);g=k.get("delay");this.invokeLater(this._triggerFakeReply,g)}else{var l=this.createRequest(),j,h,m;this.set("rawRequest",l);m=!!this.getPath("request.isAsynchronous");if(m){if(!SC.browser.msie&&!SC.browser.opera){SC.Event.add(l,"readystatechange",this,this.finishRequest,l)}else{j=this;h=function(){if(!j){return null}var a=j.finishRequest();if(a){j=null}return a};l.onreadystatechange=h}}l.open(this.get("type"),this.getFullAddress(),m);this.setRequestHeaders();if(this.getPath("request.useCrossDomain")&&this.getPath("request.withCredentials")){l.withCredentials=true}l.send(this.getPath("request.encodedBody"));if(!m){this.finishRequest()}return l}},setRequestHeaders:function(){var d=this.get("rawRequest"),f=this.getPath("request.headers");for(var e in f){d.setRequestHeader(e,f[e])}},cancelTransport:function(){var b=this.get("fakeReply");if(b){return}else{return arguments.callee.base.apply(this,arguments)}},_triggerFakeReply:function(){var b=this.get("fakeReply");if(b){b.set("readyState",4);this.finishRequest(undefined)}}});sc_require("system/response");CW.IFramePostMessageResponse=CW.Response.extend({isCrossDomain:YES,requestId:-1,rawResponse:null,_activeRequests:{},destinationDomain:"",headers:function(){var e=this.get("rawResponse");if(!e){return{}}var f=e.headers,d={};if(!f){return d}f.split("\n").forEach(function(a){var h=a.indexOf(":"),c,b;if(h>=0){c=a.slice(0,h);b=a.slice(h+1).trim();d[c]=b}},this);return d}.property("status").cacheable(),header:function(d){var c=this.get("headers");return c[d]||null},encodedBody:function(){var b=this.get("rawResponse");if(!b){return""}return b.responseText}.property("status").cacheable(),invokeTransport:function(h){var k=this.get("request");var g={requestId:h,url:k.getFullAddress(),type:k.get("type"),headers:k.get("headers"),body:k.get("body"),isAsynchronous:k.get("isAsynchronous")};var e=SC.Request.manager.get("crossDomainIFrames")[k.get("destinationDomain")];try{e.contentWindow.postMessage(SC.json.encode(g),this.get("destinationDomain"))}catch(j){SC.debug('CW.IFramePostMessageResponse: iFrame not properly loaded from "%@". Maybe ajax_sender.html is missing?',e.src)}},finishRequest:function(m){var k=this.get("rawResponse"),h=k.readyState,l,g,j;if(h===4&&!this.get("timedOut")){this.receive(function(c){if(!c){return}g=-1;try{g=k.status||0}catch(a){}if((g<200)||(g>=300)){try{j=k.statusText||""}catch(b){j=""}l=SC.$error(j||"HTTP Request failed","Request",g);l.set("errorValue",this);this.set("isError",YES);this.set("errorObject",l)}this.set("status",g)},this);if(!SC.browser.msie&&!SC.browser.opera){SC.Event.remove(k,"readystatechange",this,this.finishRequest)}else{k.onreadystatechange=null}return YES}return NO},cancelTransport:function(){this.set("rawRequest",null)}});sc_require("core");CW.ImagePreloader=SC.Object.extend({images:null,callBack:null,init:function(){this.loadImages()},loadImages:function(){this._numLoaded=0;this._numProcessed=0;this._allImages=[];this._numImages=this.get("images").length;for(var b=0;b<this._numImages;b++){this.preload(this.get("images")[b])}},preload:function(d){var c=new Image;this._allImages.push(c);theImage=this;c.onload=function(){theImage.onload.call(theImage)};c.onerror=function(){theImage.onerror.call(theImage)};c.onabort=function(){theImage.onabort.call(theImage)};c.sLoaded=false;c.src=d},onComplete:function(){this._numProcessed++;if(this._numProcessed===this._numImages){this.callBack(this._allImages,this._numLoaded)}},onload:function(){this.sLoaded=true;this._numLoaded++;this.onComplete()},onerror:function(){this.sError=true;this.onComplete()},onabort:function(){this.sAbort=true;this.onComplete()}});CW.KeyResponder={_kr_init:function(){var b=this.keyboardShortcuts||{};b=SC.clone(b);this.keyboardShortcuts=b;this._kr_hasInited=YES},registerKeyboardShortcut:function(e,f,d){if(!this._kr_hasInited){this._kr_init()}if(!d){d=f;this.keyboardShortcuts[e]=d}else{this.keyboardShortcuts[e]={target:f,action:d}}},deregisterKeyboardShortcut:function(b){if(!this._kr_hasInited){this._kr_init()}delete this.keyboardShortcuts[b]},performKeyEquivalent:function(k,f){if(!this._kr_hasInited){this._kr_init()}if(CW.LOG_KEYBOARD_SHORTCUTS){SC.Logger.log("Responder attempting to find keyboard shortcut for %s",k)}var g=this.keyboardShortcuts[k];if(g){var j=g,h=this;if(typeof g==="object"){h=g.target;j=g.action}if(typeof j!=="string"){return j.call(h,k,f)}return SC.RootResponder.responder.sendAction(j,h,this,k,f)}return NO}};SC.mixin(CW,{LOG_KEYBOARD_SHORTCUTS:YES,registerKeyboardShortcut:function(e,f,d){CW.globalKeyResponder.registerKeyboardShortcut(e,f,d)},deregisterKeyboardShortcut:function(b){CW.globalKeyResponder.deregisterKeyboardShortcut(b)},keyResponders:[],globalKeyResponder:SC.Object.create(CW.KeyResponder),addKeyResponder:function(b){this.keyResponders.push(b)},removeKeyResponder:function(b){this.keyResponders.removeObject(b)},performKeyEquivalent:function(h,k){if(CW.LOG_KEYBOARD_SHORTCUTS){SC.Logger.log("Attempting to find keyboard shortcut for %s",h)}var j=this.keyResponders,f,g=j.length;for(f=g-1;f>=0;f--){if(j[f].performKeyEquivalent(h,k)){return YES}}return NO},installKeyResponder:function(){}});CW.keyResponders.push(CW.globalKeyResponder);CW.LOG_NOTIFICATIONS=YES;CW.notificationCenter=SC.Object.create({_subscriptions:{},postNotification:function(m){var t=this._subscriptions;if(!t[m]){if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Could not find any subscribers for %@, returning.".fmt(m))}return}var n=t[m];var s=n.length;var l=SC.A(arguments).slice(1);if(!l){l=[]}if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Posting notification %@".fmt(m))}for(var p=0;p<s;p++){var k=n[p];if(k){var q=k.action;var o=k.target;q.apply(o,l)}}},_targetForTargetName:function(b){if(SC.typeOf(b)===SC.T_STRING){return SC.objectForPropertyPath(b)}return b},_methodForMethodNameInTarget:function(d,c){if(SC.typeOf(d)===SC.T_STRING){return SC.objectForPropertyPath(d,c)}return d},subscribeToNotification:function(m,o,s){o=this._targetForTargetName(o);s=this._methodForMethodNameInTarget(s,o);if(!s){throw"You must pass a action to subscribeToNotification()"}var t=this._subscriptions;var n=t[m];if(!n){n=t[m]=[]}var k=false;var p=n.length;for(var q=0;q<p;q++){var l=n[q];if(l.action===s&&l.target===o){k=true}}if(!k){if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Subscribed to %@".fmt(m))}t[m].push({action:s,target:o});this._subscriptions=t}},unsubscribeFromNotification:function(m,o,q){var t=this._subscriptions;o=this._targetForTargetName(o);q=this._methodForMethodNameInTarget(q,o);if(!q){throw"You must pass a action to subscribeToNotification()"}var n=t[m];if(!n){return}var s=n.length;var k=-1;for(var p=0;p<s;p++){var l=n[p];if(l.action===q&&l.target===o){k=p}}if(k!==-1){if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Subscribed to %@".fmt(m))}t[m].splice(k,1);this._subscriptions=t}}});sc_require("system/response");CW.Request=SC.Request.extend({COPY_KEYS:SC.Request.prototype.COPY_KEYS.concat(["overallTimeout","addressPrefix","useCrossDomain","withCredentials","id","isCancelled","destinationDomain","cycle","action","isBackgroundRequest","_crossDomainMethod","_queryParameters","_isRead","isRead","isWrite","_isPending","_cycleWhenPended","_cycleWhenSent"]),responseClass:undefined,timeout:30000,overallTimeout:null,addressPrefix:null,useCrossDomain:NO,withCredentials:NO,iFrameScriptLocation:"ajax_sender.html",id:null,isCancelled:NO,cycle:null,action:null,isBackgroundRequest:NO,init:function(){arguments.callee.base.apply(this,arguments);this.queryParameter("lang",String.preferredLanguage)},isRead:function(f,h){if(h===undefined){var g=this._isRead;if(g!==undefined){return g}else{var e=this.get("type");if(!e){CW.fatalError("No type was specified, so we dont know whether this request is a read or a write.")}else{return e.toLowerCase()==="get"}}}else{this._isRead=h;return h}}.property("type").cacheable(),isWrite:function(d,c){if(c===undefined){return !this.get("isRead")}else{this.set("isRead",!c);return c}}.property("isRead").cacheable(),bodyShouldBeLogged:NO,queryParameter:function(e,d){var f;if(SC.typeOf(e)===SC.T_STRING){f=this._queryParameters;if(arguments.length===1){return f?f[e]:null}else{this.propertyWillChange("queryParameters");if(!f){f=this._queryParameters={}}f[e]=d;this.propertyDidChange("queryParameters");return this}}else{if(d===undefined){f=e;this.beginPropertyChanges();for(e in f){if(!f.hasOwnProperty(e)){continue}this.queryParameter(e,f[e])}this.endPropertyChanges();return this}else{CW.fatalError("queryParameter():  You must pass in either a key or a hash of query parameters",{target:this})}}return this},clearQueryParameters:function(){this.propertyWillChange("queryParameters");this._queryParameters={};this.propertyDidChange("queryParameters")},queryParameters:function(){return this._queryParameters}.property().cacheable(),addressWithQueryParameters:function(){var b=URI(this.get("address")).addQuery(this.get("queryParameters")).sortQuery().normalize().toString();return b}.property("address","queryParameters").cacheable(),send:function(u,w){this._determineResponseClassAndMethod();var x;if(this.get("isAsynchronous")===NO){x=this._crossDomainMethod;if(x&&x!=="cors"){CW.fatalError("You cannot send a synchronous request using iframes with postMessage",{target:this})}}var o=CW.RequestManagement,s=o?o.sharedInstance():null,t,n,q,v;this._isPending=NO;this._cycleWhenPended=null;this._cycleWhenSent=this.get("cycle");n=this._getFakeReply();var p=this.get("timeout");if(p&&!this.get("isAsynchronous")){throw"Timeout values cannot be used with synchronous requests"}else{if(p===0){throw"The timeout value must either not be specified or must be greater than 0"}}if(u){this.set("body",u)}var m=SC.clone(this._queryParameters);v=this.copy()._prep();v._queryParameters=m;if(n){v._fakeReplyToUse=n}t=SC.Request.manager.sendRequest(v);if(t&&s){s.addOutstandingResponse(t)}if(w&&s){s.removePendingRequest(this)}return t},sendAfterDelay:function(f,g){if(!g){CW.fatalError("sendAfterDelay():  You must specify a delay",{target:this})}var h=CW.RequestManagement,e=h?h.sharedInstance():null;this._isPending=YES;this._cycleWhenPended=this.get("cycle");if(e){e.addPendingRequest(this)}this.invokeLater(this.send,g,f,YES)},resend:function(m,j){var k=this._getFakeReply(),n,l,o,h;l=this.get("source")?this:this.copy()._prep();if(k){l._fakeReplyToUse=k}n=SC.Request.manager.sendRequest(l,m);if(n){o=CW.RequestManagement;h=o?o.sharedInstance():null;if(h){h.addOutstandingResponse(n)}}if(j&&h){h.removePendingRequest(this)}return n},resendAfterDelay:function(g,h){if(!h){CW.fatalError("resendAfterDelay():  You must specify a delay",{target:this})}var e=CW.RequestManagement,f=e?e.sharedInstance():null;this._isPending=YES;this._cycleWhenPended=this.get("cycle");if(f){f.addPendingRequest(this)}this.invokeLater(this.resend,h,g,YES)},getFullAddress:function(){var c=this.get("addressPrefix"),d=this.get("addressWithQueryParameters");if(c){d=c+d}return d},didSend:function(d,e){var f;CW._logRequestIfAppropriateFor(e);f=e.get("rawRequest");if(f&&f.isFakeReply){SC.info("Using fake reply (%@) for request:  %@",f,d)}},didReceive:function(g,h){var e=CW.Request,f;if(e._responseSuspendCount>0){h._receivedAtWhileSuspended=new Date();f=e._suspendedResponses;if(!f){f=e._suspendedResponses=[h]}else{f.push(h)}if(!h.get("isCancelled")){h._receivedWhenSuspended=YES;h.set("isCancelled",YES)}}else{CW._logResponseIfAppropriate(h)}},destinationDomain:function(){var f=this.getFullAddress(),e=null,g,h;if(f){if(URI(f).protocol()===""||URI(f).host()===""){SC.error("Malformed URL: "+f);return null}e=URI(f).protocol()+"://"+URI(f).host()}return e}.property("addressPrefix","address"),cycleDidChange:function(){var e=CW.RequestManagement,f=e?e.sharedInstance():null,g,h;if(f){g=this.get("cycle");if(this._isPending){if(g!==this._cycleWhenPended){f.cycleDidChangeForPendingRequest()}}else{h=this._cycleWhenSent;if(h&&(g!==h)){f.cycleDidChangeForOutstandingResponse()}}}}.observes("cycle"),toString:function(){var c=arguments.callee.base.apply(this,arguments),d=this.get("address");if(d){c+=" ("+d+")"}return c},_crossDomainMethod:null,_queryParameters:null,_isPending:NO,_cycleWhenPended:null,_cycleWhenSent:null,_determineResponseClassAndMethod:function(){var e=SC.kindOf,d,f;if(this.get("useCrossDomain")){d=this.get("responseClass");if(!d){if(XMLHttpRequest&&"withCredentials" in new XMLHttpRequest()){d=CW.Response}else{if(this._isAppropriateForXDomainRequest()){d=CW.XDRResponse}else{if(window.postMessage){d=CW.IFramePostMessageResponse}else{if(SC.browser.msie&&SC.browser.version<=7){d=CW.IFrameDocumentDomainResponse}}}}}if(!this._crossDomainMethod){if(e(d,CW.IFramePostMessageResponse)){f="postMessage"}else{if(e(d,CW.IFrameDocumentDomainResponse)){f="documentDomain"}else{if(e(d,CW.Response)||e(d,CW.XDRResponse)){f="cors"}}}if(f){this._crossDomainMethod=f}}}else{d=CW.Response}if(!this.get("responseClass")&&d){this.set("responseClass",d)}},_isAppropriateForXDomainRequest:function(){var d=this.get("headers"),e=YES,f;if(d){for(f in d){if(f.toLowerCase()!=="content-type"||d[f]!=="text/plain"){e=NO}}}if(e&&SC.browser.msie&&SC.browser.version<=9&&!this.get("withCredentials")){return YES}return NO},_getFakeReply:function(){var s=CW.get("fakeReplyQueue"),k=s?s.length:0,o=null,n,m,p,q,l,t;if(k>0){n=this.get("isBackgroundRequest");m=null;for(p=0;p<k;++p){q=s[p];if(n&&!q.get("applyToBackgroundRequests")){continue}l=q.get("urlFilter");if(l){t=this.get("address");if(!t||!l.test(t)){continue}}s.removeAt(p,1);m=q;break}if(m){if(!m.get("shouldProcessRequestNormally")){o=m}}}return o}});CW.Request.mixin({suspendResponses:function(){++this._responseSuspendCount},resumeResponses:function(){var l=--this._responseSuspendCount,j,p,k,q,n,m;if(l<0){SC.warn("CW.Response.resumeResponses() was called without a paired suspendResponses() invocation; ignoring");this._responseSuspendCount=0}var o=function(){if(q.get("isCancelled")&&q._receivedWhenSuspended){q.set("isCancelled",NO);n=q.get("request");m=n.get("source");if(m&&m.didReceive){m.didReceive(n,q)}if(!q.get("isCancelled")){q.notify()}}};j=this._suspendedResponses;k=j?j.length:0;for(p=0;p<k;++p){q=j[p];SC.run(o)}},_responseSuspendCount:0,_suspendedResponses:null});SC.Request.manager.mixin({crossDomainIFrames:{},_requestId:0,_crossDomainXHRLoaderURL:"",shouldFireRequest:null,_createCrossDomainIFrame:function(g,h){if(!g){CW.fatalError("_createCrossDomainIFrame():  A destination domain must be specified",{target:this})}if(!h){CW.fatalError("_createCrossDomainIFrame():  An AJAX sender URL must be specified",{target:this,destinationDomain:g})}var f=document.createElement("iframe"),e=this;if(h[0]!=="/"){h="/"+h}f.loaded=false;f.onload=f.onreadystatechange=function(){if(!f.loaded&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f.loaded=true;e.fireRequestIfNeeded()}};if(g[g.length-1]==="/"){g=g.substr(0,g.length-1)}f.src=g+h;f.style.display="none";document.body.appendChild(f);f.className="crossdomain-iframe";SC.Event.add(window,"message",this,"_messageWasReceived",null,true);this.get("crossDomainIFrames")[g]=f;this.notifyPropertyChange("crossDomainIFrames")},_messageWasReceived:function(q){var j=q.originalEvent;var p=SC.json.decode(j.data);if(!p.isIFramePostMessageResponse){return}var l=p.headers,m=this.get("inflight"),k,n,o;for(o=0,k=m.length;o<k;o++){n=m[o];if(n.requestId===p.requestId){if(!URI(j.origin).baseEquals(URI(n.get("destinationDomain")))){CW.fatalError("Potential cross domain attack, postMessage from unknown origin, %@",j.origin);return}n.set("rawResponse",p);n.set("rawRequest",p);n.finishRequest();return}}},sendRequest:function(p,o){if(!p){return null}var t=this._requestId,s=p.get("responseClass").create({request:p,requestId:t}),l,m,q,u;if(s.get("isCrossDomain")){var n=p.get("destinationDomain"),v=p._crossDomainMethod;if((v==="postMessage"||v==="documentDomain")&&!this.get("crossDomainIFrames")[n]){this._createCrossDomainIFrame(n,p.get("iFrameScriptLocation"))}s.set("destinationDomain",n)}if(o){s.set("retryOf",o)}this._requestId=++t;s.set("addedToOutgoingQueueTimestamp",new Date());l=p._fakeReplyToUse;if(l){s.set("fakeReply",l);delete p._fakeReplyToUse}m=p.get("timeout");q=p.get("overallTimeout");if(q===null&&m){q=m;p.set("overallTimeout",m)}if(q){u=SC.Timer.schedule({target:s,action:"timeoutReached",interval:q,repeats:NO});s.set("overallTimeoutTimer",u)}this.get("pending").pushObject(s);this.fireRequestIfNeeded();return s},fireRequestIfNeeded:function(){var u=this.get("pending"),o=this.get("inflight"),n=this.get("maxRequests"),p=u.length,l,s,m,q;if((p>0)&&(o.length<n)){l=this.shouldFireRequest;if(l){for(q=0;q<p;++q){s=u.objectAt(q);if(l(s)){m=s;u.removeAt(q);break}}}else{m=u.shiftObject()}if(!m){return}if(m.get("isCrossDomain")){var t=this.get("crossDomainIFrames")[m.get("destinationDomain")];if(!t||!t.loaded){SC.debug("CW.Request.manager: postponing the sending of %@ since the necessary iframe is not loaded",m);u.unshift(m);return}}o.pushObject(m);this.set("inflight",o);var v=m.get("requestId");m.fire(v)}this.propertyDidChange("inflight")}});CW.RequestManagement=SC.Object.extend({pendingRequests:null,outstandingResponses:null,addPendingRequest:function(c){var d=this.get("pendingRequests");d.pushObject(c)},addOutstandingResponse:function(c){if(!c.getPath("request.isAsynchronous")){SC.debug("Skipping response registration for synchronous response %@",c);return}var d=this.get("outstandingResponses");d.pushObject(c)},removePendingRequest:function(f){var d=this.get("pendingRequests"),e=d.indexOf(f);if(e!==-1){d.removeAt(e,1)}},removeOutstandingResponse:function(f){var d=this.get("outstandingResponses"),e=d.indexOf(f);if(e!==-1){d.removeAt(e,1)}},pendingRequestsForCycle:function(k){var j=this.get("pendingRequests"),m=null,l,h,g;for(l=0,h=j.length;l<h;++l){g=j[l];if(g.get("cycle")===k){if(!m){m=[g]}else{m.push(g)}}}return m},outstandingResponsesForCycle:function(j){var g=this.get("outstandingResponses"),l=null,k,h,m;for(k=0,h=g.length;k<h;++k){m=g[k];if(m.getPath("request.cycle")===j){if(!l){l=[m]}else{l.push(m)}}}return l},cycleDidChangeForPendingRequest:function(){this.get("pendingRequests").enumerableContentDidChange()},cycleDidChangeForOutstandingResponse:function(){this.get("outstandingResponses").enumerableContentDidChange()},numberOfPendingOrOutstandingReadsForCycle:function(b){return(this.numberOfPendingReadRequestsForCycle(b)+this.numberOfOutstandingReadResponsesForCycle(b))},numberOfPendingReadRequestsForCycle:function(l){var m,h,g,j=0,k=this.pendingRequestsForCycle(l);if(k){for(m=0,h=k.length;m<h;++m){g=k[m];if(g.get("isRead")){j++}}}return j},numberOfOutstandingReadResponsesForCycle:function(k){var l,h,m,j=0,g=this.outstandingResponsesForCycle(k);if(g){for(l=0,h=g.length;l<h;++l){m=g[l];if(m.getPath("request.isRead")){j++}}}return j},numberOfPendingOrOutstandingWritesForCycle:function(b){return(this.numberOfPendingWriteRequestsForCycle(b)+this.numberOfOutstandingWriteResponsesForCycle(b))},numberOfPendingWriteRequestsForCycle:function(l){var m,h,g,j=0,k=this.pendingRequestsForCycle(l);if(k){for(m=0,h=k.length;m<h;++m){g=k[m];if(g.get("isWrite")){j++}}}return j},numberOfOutstandingWriteResponsesForCycle:function(k){var l,h,m,j=0,g=this.outstandingResponsesForCycle(k);if(g){for(l=0,h=g.length;l<h;++l){m=g[l];if(m.getPath("request.isWrite")){j++}}}return j},init:function(){var b=arguments.callee.base.apply(this,arguments);this.pendingRequests=[];this.outstandingResponses=[];return b}});CW.RequestManagement.mixin({sharedInstance:function(){var b=this._singleton;if(!b){b=this._singleton=CW.RequestManagement.create()}return b},_singleton:null});SHA1=SC.Object.create({hexcase:1,b64pad:"",hex_sha1:function(b){return this.rstr2hex(this.rstr_sha1(this.str2rstr_utf8(b)))},b64_sha1:function(b){return this.rstr2b64(this.rstr_sha1(this.str2rstr_utf8(b)))},sha1_vm_test:function(){return this.hex_sha1("abc").toLowerCase()==="a9993e364706816aba3e25717850c26c9cd0d89d"},rstr_sha1:function(b){return this.binb2rstr(this.binb_sha1(this.rstr2binb(b),b.length*8))},rstr2hex:function(k){var h=this.hexcase?"0123456789ABCDEF":"0123456789abcdef";var f="";var g;for(var j=0;j<k.length;j++){g=k.charCodeAt(j);f+=h.charAt((g>>>4)&15)+h.charAt(g&15)}return f},rstr2b64:function(o){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var h="";var j=o.length;for(var m=0;m<j;m+=3){var k=(o.charCodeAt(m)<<16)|(m+1<j?o.charCodeAt(m+1)<<8:0)|(m+2<j?o.charCodeAt(m+2):0);for(var n=0;n<4;n++){if(m*8+n*6>o.length*8){h+=b64pad}else{h+=l.charAt((k>>>6*(3-n))&63)}}}return h},str2rstr_utf8:function(k){var f="";var j=-1;var g,h;while(++j<k.length){g=k.charCodeAt(j);h=j+1<k.length?k.charCodeAt(j+1):0;if(55296<=g&&g<=56319&&56320<=h&&h<=57343){g=65536+((g&1023)<<10)+(h&1023);j++}if(g<=127){f+=String.fromCharCode(g)}else{if(g<=2047){f+=String.fromCharCode(192|((g>>>6)&31),128|(g&63))}else{if(g<=65535){f+=String.fromCharCode(224|((g>>>12)&15),128|((g>>>6)&63),128|(g&63))}else{if(g<=2097151){f+=String.fromCharCode(240|((g>>>18)&7),128|((g>>>12)&63),128|((g>>>6)&63),128|(g&63))}}}}}return f},rstr2binb:function(d){var f;var e=Array(d.length>>2);for(f=0;f<e.length;f++){e[f]=0}for(f=0;f<d.length*8;f+=8){e[f>>5]|=(d.charCodeAt(f/8)&255)<<(24-f%32)}return e},binb2rstr:function(d){var e="";for(var f=0;f<d.length*32;f+=8){e+=String.fromCharCode((d[f>>5]>>>(24-f%32))&255)}return e},binb_sha1:function(F,d){F[d>>5]|=128<<(24-d%32);F[((d+64>>9)<<4)+15]=d;var E=Array(80);var G=1732584193;var H=-271733879;var a=-1732584194;var b=271733878;var c=-1009589776;for(var t=0;t<F.length;t+=16){var e=G;var j=H;var w=a;var x=b;var C=c;for(var B=0;B<80;B++){if(B<16){E[B]=F[t+B]}else{E[B]=this.bit_rol(E[B-3]^E[B-8]^E[B-14]^E[B-16],1)}var D=this.safe_add(this.safe_add(this.bit_rol(G,5),this.sha1_ft(B,H,a,b)),this.safe_add(this.safe_add(c,E[B]),this.sha1_kt(B)));c=b;b=a;a=this.bit_rol(H,30);H=G;G=D}G=this.safe_add(G,e);H=this.safe_add(H,j);a=this.safe_add(a,w);b=this.safe_add(b,x);c=this.safe_add(c,C)}return Array(G,H,a,b,c)},sha1_ft:function(h,b,c,d){if(h<20){return(b&c)|((~b)&d)}if(h<40){return b^c^d}if(h<60){return(b&c)|(b&d)|(c&d)}return b^c^d},sha1_kt:function(b){return(b<20)?1518500249:(b<40)?1859775393:(b<60)?-1894007588:-899497514},safe_add:function(f,g){var h=(f&65535)+(g&65535);var e=(f>>16)+(g>>16)+(h>>16);return(e<<16)|(h&65535)},bit_rol:function(d,c){return(d<<c)|(d>>>(32-c))}});CW.SpritePreloadEnforcement={hasSpritePreloadEnforcement:YES,extraRequiredSrcs:null,extraRequiredImages:null,didFinishWaitingForImages:function(){},initMixin:function(){if(this.didCreateLayer){this._user_didCreateLayer=this.didCreateLayer}this.didCreateLayer=function(){if(this._user_didCreateLayer){var b=this._user_didCreateLayer.apply(this,arguments)}this._preload_didCreateLayer();return b}},_preload_didCreateLayer:function(){if(this.constructor.prototype.__hasPreloadedSprites__){var b=this.constructor.prototype.__preloadedExtraRequiredImages__;if(b){this.extraRequiredImages=b}SC.debug("Creating another instance of "+this.constructor+": all sprite backgrounds are confirmed to have been downloaded. Performing no preload action.");if(this.hasPaneAnimationSupport){SC.debug("Because this is the first append, and this pane has PaneAnimationSupport, we now trigger animateShow() to perform the animation.");this._hasShownFromDidCreateLayer=true;this.animateShow()}return}this.hideForPreload();this.preloadBackgroundSprites(this.getPreloadElementList(),this.showForPreload,this)},getPreloadElementList:function(){return SC.$A(this.$("*"))},hideForPreload:function(){this.set("isVisible",NO)},showForPreload:function(){this.set("isVisible",YES);if(this.hasPaneAnimationSupport){this._hasShownFromDidCreateLayer=true;this.animateShow()}},preloadBackgroundSprites:function(e,f,d){this.__elements__=e;this.__callback__=f;this.__target__=d;this.invokeLast("_preloadBackgroundSprites",e,f,d)},_preloadBackgroundSprites:function(x,J,u){x=this.__elements__;J=this.__callback__;u=this.__target__;this.__target__=this.__callback__=this.__elements__=undefined;var C=CW._backgroundImageLoadedness||(CW._backgroundImageLoadedness={}),M,G=0,I=false,D=this,B=undefined,H=this.get("extraRequiredSrcs"),y=this.extraRequiredImages=H?{}:null,K=function(){G--;SC.debug("Finished loading "+this._src_+". images remaining before callback: "+G);C[this._src_]=true;if(y&&this._extraKey_){y[this._extraKey_]=this}if(G===0){SC.debug("All images are downloaded. Now running callback.");E()}},E=function(a){if(B){clearTimeout(B)}if(I){SC.debug("Performing the callback for all images having finished loading, but it has already been performed. Aborting.");return}if(!a){D.constructor.prototype.__hasPreloadedSprites__=true;if(y){D.constructor.prototype.__preloadedExtraRequiredImages__=y}}D.didFinishWaitingForImages();I=true;SC.run(function(){J.apply(u||D)})};x=SC.$A(x);for(var v=0,N,w,F,z;N=x[v];v++){F=jQuery(N).css("background-image");if(!F){continue}if(F.indexOf("http")===-1){continue}if(F.indexOf("url(")===-1){continue}F=F.substring(4,F.length-1);if((w=F.charAt(0))==='"'||w==="'"){F=F.substring(1)}if((w=F.charAt(F.length-1))==='"'||w==="'"){F=F.substring(0,F.length-1)}if(C[F]){continue}if(M&&M[F]){continue}(M||(M={}))[F]=true;G++;z=new Image();z.onload=K;SC.debug("Preloading "+F);z.src=(z._src_=F)}if(H){for(v in H){if(!H.hasOwnProperty(v)){continue}F=H[v];G++;z=new Image();z.onload=K;SC.debug("Preloading explicitly-specified image "+F);z.src=(z._src_=F);z._extraKey_=v}}if(G===0){SC.debug("Preloading background images, but every image was already loaded. Running callback immediately.");E()}else{var L=SC.buildMode==="debug"?3000:1500;B=setTimeout(function(){SC.debug("Attempted to preload background images, but the loading is taking longer than "+(L/1000)+" seconds. Now running callback regardless of image loadedness.");E(true)},L)}}};CW.TouchApproximation={isTouchApproximationEnabled:YES,distanceThreshold:50,touchStart:function(E){var B=this.convertFrameFromView({x:E.pageX,y:E.pageY}),w=B.x,y=B.y,f,t,x=this.get("touchApproximationViews")||this.get("childViews"),D=this.get("distanceThreshold"),F=null,u=Infinity,G,s,v,C,z;C=x.get("length");for(v=0;v<C;v++){G=x[v];if(!G||!G.get("isVisible")||G.get("isDecorative")){continue}s=G.get("frame");f=-1;t=-1;if(w<s.x){f=s.x-w}else{if(w>(s.x+s.width)){f=w-(s.x+s.width)}}if(y<s.y){t=s.y-y}else{if(y>(s.y+s.height)){t=y-(s.y+s.height)}}if(f!==-1&&t!==-1){f=(f+t)/2}else{if(t!==-1){f=t}}if(f!==-1&&f<u&&f<D){F=G;u=f}}if(F){E.isProxied=YES;E.target=F.get("layer");z=F.tryToPerform("touchStart",E);if(z){this._foundChild=F;return YES}else{this._foundChild=null}}return NO},touchesDragged:function(e,f){var d=this._foundChild;if(d){return d.tryToPerform("touchesDragged",e,f)}return NO},touchEnd:function(c){var d=this._foundChild;if(d){c.isProxied=YES;c.target=d.get("layer");return d.tryToPerform("touchEnd",c)}return NO}};CW.UPLOADER_READY=0;CW.UPLOADER_INCOMPATIBLE_FILE_TYPE=1;CW.UPLOADER_FILE_TOO_BIG=2;CW.UPLOADER_MISSING_XHR=3;CW.Uploader=SC.Object.extend({isUploader:YES,uploadURL:null,maximumFileSize:1024*2000,allowedFileTypes:"png jpeg bmp jpg gif".w(),shouldUploadFile:function(b){return YES},willUploadFile:function(f,d){var e=this;d.upload.onprogress=function(a){SC.run(function(){e.uploadProgressDidChange(d,a)})};d.onload=function(a){SC.run(function(){e.didUploadFile(d,a)})};d.onerror=function(a){SC.run(function(){e.uploadDidFail(d,a)})};d.onreadystatechange=function(a){if(d.readyState===4&&d.status!==200){SC.run(function(){e.uploadDidFail(d,a)})}}},setRequestHeaders:function(h,j){j.setRequestHeader("X-File-Name",h.fileName);j.setRequestHeader("X-File-Size",h.fileSize);var k=this._xhrHeaders;var g=k.length;for(var f in k){j.setRequestHeader(f,k[f])}},uploadProgressDidChange:function(c,d){},didUploadFile:function(c,d){},uploadDidFail:function(c,d){},uploadFiles:function(e){var j=[];for(var h=e.length-1;h>=0;h--){var m=e[h];var k=this._fileIsAcceptableToUpload(m);if((k)!==CW.UPLOADER_READY){j.push(this._errorForFile(m,k))}else{if(this.shouldUploadFile(m)){try{this._createAndSendUploadRequest(m)}catch(l){console.warn(l.toString())}}}}return j},_xhrHeaders:{"If-Modified-Since":"Mon, 26 Jul 1997 05:00:00 GMT","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest","Content-Type":"text/plain"},_fileTooBigDescription:"Uploader.fileTooBigDescription".loc(),_wrongFileTypeDescription:"Uploader.wrongFiletypeDescription".loc(),_createAndSendUploadRequest:function(d){var e=this.get("uploadURL");if(!e){throw"%@: Can't upload file if uploadURL is not set.".fmt(this)}var f=new XMLHttpRequest();if(!f){throw this._errorForFile(d,CW.UPLOADER_MISSING_XHR)}this.willUploadFile(d,f);f.open("POST",e,true);this.setRequestHeaders(d,f);f.send(d)},_fileIsAcceptableToUpload:function(j){var f=CW.UPLOADER_READY;var h=this.get("maximumFileSize");var g=this.get("allowedFileTypes");var k=j.type.split("/")[1];if(j.fileSize>h){f=CW.UPLOADER_FILE_TOO_BIG}if(g.indexOf(k)===-1){f=CW.UPLOADER_INCOMPATIBLE_FILE_TYPE}return f},_errorForFile:function(h,g){var e="";var f="";switch(g){case CW.UPLOADER_INCOMPATIBLE_FILE_TYPE:e=this._wrongFileTypeDescription;break;case CW.UPLOADER_FILE_TOO_BIG:e=this._fileTooBigDescription;break}return SC.$error(e,f,h,g)}});sc_require("system/date_parser");SC.Validator.CalDate=SC.Validator.extend({format:"M/d/yyyy",currentValue:null,fieldValueForObject:function(e,h,g){var f=CW.Date.create(e,CW.DATE_ONLY);e=this._date=f.format(this.get("format"));return e},objectForFieldValue:function(q,y,u){var w=CW.DATE_ONLY,s=this.get("format"),o=["M/d/yyyy","M.d.yyyy","M-d-yyyy"],n=o.indexOf(s)===-1,x=n?[s]:null,t,v,z=u.get("value"),p=this.get("currentValue");q=q.replace(/\s/g,"");v=Date.parseDate(q,x);if(v){q=CW.Date.create(v,w).done()}else{if(Date.isDate(q,"yyyy/MM/dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/MM/dd")),w).done()}else{if(Date.isDate(q,"yyyy.MM.dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM.dd")),w).done()}else{if(Date.isDate(q,"yyyy/M/dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/M/dd")),w).done()}else{if(Date.isDate(q,"yyyy.M.dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.M.dd")),w).done()}else{if(Date.isDate(q,"yyyy/MM/d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/MM/d")),w).done()}else{if(Date.isDate(q,"yyyy.MM.d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM.d")),w).done()}else{if(Date.isDate(q,"yyyy.M.d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.M.d")),w).done()}else{if(Date.isDate(q,"yyyy/M/d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/M/d")),w).done()}else{if(Date.isDate(q,"MM/yyyy")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM/yyyy")),w).done()}else{if(Date.isDate(q,"MM.yyyy")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM.yyyy")),w).done()}else{if(Date.isDate(q,"MM-yyyy")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM-yyyy")),w).done()}else{if(Date.isDate(q,"yyyy/MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/MM")),w).done()}else{if(Date.isDate(q,"yyyy.MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM")),w).done()}else{if(Date.isDate(q,"yyyy-MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy-MM")),w).done()}else{if(Date.isDate(q,"dd.MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"dd.MM")),w).done()}else{if(Date.isDate(q,"MM.dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM.dd")),w).done()}else{if(Date.isDate(q,"yyyy.MM.dd.")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM.dd.")),w).done()}else{t=CW.DateParser.parseDate(q,z,n,p);q=t?t.done():z}}}}}}}}}}}}}}}}}}return q}});SC.Validator.Email=SC.Validator.extend({validate:function(d,c){return/^([A-Z0-9\.\-\_\+])*([A-Z0-9\+\-\_])+\@[A-Z0-9]+([\-][A-Z0-9]+)*([\.][A-Z0-9\-]+){1,8}$/i.test(c.get("fieldValue")||"")},validateError:function(d,f){var e=f.get("errorLabel")||"Field";return SC.$error("Invalid.Email(%@)".loc(e),e)}});SC.Validator.IsDate=SC.Validator.Date.extend({validate:function(e,g){var h=g.get("fieldValue");var f=!!h;if(f&&h.length){f=Date.isDate(h)}return f},validateError:function(d,f){var e=f.get("errorLabel")||"Field";return $error("Invalid.Date(%@)".loc(),f.get("errorLabel"))}});SC.Validator.CalTime=SC.Validator.extend({format:"hh:mm",separator:":",timeFormat:24,fieldValueForObject:function(e,d,f){return e},objectForFieldValue:function(R,Y,aa){var N=this.get("format"),L=aa.get("value"),Z=this.get("timeFormat"),I=Z===12?13:24,E,J,P,H,V,U=["a","am","p","pm"],T=R.charAt(R.length-1),Q=R.substr(R.length-2),O=U.indexOf(T)!==-1?T:((U.indexOf(Q)!==-1)?Q:null),K=U.indexOf(O)>=2,X=R,F=X.length;if(!isNaN(R)&&(R<0||R>=I)){return[L,Z]}if(Date.isDate(R,"h:m")){H=new Date(Date.getDateFromFormat(R,"h:m"))}else{if(Date.isDate(R,"h.m")){H=new Date(Date.getDateFromFormat(R,"h:m"))}}if(Date.isDate(R,"h")){H=new Date(Date.getDateFromFormat(R,"h"));H.setMinutes(0)}if(Date.isDate(R,"h:")){H=new Date(Date.getDateFromFormat(R,"h:"));H.setMinutes(0)}else{if(Date.isDate(R,"h.")){H=new Date(Date.getDateFromFormat(R,"h."));H.setMinutes(0)}}if(Date.isDate(R,":m")){H=new Date(Date.getDateFromFormat(R,":m"));H.setHours(0)}else{if(Date.isDate(R,".m")){H=new Date(Date.getDateFromFormat(R,".m"));H.setHours(0)}}if(Date.isDate(R,"H:m")){H=new Date(Date.getDateFromFormat(R,"H:m"))}else{if(Date.isDate(R,"H.m")){H=new Date(Date.getDateFromFormat(R,"H.m"))}}if(Date.isDate(R,"H:")){H=new Date(Date.getDateFromFormat(R,"H:"));H.setMinutes(0)}else{if(Date.isDate(R,"H.")){H=new Date(Date.getDateFromFormat(R,"H."));H.setMinutes(0)}}if(Date.isDate(R,"H")){H=new Date(Date.getDateFromFormat(R,"H"));H.setMinutes(0)}if(!SC.none(H)){E=R.split(this.get("separator")).objectAt(0);J=(E.toString().charAt(0)==="0")?parseInt(E.toString().charAt(1),10):parseInt(E,10);if(E.toString().charAt(0)==="0"||J>12){Z=24}else{if(N==="H:mm"&&(J===12||J===11||J===10)){Z=24}}L=H.format(N)}else{if(R.toLowerCase()==="Now".loc().toLowerCase()){V=CW.Date.create(null,CW.DATE_TIME);V._dateObj=Date.parse(R);V.parse(Date.parse(R));L=V.format(N);Z=24}else{if(R.toLowerCase()==="Midnight".loc().toLowerCase()){V=CW.Date.create(null,CW.DATE_TIME);V.hours(0).minutes(0);L=V.format(N);Z=24}else{if(R.toLowerCase()==="Noon".loc().toLowerCase()){V=CW.Date.create(null,CW.DATE_TIME);V.hours(12).minutes(0);L=V.format(N);Z=24}else{var M,a,b,S,W;if(O){X=R.substr(0,R.indexOf(O));F=X.length}if(!isNaN(X)){if(X<0||X>=I){return[L,Z]}M=parseInt(R.charAt(0),10);b=parseInt(R.charAt(1),10);a=parseInt(R.substr(0,2),10);S=parseInt(R.substr(2,2),10);W=parseInt(R.substr(1,2),10);switch(F){case 1:E=M;P=0;break;case 2:E=a<=23?a:M;P=a<=23?0:b;break;case 3:E=M;P=W;break;case 4:E=a;P=S;break}if(E<12&&K){E+=12}if(E===12&&!K){E=0}if(P>=0&&P<=59&&E>=0&&E<=23){V=CW.Date.create(null,CW.DATE_TIME);var G=new Date();G.setHours(parseInt(E,10));G.setMinutes(parseInt(P,10));G.setSeconds(0);G.setMilliseconds(0);V._dateObj=G;V._dateComponentDidChange();Z=24;L=V.format(N)}}}}}}return[L,Z]}});CW.ViewKeyHandlingHelpers={keyboardShortcuts:null,initMixin:function(){this._cwvkh_paneDidChange()},_cwvkh_paneDidChange:function(){var m,n,k,l,o,h=this,j;if(this.keyboardShortcuts&&this._cwvkh_lastPane!==this.get("pane")){k=this.get("pane");m=this.get("keyboardShortcuts");l=this._cwvkh_lastPane;if(l){for(n in m){l.deregisterKeyboardShortcut(n)}}if(k){for(n in m){o=m[n];if(typeof o==="string"||typeof o==="function"){j=o}else{h=o.target;j=o.action}k.registerKeyboardShortcut(n,h,j)}}this._cwvkh_lastPane=k}}.observes("pane"),registerKeyboardShortcut:function(f,j,k){if(!k){k=j;j=this}var g=this.keyboardShortcuts,h=this.get("pane");if(!g){g=this.keyboardShortcuts={}}g[f]={target:j,action:k};if(h&&(h!=this)){h.registerKeyboardShortcut(f,j,k)}},deregisterKeyboardShortcut:function(e){var d=this.keyboardShortcuts,f=this.get("pane");if(d){delete this.keyboardShortcuts[e];if(f&&(f!=this)){f.deregisterKeyboardShortcut(e)}}}};sc_require("system/response");CW.XDRResponse=CW.Response.extend({createRequest:function(){var d=new XDomainRequest(),c=this;d.timeout=null;d.onerror=function(){if(!c){return null}var a=c.finishRequest();if(a){c=null}return a};d.onload=function(){if(!c){return null}var a=c.finishRequest(200);if(a){c=null}return a};return d},setRequestHeaders:function(){},finishRequest:function(d){var c=this.get("rawRequest");c.readyState=4;c.status=d;return arguments.callee.base.apply(this,arguments)}});SC.View.reopen({init:function(b){b();this._lastTheme=this.get("theme");this._sc_view_lastRenderTheme=this.get("renderTheme")}.enhance(),themeName:null,baseThemeName:null,_sc_view_findThemeInParent:function(e,f,g){if(e){var h;if(f){h=f.find(e,g);if(h){return h}}if(!g){h=SC.Theme.find(e);if(h){return h}}return f.invisibleSubtheme(e)}return f},findThemeAtPathInParent:function(l,o,k){if(!l){return o}var m=l.split("."),h,j=m.length,n=o;for(h=0;h<j;h++){n=this._sc_view_findThemeInParent(m[h],n,k);k=YES}return n},theme:function(){return this.findThemeAtPathInParent(this.get("themeName"),this.get("baseTheme"))}.property("baseTheme","themeName").cacheable(),_sc_view_themeDidChange:function(){if(this._lastTheme===this.get("theme")){return}this._lastTheme=this.get("theme");var f=this.childViews,d=f.length,e;for(e=0;e<d;e++){f[e].notifyPropertyChange("baseTheme")}}.observes("theme"),baseTheme:function(){var d;var e=this.get("baseThemeName");if(e){return this.findThemeAtPathInParent(e,SC.Theme)}else{d=this.get("parentView");var f=d&&d.get("theme");return f||this.findThemeAtPathInParent(SC.defaultTheme,SC.Theme)}}.property("baseThemeName","parentView").cacheable(),renderStyle:null,renderTheme:function(){return this.findThemeAtPathInParent(this.get("renderStyle"),this.get("theme"))}.property("theme","renderStyle").cacheable(),_sc_view_renderThemeDidChange:function(){if(this._sc_view_lastRenderTheme===this.get("renderTheme")){return}this._sc_view_lastRenderTheme=this.get("renderTheme");if(this.get("layer")){this.replaceLayer()}}.observes("renderTheme"),renderDelegate:function(h,g){if(g){this._setRenderDelegate=g}if(this._setRenderDelegate){return this._setRenderDelegate}var f=this.get("renderDelegateName"),e;if(f){e=this.get("theme")[f];if(!e){throw'%@: Unable to locate render delegate "%@" in theme.'.fmt(this,f)}return e}return null}.property("renderDelegateName","renderTheme"),renderDelegateName:null,renderDelegateProxy:function(){return SC.View._RenderDelegateProxy.createForView(this)}.property("renderDelegate").cacheable(),render:function(d,f){var e=this.get("renderDelegate");if(e){if(f){e.render(this.get("renderDelegateProxy"),d)}else{e.update(this.get("renderDelegateProxy"),d.$())}}},applyAttributesToContext:function(l,m){var k=this.get("renderTheme");var o=k.classNames,h,j=o.length;for(h=0;h<j;h++){m.addClass(o[h])}l(m);var n=this.get("renderDelegate");if(n&&n.className){m.addClass(n.className)}}.enhance(),invokeRenderDelegateMethod:function(f,d){var e=this.get("renderDelegate");if(!e){return undefined}if(SC.typeOf(e[f])!==SC.T_FUNCTION){return undefined}d=SC.$A(arguments);d.shift();d.unshift(this.get("renderDelegateProxy"));return e[f].apply(e,d)}});SC.View._RenderDelegateProxy={isViewRenderDelegateProxy:YES,createForView:function(m){var l=SC.beget(this);var j=m.get("displayProperties"),k={};for(var g=0,h=j.length;g<h;g++){k[j[g]]=YES}k.theme=YES;l._displayPropertiesLookup=k;l.renderState={};l._view=m;return l},get:function(c){if(this[c]!==undefined){return this[c]}var d="display"+c.capitalize();if(this._displayPropertiesLookup[d]){return this._view.get(d)}else{if(this._displayPropertiesLookup[c]){return this._view.get(c)}}return undefined},didChangeFor:function(j){var f=arguments.length,g;for(g=1;g<f;g++){var h=arguments[g],k="display"+h.capitalize();if(this._displayPropertiesLookup[k]){if(this._view.didChangeFor(j,k)){return YES}}else{if(this._displayPropertiesLookup[h]){if(this._view.didChangeFor(j,h)){return YES}}}}return NO}};SC.propertyFromRenderDelegate=function(d,c){return function(b,a){if(a!==undefined){this["_set_rd_"+b]=a}var j=this["_set_rd_"+b];if(j!==undefined){return j}var k=this.get("renderDelegate");if(k&&k.get){var h=this.get("renderDelegateProxy");j=k.getPropertyFor(h,d)}if(j!==undefined){return j}return c}.property("renderDelegate","controlSize").cacheable()};(function(F){var y=typeof module!=="undefined"&&module.exports,K=function(a){return y?require("./"+a):window[a]},J=K("punycode"),I=K("IPv6"),D=K("SecondLevelDomains"),C=function(b,a){if(!(this instanceof C)){return new C(b)}if(b===F){b=location.href+""}this.href(b);if(a!==F){return this.absoluteTo(a)}return this},v=C.prototype;function H(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function x(a){return String(Object.prototype.toString.call(a))==="[object Array]"}function z(b,c){var a={},e,d;if(x(c)){for(e=0,d=c.length;e<d;e++){a[c[e]]=true}}else{a[c]=true}for(e=0,d=b.length;e<d;e++){if(a[b[e]]!==F){b.splice(e,1);d--;e--}}return b}C.idn_expression=/[^a-z0-9\.-]/i;C.punycode_expression=/(xn--)/i;C.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;C.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;C.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/ig;C.defaultPorts={http:"80",https:"443",ftp:"21"};C.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;C.encode=encodeURIComponent;C.decode=decodeURIComponent;C.iso8859=function(){C.encode=escape;C.decode=unescape};C.unicode=function(){C.encode=encodeURIComponent;C.decode=decodeURIComponent};C.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}}};C.encodeQuery=function(a){return C.encode(a+"").replace(/%20/g,"+")};C.decodeQuery=function(a){return C.decode((a+"").replace(/\+/g,"%20"))};C.recodePath=function(c){var d=(c+"").split("/");for(var b=0,a=d.length;b<a;b++){d[b]=C.encodePathSegment(C.decode(d[b]))}return d.join("/")};C.decodePath=function(c){var d=(c+"").split("/");for(var b=0,a=d.length;b<a;b++){d[b]=C.decodePathSegment(d[b])}return d.join("/")};var G={encode:"encode",decode:"decode"},E,B=function(a){return function(b){return C[a](b+"").replace(C.characters.pathname[a].expression,function(c){return C.characters.pathname[a].map[c]})}};for(E in G){C[E+"PathSegment"]=B(G[E])}C.parse=function(d){var a,c,b={};a=d.indexOf("#");if(a>-1){b.fragment=d.substring(a+1)||null;d=d.substring(0,a)}a=d.indexOf("?");if(a>-1){b.query=d.substring(a+1)||null;d=d.substring(0,a)}if(d.substring(0,2)==="//"){b.protocol="";d=d.substring(2);d=C.parseAuthority(d,b)}else{a=d.indexOf(":");if(a>-1){b.protocol=d.substring(0,a);if(d.substring(a+1,a+3)==="//"){d=d.substring(a+3);d=C.parseAuthority(d,b)}else{d=d.substring(a+1);b.urn=true}}}b.path=d;return b};C.parseHost=function(e,c){var a=e.indexOf("/"),d;if(a===-1){a=e.length}if(e[0]==="["){var b=e.indexOf("]");c.hostname=e.substring(1,b)||null;c.port=e.substring(b+2,a)||null}else{if(e.indexOf(":")!==e.lastIndexOf(":")){c.hostname=e.substring(0,a)||null;c.port=null}else{d=e.substring(0,a).split(":");c.hostname=d[0]||null;c.port=d[1]||null}}if(c.hostname&&e.substring(a)[0]!=="/"){a++;e="/"+e}return e.substring(a)||"/"};C.parseAuthority=function(b,a){b=C.parseUserinfo(b,a);return C.parseHost(b,a)};C.parseUserinfo=function(d,b){var a=d.indexOf("@"),e=d.indexOf("/"),c;if(a>-1&&(e===-1||a<e)){c=d.substring(0,a).split(":");b.username=c[0]?C.decode(c[0]):null;b.password=c[1]?C.decode(c[1]):null;d=d.substring(a+1)}else{b.username=null;b.password=null}return d};C.parseQuery=function(a){if(!a){return{}}a=a.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!a){return{}}var c={},f=a.split("&"),e=f.length;for(var h=0;h<e;h++){var d=f[h].split("="),b=C.decodeQuery(d.shift()),g=d.length?C.decodeQuery(d.join("=")):null;if(c[b]){if(typeof c[b]==="string"){c[b]=[c[b]]}c[b].push(g)}else{c[b]=g}}return c};C.build=function(a){var b="";if(a.protocol){b+=a.protocol+":"}if(!a.urn&&(b||a.hostname)){b+="//"}b+=(C.buildAuthority(a)||"");if(typeof a.path==="string"){if(a.path[0]!=="/"&&typeof a.hostname==="string"){b+="/"}b+=a.path}if(typeof a.query=="string"){b+="?"+a.query}if(typeof a.fragment==="string"){b+="#"+a.fragment}return b};C.buildHost=function(a){var b="";if(!a.hostname){return""}else{if(C.ip6_expression.test(a.hostname)){if(a.port){b+="["+a.hostname+"]:"+a.port}else{b+=a.hostname}}else{b+=a.hostname;if(a.port){b+=":"+a.port}}}return b};C.buildAuthority=function(a){return C.buildUserinfo(a)+C.buildHost(a)};C.buildUserinfo=function(a){var b="";if(a.username){b+=C.encode(a.username);if(a.password){b+=":"+C.encode(a.password)}b+="@"}return b};C.buildQuery=function(a,f){var c="";for(var d in a){if(Object.hasOwnProperty.call(a,d)&&d){if(x(a[d])){var g={};for(var e=0,b=a[d].length;e<b;e++){if(a[d][e]!==F&&g[a[d][e]+""]===F){c+="&"+C.buildQueryParameter(d,a[d][e]);if(f!==true){g[a[d][e]+""]=true}}}}else{if(a[d]!==F){c+="&"+C.buildQueryParameter(d,a[d])}}}}return c.substring(1)};C.buildQueryParameter=function(b,a){return C.encodeQuery(b)+(a!==null?"="+C.encodeQuery(a):"")};C.addQuery=function(a,d,b){if(typeof d==="object"){for(var c in d){if(Object.prototype.hasOwnProperty.call(d,c)){C.addQuery(a,c,d[c])}}}else{if(typeof d==="string"){if(a[d]===F){a[d]=b;return}else{if(typeof a[d]==="string"){a[d]=[a[d]]}}if(!x(b)){b=[b]}a[d]=a[d].concat(b)}else{throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")}}};C.removeQuery=function(f,e,a){if(x(e)){for(var c=0,b=e.length;c<b;c++){f[e[c]]=F}}else{if(typeof e==="object"){for(var d in e){if(Object.prototype.hasOwnProperty.call(e,d)){C.removeQuery(f,d,e[d])}}}else{if(typeof e==="string"){if(a!==F){if(f[e]===a){f[e]=F}else{if(x(f[e])){f[e]=z(f[e],a)}}}else{f[e]=F}}else{throw new TypeError("URI.addQuery() accepts an object, string as the first parameter")}}}};C.commonPath=function(c,d){var b=Math.min(c.length,d.length),a;for(a=0;a<b;a++){if(c[a]!==d[a]){a--;break}}if(a<1){return c[0]===d[0]&&c[0]==="/"?"/":""}if(c[a]!=="/"){a=c.substring(0,a).lastIndexOf("/")}return c.substring(0,a+1)};C.withinString=function(b,a){return b.replace(C.find_uri_expression,a)};C.ensureValidHostname=function(a){if(a.match(C.invalid_hostname_characters)){if(!J){throw new TypeError("Hostname '"+a+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available")}if(J.toASCII(a).match(C.invalid_hostname_characters)){throw new TypeError("Hostname '"+a+"' contains characters other than [A-Z0-9.-]")}}};v.build=function(a){if(a===true){this._deferred_build=true}else{if(a===F||this._deferred_build){this._string=C.build(this._parts);this._deferred_build=false}}return this};v.toString=function(){return this.build(false)._string};v.valueOf=function(){return this.toString()};G={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"};B=function(a){return function(c,b){if(c===F){return this._parts[a]||""}else{this._parts[a]=c;this.build(!b);return this}}};for(E in G){v[E]=B(G[E])}G={query:"?",fragment:"#"};B=function(b,a){return function(d,c){if(d===F){return this._parts[b]||""}else{if(d!==null){d=d+"";if(d[0]===a){d=d.substring(1)}}this._parts[b]=d;this.build(!c);return this}}};for(E in G){v[E]=B(E,G[E])}G={search:["?","query"],hash:["#","fragment"]};B=function(b,a){return function(d,e){var c=this[b](d,e);return typeof c==="string"&&c.length?(a+c):c}};for(E in G){v[E]=B(G[E][1],G[E][0])}v.pathname=function(c,a){if(c===F||c===true){var b=this._parts.path||(this._parts.urn?"":"/");return c?C.decodePath(b):b}else{this._parts.path=c?C.recodePath(c):"/";this.build(!a);return this}};v.path=v.pathname;v.href=function(e,f){if(e===F){return this.toString()}else{this._string="";this._parts={protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null};var c=e instanceof C,b=typeof e==="object"&&(e.hostname||e.path),d;if(typeof e==="string"){this._parts=C.parse(e)}else{if(c||b){var a=c?e._parts:e;for(d in a){if(Object.hasOwnProperty.call(this._parts,d)){this._parts[d]=a[d]}}}else{throw new TypeError("invalid input")}}this.build(!f);return this}};v.is=function(a){var f=false,e=false,g=false,j=false,b=false,h=false,d=false,c=!this._parts.urn;if(this._parts.hostname){c=false;e=C.ip4_expression.test(this._parts.hostname);g=C.ip6_expression.test(this._parts.hostname);f=e||g;j=!f;b=j&&D&&D.has(this._parts.hostname);h=j&&C.idn_expression.test(this._parts.hostname);d=j&&C.punycode_expression.test(this._parts.hostname)}switch(a.toLowerCase()){case"relative":return c;case"absolute":return !c;case"domain":case"name":return j;case"sld":return b;case"ip":return f;case"ip4":case"ipv4":case"inet4":return e;case"ip6":case"ipv6":case"inet6":return g;case"idn":return h;case"url":return !this._parts.urn;case"urn":return !!this._parts.urn;case"punycode":return d}return null};var p=v.protocol,L=v.port,q=v.hostname;v.protocol=function(b,a){if(b!==F){if(b){b=b.replace(/:(\/\/)?$/,"");if(b.match(/[^a-zA-z0-9\.+-]/)){throw new TypeError("Protocol '"+b+"' contains characters other than [A-Z0-9.+-]")}}}return p.call(this,b,a)};v.scheme=v.protocol;v.port=function(b,a){if(this._parts.urn){return b===F?"":this}if(b!==F){if(b===0){b=null}if(b){b+="";if(b[0]===":"){b=b.substring(1)}if(b.match(/[^0-9]/)){throw new TypeError("Port '"+b+"' contains characters other than [0-9]")}}}return L.call(this,b,a)};v.hostname=function(b,a){if(this._parts.urn){return b===F?"":this}if(b!==F){var c={};C.parseHost(b,c);b=c.hostname}return q.call(this,b,a)};v.host=function(b,a){if(this._parts.urn){return b===F?"":this}if(b===F){return this._parts.hostname?C.buildHost(this._parts):""}else{C.parseHost(b,this._parts);this.build(!a);return this}};v.authority=function(b,a){if(this._parts.urn){return b===F?"":this}if(b===F){return this._parts.hostname?C.buildAuthority(this._parts):""}else{C.parseAuthority(b,this._parts);this.build(!a);return this}};v.userinfo=function(c,a){if(this._parts.urn){return c===F?"":this}if(c===F){if(!this._parts.username){return""}var b=C.buildUserinfo(this._parts);return b.substring(0,b.length-1)}else{if(c[c.length-1]!=="@"){c+="@"}C.parseUserinfo(c,this._parts);this.build(!a);return this}};v.subdomain=function(c,e){if(this._parts.urn){return c===F?"":this}if(c===F){if(!this._parts.hostname||this.is("IP")){return""}var d=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,d)||""}else{var f=this._parts.hostname.length-this.domain().length,a=this._parts.hostname.substring(0,f),b=new RegExp("^"+H(a));if(c&&c[c.length-1]!=="."){c+="."}if(c){C.ensureValidHostname(c)}this._parts.hostname=this._parts.hostname.replace(b,c);this.build(!e);return this}};v.domain=function(c,e){if(this._parts.urn){return c===F?"":this}if(typeof c=="boolean"){e=c;c=F}if(c===F){if(!this._parts.hostname||this.is("IP")){return""}var a=this._parts.hostname.match(/\./g);if(!a){return this._parts.hostname}if(a.length<2){return this._parts.hostname}var d=this._parts.hostname.length-this.tld(e).length-1;d=this._parts.hostname.lastIndexOf(".",d-1)+1;return this._parts.hostname.substring(d)||""}else{if(!c){throw new TypeError("cannot set domain empty")}C.ensureValidHostname(c);if(!this._parts.hostname||this.is("IP")){this._parts.hostname=c}else{var b=new RegExp(H(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(b,c)}this.build(!e);return this}};v.tld=function(d,a){if(this._parts.urn){return d===F?"":this}if(typeof d=="boolean"){a=d;d=F}if(d===F){if(!this._parts.hostname||this.is("IP")){return""}var e=this._parts.hostname.lastIndexOf("."),c=this._parts.hostname.substring(e+1);if(a!==true&&D&&D.list[c.toLowerCase()]){return D.get(this._parts.hostname)||c}return c}else{var b;if(!d){throw new TypeError("cannot set TLD empty")}else{if(d.match(/[^a-zA-Z0-9-]/)){if(D&&D.is(d)){b=new RegExp(H(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(b,d)}else{throw new TypeError("TLD '"+d+"' contains characters other than [A-Z0-9]")}}else{if(!this._parts.hostname||this.is("IP")){throw new ReferenceError("cannot set TLD on non-domain host")}else{b=new RegExp(H(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(b,d)}}}this.build(!a);return this}};v.directory=function(b,g){if(this._parts.urn){return b===F?"":this}if(b===F||b===true){if(!this._parts.path||this._parts.path==="/"){return"/"}var c=this._parts.path.length-this.filename().length-1,f=this._parts.path.substring(0,c)||"/";return b?C.decodePath(f):f}else{var e=this._parts.path.length-this.filename().length,d=this._parts.path.substring(0,e),a=new RegExp("^"+H(d));if(!this.is("relative")){if(!b){b="/"}if(b[0]!=="/"){b="/"+b}}if(b&&b[b.length-1]!=="/"){b+="/"}b=C.recodePath(b);this._parts.path=this._parts.path.replace(a,b);this.build(!g);return this}};v.filename=function(c,f){if(this._parts.urn){return c===F?"":this}if(c===F||c===true){if(!this._parts.path||this._parts.path==="/"){return""}var e=this._parts.path.lastIndexOf("/"),a=this._parts.path.substring(e+1);return c?C.decodePathSegment(a):a}else{var d=false;if(c[0]==="/"){c=c.substring(1)}if(c.match(/\.?\//)){d=true}var b=new RegExp(H(this.filename())+"$");c=C.recodePath(c);this._parts.path=this._parts.path.replace(b,c);if(d){this.normalizePath(f)}else{this.build(!f)}return this}};v.suffix=function(c,h){if(this._parts.urn){return c===F?"":this}if(c===F||c===true){if(!this._parts.path||this._parts.path==="/"){return""}var d=this.filename(),f=d.lastIndexOf("."),g,a;if(f===-1){return""}g=d.substring(f+1);a=(/^[a-z0-9%]+$/i).test(g)?g:"";return c?C.decodePathSegment(a):a}else{if(c[0]==="."){c=c.substring(1)}var e=this.suffix(),b;if(!e){if(!c){return this}this._parts.path+="."+C.recodePath(c)}else{if(!c){b=new RegExp(H("."+e)+"$")}else{b=new RegExp(H(e)+"$")}}if(b){c=C.recodePath(c);this._parts.path=this._parts.path.replace(b,c)}this.build(!h);return this}};var w=v.query;v.query=function(b,a){if(b===true){return C.parseQuery(this._parts.query)}else{if(b!==F&&typeof b!=="string"){this._parts.query=C.buildQuery(b);this.build(!a);return this}else{return w.call(this,b,a)}}};v.addQuery=function(d,b,a){var c=C.parseQuery(this._parts.query);C.addQuery(c,d,b);this._parts.query=C.buildQuery(c);if(typeof d!=="string"){a=b}this.build(!a);return this};v.removeQuery=function(d,b,a){var c=C.parseQuery(this._parts.query);C.removeQuery(c,d,b);this._parts.query=C.buildQuery(c);if(typeof d!=="string"){a=b}this.build(!a);return this};v.addSearch=v.addQuery;v.removeSearch=v.removeQuery;v.normalize=function(){if(this._parts.urn){return this.normalizeProtocol(false).normalizeQuery(false).normalizeFragment(false).build()}return this.normalizeProtocol(false).normalizeHostname(false).normalizePort(false).normalizePath(false).normalizeQuery(false).normalizeFragment(false).build()};v.normalizeProtocol=function(a){if(typeof this._parts.protocol==="string"){this._parts.protocol=this._parts.protocol.toLowerCase();this.build(!a)}return this};v.normalizeHostname=function(a){if(this._parts.hostname){if(this.is("IDN")&&J){this._parts.hostname=J.toASCII(this._parts.hostname)}else{if(this.is("IPv6")&&I){this._parts.hostname=I.best(this._parts.hostname)}}this._parts.hostname=this._parts.hostname.toLowerCase();this.build(!a)}return this};v.normalizePort=function(a){if(typeof this._parts.protocol==="string"&&this._parts.port===C.defaultPorts[this._parts.protocol]){this._parts.port=null;this.build(!a)}return this};v.normalizePath=function(f){if(this._parts.urn){return this}if(!this._parts.path||this._parts.path==="/"){return this}var c,d,b=this._parts.path,a,e;if(b[0]!=="/"){if(b[0]==="."){d=b.substring(0,b.indexOf("/"))}c=true;b="/"+b}b=b.replace(/(\/(\.\/)+)|\/{2,}/g,"/");while(true){a=b.indexOf("/../");if(a===-1){break}else{if(a===0){b=b.substring(3);break}}e=b.substring(0,a).lastIndexOf("/");if(e===-1){e=a}b=b.substring(0,e)+b.substring(a+3)}if(c&&this.is("relative")){if(d){b=d+b}else{b=b.substring(1)}}b=C.recodePath(b);this._parts.path=b;this.build(!f);return this};v.normalizePathname=v.normalizePath;v.normalizeQuery=function(a){if(typeof this._parts.query==="string"){if(!this._parts.query.length){this._parts.query=null}else{this.query(C.parseQuery(this._parts.query))}this.build(!a)}return this};v.normalizeFragment=function(a){if(!this._parts.fragment){this._parts.fragment=null;this.build(!a)}return this};v.normalizeSearch=v.normalizeQuery;v.normalizeHash=v.normalizeFragment;v.iso8859=function(){var b=C.encode,a=C.decode;C.encode=escape;C.decode=decodeURIComponent;this.normalize();C.encode=b;C.decode=a;return this};v.unicode=function(){var b=C.encode,a=C.decode;C.encode=encodeURIComponent;C.decode=unescape;this.normalize();C.encode=b;C.decode=a;return this};v.readable=function(){var g=new C(this);g.username("").password("").normalize();var a="";if(g._parts.protocol){a+=g._parts.protocol+"://"}if(g._parts.hostname){if(g.is("punycode")&&J){a+=J.toUnicode(g._parts.hostname);if(g._parts.port){a+=":"+g._parts.port}}else{a+=g.host()}}if(g._parts.hostname&&g._parts.path&&g._parts.path[0]!=="/"){a+="/"}a+=g.path(true);if(g._parts.query){var f="";for(var b=0,c=g._parts.query.split("&"),d=c.length;b<d;b++){var e=(c[b]||"").split("=");f+="&"+C.decodeQuery(e[0]).replace(/&/g,"%26");if(e[1]!==F){f+="="+C.decodeQuery(e[1]).replace(/&/g,"%26")}}a+="?"+f.substring(1)}a+=g.hash();return a};v.absoluteTo=function(a){if(this._parts.urn){throw new Error("URNs do not have any generally defined hierachical components")}if(!this.is("relative")){throw new Error("Cannot resolve non-relative URL")}if(!(a instanceof C)){a=new C(a)}var d=new C(this),b=["protocol","username","password","hostname","port"];for(var c=0,e;e=b[c];c++){d._parts[e]=a._parts[e]}if(d.path()[0]!=="/"){d._parts.path=a.directory()+"/"+d._parts.path;d.normalizePath()}d.build();return d};v.relativeTo=function(g){if(this._parts.urn){throw new Error("URNs do not have any generally defined hierachical components")}if(!(g instanceof C)){g=new C(g)}if(this.path()[0]!=="/"||g.path()[0]!=="/"){throw new Error("Cannot calculate common path from non-relative URLs")}var j=new C(this),d=["protocol","username","password","hostname","port"],e=C.commonPath(j.path(),g.path()),k=g.directory();for(var f=0,h;h=d[f];f++){j._parts[h]=null}if(!e||e==="/"){return j}if(k+"/"===e){j._parts.path="./"+j.filename()}else{var a="../",c=new RegExp("^"+H(e)),b=k.replace(c,"/").match(/\//g).length-1;while(b--){a+="../"}j._parts.path=j._parts.path.replace(c,a)}j.build();return j};v.equals=function(c){var h=new C(this),l=new C(c),g={},e={},d={},f,a,b;h.normalize();l.normalize();if(h.toString()===l.toString()){return true}f=h.query();a=l.query();h.query("");l.query("");if(h.toString()!==l.toString()){return false}if(f.length!==a.length){return false}g=C.parseQuery(f);e=C.parseQuery(a);for(b in g){if(Object.prototype.hasOwnProperty.call(g,b)){if(!x(g[b])){if(g[b]!==e[b]){return false}}else{if(!x(e[b])){return false}if(g[b].length!==e[b].length){return false}g[b].sort();e[b].sort();for(var j=0,k=g[b].length;j<k;j++){if(g[b][j]!==e[b][j]){return false}}}d[b]=true}}for(b in e){if(Object.prototype.hasOwnProperty.call(e,b)){if(!d[b]){return false}}}return true};(typeof module!=="undefined"&&module.exports?module.exports=C:window.URI=C)})();sc_require("URI.js");(function(e,f){var d=e.prototype;d.baseEquals=function(a){var b=new e(this).normalize(),c=new e(a).normalize(),j=b.protocol()+"://"+b.domain()+":"+b.port(),k=c.protocol()+"://"+c.domain()+":"+c.port();return j===k}})(window.URI);sc_require("URI.js");(function(e,f){var d=e.prototype;d.sortQuery=function(){var a=this._parts.query;if(!a.length){this._parts.query=null}else{var k=e.parseQuery(a),l,m,c,b;this.query(null);b=CW.invertHash(k).sort();for(l=0,m=b.length;l<m;l++){c=b[l];this.addQuery(c,k[c])}}return this}})(window.URI);if(!window.CW){window.CW={}}(function(){var b=CW.Animator=CW.Anim={fps:60,tasks:[],speedMultiplier:1,frameCount:0,isActive:false,isInFrame:false,extraStatus:{},ENABLE_OLD_IE:true,_runningCWAguid:0,_hasSC:!!(window.SC&&SC.RunLoop&&SC.Object),_frameTimeNoiseLevelingWindowSize:30,_frameNoiseLevelerLog:[],_movingAverageFrameTime:function(){for(var g=0,f=b._frameNoiseLevelerLog,h=0,a=f.length;g<a;g++){h+=f[g]}return Math.round(10*h/(a||1))/10},init:function(){b.prepareObject();b.stop();b.useRAF=b.IS_MOBILE&&window.requestAnimationFrame&&window.cancelRequestAnimationFrame;b.lock16=b.IS_MOBILE&&!b.useRAF},nextFrame:function(x,o){b.isInFrame=true;var p,n=b._frameNoiseLevelerLog,v=b._frameTimeNoiseLevelingWindowSize,t,s;t=(b._lastFrameTime===-1)?new Date().valueOf():b._lastFrameTime;b._lastFrameTime=new Date().valueOf();s=t=b._lastFrameTime-t;b.now=b._lastFrameTime;if(b.firstActiveFrame){t=0}if(t>=300&&t>=(p=Math.max(b._movingAverageFrameTime(),300/5))*5){t=0;n.unshift(p/2)}else{n.unshift(t)}(n.length<=v)||(n.length=v);b.frameTime=t;var w=!b._hasSC||SC.RunLoop.isRunLoopInProgress();if(!b.shouldSkipFrame||!b.shouldSkipFrame()){if(!w){SC.RunLoop.begin();b._SCLoopBegan()}b.trigger("preframe");for(var q=0,u;u=b.tasks[q];q++){if(u.running){u.elapse(t*b.speedMultiplier)}}for(q=0;u=b.tasks[q];q++){if(!u.running){u._inCWATasks=false;b.tasks.splice(q--,1)}}b.trigger("frame");if(!w){SC.RunLoop.end();b._SCLoopEnded()}b.isActive=!!b.tasks.length;b.frameCount++}b.frameRate=Math.round(100*1000/s)/100;b.computeTime=new Date().valueOf()-b.now;var a=Math.round(1000/b.fps);b.timeoutWaitTime=Math.max(0,a-b.computeTime);b.clearNextTimeout();if(!o&&b.isActive){if(b.useRAF){b._timeout=requestAnimationFrame(b.nextFrame,document.body)}else{b._timeout=setTimeout(b.nextFrame,b.lock16?16:b.timeoutWaitTime)}}else{b.stop()}if(b.firstActiveFrame){b.firstActiveFrame=false}b.isInFrame=false},start:function(){if(b.isActive||b.isInFrame){return}b.firstActiveFrame=true;b.isActive=true;b._lastFrameTime=-1;b.frameTime=1000/b.fps;b.frameRate=1000/b.frameTime;b.computeTime=0;b.trigger("start");b.nextFrame()},stop:function(){b.isActive=false;b.frameTime=Infinity;b.frameRate=0;b.computeTime=NaN;b.timeoutWaitTime=NaN;b.clearNextTimeout();b.trigger("stop")},clearNextTimeout:function(){if(!b._timeout){return}if(b.useRAF){cancelRequestAnimationFrame(b._timeout)}else{clearTimeout(b._timeout)}b._timeout=0},handleTask:function(h){if(!h||h.isDestroyed){return}if(!h._inCWATasks){if(h.name){for(var g=0,f=b.tasks,a;a=f[g];g++){if(a.name===h.name){a.stop()}}}b.tasks.push(h)}h._inCWATasks=true;b.start()},tellStop:function(){arguments._isArgs_=true;this.performMethodOn("stop",arguments)},tellFinish:function(){arguments._isArgs_=true;this.performMethodOn("finish",arguments)},performMethodOn:function(o,m){var j=1,l=arguments;if(m&&m._isArgs_){j=0;l=m}for(var n=j,k,a=l.length;n<a;n++){if((k=l[n])&&k[o]){k[o]()}}},trigger:function(k,m){if(this.isDestroyed){return}var a,h;if((a=this["on"+k]||this["on"+k.charAt(0).toUpperCase()+k.substring(1)]) instanceof Function){a.call(this,m)}if(!(h=this["__"+k+"Listeners__"])){return}for(var l=0,j;l<h.length;l++){if(!((j=h[l]) instanceof Function)){continue}j.call(this,m)}},clearTrigger:function(a){var d=this["__"+a+"Listeners__"];if(!d){return}d.length=0},listen:function(p,k){if(!p){return}if(!k){k=p;var m=k._listens;if(m){for(var q=0;p=m[q];q++){this.listen(p,k)}}return}var n="__"+p+"Listeners__";if(!this.hasOwnProperty(n)){if(!this[n]){this[n]=[]}else{for(var o=[],a=0,j=this[n].length;a<j;a++){o.push(this[n][a])}this[n]=o}}this[n].push(k)},unlisten:function(j,w){if(!j){return}if(!w){w=j;var a=w._listens;if(a){for(var t=0;j=a[t];t++){this.unlisten(j,w)}}return}var q="__"+j+"Listeners__";if(!this[q]){return}if(!this.hasOwnProperty(q)){for(var x=[],u=0,k=this[q].length;u<k;u++){x.push(this[q][u])}this[q]=x}for(var s=0,l=this[q],v=l.length;s<v;s++){if(l[s]===w){l[s]=undefined}}},setIfChanged:function(e,f){var a=this[e];this[e]=f;if(f!==a){this.trigger(e)}return f},get:function(a){return this[a]},set:function(d,a){this[d]=a;this.trigger(d);return a},cloneFunction:function(g){var h=g.clonedFrom;if(h){return h.clone()}var f=function(){var c=arguments.callee.clonedFrom,d=c.base,e;c.base=arguments.callee.base;e=arguments.callee.clonedFrom.apply(this,arguments);c.base=d;return e};for(var a in g){if(g.hasOwnProperty(a)){f[a]=g[a]}}f.clonedFrom=g;f.toString=function(){return"Clone of "+this.clonedFrom.toString()};return f},toString:function(){return"[The CoreWeb Animator]"},prepareObject:function(){var a=Function.prototype;a.listens=function(){var g=!this._listens,h=(this._listens||(this._listens=[]));if(g){h.length=0}for(var j=0,k=arguments.length;j<k;j++){h.push(arguments[j])}return this};if(!a.observes){a.observes=a.listens}b.Object=b._hasSC?b.prepareSCObject():b.prepareOwnObject()},prepareOwnObject:function(){var a=function(){};a.prototype={className:"Object",init:function(){this._cwaguid=++b._runningCWAguid},mixin:function(u){if(!arguments.length){return this}for(var y=0,C=arguments.length,B,w,z,v,x,s,t,D,j,l;y<C;y++){z=arguments[y];t=z.isMixin;for(s in z){j=this["suffixes"];if(!z.hasOwnProperty(s)||s==="isMixin"){continue}v=this[s];x=z[s];if((D=this[s+"Override"])&&(D instanceof Function||(D=this[D]) instanceof Function)){x=D.call(this,x,v,s)}for(B=0;l=j&&j[B];B++){if(s.slice(-l.length)===l){if((D=this["*"+l+"Override"])&&(D instanceof Function||(D=this[D]) instanceof Function)){x=D.call(this,x,v,s)}}}if(v instanceof Function){if(t&&x instanceof Function){x=b.cloneFunction(x)}x.base=v;if(v._listens){this.unlisten(v)}}if(x instanceof Function&&x._listens){this.listen(x)}this[s]=x}}return this},trigger:b.trigger,listen:b.listen,unlisten:b.unlisten,clearTrigger:b.clearTrigger,toString:b._objectToString,get:b.get,set:b.set,setIfChanged:b.setIfChanged};a.isClass=true;a.create=function(){var d;if(!arguments.length){d=new this()}else{d=new (this.extend.apply(this,arguments))()}d._type=this;d.init();return d};a.extend=function(){var h=function(){};var f=new this();f.mixin.apply(f,arguments);for(var g in this){if(!this.hasOwnProperty(g)){continue}h[g]=this[g]}h.prototype=f;return h};return a},prepareSCObject:function(){var a=SC.Object.extend({className:"CW.Anim.Object",init:function(){arguments.callee.base.call(this);this._cwaguid=++b._runningCWAguid},trigger:b.trigger,listen:b.listen,unlisten:b.unlisten,clearTrigger:b.clearTrigger,toString:b._objectToString,setIfChanged:b.setIfChanged});var g=function(e,m){for(var n,c,d=0;n=e[d];d++){if(typeof n!=="object"){continue}for(i in n){if(!n.hasOwnProperty(i)){continue}if(!((func=n[i]) instanceof Function)||!func._listens){continue}m.listen(func)}}};var f=function(){var c=arguments.callee.base.apply(this,arguments);c.prototype._type=this;g(arguments,c.prototype);return c};f.base=a.extend;a.extend=f;var h=function(){var c=arguments.callee.base.apply(this,arguments);g(arguments,c);return c};h.base=a.create;a.create=h;return a},_objectToString:function(){return"["+this.className+(this._cwaguid?":"+this._cwaguid:"")+"]"},asHTML:function(a){return a.split("\n").join("<BR>").split("  ").join(" &nbsp;")},toCamel:function(f,g){for(var h=0,a=f.length;h<a;h++){if(f.charAt(h)!=="-"||h==a-1){continue}f=f.substring(0,h)+f.charAt(h+1).toUpperCase()+f.substring(h+2);a--}return g?(f.charAt(0).toUpperCase()+f.substring(1)):f},toDashed:function(g){for(var h=0,a=g.length;h<a;h++){var c=g.charAt(h);if(c.toLowerCase()===c||h==a-1){continue}g=g.substring(0,h)+"-"+g.charAt(h).toLowerCase()+g.substring(h+1);a++}return g},getStyle:function(f,a){if(f.currentStyle){return f.currentStyle[b.toCamel(a)]}if(f.initialStyle){return f.initialStyle.getPropertyValue(a)}var e;if((e=document.defaultView)&&(e=(e.getComputedStyle))){return(f.initialStyle=e(f,null)).getPropertyValue(a)}},IS_MOBILE:!!((/ipad/).test(navigator.userAgent.toLowerCase())||(/iphone/).test(navigator.userAgent.toLowerCase())||(/ipod/).test(navigator.userAgent.toLowerCase())||(/android/).test(navigator.userAgent.toLowerCase())),getOpacity:function(f){if(!f){return -1}var a;if(((a=(f.cwa$opacity||f.getAttribute("cwa$opacity")))&&(a=parseFloat(a)))||a===0){return a}if(SC.browser.isIE8OrLower){try{a=parseInt(f.filters.item("DXImageTransform.Microsoft.Alpha").opacity,10)/100;return a}catch(e){}a=f.style.filter||b.getStyle(f,"filter");if(a){a=a.toLowerCase();if(a.indexOf("alpha(opacity=")!==-1){if((a=parseFloat(a.substring(a.indexOf("alpha(opacity=")+14))/100)||a===0){return a}}else{return 1}}else{return 1}}if(((a=(f.style.opacity||b.getStyle(f,"opacity")))&&(a=parseFloat(a)))||a===0){return parseFloat(a)}else{return 1}},setOpacity:function(h,e){var a=SC.browser.isIE8OrLower;if(!h){return -1}e=Math.max(0,Math.min(1,e));if(e>0.9999||isNaN(e)){return this.removeOpacity(h)}h.cwa$opacity=e;if(!a){h.style.opacity=e}else{if(h.hasIEAlpha){try{h.filters.item("DXImageTransform.Microsoft.Alpha").opacity=Math.round(e*100)}catch(g){h.hasIEAlpha=true;h.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+Math.round(e*100)+")"}}else{h.hasIEAlpha=true;h.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+Math.round(e*100)+")"}if(h.isIEAlphaDisabled){h.filters.item("DXImageTransform.Microsoft.Alpha").enabled=true;h.isIEAlphaDisabled=false}}return e},removeOpacity:function(f){if(!f){return -1}var a=SC.browser.isIE8OrLower;f.cwa$opacity=1;if(!a){f.style.opacity=""}else{if(f.hasIEAlpha){try{f.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100;f.filters.item("DXImageTransform.Microsoft.Alpha").enabled=false;f.isIEAlphaDisabled=true}catch(e){f.style.filter=""}}}return 1},encodeColor:function(a,f,g){if(typeof a==="object"&&typeof a.r==="number"&&typeof a.g==="number"&&typeof a.b==="number"){f=a.g;g=a.b;a=a.r}else{if(typeof a==="object"){f=a[1];g=a[2];a=a[0]}else{if(typeof a=="string"){if(a.charAt(0)=="#"&&a.length===7){return a}a=CW.Anim.decodeColor(a);f=a[1];g=a[2];a=a[0]}}}a=Math.round(Math.max(0,Math.min(255,a))).toString(16);if(a.length==1){a="0"+a}f=Math.round(Math.max(0,Math.min(255,f))).toString(16);if(f.length==1){f="0"+f}g=Math.round(Math.max(0,Math.min(255,g))).toString(16);if(g.length==1){g="0"+g}return("#"+a+f+g).toUpperCase()},decodeColor:function(l){if(b.colors&&b.colors[l]){l=b.colors[l]}var m,g,k,n;if((m=typeof l)=="number"||m=="object"){return undefined}l=l.replace(/\s+/g,"");if(l.charAt(0)=="#"){if(l.length==4){l="#"+l.charAt(1)+l.charAt(1)+l.charAt(2)+l.charAt(2)+l.charAt(3)+l.charAt(3)}g=parseInt(l.substring(1,3),16);k=parseInt(l.substring(3,5),16);n=parseInt(l.substring(5,7),16)}else{var a;if(l.indexOf("rgba(")!=-1){a=5}else{if(l.indexOf("rgb(")!=-1){a=4}else{return undefined}}l=l.substring(a,l.length-1).split(",");g=parseInt(l[0],10);k=parseInt(l[1],10);n=parseInt(l[2],10)}return[g,k,n]},colors:{red:"#ff0000","orange red":"#ff4500",orange:"#ff7f00",yellow:"#ffff00",green:"#00ff00","forest green":"#228b22",cyan:"#00ffff","light sea green":"#20b2aa",blue:"#0000ff","cornflower blue":"#6495ed","medium blue":"#3232cd",purple:"#a020f0","hot pink":"#ff69b4",magenta:"#ff00ff",white:"#ffffff","light gray":"#d3d3d3",gray:"#bebebe","dark gray":"#a9a9a9","dim gray":"#696969",black:"#000000"},initRandom:function(e,f,a){return{isInitRandom:true,lo:e,hi:f,round:a}},_improveSCCompatibility:function(){if(!b._hasSC){return}b._runLoopedTrigger=function(){var a=SC.RunLoop.isRunLoopInProgress();if(!a){SC.RunLoop.begin()}b._inSCLoop=true;var d=b._coreTrigger.apply(this,arguments);b._inSCLoop=false;if(!a){SC.RunLoop.end()}return d};b._coreTrigger=b.trigger;b.trigger=b._runLoopedTrigger},_SCLoopBegan:function(){b._inSCLoop=true;b.trigger=b.Object.prototype.trigger=b._coreTrigger},_SCLoopEnded:function(){b._inSCLoop=false;b.trigger=b.Object.prototype.trigger=b._runLoopedTrigger}}})();CW.Anim.init();CW.Anim._improveSCCompatibility();CW.Anim.Task=CW.Anim.Object.extend({className:"CW.Anim.Task",running:false,speedMultiplier:1,frameCount:0,elapsedTime:0,ticked:false,tickCount:0,start:function(){if(this.running){return this}this.running=true;this.elapsedTime=this.frameCount=this.tickCount=0;this.trigger("start");CW.Anim.handleTask(this);return this},stop:function(){if(!this.running){return this}this.running=false;this.trigger("stop");return this},elapse:function(k,l){if(this.isDestroyed){this.running=false;return this}if(!l&&this.shouldSkipFrame&&this.shouldSkipFrame()){return this}if(this._forcedZeroes){k=0;this._forcedZeroes--}k*=this.speedMultiplier;this.trigger("preframe");this.elapsedTime+=k;if(!this.ticked){this.trigger("pretick");if(this.run instanceof Function){this.run(k)}this.tickCount++;this.trigger("tick")}else{for(var j=this.ticked===true?1000/CW.Anim.fps:this.ticked,h=1+Math.floor(this.elapsedTime/j),m=h-this.tickCount,g=0;g<m;g++){this.trigger("pretick");if(this.run instanceof Function){this.run(j,g<m-1)}if(this.running){this.trigger("tick")}this.tickCount++}}if(this.running){this.trigger("frame");this.trigger("frame"+this.frameCount)}this.trigger("postFrame");this.clearTrigger("postFrame");this.frameCount++;return this},destroy:function(){if(arguments.callee.base){arguments.callee.base.apply(this,arguments)}this.isDestroyed=true;return this}});CW.Anim.Task.initiate=function(){var b=this.create.apply(this,arguments);b.start();return b};CW.Anim.tweens={make:function(g){var e=[];for(var h=1,f=arguments.length;h<f;h++){e.push(arguments[h])}return(function(){var b=e;b.l=b.length;var a=CW.Anim.tweens[g]||CW.Anim.tweens.LINEAR;return function(c){b[b.l]=c;return a.apply(this,b)}})()},compound:function(){var f=arguments.length;var g=arguments[f-1];for(var h=0,e;h<f-1&&(e=arguments[h]);h++){if(typeof e==="string"){g=A.tweens[e].call(this,g)}else{g=e.call(this,g)}}return g},LINEAR:function(b){return b},BOUNCE:function(a){var b;a=1-a;for(var g=0,h=1;1;g+=h,h/=2){if(a>=(7-4*g)/11){b=h*h-Math.pow((11-6*g-11*a)/4,2);break}}return 1-b},SINE_IN_OUT:function(b){return 0.5-0.5*Math.cos(Math.PI*b)},multiSineInOut:function(h,e){var g=h%1;h=Math.floor(h);for(var f=0;f<h;f++){e=0.5-0.5*Math.cos(Math.PI*e)}if(g){e=(1-g)*e+(g)*(0.5-0.5*Math.cos(Math.PI*e))}return e},QUADRATIC_IN:function(b){return b*b},QUADRATIC_OUT:function(b){return 1-(b=1-b)*b},WEBKIT_EASE:function(b){return CW.Anim.tweens.cubicBezier(0.25,0.1,0.25,1,b)},WEBKIT_LINEAR:function(b){return b},WEBKIT_EASE_IN:function(b){return CW.Anim.tweens.cubicBezier(0.42,0,1,1,b)},WEBKIT_EASE_OUT:function(b){return CW.Anim.tweens.cubicBezier(0,0,0.58,1,b)},WEBKIT_EASE_IN_OUT:function(b){return CW.Anim.tweens.cubicBezier(0.42,0,0.58,1,b)},cubicBezier:function(L,M,H,I,E){var N=5;var J=3*L,w=3*(H-L)-J,B=1-J-w,K=3*M,y=3*(I-M)-K,F=1-K-y,u=1/(200*N),C,D,G,x,v,z;for(G=E,z=0;z<8;z++){x=((B*G+w)*G+J)*G-E;if(Math.abs(x)<u){return((F*G+y)*G+K)*G}v=(3*B*G+2*w)*G+J;if(Math.abs(v)<0.000001){break}G=G-x/v}C=0;D=1;G=E;if(G<C){return((F*C+y)*C+K)*C}if(G>D){return((F*D+y)*D+K)*D}while(C<D){x=((B*G+w)*G+J)*G;if(Math.abs(x-E)<u){return((F*G+y)*G+K)*G}if(E>x){C=G}else{D=G}G=(D-C)*0.5+C}return((F*G+y)*G+K)*G},linearInterpolation:function(j,n){var k=j._length_||(j._length=j.length),o=n*k/k*(k-1),l=Math.floor(o),h=j[l];rem=o-l;if(rem===0){return h}var m=j[Math.ceil(o)];return h*(1-rem)+m*rem}};CW.Anim.Animation=CW.Animation=CW.Anim.Task.extend({className:"CW.Animation",isAnimation:true,init:function(){arguments.callee.base.call(this);if(!this.hasOwnProperty("animateOldIE")){this.animateOldIE=CW.Anim.ENABLE_OLD_IE}if(SC.browser.isIE8OrLower&&!this.animateOldIE){this.disabled=true}var j,k,m,g,l,h=this._type.prototype.freevars;if(typeof this.freevars==="string"){this.freevars=this.freevars.split(/\s+/)}if(this.freevars&&!this.freevars.length){this.freevars=[this.freevars]}if(this.freevars&&h&&this.freevars===h){l=[];for(k=0;k<(g||(g=this.freevars.length));k++){l.push(this.freevars[k])}this.freevars=l}if(this.freevars){if(this.speed===undefined&&this.duration===undefined&&!this.signal){this.duration=0}}for(k=-1,g=!!this.freevars&&this.freevars.length;k<g;k++){j=k===-1?this:this.freevars[k];if(typeof j==="string"){this[j].key=j;this.freevars[k]=j=this[j]}j=this.makeFreevarFromHash(j);if(j!==this){this.freevars[k]=j;if(j.key){this[j.key]=j}}}},makeFreevarFromHash:function(n){if(n._isFreevar){return n}var t=CW.Animation.defaultFreevar,o,v,s,q,p,u,m,j=n===this?this:{};for(s in n){if(!n.hasOwnProperty(s)){continue}if((q=n[s])&&q.isInitRandom===true){m=q.round;q=Math.random()*(q.hi-q.lo)+q.lo;if(m){q=Math.round(q/m)*m}j[s]=q}else{if(j!==n){j[s]=n[s]}}}if(j===this){for(s in t){if(j[s]===undefined){j[s]=t[s]}}}else{for(s in t){if(!j.hasOwnProperty(s)){j[s]=t[s]}}}if(j.signal){j.tween=undefined;o=this._returnExtendedFreevar(j,CW.Animation._signalFreevar);o._unsignaledCurrent=o.from}else{if(j.inertia){j.tween=undefined;o=this._returnExtendedFreevar(j,CW.Animation._inertiaFreevar);o._undampedCurrent=o.from;o.inertia!==true||(o.inertia=CW.Animation._inertiaFreevar.prototype.inertia);v=[];for(s=0;s<j.inertia-1;s++){v[s]=o._undampedCurrent}o.inertiaChain=v}else{o=this._returnExtendedFreevar(j,CW.Animation._tweenFreevar);o._untweenedCurrent=j.from;if(typeof o.speed==="number"){o.duration=undefined}}}o._isFreevar=true;o.freevarRun(0);return o},_returnExtendedFreevar:function(d,f){if(d===this){for(var e in f.prototype){if(this[e]===undefined){this[e]=f.prototype[e]}}return this}else{return new f(d)}},addFreevar:function(b){if(!b){return}if(b.key&&this[b.key]){return false}b=this.makeFreevarFromHash(b);if(b.key){this[b.key]=b}(this.freevars||(this.freevars=[])).push(b);return this},removeFreevar:function(c){if(typeof c==="string"){c=this[c]}if(!c||!c._isFreevar){return null}if(!this.freevars||!this.freevars.length){return null}if(c.key){this[c.key]=undefined}for(var d=0;d<this.freevars.length;d++){if(this.freevars[d]===c){this.freevars.splice(d--,1)}}return c},allFreevarsDo:function(f,m){var n,k,o=arguments.callee.args||(arguments.callee.args=[]);o.length=0;for(var l=1,j=arguments.length;l<j;l++){o.push(arguments[l])}this[f].apply(this,o);if(!(n=this.freevars)){return this}for(l=0;k=n[l];l++){k[f].apply(k,o)}return this},forceAll:function(b){this.allFreevarsDo("force",b);return this},resetAll:function(){this.allFreevarsDo("reset");return this},reverseAll:function(b){this.allFreevarsDo("reverse");return this},run:function(m,q){var k=true;var p=1;var n=Infinity;var l;for(var o=-1,j=(!!this.freevars&&this.freevars.length)||0;o<j;o++){l=(this.freevars&&this.freevars[o])||this;if(!l.freevarRun(m)){k=false}if(l.progress<p){p=l.progress}if(l.tweenedProgress<n){n=l.tweenedProgress}}if(this.freevars){this.progress=p;this.tweenedProgress=n}if(!q){this.update()}if(k){this.listen("postFrame",this._finishNaturally)}},start:function(){if(this.running){return this}if(this.disabled){this.allFreevarsDo("zeroOutDuration")}if(CW.Animator._hasSC){var d=SC.RunLoop.isRunLoopInProgress();if(!d){SC.RunLoop.begin()}}var c=arguments.callee.base.apply(this,arguments);if(CW.Anim.isActive){this.update();this.trigger("tick");this.trigger("frame")}if(!d&&CW.Animator._hasSC){SC.RunLoop.end()}return c},finish:function(e,f){if(!this.running){return this}if(!e){this.allFreevarsDo("force");if(!f){this.update();this.trigger("tick");this.trigger("frame")}}var d=this.stop();this.trigger("finish");if(this.repeat>0){this.repeat--;if(this.reverseOnRepeat){this.reverse()}else{this.reset()}this.start()}return d},_finishNaturally:function(){this.finish(true)},update:function(){},toString:function(){var b=arguments.callee.base.apply(this,arguments);b=b.substring(0,b.length-1)+(this.name?(" "+this.name):"")+(this.running?" running":"")+((this.freevars||this.inertia)?"":(" "+this.from+"-to-"+this.to+" "+this.duration+"ms "+Math.round(this.progress*100)+"%"))+"]";return b},destroy:function(){var b=arguments.callee.base.apply(this,arguments);this.update=this.run=this.finish=function(){};return b},recycle:function(){this.tickCount=this.frameCount=this.elapsedTime=this._forcedZeroes=0}});CW.Animation.defaultFreevar={tween:CW.Anim.tweens.WEBKIT_EASE,discreteness:0};CW.Animation._tweenFreevar=(function(){var b=function(a){for(var d in a){if(a.hasOwnProperty(d)){this[d]=a[d]}}};b.prototype={from:0,to:1,duration:1000,importants:undefined,isAlmostFinished:function(a){return Math.abs(this.to-this.current)<a},reverse:function(){var a=this.to;this.to=this.from;this.from=a;this.freevarRun(0);return this},reset:function(){this._untweenedCurrent=this.from;this.freevarRun(0);return this},redirectTo:function(a){this.from=this.current;this.to=a;this._untweenedCurrent=this.from;this.freevarRun(0);return this},redirectFrom:function(a){this.from=this._untweenedCurrent=a;this.freevarRun(0);return this},zeroOutDuration:function(){!this.duration||(this.duration=0);!this.speed||(this.speed=Infinity);return this},force:function(a){if(typeof a==="number"){this.to=a}this._untweenedCurrent=this.to;this.freevarRun(0);return this},freevarRun:function(l){if(this.duration===0||this.speed===Infinity){this._untweenedCurrent=this.to}var m=this,p=m._untweenedCurrent<m.to,n=m.isFinished=(m._untweenedCurrent===m.to),q=m.importants?(m.importants[m._impSpot||0]||undefined):undefined,a=q!==undefined?m._untweenedCurrent<q:undefined,f,o;if(m.to===m.from){m.current=m._untweenedCurrent=m.to;return m.isFinished=true}if(!n){o=m.speed||1000/m.duration*Math.abs(m.to-m.from);f=Math.abs(o*l/1000);if(p){m._untweenedCurrent+=f}else{m._untweenedCurrent-=f}if((a===true&&m._untweenedCurrent>q)||(a===false&&m._untweenedCurrent<q)){m._untweenedCurrent=q;m._impSpot=(m._impSpot||0)+1}if((m.isFinished=(p&&m._untweenedCurrent>=m.to)||(!p&&m._untweenedCurrent<=m.to))){m._untweenedCurrent=m.to}}if(m.from!==undefined&&m.to!==undefined){m.progress=(m._untweenedCurrent-m.from)/(m.to-m.from);if(m.tween instanceof Function&&m.from!=m.to){if(m.from===0&&m.to===1){m.current=m.tweenedProgress=m.tween.call(this,m._untweenedCurrent)}else{m.current=(m.tweenedProgress=m.tween.call(this,m.progress))*(m.to-m.from)+m.from}}}else{m.current=m._untweenedCurrent}if(m.discreteness&&Math.abs(m.to/m.discreteness)%1<1e-8){m.current=Math.round(m.current/m.discreteness)*m.discreteness}return m.isFinished}};b._freevarPrototype=b;return b})();CW.Animation._inertiaFreevar=(function(){var b=function(a){for(var d in a){if(a.hasOwnProperty(d)){this[d]=a[d]}}};b.prototype={from:0,to:1,speed:1,inertia:3,headStart:0.01,isAlmostFinished:function(a){return Math.abs(this.to-this.current)<a},reverse:function(){var a=this.to;this.to=this.from;this.from=a;return this},reset:function(){var a=this.to;this.force(this.from);this.to=a;return this},redirectTo:function(a){this.from=this.current;this.to=a;return this},redirectFrom:function(f){var g=f-this.current;this.from=f;this._undampedCurrent+=g;for(var h=0,a=this.inertiaChain.length;h<a;h++){this.inertiaChain[h]+=g}this.freevarRun(0);return this},zeroOutDuration:function(){this.speed=Infinity;return this},force:function(f){if(typeof f==="number"){this.to=f}this._undampedCurrent=this.current=this.to;for(var e=0,a=this.inertiaChain.length;e<a;e++){this.inertiaChain[e]=this.to}return this},freevarRun:function(s){if(this.speed===Infinity){this.force()}var o,n=this,t,f,q=n.speed,u=n.inertiaChain,p,a,v;for(o=0;o<n.inertia;o++){if(o===0){t=n._undampedCurrent;f=n.to}else{if(o===1){t=u[0];f=n._undampedCurrent}else{t=u[o-1];f=u[o-2]}}if(t===f){continue}p=t<f;a=s/1000*q*Math.abs(f+n.headStart*(2*p-1)-t);if(p){t+=a}else{t-=a}if((v=(p&&t>=f)||(!p&&t<=f))){t=f}if(o===0){n._undampedCurrent=t}else{u[o-1]=t}}n.current=t;if(n.discreteness&&Math.abs(n.to/n.discreteness)%1<1e-8){n.current=Math.round(n.current/n.discreteness)*n.discreteness}n.isFinished=n.to===n.current;n.progress=NaN;return n.isFinished}};b._freevarPrototype=b;return b})();CW.Animation._signalFreevar=(function(){var b=function(a){for(var d in a){if(a.hasOwnProperty(d)){this[d]=a[d]}}};b.prototype={speed:1,from:0,signal:function(a){return 0.5+0.5*Math.sin(a*Math.PI*2)},persistent:true,isAlmostFinished:function(a){return !this.persistent},reverse:function(){this.speed=-this.speed;return this},reset:function(){this._unsignaledCurrent=this.from;return this},redirectTo:function(){return this},force:function(){return this},advance:function(a){this._unsignaledCurrent+=a},zeroOutDuration:function(){return this},freevarRun:function(a){this._unsignaledCurrent+=a/1000*this.speed;this.current=this.signal(this._unsignaledCurrent);if(this.discreteness){this.current=Math.round(this.current/this.discreteness)*this.discreteness}this.isFinished=!this.persistent;this.progress=NaN;return this.isFinished}};b._freevarPrototype=b;return b})();CW.Anim.Fader=CW.Fader=CW.Animation.extend({className:"CW.Fader",update:function(){CW.Anim.setOpacity(this.element,this.current)},init:function(){if(this.from===undefined){this._untweenedCurrent=this.from=CW.Anim.getOpacity(this.element)}arguments.callee.base.apply(this,arguments)},_removeOnFinish:function(){if(!this.REMOVE_ON_FINISH){return}if(this.element.parentNode){this.element.parentNode.removeChild(this.element)}}.listens("finish"),saveSelf:function(){tmp=this.element._cwaFader;if(tmp){tmp.stop()}this.element._cwaFader=this}.listens("start"),killSelf:function(){this.element._cwaFader=undefined}.listens("stop")});CW.Anim.DisplayNoneAtZero={isMixin:true,setDisplayNone:function(){if(this.to===0){this.element.style.display="none"}}.listens("finish"),removeDisplayNone:function(){this.element.style.display=""}.listens("start")};CW.Anim.ColorFader=CW.ColorFader=CW.Animation.extend({className:"CW.ColorFader",style:"color",init:function(){this.colorKey="_cwa"+this.style+"color";this.saveKey="_cwa"+this.style+"Fader";var b;if(this.sR===undefined||this.sG===undefined||this.sB===undefined){if((b=CW.Anim.getStyle(this.element,this.style))){b=CW.Anim.decodeColor(b)}else{b=this.element[this.colorKey]||(this.element[this.colorKey]=[0,0,0])}this.sR=b[0];this.sG=b[1];this.sB=b[2]}arguments.callee.base.apply(this,arguments)},update:function(){if(!this.element||!this.style){return}var k=this.current,l=1-k,g,j,b,m=this.element[this.colorKey]||(this.element[this.colorKey]=[]);m[0]=g=this.tR*k+this.sR*l;m[1]=j=this.tG*k+this.sG*l;m[2]=b=this.tB*k+this.sB*l;this.element.style[this.style]=(this.cssBeforeColor||"")+CW.Anim.encodeColor(g,j,b)+(this.cssAfterColor||"")},saveSelf:function(){var b=this.element[this.saveKey];if(b){b.stop()}this.element[this.saveKey]=this}.listens("start"),killSelf:function(){this.element[this.saveKey]=undefined}.listens("stop")});CW.Anim.Mover=CW.Mover=CW.Animation.extend({className:"CW.Mover",getOmittedPositions:function(){var e,f,g,h;if(this.fromX===undefined||this.anchorX===undefined){g="left";e=parseInt(CW.Anim.getStyle(this.element,g),10);if(isNaN(e)){g="right";e=parseInt(CW.Anim.getStyle(this.element,g),10)}if(isNaN(e)){g="left"}this.anchorX!==undefined||(this.anchorX=g);this.fromX!==undefined||(this.fromX=e)}if(this.fromY===undefined||this.anchorY===undefined){h="top";f=parseInt(CW.Anim.getStyle(this.element,h),10);if(isNaN(f)){h="bottom";f=parseInt(CW.Anim.getStyle(this.element,h),10)}if(isNaN(f)){g="top"}this.anchorY!==undefined||(this.anchorY=h);this.fromY!==undefined||(this.fromY=f)}if(isNaN(this.fromX)||isNaN(this.fromY)){this.anchorX="left";this.anchorY="top";this.fromX=this.element.offsetLeft;this.fromY=this.element.offsetTop;this.element.style.position="absolute"}if(this.toX===undefined){this.toX=this.fromX}if(this.toY===undefined){this.toY=this.fromY}}.listens("start"),update:function(){var f=this.element.style,d=this.current,e=1-d;f[this.anchorX]=Math.round(d*this.toX+e*this.fromX)+"px";f[this.anchorY]=Math.round(d*this.toY+e*this.fromY)+"px"}});CW.Animatability={ENABLE_OLD_IE:YES,hasAnimatability:true,mustKeepLayoutSync:YES,isAnimating:NO,isAnimatingInWindow:NO,isAnimatingWithParent:NO,recomputeIsAnimatingBooleans:function(){var g=this.get("isAnimatingInWindow"),h=false,k=this,f=this._animCount>0,j;while((k=k.get("parentView"))){if(k.hasAnimatability&&k.get("isAnimating")){h=true;break}}j=h||f;if(this.isAnimating!==f){this.set("isAnimating",f)}if(this.isAnimatingInWindow!==j){this.set("isAnimatingInWindow",j)}if(this.isAnimatingWithParent!==h){this.set("isAnimatingWithParent",h)}if(j!==g){this._recomputeChildrenIsAnimatingBooleans()}},_recomputeChildrenIsAnimatingBooleans:function(){for(var d=0,f=this.get("childViews"),e;e=f[d];d++){if(e.hasAnimatability){e.recomputeIsAnimatingBooleans()}else{CW.Animatability._recomputeChildrenIsAnimatingBooleans.apply(e)}}},incrementAnimationCount:function(){this._animCount=(this._animCount||0)+1;this.recomputeIsAnimatingBooleans()},decrementAnimationCount:function(){this._animCount=Math.max(this._animCount-1,0);this.recomputeIsAnimatingBooleans()},animateProperty:function(f,e,d){return this.animateProperties.apply(this,arguments)},animateProperties:function(ad,af){var V,X,K,Q,W,Y,U,ac,M,ah,ae,Z,j,J,T,ai,al,S,l,R,ab,O,aa,ag,N,L,ak=SC.A(arguments),aj=this._currentlyAnimatingProperties,P=this.get("mustKeepLayoutSync");if((W=typeof ad==="string")){(Q={})[ad]=af;ad=Q;af=ak[2]}if(!ad){SC.warn("When using .animateProperties(, either a property name (string)or a hash, keyed by property name, full of destinations (or full freevar optionshashes) must be supplied as the first argument. Aborting the call.");return}ad=SC.clone(ad);if(af){for((V=W?2:1)&&(K=ak.length)&&!(af=undefined);V<K;V++){if(typeof(ag=ak[V])!=="object"){continue}for(X in ag){(af||(af={}))[X]=ag[X]}}}af||(af=this.___emptyHash);if(typeof(Y=af.duration)==="number"){delete af.duration}if((U=af.tween)){delete af.tween}if((ac=af.speed)){delete af.speed}if((M=af.inertia)){delete af.inertia}if((ah=af.headStart)){delete af.headStart}T=true;for(V in af){if(!af.hasOwnProperty(V)){continue}al=af[V];S=typeof al;if(S==="object"||S==="function"){T=false}(ai||(ai=[])).push(V)}af.canReuse=T=T||af.canReuse;if(ai){af.extraKeys=ai}for(V in ad){if(SC.none(ae=ad[V])){continue}Z=(j=aj[V])?((ab||(ab={}))[V]=j).removeProperty(V,true):undefined;if(typeof ae==="number"){ae=ad[V]={to:ae}}if(ae.from===undefined){if(ae.isLayoutProperty){if(Z){ae.from=Z.current}else{ae.from=(this._previousLayout||this.get("layout"))[V]}if(typeof ae.from!=="number"){ae.from=this._DEFAULT_LAYOUT_FROMS[V]||0}}else{ae.from=this.getPath(V)}}if(typeof Y==="number"&&ae.duration===undefined&&ae.inertia===undefined&&ae.speed===undefined){ae.duration=Y}if(U&&ae.tween===undefined&&ae.inertia===undefined){ae.tween=U}if(ac&&ae.speed===undefined&&ae.duration===undefined&&ae.tween===undefined){ae.speed=ac}if(M&&ae.inertia===undefined&&ae.tween===undefined){ae.inertia=M}if(ah&&ae.headStart===undefined){ae.headStart=ah}if(Z&&Z.inertia&&ae.inertia===Z.inertia){if(ae.speed){Z.speed=ae.speed}if(ae.headStart){Z.headStart=ae.headStart}Z.from=ae.from;Z.to=ae.to;ad[V]=ae=Z}ad[V].propertyName=V}R=0;aa=0;N=!this.get("animateOldIE")&&SC.browser.msie&&SC.browser.msie<=8;for(V in ad){if(!(ae=ad[V])){continue}if(N){!ae.duration||(ae.duration=0);!ae.speed||(ae.speed=Infinity)}if((ae.duration||0)>R){R=ae.duration}if(!P){this.adjust(ae.propertyName,ae.to)}if(ae.to===ae.from){if(P){this.adjust(ae.propertyName,ae.to)}delete ad[V]}else{aa++}}if(aa===0){if(!T){L=CW.Animation.create({view:this,duration:R||Y||0},af).start()}}else{if(T&&(l=this._bestMatchAnimationForProperties(ad)||this._animationFromPool())){for(V in ad){l.addProperty(ad[V])}for(V in af){l[V]=af[V]}L=l.start()}else{J={freevars:[],properties:[]};for(V in ad){J.freevars.push(V);J.properties.push(V)}J.view=this;l=CW.MultiPropertyAnimation.create(J,ad,af);for(V in ad){aj[V]=l}L=l.start()}}if(ab){for(V in ab){if(!ab.hasOwnProperty(V)){continue}O=ab[V];if(O.__checked__){continue}O.__checked__=true;O.stopIfNoProperties()}for(V in ab){if(!ab.hasOwnProperty(V)){continue}ab[V].__checked__=false}}return L},_bestMatchAnimationForProperties:function(p){var q,j,k,l,o,n,m=this._currentlyAnimatingProperties;for(q in m){if(!(l=m[q])||l.___matchCheck){continue}l.___matchCheck=true;k=l.properties.length;o=0;for(j=0;j<k;j++){o+=(p[l.properties[j]])?2:1}l.___matchCount=o}o=0;for(q in m){if(!(l=m[q])||!l.matchCheck){continue}l.___matchCheck=undefined;if(l.___matchCount>o){o=l.___matchCount;n=l}l.___matchCount=undefined}return n||this._animationFromPool()},_propertyAnimPool:null,_addAnimationToPool:function(g){if(!g){return}var h=this._propertyAnimPool;for(var e=0,f=h.length;e<f;e++){if(h[e]===g){return}}h.push(g)},_animationFromPool:function(){var f=this._propertyAnimPool,e=f.length,d=f[e-1];if(d){f.length=e-1}return d},animate:function(n,u){var q,t,p,v,l,s,j,o=SC.A(arguments);if((s=typeof n==="string")){(q={})[n]=u;n=q;u=o[2]}if(!n){SC.warn("When using .animate(, either a property name (string)or a hash, keyed by property name, full of destinations (or full freevar optionshashes) must be supplied as the first argument. Aborting the call.");return}n=SC.clone(n);if(u){for((p=s?2:1)&&(v=o.length)&&!(u=undefined);p<v;p++){if(typeof(j=o[p])!=="object"){continue}for(t in j){(u||(u={}))[t]=j[t]}}}if(typeof(q=n.duration)==="number"){(u||(u={})).duration=q;delete n.duration}if((q=n.tween)){(u||(u={})).tween=q;delete n.tween}if((q=n.speed)){(u||(u={})).speed=q;delete n.speed}if((q=n.inertia)){(u||(u={})).inertia=q;delete n.inertia}if((q=n.headStart)){(u||(u={})).headStart=q;delete n.headStart}u||(u=this.___emptyHash);for(p in n){l=n[p];if(typeof l==="number"){l=n[p]={to:l}}l.isLayoutProperty=true}return this.animateProperties(n,u)},adjust:function(b){return SC.View.prototype.adjust.apply(this,arguments)},stopAnimation:function(){this._forSaidPropertyAnimationsDo("removeProperty",arguments)},finishAnimation:function(){this._forSaidPropertyAnimationsDo("finishProperty",arguments)},updateToAnimation:function(){this._forSaidPropertyAnimationsDo("updateToProperty",arguments)},_forSaidPropertyAnimationsDo:function(q,l){var t=this._currentlyAnimatingProperties;if(!q||!t){return}var k=this.___keysForDoAll||(this.___keysForDoAll=[]),m=l[0],n,p,s,o;k.length=0;if(!m){m=t}if(m instanceof Array){p=m.length;for(n=0;n<p;n++){k[n]=m[n]}}else{if(typeof m==="object"){for(n in m){if(m.hasOwnProperty(n)&&m[n]!==undefined){k.push(n)}}}else{if(typeof m==="string"){p=l.length;for(n=0;n<p;n++){k[n]=l[n]}}}}p=k.length;for(n=0;n<p;n++){o=t[s=k[n]];if(!o){continue}o[q](s)}},_canAvoidAdjust:function(){if(this.get("mustKeepLayoutSync")){return false}return true},_quickAdjust:function(c,d){if(!this._isQuickAdjusting){return this.adjust.apply(this,arguments)}},_isQuickAdjusting:false,_quickAdjustment:null,_beginQuickAdjustment:function(){this._isQuickAdjusting=true;var f=this._quickAdjustment||(this._quickAdjustment={}),d=this._previousLayout||this.get("layout");for(var e in f){if(!d.hasOwnProperty(e)){delete f[e]}}for(e in d){f[e]=d[e]}},_commitQuickAdjustment:function(){this._isQuickAdjusting=false},_renderQuickAdjustment:function(){},_currentlyAnimatingProperties:null,___emptyHash:{},initMixin:function(){this._currentlyAnimatingProperties={};this._propertyAnimPool=[];if(!this.hasOwnProperty("animateOldIE")){this.set("animateOldIE",CW.Animatability.ENABLE_OLD_IE)}},_DEFAULT_LAYOUT_FROMS:{opacity:1,scale:1},discreteForOutsideUnitInterval:{left:YES,top:YES,width:YES,height:YES,right:YES,bottom:YES,centerX:YES,centerY:YES}};CW.MultiPropertyAnimation=CW.Animation.extend({view:null,properties:null,ticked:SC.platform.touch?5:0,stopIfNoProperties:function(){if(this.properties.length===0){this.stop()}},finishProperty:function(e,d){var f=this.freevarForProperty(e);if(!f){return}f.force();if(!d){this.update()}this.removeProperty(e)},removeProperty:function(k,g){for(var j=0,h;h=this.properties[j];j++){if(h===k){this.properties.splice(j,1);j--}}this.view._currentlyAnimatingProperties[k]=undefined;if(!g){this.stopIfNoProperties()}var f=this.removeFreevar(this.freevarForProperty(k));return f},addProperty:function(e){var f;if(!e||!(f=e.propertyName)){return}e.key=e.propertyName;for(var h=0,g;g=this.properties[h];h++){if(g===f){this.removeProperty(f,true);h--}}this.properties.push(f);this.view._currentlyAnimatingProperties[f]=this;this.addFreevar(e)},updateToProperty:function(e){var g=CW.Animatability.discreteForOutsideUnitInterval,h=e,f=this.view;f._updatingAnimatedProperty=true;if(typeof h==="string"){h=this.freevarForProperty(h)}e=h.propertyName;if(h.isLayoutProperty){h.discreteness=(g[e]&&(h.to>1||h.from>1||h.to<0||h.from<0))?1:0.000001;if(f.get("mustKeepLayoutSync")){f.adjust(e,h.current)}else{f.$().css(e,h.current)}}else{if(this.view[e]!==h.current){f.set(e,h.current)}}f._updatingAnimatedProperty=false},freevarForProperty:function(b){return this[b]},update:function(){for(var d=0,f,e;f=this.freevars[d];d++){this.updateToProperty(f)}},releaseProperties:function(){for(var d=0,c;c=this.properties[d];d++){this.view._currentlyAnimatingProperties[c]=undefined}}.listens("stop"),poolAnimation:function(){if(!this.canReuse){return}while(this.properties.length){this.removeProperty(this.properties[0],true)}this.properties.length=0;if(this.extraKeys){for(var b in this.extraKeys){delete this[b]}delete this.extraKeys}this.recycle();this.view._addAnimationToPool(this)}.listens("stop"),markView:function(){this.view.incrementAnimationCount()}.listens("start"),unmarkView:function(){this.view.decrementAnimationCount()}.listens("stop")});CW.PaneAnimationSupport={hasPaneAnimationSupport:YES,hiddenState:{opacity:0},showingState:{opacity:1},duration:350,showDuration:null,hideDuration:null,tween:CW.Anim.tweens.WEBKIT_EASE,showTween:null,hideTween:null,firstShowDelay:0,hideDelay:0,append:function(b){if(!this.hasSpritePreloadEnforcement||this._hasShownFromDidCreateLayer){this.animateShow()}b()}.enhance(),animateShow:function(){if(SC.browser.isIE8OrLower){this.paneWillShow();this.paneDidShow();return}if(this._hideAnim){this._hideAnim.finish()}if(this._showAnim){this._showAnim.finish()}if(this._showTimer){this._showTimer.invalidate();this._showTimer=null}if(this._hideTimer){this._hideTimer.invalidate();this._hideTimer=null}this._animatingShow=YES;this.paneWillShow();this.invokeLast(function(){this._animatingShow=YES;this.adjust(this.get("hiddenState"));var c=this.get("showDuration"),d=[this.get("showingState"),{duration:typeof c==="number"?c:this.get("duration"),tween:this.get("showTween")||this.get("tween"),notifyFrame:function(){this.view.didFrame(this);this.view.showDidFrame(this)}.listens("frame"),completed:function(){this.view._showAnim=null;this.view.paneDidShow(this)}.listens("finish")}];if(!this._hasAppendedOnce&&this.get("firstShowDelay")!==0){this._showTimer=this.invokeLater(function(){this._showTimer=null;this._showAnim=this.animate.apply(this,d)},this.get("firstShowDelay"));this._hasAppendedOnce=YES}else{this._showTimer=this.invokeLast(function(){this._showTimer=null;this._showAnim=this.animate.apply(this,d)})}this._animatingShow=NO});this._animatingShow=NO},remove:function(c){if(SC.browser.isIE8OrLower){this.paneWillHide();c();this.paneDidHide();return}var d;if(this.get("isPanelPane")&&this._isShowingModal){this._isShowingModal=NO;if((d=this._modalPane())){d.paneDidRemove(this)}}if(this._hideAnim){this._hideAnim.finish()}if(this._showAnim){this._showAnim.finish()}if(this._showTimer){this._showTimer.invalidate();this._showTimer=null}if(this._hideTimer){this._hideTimer.invalidate();this._hideTimer=null}this._animatingHide=YES;this.paneWillHide();this.invokeLast(function(){this._animatingHide=YES;var a=this.get("hideDuration"),b=[this.get("hiddenState"),{duration:typeof a==="number"?a:this.get("duration"),tween:this.get("hideTween")||this.get("tween"),notifyFrame:function(){this.view.didFrame(this);this.view.hideDidFrame(this)}.listens("frame"),enableClickThrough:function(){this.view.$().css("pointerEvents","none")}.listens("start"),removeClickThrough:function(){this.view.$().css("pointerEvents","")}.listens("stop"),completed:function(){this.view._hideAnim=null;c();this.view.paneDidHide(this)}.listens("finish")}];if(this.get("hideDelay")!==0){this._hideTimer=this.invokeLater(function(){this._hideTimer=null;this._hideAnim=this.animate.apply(this,b)},this.get("hideDelay"))}else{this._hideTimer=this.invokeLast(function(){this._hideTimer=null;this._hideAnim=this.animate.apply(this,b)})}this._animatingHide=NO});this._animatingHide=NO}.enhance(),didFrame:function(b){},showDidFrame:function(b){},hideDidFrame:function(b){},paneDidHide:function(b){},paneWillHide:function(){},paneDidShow:function(b){},paneWillShow:function(){}};CW.PaneFadingSupport=SC.clone(CW.PaneAnimationSupport);SC.mixin(CW.PaneFadingSupport,{paneFadeInDuration:100,paneFadeOutDuration:350,showDuration:function(){return this.get("paneFadeInDuration")}.property("paneFadeInDuration").cacheable(),hideDuration:function(){return this.get("paneFadeOutDuration")}.property("paneFadeOutDuration").cacheable(),showingState:function(){return{opacity:this.get("paneOpacity")||1}}.property("paneOpacity").cacheable(),paneDidHide:function(){return this.paneDidFadeOut()},paneDidFadeOut:function(){}});SC.stringsFor("en-us",{monthHeading:"%@1 %@2",year:"%@",January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sun:"Sun",Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri",Sat:"Sat",Yesterday:"Yesterday",Today:"Today",Tomorrow:"Tomorrow",Midnight:"Midnight",Now:"Now",Noon:"Noon",Next:"Next",Last:"Last",English:"English",French:"French",German:"German",Japanese:"Japanese","Button.OK":"OK","Button.Cancel":"Cancel","Button.Reload":"Reload","Button.Save":"Save","Button.Accept":"Accept","Button.Decline":"Decline","Button.Maybe":"Maybe","Button.TryAgain":"Try Again","Status.Loading":"Loading","Status.Sharing":"Sharing","Toolbar.Message.Actions":"Actions","Dialog.Error.Details":"Details","Color.Picker.Custom.Color":"Custom color","CW.DropTarget.SafariWindowsNotSupported.Title":"Drag and drop not supported.","CW.DropTarget.SafariWindowsNotSupported.Description":"Drag and drop of files into this browser is not currently supported."});CW.ScrollerView=SC.ScrollerView.extend({hasButtons:YES,scrollbarThickness:14,capLength:16,capOverlap:10,buttonLength:37,buttonOverlap:6});SC.mixin(SC.ScrollView.prototype,{horizontalScrollerView:CW.ScrollerView,verticalScrollerView:CW.ScrollerView});sc_require("views/scroller");CW.FadingCaplessScrollerView=CW.ScrollerView.extend({hasButtons:NO,classNames:"sc-fading-capless-scroller-view".w(),capLength:0,capOverlap:-2,buttonLength:0,buttonOverlap:-2,scrollbarThickness:10,minimumThumbLength:32,isVisibleDidChange:function(){if(!this.get("isVisible")){return}this.$(".sc-scroller-view").addClass("sc-fading-capless-scroller-view-invisible")}.observes("isVisible")});CW.FadingCaplessScrollerViewSupport={_thumbHidden:NO,didCreateLayer:function(b){this.$(".sc-scroller-view").addClass("sc-fading-capless-scroller-view-invisible");this._thumbHidden=YES;b()}.enhance(),verticalOverlay:YES,horizontalOverlay:YES,mouseExited:function(){if(this._thumbHidden){return}var d=this.get("verticalScrollerView"),c=this.get("horizontalScrollerView");if((d&&!d._thumbDragging)||(c&&!c._thumbDragging)){this.$(".sc-scroller-view").addClass("sc-fading-capless-scroller-view-invisible");this._thumbHidden=YES}},mouseMoved:function(){if(!this._thumbHidden){return}if(!this._thumbView){this._thumbView=this.$(".thumb")}this.$(".sc-scroller-view").removeClass("sc-fading-capless-scroller-view-invisible");this._thumbHidden=NO}};sc_require("views/fading_capless_scroller");CW.MiniFadingCaplessScrollerView=CW.FadingCaplessScrollerView.extend({minimumThumbLength:16,classNames:"sc-mini-fading-capless-scroller-view".w()});CW.MiniFadingCaplessScrollerViewSupport=CW.FadingCaplessScrollerViewSupport;sc_require("views/mini_fading_capless_scroller");CW.Alert=SC.PanelPane.extend({message:"",messageViewPaddingBottom:10,description:null,descriptionViewPadding:{top:0,bottom:4},descriptionViewMinHeight:9,descriptionViewMaxHeight:CW.get("isMobile")?200:300,caption:null,captionViewPadding:{top:4,bottom:7},captionViewMinHeight:0,image:"me-icon-alert-68",rightButton:"OK",middleButton:null,leftButton:null,extraView:null,extraViewPadding:{top:5,bottom:3},extraViewMinHeight:0,escapeHTML:NO,layout:{centerX:0,width:450,centerY:-10,height:160},classNames:["cw-alert"],ariaRole:"alertdialog",init:function(){arguments.callee.base.apply(this,arguments);if(this.get("extraWide")){this.adjust("width",500)}if(CW.isMobile()){this.layout={left:20,centerY:0,right:20}}},modalPane:SC.ModalPane.extend(CW.Animatability,CW.PaneFadingSupport,{classNames:"cw-modal".w(),paneFadeInDuration:!SC.browser.webkit?350:function(){return 350*(innerWidth<1983&&innerHeight<1983)}.property(),paneFadeOutDuration:function(){return this.get("paneFadeInDuration")}.property(),paneOpacity:0.5,init:function(){if((SC.browser.webkit)&&(innerWidth>=1983||innerHeight>=1983)){this.classNames.push("no-gpu")}arguments.callee.base.apply(this,arguments);var e=SC.RootResponder.responder.mainPane;if(e){var d=e.layout.minWidth,f=e.layout.minHeight;if(d){this.adjust("minWidth",d)}if(f){this.adjust("minHeight",f)}}}}),contentView:SC.View.design({layout:{left:0,right:0,top:0,bottom:0},escapeHTMLBinding:"*parentView.escapeHTML",separatorView:SC.View.design({layout:{height:2,right:5,left:5,bottom:56},classNames:["separator"]}),createChildViews:function(){SC.Binding.flushPendingChanges();var C=this.get("escapeHTML"),D=this.get("pane"),G=D.get("message"),B=D.get("description"),x=D.get("caption"),E=CW.get("isMobile")?null:D.get("image"),O=D.get("extraView"),K=D.get("rightButton"),J=D.get("middleButton"),L=D.get("leftButton"),w=this.childViews,H=CW.Alert,F="Trying to create a CW.Alert with a %@ button that is neither a string, nor a button view.",I,N,y,P,z,v,M;if(E){if(SC.typeOf(E)===SC.T_STRING){this.imageView=H.ImageView.extend({value:E})}else{if(E.value&&E.width&&E.height){this.imageView=H.ImageView.extend({value:E.value,width:E.width,height:E.height})}else{CW.fatalError("Trying to create a CW.Alert with improper an invalid image hash.")}}w.push("imageView")}if(!G){CW.fatalError("Trying to create a CW.Alert without a message.")}this.messageView=H.MessageView.extend({value:G,escapeHTML:C});w.push("messageView");if(B){this.descriptionView=H.DescriptionView.extend({value:B,escapeHTML:C});w.push("descriptionView")}if(x){this.captionView=H.CaptionView.extend({value:x,escapeHTML:C});w.push("captionView")}if(O){this.extraView=O;w.push("extraView")}w.push("separatorView");if(L){if(SC.typeOf(L)===SC.T_STRING){I={title:L,action:"remove",target:D}}else{if(SC.typeOf(L)===SC.T_HASH){I=L}else{CW.fatalError(F.fmt("left"))}}this.leftButtonView=H.LeftButtonView.extend(I);w.push("leftButtonView")}if(J){if(SC.typeOf(J)===SC.T_STRING){N=J;y="remove";P=D}else{if(SC.typeOf(J)===SC.T_HASH){N=J.title?J.title:"Cancel";y=J.action?J.action:null;P=J.target?J.target:D}else{CW.fatalError(F.fmt("middle"))}}}if(!K){CW.fatalError("Trying to create a CW.Alert without a right button.")}if(SC.typeOf(K)===SC.T_STRING){z=K;v="remove";M=D}else{if(SC.typeOf(K)===SC.T_HASH){z=K.title?K.title:"OK";v=K.action?K.action:null;M=K.target?K.target:D}else{CW.fatalError(F.fmt("right"))}}this.mainButtonsView=H.MainButtonsView.extend({middleButtonIsVisible:J?YES:NO,middleButtonTitle:N,middleButtonAction:y,middleButtonTarget:P,rightButtonTitle:z,rightButtonAction:v,rightButtonTarget:M});w.push("mainButtonsView");return arguments.callee.base.apply(this,arguments)},extraViewFrameDidChange:function(){if(this._resizingExtraView){this._resizingExtraView=NO;return}this.performLayout()},didCreateLayer:function(){var f=this.get("pane");if(SC.browser.isIE8OrLower){f.$()[0].style.filter="alpha(opacity=0)"}else{f.$().css({opacity:0,"-webkit-animation-name":"none",})}var d=this.get("extraView");if(d&&d.isAutoResizingExtraView){d.addObserver("frame",this,this.extraViewFrameDidChange)}var e=this;this.invokeLater(function(){e.performLayout()},100)},performLayout:function(){var J=this.get("pane"),N=this.messageView,ah=this.descriptionView,M=J.get("descriptionViewMinHeight")||0,I=J.get("descriptionViewMaxHeight")||0,T=this.captionView,ad=J.get("captionViewMinHeight")||0,ae=this.extraView,U=J.get("extraViewMinHeight")||0,X=this.imageView,K=J.get("image"),G=N.getPath("layout.top"),ac=this.mainButtonsView,W=CW.Alert,E=W.MIN_ALERT_HEIGHT,ag=null,R,af,L,H=0,P,F,aa,ab,Y,S,O,Q,Z;if(SC.browser.isIE8OrLower){J.$()[0].style.filter="alpha(opacity=100)"}else{J.$().css({opacity:1,"-webkit-animation-name":"pop",})}J.set("ariaLabelledBy",SC.guidFor(N));J.set("ariaDescribedBy",SC.guidFor(ah));R=N.get("value");af=N.get("layer");F=N.get("frame").width+"px";af.style.maxWidth=F;L=SC.metricsForString(R,af,null,!this.get("escapeHTML")).height;N.adjust("height",L);G+=L;Z=J.get("messageViewPaddingBottom");if(Z){G+=Z}if(ah){O=J.get("descriptionViewPadding");if(O&&(Q=O.top)){G+=Q}ah.adjust("top",G);R=ah.get("value");af=ah.contentView.get("layer");af.style.maxWidth=F;L=SC.metricsForString(R,af,null,!this.get("escapeHTML")).height;if(L<M){L=M}else{if(L>I){ag=L;L=I}}ah.adjust("height",L);if(ag){ah.contentView.adjust("height",CW.get("isMobile")?ag+200:ag)}G+=L;if(O&&(Z=O.bottom)){G+=Z}}else{G+=M}if(T){O=T.get("padding");if(O&&(Q=O.top)){G+=Q}T.adjust("top",G);R=T.get("value");af=T.get("layer");af.style.maxWidth=F;L=SC.metricsForString(R,af,null,!this.get("escapeHTML")).height;if(L<ad){L=ad}T.adjust("height",L);G+=L;if(O&&(Z=O.bottom)){G+=Z}}else{G+=ad}if(ae){this._resizingExtraView=YES;O=J.get("extraViewPadding");if(O&&(Q=O.top)){G+=Q}ae.adjust("top",G);L=undefined;if(ae.isAutoResizingExtraView){L=ae.computeHeight()}if(SC.none(L)){L=ae.get("frame").height}if(SC.none(L)){CW.fatalError("Trying to create a CW.Alert with an extraView which does not have its height specified.")}if(L<U){L=U}G+=L;if(O&&(Z=O.bottom)){G+=Z}}else{G+=U}if(X&&K.width&&K.height){X.adjust("width",K.width);X.adjust("height",K.height);imageViewBottom=X.getPath("frame.bottom")}G+=W.BUTTONS_AND_SEPARATOR_HEIGHT;if(G<E){G=E}aa=ac.middleButton;ab=ac.rightButton;if(this.leftButtonView){S=this.leftButtonView.get("frame");if(S){H=S.width}}if(aa){S=aa.get("frame");if(S){H+=S.width}}if(ab){S=ab.get("frame");if(S){H+=S.width}}J.adjust("height",G);Y=W.BUTTONS_REGULAR_PADDING+W.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT+(W.BUTTONS_SIDE_PADDING*2);if(H+Y>J.get("frame").width){J.adjust("width",H+Y)}this._resizingExtraView=NO;var V=this.$(".def");setTimeout(function(){V[0].focus()},1000)}})});CW.Alert.BUTTONS_REGULAR_PADDING=8;CW.Alert.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT=15;CW.Alert.BUTTONS_SIDE_PADDING=20;CW.Alert.BUTTONS_AND_SEPARATOR_HEIGHT=71;CW.Alert.MIN_ALERT_HEIGHT=162;CW.Alert.MessageView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,top:26,right:25},classNames:["title-label"],ariaRole:"heading"});CW.Alert.DescriptionView=SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["description"],valueBinding:".parentView.parentView.value",escapeHTMLBinding:".parentView.parentView.escapeHTML",})});CW.Alert.CaptionView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["caption"]});CW.Alert.ImageView=SC.ImageView.extend({layout:{left:25,top:22,width:68,height:68},classNames:["cw-alert-image-view"]});CW.Alert.MainButtonsView=SC.View.extend({layout:{height:30,bottom:11,right:16,left:16},classNames:["text-align-right"],childViews:["middleButton","rightButton"],middleButtonIsVisible:YES,middleButtonTitle:"Cancel",middleButtonAction:null,middleButtonTarget:null,rightButtonTitle:"Ok",rightButtonAction:null,rightButtonTarget:null,init:function(){arguments.callee.base.apply(this,arguments);this.middleButton.set("title",this.middleButtonTitle);this.middleButton.set("isVisible",this.middleButtonIsVisible);this.middleButton.set("action",this.middleButtonAction);this.middleButton.set("target",this.middleButtonTarget);this.rightButton.set("title",this.rightButtonTitle);this.rightButton.set("action",this.rightButtonAction);this.rightButton.set("target",this.rightButtonTarget)},middleButton:SC.ButtonView.extend({isCancel:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0}}),rightButton:SC.ButtonView.extend({isDefault:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0},render:function(b){b.attr("tabindex","0");return arguments.callee.base.apply(this,arguments)}})});CW.Alert.LeftButtonView=SC.ButtonView.extend(SC.AutoResize,{title:"Other...",themeName:"square",controlSize:SC.HUGE_CONTROL_SIZE,layout:{height:30,left:18,bottom:11,minWidth:72}});CW.Alert.ExtraViewAutoResizingSupport={isAutoResizingExtraView:YES,computeHeight:function(){var g=this.get("autoResizeLayer")||this.get("layer"),k=this.getPath("frame.width"),h=this.get("autoResizeText")||"",j=this.get("autoResizePadding")||0,f;if(SC.none(g)||SC.empty(h)){return 0}g.style.maxWidth=k+"px";f=SC.metricsForString(h,g,this.get("classNames"),!this.get("escapeHTML"));return f.height+j}};CW.Alert.show=function(c){if(SC.typeOf(c)===SC.T_HASH){var d=this.create(c);d.append();return d}CW.fatalError("Attempted to show a CW.Alert without options.");return null};CW.AlertPaneListItemView=SC.View.extend(SC.Control,SC.StaticLayout,{useStaticLayout:YES,layout:{height:45},childViews:["message","label"],message:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,layout:{top:8,height:"auto"},escapeHTML:NO,controlSize:SC.TINY_CONTROL_SIZE,classNames:["message"],valueBinding:"*owner.content.message"}),label:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,controlSize:SC.TINY_CONTROL_SIZE,classNames:["label"],layout:{top:10,height:"auto"},valueBinding:"*owner.content.label"})});sc_require("panes/list_item");CW.AlertPaneDetailView=SC.StackedView.extend({layout:{left:0,top:0,right:0,bottom:0},isSelectable:NO,classNames:"alert-pane-list".w(),exampleView:CW.AlertPaneListItemView,contentBinding:"*parentView.owner.pane.alertDetails"});sc_require("views/scroller");CW.CaplessMiniScrollerView=CW.ScrollerView.extend({hasButtons:NO,classNames:"me-capless-mini-scroller-view",capLength:0,capOverlap:0,buttonLength:0,buttonOverlap:0,scrollbarThickness:8});sc_require("panes/alert_pane_detail");sc_require("views/capless_mini_scroller");CW.BUTTON1_STATUS="button1";CW.BUTTON2_STATUS="button2";CW.BUTTON3_STATUS="button3";CW.ACTIONABLE_VIEW_ELEM_CHECKBOX="checkbox";CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD="oneTextField";CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS="twoTextField";CW.DETAIL_VIEW_MAX_HEIGHT=143;CW.AlertPane=SC.PanelPane.extend({classNames:"me-alert",ariaRole:"alertdialog",themeName:"atv3",delegate:null,shouldEscapeHTML:YES,showDetails:NO,alertDetails:null,detailView:CW.AlertPaneDetailView,icon:"sc-icon-alert-48",buttonOne:SC.outlet("contentView.mainActionButtons.okButton"),buttonTwo:SC.outlet("contentView.mainActionButtons.cancelButton"),buttonThree:SC.outlet("contentView.extraActionButton.button"),buttonThreeWrapper:SC.outlet("contentView.extraActionButton"),checkbox:SC.outlet("contentView.info.checkbox"),textField:SC.outlet("contentView.info.textfield.textfieldContent"),textField1:SC.outlet("contentView.info.textfields.left.textfield1Content"),textField2:SC.outlet("contentView.info.textfields.right.textfield2Content"),layout:{top:0.3,centerX:0,width:500},isExtraButtonCancel:null,contentView:SC.View.extend({useStaticLayout:YES,layout:{left:0,right:0,top:0,height:"auto"},childViews:["info","separator","mainActionButtons","extraActionButton"],info:SC.View.extend(SC.StaticLayout,{useStaticLayout:YES,layout:{top:0,left:0,right:460,height:"auto"},classNames:["info"],render:function(f,g){var h=this.get("pane"),e=SC.BLANK_IMAGE_URL;if(g&&h.get("icon")!=="blank"){f.push('<img src="'+e+'" class="icon '+h.get("icon")+'" />')}f.addClass("show-"+h.get("icon"));arguments.callee.base.apply(this,arguments)},childViews:["title","description","detailDisclosure","detail","caption","checkbox","textfield","textfields"],title:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["title-label"],layout:{top:0,left:0,right:0,height:"auto"},tagName:"h1",valueBinding:"*owner.pane.message",escapeHTMLBinding:"*owner.pane.shouldEscapeHTML"}),description:SC.LabelView.design(SC.StaticLayout,{classNames:["description"],useStaticLayout:YES,layout:{top:0,left:0,right:0,height:"auto"},valueBinding:"*owner.pane.description",escapeHTMLBinding:"*owner.pane.shouldEscapeHTML"}),detailDisclosure:SC.DisclosureView.design(SC.StaticLayout,{useStaticLayout:YES,isEnabled:YES,value:NO,layout:{height:15},title:"Dialog.Error.Details".loc(),isVisibleBinding:"*owner.pane.showDetails"}),detail:SC.WellView.design(SC.StaticLayout,{isVisibleBinding:"*owner.detailDisclosure.value",useStaticLayout:YES,layout:{top:0,left:0,right:0,height:CW.DETAIL_VIEW_MAX_HEIGHT},contentLayout:{top:1,left:0,right:0,bottom:2},classNames:"detail".w(),contentView:SC.ScrollView.design({verticalScrollerView:CW.CaplessMiniScrollerView,verticalScrollerLayout:{top:2,right:4,bottom:2},hasHorizontalScroller:NO,hasVerticalScroller:YES,layout:{left:0,top:0,right:0,bottom:0},contentView:function(){var b=this.getPath("owner.pane.detailView");if(SC.typeOf(b)===SC.T_CLASS){b=b.create();this.setPath("owner.pane.detailView",b)}return b}.property()}),detailVisibleDidChange:function(){var d=this.parentView.parentView.parentView;if(d){var c=d.get("layout").height+(this.get("isVisible")?-1:1)*CW.DETAIL_VIEW_MAX_HEIGHT;d.adjust({height:c}).updateLayout()}}.observes("*owner.detailDisclosure.value")}),caption:SC.LabelView.extend(SC.StaticLayout,{useStaticLayout:YES,classNames:["caption"],layout:{top:0,left:0,right:0,height:"auto"},escapeHTMLBinding:"*owner.pane.shouldEscapeHTML",init:function(){var b=this.get("pane").get("caption");if(b===null||b===""){this.set("isVisible",NO)}this.set("value",b);arguments.callee.base.apply(this,arguments)}}),checkbox:SC.CheckboxView.design(SC.StaticLayout,{useStaticLayout:YES,layout:{top:0,left:-1,right:0,height:"auto"},classNames:["checkbox"],valueBinding:"*owner.pane.checkboxValue",titleBinding:"*owner.pane.checkboxTitle",isVisibleBinding:"*owner.pane.checkboxVisible"}),textfield:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["one-textfield"],layout:{top:0,left:0,right:0,height:"auto"},isVisibleBinding:"*owner.pane.textFieldVisible",childViews:["textfieldLabel","textfieldContent"],textfieldLabel:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["me-dialog-label"],fontWeight:SC.BOLD_WEIGHT,layout:{top:0,left:0,right:0,height:15},valueBinding:"*owner.pane.textFieldLabel"}),textfieldContent:SC.TextFieldView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["textfield"],layout:{top:0,left:0,right:0,height:22},valueBinding:"*owner.pane.textFieldValue"})}),textfields:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["two-textfield"],layout:{top:0,left:0,right:0,height:"auto"},isVisibleBinding:"*owner.pane.textFieldsVisible",childViews:["left","right"],left:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["left-half"],layout:{top:0,height:"auto"},tagName:"span",childViews:["textfield1Label","textfield1Content"],textfield1Label:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["me-dialog-label"],fontWeight:SC.BOLD_WEIGHT,layout:{top:0,left:0,right:0,height:15},valueBinding:"*owner.pane.textField1Label"}),textfield1Content:SC.TextFieldView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["textfield"],layout:{top:0,left:0,right:0,height:22},valueBinding:"*owner.pane.textField1Value"})}),right:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["right-half"],layout:{top:0,height:"auto"},tagName:"span",childViews:["textfield2Label","textfield2Content"],textfield2Label:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["me-dialog-label"],fontWeight:SC.BOLD_WEIGHT,layout:{top:0,left:0,right:0,height:15},valueBinding:"*owner.pane.textField2Label"}),textfield2Content:SC.TextFieldView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["textfield"],layout:{top:0,left:0,right:0,height:22},isPassword:YES,valueBinding:"*owner.pane.textField2Value"})})})}),separator:SC.View.design({classNames:["separator"],layout:{bottom:51,height:2,right:15,left:15}}),mainActionButtons:SC.View.design({layout:{bottom:10,height:CW.SQUARE_BUTTON_REGULAR_HEIGHT,right:18,left:18},childViews:["cancelButton","okButton"],classNames:["text-align-right"],cancelButton:SC.ButtonView.design({useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},themeName:"square",title:"Cancel",isCancel:YES,isCancelBinding:SC.Binding.not("*parentView.owner.pane.isExtraButtonCancel"),action:"dismiss",isVisible:NO,_notifyDidAppendToDocument:function(){arguments.callee.base.apply(this,arguments);this.set("isCancel",!this.getPath("parentView.owner.pane.isExtraButtonCancel"))}}),okButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},themeName:"square",title:"OK",isDefault:YES,action:"dismiss"})}),extraActionButton:SC.View.design({layout:{bottom:10,height:CW.SQUARE_BUTTON_REGULAR_HEIGHT,left:18,width:150},isVisible:NO,childViews:["button"],button:SC.ButtonView.design({useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},themeName:"square",title:"Extra",isCancel:NO,isCancelBinding:"*parentView.owner.pane.isExtraButtonCancel",action:"dismiss",isVisible:NO,_notifyDidAppendToDocument:function(){arguments.callee.base.apply(this,arguments);this.set("isCancel",this.getPath("parentView.owner.pane.isExtraButtonCancel"))}})})}),dismiss:function(c){var d=this.delegate;if(d&&d.alertPaneDidDismiss){d.alertPaneDidDismiss(this,c.get("actionKey"))}if(c.get("theme")!="help"){this.set("checkboxValue",this.get("checkbox").value);this.set("textFieldValue",this.get("textField").value);this.set("textField1Value",this.get("textField1").value);this.set("textField2Value",this.get("textField2").value);this.remove()}}});CW.AlertPane._normalizeArguments=function(d){d=SC.A(d);var e=d.length,f=d[e-1];if(SC.typeOf(f)!==SC.T_STRING){d[e-1]=null}else{f=null}d[11]=f;return d};CW.AlertPane.show=function(ad,ab,S,ak,ap,af,ac,an,aj,U,K,W,M){var al=!M?this._normalizeArguments(arguments):arguments;var O,ai,ag,Q,ah,R,ae,Z;var Y=YES,T=NO,aa=NO,V=NO;if(ak!==null&&ak!==CW.ACTIONABLE_VIEW_ELEM_CHECKBOX&&ak!==CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD&&ak!==CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS){SC.error("Extra element must be either of the following three values: CW.ACTIONABLE_VIEW_ELEM_CHECKBOX, CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD, CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS")}if(ak!==null&&ap===null){SC.error("Please provide the element details when you want the display a checkbox or text field(s) in the alert pane.")}if(ap!==null){if(ak===CW.ACTIONABLE_VIEW_ELEM_CHECKBOX){O=ap[0];ai=ap[1];T=YES}else{if(ak===CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD){ag=ap[0];Q=ap[1];aa=YES}else{if(ak===CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS){ah=ap[0];R=ap[1];ae=ap[2];Z=ap[3];V=YES}}}}var N={message:al[0]||"",description:al[1]||null,caption:al[2]||null,checkboxVisible:T,checkboxTitle:O,checkboxValue:ai,textFieldVisible:aa,textFieldLabel:ag,textFieldValue:Q,textField1Label:ah,textField1Value:R,textFieldsVisible:V,textField2Label:ae,textField2Value:Z,icon:al[8]||"sc-icon-alert-48",showDetails:SC.none(al[9])?NO:YES,alertDetails:!SC.kindOf(al[9],SC.View)?al[9]:null,shouldEscapeHTML:al[10]!==NO?YES:NO,delegate:al[11],isExtraButtonCancel:al[12]||NO};if(SC.kindOf(al[9],SC.View)){N.detailView=al[9]}N=this.create(N);var ao="buttonOne buttonTwo buttonThree".w(),aq,L,am=97;for(var X=0;X<3;X++){aq=N.get(ao[X]);L=al[X+5];if(L){aq.set("title",L).set("isVisible",YES);if(X==2){if(L=="?"){aq.set("title","").set("theme","help")}N.get("buttonThreeWrapper").set("isVisible",YES)}}}var P=N.append();SC.RunLoop.begin();P.awake();SC.RunLoop.end();if(N.get("buttonThreeWrapper").get("isVisible")){N.get("buttonThreeWrapper").adjust({width:N.get(ao[2]).$().width()+16})}am+=N.get(ao[0]).$().width()+N.get(ao[1]).$().width()+N.get(ao[2]).$().width();if(am>N.get("layout").width){N.adjust("width",am);N.updateLayout()}N.adjust("height",N.childViews[0].$().height());N.updateLayout();return P};CW.AlertPane.warn=function(l,o,n,t,p,v,u,m,q){var s=this._normalizeArguments(arguments);s[8]="me-icon-alert-68";return this.show.apply(this,s)};CW.AlertPane.info=function(l,o,n,t,p,v,u,m,q){var s=this._normalizeArguments(arguments);s[8]="me-icon-info-68";return this.show.apply(this,s)};CW.AlertPane.plain=function(o,t,q,x,u,z,y,p,B,C,s,v){var w=this._normalizeArguments(arguments);w[8]="blank";return this.show.apply(this,w)};CW.AlertPane.detail=function(p,u,s,z,v,C,B,q,D,E,t,x){var y=this._normalizeArguments(arguments),w=y[8];if(!w||(w&&!w.length)){y[8]="me-icon-info-68"}return this.show.apply(this,y)};CW.AlertPane.plainWithExtraButtonCancel=function(o,t,q,x,u,z,y,p,B,C,s,v){var w=this._normalizeArguments(arguments);w[8]="blank";w[12]=YES;return this.show.apply(this,w)};CW.COMMIT="Commit";CW.DISCARD="Discard";CW.ColorPickerPane=SC.PickerPane.extend({classNames:"sc-menu color-picker".w(),_h:0,_s:1,_v:1,POINTER_CANVAS:1,SLIDER_CANVAS:2,selectedColor:"",displayProperties:["selectedColor"],colorCanvas:"",showButtons:NO,delegate:null,layout:{width:191,height:225},colorPointer:SC.outlet("contentView.colorBoxView.colorBackgroundView.colorPointerView"),colorSlider:SC.outlet("contentView.colorBoxView.colorBackgroundView.colorSliderView"),render:function(k,h){arguments.callee.base.apply(this,arguments);if(h){if(this.showButtons){return}var j=this.get("objects"),g=this.get("selectedColor");var f=this.getPath("contentView.swatchView");j.forEach(function(a,c){if(a){var b=SC.View.create({layout:{left:(26*c),top:0,height:26,width:26},backgroundColor:a,classNames:["color-swatch-default"],render:function(e,d){if(this.get("backgroundColor")===g){e.begin("div").addClass("color-swatch-selected").end()}arguments.callee.base.apply(this,arguments)},eventManager:0,viewClicked:"",mouseDown:function(m){if(this.get("eventManager")===0){this.set("eventManager",1);this.viewClicked=m.target;var e=this.viewClicked,d=e.className;e.className=d.replace("color-swatch-default","color-swatch-pressed")}return YES},touchStart:function(d){return this.mouseDown(d)},mouseUp:function(e){var m=this.getPath("parentView.parentView.parentView");var d=this.get("eventManager");if(d===1||d===3){m.set("selectedColor",this.get("backgroundColor"));m.commitAndDismiss()}if(this.get("eventManager")>0){this.set("eventManager",0)}return YES},touchEnd:function(d){return this.mouseUp(d)},mouseEntered:function(m){if(this.get("eventManager")===2){this.set("eventManager",3);var e=this.viewClicked,d=e.className;e.className=d.replace("color-swatch-default","color-swatch-pressed")}return YES},mouseExited:function(m){if(this.get("eventManager")===1||this.get("eventManager")===3){this.set("eventManager",2);var e=this.viewClicked,d=e.className;e.className=d.replace("color-swatch-pressed","color-swatch-default")}return YES}});f.appendChild(b)}})}},init:function(){arguments.callee.base.apply(this,arguments);var m=this.get("objects"),j=this.get("selectedColor");this.set("_originalColor",j);var k=this.get("pane"),n=YES,l=this.get("contentView"),h=this.getPath("contentView.colorBoxView"),o=this.getPath("contentView.customColorLabelView");if(this.showButtons){h.set("isVisible",YES);o.set("isVisible",NO);l.generateButtons();h.adjust({top:7});k.adjust({height:217}).updateLayout()}else{m.forEach(function(a){if(a===j){n=NO;h.set("isVisible",NO);o.set("isVisible",YES);k.adjust({height:61}).updateLayout()}});if(n){h.set("isVisible",YES);o.set("isVisible",NO);k.adjust({height:215}).updateLayout()}}this.initColor(j)},contentView:SC.View.extend({layout:{left:3,right:3,top:3,bottom:3},childViews:["swatchView","customColorLabelView","colorBoxView"],swatchView:SC.View.design({layout:{top:4,left:1,width:183,height:26}}),customColorLabelView:SC.LabelView.design({tagName:"a",layout:{bottom:5,left:0,height:18,width:179},value:"Color.Picker.Custom.Color",localize:YES,fontWeight:SC.BOLD_WEIGHT,controlSize:SC.SMALL_CONTROL_SIZE,classNames:["custom-color-switcher-label"],textAlign:"center",isVisible:NO,mouseDown:function(){var c=this.get("pane");var d=this.getPath("parentView.colorBoxView");d.set("isVisible",YES);this.set("isVisible",NO);c.adjust({height:215}).updateLayout();c.positionPane();return true},touchStart:function(b){return this.mouseDown(b)}}),colorBoxView:SC.View.design({childViews:["selectedColorView","colorCanvasView","colorBackgroundView"],layout:{top:35,left:0,width:185,height:171},isVisible:YES,selectedColorView:SC.View.design({wantsAcceleratedLayer:YES,classNames:"color_selected".w(),layout:{top:0,left:7,width:166,height:24},render:function(e,f){var d=this.get("pane");e.addStyle({backgroundColor:d.get("selectedColor")})}}),colorCanvasView:SC.View.design({wantsAcceleratedLayer:YES,classNames:"color_canvas".w(),layout:{top:34,left:7,width:132,height:132},render:function(e,f){var d=this.get("pane");e.addStyle({backgroundColor:d.get("colorCanvas")})}}),colorBackgroundView:SC.View.design({wantsAcceleratedLayer:YES,layout:{top:0,left:7,width:168,height:166},classNames:"color-picker-background".w(),childViews:"colorPointerView colorSliderView".w(),colorPointerView:SC.View.design({wantsAcceleratedLayer:YES,layout:{width:11,height:11},classNames:"color-picker-pointer".w()}),colorSliderView:SC.View.design({wantsAcceleratedLayer:YES,layout:{right:-2,width:32,height:11},classNames:"color-picker-slider".w()})})}),generateButtons:function(){var c=this.get("pane");if(c.get("showButtons")){var d=SC.View.create({layout:{bottom:7,height:22,right:7,width:166},classNames:["text-align-right"],childViews:["cancelButtonView","okButtonView"],cancelButtonView:SC.ButtonView.design({useStaticLayout:YES,layout:{top:0,height:22,width:"auto",left:0},title:"Button.Cancel",localize:YES,controlSize:SC.SMALL_CONTROL_SIZE,isCancel:YES,action:"discardAndDismiss",actionKey:CW.DISCARD}),okButtonView:SC.ButtonView.design({useStaticLayout:YES,layout:{top:0,height:22,width:"auto",left:2},title:"Button.OK",localize:YES,controlSize:SC.SMALL_CONTROL_SIZE,isDefault:YES,action:"dismissPane",actionKey:CW.COMMIT})});this.appendChild(d)}return}}),mouseDown:function(b){if(this.clickedOnCustomColorSwatch(b)){this.commitAndDismiss()}else{this._canvas=this.clickPositionOnColorCanvas(b);switch(this._canvas){case this.POINTER_CANVAS:this.calculatePointerPosition();break;case this.SLIDER_CANVAS:this.calculateSliderPosition();break;default:}}return YES},touchStart:function(b){return this.mouseDown(b)},mouseUp:function(b){this._canvas=0;return YES},touchEnd:function(b){return this.mouseUp(b)},mouseDragged:function(b){this.calculateClickEventPosition(b);switch(this._canvas){case this.POINTER_CANVAS:this.calculatePointerPosition();break;case this.SLIDER_CANVAS:this.calculateSliderPosition();break;default:}return YES},modalPaneDidClick:function(d){var c=this.get("frame");if(!this.clickInside(c,d)){this.commitAndDismiss()}return YES},performKeyEquivalent:function(c,d){switch(c){case"tab":case"shift_tab":this.commitAndDismiss(c);return YES;case"escape":this.discardAndDismiss(c);return YES;case"return":this.commitAndDismiss(c);return YES;default:return NO}},clickedOnCustomColorSwatch:function(h){var o=this.getPath("contentView.colorBoxView");if(!o||!o.get("isVisible")){return NO}var m=this.get("frame"),n=m.x+11,l=m.y+(this.get("showButtons")?12:40),j=h.pageX-n,k=h.pageY-l;if(j>=0&&j<166&&k>=0&&k<24){return YES}return NO},clickPositionOnColorCanvas:function(e){this.calculateClickEventPosition(e);var f=this._x,g=this._y,h=0;if(f>=0&&f<132&&g>=0&&g<132){h=this.POINTER_CANVAS}else{if(f>=136&&f<=167&&g>=-5&&g<132){h=this.SLIDER_CANVAS}}return h},calculateClickEventPosition:function(g){if(!this._frameCache){this._frameCache=this.get("frame")}var l=this._frameCache,m=l.x+13,k=l.y+(this.get("showButtons")?46:75),h=g.pageX-m,j=g.pageY-k;this._x=h;this._y=j},calculatePointerPosition:function(){var h=this._s,e=this._v,f=this._x,g=this._y;f-=3;g-=3;f=Math.max(Math.min(f,121),0);g=Math.max(Math.min(g,121),0);this.get("colorPointer").adjust({left:f,top:g+34});this._s=f/124;this._v=(124-g)/124;if(h!=this._s||e!=this._v){this.set("selectedColor",SC.convertHsvToHex(this._h,this._s,this._v))}},calculateSliderPosition:function(){var d=this._h,c=Math.max(Math.min(this._y,131),0);this.get("colorSlider").adjust({top:c+29});this._h=c/131;if(d!=this._h){this.set("colorCanvas",SC.convertHsvToHex(this._h,1,1));this.set("selectedColor",SC.convertHsvToHex(this._h,this._s,this._v))}},dismissPane:function(c){var d=this.delegate;if(d&&d.colorPickerPaneDidDismiss){d.colorPickerPaneDidDismiss(this,c.get("actionKey"))}this.remove()},commitAndDismiss:function(c){this.remove();var d=this.delegate;if(d&&d.colorPickerPaneDidDismiss){d.colorPickerPaneDidDismiss(this,CW.COMMIT,c)}},discardAndDismiss:function(){this.remove();var b=this.delegate;if(b&&b.colorPickerPaneDidDismiss){this.set("selectedColor",this.get("_originalColor"));b.colorPickerPaneDidDismiss(this,CW.DISCARD)}},selectedColorDidChange:function(){var c=this.getPath("contentView.colorBoxView.selectedColorView");if(c){c.displayDidChange()}var d=this.delegate;if(d&&d.pointerMovedOnCustomColorCanvas){d.pointerMovedOnCustomColorCanvas(this)}}.observes("selectedColor"),colorCanvasDidChange:function(){var b=this.getPath("contentView.colorBoxView.colorCanvasView");if(b){b.displayDidChange()}}.observes("colorCanvas"),initColor:function(s){var p=SC.convertHexToHsv(s),q=p[0],h=p[1],l=p[2],t=SC.convertHsvToHex(q,1,1),m=Math.round(121*h),n=Math.round(124*(1-l)),o=Math.round(131*q);this.set("colorCanvas",t||"");this.set("_h",q||"");this.set("_s",h||"");this.set("_v",l||"");this.get("colorPointer").adjust({left:m,top:n+34});this.get("colorSlider").adjust({top:o+29})}});CW.ErrorPicker=SC.PickerPane.extend({layout:{left:0,top:0,height:15,right:0,minWidth:36},classNames:["error-picker"],errorText:"Please fill in required info",pointerOffset:[10,20,-17,19],preferType:SC.PICKER_POINTER,acceptsKeyPane:NO,acceptsFirstResponder:NO,isModal:NO,contentView:SC.LabelView.extend({layout:{width:192,bottom:0,top:0,minWidth:36},classNames:["error-picker-label"],valueBinding:"*parentView.errorText",textAlign:SC.ALIGN_CENTER,controlSize:SC.SMALL_CONTROL_SIZE,render:function(g,j){arguments.callee.base.apply(this,arguments);var l=this.get("parentView"),h=l.layout.height||26,m;var k=this.getPath("parentView.classNames").toString().replace(/,/g," ")+" "+this.get("classNames").toString().replace(/,/g," ")+" sc-small-size";m=this.getViewWidth(h,this.get("value"),k)+1;this.adjust({width:m}).updateLayout();l.adjust({width:m-46}).updateLayout();l.positionPane()},getViewWidth:function(g,f,h){var k=document.createElement("div");k.style.cssText="height: %@px; top:-10000px; left: -10000px; position: absolute; text-wrap: normal; word-wrap: break-word;".fmt(g);k.className=h;k.innerHTML=SC.RenderContext.escapeHTML(f);document.body.appendChild(k);var j=k.offsetWidth;document.body.removeChild(k);return j}}),preferMatrix:[2,3,2,2,2],render:function(e,g){var f=this.get("pointerPos");if(e.needsContent){this.renderChildViews(e,g);e.push("<div class='top-left-edge'></div>","<div class='top-edge'></div>","<div class='top-right-edge'></div>");if(f.indexOf(SC.POINTER_LAYOUT[2])!==-1){e.push('<div class="top-middle-edge" style="margin-top: '+this.get("pointerPosY")+'px"></div>')}else{if(f.indexOf(SC.POINTER_LAYOUT[3])!==-1){e.push('<div class="bottom-middle-edge" style="margin-top: '+this.get("pointerPosY")+'px"></div>')}}}else{var h=this.$(".sc-pointer");if(f===SC.POINTER_LAYOUT[2]){h.attr("class","top-middle-edge");h.attr("style","margin-top: "+this.get("pointerPosY")+"px")}else{if(f===SC.POINTER_LAYOUT[3]){h.attr("class","bottom-middle-edge");h.attr("style","margin-top: "+this.get("pointerPosY")+"px")}}}e.addClass(f)}});CW.ErrorPicker.showError=function(e,d){var f=this.create({errorText:d});f.popup(e,SC.PICKER_POINTER);return f};CW.BottomPaneView=SC.View.extend(SC.StaticLayout,{useStaticLayout:NO,childViews:["leftView","rightView"],buttonOne:SC.outlet("rightView.okButton"),buttonTwo:SC.outlet("rightView.cancelButton"),buttonThree:SC.outlet("leftView.extraButton"),leftButtonsContainerWidth:null,rightButtonsContainerWidth:null,leftViewLayout:function(){return{bottom:1,height:26,width:this.get("leftButtonsContainerWidth"),left:8}}.property("leftButtonsContainerWidth").cacheable(),rightViewLayout:function(){return{bottom:1,height:26,width:this.get("rightButtonsContainerWidth"),right:8}}.property("rightButtonsContainerWidth").cacheable(),delegate:null,action:null,buttonOneHash:{useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{right:0,height:"auto",width:"auto",bottom:0},title:"Button.OK",icon:null,action:"dismiss",isDefault:YES},buttonTwoHash:{useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},title:"Button.Cancel",icon:null,action:"dismiss",isVisible:YES,isCancel:YES},buttonThreeHash:{useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},title:"Extra",icon:null,action:"dismiss",isVisible:NO},rightView:SC.View.extend({layoutBinding:"*owner.rightViewLayout",classNames:["text-align-right"],buttonOneHashBinding:"*parentView.buttonOneHash",buttonTwoHashBinding:"*parentView.buttonTwoHash",cancelButton:SC.ButtonView.extend(),okButton:SC.ButtonView.extend(),buttonHashObserver:function(){var c,d;c=this.okButton=SC.ButtonView.create(this.get("buttonOneHash"));d=this.cancelButton=SC.ButtonView.create(this.get("buttonTwoHash"));this.replaceAllChildren([d,c])}.observes("buttonOneHash","buttonTwoHash")}),leftView:SC.View.extend({layoutBinding:"*owner.leftViewLayout",classNames:["text-align-left"],isVisible:YES,buttonThreeHashBinding:"*parentView.buttonThreeHash",extraButton:SC.ButtonView.extend(),buttonHashObserver:function(){var b;b=this.extraButton=SC.ButtonView.create(this.get("buttonThreeHash"));this.replaceAllChildren([b])}.observes("buttonThreeHash")})});CW.FallOffScrollView=SC.ScrollView.extend({fallOffWidth:null,fallOffSize:SC.REGULAR_CONTROL_SIZE,classNames:["falloff-scroll"],showGradientOnlyIfScrollerVisible:NO,scrollerViewOffset:function(){return(this.get("isVerticalScrollerVisible")&&!this.get("verticalOverlay"))?this.getPath("verticalScrollerView.scrollbarThickness"):0}.property("isVerticalScrollerVisible"),applyScrollerViewOffset:function(){var f=this._falloffTop,e=this._falloffBottom;if(!SC.none(this.get("falloffWidth"))||!(f&&e)){return}var d=this._cssHash||(this._cssHash={});d.right=this.get("scrollerViewOffset");f.css(d);e.css(d)}.observes("scrollerViewOffset"),calculateFalloffVisibility:function(){var f,e,h=this.get("verticalScrollOffset"),g=this.get("maximumVerticalScrollOffset");if(!this.get("isVerticalScrollerVisible")&&this.get("showGradientOnlyIfScrollerVisible")){f=NO;e=NO}else{f=h!==0;e=h!==g}this.setIfChanged("showingTopFalloff",f);this.setIfChanged("showingBottomFalloff",e)},_calculateFalloffVisibilityOnce:function(){this.invokeOnce(this.calculateFalloffVisibility)}.observes("isVerticalScrollerVisible","verticalScrollOffset","showGradientOnlyIfScrollerVisible","maximumVerticalScrollOffset"),showingTopFalloff:NO,showOrHideTopFalloff:function(){var k=this.$(".falloff.top")[0];if(!k){return}var f=SC.browser.isIE8OrLower?0:300,h=this.get("showingTopFalloff")?1:0,j=this._wasShowingTopFalloff?1:0;this._wasShowingTopFalloff=this.get("showingTopFalloff");if(this._cwfs_topFalloffAnimation){this._cwfs_topFalloffAnimation.redirectTo(h)}else{if(h>0){k.style.display="block"}var g=this;this._cwfs_topFalloffAnimation=CW.Animation.create({duration:f,from:j,to:h,update:function(){k.style.opacity=this.current},cleanup:function(){if(this.to<1){k.style.display="none"}g._cwfs_topFalloffAnimation=null}.listens("finish")});this._cwfs_topFalloffAnimation.start()}}.observes("showingTopFalloff"),showingBottomFalloff:NO,showOrHideBottomFalloff:function(){var f=this.$(".falloff.bottom")[0];if(!f){return}var k=SC.browser.isIE8OrLower?0:300,h=this.get("showingBottomFalloff")?1:0,j=this._wasShowingBottomFalloff?1:0;this._wasShowingBottomFalloff=this.get("showingBottomFalloff");if(this._cwfs_bottomFalloffAnimation){this._cwfs_bottomFalloffAnimation.redirectTo(h)}else{if(h>0){f.style.display="block"}var g=this;this._cwfs_bottomFalloffAnimation=CW.Animation.create({duration:k,from:j,to:h,update:function(){f.style.opacity=this.current},cleanup:function(){if(this.to<1){f.style.display="none"}g._cwfs_bottomFalloffAnimation=null}.listens("finish")});this._cwfs_bottomFalloffAnimation.start()}}.observes("showingBottomFalloff"),render:function(t,x){arguments.callee.base.apply(this,arguments);if(SC.platform.touch){return}if(x){var s=this.get("fallOffWidth"),w=this.get("fallOffSize"),v="",u=this.get("showingTopFalloff"),n=this.get("showingBottomFalloff"),q,p,m=(w===SC.SMALL_CONTROL_SIZE)?"small":(w===SC.REGULAR_CONTROL_SIZE)?"regular":"large",o='<span class="right"/><span class="middle"/><span class="left"/>';if(!SC.none(s)){v+="width: %@px;".fmt(s)}else{v+="right: %@px;".fmt(this.get("scrollerViewOffset"))}if(!u){q=v+"display: none; opacity: 0;"}else{q=v}this._wasShowingTopFalloff=u;if(!n){p=v+"display: none; opacity: 0;"}else{p=v}this._wasShowingBottomFalloff=n;t.push('<div class="falloff %@1 top" style="%@2">%@4</div><div class="falloff %@1 bottom" style="%@3">%@4</div>'.fmt(m,q,p,o))}},didCreateLayer:function(b){this._falloffBottom=this.$(".falloff.bottom");this._falloffTop=this.$(".falloff.top");b()}.enhance()});sc_require("views/pane_bottom");sc_require("views/falloff_scroll");CW.PICKER_BOTTOM_BORDER_HEIGHT=28;CW.DEFAULT_POINTER_POSITION_FROM_TOP=33;CW.ADJUST_PARENT_DEBUGGING=NO;CW.PopOver=SC.PickerPane.extend({classNames:["pop-over"],innerScrollView:SC.outlet("contentView.wellView.contentView"),innerTitleView:SC.outlet("contentView.titleView"),innerContentOfScrollView:SC.outlet("contentView.wellView.contentView.contentView"),innerContent:SC.outlet("contentView.wellView.contentView"),innerBottomView:SC.outlet("contentView.bottomView"),contentViewHasScrollerView:NO,titleView:null,hasBottomView:NO,bottomViewWidthDistribution:null,leftButtonsContainerWidth:function(){return this.bottomViewWidthDistribution?this.bottomViewWidthDistribution.leftButtonsContainerWidth:".30"}.property("bottomViewWidthDistribution").cacheable(),rightButtonsContainerWidth:function(){return this.bottomViewWidthDistribution?this.bottomViewWidthDistribution.rightButtonsContainerWidth:".70"}.property("bottomViewWidthDistribution").cacheable(),delegate:null,action:null,verticalOverlay:YES,setInitialLayout:YES,popup:function(){arguments.callee.base.apply(this,arguments)},bottomView:CW.BottomPaneView.extend({layout:{height:32,left:0,right:0,bottom:0},leftButtonsContainerWidthBinding:"*parentView.parentView.leftButtonsContainerWidth",rightButtonsContainerWidthBinding:"*parentView.parentView.rightButtonsContainerWidth",delegateBinding:"*parentView.delegate",actionBinding:"*parentView.action"}),initialLayout:null,wellViewLayout:{top:10,left:12,right:12,bottom:10},wellView:SC.WellView.extend({}),contentViewLayout:{top:4,left:0,right:0,bottom:4},alwaysPositionBottom:NO,adjustLayout:YES,isLoading:NO,loadingText:null,isVerticalScrollerVisible:function(){if(this.get("contentViewHasScrollerView")){var b=this.get("innerScrollView");return b.get("isVerticalScrollerVisible")}return NO}.property(),render:function(n,k){var o=this.get("pointerPosY"),h=this.get("pointerPos"),m=0,l;if(h===SC.POINTER_LAYOUT[0]){m=0}else{if(h===SC.POINTER_LAYOUT[1]){l=this.get("layout");m=(l)?l.width:0}else{if(h===SC.POINTER_LAYOUT[2]||h===SC.POINTER_LAYOUT[3]){l=this.get("layout");m=(l)?l.width/2:0}}}if(h!==SC.POINTER_LAYOUT[3]&&h!==SC.POINTER_LAYOUT[2]){o+=CW.DEFAULT_POINTER_POSITION_FROM_TOP}n.addClass("popme");if(!SC.none(n.styles()["-webkit-transform-origin"])){n.removeStyle("-webkit-transform-origin")}if(!SC.none(n.styles()["-moz-transform-origin"])){n.removeStyle("-moz-transform-origin")}n.addStyle("-webkit-transform-origin","%@px %@px".fmt(m,o));n.addStyle("-moz-transform-origin","%@px %@px".fmt(m,o));var j=arguments.callee.base.apply(this,arguments);return j},contentView:SC.View.extend({classNames:["picker-contentView"],layout:{top:0,left:0,right:0,bottom:0},createChildViews:function(){var v=[],n=this.parentView,o=n.innerContentView,s=n.scrollView,p=n.titleView,z=n.contentViewLayout,w=n.hasBottomView,y=n.bottomView,t=n.get("contentViewHasScrollerView"),x=n.get("wellView"),u=n.get("wellViewLayout"),q=this.parentView.get("verticalOverlay");if(p){p=this.titleView=this.createChildView(p);this.childViews.pushObject(p)}if(w){this.bottomView=y=this.createChildView(y);this.childViews.pushObject(y)}if(t){this.wellView=x=this.createChildView(x,{layout:u,contentLayout:z,contentView:CW.FallOffScrollView.extend({classNames:["pop-over-scroll"],fallOffSize:SC.REGULAR_CONTROL_SIZE,verticalOverlay:q,hasHorizontalScroller:NO,verticalScrollerLayout:{right:4,top:3,bottom:4},verticalScrollerView:CW.CaplessMiniScrollerView,contentView:o,showGradientOnlyIfScrollerVisible:YES,delaysContentTouches:NO})});this.childViews.pushObject(x)}else{this.wellView=x=this.createChildView(x,{layout:u,contentLayout:z,contentView:o});this.childViews.pushObject(x)}}}),paneDidAttach:function(){arguments.callee.base.apply(this,arguments);this.set("initialLayout",this.get("layout"))},getContentView:function(){if(this.get("contentViewHasScrollerView")){return this.get("innerContentOfScrollView")}else{return this.get("innerContent")}},remove:function(){var d=this.get("initialLayout");var c=this.get("setInitialLayout");if(d&&c){this.set("layout",d)}arguments.callee.base.apply(this,arguments)},dismiss:function(d){var e=this.get("delegate");var f=this.get("action");if(e&&f){SC.RootResponder.responder.sendAction(f,e,d.get("actionKey"))}else{CW.fatalError("Delegate and action were not provided")}},name:"Pop Over",readableName:function(){return this.name||this.toString()}.property("name").cacheable(),updateHeight:function(g,f){var e=this.get("frame").height,h=(e+g);if(CW.ADJUST_PARENT_DEBUGGING){CW.debug("%@ current height ---> %@",this,e);CW.debug("%@ pickerHeightChange ---> %@",this,h)}this.adjust({height:h});if(f){this.adjustChildViewsLayout(g,f)}this.windowSizeDidChange(null,SC.RootResponder.responder.computeWindowSize())},fitPositionToScreenPointer:function(a,p,f){if(this.get("alwaysPositionBottom")){var m=(f.height>12)?0:1;var o=(f.height>12)?0:3;var v;var s=[[f.x+f.width+(7+m),f.y+parseInt(f.height/2,0)-40],[f.x-p.width-(7+m),f.y+parseInt(f.height/2,0)-40],[f.x+parseInt((f.width/2)-(p.width/2),0),f.y-p.height-(17+o)],[f.x+parseInt((f.width/2)-(p.width/2),0),f.y+f.height+(17+o)]];var t=[[f.x+f.width+p.width+(7+m),f.y+parseInt(f.height/2,0)+p.height-24],[f.x-(7+m),f.y+parseInt(f.height/2,0)+p.height-24],[f.x+parseInt((f.width/2)-(p.width/2),0)+p.width,f.y-(17+o)],[f.x+parseInt((f.width/2)-(p.width/2),0)+p.width,f.y+f.height+p.height+(17+o)]];var q=[[s[0][1]>0?0:0-s[0][1],t[0][0]<a.width?0:t[0][0]-a.width,t[0][1]<a.height?0:t[0][1]-a.height,s[0][0]>0?0:0-s[0][0]],[s[1][1]>0?0:0-s[1][1],t[1][0]<a.width?0:t[1][0]-a.width,t[1][1]<a.height?0:t[1][1]-a.height,s[1][0]>0?0:0-s[1][0]],[s[2][1]>0?0:0-s[2][1],t[2][0]<a.width?0:t[2][0]-a.width,t[2][1]<a.height?0:t[2][1]-a.height,s[2][0]>0?0:0-s[2][0]],[s[3][1]>0?0:0-s[3][1],t[3][0]<a.width?0:t[3][0]-a.width,t[3][1]<a.height?0:t[3][1]-a.height,s[3][0]>0?0:0-s[3][0]]];if(!this.preferMatrix||this.preferMatrix.length!==5){this.set("preferMatrix",[0,1,2,3,0])}var u=this.preferMatrix;if(u[4]===-1){p.x=f.x+parseInt(f.width/2,0);p.y=f.y+parseInt(f.height/2,0)-parseInt(p.height/2,0);this.set("pointerPos",SC.POINTER_LAYOUT[0]+" fallback");this.set("pointerPosY",parseInt(p.height/2,0)-40)}else{p.x=s[u[4]][0];p.y=s[u[4]][1];this.set("pointerPos",SC.POINTER_LAYOUT[u[4]]);this.set("pointerPosY",0)}this.set("pointerPosX",0);v=u[0];p.x=s[v][0];p.y=s[v][1];this.set("pointerPosY",0);this.set("pointerPos",SC.POINTER_LAYOUT[v])}else{p=arguments.callee.base.apply(this,arguments)}return p},windowSizeDidChange:function(s,n){var m=this.get("innerScrollView"),k,p,o,t,q,l;if(!this.get("isPaneAttached")){return}if(s&&n&&s.height===n.height&&s.width===n.width){return this}if(this.get("alwaysPositionBottom")&&this.get("contentViewHasScrollerView")&&this.get("adjustLayout")){SC.RunLoop.begin();SC.RunLoop.end();k=m.get("containerView").get("frame").height;p=m.get("contentView").get("frame").height;o=p-k;t=n.height;q=this.get("frame");l=t-(q.y+q.height+CW.PICKER_BOTTOM_BORDER_HEIGHT);l=o>l?l:o;this.adjust({height:q.height+l})}this.positionPane(s===null?YES:NO);return this},setButtonHash:function(g,k,h){var l=["buttonOne","buttonTwo","buttonThree"];var j=this.get("hasBottomView");if(!j){CW.fatalError("there is no bottomView provided")}if(l.indexOf(h)===-1){CW.fatalError("buttonNumber provided is invalid")}var m=SC.clone(this.getPath("pane.innerBottomView."+h+"Hash"));m[g]=k;this.getPath("pane.innerBottomView").set(h+"Hash",m)},setHash:function(e,f){var h=["buttonOne","buttonTwo","buttonThree"];var g=this.get("hasBottomView");if(!g){CW.fatalError("there is no bottomView provided")}if(h.indexOf(f)===-1){CW.fatalError("buttonNumber provided is invalid")}this.getPath("pane.innerBottomView").set(f+"Hash",e)},addViewToTheContentView:function(e){var d=this.get("contentViewHasScrollerView"),f;if(d){f=this.get("innerContentOfScrollView")}else{f=this.get("innerContent")}f.appendChild(e)},removeViewFromTheContentView:function(e){var d=this.get("contentViewHasScrollerView"),f;if(d){f=this.get("innerContentOfScrollView")}else{f=this.get("innerContent")}f.removeChild(e)},isLoadingObserver:function(){var e=this.get("loadingText"),f=this.get("isLoading"),h=this.get("loadingView"),g=this.getPath("contentView.wellView").get("frame");if(f){h=CW.LoadingView.show(g.width-4,g.height-4,e,"overlay-loading-view");this.set("loadingView",h);this.getPath("contentView.wellView").appendChild(h)}else{if(h){this.getPath("contentView.wellView").removeChild(h)}else{SC.error("There is no Loading View")}}}.observes("isLoading"),adjustHeightAndPositionPane:function(b){if(b&&b>0){this.adjust({height:b}).positionPane()}return this},positionPane:function(w){var t=this.get("anchorElement"),u=this.get("anchorView"),o=this.get("preferType"),p=this.get("preferMatrix"),q=this.get("layout"),m,x,n,v,s;if(t){if(!w){if(u){x=u.get("frame");n=x.width;v=x.height}t=this.computeAnchorRect(t,n,v);if(t.x===0&&t.y===0){return}m=SC.cloneRect(t);if(o){switch(o){case SC.PICKER_MENU:case SC.PICKER_FIXED:if(!p||p.length!==3){this.set("preferMatrix",[1,4,3])}m.x+=((this.preferMatrix[2]===0)?m.width:0)+this.preferMatrix[0];m.y+=((this.preferMatrix[2]===3)?m.height:0)+this.preferMatrix[1];break;default:m.y+=m.height;break}}else{m.y+=m.height}this._originCached=m;this._anchorCached=t}else{m=this._originCached;t=this._anchorCached}s=this.fitPositionToScreen(m,this.get("frame"),t);this.adjust({width:s.width,height:s.height,left:s.x,top:s.y})}else{this.adjust({width:q.width,height:q.height,centerX:0,centerY:0})}this.updateLayout();return this}});sc_require("views/mini_fading_capless_scroller");CW.Prompt=SC.PanelPane.extend({message:"",messageViewPaddingBottom:10,description:null,descriptionViewPadding:{top:0,bottom:4},descriptionViewMinHeight:9,descriptionViewMaxHeight:CW.get("isMobile")?200:300,caption:null,captionViewPadding:{top:4,bottom:7},captionViewMinHeight:0,image:"me-icon-alert-68",rightButton:"OK",middleButton:null,leftButton:null,extraView:null,extraViewPadding:{top:5,bottom:3},extraViewMinHeight:0,escapeHTML:NO,layout:{centerX:0,width:450,centerY:-10,height:160},defaultText:null,classNames:["cw-alert"],ariaRole:"alertdialog",init:function(){arguments.callee.base.apply(this,arguments);if(this.get("extraWide")){this.adjust("width",500)}if(CW.isMobile()){this.layout={left:20,centerY:0,right:20}}},modalPane:SC.ModalPane.extend(CW.Animatability,CW.PaneFadingSupport,{classNames:"cw-modal".w(),paneFadeInDuration:!SC.browser.webkit?350:function(){return 350*(innerWidth<1983&&innerHeight<1983)}.property(),paneFadeOutDuration:function(){return this.get("paneFadeInDuration")}.property(),paneOpacity:0.5,init:function(){if((SC.browser.webkit)&&(innerWidth>=1983||innerHeight>=1983)){this.classNames.push("no-gpu")}arguments.callee.base.apply(this,arguments);var e=SC.RootResponder.responder.mainPane;if(e){var d=e.layout.minWidth,f=e.layout.minHeight;if(d){this.adjust("minWidth",d)}if(f){this.adjust("minHeight",f)}}}}),contentView:SC.View.design({layout:{left:0,right:0,top:0,bottom:0},escapeHTMLBinding:"*parentView.escapeHTML",separatorView:SC.View.design({layout:{height:2,right:5,left:5,bottom:56},classNames:["separator"]}),createChildViews:function(){SC.Binding.flushPendingChanges();var D=this.get("escapeHTML"),E=this.get("pane"),H=E.get("message"),B=E.get("description"),x=E.get("caption"),C=E.get("defaultText"),F=(CW.get("isMobile")||(SC.typeOf(C)===SC.T_STRING))?null:E.get("image"),P=E.get("extraView"),L=E.get("rightButton"),K=E.get("middleButton"),M=E.get("leftButton"),w=this.childViews,I=CW.Prompt,G="Trying to create a CW.Prompt with a %@ button that is neither a string, nor a button view.",J,O,y,Q,z,v,N;if(F){if(SC.typeOf(F)===SC.T_STRING){this.imageView=I.ImageView.extend({value:F})}else{if(F.value&&F.width&&F.height){this.imageView=I.ImageView.extend({value:F.value,width:F.width,height:F.height})}else{CW.fatalError("Trying to create a CW.Prompt with improper an invalid image hash.")}}w.push("imageView")}if(!H){CW.fatalError("Trying to create a CW.Prompt without a message.")}this.messageView=I.MessageView.extend({value:H,escapeHTML:D});w.push("messageView");if(B){this.descriptionView=I.DescriptionView.extend({value:B,escapeHTML:D});w.push("descriptionView")}if(SC.typeOf(C)===SC.T_STRING){this.promptView=I.PromptView.extend({hint:C,escapeHTML:D});w.push("promptView")}if(x){this.captionView=I.CaptionView.extend({value:x,escapeHTML:D});w.push("captionView")}if(P){this.extraView=P;w.push("extraView")}w.push("separatorView");if(M){if(SC.typeOf(M)===SC.T_STRING){J={title:M,action:"remove",target:E}}else{if(SC.typeOf(M)===SC.T_HASH){J=M}else{CW.fatalError(G.fmt("left"))}}this.leftButtonView=I.LeftButtonView.extend(J);w.push("leftButtonView")}if(K){if(SC.typeOf(K)===SC.T_STRING){O=K;y="remove";Q=E}else{if(SC.typeOf(K)===SC.T_HASH){O=K.title?K.title:"Cancel";y=K.action?K.action:null;Q=K.target?K.target:E}else{CW.fatalError(G.fmt("middle"))}}}if(!L){CW.fatalError("Trying to create a CW.Prompt without a right button.")}if(SC.typeOf(L)===SC.T_STRING){z=L;v="remove";N=E}else{if(SC.typeOf(L)===SC.T_HASH){z=L.title?L.title:"OK";v=L.action?L.action:null;N=L.target?L.target:E}else{CW.fatalError(G.fmt("right"))}}this.mainButtonsView=I.MainButtonsView.extend({middleButtonIsVisible:K?YES:NO,middleButtonTitle:O,middleButtonAction:y,middleButtonTarget:Q,rightButtonTitle:z,rightButtonAction:v,rightButtonTarget:N});w.push("mainButtonsView");return arguments.callee.base.apply(this,arguments)},extraViewFrameDidChange:function(){if(this._resizingExtraView){this._resizingExtraView=NO;return}this.performLayout()},didCreateLayer:function(){var f=this.get("pane");if(SC.browser.isIE8OrLower){f.$()[0].style.filter="alpha(opacity=0)"}else{f.$().css({opacity:0,"-webkit-animation-name":"none",})}var d=this.get("extraView");if(d&&d.isAutoResizingExtraView){d.addObserver("frame",this,this.extraViewFrameDidChange)}var e=this;this.invokeLater(function(){e.performLayout()},100)},performLayout:function(){var K=this.get("pane"),O=this.messageView,ai=this.descriptionView,E=this.promptView,N=K.get("descriptionViewMinHeight")||0,J=K.get("descriptionViewMaxHeight")||0,U=this.captionView,ae=K.get("captionViewMinHeight")||0,af=this.extraView,V=K.get("extraViewMinHeight")||0,Y=this.imageView,L=K.get("image"),H=O.getPath("layout.top"),ad=this.mainButtonsView,X=CW.Prompt,F=X.MIN_Prompt_HEIGHT,ah=null,S,ag,M,I=0,Q,G,ab,ac,Z,T,P,R,aa;if(SC.browser.isIE8OrLower){K.$()[0].style.filter="alpha(opacity=100)"}else{K.$().css({opacity:1,"-webkit-animation-name":"pop",})}K.set("ariaLabelledBy",SC.guidFor(O));K.set("ariaDescribedBy",SC.guidFor(ai));S=O.get("value");ag=O.get("layer");G=O.get("frame").width+"px";ag.style.maxWidth=G;M=SC.metricsForString(S,ag,null,!this.get("escapeHTML")).height;if(E){O.adjust("left",25)}O.adjust("height",M);H+=M;aa=K.get("messageViewPaddingBottom");if(aa){H+=aa}if(ai){P=K.get("descriptionViewPadding");if(P&&(R=P.top)){H+=R}ai.adjust("top",H);S=ai.get("value");ag=ai.contentView.get("layer");ag.style.maxWidth=G;M=SC.metricsForString(S,ag,null,!this.get("escapeHTML")).height;if(M<N){M=N}else{if(M>J){ah=M;M=J}}if(E&&ai.contentView){ai.contentView.adjust("left",25)}ai.adjust("height",M);if(ah){ai.contentView.adjust("height",CW.get("isMobile")?ah+200:ah)}H+=M;if(P&&(aa=P.bottom)){H+=aa}}else{H+=N}if(E){E.adjust("top",H+5);promptViewHeight=E.get("frame").height;H+=promptViewHeight+5}if(U){P=U.get("padding");if(P&&(R=P.top)){H+=R}U.adjust("top",H);S=U.get("value");ag=U.get("layer");ag.style.maxWidth=G;M=SC.metricsForString(S,ag,null,!this.get("escapeHTML")).height;if(M<ae){M=ae}if(E){U.adjust("left",25)}U.adjust("height",M);H+=M;if(P&&(aa=P.bottom)){H+=aa}}else{H+=ae}if(af){this._resizingExtraView=YES;P=K.get("extraViewPadding");if(P&&(R=P.top)){H+=R}af.adjust("top",H);M=undefined;if(af.isAutoResizingExtraView){M=af.computeHeight()}if(SC.none(M)){M=af.get("frame").height}if(SC.none(M)){CW.fatalError("Trying to create a CW.Prompt with an extraView which does not have its height specified.")}if(M<V){M=V}H+=M;if(P&&(aa=P.bottom)){H+=aa}}else{H+=V}if(Y&&L.width&&L.height){Y.adjust("width",L.width);Y.adjust("height",L.height);imageViewBottom=Y.getPath("frame.bottom")}H+=X.BUTTONS_AND_SEPARATOR_HEIGHT;if(H<F){H=F}ab=ad.middleButton;ac=ad.rightButton;if(this.leftButtonView){T=this.leftButtonView.get("frame");if(T){I=T.width}}if(ab){T=ab.get("frame");if(T){I+=T.width}}if(ac){T=ac.get("frame");if(T){I+=T.width}}K.adjust("height",H);Z=X.BUTTONS_REGULAR_PADDING+X.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT+(X.BUTTONS_SIDE_PADDING*2);if(I+Z>K.get("frame").width){K.adjust("width",I+Z)}this._resizingExtraView=NO;var W=this.$(".def");setTimeout(function(){W[0].focus()},1000)}})});CW.Prompt.BUTTONS_REGULAR_PADDING=8;CW.Prompt.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT=15;CW.Prompt.BUTTONS_SIDE_PADDING=20;CW.Prompt.BUTTONS_AND_SEPARATOR_HEIGHT=71;CW.Prompt.MIN_Prompt_HEIGHT=162;CW.Prompt.MessageView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,top:26,right:25},classNames:["title-label"],ariaRole:"heading"});CW.Prompt.DescriptionView=SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["description"],valueBinding:".parentView.parentView.value",escapeHTMLBinding:".parentView.parentView.escapeHTML",})});CW.Prompt.CaptionView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["caption"]});CW.Prompt.ImageView=SC.ImageView.extend({layout:{left:25,top:22,width:68,height:68},classNames:["cw-alert-image-view"]});CW.Prompt.PromptView=SC.TextFieldView.extend({layout:{left:25,right:25,height:70},isTextArea:true,classNames:["prompt"],render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this.$(".field").css("font-size","23px");this.becomeFirstResponder()})}});CW.Prompt.MainButtonsView=SC.View.extend({layout:{height:30,bottom:11,right:16,left:16},classNames:["text-align-right"],childViews:["middleButton","rightButton"],middleButtonIsVisible:YES,middleButtonTitle:"Cancel",middleButtonAction:null,middleButtonTarget:null,rightButtonTitle:"Ok",rightButtonAction:null,rightButtonTarget:null,init:function(){arguments.callee.base.apply(this,arguments);this.middleButton.set("title",this.middleButtonTitle);this.middleButton.set("isVisible",this.middleButtonIsVisible);this.middleButton.set("action",this.middleButtonAction);this.middleButton.set("target",this.middleButtonTarget);this.rightButton.set("title",this.rightButtonTitle);this.rightButton.set("action",this.rightButtonAction);this.rightButton.set("target",this.rightButtonTarget)},middleButton:SC.ButtonView.extend({isCancel:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0}}),rightButton:SC.ButtonView.extend({isDefault:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0},render:function(b){b.attr("tabindex","0");return arguments.callee.base.apply(this,arguments)}})});CW.Prompt.LeftButtonView=SC.ButtonView.extend(SC.AutoResize,{title:"Other...",themeName:"square",controlSize:SC.HUGE_CONTROL_SIZE,layout:{height:30,left:18,bottom:11,minWidth:72}});CW.Prompt.ExtraViewAutoResizingSupport={isAutoResizingExtraView:YES,computeHeight:function(){var g=this.get("autoResizeLayer")||this.get("layer"),k=this.getPath("frame.width"),h=this.get("autoResizeText")||"",j=this.get("autoResizePadding")||0,f;if(SC.none(g)||SC.empty(h)){return 0}g.style.maxWidth=k+"px";f=SC.metricsForString(h,g,this.get("classNames"),!this.get("escapeHTML"));return f.height+j}};CW.Prompt.show=function(c){if(SC.typeOf(c)===SC.T_HASH){var d=this.create(c);d.append();return d}CW.fatalError("Attempted to show a CW.Prompt without options.");return null};CW.SquareMenuPane=SC.MenuPane.extend({classNames:"me-square-menu",itemHeight:31,itemSeparatorHeight:7,menuHeightPadding:6});CW.CANVAS_BUTTON_HEIGHT=26;CW.TOOLBAR_BUTTON_HEIGHT=26;CW.SQUARE_BUTTON_REGULAR_HEIGHT=27;CW.IOS_BUTTON_REGULAR_HEIGHT=30;CW.IOSMINI_BUTTON_REGULAR_HEIGHT=24;CW.IOSBIG_BUTTON_REGULAR_HEIGHT=46;CW.SELECT_BUTTON_REGULAR_HEIGHT=27;CW.POPUP_BUTTON_REGULAR_HEIGHT=27;CW.SQUARE_BUTTON_REGULAR_MIN_WIDTH=68;CW.SQUARE_BUTTON_SMALL_MIN_WIDTH=56;CW.SQUARE_BUTTON_TINY_MIN_WIDTH=52;CW.HELP_BUTTON_REGULAR_MIN_WIDTH=26;CW.HELP_BUTTON_SMALL_MIN_WIDTH=22;CW.HELP_BUTTON_TINY_MIN_WIDTH=18;CW.CHECKBOX_REGULAR_HEIGHT=18;CW.PROGRESS_REGULAR_HEIGHT=20;CW.PROGRESS_CAPSULE_HEIGHT=19;CW.PROGRESS_CAPSULE_ANIMATED_BACKGROUND_MATRIX=[171,19,31];CW.PROGRESS_REGULAR_OFFSETRANGE=32;CW.PROGRESS_CAPSULE_OFFSETRANGE=20;CW.TEXT_FIELD_SMALL_HEIGHT=18;CW.TEXT_FIELD_REGULAR_HEIGHT=22;CW.TEXT_FIELD_LARGE_HEIGHT=26;CW.TEXT_FIELD_LARGE_TALL_HEIGHT=31;CW.TEXT_FIELD_HUGE_HEIGHT=31;CW.SLIDER_REGULAR_HEIGHT=25;CW.DOCK_HEIGHT=46;CW.SOURCE_LIST_WIDTH=171;CW.TINY_CONTROL_SIZE=SC.TINY_CONTROL_SIZE;CW.SMALL_CONTROL_SIZE=SC.SMALL_CONTROL_SIZE;CW.REGULAR_CONTROL_SIZE=SC.REGULAR_CONTROL_SIZE;CW.LARGE_CONTROL_SIZE=SC.LARGE_CONTROL_SIZE;CW.LARGE_TALL_CONTROL_SIZE="me-large-tall-size";CW.XLARGE_CONTROL_SIZE=SC.HUGE_CONTROL_SIZE;CW.DropTarget={isDropTarget:YES,acceptsFileDrags:YES,dragStarted:function(c,d){},dragEntered:function(c,d){},dragUpdated:function(c,d){},dragExited:function(c,d){},dragEnded:function(c,d){},computeDragOperations:function(c,d){return SC.DRAG_NONE},acceptDragOperation:function(d,c){return YES},performDragOperation:function(d,c){return SC.DRAG_NONE},_isCurrentlyHovered:NO,renderMixin:function(d,c){if(c&&SC.browser.isWebkit&&this.get("acceptsFileDrags")){d.push('<div class="cw-drop-target-container"><input class="cw-drop-target-file" type="file" multiple="multiple"></div>')}},didCreateLayer:function(d){d();if(!this.get("acceptsFileDrags")){return}var f=this.$().children(".cw-drop-target-container").children()[0]||null;if(SC.browser.isWebkit&&f){SC.Event.add(f,"change",this,this._handleDrop)}else{if(SC.browser.mozilla){var e=this.get("layer");SC.Event.add(e,"drop",this,this._handleDrop)}}}.enhance(),_changeFileElementClickability:function(e){if(SC.browser.isWebkit&&this.get("acceptsFileDrags")){var d=this.$().children(".cw-drop-target-container").children()[0]||null;var f=(e)?"block":"none";if(d&&f!==d.style.display){d.style.display=f}}},_handleDragEnter:function(d){if(CW.DropTarget.dealWithSafariWindows()){return}if(SC.browser.isWebkit){if(!(d&&d.target&&d.target.className&&d.target.className.indexOf&&d.target.className.indexOf("cw-drop-target-file")>-1)){this._isCurrentlyHovered=YES;return}}var c=d.dragOperation;if(this._isFileEvent(d)){this._changeFileElementClickability(YES)}if(this.computeDragOperations(c,d)|SC.DRAG_DATA){this.dragEntered(c,d);this._isCurrentlyHovered=YES}},_handleDragOver:function(d){var c=d.dragOperation;if(this._isFileEvent(d)){this._changeFileElementClickability(YES)}if(CW.DropTarget.dealWithSafariWindows()){return}if(this.computeDragOperations(c,d)|SC.DRAG_DATA){if(this._isCurrentlyHovered){this.dragUpdated(c,d)}else{this.dragEntered(c,d);this._isCurrentlyHovered=YES}}},_handleDrop:function(m){var j=m.dragOperation;if(!j){j=this._dragOperationForEvent(m)}this._changeFileElementClickability(NO);if(CW.DropTarget.dealWithSafariWindows()){return}if(this.acceptDragOperation(j,SC.DRAG_DATA)){var l=m.dataTransfer.files;if(l&&l.length>0){j.data=l;for(var g=0,h=l.length;g<h;++g){var k=l[g];if(SC.none(k.fileName)&&k.name){k.fileName=k.name}}}this.performDragOperation(j,SC.DRAG_DATA)}},_handleDragExit:function(e){if(SC.browser.isWebkit){if(!(e&&e.target&&e.target.className&&e.target.className.indexOf&&e.target.className.indexOf("cw-drop-target-file")>-1)){return}}var f=e.dragOperation;var d=e.originalEvent.target;if(d.type&&d.type==="file"){this._changeFileElementClickability(NO)}if(CW.DropTarget.dealWithSafariWindows()){return}this.dragExited(f,e)},_isFileEvent:function(k){var h=k.dataTransfer;if(h){var j=h.types;if(SC.none(j)){return YES}for(var f=0,g=j.length;f<g;++f){if(j[f]==="Files"){return YES}}}return NO},_notifyTargetViewsOfEvent:function(g,f){var e=SC.RootResponder.responder;var h=e.targetViewForEvent(f);if(!this._isFileEvent(f)){f.allowDefault()}else{f.stopPropagation();f.preventDefault()}if(SC.browser.isWindows&&SC.browser.isSafari){return NO}f.dragOperation=this._dragOperationForEvent(f,h);return e.sendEvent(g,f,h)},_dragOperation:null,_dragOperationForEvent:function(f,e){var g=CW.DropTarget._dragOperation;if(g){return g}var h=SC.Drag.start({event:f,source:e,ghost:NO,slideBack:NO,sourceIsDraggable:NO});CW.DropTarget._dragOperation=h;return h},_dragEndedOnDropTargets:function(n,l){if(CW.DropTarget.dealWithSafariWindows()){return}l=n.dragOperation||l;if(!l){return}var m=l._dropTargets();for(var h=0,j=m.length;h<j;h++){var o=m[h];o.tryToPerform("dragEnded",this,n);if(o&&o.get("acceptsFileDrags")){o._isCurrentlyHovered=NO;o._changeFileElementClickability(NO);if(SC.browser.isWebkit&&o.isVisibleInWindow){var k=o.$().children(".cw-drop-target-container").children()[0]||null;if(k){k.value=null}}}}CW.DropTarget._dragOperation=null}};SC.RootResponder.reopen({init:function(b){b();if(!SC.browser.isIE9OrLower){this.listenFor("dragenter dragover dragleave drop".w(),document,null,true)}}.enhance(),_dropTargetViewForEvent:function(d){var c=this.targetViewForEvent(d);while(YES){if(SC.none(c)||c.isDropTarget){return c}else{c=c.get("parentView")}}},dragenter:function(d){this.set("_lastDragEnterTarget",d.target);this._setupDragOverTimer(d);if(SC.browser.isMozilla||SC.browser.isIE10){var c=this._lastEvent;this._lastEvent=d;if(c){if(this._dropTargetViewForEvent(d)===this._dropTargetViewForEvent(c)){return}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragExit",c)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragEnter",d)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragEnter",d)}},_setupDragOverTimer:function(d){var c=this.get("_dragOverTimer");this.set("_lastDragOverEvent",d);if(c){c.invalidate()}c=SC.Timer.schedule({target:this,action:function(){var a=this.get("_lastDragOverEvent");if(a){this._lastEvent=undefined;CW.DropTarget._dragEndedOnDropTargets(a)}},interval:500,repeats:NO});this.set("_dragOverTimer",c)},dragover:function(b){this._setupDragOverTimer(b);CW.DropTarget._notifyTargetViewsOfEvent("_handleDragOver",b)},dragleave:function(d){if(SC.browser.isMozilla||SC.browser.isIE10){var c=this._lastEvent;this._lastEvent=d;if(c){if(this._dropTargetViewForEvent(c)===this._dropTargetViewForEvent(d)){return}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragEnter",c)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragExit",d)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragExit",d)}},drop:function(d){if(CW.DropTarget.eliminateDoubleDrops){if(CW.DropTarget._droppedRecently){return}CW.DropTarget._droppedRecently=YES;setTimeout(function(){CW.DropTarget._droppedRecently=undefined},1000)}var c=CW.DropTarget._notifyTargetViewsOfEvent("_handleDrop",d);if(!c){CW.DropTarget._dragEndedOnDropTargets(d)}}});CW.DropTarget.dealWithSafariWindows=function(){if(SC.browser.isWindows&&SC.browser.isSafari){CW.Alert.show({message:"CW.DropTarget.SafariWindowsNotSupported.Title".loc(),description:"CW.DropTarget.SafariWindowsNotSupported.Description".loc()});return YES}return NO};CW.PrefsTheme=SC.BaseTheme.create({name:"prefs-theme"});SC.Theme.addTheme(CW.PrefsTheme);CW.PrefsSegmentedView=SC.SegmentedView.extend(SC.Control,{themeName:"prefs-theme"});CW.PrefsTheme.buttonRenderDelegate=SC.RenderDelegate.create({name:"button",render:function(g,f){var h=g.get("title"),e=g.get("icon");f.push('<span class="sc-button-inner"><div class="sc-button-label">','<img src="',SC.BLANK_IMAGE_URL,'" alt="" class="icon '+e+'"/>','<div class="sc-button-title">',h,"</div></div></span>")},update:function(c,d){}});sc_require("views/scroller");CW.CaplessScrollerView=CW.ScrollerView.extend({classNames:"me-capless-scroller-view",hasButtons:NO,capLength:0,capOverlap:0,buttonLength:0,buttonOverlap:0});CW.CollectionFastPath={log:function(){var b=SC.A(arguments);b.unshift(SC.guidFor(this));console.log.apply(console,b)},DOMPoolSize:200,preserveDOMOrder:NO,hasContentForShowing:YES,_curShowing:null,_shouldBeShowing:null,_justCreated:null,_indexMap:null,_viewsForItem:null,_oldLayouts:null,init:function(b){this._curShowing=SC.CoreSet.create();this._shouldBeShowing=SC.CoreSet.create();this._hasNoContent=SC.CoreSet.create();this._justCreated=SC.CoreSet.create();this._indexMap=[];this._pendingPool=SC.CoreSet.create();this._viewsForItem={};this._oldLayouts={};SC.backgroundTaskQueue.minimumIdleDuration=250;SC.backgroundTaskQueue.runLimit=-1;b()}.enhance(),firstKeyView:function(){return this.itemViewForContentIndex(0)}.property(),lastKeyView:function(){return this.itemViewForContentIndex(this.get("length"))}.property(),renderFromPool:function(h){var f,e=this.attributesForIndex(h),g=this.layoutForContentIndex(h);if(f=this._indexMap[h]){if(f.get("content")!==e.content){this.unpool(f);this.sendToOffscreenDOMPool(f);f=null}else{f=this.updateView(f,e,g)}}while(!f&&(f=this.pooledViewForItem(h))){f=this.updateView(f,e,g)}while(!f&&(f=this.viewFromDOMPoolFor(h))){f=this.updateView(f,e,g)}if(!f){f=this.renderItem(this.exampleViewForIndex(h),e,g)}this.mapToItem(f);this.mapToIndex(f);return f},_SCCFP_lastContent:null,_cv_contentDidChange:function(){var h=this.get("content");if(this._SCCFP_lastContent){this._SCCFP_lastContent.removeArrayObservers({target:this})}this._SCCFP_lastContent=h;if(h){this._SCCFP_contentRangeObserver=h.addArrayObservers({target:this})}var j=this._indexMap,k,g=j.length,f;for(k=0;k<g;k++){f=j[k];if(f){this.sendToOffscreenDOMPool(f)}}this.reload();arguments.callee.base.apply(this,arguments)}.observes("content"),contentLengthDidChange:function(){this.invokeLast(this._contentLengthDidChange);this.set("length",this.getPath("content.length"))},_contentLengthDidChange:function(){var k=this.get("content"),l=k?k.get("length"):0,m=this._indexMap,o=m.length;if(l<o){var h,j;for(h=l;h<o;h++){j=m[h];if(j){this.sendToOffscreenDOMPool(j)}}}m.length=l;this.setIfChanged("length",l);var n=this.computeLayout();if(n){this.adjustCollectionView(n)}},_sclv_lengthDidChange:SC.K,adjustCollectionView:function(b){this.adjust(b)},arrayDidChange:function(h,j,k){var f=this.getPath("content.length"),g=f+j-k;this.reload(SC.IndexSet.create(h,j===k?j:Math.max(f,g)-h))},arrayWillChange:SC.K,_cv_nowShowingDidChange:function(){if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}}.observes("nowShowing"),_cv_isVisibleInWindowDidChange:function(){if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}}.observes("isVisibleInWindow"),reloadSelectionIndexes:function(b){this.reload(b)},reloadSelectionIndexesIfNeeded:function(){this.reloadIfNeeded()},reload:function(d){if(SC.none(d)){var f,e=this._indexMap.length;for(f=0;f<e;f++){this.invalidate(f)}}else{if(d.isIndexSet){d.forEach(this.invalidate,this)}else{this.invalidate(d)}}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}return this},contentIndexIsGroup:function(f,j){var k=this.get("contentDelegate"),g=this.get("_contentGroupIndexes"),h=NO;h=g&&g.contains(f);if(h){h=k.contentIndexIsGroup(this,this.get("content"),f)}return h},exampleViewForIndex:function(p){var j=this.get("contentDelegate"),q=this.get("_contentGroupIndexes"),o,k,m=this.get("content"),n=m.objectAt(p),l=this.contentIndexIsGroup(p,n);if(l){o=this.get("contentGroupExampleViewKey");if(o&&n){k=n.get(o)}if(!k){k=this.get("groupExampleView")||this.get("exampleView")}}else{o=this.get("contentExampleViewKey");if(o&&n){k=n.get(o)}if(!k){k=this.get("exampleView")}}return k},processNowShowing:function(b){if(b<this._minShowing){this._minShowing=b}if(b>this._maxShowing){this._maxShowing=b}this._shouldBeShowing.add(b)},wantsUpdate:function(b){if(this._justCreated.contains(b)){return}if(this._indexMap[b.contentIndex]===b){this.reload(b.contentIndex)}else{b._SCCFP_dirty=YES}},_SCCFP_resetBackgroundRenderQueue:function(){for(var b in this._DOMPools){this._DOMPools[b]._lastRendered=null}},reloadIfNeeded:function(F,D){var u=this.get("content"),s=u?u.get("length"):0,E=this._curShowing,C=this._shouldBeShowing,G=this._pendingRemovals||(this._pendingRemovals=[]),y=SC.platform.touch,t,B,z,v,w,x;if(!this.get("isVisibleInWindow")){return}if(!F||!F.isIndexSet){F=this.get("nowShowing")}C.clear();this._maxShowing=0;this._minShowing=s;F.forEach(this.processNowShowing,this);this._topBackground=this._maxShowing;this._bottomBackground=this._minShowing;v=E.length;for(z=0;z<v;z++){w=E[z];if(!C.contains(w)){if(!this._indexMap[w]){continue}G.push(this._indexMap[w])}}while(t=G.pop()){this.sendToDOMPool(t)}this._SCCFP_resetBackgroundRenderQueue();CW.CollectionFastPath.backgroundRenderTask.add(this);if(this.visibleDirtyViews){var q=this.visibleDirtyViews();while(t=q.pop()){if(!SC.none(t.contentIndex)&&!C.contains(t.contentIndex)){this.unpool(t);this.sendToOffscreenDOMPool(t)}}}if(y&&D){this.incrementalRenderTask.add(this)}else{while(this.renderNextNowShowing()){}CW.CollectionFastPath.backgroundRenderTask.start()}this.contentLengthDidChange()},DOMPoolSize:200,DOMPoolForExampleView:function(g){var h=this._DOMPools||(this._DOMPools={}),f=SC.guidFor(g),e=h[f];if(!g){"no exampleView to create from"}if(!e){e=h[f]=CW.CollectionFastPath._DoublyLinkedList.create()}return e},sendToDOMPool:function(g,k){if(!g){throw"cannot pool null view"}var j=this._curShowing;j.remove(g.contentIndex);this._hasNoContent.remove(g.contentIndex);this.updateHasContentForShowing();if(!g.isPoolable){return g}var h=g.createdFromExampleView,f=this.DOMPoolForExampleView(h);if(k){if(f._lastRendered){f.insertBetween(g,f._lastRendered,f._lastRendered._SCCFP_next)}else{f.enqueue(g)}f._lastRendered=g}else{f.enqueue(g)}return g},sendToOffscreenDOMPool:function(b){if(!b){throw"cannot pool null view"}this._curShowing.remove(b.contentIndex);if(!b.isPoolable){this.unmapFromIndex(b);this.unmapFromItem(b);b.destroy();return}this._pendingPool.add(b);this.unmapFromIndex(b);b.set("contentIndex",null);this.invokeOnce("flushPool")},flushPool:function(){var c=this._pendingPool;var d;while(d=c.pop()){d._willBePooled=YES;this.configureItemView(d)}},_sendToOffscreenDOMPool:function(l){var k=l.contentIndex,h,m,g,j=this.DOMPoolForExampleView(l.createdFromExampleView);this._hasNoContent.remove(k);this.updateHasContentForShowing();if(this.get("preserveDOMOrder")){l.set("isVisible",NO)}else{l.adjust("top",-1000)}this.unpool(l);j.push(l)},viewFromDOMPoolFor:function(e){var g=this.exampleViewForIndex(e),h=this.DOMPoolForExampleView(g);var f=h.tail();return f},touchScrollDidChange:function(m,n){if(Date.now()-this._lastTouchScrollTime<25){return}var l=this.get("clippingFrame");var o=this._inScrollClippingFrame||(this._inScrollClippingFrame={x:0,y:0,width:0,height:0});o.x=l.x;o.y=l.y;o.width=l.width;o.height=l.height;o.x=m;o.y=n;var p=this.contentIndexesInRect(o);if(!p){return}var j=this.get("length"),k=p.get("max"),q=p.get("min");if(k>j||q<0){p=p.copy();p.remove(j,k-j).remove(q,0-q).freeze()}if(this._lastNowShowing){if(p.contains(this._lastNowShowing)&&this._lastNowShowing.contains(p)){return}}this._lastNowShowing=p;this.reloadIfNeeded(p,YES);this._lastTouchScrollTime=Date.now()},mapToIndex:function(d){var c=d.contentIndex;if(this._indexMap[c]&&this._indexMap[c]!=d){throw"index %@ already mapped".fmt(c)}this._indexMap[c]=d;return d},unmapFromIndex:function(b){this._indexMap[b.contentIndex]=null;return b},mapToItem:function(e){var g=e.content,h=SC.guidFor(g),f=this._viewsForItem[h]||(this._viewsForItem[h]=SC.CoreSet.create());f.add(e);return e},unmapFromItem:function(d){var f=d.content,e=this._viewsForItem[SC.guidFor(f)];if(!e){"no view to unmap"}e.remove(d);return d},pooledViewForItem:function(p){var m=this._viewsForItem,n=this.get("content").objectAt(p),q=m[SC.guidFor(n)],j,l;if(q){var o,k=q.length;for(o=0;o<k;o++){j=q[o];l=j.contentIndex;if(l>p||!this._shouldBeShowing.contains(l)||j._SCCFP_dirty||SC.none(j.contentIndex)){return j}}}return null},contentIndexForLayerId:function(c){var d=SC.View.views[c];if(d&&d.displayDelegate===this&&!SC.none(d.contentIndex)){return d.contentIndex}else{return null}},_tempAttrs:{},attributesForIndex:function(n){var h=this.get("contentDelegate"),l=this.get("content"),m=l.objectAt(n),k=this.contentIndexIsGroup(n),j=this.exampleViewForIndex(n),o=this._tempAttrs;o.createdFromExampleView=j;o.parentView=this.get("containerView")||this;o.contentIndex=n;o.owner=o.displayDelegate=this;o.content=m;o.page=this.page;o.isEnabled=h.contentIndexIsEnabled(this,l,n);o.isSelected=h.contentIndexIsSelected(this,l,n);o.outlineLevel=h.contentIndexOutlineLevel(this,l,n);o.disclosureState=h.contentIndexDisclosureState(this,l,n);o.isGroupView=k;o.isVisible=YES;return o},configureItemView:function(j,f,h){var g=SC.guidFor(f?f.content:j.get("content")),k=this._oldLayouts[g];j.beginPropertyChanges();if(f){j.setIfChanged(f)}this.adjustItemView(j,h,k);this._oldLayouts[g]=h;j.endPropertyChanges();return j},adjustItemView:function(e,f,d){if(f){e.adjust(f)}this.finishAdjust(e)},finishAdjust:function(b){if(b._willBePooled){this._sendToOffscreenDOMPool(b);b._willBePooled=NO}return b},updateView:function(j,h,m){var k=j.contentIndex,o=h?h.contentIndex:k,l=this.exampleViewForIndex(o),n;if(!h){h=this.attributesForIndex(o)}if(!m){m=this.layoutForContentIndex(o)}this.unpool(j);if(l!==j.createdFromExampleView){this.sendToOffscreenDOMPool(j);this.unmapFromItem(j);return null}if(this.get("preserveDOMOrder")&&k!==o){this._insertChildViewAtIndex(j)}this.unmapFromItem(j);if(!SC.none(k)){this.unmapFromIndex(j);this._curShowing.remove(k);this._hasNoContent.remove(k);this.updateHasContentForShowing()}n=j._SCCFP_dirty||h.content!==j.get("content")||h.isSelected!==j.get("isSelected");this._pendingPool.remove(j);j._willBePooled=NO;this.configureItemView(j,h,m);if(n||j._SCCFP_dirty){j.invokeLast(j.updateLayer)}this.mapToIndex(j);this.mapToItem(j);this.validate(o);return j},renderItem:function(g,e,h){if(h){e.layout=h}var f=g.create(e);delete e.layout;this.configureItemView(f,e,h);this._justCreated.add(f);this.invokeOnce(this._appendJustCreated);return f},_appendJustCreated:function(){var b;while(b=this._justCreated.pop()){if(this.get("preserveDOMOrder")){this._insertChildViewAtIndex(b)}else{this.appendChild(b)}}},_insertChildViewAtIndex:function(f){var k=f.get("contentIndex"),j=this._indexMap,h,g=j.length;if(!SC.none(k)){for(k++;k<g;k++){h=j[k];if(h){this.insertBefore(f,h);return}}}this.appendChild(f)},renderNewView:function(h){var f,e=this.attributesForIndex(h),g=this.layoutForContentIndex(h);if(f=this._indexMap[h]){if(f.get("content")!==e.content){this.unpool(f);this.sendToOffscreenDOMPool(f);f=null}else{f=this.updateView(f,e,g)}}if(!f){f=this.renderItem(this.exampleViewForIndex(h),e,g)}this.mapToItem(f);this.mapToIndex(f);return f},unpool:function(d){var c=this.DOMPoolForExampleView(d.createdFromExampleView);if(d===c._lastRendered){c._lastRendered=(d._SCCFP_prev===d?null:d._SCCFP_prev)}c.remove(d);return d},updateHasContentForShowing:function(){this.invokeOnce(this._updateHasContentForShowing)},_updateHasContentForShowing:function(){this.setIfChanged("hasContentForShowing",!this._hasNoContent.length)},renderForeground:function(f){var d;if(this.willReload){this.willReload(d=SC.IndexSet.create(f))}var e=this.renderFromPool(f);this.validate(f);this._curShowing.add(f);if(e.get("content")){this._hasNoContent.remove(f)}else{this._hasNoContent.add(f)}this.updateHasContentForShowing();if(this.didReload){this.didReload(d||SC.IndexSet.create(f))}return e},renderBackground:function(k){var f,h=this.exampleViewForIndex(k),j=this.DOMPoolForExampleView(h),g;if(this.willReload){this.willReload(f=SC.IndexSet.create(k))}if(j.length<this.DOMPoolSize){g=this.renderNewView(k)}else{g=this.renderFromPool(k)}this.sendToDOMPool(g,YES);this.validate(k);if(this.didReload){this.didReload(f||SC.IndexSet.create(k))}return g},itemViewForContentIndex:function(d){var c=this.get("content");if(c&&d>=0&&d<c.get("length")){return this.renderForeground(d)}},getNextNowShowing:function(){var k=this._curShowing,l=this._shouldBeShowing,n,j=l.length,o,m=this._indexMap,h;for(n=0;n<j;n++){o=l[n];h=m[o];if(!k.contains(o)||!h||h._SCCFP_dirty){return o}}},renderNextNowShowing:function(){var b=this.getNextNowShowing();if(b!==undefined){return this.renderForeground(b)}},invalidate:function(c){var d=this._indexMap[c];if(d){d._SCCFP_dirty=YES}},validate:function(c){var d=this._indexMap[c];if(d){d._SCCFP_dirty=NO}},_topBackground:0,_bottomBackground:0,_parity:YES,getNextBackground:function(){var o=this.get("content"),k=o.get("length"),n=this._indexMap,l,m=this._topBackground,t=this._bottomBackground,q=this._parity,s=this.DOMPoolSize,p;while((m-t<s-1)&&(m<k-1||t>0)){q=!q;if(q&&m<k-1){l=n[++m];if(!l||l._SCCFP_dirty){p=m;break}}else{if(t>0){l=n[--t];if(!l||l._SCCFP_dirty){p=t;break}}}}this._topBackground=m;this._bottomBackground=t;this._parity=q;return p},renderNextBackground:function(){var e=this.getNextBackground();if(e===undefined){return}var g=this.exampleViewForIndex(e),h=this.DOMPoolForExampleView(g),f;if(h._lastRendered&&!h.head){throw"New background render cycle started but last rendered view was not cleared"}if(h.length>=this.DOMPoolSize&&h._lastRendered&&(h._lastRendered===h.head._SCCFP_prev)){h._lastRendered=null;return}f=this.renderBackground(e);return f},incrementalRenderQueue:SC.TaskQueue.create({runWhenIdle:YES,runLimit:SC.platform.touch?-1:10,interval:SC.platform.touch?50:1,minimumIdleDuration:-1})};SC.mixin(CW.CollectionFastPath,{backgroundRenderTask:SC.Task.create({_cur:0,rendering:NO,viewsNeedRendering:SC.CoreSet.create(),run:function(e){if(!this.rendering){return}var f=this.viewsNeedRendering,d;if(this._cur>=f.length){this._cur=0}d=f[this._cur];if(d.renderNextBackground()){this._cur++}else{f.remove(d)}if(f.length>0){e.push(this)}else{this.stop()}},add:function(b){this.viewsNeedRendering.add(b)},start:function(){if(!this.rendering&&!CW.CollectionFastPath.incrementalRenderTask.rendering){SC.backgroundTaskQueue.push(this);this.rendering=YES}},stop:function(){this.rendering=NO}}),incrementalRenderTask:SC.Task.create({_cur:0,rendering:NO,viewsNeedRendering:SC.CoreSet.create(),run:function(e){var f=this.viewsNeedRendering,d;if(this._cur>=f.length){this._cur=0}d=f[this._cur];if(d.renderNextNowShowing()){this._cur++}else{f.remove(d)}if(f.length>0){e.push(this)}else{this.rendering=NO;CW.CollectionFastPath.backgroundRenderTask.start()}},add:function(b){this.viewsNeedRendering.add(b);if(!this.rendering){CW.CollectionFastPath.backgroundRenderTask.stop();CW.CollectionFastPath.incrementalRenderQueue.push(this);this.rendering=YES}}}),_DoublyLinkedList:SC.mixin({},{head:null,length:0,create:function(c){var d=SC.beget(this);if(c){d.init(c)}d.enqueue=d.unshift;d.dequeue=d.pop;return d},insertBetween:function(f,d,e){if(!e||!d){throw"invalid insertion"}d._SCCFP_next=f;f._SCCFP_prev=d;e._SCCFP_prev=f;f._SCCFP_next=e;this.length++;return f},remove:function(g){var h=g._SCCFP_prev,e=g._SCCFP_next,f=this.head;if(!(e&&h&&f)){return}e._SCCFP_prev=h;h._SCCFP_next=e;this.length--;if(g===f){if(f._SCCFP_next===f){this.head=null}else{this.head=e}}g._SCCFP_next=null;g._SCCFP_prev=null;return g},init:function(b){this.head=b;b._SCCFP_next=b;b._SCCFP_prev=b;this.length++;return this},push:function(c){var d=this.head;if(d){this.insertBetween(c,d._SCCFP_prev,d)}else{this.init(c)}return this},pop:function(){var b=this.head;if(b){return this.remove(b._SCCFP_prev)}},unshift:function(c){var d=this.head;if(d){this.insertBetween(c,d._SCCFP_prev,d);this.head=c}else{this.init(c)}return this},shift:function(){return this.remove(this.head)},tail:function(){var b=this.head;if(b){return b._SCCFP_prev}}})});CW.CollectionItem={nextKeyView:function(){var f=this.get("contentIndex"),g=this.get("displayDelegate"),e,h=g.get("length")-1;while(f++<h&&!(e=g.itemViewForContentIndex(f))){}return e||null}.property(),previousKeyView:function(){var e=this.get("contentIndex"),f=this.get("displayDelegate"),d;while(e-->0&&!(d=f.itemViewForContentIndex(e))){}return d||null}.property(),requestUpdate:function(){this.displayDelegate.wantsUpdate(this)},isPoolable:YES};CW.ScrollProxy={isScrollProxy:YES,_CSP_scrollView:null,proxyScrollView:function(b){this._CSP_scrollView=b;return this},scrollTo:function(e,f){var d=this._CSP_scrollView;if(d){d.scrollTo(e,f)}return this}};sc_require("views/collection/scroll_proxy");CW.CollectionViewProxy=SC.mixin(SC.clone(CW.ScrollProxy),{isCollectionViewProxy:YES,_CCVSP_collectionView:null,proxyCollectionView:function(d){var c=d;this._CCVSP_collectionView=d;this.set("nowShowingBinding",d.bind("nowShowing",this,"nowShowing"));while(c&&!c.get("isScrollable")){c=c.get("parentView")}if(c){this.proxyScrollView(c)}else{throw"collectionView is not inside a scrollView"}return this},scrollToContentIndex:function(c){var d=this._CCVSP_collectionView;if(d){this._CCVSP_collectionView.scrollToContentIndex(c)}return this},scrollToContentItem:function(g){var f=this._CCVSP_collectionView,h,e;if(!f||!g){return this}h=f.get("content");if(!h){return this}e=h.indexOf(g);if(e>=0){this.scrollToContentIndex(e)}return this},nowShowing:null});sc_require("panes/alert");CW.DetailsDisclosureView=SC.View.extend(CW.Alert.ExtraViewAutoResizingSupport,{layout:{left:111,right:25},contentView:SC.TextFieldView.design({layout:{height:90},isVisible:NO}),caption:null,isExpanded:NO,disclosureTitle:"Details",verticalPadding:7,classNames:["cw-details"],childViews:["contentView","disclosureButtonView"],disclosureButtonView:SC.DisclosureView.design({valueBinding:"*owner.isExpanded",titleBinding:"*owner.disclosureTitle",layout:{height:15}}),init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("contentView");if(b){b.set("isVisible",this.get("isExpanded"))}},_isExpandedDidChange:function(){var j=this.get("isExpanded"),m=this.get("captionView"),g=m?m.getPath("frame.height"):undefined,k=this.get("contentView"),l=k.getPath("frame.height")+this.get("verticalPadding"),h=this.getPath("frame.height");if(j){k.set("isVisible",YES);if(m){m.adjust("top",g+l)}this.adjust("height",h+l)}else{k.set("isVisible",NO);if(m){m.adjust("top",g-l)}this.adjust("height",h-l)}}.observes("isExpanded"),createChildViews:function(){var b=this.get("caption");if(b){this.captionView=CW.DetailsDisclosureView.CaptionView.extend({value:b});this.childViews.push("captionView")}return arguments.callee.base.apply(this,arguments)},computeHeight:function(){var n=this.get("disclosureButtonView"),m=this.get("contentView"),s=this.get("captionView"),t=this.get("isExpanded"),q=this.get("verticalPadding"),k=n.getPath("frame.height")+q,l,o;m.adjust("top",k);if(t){k+=m.getPath("frame.height")+q+9}else{k+=6}if(s){var p=s.get("value");s.adjust("top",k);o=s.get("layer");o.style.maxWidth=s.getPath("frame.width")+"px";l=SC.metricsForString(p,o,"",NO).height;s.adjust("height",l);k+=l}this.adjust("height",k);return k}});CW.DetailsDisclosureView.CaptionView=SC.LabelView.design({escapeHTML:NO,classNames:["cw-caption"],layout:{top:0,left:0,right:0,height:0}});CW.ImageMapView=SC.View.extend({classNames:["me-image-map-view"],regions:[],regionCoordinatesKey:"coordinates",regionTargetKey:"target",regionActionKey:"action",hoveredRegion:null,selectedRegion:null,mouseDown:function(e){var d,f;d=this.convertFrameFromView({x:e.pageX,y:e.pageY});f=this.regionForPoint(d);if(f){this._mouseDownRegion=f;return YES}return NO},touchStart:function(b){return this.mouseDown(b)},mouseUp:function(g){var k,h,j,f;k=this.convertFrameFromView({x:g.pageX,y:g.pageY});h=this.regionForPoint(k);if(h){f=SC.get(h,"regionActionKey");j=SC.get(h,"regionTargetKey")||null;if(j){this.getPath("pane.rootResponder").sendAction(f,j,this,this.get("pane"),{region:h,coords:k})}this.setIfChanged("selectedRegion",h);return YES}return NO},touchEnd:function(b){this.set("hoveredRegion",null);return this.mouseUp(b)},mouseMoved:function(c){var d=this.convertFrameFromView({x:c.pageX,y:c.pageY});this.setIfChanged("hoveredRegion",this.regionForPoint(d))},touchesDragged:function(b){this.mouseMoved(b)},mouseExited:function(b){this.set("hoveredRegion",null)},regionForPoint:function(m){var j=this.get("regions"),g=0,h=j.get("length"),k,l=this.get("regionCoordinatesKey");this._coordinatesCache=this._coordinatesCache||[];for(;g<h;g++){k=(j[g].get?j[g].get(l):j[g][l]);if(SC.typeOf(k)===SC.T_STRING){if(this._coordinatesCache[g]){k=this._coordinatesCache[g]}else{k=this._coordinatesCache[g]=this._coordinateObjectForString(k)}}if(this._pointInPoly(m,k)){return j[g]}}return null},_pointInPoly:function(q,m){var o=m.length,j=q.x,l=q.y,k,p=o-1,n=NO;for(k=0;k<o;k++){if(m[k][1]<l&&m[p][1]>=l||m[p][1]<l&&m[k][1]>=l){if(m[k][0]+(l-m[k][1])/(m[p][1]-m[k][1])*(m[p][0]-m[k][0])<j){n=!n}}p=k}return n},_coordinateObjectForString:function(m){var l=m.split(","),g=0,h=l.length,j=[];if(h%2!==0){var k=SC.Error.desc("SC.ImageMapView: Unable to parse coordinates string because there were an odd number of values.");console.error(k.toString());throw k}for(;g<h;g+=2){j.push([parseInt(l[g],10),parseInt(l[g+1],10)])}return j}});sc_require("views/scroller");CW.MiniScrollerView=CW.ScrollerView.extend({classNames:"me-mini-scroller-view",hasButtons:NO,buttonLength:5,buttonOverlap:2,capLength:5,capOverlap:2,scrollbarThickness:8});sc_require("views/mini_scroller");CW.InsetMiniScrollerView=CW.MiniScrollerView.extend({classNames:["inset"],scrollbarThickness:(CW.MiniScrollerView.prototype.scrollbarThickness-1),capLength:(CW.MiniScrollerView.prototype.capLength-1),buttonLength:(CW.MiniScrollerView.prototype.buttonLength-1)});sc_require("views/scroller");CW.InsetScrollerView=CW.ScrollerView.extend({classNames:["inset"],scrollbarThickness:(CW.ScrollerView.prototype.scrollbarThickness-1),capLength:(CW.ScrollerView.prototype.capLength-1),buttonLength:(CW.ScrollerView.prototype.buttonLength-1)});CW.LoadingView=SC.View.extend({classNames:"",layout:null,icon:"",text:"",adjustParent:NO,render:function(d,e,f){d(e,f);e.push('<table border="0" width="100%" height="100%" valign="center">',"<tr>",'<td align="center">','<span class="spinner-box" style="text-align: middle">','<span style="vertical-align: middle; display: inline-block; float: none;" class="%@ spinner message"/>'.fmt(this.get("icon")),'<span style="vertical-align: middle;" class="me-loading-app text">',this.get("text"),"</span>","</span>","</td>","</tr>","</table>")}.enhance()});CW.LoadingView.show=function(l,h,j,k,m){var g=this.create({layout:{width:l,height:h},classNames:[k||"content-loading-view"],text:j||"Status.Loading".loc(),icon:m||"spinner-32px-f3f5f5"});return g};CW.ProgressVectorView=SC.ProgressView.extend({classNames:"me-progress-vector-view",render:function(g,j){var l=this.get("displayValue"),h=this.get("isIndeterminate"),m=this.get("isEnabled");if(this._lastTimeWasIndeterminate!==h){j=YES;this._lastTimeWasIndeterminate=h}if(h||l<=0||l>=1){var k={"sc-indeterminate":h,"sc-empty":(l<=0),"sc-complete":(l>=1)};g.setClass(k)}if(!j&&!h){this.updatePercentage(l,YES)}},isIndeterminateDidChange:function(){this.replaceLayer()}.observes("isIndeterminate"),didCreateLayer:function(){switch(this.get("isIndeterminate")){case YES:this.drawIndeterminate();break;case NO:this.drawDeterminate();break}},drawDeterminate:function(){var W=this.get("frame"),ae=Raphael.format,M=W.width,K=W.height,J=2,P=(K-1)/2,aa=P-J,Q=M,h=M-J*2,ac=P*2+1,L=Raphael(this.$()[0],M+2,ac+2),S=L.set(),O=L.set(),H="M0 "+(aa+J),G="M"+J+" "+(aa+J),ab="a{0},{0} 0 0,1 {0},-{0} h{1} a{0},{0} 0 0,1 {0},{0}",N="a{0},{0} 0 0,1 -{0},{0} h-{1} a{0},{0} 0 0,1 -{0},-{0} ",T=ab+"a{0},{0} -180 0,0 -{2} -{2} h -{1} h-1 a{0},{0} 0 0,0 -{0} {2} z",w=G+ae(ab,aa,h-(2*aa)),ad=ae(N,aa,h-(2*aa)),R,I,Y,U,X,V,Z;R=L.path(w+ad+" z").attr({fill:"#000","fill-opacity":"0.2",stroke:"none"});I=R.clone().attr({fill:"90-#949aa7-#d9dee8",stroke:"none","fill-opacity":"1.0"});Y=L.path(G+ae(T,aa,h-(2*aa),aa-1)).attr({fill:"#fff","fill-opacity":".5",stroke:"none"});U=Y.clone().scale(1,-1).translate(0,aa+1).attr({fill:"#000","fill-opacity":"0.3"});S.push(Y,I);O.push(U,R);X=L.path(H+ae(ab,P,Q-(2*P))+ae(N,P,Q-(2*P))+"z");X.attr({stroke:"none",fill:"hsb(0,0,0.1)","fill-opacity":"0.6"}).toBack();V=L.path(H+ae(T,P,Q-2*P,P-1)).attr({fill:"#101724","fill-opacity":"0.4",stroke:"none"});Z=V.clone().scale(1,-1).translate(0,P+1).attr({fill:"#fff","fill-opacity":"0.3"});this.set("paper",L);this.set("progressSet",S);this.set("shadowSet",O);this.set("innerProgressBar",I);this.updatePercentage(this.get("displayValue"),true);if(this.get("isEnabled")){this._animatePulsation()}},drawIndeterminate:function(){var Y,ag,O,M,L,R,ac,S,h,P,N,ae,T,J,H,ad,Q,U,w,af,V,I,aa,W,Z,X,ab,K;Y=this.get("frame");ag=Raphael.format;O=Y.width;M=Y.height;L=2;R=(M-1)/2;ac=R-L;S=O;h=O-L*2;ae=R*2+1;N=Raphael(this.$()[0],O+2,ae+2);T=N.set();J="M0 "+(ac+L);H="M"+L+" "+(ac+L);ad="a{0},{0} 0 0,1 {0},-{0} h{1} a{0},{0} 0 0,1 {0},{0}";Q="a{0},{0} 0 0,1 -{0},{0} h-{1} a{0},{0} 0 0,1 -{0},-{0} ";U=ad+"a{0},{0} -180 0,0 -{2} -{2} h -{1} h-1 a{0},{0} 0 0,0 -{0} {2} z";K=h-(2*ac);w=H+ag(ad,ac,K);af=ag(Q,ac,K);V="../../../../applications/reminders/coreweb/views/zh-cn/1N44/source/resources/images/progress/ind-bg-fill.png";I=N.path(w+af+" z").attr({fill:"url("+V+")",stroke:"none"});aa=N.path(H+ag(U,ac,K,ac-1)).attr({fill:"#fff","fill-opacity":".5",stroke:"none"});W=aa.clone().scale(1,-1).translate(0,ac+1).attr({fill:"#000","fill-opacity":"0.3"});T.push(I,aa,W);Z=N.path(J+ag(ad,R,S-(2*R))+ag(Q,R,S-(2*R))+"z");Z.attr({stroke:"none",fill:"hsb(0,0,0.1)","fill-opacity":"0.6"}).toBack();X=N.path(J+ag(U,R,S-(2*R),R-1)).attr({fill:"#101724","fill-opacity":"0.4",stroke:"none"});ab=X.clone().scale(1,-1).translate(0,R+1).attr({fill:"#fff","fill-opacity":"0.3"});this.set("innerProgressBar",I);if(this.get("isEnabled")){this.animateBg({x:24},400)}},updatePercentage:function(o,h){var k=this.get("frame"),l=k.width,p=k.height,m=l*o,n=this.get("progressSet"),q=this.get("shadowSet");if(!h){n.animate({"clip-rect":[0,0,m,p]},200);q.animateWith(n,{"clip-rect":[0,0,m+1,p]},200)}else{n.attr({"clip-rect":[0,0,m,p]});q.attr({"clip-rect":[0,0,m+1,p]})}},animateBg:function(n,m,k){if(n==="stop"){clearTimeout(this._ticker)}var o=this.get("innerProgressBar"),h=o.pattern||o.node.getElementsByTagName("fill")[0];if(!h){return}if(o._lastOffsetX===undefined){o._lastOffsetX=0}if(o._lastOffsetY===undefined){o._lastOffsetY=0}var j;(function l(){var d=n.x,a=n.y,c,b;if(d||a){b=(o._lastOffsetX+=1)%d;c=(o._lastOffsetY+=1)%d;if(o.paper.raphael.type==="SVG"){if(d){h.setAttribute("x",b)}if(a){h.setAttribute("y",c)}}else{if(h.origin){if(d){h.origin.x=(1-(b/d))}if(a){h.origin.y=(1-(c/a))}}}if(!this._ticker){j=setTimeout(l,m/d)}}})();this._ticker=j},_animatePulsation:function(){var b=this.get("innerProgressBar");if(this._pulseOpacity==1){this._pulseOpacity=0.85}else{this._pulseOpacity=1}b.animate({opacity:this._pulseOpacity},1000,"swing");this.invokeLater(this._animatePulsation,1000)}});CW.SpinnerView=SC.View.extend({layout:{left:0,top:0},frequency:3/2,size:NaN,asset:"../../../../system/steedos/4330/coreweb/views/4330/en-us/source/resources/images/spinner.png",didCreateLayer:function(){if(!(this._layer=this.get("layer"))){return}var d=this._image=new Image(),c=this;d.style.cssText="position:absolute; left:0px; display:none;";d.onload=function(){SC.run(function(){c._imageLoaded=YES;var a=1;if(typeof window.devicePixelRatio!=="undefined"){a=window.devicePixelRatio||1}if(isNaN(c.get("size"))){c.set("size",d.width/a)}else{c._renderSize()}c._startStopSpin();d.style.display=""})};d.src=this.get("asset");this._layer.appendChild(d)},_startStopSpin:function(){var d=this.get("layout");var c=this.get("isVisibleInWindow")&&this._imageLoaded&&(SC.none(d.opacity)||d.opacity>0);c?this._startSpin():this._stopSpin()}.observes("isVisibleInWindow","layout"),_renderSize:function(){var b=this.get("size");if(isNaN(b)){return}this.adjust({width:this._size=b,height:b});this._image.style.width=b+"px";this._image.style.height=b*12+"px";this._renderPosition()}.observes("size"),_startSpin:function(){if(this._interval){return}var b=this;this._interval=setInterval(function(){b._rotateStep()},(1000/this.get("frequency"))/12)},_stopSpin:function(){if(!this._interval){return}clearInterval(this._interval);this._interval=null},_rotateStep:function(){this._pos=(this._pos+1)%12;this._renderPosition()},_renderPosition:function(){this._image.style.top=-(this._size||0)*this._pos+"px"},_pos:0});CW.ViewController=SC.Responder.extend({isViewController:YES,view:null});CW.SectionedViewDataSource={isSectionedViewDataSource:YES,numberOfSectionsInSectionedView:function(b){return 0},sectionedViewSectionIsVisible:function(d,c){return YES},sectionedViewNumberOfRowsInSection:function(d,c){return 0},sectionedViewTitleForHeaderInSection:function(d,c){return undefined},sectionedViewTitleForFooterInSection:function(d,c){return undefined},sectionedViewCellForRowAtIndexPath:function(d,c){return undefined},sectionedViewContentForRowAtIndexPath:function(d,c){return undefined}};CW.SectionedViewDelegate={isSectionedViewDelegate:YES,sectionedViewHeightForRowAtIndexPath:function(d,c){return undefined},sectionedViewAccessoryButtonTappedForRowAtIndexPath:function(d,c){},sectionedViewWillSelectRowAtIndexPath:function(d,c){return c},sectionedViewDidSelectRowAtIndexPath:function(d,c){},sectionedViewWillDeselectRowAtIndexPath:function(d,c){return c},sectionedViewDidDeselectRowAtIndexPath:function(d,c){},sectionedViewViewForHeaderInSection:function(d,c){return undefined},sectionedViewViewForFooterInSection:function(d,c){return undefined},sectionedViewHeightForHeaderInSection:function(d,c){return undefined},sectionedViewHeightForFooterInSection:function(d,c){return undefined},sectionedViewShouldAutoResizeHeaderTitleInSection:function(d,c){return undefined},sectionedViewShouldAutoResizeFooterTitleInSection:function(d,c){return undefined},sectionedViewCellDisplayDelegateForRowAtIndexPath:function(d,c){return d},sectionedViewWillSetupAllCells:function(b){},sectionedViewDidSetupAllCells:function(b){},sectionedViewWillTearDownAllCells:function(b){},sectionedViewDidTearDownAllCells:function(b){}};sc_require("controllers/view_controller");sc_require("sectioned_view/mixins/sectioned_view_data_source");sc_require("sectioned_view/mixins/sectioned_view_delegate");CW.SectionedViewController=CW.ViewController.extend(CW.SectionedViewDataSource,CW.SectionedViewDelegate,{});CW.ProxyDisplay={concatenatedProperties:"proxyDisplayProperties".w(),proxyDisplayProperties:[],displayDelegateKey:"displayDelegate",initMixin:function(){this._cwps_computedDisplayProxyProperties=[];this._cwps_computedProxyPropertyToPropertyMap={};this._cwps_contentKeys=[];this._cwps_contentKeyToComputedProxyPropertyMap={};this._cwps_computedProxyPropertyToContentKeyMap={};var b=this.get("proxyDisplayProperties");this._cwps_addContentKeyComputedDisplayProxyPropertyMapping(b);this._cwps_addComputedDisplayProxyProperties(b);this._cwps_setupContentPropertiesObserving();this._cwps_propertiesDidChange(this,"*")},destroyMixin:function(){this._cwps_tearDownContentPropertiesObserving()},computedDisplayProxyPropertyKey:function(b){return"display%@".fmt(b.classify())},_cwps_computedContentKey:function(f){var h="content%@Key".fmt(f.classify()),k=this.get(h);if(SC.none(k)){var j=this.get("displayDelegateKey"),g=j?this.get(j):null;k=g?g.get(h):null}return SC.none(k)?f:k},contentPropertyValueForComputedDisplayProxyProperty:function(g){var f=this.get("content"),e=this._cwps_computedProxyPropertyToContentKeyMap;if(!f||!e){return undefined}var h=e[g];return f.get(h)},contentPropertyValueForProxiedProperty:function(f){var e=this.get("content");if(!e){return undefined}var d=this._cwps_computedContentKey(f);return e.get(d)},computedDisplayProxyPropertyValue:function(g){var e=this.contentPropertyValueForComputedDisplayProxyProperty(g),h=this._cwps_computedProxyPropertyToPropertyMap;if(!SC.none(e)){return e}if(!h){return undefined}var f=h[g];return this.get(f)},addProxyDisplayProperty:function(b){this.addProxyDisplayProperties([b])},addProxyDisplayProperties:function(d){this._cwps_addContentKeyComputedDisplayProxyPropertyMapping(d);this._cwps_addComputedDisplayProxyProperties(d);var c=this.get("proxyDisplayProperties");this.set("proxyDisplayProperties",c.concat(d));d.forEach(function(a){this._cwps_propertiesDidChange(this,a)},this)},_cwps_addComputedDisplayProxyProperties:function(h){var f=this._cwps_computedDisplayProxyProperties,e=this._cwps_computedProxyPropertyToPropertyMap;h.forEach(function(a){if(a==="content"){throw"Can not proxy the content property"}var c=this.computedDisplayProxyPropertyKey(a),b=this[c];if(b===undefined){this[c]=null;f.push(c);e[c]=a}else{if(SC.typeOf(b)===SC.T_FUNCTION&&b.isProperty){f.push(c)}else{throw"'%@' is already defined. Can not proxy property '%@'".fmt(c,a)}}},this);var g=this.get("displayProperties");g=g.concat(f);this.set("displayProperties",g)},_cwps_addContentKeyComputedDisplayProxyPropertyMapping:function(e){var f=this._cwps_contentKeys,g=this._cwps_contentKeyToComputedProxyPropertyMap,h=this._cwps_computedProxyPropertyToContentKeyMap;e.forEach(function(a){var b=this._cwps_computedContentKey(a),c=this.computedDisplayProxyPropertyKey(a);f.push(b);g[b]=c;h[c]=b},this)},_cwps_contentDidChange:function(){this._cwps_tearDownContentPropertiesObserving();this._cwps_setupContentPropertiesObserving();this._cwps_contentPropertiesDidChange(this,"*")}.observes("content"),_cwps_setupContentPropertiesObserving:function(){var b=this.get("content");this._cwps_content=b;if(!b){return}b.addObserver("*",this,"_cwps_contentPropertiesDidChange")},_cwps_tearDownContentPropertiesObserving:function(){var b=this._cwps_content;this._cwps_content=null;if(!b){return}b.removeObserver("*",this,"_cwps_contentPropertiesDidChange")},_cwps_propertiesDidChange:function(h,e){var f=this.get("proxyDisplayProperties")||[],g=null;if(e==="*"){g=f}else{if(f.indexOf(e)>=0){g=[e]}}if(!g){return}this.beginPropertyChanges();g.forEach(function(b){var a=this.computedDisplayProxyPropertyKey(b);this._cwps_notifyComputedDisplayProxyPropertyChanged(a)},this);this.endPropertyChanges();this.displayDidChange()}.observes("*"),_cwps_contentPropertiesDidChange:function(k,f){var h=this.get("content"),g=this._cwps_contentKeys||[],j=null;if(f==="*"){j=g}else{if(g.indexOf(f)>=0){j=[f]}}if(!j){return}this.beginPropertyChanges();j.forEach(function(b){var a=this._cwps_contentKeyToComputedProxyPropertyMap[b];this._cwps_notifyComputedDisplayProxyPropertyChanged(a)},this);this.endPropertyChanges();this.displayDidChange()},_cwps_notifyComputedDisplayProxyPropertyChanged:function(e){var f=this.get(e);if(SC.typeOf(f)===SC.T_FUNCTION&&f.isProperty){this.notifyPropertyChange(e)}else{var d=this.computedDisplayProxyPropertyValue(e);this.set(e,d!==undefined?d:null)}}};CW.BAR_OPACITY_DURATION=200;CW.BAR_LEFT_DURATION=350;CW.VIEW_LEFT_DURATION=350;CW.NAVIGATABLE_VIEW_PADDING=0;CW.NavigationController=SC.ObjectController.extend({layout:{top:0,left:0,right:0,bottom:0},viewStack:null,barStack:null,navigationView:null,previousNavigatableView:function(){var b=this.get("viewStack");return b[b.length-2]||null},currentNavigatableView:function(){var b=this.get("viewStack");return b[b.length-1]||null},init:function(){this.viewStack=[];this.barStack=[];this.navigationViewDidChange()},clearStacks:function(){this.get("viewStack").forEach(function(a){a.removeFromParent();a.destroy()});this.get("barStack").forEach(function(a){a.removeFromParent();a.destroy()});this.viewStack=[];this.barStack=[]},navigationViewDidChange:function(){this.clearStacks();var d=this.get("navigationView"),c=this.get("_oldNavigationView");if(d!==c){if(c){c.removeObserver("frame",this,this.navigationViewFrameDidChange)}if(d){d.addObserver("frame",this,this.navigationViewFrameDidChange);this.set("_oldNavigationView",d)}}}.observes("navigationView"),navigationViewFrameDidChange:function(){var k,h=this.getPath("navigationView.frame.width"),f=this.viewStack;for(var j=0,g=f.length;j<g;++j){k=f[j];k.adjust("width",h);this.barStack[j].adjust("width",h)}},push:function(t,s,n){if(s===undefined){s=YES}if(SC.browser.isAndroid){s=NO}if(!t.isNavigatable){SC.error("Tried to push a view which doesn't mix-in the CW.NavigationSupport mixin.")}var u=this.get("viewStack"),m=this.get("barStack"),l=-1*this.getPath("navigationView.frame").width,o=u[u.length-1],p=m[m.length-1];this._pushViewAndBarToStack(t,YES);this.getPath("navigationView.pane").makeFirstResponder(t);var q=u[u.length-1],v=m[m.length-1];this._moveBarAndViewTo(q,v,s,0,1,NO);if(o){this._moveBarAndViewTo(o,p,s,l,0,NO,n)}},pop:function(x,o,s){var D=this.getPath("navigationView.pane");if(!D){return}if(x===undefined){x=YES}if(SC.browser.isAndroid){x=NO}if(o===undefined){o=1}var B=this.get("viewStack"),q=this.get("barStack"),u=B.pop(),C=q.pop(),p,y,t,v,z;for(var w=0;w<o-1;w++){p=B.pop();y=q.pop();p.removeFromParent();y.removeFromParent()}t=B[B.length-1];v=q[q.length-1];z=this.get("navigationView").get("frame").width;D.makeFirstResponder(t);if(o>1){t.adjust({left:-1*z});v.adjust({left:-1*z})}this._moveBarAndViewTo(u,C,x,z,0,YES,undefined,YES);if(t){this._moveBarAndViewTo(t,v,x,0,1,NO,s)}},hidePreviousView:function(){var a=this.previousNavigatableView();if(a){this.invokeLast(function(){a.adjust({opacity:0})})}},showCurrentView:function(){var a=this.currentNavigatableView();if(a){a.adjust({opacity:1})}},_moveBarAndViewTo:function(s,v,z,x,y,p,w,F){CW.testController=this;CW.testView=s;var B=this.get("navigationView"),q=1,t=s.get("frame").x;var G=this;if(F){this.showCurrentView()}if(z){s.adjust({left:t,height:B.get("frame").height-v.get("frame").height,bottom:null});v.adjust({left:t,opacity:q});s.set("wantsAcceleratedLayer",YES);v.set("wantsAcceleratedLayer",YES);var u=Math.max(CW.VIEW_LEFT_DURATION,CW.BAR_LEFT_DURATION,CW.BAR_OPACITY_DURATION);var D=B.$();if(D.find(".overlay").size()===0){var E="position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px; z-index: 1000;";E+='background-image: url("%@");'.fmt("");D.append("<div class='overlay' style='%@'></div>".fmt(E))}var C=CW.Animation.create({view:s,bar:v,navigationView:B,tween:CW.Anim.tweens.WEBKIT_EASE_IN_OUT,viewLayer:s.get("layer"),barLayer:v.get("layer"),toLeft:x,fromLeft:t,toOpacity:y,fromOpacity:q,duration:u,name:SC.guidFor(this)+":navigationAnimation:"+SC.guidFor(s),update:function(){var e=this.current;var a=Math.round(this.fromLeft+(this.toLeft-this.fromLeft)*Math.min(1,Math.max(0,e*(this.duration/CW.VIEW_LEFT_DURATION))));var b=Math.round(this.fromLeft+(this.toLeft-this.fromLeft)*Math.min(1,Math.max(0,e*(this.duration/CW.BAR_LEFT_DURATION))));var f=this.fromOpacity+(this.toOpacity-this.fromOpacity)*Math.min(1,Math.max(0,e*(this.duration/CW.BAR_OPACITY_DURATION)));if(!this.viewLayer||!this.barLayer){this.viewLayer=this.view.get("layer");this.barLayer=this.bar.get("layer")}if(this.viewLayer&&this.barLayer){var c=this.viewLayer.style,d=this.barLayer.style;if(SC.platform.supportsCSS3DTransforms){c.width=this.view.get("frame").width;c.webkitTransform="translate3d("+a+"px,0,0)";d.webkitTransform="translate3d("+b+"px,0,0)"}else{c.left=a+"px";d.left=b+"px"}}},cleanUp:function(){if(p){this.view.removeFromParent();this.bar.removeFromParent();this.bar.destroy()}else{this.view.adjust({left:x});this.bar.adjust({left:x,opacity:y})}this.view.adjust({height:null,bottom:0});var a=this.navigationView.$();var b=a.find(".overlay");b.remove();if(w){w()}G.hidePreviousView()}.listens("finish")});setTimeout(function(){C.start()},100)}else{s.adjust({left:x});v.adjust({left:x,opacity:y});G.hidePreviousView();if(p){if(s){s.removeFromParent()}if(v){v.removeFromParent();v.destroy()}}}},_pushViewAndBarToStack:function(m,k){var p=this.get("navigationView"),q=p.createChildView(CW.NavigationBarView),n=p.get("frame").width,o=p.get("frame").height,j=(((k)?1:-1)*n)+CW.NAVIGATABLE_VIEW_PADDING,l=p.get("navigationBarHeight");m.set("navigationController",this);m.set("layout",{top:0,bottom:0,left:j,width:n});q.set("layout",{top:0,left:j/2,width:n,height:l});q.set("navigationController",this);q.set("associatedView",m);p.appendChild(q);p.get("well").appendChild(m);this.get("viewStack").push(m);this.get("barStack").push(q)}});CW.iOScallout=SC.PickerPane.extend(CW.Animatability,CW.PaneFadingSupport,{renderDelegateName:"iOSCalloutRenderDelegate",themeName:"iOS",preferMatrix:[2,2,2,2,2],layout:{height:43,width:215,minWidth:150},classNames:["iOSCallout"],titleValue:"Callout title",detailValue:"Callout detail",escapeTitle:YES,escapeDetail:YES,target:"",action:"",preferType:SC.PICKER_POINTER,acceptsKeyPane:NO,isInfoButtonRequired:YES,acceptsFirstResponder:NO,isModal:NO,repositionOnWindowResize:NO,pointerOffset:[0,0,0,0],contentView:SC.View.extend({childViews:["title","detail","button"],title:SC.LabelView.extend({layout:{top:0,height:25,left:9,right:35},classNames:"title",escapeHTMLBinding:"*parentView.parentView.escapeTitle",valueBinding:"*parentView.parentView.titleValue"}),detail:SC.LabelView.extend({layout:{top:24,left:9,height:15},classNames:"detail",escapeHTMLBinding:"*parentView.parentView.escapeDetail",valueBinding:"*parentView.parentView.detailValue"}),button:SC.ImageButtonView.extend({layout:{top:7,height:30,right:5,width:30},image:"info_button",isVisibleBinding:"*parentView.parentView.isInfoButtonRequired",targetBinding:"*parentView.parentView.target",actionBinding:"*parentView.parentView.action"})}),didCreateLayer:function(){this.invokeLater(this.recomputeLayout,0)},recomputeLayout:function(){var l=this.$(".title")[0],g=this.$(".detail")[0],h=55;if(!this.get("isInfoButtonRequired")){h=20;this.getPath("contentView.title").adjust({right:9})}if(SC.none(l)||SC.none(g)){return}var j=SC.metricsForString(this.get("titleValue"),l,null,NO),m=SC.metricsForString(this.get("detailValue"),g,null,NO),k=(j.width>m.width?j.width:m.width)+h;k=(k%2?k-1:k);k=Math.max(k,150);this.adjust({width:k});this.positionPane()},showCalloutInContainer:function(b){this._hideOverflow();this.appendTo(b)},valuesObserver:function(){this.recomputeLayout()}.observes("detailValue","titleValue","layer"),modalPaneDidClick:function(){return NO}});CW.NOTIFICATION_AUTOMATICALLY_DISMISS_DELAY=4000;CW.iOSNotification=SC.PanelPane.extend(CW.SpritePreloadEnforcement,CW.Animatability,CW.PaneAnimationSupport).extend({acceptsKeyPane:NO,isIOSNotification:YES,hasBeenSeen:NO,isDismissable:YES,automaticallyDismiss:YES,icon:undefined,iconWidth:35,iconHeight:35,iconInset:9,message:undefined,description:undefined,shouldAdornEndingDescriptionLinkWithArrow:YES,dismiss:function(){this.remove();this.didDismiss(this)},didDismiss:function(){},action:function(){},hiddenState:function(){return{top:-this.get("frame").height-31}}.property(),showingState:{top:1},MAX_WIDTH:1093,MIN_WIDTH:500,MIN_HEIGHT:48,maxWidth:Infinity,minimumSideClearance:100,layout:{right:5},isModal:NO,classNames:"ios-notification".w(),windowResized:function(){var h=this.get("currentWindowSize"),f,e;if(!h||!h.width){return}try{f=SteedOS.MIN_WIDTH}catch(g){f=950}e=Math.max(f,h.width);this.set("maxWidth",Math.max(this.MIN_WIDTH,Math.min(e-this.get("minimumSideClearance")*2,this.MAX_WIDTH)))}.observes("currentWindowSize","minimumSideClearance"),_hideMask:function(){CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._mask,to:0,duration:100}).start()},_showMask:function(){CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._mask,to:0.4,duration:100}).start()},mouseDown:function(b){if(!this._mask){return NO}this._isClicked=YES;this._showMask();return YES},mouseUp:function(e){if(!this._mask){return}this._isClicked=NO;this._hideMask();var f=this.get("frame"),d=this.convertFrameFromView({x:e.pageX,y:e.pageY});if(!f||d.x<0||d.y<0||d.x>f.width||d.y>f.height){return}if(this._icon){this._spinner.src="";CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._icon,to:0,duration:200}).start();CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._spinner,to:1,duration:200}).start()}this.get("action")(this)},mouseEntered:function(b){if(!this._isClicked){return}this._showMask();return YES},mouseExited:function(b){if(!this._isClicked){return}this._hideMask();return YES},render:function(f){window.iosnotification=this;for(var g=0,h="";g<9;g++){h+='<div class="'+SC.NINE_SLICE[g]+'"></div>'}f.push('<div class="shadow" aria-hidden=true>'+h+"</div>");f.push('<div class="background" aria-hidden=true>'+h+"</div>");var j=this.get("message"),k=this._adornStringWithArrowIfNeeded(this._lastDesc=this.get("description"));this._lastMess=j;f.push('<img class="spinner">');f.push('<div class="message">'+j+"</div>");f.push('<div class="description">'+k+"</div>");if(this.get("action")){f.push('<div class="mask" aria-hidden=true>'+h+"</div>")}this.adjust("zIndex",this.get("isDismissable")?CW.iOSNotification.runningDismissableZIndex++:CW.iOSNotification.runningNonDismissableZIndex++)},displayProperties:"message description icon maxWidth".w(),update:function(){var f,d,e;if(this._lastMess!==(this._lastMess=f=this.get("message"))){this.$(".message")[0].innerHTML=f}if(this._lastDesc!==(this._lastDesc=d=this.get("description"))){this.$(".description")[0].innerHTML=this._adornStringWithArrowIfNeeded(d);e=YES}if(this.didChangeFor("update","maxWidth")){e=YES}if(e){this.invokeLast("finishLayerDependentRendering")}},didCreateLayer:function(){this._mask=this.$(".mask")[0];this._spinner=this.$(".spinner")[0];if(this._mask){CW.Anim.setOpacity(this._mask,0)}if(this._spinner){CW.Anim.setOpacity(this._spinner,0)}this.$(".description")[0].cacheableForMetrics=YES;this.windowResized();if(this.get("automaticallyDismiss")){this.invokeLater(function(){if(this.get("automaticallyDismiss")){this.dismiss()}},CW.NOTIFICATION_AUTOMATICALLY_DISMISS_DELAY)}},finishLayerDependentRendering:function(){var m=this.get("frame"),n=this.get("layer"),l,q=this.get("icon"),t,s,f,p;if(this._lastIconInput!==(this._lastIconInput=q)){if((l=this._icon)&&l.parentNode){l.parentNode.removeChild(l)}this._icon=null}if(!(l=this._icon)){if(typeof q==="string"&&q.indexOf("/")!==-1){l=new Image();this._icon=l;l.src=q;var o="z-index:3; position:absolute; left:"+this.get("iconInset")+"px; width:"+this.get("iconWidth")+"px; height:"+(f=this.get("iconHeight"))+"px; margin-top:-"+Math.floor(f/2)+"px; top:50%;";l.style.cssText=o;l.setAttribute("aria-hidden",true);n.appendChild(l)}else{if(q){if(typeof q==="string"){l=document.createElement("div");l.className=q;this._icon=l}t=(this._icon||(this._icon=l=q)).style;t.position="absolute";t.left=this.get("iconInset")+"px";t.top="50%";t.zIndex="3";l.setAttribute("aria-hidden",true);n.appendChild(l);this.invokeOnce(function(){var a,b;this.set("iconWidth",a=parseInt(jQuery(l).css("width"),0)||this.get("iconWidth"));this.set("iconHeight",b=parseInt(jQuery(l).css("height"),0)||this.get("iconHeight"));t.marginTop=-Math.ceil(b/2)+"px"})}else{if(this.get("iconWidth")){this.set("iconWidth",s=0)}if(this.get("iconHeight")){this.set("iconHeight",f=0)}if((p=this._separator)){if(p.parentNode){p.parentNode.removeChild(p)}this._separator=undefined}}}}this.invokeOnce(function(){if(this._icon&&!(p=this._separator)){p=document.createElement("div");p.style.cssText="position:absolute; left:"+(this.get("iconInset")*2+this.get("iconWidth"))+"px; top:0px; width:1px; bottom:0px; z-index:4; background:black;";this._separator=p;CW.Anim.setOpacity(p,0.12);p.setAttribute("aria-hidden",true);n.appendChild(p)}});this.invokeOnce("sizeToText")},sizeToText:function(){var y,w=29,n,p,v=19,u=0,z=0,s=0,x=0,q=0,t=6;y=2+((!!this.get("icon"))*2+1)*this.get("iconInset")+this.get("iconWidth");if((n=this._message||(this._message=this.$(".message")[0]))){n.style.left=y+"px";u=SC.bestStringMetricsForMaxWidth(n.innerHTML,this.get("maxWidth")-y-w,n,undefined,true);z=u.height;n.style.height=z+"px";u=u.width}if((p=this._description||(this._description=this.$(".description")[0]))){p.style.left=y+"px";s=SC.bestStringMetricsForMaxWidth(p.innerHTML,this.get("maxWidth")-y-w,p,undefined,true);x=s.height;s=s.width;q=(z||-1)+8+2*!!SC.browser.mozilla;p.style.top=q+"px";p.style.height=x+"px"}var o=Math.max(this.MIN_HEIGHT,t+q+x);if(this.get("iconHeight")){o=Math.round(o/2)*2+(this.get("iconHeight")%2!==0)}this.adjust({width:Math.max(this.MIN_WIDTH,y+w+s,y+w+u),height:o})},animateShow:function(){var c=CW.PaneAnimationSupport.animateShow,d=arguments;this.invokeLast(function(){c.apply(this,d)})},contentView:SC.ImageButtonView.design({classNames:"dismiss".w(),init:function(){this.set("toolTip","Button.Close".loc());arguments.callee.base.apply(this,arguments)},layout:{width:16,height:16,right:6,centerY:0},action:"dismiss"}),append:function(){this.set("hasBeenSeen",YES);this._isAppended=YES;return this.appendTo(this.get("parentElement")||CW.iOSNotification.defaultParentElement||document.body)},remove:function(){var b=arguments.callee.base.apply(this,arguments);this._isAppended=NO;CW.iOSNotification.notificationWasRemoved(this);return b},replaceWith:function(b){CW.iOSNotification.replaceNotificationWithNotification(this,b)},init:function(){if(!this.get("isDismissable")){this.contentView=null}if(CW.isMobile()){this.set("MIN_WIDTH",300);this.set("MAX_WIDTH",320);this.adjust({width:320,centerX:0})}arguments.callee.base.apply(this,arguments)},_adornStringWithArrowIfNeeded:function(b){if(!this.get("shouldAdornEndingDescriptionLinkWithArrow")){return b}if(!b){return""}if(b.substring(b.length-4)==="</a>"){b=b.substring(0,b.length-4)+'<div class="ios-notification-link-arrow"></div></a>'}if(b.substring(b.length-5)==="</a>."){b=b.substring(0,b.length-5)+'.<div class="ios-notification-link-arrow"></div></a>'}return b}});SC.mixin(CW.iOSNotification,{runningDismissableZIndex:2000,runningNonDismissableZIndex:1000,show:SC.RunLoop.wrapFunction(function(c){var d=c.isIOSNotification?c:this._simpleCreate.apply(this,arguments);d.append();return d}),queue:[],enqueue:function(c){var d=c.isIOSNotification?c:this._simpleCreate.apply(this,arguments);d._isInQueue=YES;this.queue.unshift(d);this.updateToQueue();return d},updateToQueue:SC.RunLoop.wrapFunction(function(){var d=this.queue;if(!d.length){return}var c=d[d.length-1];if(!c._isAppended){c.append()}}),notificationWasRemoved:function(f){if(this._ignoreRemovals){return}for(var d=0,e=this.queue;this.queue[d];d++){if(e[d]===f){e.splice(d,1)}}this.updateToQueue()},replaceNotificationWithNotification:function(f,k){for(var j=0,g=this.queue,h;h=g[j];j++){if(h===f){g[j]=k;if(j===g.length-1){this._ignoreRemovals=YES;f.remove();this._ignoreRemovals=NO;k.append()}break}}},_simpleCreate:function(j,k,l,m,h){var g;if(typeof j==="object"){(g=this.create.apply(this,arguments))}else{(g=this.create({message:j,description:k,icon:l,isDismissable:!(m===NO),parentElement:h}))}return g}});CW.TOP_SLICES=["middle","top-left","top one","top two","top-right"];CW.BOTTOM_SLICES=["bottom-left","bottom one","bottom two","bottom-right"];SC.BaseTheme.iOSPickerRenderDelegate=SC.RenderDelegate.create({className:"ios_picker",render:function(l,q){var m=l.get("pointerPos"),o=l.get("pointerPosY"),k=l.get("ariaLabel"),n=l._view.get("layout"),j,p;q=q.begin("div").addClass("panel-background");this.includeSlices(l,q,CW.TOP_SLICES);j=o+8;p=n.height-o-36;if(m==="perfectLeft"){q.push('<div class="left one"></div>');q.push('<div class="left two"></div>');q.push('<div class="right one" style="margin-top: '+j+'px"></div>');q.push('<div class="right two" style="display: block; margin-bottom: '+p+'px"></div>')}else{if(m==="perfectRight"){q.push('<div class="left one" style="margin-top: '+j+'px"></div>');q.push('<div class="left two" style="display: block; margin-bottom: '+p+'px"></div>');q.push('<div class="right one"></div>');q.push('<div class="right two"></div>')}else{q.push('<div class="left one"></div>');q.push('<div class="left two"></div>');q.push('<div class="right one"></div>');q.push('<div class="right two"></div>')}}this.includeSlices(l,q,CW.BOTTOM_SLICES);q.addClass(m);if(m==="perfectLeft"||m==="perfectRight"){q.push('<div class="sc-pointer" style="margin-top: '+o+'px"></div>')}else{q.push('<div class="sc-pointer"></div>')}q=q.end();if(m==="perfectLeft"||m==="perfectRight"){q.addStyle("-webkit-transform-origin-y",(o+"px"))}q.addClass(m);q.attr("aria-label",k||"")},update:function(z,w){var o=z.get("preferType"),v=z.get("pointerPos"),p=z.get("pointerPosY"),s=z._view.get("layout"),t,n,q,u,x,y=w.find(".panel-background").first();if(y){y.attr("class","panel-background "+v)}y=w.find(".sc-pointer").first();if(y){if(v==="perfectLeft"||v==="perfectRight"){y.attr("style","margin-top: "+p+"px");if(v==="perfectLeft"){q=".right"}else{q=".left"}t=w.find(".one"+q).first();n=w.find(".two"+q).first();u=p+8;x=s.height-p-36;if(u<0){u=0}if(x<0){x=0}t.attr("style","margin-top: "+u+"px");n.attr("style","display: block; margin-bottom: "+x+"px");if(v==="perfectLeft"){q=".left"}else{q=".right"}t=w.find(".one"+q).first();n=w.find(".two"+q).first();t.attr("style","");n.attr("style","")}else{y.attr("style","");t=w.find(".one");n=w.find(".two");t.attr("style","");n.attr("style","")}}}});sc_require("render_delegates/ios_picker");CW.iOSPickerPane=SC.PickerPane.extend(CW.Animatability,CW.PaneFadingSupport,{renderDelegateName:"iOSPickerRenderDelegate",paneFadeInDuration:0,fitPositionToScreenPointer:function(p,l,q){var n=arguments.callee.base.apply(this,arguments),f=30,o;var a=this.get("pointerPos"),m=this.get("pointerPosY");if(a==="perfectLeft"||a==="perfectRight"){if(m>=0&&m<f){n.y=n.y-f;m+=f}}m-=2;this.set("pointerPosY",m);return n},popup:function(h,e,g,f){if(!f){f=[13,-13,-9,9]}arguments.callee.base.call(this,h,e,g,f)},performKeyEquivalent:function(c,d){switch(c){case"escape":this.modalPaneDidClick(d);return YES;default:return NO}}});SC.BaseTheme.borderRenderDelegate=SC.RenderDelegate.create({className:"border",render:function(c,d){d=d.begin("div").addClass("panel-background");this.includeSlices(c,d,SC.NINE_SLICE);d=d.end()},update:function(){}});CW.FIVE_SLICE=["left","middle one","pointer","middle two","right"];SC.BaseTheme.iOSCalloutRenderDelegate=SC.RenderDelegate.create({className:"ios_callout",render:function(f,e){var d=f.get("pointerPos");e=e.begin("div").addClass("panel-background");this.includeSlices(f,e,CW.FIVE_SLICE);e.addClass(d);e=e.end()},update:function(g,h){var e=g.get("pointerPos");var f=h.find(".panel-background").first();if(f){f.attr("class","panel-background "+e)}}});SC.BaseTheme.sheetPaneRenderDelegate=SC.RenderDelegate.create({className:"panel",render:function(j,l){var k=j.get("hasTabBar");var m=j.get("hasNavigationBar");if(k){l.addClass("has-tab-bar")}if(m){l.addClass("has-navigation-bar")}if(j.get("isFullScreen")){l.addClass("fullscreen")}var h=l.begin("div").addClass("panel-mask");var l=l.begin("div").addClass("panel-background");this.includeSlices(j,l,SC.NINE_SLICE);l=l.end();h.end();if(m){l=l.begin("div").addClass("navigation-bar");this.includeSlices(j,l,SC.THREE_SLICE);l.end()}if(k){l=l.begin("div").addClass("tab-bar");this.includeSlices(j,l,SC.THREE_SLICE);l.end()}var g=j.get("ariaLabel");l.attr("aria-label",g||"")},update:function(h,j){var g=h.get("ariaLabel");j.attr("aria-label",g||"");var k=h.get("hasTabBar");var f=h.get("hasNavigationBar");if(k){j.addClass("has-tab-bar")}if(f){j.addClass("has-navigation-bar")}}});SC.BaseTheme.switchViewRenderDelegate=SC.RenderDelegate.create({className:"switchview",render:function(v,t){this.addSizeClassName(v,t);var q=v.get("theme"),p,u;u=SC.guidFor(v)+"-label";var s=v.get("isSelected")||NO,m=v.get("isActive"),n=!v.get("isEnabled"),o;if(s){o="true"}else{o="false"}t.attr("role","checkbox");t.attr("aria-checked",o);t.attr("aria-labelledby",u);t.setClass({active:m,disabled:n});t=t.begin("span").addClass("label").id(u);q.labelRenderDelegate.render(v,t);t=t.end();var l=t.begin("span").addClass("cw-switchview-container");t=t.push('<span class="cw-switchview-on-cap"></span>');t=t.begin("span").addClass("cw-switchview-tracks-container");this.includeSlices(v,t,["cw-switchview-off-track"]);t=t.end();t=t.push('<span class="cw-switchview-off-cap"></span>');t=t.begin("span").addClass("cw-switchview-text-container");this.includeSlices(v,t,["cw-switchview-on-text","cw-switchview-off-text"]);t=t.end();t.push('<span class = "cw-switchview-handle"></span>');l.end()},update:function(k,o){this.updateSizeClassName(k,o);var l=k.get("theme"),n=k.get("isSelected"),m=k.get("isActive"),h=!k.get("isEnabled"),j;if(n){j="true"}else{j="false"}o.attr("aria-checked",j);l.labelRenderDelegate.update(k,o.find("span.label"));o.setClass({active:m,disabled:h})}});CW.SectionedViewStyle=SC.Object.extend({contentLayout:{},sectionSpacing:0,classNames:[]});CW.SectionedViewStyle.NONE=CW.SectionedViewStyle.create();CW.SectionedViewStyle.PLAIN=CW.SectionedViewStyle.create({classNames:["cw-plain"]});CW.SectionedViewStyle.GROUPED=CW.SectionedViewStyle.create({_layout1:{top:15,left:10,right:10,bottom:15},_layout2:{top:20,left:30,right:30,bottom:30},contentLayout:function(){var b=SC.browser;return b.iPhone||b.iPod?this._layout1:this._layout2}.property(),sectionSpacing:23,classNames:["cw-grouped"]});CW.SectionedViewStyle.GROUPED_THIN=CW.SectionedViewStyle.create({_layout1:{top:15,left:10,right:10,bottom:15},_layout2:{top:20,left:30,right:30,bottom:30},contentLayout:function(){return this._layout1}.property(),sectionSpacing:23,classNames:["cw-grouped"]});CW.IMAGE_ANCHOR_CLASS_NAME="cw-image-anchor";CW.SectionedViewCellImageAnchor=SC.Object.extend({concatenatedProperties:["classNames"],classNames:[CW.IMAGE_ANCHOR_CLASS_NAME]});CW.SectionedViewCellImageAnchor.CONTENT_AREA=CW.SectionedViewCellImageAnchor.create();CW.SectionedViewCellImageAnchor.TEXT_LEFT=CW.SectionedViewCellImageAnchor.create({classNames:["cw-image-left"]});CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT=CW.SectionedViewCellImageAnchor.create({classNames:["cw-image-left"]});sc_require("sectioned_view/modifiers/cell_image_anchor");CW.SectionedViewCellStyle=SC.Object.extend({concatenatedProperties:"classNames".w(),classNames:[],imageAnchor:CW.SectionedViewCellImageAnchor.CONTENT_AREA});CW.SectionedViewCellStyle.DEFAULT1=CW.SectionedViewCellStyle.create({classNames:["cw-default"],imageAnchor:CW.SectionedViewCellImageAnchor.TEXT_LEFT});CW.SectionedViewCellStyle.DEFAULT2=CW.SectionedViewCellStyle.create({classNames:["cw-default"],imageAnchor:CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT});CW.SectionedViewCellStyle.BUTTON=CW.SectionedViewCellStyle.create({classNames:["cw-button"],});CW.SectionedViewCellStyle.DELETE_BUTTON=CW.SectionedViewCellStyle.create({classNames:["cw-delete-button"],});CW.SectionedViewCellStyle.TEXT_FIELD=CW.SectionedViewCellStyle.create({classNames:["cw-text-field"]});CW.SectionedViewCellStyle.DOUBLE_LINE_ROW=CW.SectionedViewCellStyle.create({classNames:["cw-double-line-row"]});CW.SectionedViewCellStyle.WARNING_ROW=CW.SectionedViewCellStyle.create({classNames:["cw-warning-row"]});CW.SectionedViewCellSelectionStyle=SC.Object.extend({classNames:[]});CW.SectionedViewCellSelectionStyle.NONE=CW.SectionedViewCellSelectionStyle.create();CW.SectionedViewCellSelectionStyle.BLUE=CW.SectionedViewCellSelectionStyle.create({classNames:["cw-selection-blue"]});sc_require("mixins/proxy_display");sc_require("sectioned_view/modifiers/cell_style");sc_require("sectioned_view/modifiers/cell_selection_style");CW.SectionedViewCoreCell=SC.View.extend(CW.ProxyDisplay,{renderDelegateName:"sectionedViewCoreCellRenderDelegate",proxyDisplayProperties:"isEnabled style selectionStyle".w(),indexPath:null,isHighlighted:NO,isSelected:NO,isEnabled:YES,isEnabledInSectionedView:YES,style:null,selectionStyle:CW.SectionedViewCellSelectionStyle.BLUE,highlightStyle:CW.SectionedViewCellSelectionStyle.BLUE,owner:null,selectedTarget:null,selectedAction:null,deselectedTarget:null,deselectedAction:null,displayProperties:"isSelected isHighlighted isEnabledInSectionedView highlightStyle".w(),render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this.changeDivWidth(this.$())})},changeDivWidth:function(e){if(e){var g=e;g.find(".cw-text span").css("display","inline-block");var a=g.find(".cw-content").width(),d=45,c=10,f=g.find(".cw-detail-text").width(),b=g.find(".cw-text img").length>0?40:0;g.find(".cw-text span").width(a-c-f-d-b)}},computedDisplayProxyPropertyKey:function(b){return b+"Value"},sectionedViewTapStartForEvent:function(d,c){return NO},sectionedViewTapEndForEvent:function(d,c){return NO},selected:function(){var c=this.get("selectedTarget"),d=this.get("selectedAction");this.handleCellAction(c,d)},deselected:function(){var c=this.get("deselectedTarget"),d=this.get("deselectedAction");this.handleCellAction(c,d)},handleCellAction:function(h,e){if(!e){return}var g=this.getPath("owner.pane"),f=g.get("rootResponder");f.sendAction(e,h,this,g)},isEnabledValue:function(){if(!this.get("isEnabledInSectionedView")||!this.get("isEnabledInPane")){return NO}var b=this.contentPropertyValueForProxiedProperty("isEnabled");return b===undefined?this.get("isEnabledInPane"):b}.property("isEnabledInPane","isEnabledInSectionedView").cacheable()});sc_require("sectioned_view/views/sectioned_view_core_cell");CW.SECTIONED_VIEW_CELL_DEFAULT_ACCESSORY_WIDTH=0;CW.SectionedViewCell=CW.SectionedViewCoreCell.extend({proxyDisplayProperties:"text detailText image accessoryType accessoryIsEnabled accessoryView indentationLevel indentationWidth".w(),content:null,text:null,detailText:null,image:null,accessoryType:null,accessoryView:null,accessoryIsEnabled:YES,style:CW.SectionedViewCellStyle.DEFAULT1,accessoryTypeButtonActive:NO,indentationLevel:0,indentationWidth:22,renderDelegateName:"sectionedViewCellRenderDelegate",displayProperties:"accessoryTypeButtonActive accessoryLayout".w(),accessoryViewValue:function(){var b;b=this.get("accessoryView");if(b){return b}b=this.contentPropertyValueForProxiedProperty("accessoryView");return b}.property().cacheable(),accessoryValue:function(){var c=this.get("accessoryTypeValue"),d=this.get("accessoryViewValue");if(d){return d}if(c){return c}return null}.property("accessoryTypeValue","accessoryViewValue").cacheable(),accessoryShouldBeEnabled:function(){return !!this.get("isEnabledValue")&&!!this.get("accessoryIsEnabledValue")}.property("isEnabledValue","accessoryIsEnabledValue").cacheable(),accessoryLayout:function(){var b=this.get("accessoryValue");return this._computeAccessoryLayout(b)}.property("accessoryValue").cacheable(),destroy:function(){this.accessoryView=null;this.contentView=null;arguments.callee.base.apply(this,arguments)},createChildViews:function(){var c=[],d;d=this.createAccessoryView();if(d){c.pushObject(d);this.beginPropertyChanges();this.set("accessoryView",d);this.set("childViews",c);this.endPropertyChanges()}return this},_isEnabledValueDidChange:function(){}.observes("isEnabledValue"),createAccessoryView:function(){var e=this.get("accessoryViewValue"),d=this.get("content"),f=this;if(!e||!(SC.kindOf(e,SC.View)&&e.isClass)){return null}e=this.createChildView(e,{layerId:this.get("layerId")+"-accessory",layout:this._computeAccessoryLayout(e),classNames:["cw-accessory"],isEnabledBinding:SC.Binding.oneWay(".parentView.accessoryShouldBeEnabled")});if(d&&d.get("isBindingAgent")){f=d}e.bindingAgent=f;return e},_computeAccessoryLayout:function(g){if(!g){return null}var h={},e=null,f=SC.typeOf(g);switch(f){case SC.T_OBJECT:e=g.get("layout");break;case SC.T_CLASS:e=g.prototype.layout;break;case SC.T_HASH:e=g.layout;break}e=e||{};if(!e){h.width=CW.SECTIONED_VIEW_CELL_DEFAULT_ACCESSORY_WIDTH}else{if(e.width){h.width=e.width}else{if(e.left){h.left=e.left}else{h.width=CW.SECTIONED_VIEW_CELL_DEFAULT_ACCESSORY_WIDTH}}}if(!SC.none(e.centerY)){h.centerY=e.centerY;h.height=e.height||0}else{h.top=e.top||0;h.bottom=e.bottom||0}h.right=e.right||0;return h},sectionedViewTapStartForEvent:function(f,h){var g=this.get("accessoryTypeValue"),e=this.get("isEnabledValue");if(e&&g&&g.buttonHitTest(this,h)){this._handlingRowTap=YES;this.set("accessoryTypeButtonActive",YES);return YES}return NO},sectionedViewTapEndForEvent:function(e,d){var f=this.get("accessoryTypeValue");if(!this._handlingRowTap){return NO}if(f&&f.buttonHitTest(this,d)){e.rowAccessoryButtonTappedAtIndexPath(this.get("indexPath"))}this._handlingRowTap=NO;this.set("accessoryTypeButtonActive",NO);return YES}});sc_require("sectioned_view/modifiers/sectioned_view_style");sc_require("sectioned_view/mixins/sectioned_view_data_source");sc_require("sectioned_view/mixins/sectioned_view_delegate");sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewMonitor={isSectionedViewMonitor:YES,sectionedViewWillUpdateContentView:function(b){},sectionedViewDidUpdateContentView:function(b){},sectionedViewWillSetupContentView:function(b){},sectionedViewDidSetupContentView:function(b){},sectionedViewWillTearDownContentView:function(b){},sectionedViewDidTearDownContentView:function(b){}};CW.SectionedView=SC.ScrollView.extend(CW.SectionedViewDelegate,CW.SectionedViewDataSource,CW.SectionedViewMonitor,{classNames:"cw-sectioned-view".w(),datasource:null,delegate:null,selection:null,allowsSelection:YES,rowHeight:44,style:null,sectionHeaderHeight:25,sectionFooterHeight:25,sectionHeaderViewExample:SC.LabelView,sectionFooterViewExample:SC.LabelView,headerView:null,footerView:null,headerHeight:18,footerHeight:18,rowCellExample:CW.SectionedViewCell,anchorLastSectionToBottom:NO,monitor:null,contentView:SC.View,styleValue:function(){var b=this.get("style");return b?b:CW.SectionedViewStyle.NONE}.property("style").cacheable(),sectionedViewDelegate:function(){var b=this.get("delegate");return this.delegateFor("isSectionedViewDelegate",b)}.property("delegate").cacheable(),sectionedViewDataSource:function(){var b=this.get("dataSource");return this.delegateFor("isSectionedViewDataSource",b)}.property("dataSource").cacheable(),sectionedViewMonitor:function(){var b=this.get("monitor");return this.delegateFor("isSectionedViewMonitor",b)}.property("monitor").cacheable(),reloadData:function(){this.clearSelection();this._updateContentView();this.invokeLast(function(){this.refreshLayout()})},reloadSection:function(t){if(!this._sectionBlocks){return}var u=this._sectionBlocks[t];if(!u){return}var l=u.get("views")||[],o=l.length,m=this.get("contentView"),p=m.get("childViews")||[],v=p.length,s=null;var q=o>0?l[o-1]:null,n=p.indexOf(q);if(n>-1&&n<v-1){s=p[n+1]}m.beginPropertyChanges();l.forEach(function(a){m.removeChild(a)},this);u.reload();l=u.get("views")||[];l.forEach(function(a){m.insertBefore(a,s);s=a},this);this._readjustAllBlocks();m.endPropertyChanges();this.invokeLater(function(){this.refreshLayout()})},reloadRowAtIndexPath:function(b){},didAppendToDocument:function(){var b=this;this.invokeLater(function(){b.refreshLayout()})},refreshLayout:function(){var b=this._blocks||[];b.forEach(function(a){a.updateHeightIfNeeded()});this._readjustAllBlocks()},cellForRowAtIndexPath:function(h){var j=this._sectionBlocks,l,m,g=h?h.get("section"):null,k=h?h.get("row"):null;if(!h||!j||g>(j.length-1)){return null}l=j[g];m=l.rows;if(!m||k>(m.length-1)){return null}return m[k]},cellForEvent:function(l){var k=l.target,g=this.get("layer"),m=k,h,j;while(m&&m!==g&&m!==document){if((j=m.id)&&(h=SC.View.views[j])&&h.isSectionedViewCell){return h}m=m.parentNode}return null},deselectRowAtIndexPath:function(b){if(!this.get("allowsSelection")||!b){return}if(!this.validIndexPath(b)){return}this.clearSelection()},selectRowAtIndexPath:function(c){if(!this.get("allowsSelection")||!c){return}this.propertyWillChange("selection");var d=this.cellForRowAtIndexPath(c);if(!d){return}this.propertyWillChange("selection");this.clearSelection();d.set("isSelected",YES);this.set("selection",c);this.propertyDidChange("selection")},clearSelection:function(){var c=this.get("selection"),d;if(!c){return}d=this.cellForRowAtIndexPath(c);if(d){d.set("isSelected",NO)}this.set("selection",null)},validIndexPath:function(g){var h,j,l,m,k;if(!g){return NO}j=this._sectionBlocks;h=j?j.length:0;l=g.get("section");if(l<0||l>=h){return NO}m=j[l].rows;h=m?m.length:0;k=g.get("row");if(k<0||k>=h){return NO}return YES},rowTapStartAtIndexPath:function(m){if(!this.get("allowsSelection")||!this.validIndexPath(m)){return}var g=this.get("sectionedViewDelegate"),k=this.get("selection"),j,l,h;h=this.cellForRowAtIndexPath(m);if(!h||!h.get("isEnabledValue")){return}j=g.sectionedViewWillSelectRowAtIndexPath(this,m);if(k){l=g.sectionedViewWillDeselectRowAtIndexPath(this,k)}h=this.cellForRowAtIndexPath(j);if(!h){return}this._rowTapInfo={selectIndexPath:j,deselectIndexPath:l,cell:h};h.set("isHighlighted",YES)},rowTapEndAtIndexPath:function(m){var g=this.get("sectionedViewDelegate"),k=this._rowTapInfo||{},j=k.selectIndexPath,l=k.deselectIndexPath,h;if(m&&m.equals(j)){this._removeHighlightFromTappedRow();this.selectRowAtIndexPath(j);g.sectionedViewDidSelectRowAtIndexPath(this,j);if(l){g.sectionedViewDidDeselectRowAtIndexPath(this,l)}h=this.cellForRowAtIndexPath(l);if(h){h.deselected()}h=this.cellForRowAtIndexPath(j);if(h){h.selected()}}this._cleanupRowTap()},cancelRowTap:function(){this._cleanupRowTap()},_cleanupRowTap:function(){this._removeHighlightFromTappedRow();this._rowTapInfo=null},_removeHighlightFromTappedRow:function(){var c=this._rowTapInfo||{},d=c.cell;if(d){d.set("isHighlighted",NO)}},rowAccessoryButtonTappedAtIndexPath:function(c){var d=this.get("sectionedViewDelegate");d.sectionedViewAccessoryButtonTappedForRowAtIndexPath(this,c)},render:function(f,g){var e=this.get("styleValue"),h=e.get("classNames");if(g){f.addClass(h)}},createChildViews:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this._setupContentView()},this);return this},destroy:function(){this._tearDownContentView();arguments.callee.base.apply(this,arguments)},_updateContentView:function(){var b=this.get("sectionedViewMonitor");b.sectionedViewWillUpdateContentView(this);this._tearDownContentView();this._setupContentView();b.sectionedViewDidUpdateContentView(this)},_setupContentView:function(){var m=this.get("contentView"),j=this.get("sectionedViewMonitor"),h=this.get("sectionedViewDelegate"),l=[];j.sectionedViewWillSetupContentView(this);h.sectionedViewWillSetupAllCells(this);this._headerBlock=this._createHeaderBlock();this._footerBlock=this._createFooterBlock();this._sectionBlocks=this._createSectionBlocks();var k=[];k.push(this._headerBlock);k.pushObjects(this._sectionBlocks);k.push(this._footerBlock);this._blocks=k;k.forEach(function(a){a.setup();l.pushObjects(a.get("views"))});m.beginPropertyChanges();var o=this.get("styleValue"),n=o.get("contentLayout");m.adjust({right:n.right||0,left:n.left||0});m.set("childViews",l);m.endPropertyChanges();this._readjustAllBlocks();m.replaceLayer();h.sectionedViewDidSetupAllCells(this);j.sectionedViewDidSetupContentView(this)},_frameDidChange:function(){var d=this._readjustAnchoredBottomBlocks();if(d){var c=this.get("contentView");c.adjust("height",d)}}.observes("frame"),_heightOfAllBlocksWithPadding:function(){var e=this.get("styleValue"),h=e.get("contentLayout"),g=h.top||0,f=h.bottom||0;return this._heightOfAllBlocks()+g+f},_heightOfAllBlocks:function(){var c=this._blocks,d=c?c.length:0;return this._heightOfBlocksToIndex(d-1)},_heightOfBlocksToIndex:function(k){var h=this._blocks,f=h?h.length:0,g=0;if(k>=f){throw"invalid index: "+k}for(var j=0;j<=k;j+=1){g+=h[j].get("height")}return g},_heightOfBlocksFromIndex:function(k){var h=this._blocks,f=h?h.length:0,g=0;if(k>=f){throw"invalid index: "+k}for(var j=k;j<f;j+=1){g+=h[j].get("height")}return g},_readjustAllBlocks:function(){var f=this.get("styleValue"),g=f.get("contentLayout");this._readjustBlockFromIndex(0,g.top||0);var h=this._readjustAnchoredBottomBlocks();if(!h){h=this._heightOfAllBlocksWithPadding()}var e=this.get("contentView");e.adjust("height",h)},_readjustBlockFromIndex:function(e,h){var g=this._blocks,f=g?g.length:0;if(e>=f){return}this._readjustBlockRegion(e,f-1,h)},_readjustAnchoredBottomBlocks:function(){if(!this.get("anchorLastSectionToBottom")){return}var u=this.get("sectionedViewDataSource"),l=u.numberOfSectionsInSectionedView(this),n=this.get("frame").height,t=this._blocks;if(!t){return}var m=t.length;if(l<2){return}var o=m-2;if(this._heightOfAllBlocksWithPadding()>=n){this._readjustBlockFromIndex(o);return}var s=this.get("styleValue"),p=s.get("contentLayout"),v=p.bottom||0,q=this._heightOfBlocksFromIndex(o);top=n-q-v;this._readjustBlockRegion(o,m-1,top);return n},_readjustBlockRegion:function(s,o,l){var u=this._blocks,m=u.length;if(s<0||o>=m){throw"invalid argument provided"}var q=l>=0;for(var n=s;n<=o;n+=1){var p=u[n],t=n-1>=0?u[n-1]:null,v=t?t.get("top")+t.get("height"):0;if(!q){l=t?v:0}p.readjustFromTop(l);q=false}},_createHeaderBlock:function(){return CW.SectionedViewHeaderBlock.create({sectionedView:this})},_createFooterBlock:function(){return CW.SectionedViewFooterBlock.create({sectionedView:this})},_createSectionBlocks:function(){var j=this.get("sectionedViewDataSource"),g=j.numberOfSectionsInSectionedView(this),h=[];for(var f=0;f<g;f+=1){if(j.sectionedViewSectionIsVisible(this,f)){var k=CW.SectionedViewSectionBlock.create({sectionedView:this,sectionIndex:f});h.push(k)}}return h},_tearDownContentView:function(){var d=this.get("sectionedViewMonitor"),c=this.get("sectionedViewDelegate");d.sectionedViewWillTearDownContentView(this);c.sectionedViewWillTearDownAllCells(this);this._tearDownAllBlocks();c.sectionedViewDidTearDownAllCells(this);d.sectionedViewDidTearDownContentView(this)},_tearDownAllBlocks:function(){var d=this.get("contentView");d.beginPropertyChanges();d.removeAllChildren();var c=this._blocks||[];c.forEach(function(a){a.tearDown()});d.endPropertyChanges()},mouseDown:function(b){return this._handleTapStartForEvent(b)},mouseUp:function(b){return this._handleTapEndForEvent(b)},touchStart:function(e){var g=e.averagedTouchesForView(this,YES),h={event:e,handled:NO,x:g.x,y:g.y};this._touchStartInfo=h;var f=this;setTimeout(function(){SC.RunLoop.begin();f._handleTouchStart();SC.RunLoop.end()},100);return arguments.callee.base.apply(this,arguments)},touchesDragged:function(f,g){arguments.callee.base.apply(this,arguments);var h=f.averagedTouchesForView(this),e=this._touchStartInfo;if(!e){return YES}e.touchDragged=YES;if(Math.abs(e.y-h.y)>3){this._touchStartInfo=null;this.cancelRowTap()}return YES},touchEnd:function(e){var f=e.averagedTouchesForView(this),d=this._touchStartInfo;if(d){if(d.handled){this._handleTapEndForEvent(e)}else{if(!d.touchDragged){this.invokeLater(function(){this._handleTapStartForEvent(d.event);this.invokeLater(function(){this._handleTapEndForEvent(e)},100)},10)}}}this._touchStartInfo=null;return arguments.callee.base.apply(this,arguments)},_handleTouchStart:function(){var b=this._touchStartInfo;if(!b){return}b.handled=YES;this._handleTapStartForEvent(b.event)},_handleTapStartForEvent:function(d){var f={};this._tapStartInfo=f;var e=this.cellForEvent(d);if(!e){this._tapStartInfo=null;return NO}f.cell=e;if(e.tryToPerform("sectionedViewTapStartForEvent",this,d)){f.cellHandlingRowTap=YES;return YES}this.rowTapStartAtIndexPath(e.get("indexPath"));return YES},_handleTapEndForEvent:function(h){if(!this._tapStartInfo){return NO}var g=this._tapStartInfo,f=g.cell,e;this._tapStartInfo=null;if(g.cellHandlingRowTap&&f.sectionedViewTapEndForEvent){return f.sectionedViewTapEndForEvent(this,h)}f=this.cellForEvent(h);if(f){e=f.get("indexPath")}this.rowTapEndAtIndexPath(e);return YES},_cw_sv_isEnabledChanged:function(){var c=this._sectionBlocks||[],d=this.get("isEnabled");c.forEach(function(a){var b=a.rows||[];b.forEach(function(f){f.set("isEnabledInSectionedView",d)})})}.observes("isEnabled")});CW.IndexPath=SC.Object.extend(SC.Copyable,{section:null,row:null,copy:function(b){return CW.IndexPath.create({section:this.get("section"),row:this.get("row")})},equals:function(b){if(!b||!SC.kindOf(b,CW.IndexPath)){return NO}return CW.IndexPath.compare(this,b)===0},toString:function(){var c=this.get("row"),d=this.get("section");return"IndexPath(row: %@, section: %@)".fmt(c,d)}});CW.IndexPath.mixin(SC.Comparable,{compare:function(g,h){var b=SC.kindOf(g,CW.IndexPath),a=SC.kindOf(h,CW.IndexPath);if(!b&&!a){throw"Can not compare. a and b must both be of type CW.IndexPath"}if(g.get("section")==h.get("section")){if(g.get("row")===h.get("row")){return 0}return g.get("row")<h.get("row")?-1:1}return g.get("section")<h.get("section")?-1:1}});CW.SectionedViewAutoResizingViewSupport={isSectionedViewAutoResizingView:YES,shouldAutoResize:YES,heightPadding:0,computeHeight:function(){var d=this.$()[0],f=this.getPath("frame.width"),e;if(SC.none(d)){return null}d.style.maxWidth=f+"px";e=SC.metricsForString(this.get("value"),d);return e.height+this.get("heightPadding")}};CW.SVCollectionSectionDelegate={isSVCollectionSectionDelegate:YES,collectionSectionCellForContentAtIndex:function(f,d,e){return null},collectionSectionRowHeightForContentAtIndex:function(f,d,e){return null}};sc_require("sectioned_view/mixins/sectioned_view_data_source");sc_require("sectioned_view/mixins/sectioned_view_delegate");CW.SectionedViewDesignSupport={};SC.mixin(CW.SectionedViewDesignSupport,CW.SectionedViewDataSource,CW.SectionedViewDelegate,{isSectionedViewDesigner:YES,sections:[],initMixin:function(){this.createSections()},createSections:function(){var h=(this.get("sections")||[]).slice(),g=h.length,f=0,j,k;for(;f<g;f+=1){j=h[f];k=this.createSection(this[j],f);h[f]=this[j]=k;if(!k){throw'sectioned view designer has invalid section "%@" for section[%@]'.fmt(j,f)}}this.set("sections",h)},createSection:function(c,d){if(SC.kindOf(c,CW.SectionedViewSection)&&c.isClass){return c.create({owner:this,index:d})}return null},sectionForIndex:function(d){var c=this.get("sections");return c?c.objectAt(d):undefined},rowForIndexPath:function(e){var d=e.get("section"),f=e.get("row");d=this.sectionForIndex(d);return d?d.rowForIndex(f):d},numberOfSectionsInSectionedView:function(b){return this.getPath("sections.length")},sectionedViewSectionIsVisible:function(d,c){c=this.sectionForIndex(c);return c?c.get("isVisible"):NO},sectionedViewNumberOfRowsInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("rows").length:c},sectionedViewCellForRowAtIndexPath:function(f,k){var j=this.sectionForIndex(k.get("section")),h=this.rowForIndexPath(k),g;if(h&&(g=h.get("cell"))){return g}if(j&&(g=j.get("cell"))){return g}return null},sectionedViewContentForRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(!f||f.get("isContent")){return f}return f.get("content")},sectionedViewTitleForHeaderInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("headerTitle"):c},sectionedViewTitleForFooterInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("footerTitle"):c},sectionedViewHeightForRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);return f?f.get("height"):f},sectionedViewViewForHeaderInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("headerView"):c},sectionedViewViewForFooterInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("footerView"):c},sectionedViewHeightForHeaderInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("headerHeight"):c},sectionedViewHeightForFooterInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("footerHeight"):c},sectionedViewShouldAutoResizeHeaderTitleInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("autoResizeHeaderTitle"):NO},sectionedViewShouldAutoResizeFooterTitleInSection:function(d,c){c=this.sectionForIndex(c);return c?c.get("autoResizeFooterTitle"):NO},sectionedViewAccessoryButtonTappedForRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(!f){return null}f.accessoryButtonTapped(e)},sectionedViewWillSelectRowAtIndexPath:function(h,m){var j=this.rowForIndexPath(m),k=this.sectionForIndex(m.get("section")),g=j&&j.get("allowsSelection"),l=j&&j.get("isEnabled");if(!k.get("allowsSelection")||!j.get("allowsSelection")||!j.get("isEnabled")){return null}return m},sectionedViewDidSelectRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(f&&f.get("allowsSelection")){f.selected(e)}},sectionedViewWillDeselectRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);return f&&f.get("allowsSelection")?d:null},sectionedViewDidDeselectRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(f&&f.get("allowsSelection")){f.deselected(e)}},sectionedViewCellDisplayDelegateForRowAtIndexPath:function(g,k){var j=this.sectionForIndex(k.get("section")),h=k.get("row"),f=null;if(j){f=j.displayDelegateForRow(h)}return f?f:g},sectionedViewWillSetupAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewWillSetupAllCells",b)},sectionedViewDidSetupAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewDidSetupAllCells",b)},sectionedViewWillTearDownAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewWillTearDownAllCells",b)},sectionedViewDidTearDownAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewDidTearDownAllCells",b)},_notifySectionsOfAllCellUpdates:function(d,e){var f=this.get("sections")||[];f.forEach(function(a){a[d](e)})}});CW.SWITCH_VIEW_WIDTH=79;CW.HANDLE_WIDTH=27;CW.CAP_WIDTH=15;CW.HANDLE_MAX_LEFT=52;CW.SwitchView=SC.CheckboxView.extend({classNames:["cw-switchview"],renderDelegateName:"switchViewRenderDelegate",animateOnPropertyChange:NO,animateOnPropertyChangeBindingDefault:SC.Binding.oneWay(),_isTracking:NO,_startingMouseOffset:0,_handleLocation:0,_container:null,_handle:null,_offTrack:null,_offText:null,_onText:null,_onCap:null,_offCap:null,didCreateLayer:function(){this._animateTo(this.get("isSelected"),NO,0)},didUpdateLayer:function(){this._animateTo(this.get("isSelected"),NO,0)},_isSelectedDidChange:function(){if(!this._handle){this._initReferences()}var d=this.get("animateOnPropertyChange"),c=d?null:0;this._animateTo(this.get("isSelected"),NO,c)}.observes("isSelected"),keyDown:function(b){if(!this.get("isEnabled")){return NO}if(!this._handle){this._initReferences()}if(b.keyCode===13){this._animateTo(!this.get("isSelected"));return YES}else{if(b.keyCode===39){this._animateTo(YES);return YES}else{if(b.keyCode===37){this._animateTo(NO);return YES}else{return arguments.callee.base.apply(this,arguments)}}}},mouseDown:function(b){if(!this.get("isEnabled")){return NO}if(!this._handle){this._initReferences()}if(!b.target.className.indexOf("cw-switchview-handle")>0){this._handle.removeClass("highlight");this._handle.addClass("pressed")}this._onCap.addClass("cw-switchview-on");this._startingMouseOffset=this._makeValueRelativeToLeftEdgeOf(b.clientX,this._container);this._startingHandleLocation=parseInt(this._handle.css("left"),10)},touchesDragged:function(b){this.mouseDragged(b)},mouseDragged:function(e){if(!this.get("isEnabled")){return NO}if(!this._isTracking){this._handle.removeClass("highlight");this._handle.addClass("pressed")}this._isTracking=YES;var d=this._makeValueRelativeToLeftEdgeOf(e.clientX,this._container);var f=d-this._startingMouseOffset;this._repositionTo(this._startingHandleLocation+f)},mouseUp:function(c){if(!this.get("isEnabled")){return NO}var d=parseInt(this._handle.css("left"),10)>=CW.HANDLE_MAX_LEFT/2;if(!this._isTracking){this._animateTo(!this.get("isSelected"))}else{this._animateTo(d);this._isTracking=NO}},_makeValueRelativeToLeftEdgeOf:function(h,f){var e=0,g=0;if(f.offsetParent){do{if(f===document.body){break}g+=f.offsetLeft;e+=f.offsetTop}while(f=f.offsetParent)}return h-g},_initReferences:function(){this._container=this.$(".cw-switchview-container")[0];this._handle=this.$(".cw-switchview-handle");this._offTrack=this.$(".cw-switchview-off-track");this._offText=this.$(".cw-switchview-off-text");this._onText=this.$(".cw-switchview-on-text");this._onCap=this.$(".cw-switchview-on-cap");this._offCap=this.$(".cw-switchview-off-cap")}.observes("layer"),_repositionTo:function(b){b=Math.max(Math.min(b,CW.HANDLE_MAX_LEFT),0);this._handle.css("left",this._handleLocation=b);this._offTrack.css("left",b);this._onText.css("left",b-41);this._offText.css("left",b+34)},_animateTo:function(d,e,f){if(e===undefined){e=YES}this._handle.removeClass("pressed");if(d){this._onCap.addClass("cw-switchview-on")}else{this._handle.removeClass("highlight")}if(this._anim){this._anim.stop()}if(f===0){this._repositionTo(d?CW.HANDLE_MAX_LEFT:0)}else{this._anim=CW.Animation.create({name:this.toString(),that:this,updateValue:e,isSelected:d,updateValue:e,from:this._handleLocation,to:(d)?CW.HANDLE_MAX_LEFT:0,duration:SC.none(f)?350:f,update:function(){this.that._repositionTo(this.current)},onFinish:function(){if(this.updateValue){if(this.that.get("isSelected")!==this.isSelected){this.invokeLast(function(){this.that._action()})}this.that.set("isSelected",this.isSelected)}if(!this.isSelected){this.that._onCap.removeClass("cw-switchview-on")}}}).start()}}});sc_require("views/switch_view");CW.SwitcherAccessoryViewSupport={target:null,action:null,animateOnPropertyChange:NO,animateOnPropertyChangeBindingDefault:SC.Binding.oneWay(),accessoryView:CW.SwitchView.extend({layout:{width:80,centerY:1,height:27,right:10},animateOnPropertyChangeBinding:SC.Binding.oneWay(".bindingAgent.animateOnPropertyChange"),valueBinding:".bindingAgent.value",targetBinding:SC.Binding.oneWay(".bindingAgent.target"),actionBinding:SC.Binding.oneWay(".bindingAgent.action")})};CW.SectionedViewCellAccessoryType=SC.Object.extend({concatenatedProperties:["classNames"],classNames:[],buttonHitTest:function(d,c){return NO}});CW.SectionedViewCellAccessoryType.mixin({CLASS_NAME:"cw-accessory-type",render:function(d,f,e){e=e.begin().addClass(this.CLASS_NAME);if(d){e.addClass(d.get("classNames"))}e.end()},update:function(k,h,g){var j=g.find("."+this.CLASS_NAME);if(j){var f=[this.CLASS_NAME];if(k){f=f.concat(k.get("classNames"))}j.attr("class",f.join(" "))}}});CW.SectionedViewCellAccessoryType.DETAIL_CHECKMARK=CW.SectionedViewCellAccessoryType.create({classNames:"cw-detail-checkmark".w()});CW.SectionedViewCellAccessoryType.DISCLOSURE_INDICATOR=CW.SectionedViewCellAccessoryType.create({classNames:"cw-disclosure-indicator".w()});CW.SectionedViewCellAccessoryType.DETAIL_DISCLOSURE_BUTTON=CW.SectionedViewCellAccessoryType.create({classNames:"cw-detail-disclosure-button".w(),buttonHitTest:function(f,h){var g=h.target,e=f.$("."+this.get("classNames")[0]);return e.size()>0&&e.within(g)}});CW.SectionedViewBlock=SC.Object.extend({sectionedView:null,views:[],height:0,top:0,hasViews:function(){var b=this.get("views");return b&&(b.length>0)}.property("view").cacheable(),setup:function(){},tearDown:function(){var b=this.get("views")||[];b.forEach(function(a){a.destroy()});this.set("views",[])},reload:function(){},readjustFromTop:function(b){this.set("top",b);this.doReadjustFromTop(b)},doReadjustFromTop:function(b){},readjustViewFromTop:function(d,c){d.adjust({top:c,bottom:null});return d.get("frame").height},updateHeightIfNeeded:function(){var c=this.get("views")||[],d=NO;c.forEach(function(a){if(a.isSectionedViewAutoResizingView&&a.shouldAutoResize){var b=a.computeHeight();if(b){a.adjust("height",b);d=YES}}});if(d){this.updateHeight()}},updateHeight:function(){}});sc_require("sectioned_view/private/block");CW.SectionedViewFooterBlock=CW.SectionedViewBlock.extend({setup:function(){var f=this.get("sectionedView"),k=f.get("styleValue"),j=k.get("contentLayout"),h=f.get("footerView"),g=f.get("footerHeight");if(!h){return}if(!h.isClass||!SC.kindOf(h,SC.View)){SC.Logger.error("%@: sectioned view footer is not a view class".fmt(f));return}h=f.get("contentView").createChildView(h,{layerId:"%@-footer".fmt(f.get("layerId")),classNames:"cw-sectioned-footer",layout:{left:0,right:0,top:0,height:g}});this.set("views",[h]);this.set("height",g)},doReadjustFromTop:function(c){var d=this.get("views");if(d&&d.length>0){this.readjustViewFromTop(d[0],c)}},updateHeight:function(){this.set("height",this.get("views")[0].get("frame").height)}});sc_require("sectioned_view/private/block");CW.SectionedViewHeaderBlock=CW.SectionedViewBlock.extend({setup:function(){var f=this.get("sectionedView"),k=f.get("styleValue"),j=k.get("contentLayout"),h=f.get("headerView"),g=f.get("headerHeight");if(!h){return}if(!h.isClass||!SC.kindOf(h,SC.View)){SC.Logger.error("%@: sectioned view header is not a view class".fmt(f));return}h=f.get("contentView").createChildView(h,{layerId:"%@-header".fmt(f.get("layerId")),classNames:"cw-sectioned-header",layout:{left:0,right:0,top:0,height:g}});this.set("views",[h]);this.set("height",g)},doReadjustFromTop:function(c){var d=this.get("views");if(d&&d.length>0){this.readjustViewFromTop(d[0],c)}},updateHeight:function(){this.set("height",this.get("views")[0].get("frame").height)}});sc_require("sectioned_view/private/block");CW.SectionedViewSectionBlock=CW.SectionedViewBlock.extend({sectionIndex:null,headerView:null,footerView:null,rows:null,height:function(){var o=this.get("sectionedView"),p=this.get("sectionIndex"),v=o.get("sectionedViewDataSource"),l=v.numberOfSectionsInSectionedView(o),n=this.get("views")||[],s=this.rowsContainerView;var m=0;n.forEach(function(a){if(a!=s){m+=a.get("frame").height}});var u=o.get("styleValue"),t=u.get("contentLayout"),q=u.get("sectionSpacing");if(p<l-1&&m>0){m+=q}return m}.property("views","sectionIndex").cacheable(),includeSectionRowsContainer:function(){return SC.browser.isIE8OrLower}.property().cacheable(),setup:function(){var c=this.get("sectionedView"),d=[];this.headerView=this._createHeaderView();this.rows=this._createRowCells();this.footerView=this._createFooterView();this.rowsContainerView=this._createRowsContainer();if(this.rowsContainerView){d.push(this.rowsContainerView)}if(this.headerView){d.push(this.headerView)}if(this.rows){d.pushObjects(this.rows)}if(this.footerView){d.push(this.footerView)}this.set("views",d)},reload:function(){this.tearDown();this.setup()},doReadjustFromTop:function(s){var v=this.headerView,p=this.footerView,m=this.rows,u=s,x=0,n=0;if(v){s+=this.readjustViewFromTop(v,s)}for(var w=0,q=m.length;w<q;w+=1){var o=m[w];if(w===0){x=s}n+=o.get("frame").height;s+=this.readjustViewFromTop(o,s)}if(p){s+=this.readjustViewFromTop(p,s)}var t=this.rowsContainerView;if(t){t.adjust({top:x,height:n})}},updateHeight:function(){this.notifyPropertyChange("height")},_createRowsContainer:function(){var h=this.get("sectionedView"),g=h.get("contentView");if(!this.get("includeSectionRowsContainer")){return null}var e=CW.SectionedViewSectionBlock,f=e.sectionRowsContainerViewExample;return g.createChildView(f)},_createRowCells:function(){var h=this.get("sectionedView"),m=this.get("sectionIndex"),k=h.get("sectionedViewDataSource"),n=k.sectionedViewNumberOfRowsInSection(h,m),o=[];for(var l=0,j;l<n;l+=1){j=this._createRowCell(m,l);if(j){o.push(j)}}return o},_createRowCell:function(x,p){var w=this.get("sectionedView"),D=w.get("sectionedViewDataSource"),s=w.get("sectionedViewDelegate"),y=CW.IndexPath.create({section:x,row:p}),v=D.sectionedViewCellForRowAtIndexPath(w,y),B=D.sectionedViewContentForRowAtIndexPath(w,y),t=s.sectionedViewHeightForRowAtIndexPath(w,y),E=["cw-section-row"],q=D.sectionedViewNumberOfRowsInSection(w,x),z=s.sectionedViewCellDisplayDelegateForRowAtIndexPath(w,y),C;t=t||w.get("rowHeight");if(p===0){E.push("cw-first-row")}if(p===q-1){E.push("cw-last-row")}if(!v){v=w.get("rowCellExample")}if(!v||!v.isClass||!SC.kindOf(v,CW.SectionedViewCoreCell)){SC.Logger.error("%@: cell for index path %@ is not a sectioned view core cell class".fmt(w,y));return null}C={classNames:E,layerId:"%@-section-%@-row-%@".fmt(w.get("layerId"),x,p),isSectionedViewCell:YES,indexPath:y,layout:{top:0,left:0,right:0,height:t},displayDelegate:z};if(B){C.content=B}var u=w.get("contentView");v=u.createChildView(v,C);v.owner=w;return v},_createHeaderView:function(){var n=this.get("sectionedView"),o=this.get("sectionIndex"),t=n.get("sectionedViewDataSource"),l=n.get("sectionedViewDelegate"),p=t.sectionedViewTitleForHeaderInSection(n,o),s=t.sectionedViewShouldAutoResizeHeaderTitleInSection(n,o),q=l.sectionedViewViewForHeaderInSection(n,o),k=l.sectionedViewHeightForHeaderInSection(n,o);k=k||n.get("sectionHeaderHeight");if(!SC.empty(p)&&!q){q=n.get("sectionHeaderViewExample").extend({value:p});if(s){q=q.extend(CW.SectionedViewAutoResizingViewSupport,{heightPadding:6})}}if(!q){return null}if(!q.isClass||!SC.kindOf(q,SC.View)){SC.Logger.error("%@: header view for section %@ is not a view class".fmt(n,o));return null}var m=n.get("contentView");q=m.createChildView(q,{layerId:"%@-section-header-%@".fmt(n.get("layerId"),o),classNames:"cw-section-header",escapeHTML:NO,layout:{left:0,right:0,top:0,height:k},displayDelegate:n,frameWidthDidChange:function(){if(this.computeHeight){var a=this.computeHeight();if(a){this.adjust("height",this.computeHeight())}}}.observes("*frame.width")});q.owner=n;return q},_createFooterView:function(){var n=this.get("sectionedView"),o=this.get("sectionIndex"),t=n.get("sectionedViewDataSource"),l=n.get("sectionedViewDelegate"),p=t.sectionedViewTitleForFooterInSection(n,o),s=t.sectionedViewShouldAutoResizeFooterTitleInSection(n,o),q=l.sectionedViewViewForFooterInSection(n,o),k=l.sectionedViewHeightForFooterInSection(n,o);k=k||n.get("sectionFooterHeight");if(!SC.empty(p)&&!q){q=n.get("sectionFooterViewExample").extend({value:p});if(s){q=q.extend(CW.SectionedViewAutoResizingViewSupport)}}if(!q){return null}if(!q.isClass||!SC.kindOf(q,SC.View)){SC.Logger.error("%@: footer view for section %@ is not a view class".fmt(n,o));return null}var m=n.get("contentView");q=m.createChildView(q,{layerId:"%@-section-footer-%@".fmt(n.get("layerId"),o),classNames:"cw-section-footer",escapeHTML:NO,layout:{left:0,right:0,top:0,height:k},displayDelegate:n,frameWidthDidChange:function(){if(this.computeHeight){var a=this.computeHeight();if(a){this.adjust("height",this.computeHeight())}}}.observes("*frame.width")});q.owner=n;return q}});CW.SectionedViewSectionBlock.mixin({sectionRowsContainerViewExample:SC.View.extend({classNames:"cw-section-rows-container",render:function(d,c){SC.RenderDelegate.includeSlices(this,d,SC.NINE_SLICE)}})});CW.SectionedViewCoreCellRenderDelegate=SC.RenderDelegate.extend({className:"cw-sectioned-view-cell",styleKey:"styleValue",selectionStyleKey:"selectionStyleValue",highlightStyleKey:"highlightStyle",isEnabledKey:"isEnabledValue",render:function(n,j){var m=n.get("isSelected"),h=n.get("isHighlighted"),k=n.get(this.get("isEnabledKey")),l=n.get(this.get("styleKey")),o=n.get(this.get("selectionStyleKey")),e=n.get(this.get("highlightStyleKey"));if(m){j.addClass("cw-selected")}if(h){j.addClass("cw-highlighted")}if(!k){j.addClass("cw-disabled")}if(h){j.addClass(e.get("classNames"))}if(m){if(o){j.addClass(o.get("classNames"))}}if(l){j.addClass(l.get("classNames"))}this.willRenderCellBody(n,j);this.renderCellBody(n,j);this.didRenderCellBody(n,j)},renderCellBody:function(b,a){},willRenderCellBody:function(b,a){},didRenderCellBody:function(b,a){},update:function(a,q){var p=a.get(this.get("styleKey")),l=a.get(this.get("selectionStyleKey")),n=a.get(this.get("highlightStyleKey")),m;var o=a.get("isSelected");q.setClass("cw-selected",o);var d=a.get("isHighlighted");q.setClass("cw-highlighted",d);var k=a.get(this.get("isEnabledKey"));q.setClass("cw-disabled",!k);if(p){q.addClass(p.get("classNames"))}if(n){m=n.get("classNames");if(d){q.addClass(m)}else{q.removeClass(m)}}if(l){m=l.get("classNames");if(o){q.addClass(m)}else{q.removeClass(m)}}this.willUpdateCellBody(a,q);this.updateCellBody(a,q);this.didUpdateCellBody(a,q)},updateCellBody:function(b,a){},willUpdateCellBody:function(b,a){},didUpdateCellBody:function(b,a){}});SC.BaseTheme.sectionedViewCoreCellRenderDelegate=CW.SectionedViewCoreCellRenderDelegate.create();sc_require("sectioned_view/render_delegates/core_cell_render_delegate");CW.SectionedViewCellRenderDelegate=CW.SectionedViewCoreCellRenderDelegate.extend({renderCellBody:function(b,a){this.renderContentArea(b,a);this.renderAccessoryType(b,a)},renderContentArea:function(a,c){var m=a.get("indentationLevelValue"),k=a.get("indentationWidthValue"),p=a.get("accessoryLayout");c=c.begin().addClass("cw-content");c.addStyle("margin-left",m*k);if(p){var q=p.width,o=p.left,l=p.right,n=5;if(q){c.addStyle("margin-right",q+l+n)}else{if(o){c.addStyle("margin-right",o+n)}}}this.willRenderContentAreaBody(a,c);this.renderContentAreaImage(a,c,CW.SectionedViewCellImageAnchor.CONTENT_AREA);this.renderContentAreaText(a,c);this.renderContentAreaDetailText(a,c);this.didRenderContentAreaBody(a,c);c.end()},willRenderContentAreaBody:function(b,a){},didRenderContentAreaBody:function(b,a){},renderContentAreaText:function(c,b){var a=c.get("textValue");if(!a){return}b=b.begin().addClass("cw-text ellipsis");this.renderContentAreaImage(c,b,CW.SectionedViewCellImageAnchor.TEXT_LEFT);this.willRenderContentAreaText(c,b);b.begin("span").attr("title",a).text(a).end();this.didRenderContentAreaText(c,b);b.end()},willRenderContentAreaText:function(b,a){},didRenderContentAreaText:function(b,a){},renderContentAreaDetailText:function(c,b){var a=c.get("detailTextValue");if(!a){return}b=b.begin().addClass("cw-detail-text");this.renderContentAreaImage(c,b,CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT);this.willRenderContentAreaDetailText(c,b);b.begin("span").text(a).end();this.didRenderContentAreaDetailText(c,b);b.end()},willRenderContentAreaDetailText:function(b,a){},didRenderContentAreaDetailText:function(b,a){},renderContentAreaImage:function(a,e,l){var m=a.get("imageValue"),p=a.get(this.get("styleKey")),q=p.get("imageAnchor"),k=q===l;if(k){e.addClass(q.get("classNames"))}if(!m||!k){return}var o=null,n=["cw-image"];if(m&&SC.ImageView.valueIsUrl(m)){o=m}else{n.push(m);o=SC.BLANK_IMAGE_URL}this.willRenderContentAreaImage(a,e);e.begin("img").addClass(n).attr("src",o).end();this.didRenderContentAreaImage(a,e)},willRenderContentAreaImage:function(b,a){},didRenderContentAreaImage:function(b,a){},renderAccessoryType:function(d,c){var a=d.get("accessoryTypeValue");if(a){c.addClass("cw-has-accessory-type")}CW.SectionedViewCellAccessoryType.render(a,d,c)},updateCellBody:function(b,a){this.updateContentArea(b,a);this.updateAccessoryType(b,a)},updateContentArea:function(b,a){this.willUpdateContentArea(b,a);this.updateContentAreaText(b,a);this.updateContentAreaDetailText(b,a);this.updateContentAreaImage(b,a);this.didUpdateContentArea(b,a)},willUpdateContentArea:function(b,a){},didUpdateContentArea:function(b,a){},updateContentAreaText:function(f,e){if(!f.didChangeFor("update","textValue")){return}var b=f.get("textValue"),d=e.find(".cw-content .cw-text span"),g=!SC.empty(b);if(!g&&d.size()>0){d.remove();this.didRemoveContentAreaText(f,e)}else{if(g&&d.size()>0){d.text(b);this.didUpdateContentAreaText(f,e)}else{if(g){e.find(".cw-content").append('<div class="%@"><span title=%@>%@</span></div>'.fmt("cw-text ellipsis",b,b));this.updateContentAreaImage(f,e.find(".cw-text"),CW.SectionedViewCellImageAnchor.TEXT_LEFT);this.didInsertContentAreaText(f,e)}}}},didRemoveContentAreaText:function(b,a){},didUpdateContentAreaText:function(b,a){},didInsertContentAreaText:function(b,a){},updateContentAreaDetailText:function(g,e){if(!g.didChangeFor("update","detailTextValue")){return}var c=g.get("detailTextValue"),b=e.find(".cw-content .cw-detail-text span"),f=!SC.empty(c);if(!f&&b.size()>0){b.remove();this.didRemoveContentAreaDetailText(g,e)}else{if(f&&b.size()>0){b.text(c);this.didUpdateContentAreaDetailText(g,e)}else{if(f){e.find(".cw-content").append('<div class="%@"><span>%@</span></div>'.fmt("cw-detail-text",c));this.updateContentAreaImage(g,e.find(".cw-detail-text"),CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT);this.didInsertContentAreaDetailText(g,e)}}}},didRemoveContentAreaDetailText:function(b,a){},didUpdateContentAreaDetailText:function(b,a){},didInsertContentAreaDetailText:function(b,a){},updateContentAreaImage:function(b,t,m){if(!b.didChangeFor("update","imageValue")){return}var p=b.get("imageValue"),o=t.find("."+CW.IMAGE_ANCHOR_CLASS_NAME),d=o.find(".cw-image"),l=SC.ImageView.valueIsUrl(p),n=!SC.empty(p);if(!n&&d.size()>0){d.remove();this.didRemoveContentAreaImage(b,t)}else{if(n&&d.size()>0){if(l){d.attr("src",p);d.attr("class","cw-image")}else{d.attr("src",SC.BLANK_IMAGE_URL);d.attr("class","cw-image %@".fmt(p))}this.didUpdateContentAreaImage(b,t)}else{if(n){var q=b.get("styleValue"),s=q.get("imageAnchor");if(o.size()===0&&m===s){o=t;o.addClass(s.get("classNames"))}if(l){o.prepend('<img class="cw-image" src="%@"/>'.fmt(p))}else{o.prepend('<img class="cw-image %@" src="%@"/>'.fmt(p,SC.BLANK_IMAGE_URL))}this.didInsertContentAreaImage(b,t)}}}},didRemoveContentAreaImage:function(b,a){},didUpdateContentAreaImage:function(b,a){},didInsertContentAreaImage:function(b,a){},updateAccessoryType:function(e,d){var f,a;a=e.get("accessoryTypeValue");d.setClass("cw-has-accessory-type",!!a);if(e.didChangeFor("update","accessoryTypeValue")){CW.SectionedViewCellAccessoryType.update(a,e,d)}if(e.didChangeFor("update","accessoryTypeButtonActive")){a=e.get("accessoryTypeValue");if(a){if(!f){f=d.find(".cw-accessory-type")}if(e.get("accessoryTypeButtonActive")){f.addClass("cw-active")}else{f.removeClass("cw-active")}}}}});SC.BaseTheme.sectionedViewCellRenderDelegate=CW.SectionedViewCellRenderDelegate.create();sc_require("sectioned_view/render_delegates/cell_render_delegate");CW.SectionedViewCollectionItemCellRenderDelegate=CW.SectionedViewCellRenderDelegate.extend({didRenderCellBody:function(f,e){var d=f.get("isSelectedItem");if(d){e.addClass("cw-selected-collection-item")}},didUpdateCellBody:function(f,e){var d=f.get("isSelectedItem");e.setClass("cw-selected-collection-item",!!d)}});SC.BaseTheme.sectionedViewCollectionItemCellRenderDelegate=CW.SectionedViewCollectionItemCellRenderDelegate.create();CW.SectionedViewRow=SC.Object.extend({owner:null,section:null,indexPath:null,cell:null,height:null,allowsSelection:YES,isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay(),content:null,selectedTarget:null,selectedAction:null,deselectedTarget:null,deselectedAction:null,accessoryButtonTappedTarget:null,accessoryButtonTappedAction:null,isBindingAgent:YES,isContent:function(){return !this.get("content")}.property("content").cacheable(),selected:function(e){var f=this.get("selectedTarget"),d=this.get("selectedAction");this.willRespondToSelectedAction(e);this.sendAction(e,f,d);this.didRespondToSelectedAction(e)},willRespondToSelectedAction:function(b){},didRespondToSelectedAction:function(b){},deselected:function(e){var f=this.get("deselectedTarget"),d=this.get("deselectedAction");this.willRespondToDeselectedAction(e);this.sendAction(e,f,d);this.didRespondToDeselectedAction(e)},willRespondToDeselectedAction:function(b){},didRespondToDeselectedAction:function(b){},accessoryButtonTapped:function(e){var f=this.get("accessoryButtonTappedTarget"),d=this.get("accessoryButtonTappedAction");this.willRespondToAccessoryButtonTappedAction(e);this.sendAction(e,f,d);this.didRespondToAccessoryButtonTappedAction(e)},willRespondToAccessoryButtonTappedAction:function(b){},didRespondToAccessoryButtonTappedAction:function(b){},sendAction:function(g,j,k){if(!k){return}var h=g.get("pane"),f=h.get("rootResponder");f.sendAction(k,j,this,h)}});sc_require("sectioned_view/views/sectioned_view_cell");sc_require("sectioned_view/rows/row");CW.SectionedViewButtonRow=CW.SectionedViewRow.extend({title:null,titleBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),isEnabled:YES,isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),cellStyle:null,cell:CW.SectionedViewCell.extend({style:CW.SectionedViewCellStyle.BUTTON,styleBinding:SC.Binding.transform(function(b){if(SC.none(b)){return CW.SectionedViewCellStyle.BUTTON}return b}).from("*owner.cellStyle"),contentTextKey:"title",performKeyEquivalent:function(g,h){if(!this.get("isVisibleInWindow")){return NO}if(!this.get("isEnabled")){return NO}var m=this.get("content"),k=m.get("isDefault"),l=m.get("selectedAction"),j=m.get("selectedTarget");if(k&&(g==="return")){m.sendAction(this.owner,j,l)}return NO}}),willRespondToSelectedAction:function(b){b.deselectRowAtIndexPath(this.get("indexPath"))}});sc_require("sectioned_view/views/sectioned_view_cell");sc_require("sectioned_view/rows/row");CW.SectionedViewDoubleLineRow=CW.SectionedViewRow.extend({height:50,title:null,titleBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),isEnabled:YES,cellStyle:null,cell:CW.SectionedViewCell.extend({style:CW.SectionedViewCellStyle.DOUBLE_LINE_ROW,contentTextKey:"title",})});sc_require("sectioned_view/rows/row");sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewSelectRow=CW.SectionedViewRow.extend({title:null,value:null,items:null,itemTitleKey:"title",itemImageKey:"image",itemValueKey:"value",style:CW.SectionedViewCellStyle.DEFAULT2,cell:CW.SectionedViewCell.extend({contentTextKey:"title",accessoryType:CW.SectionedViewCellAccessoryType.DISCLOSURE_INDICATOR}),_valueDidChange:function(){var o=this.get("value"),p=this.get("items"),s=p.length,m=this.get("itemTitleKey"),n=this.get("itemValueKey"),t=this.get("itemImageKey"),v=null,u;if(!n&&SC.typeOf(o)===SC.T_NUMBER&&o>=0&&o<s){v=p[o]}else{if(n){for(u=0;u<s;u+=1){if(p[u][n]===o){v=p[u];break}}}}var x=SC.typeOf(v),q=null,w=null;if(x===SC.T_HASH){q=v[m];w=v[t]}else{if(x===SC.T_OBJECT){q=v.get(m);w=v.get(t)}else{if(!SC.none(v)){q=v}}}this.beginPropertyChanges();this.set("detailText",q);this.set("image",w);this.endPropertyChanges()}.observes("value")});sc_require("sectioned_view/rows/row");sc_require("sectioned_view/mixins/switcher_accessory_view_support");CW.SectionedViewSwitcherRow=CW.SectionedViewRow.extend(CW.SwitcherAccessoryViewSupport,{title:null,value:null,allowsSelection:NO,cell:CW.SectionedViewCell.extend({contentTextKey:"title"})});sc_require("sectioned_view/rows/row");sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewTextFieldRow=CW.SectionedViewRow.extend({value:"",title:"",hint:"",hintBindingDefault:SC.Binding.oneWay(),isPassword:NO,isPasswordBindingDefault:SC.Binding.bool().oneWay(),spellCheckEnabled:NO,spellCheckEnabledBindingDefault:SC.Binding.bool().oneWay(),autoCorrect:YES,autoCorrectBindingDefault:SC.Binding.bool().oneWay(),autoCapitalize:YES,autoCapitalizeBindingDefault:SC.Binding.bool().oneWay(),type:"text",textBindingDefault:SC.Binding.oneWay(),layout:null,defaultLayout:{left:150,top:5,bottom:5,right:10},allowsSelection:NO,accessoryViewExample:SC.TextFieldView.extend({themeName:"iOS",hintBinding:SC.Binding.oneWay(".bindingAgent.hint"),isPasswordBinding:SC.Binding.oneWay(".bindingAgent.isPassword"),valueBinding:".bindingAgent.value",spellCheckEnabledBinding:SC.Binding.oneWay(".bindingAgent.spellCheckEnabled"),autoCorrectBinding:SC.Binding.oneWay(".bindingAgent.autoCorrect"),autoCapitalizeBinding:SC.Binding.oneWay(".bindingAgent.autoCapitalize")}),accessoryView:function(){var j=this.get("accessoryViewExample"),n=this.get("layout")||{},m=SC.clone(this.get("defaultLayout")),k=n.left,o=n.right,l=n.top,h=n.bottom;if(!SC.none(k)){m.left=k}if(!SC.none(o)){m.right=o}if(!SC.none(l)){m.top=l}if(!SC.none(h)){m.bottom=h}return j.extend({type:this.get("type"),layout:m})}.property("accessoryViewExample").cacheable()});sc_require("sectioned_view/views/sectioned_view_cell");sc_require("sectioned_view/rows/row");CW.SectionedViewWarningRow=CW.SectionedViewRow.extend({description:null,descriptionBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),cellStyle:null,cell:CW.SectionedViewCell.extend({style:CW.SectionedViewCellStyle.WARNING_ROW,contentTextKey:"description",})});CW.SectionedViewSection=SC.Object.extend({owner:null,index:0,rows:[],footerTitle:null,autoResizeFooterTitle:YES,headerTitle:null,autoResizeHeaderTitle:YES,footerView:null,headerView:null,footerHeight:null,headerHeight:null,allowsSelection:YES,isVisible:YES,isCellDisplayDelegate:YES,cell:null,init:function(){arguments.callee.base.apply(this,arguments);this.createRows()},rowForIndex:function(b){return this.get("rows").objectAt(b)},createRows:function(){var k=(this.get("rows")||[]).slice();for(var f=0,g=k.length;f<g;f+=1){var h=k[f],j=this.createRow(this[h],f);if(!j){throw'section has an invalid row "%@" for rows[%@]'.fmt(h,f)}k[f]=this[h]=j}this.set("rows",k)},createRow:function(g,h,e){e=e||{};if(SC.kindOf(g,CW.SectionedViewCoreCell)&&g.isClass){var f=g;g=CW.SectionedViewRow.extend({isContent:NO,cell:f})}else{if(!(SC.kindOf(g,CW.SectionedViewRow)&&g.isClass)){return null}}g=g.create(e,{owner:this.get("owner"),section:this,indexPath:CW.IndexPath.create({section:this.get("index"),row:h})});return g},destoryRows:function(){var b=this.get("rows")||[];b.forEach(function(a){a.destroy()},this);this.set("rows",[])},reload:function(){this.destoryRows();this.createRows();this.get("owner").reloadSection(this.get("index"))},displayDelegateForRow:function(b){return this.get("isDisplayDelegate")?this:null},sectionedViewWillSetupAllCells:function(b){},sectionedViewDidSetupAllCells:function(b){},sectionedViewWillTearDownAllCells:function(b){},sectionedViewDidTearDownAllCells:function(b){}});sc_require("sectioned_view/sections/section");sc_require("sectioned_view/rows/button_row");CW.SectionedViewButtonSection=CW.SectionedViewSection.extend({title:null,titleBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay(),isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),selectedTarget:null,selectedAction:null,buttonRow:CW.SectionedViewButtonRow,cellStyle:null,createRows:function(){var b=this.get("buttonRow");b=this.createRow(b,0,{titleBinding:".section.title",imageBinding:".section.image",isEnabledBinding:".section.isEnabled",isDefaultBinding:".section.isDefault",selectedTarget:this.get("selectedTarget"),selectedAction:this.get("selectedAction"),style:this.get("cellStyle")});this.beginPropertyChanges();this.set("rows",[b]);this.set("buttonRow",b);this.endPropertyChanges()}});sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewCollectionItemCell=CW.SectionedViewCell.extend({renderDelegateName:"sectionedViewCollectionItemCellRenderDelegate",isSelectedItem:NO,accessoryType:function(){var b=this.get("isSelectedItem");return b?CW.SectionedViewCellAccessoryType.DETAIL_CHECKMARK:null}.property("isSelectedItem"),displayProperties:"isSelectedItem".w()});sc_require("sectioned_view/sections/section");sc_require("sectioned_view/rows/row");sc_require("sectioned_view/views/sectioned_view_collection_item_cell");sc_require("sectioned_view/mixins/collection_section_delegate");CW.SectionedViewCollectionSection=CW.SectionedViewSection.extend(SC.DelegateSupport,CW.SVCollectionSectionDelegate,{content:null,selection:null,delegate:null,target:null,action:null,retainItemSelection:NO,itemsHeaderRow:null,itemsHeaderHeight:null,itemsHeaderCell:null,itemsFooterRow:null,itemsFooterCell:null,itemsFooterHeight:null,itemRowHeight:null,itemCellExample:CW.SectionedViewCollectionItemCell,retainedItemSelectionStyle:CW.SectionedViewCellSelectionStyle.BLUE,normalizedBasicItemValueKey:"text",hasItemsHeader:function(){return this.get("itemsHeaderRow")||this.get("itemsHeaderCell")}.property("itemsHeaderRow","itemsHeaderCell").cacheable(),hasItemsFooter:function(){return this.get("itemsFooterRow")||this.get("itemsFooterCell")}.property("itemsFooterRow","itemsFooterCell").cacheable(),collectionSectionDelegate:function(){var b=this.get("delegate");return this.delegateFor("isSVCollectionSectionDelegate",b)}.property("delegate").cacheable(),createRows:function(){var e=[],f=this._createItemRows(),g=this._createHeaderRow(),h=this._createFooterRow();if(g){e.push(g)}if(f){e.pushObjects(f)}if(h){e.push(h)}this._itemsHeaderRow=g;this._itemsFooterRow=h;this._itemRows=f;this.set("rows",e)},_createItemRows:function(){var l=[],n=this.get("content")||[],h=this.get("collectionSectionDelegate"),o=CW.SectionedViewCellSelectionStyle.NONE,j=CW.SectionedViewCollectionSection,m=j._ItemRow,k;if(this.get("retainItemSelection")){o=this.get("retainedItemSelectionStyle")}n.forEach(function(a,c){var d=h.collectionSectionCellForContentAtIndex(this,a,c);if(!d){d=this.get("itemCellExample")}var e=h.collectionSectionRowHeightForContentAtIndex(this,a,c);if(!e){e=this.get("itemRowHeight")}c+=this.get("hasItemsHeader")?1:0;var b=this._normalizeItem(a);b.set("selectionStyle",o);k=this.createRow(m,c,{content:b,cell:d,height:e});k._svcs_originalItem=a;l.push(k)},this);return l},_normalizeItem:function(f){var d=SC.typeOf(f);if(d===SC.T_OBJECT){return f}if(d===SC.T_HASH){return SC.Object.create(f)}var e={};e[this.get("normalizedBasicItemValueKey")]=f;return SC.Object.create(e)},_createHeaderRow:function(){var f=this.get("itemsHeaderRow"),d=this.get("itemsHeaderCell"),e=this.get("itemsHeaderHeight");if(d){f=CW.SectionedViewRow.extend({isContent:NO,cell:d,height:e})}else{if(!f){return null}}return this.createRow(f,0)},_createFooterRow:function(){var h=this.get("itemsFooterRow"),k=this.get("itemsFooterCell"),f=this.get("itemsFooterHeight");if(k){h=CW.SectionedViewRow.extend({isContent:NO,cell:k,height:f})}else{if(!h){return null}}var g=0,j=this.get("content")||[];if(this.get("hasItemsHeader")){g+=1}g+=j.get("length");return this.createRow(h,g)},_itemsDidChange:function(){this.reload();this._selectionDidChange()}.observes("*content.[]"),_selectionDidChange:function(){var e=this.get("owner"),h=this.get("selection"),f,g;g=this._selectedRow;if(g){f=e.cellForRowAtIndexPath(g.get("indexPath"));if(f){f.set("isSelectedItem",NO)}}g=this.rowForItem(h);if(g){f=e.cellForRowAtIndexPath(g.get("indexPath"));if(f){f.set("isSelectedItem",YES)}}this._selectedRow=g}.observes("selection"),rowForItem:function(h){var e=this.get("content")||[],g=this._itemRows||[],f=h?e.indexOf(h):-1;return f>=0?g[f]:null},selectItemRow:function(g){var f=this.get("owner"),h=this.get("target"),e=this.get("action");this.set("selection",g._svcs_originalItem);this.invokeLast(function(){g.sendAction(f,h,e)})},sectionedViewDidSetupAllCells:function(b){this._selectionDidChange()},displayDelegateForRow:function(b){b=this.rows[b];return this._itemRows.indexOf(b)>=0?this:null}});CW.SectionedViewCollectionSection._ItemRow=CW.SectionedViewRow.extend({selected:function(b){this.get("section").selectItemRow(this)}});var CW_ACTION_SHEET_BUTTON_HEIGHT=67;var CW_ACTION_SHEET_BOTTOM_PADDING=20;var CW_ACTION_SHEET_SIDE_MARGINS=10;var CW_ACTION_SHEET_TEXT_WIDTH=290;CW.ActionSheet=SC.View.extend(CW.Animatability,{classNames:"cw-action-sheet",actionSheetButtons:null,actionSheetMessage:null,actionSheetMessageEscaped:YES,childViews:["sheet"],sheetHeight:0,wantsAcceleratedLayer:YES,descriptionAction:null,sheet:SC.View.design(CW.Animatability,{classNames:"cw-actions"}),init:function(){arguments.callee.base.apply(this,arguments);var l,m;for(var n=0,j=this.actionSheetButtons.length;n<j;n++){m=this.actionSheetButtons[n];l=SC.ButtonView.create({themeName:m.themeName,target:m.target,action:m.action,title:m.title,layout:{left:CW_ACTION_SHEET_SIDE_MARGINS,right:CW_ACTION_SHEET_SIDE_MARGINS,height:46,bottom:CW_ACTION_SHEET_BUTTON_HEIGHT*(j-n-1)+CW_ACTION_SHEET_BOTTOM_PADDING}});this.sheet.appendChild(l)}var k=SC.heightForString(this.actionSheetMessage,CW_ACTION_SHEET_TEXT_WIDTH,null,"atv3 iOS sc-label-view sc-small-size".w(),!this.actionSheetMessageEscaped);var h=SC.LabelView.create({layout:{top:15,height:k,left:CW_ACTION_SHEET_SIDE_MARGINS,right:CW_ACTION_SHEET_SIDE_MARGINS},controlSize:SC.SMALL_CONTROL_SIZE,textAlign:SC.ALIGN_CENTER,escapeHTMLBinding:"*parentView.parentView.actionSheetMessageEscaped",valueBinding:"*parentView.parentView.actionSheetMessage"});this.sheet.appendChild(h);var o=j*CW_ACTION_SHEET_BUTTON_HEIGHT+CW_ACTION_SHEET_BOTTOM_PADDING+(15+k);this.sheet.set("layout",{right:0,left:0,bottom:-o,height:o})}});sc_require("views/action_sheet");CW.ActionSheetSupport={actionSheetClass:CW.ActionSheet,_currentActionSheet:null,_previousLeftBarButtonState:null,_previousRightBarButtonState:null,animationDuration:350,actionSheetHeight:null,showActionSheet:function(){this._currentActionSheet=this.actionSheetClass.create();this.childViews[0].appendChild(this._currentActionSheet);var d=this._currentActionSheet,c=d.childViews[0];this.set("actionSheetHeight",d.sheet.layout.height);this._disableNavigationButtons();if(!SC.browser.msie){d.animate({opacity:{to:1,from:0,duration:this.animationDuration}})}c.animate({bottom:{to:0,duration:this.animationDuration}})},hideActionSheet:function(){var e=this._currentActionSheet;if(SC.none(e)){return}var f=e.childViews[0];this._enableNavigationButtons();if(!SC.browser.msie){e.animate({opacity:{to:0,from:1,duration:this.animationDuration}})}var d=this;f.animate({bottom:{to:-f.get("layout").height,duration:this.animationDuration}},{notifyThatIJustFinished:function(){d.childViews[0].removeChild(e);d._currentActionSheet=null;e.destroy()}.listens("finish")})},_disableNavigationButtons:function(){var d=this.getPath("navigationController.viewStack"),c=d[d.length-1];c.set("realLeftBarButtonIsEnabled",NO);c.set("realHasLeftBarButton",NO);c.set("realRightBarButtonIsEnabled",NO);c.set("realHasRightBarButton",NO)},_enableNavigationButtons:function(){var d=this.getPath("navigationController.viewStack"),c=d[d.length-1];c.set("realLeftBarButtonIsEnabled",YES);c.set("realHasLeftBarButton",YES);c.set("realRightBarButtonIsEnabled",YES);c.set("realHasRightBarButton",YES)}};CW.BorderView=SC.View.extend({classNames:"cw-border-view",renderDelegateName:"borderRenderDelegate"});CW.BUTTON1_STATUS="button1";CW.BUTTON2_STATUS="button2";CW.iOSAlert=SC.PanelPane.extend(CW.SpritePreloadEnforcement,{classNames:"ios-alert".w(),message:"",description:null,extraView:null,extraViewPaddingTop:-2,extraViewPaddingBottom:0,shouldOptimizeMessageLineWidth:YES,shouldOptimizeDescriptionLineWidth:YES,escapeHTML:NO,modalPane:SC.ModalPane.extend(CW.Animatability,CW.PaneFadingSupport,{classNames:"ios-modal".w(),paneFadeInDuration:!SC.browser.webkit?350:function(){return 350*(innerWidth<1983&&innerHeight<1983)}.property(),paneFadeOutDuration:function(){return this.get("paneFadeInDuration")}.property(),paneOpacity:0.5,init:function(){if((SC.browser.webkit)&&(innerWidth>=1983||innerHeight>=1983)){this.classNames.push("no-gpu")}arguments.callee.base.apply(this,arguments);var e=SC.RootResponder.responder.mainPane;if(e){var d=e.layout.minWidth,f=e.layout.minHeight;if(d){this.adjust("minWidth",d)}if(f){this.adjust("minHeight",f)}}}}),delegate:null,layout:{centerX:0,width:262},buttons:["OK"],buttonMixin:{themeName:"popupAlertSheet",localize:YES,action:"dismiss"},init:function(){if(!this.hasOwnProperty("buttons")){this.buttons=SC.clone(this.buttons)}arguments.callee.base.apply(this,arguments)},append:function(){var d=this,f=arguments.callee.base,e=arguments;SC.run(function(){f.apply(d,arguments)})},contentView:SC.View.extend({layout:{left:0,right:0,top:0,bottom:0},childViews:["buttons"],buttons:SC.View.extend({layout:{left:0,right:0,bottom:0}}),render:function(f){var g=this.get("pane"),h=g.get("message"),e=g.get("description");if(g.get("escapeHTML")){h=SC.RenderContext.escapeHTML(h);if(e){e=SC.RenderContext.escapeHTML(e)}}f.push('<div class="title-label" role="heading">'+h+"</div>"+(e?'<div class="description">'+e+"</div>":""))},update:function(){var l=this.get("pane");var p=this.generateButtonsIfNeeded(),m=this.performTextLayoutIfNeeded(),q=this.prepareExtraViewIfNeeded(),j=this._extraView,k=Math.max(this._minHeight,p+m+q),o,n;if(j){o=m;n=k-q-p;j.adjust("top",Math.round((o+n)/2)+l.get("extraViewPaddingTop"))}l.adjust("height",k)},didCreateLayer:function(){this._message=this.$(".title-label")[0];this._description=this.$(".description")[0];this.invokeLast("update")},_messagePadding:{top:10,bottom:7,left:8,right:8},_descriptionPadding:{top:3,bottom:7,left:8,right:8},_buttonsPaddingTop:7,_buttonSpacing:6,_buttonGapRoom:12,_minHeight:119,performTextLayoutIfNeeded:function(){if(this._textLayout){return this._textLayout.totalHeight}var t=this._textLayout||(this._textLayout={messageStyle:{},descriptionStyle:{}}),s=t.messageStyle,m=this._message,o=this._messagePadding,q=t.descriptionStyle,n=this._description,u=this._descriptionPadding,v=this.get("pane"),w=v.get("frame").width,p,x;if(v.get("shouldOptimizeMessageLineWidth")){p=SC.bestStringMetricsForMaxWidth(m.innerHTML,w-o.left-o.right,m,null,true)}else{m.style.maxWidth=w-o.left-o.right+"px";p=SC.metricsForString(m.innerHTML,m,null,true)}s.top=o.top;s.width=p.width;s.height=p.height;s.marginLeft=Math.round(p.width/-2);t.totalHeight=s.top+s.height+o.bottom;for(x in s){s[x]+="px"}if(n){if(v.get("shouldOptimizeDescriptionLineWidth")){p=SC.bestStringMetricsForMaxWidth(n.innerHTML,w-u.left-u.right,n,null,true)}else{n.style.maxWidth=w-u.left-u.right+"px";p=SC.metricsForString(n.innerHTML,n,null,true)}q.top=t.totalHeight+u.top;q.width=p.width;q.height=p.height;q.marginLeft=Math.round(p.width/-2);t.totalHeight=q.top+q.height+u.bottom;for(x in q){q[x]+="px"}}SC.mixin(m.style,s);if(n){SC.mixin(n.style,q)}return t.totalHeight},generateButtonsIfNeeded:function(){if(this._areButtonsGenerated){return this._buttonsHeight}var E=this.get("pane"),t=this.get("buttons"),v=E.get("buttons"),s=E.get("buttonMixin"),u=CW.IOSBIG_BUTTON_REGULAR_HEIGHT,w=this._buttonSpacing,G=E.get("frame").width,D=v.length,x=D===2,q=0,z,F,B,C,y;for(B=0;C=v[B];B++){if(typeof C==="string"){v[B]={title:C}}}if(D===1&&(z=v[0])&&z.isDefault===undefined&&z.isCancel===undefined){z.isDefault=YES;z.isCancel=YES}if(x&&(z=v[0])&&(F=v[1])&&z.isDefault===undefined&&z.isCancel===undefined&&F.isDefault===undefined&&F.isCancel===undefined){z.isCancel=F.isDefault=YES}for(B=0;C=v[B];B++){if(D>2&&B>0&&C.isGapped){q+=this._buttonGapRoom}if(x&&B===0){y={left:0,right:Math.round(G/2+2),top:0,height:u}}else{if(x&&B===1){y={left:Math.round(G/2+2),right:0,top:0,height:u}}else{y={left:0,right:0,top:q,height:u}}}t.appendChild(v[B]=SC.ButtonView.create(s,C,SC.AutoResize,{shouldResizeWidth:NO,shouldAutoFitText:YES,layout:y,actionKey:CW["BUTTON"+(B+1)+"_STATUS"]||(CW["BUTTON"+(B+1)+"_STATUS"]="button"+(B+1))}));if(!x||B===0){q+=u+w}}q-=w;t.adjust("height",q);this._areButtonsGenerated=true;this._buttonsHeight=q+this._buttonsPaddingTop;return this._buttonsHeight},prepareExtraViewIfNeeded:function(){var j=this.get("pane");if(this._extraViewIsPrepared){return(this._extraView&&this._extraView.get("layout").height+j.get("extraViewPaddingTop")+j.get("extraViewPaddingBottom"))||0}this._extraViewIsPrepared=YES;var g=j.get("extraView"),m=this.get("frame").width,h,l,k;if(!g){return 0}if(g.isClass){j.set("extraView",g=g.create())}l=g.get("layout");if(typeof l.height==="number"){h=l.height}else{h=(k=g.get("frame")).height}if(typeof l.height!=="number"){SC.warn("The extraView provided to this iOSAlert did not have a recognizable height (in its layout, or in its frame). Ignoring the extraView.");j.set("extraView",null);return 0}if(g.get("parentView")!==this){g.removeFromParent();this.appendChild(g)}g.set("layout",{left:0,width:m,height:h});this.set("extraView",this._extraView=g);this._lastExtraViewHeight=h+j.get("extraViewPaddingTop")+j.get("extraViewPaddingBottom");return this._lastExtraViewHeight},extraViewFrameDidChange:function(){var d=this.getPath("extraView.frame"),f=this.get("pane"),e=(d&&d.height+f.get("extraViewPaddingTop")+f.get("extraViewPaddingBottom"))||0;if(this._lastExtraViewHeight===e){return}this._lastExtraViewHeight=e;this.update()}.observes("extraView.frame")}),repositionInWindow:function(){var d=this.get("frame").height,c=this.get("currentWindowSize");if(!c){SC.warn("currentWindowSize is not accessible from pane "+this+"! Aborting...");return}c=c.height;if(this._lastFHeight===d&&this._lastWHeight===c){return}this.adjust("top",Math.max(0,Math.round((c-d)/2.5)));this._lastFHeight=d;this._lastWHeight=c}.observes("frame","currentWindowSize"),dismiss:function(c){var d=this.delegate||this;if(d&&d.alertPaneDidDismiss){d.alertPaneDidDismiss(this,c&&c.get("actionKey"))}this.remove()}});CW.iOSAlert.show=function(s,v,C,I,H,G,u,w,D,x){var E;if(SC.typeOf(s)===SC.T_HASH){E=CW.iOSAlert.create(s);E.append();SC.run(function(){E.awake()});return E}var B=SC.A(arguments);var F=B[B.length-1],y=SC.typeOf(F);if(y===SC.T_OBJECT||y===SC.T_HASH){x=F}else{x=null}if(G&&!H){H=G;w=D;G=D=undefined}var z;if(H){z=[{title:H}]}if(G){z.push({title:G})}if(w!==undefined&&z[0]){z[0].isDefault=w}if(D!==undefined&&z[1]){z[1].isDefault=D}var t={message:s||"",description:v||null,escapeHTML:u||NO,delegate:x};!z||(t.buttons=z);E=this.create(t);E.append();SC.run(function(){E.awake()});return E};CW.NavigatableView=SC.View.extend(CW.Animatability,{isNavigatable:YES,navigationController:null,title:"",icon:null,escapeHTML:YES,navigationBarTheme:"iOS",hasLeftBarButton:YES,leftBarButtonTitle:" ",leftBarButtonIsEnabled:YES,leftBarButtonTheme:"navigationBarBlackOpaqueBack",leftBarButtonTarget:this,leftBarButtonAction:function(){this.getPath("parentView.parentView.navigationController").pop()},rightBarButtonTheme:"navigationBarDone",hasRightBarButton:NO,rightBarButtonTitle:" ",rightBarButtonIsEnabled:YES,rightBarButtonTarget:null,rightBarButtonAction:"",toolbarView:null,_realLeftBarButtonIsEnabled:null,showPopupButton:NO,menu:null,leftBarButtonIcon:null,rightBarButtonIcon:null,leftBarButtonControlSize:null,rightBarButtonControlSize:null,realLeftBarButtonIsEnabled:function(d,c){if(c!==undefined){if(c===NO){this._realLeftBarButtonIsEnabled=c}else{this._realLeftBarButtonIsEnabled=null}}return SC.none(this._realLeftBarButtonIsEnabled)?this.get("leftBarButtonIsEnabled"):this._realLeftBarButtonIsEnabled}.property("leftBarButtonIsEnabled"),_realRightBarButtonIsEnabled:null,realRightBarButtonIsEnabled:function(d,c){if(c!==undefined){if(c===NO){this._realRightBarButtonIsEnabled=c}else{this._realRightBarButtonIsEnabled=null}}return SC.none(this._realRightBarButtonIsEnabled)?this.get("rightBarButtonIsEnabled"):this._realRightBarButtonIsEnabled}.property("rightBarButtonIsEnabled"),_realHasLeftBarButton:null,realHasLeftBarButton:function(d,c){if(c!==undefined){if(c===NO){this._realHasLeftBarButton=c}else{this._realHasLeftBarButton=null}}return SC.none(this._realHasLeftBarButton)?this.get("hasLeftBarButton"):this._realHasLeftBarButton}.property("hasLeftBarButton"),_realHasRightBarButton:null,realHasRightBarButton:function(d,c){if(c!==undefined){if(c===NO){this._realHasRightBarButton=c}else{this._realHasRightBarButton=null}}return SC.none(this._realHasRightBarButton)?this.get("hasRightBarButton"):this._realHasRightBarButton}.property("hasRightBarButton")});sc_require("navigation_controller");CW.NavigationBarView=SC.View.extend(CW.Animatability,{classNames:["cw-navigation-bar"],themeNameBinding:".parentView.associatedView.navigationBarTheme",childViews:"barContainer".w(),barContainer:SC.View.design({childViews:"title popupButton leftBarButton rightBarButton".w(),classNames:"cw-bar-container".w(),layout:function(){var b=this.get("parentView");while(b){if(b.kindOf(CW.iOSPickerPane)){return{top:6,left:0}}b=b.get("parentView")}return{top:6,left:5,right:5}}.property(),title:SC.LabelView.design({classNames:["cw-navigation-bar-item","cw-navigation-bar-title"],textAlign:SC.ALIGN_CENTER,escapeHTMLBinding:".parentView.parentView.associatedView.escapeHTML",iconBinding:".parentView.parentView.associatedView.icon",valueBinding:".parentView.parentView.associatedView.title",ariaRole:"heading",isVisibleBinding:SC.Binding.not(".parentView.parentView.associatedView.showPopupButton"),}),popupButton:SC.View.design({classNames:["cw-navigation-bar-item","cw-navigation-bar-popup-view"],layout:{left:65,right:65},isVisibleBinding:".parentView.parentView.associatedView.showPopupButton",childViews:["button","arrow"],button:SC.PopupButtonView.design(SC.AutoResize,{classNames:["cw-navigation-bar-item","cw-navigation-bar-popup-button"],controlSize:SC.HUGE_CONTROL_SIZE,layout:{top:1,height:30},titleBinding:".parentView.parentView.parentView.associatedView.title",menuBinding:".parentView.parentView.parentView.associatedView.menu",render:function(a,b){arguments.callee.base.apply(this,arguments);if(b){this.adjust("maxWidth",this.getPath("parentView.frame.width"))}}}),arrow:SC.LabelView.design({classNames:["cw-navigation-bar-item","cw-navigation-bar-title"],layout:{width:17,height:30},value:"",mouseDown:function(){this.parentView.button.mouseDown()},touchStart:function(){this.mouseDown()}}),childViewsFrameDidChange:function(){var a=(this.getPath("frame.width")-this.getPath("button.frame.width"))/2;if(a==0){a=-3}else{a+=5}this.arrow.adjust("right",a)}.observes(".button.frame")}),leftBarButton:SC.ButtonView.design(SC.AutoResize,{layout:{top:1,left:0,height:30,width:60,minWidth:30,},autoResizePadding:8,classNames:["cw-navigation-bar-item"],themeNameBinding:".parentView.parentView.associatedView.leftBarButtonTheme",isVisibleBinding:".parentView.parentView.associatedView.realHasLeftBarButton",isEnabledBinding:".parentView.parentView.associatedView.realLeftBarButtonIsEnabled",titleBinding:".parentView.parentView.associatedView.leftBarButtonTitle",targetBinding:".parentView.parentView.associatedView.leftBarButtonTarget",actionBinding:".parentView.parentView.associatedView.leftBarButtonAction",maxWidthBinding:".parentView.parentView.associatedView.leftBarButtonMaxWidth",iconBinding:".parentView.parentView.associatedView.leftBarButtonIcon",controlSizeBinding:".parentView.parentView.associatedView.leftBarButtonControlSize",}),rightBarButton:SC.ButtonView.design(SC.AutoResize,{layout:{top:1,right:0,height:30,width:60,minWidth:30,},autoResizePadding:10,classNames:["cw-navigation-bar-item"],themeNameBinding:".parentView.parentView.associatedView.rightBarButtonTheme",isVisibleBinding:".parentView.parentView.associatedView.realHasRightBarButton",isEnabledBinding:".parentView.parentView.associatedView.realRightBarButtonIsEnabled",titleBinding:".parentView.parentView.associatedView.rightBarButtonTitle",targetBinding:".parentView.parentView.associatedView.rightBarButtonTarget",actionBinding:".parentView.parentView.associatedView.rightBarButtonAction",maxWidthBinding:".parentView.parentView.associatedView.rightBarButtonMaxWidth",iconBinding:".parentView.parentView.associatedView.rightBarButtonIcon",controlSizeBinding:".parentView.parentView.associatedView.rightBarButtonControlSize",}),didCreateLayer:function(c){if(c){c()}var d=this;this.invokeLater(function(){d.performLayout()})}.enhance(),performLayout:function(){var q=this.get("leftBarButton"),n=this.get("rightBarButton"),d=this.get("title"),v=this._computeRequiredButtonWidth(q),b=this._computeRequiredButtonWidth(n),u=this._computeRequiredTitleWidth(),m=this.getPath("parentView.frame.width"),s=CW.NavigationBarView.LEFT_BUTTON_PADDING,p=CW.NavigationBarView.RIGHT_BUTTON_PADDING,e=CW.NavigationBarView.TITLE_BUTTON_PADDING,o=u/2+s+e+v,t=u/2+p+e+b;d.set("layout",{left:s+e+Math.max(v,CW.NavigationBarView.MIN_TITLE_PADDING),right:p+e+Math.max(b,CW.NavigationBarView.MIN_TITLE_PADDING),centerX:0})},titleDidChange:function(){this.performLayout()}.observes("title.value"),_computeRequiredTitleWidth:function(){var c=this.get("title");if(SC.none(c)){return 0}var d=c.get("autoResizeLayer");if(SC.none(d)){return 0}return SC.metricsForString(c.get("value"),d,c.get("classNames"),c.get("escapeHTML")).width},_computeRequiredButtonWidth:function(b){if(SC.none(b)||(!b.get("isVisible"))){return 0}return b.getPath("frame.width")}})});CW.NavigationBarView.LEFT_BUTTON_PADDING=5;CW.NavigationBarView.RIGHT_BUTTON_PADDING=5;CW.NavigationBarView.TITLE_BUTTON_PADDING=5;CW.NavigationBarView.MIN_TITLE_PADDING=40;CW.NavigationView=SC.View.extend(CW.Animatability,{classNames:["cw-navigation-view"],navigationController:null,navigationBar:null,navigationBarHeight:44,actionSheetContent:null,contentView:null,wellViewClassType:CW.BorderView,init:function(){var d=this.get("navigationController"),c=this.get("contentView");d.set("navigationView",this);arguments.callee.base.apply(this,arguments)},createChildViews:function(){var f=this.get("wellViewClassType"),g=this.get("navigationBarHeight"),e={top:g,left:0,right:0,bottom:0};var h=this.createChildView(f,{layout:e,classNames:["cw-navigation-well"]});this.set("well",h);this.childViews=[h]},didCreateLayer:function(){this.invokeLast(function(){var b=this.get("contentView").create();this.get("navigationController").push(b,NO)})}});CW.PanelPane=SC.PanelPane.extend({classNames:"cw-panel-pane".w(),displayProperties:["hasTabBar","hasNavigationBar","isFullScreen"],hasTabBar:NO,hasNavigationBar:NO,renderDelegateName:"sheetPaneRenderDelegate",isFullScreen:NO,init:function(){if(CW.isMobile()){this.set("isFullScreen",YES)}if(this.get("isFullScreen")){this.layout={left:0,top:0,right:0,bottom:0};this.set("isModal",NO)}arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments)}});CW.TouchScrollerView=SC.TouchScrollerView.extend({touchScrollDidStart:function(){arguments.callee.base.apply(this,arguments);this.$(".thumb").css("opacity",0.5)},touchScrollDidEnd:function(){arguments.callee.base.apply(this,arguments);this.$(".thumb").css("opacity",0)}});SC.ScrollView.prototype.verticalTouchScrollerView=CW.TouchScrollerView;SC.ScrollView.prototype.horizontalTouchScrollerView=CW.TouchScrollerView;
/*!
 * Raphael 1.5.2 - JavaScript Vector Library
 *
 * Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 * Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */
(function(){function dz(){if(dz.is(arguments[0],dK)){var a=arguments[0],j=cI[dc](dz,a.splice(0,3+dz.is(a[0],dC))),f=j.set();for(var g=0,c=a[bK];g<c;g++){var h=a[g]||{};b7[c2](h.type)&&f[bS](j[h.type]().attr(h))}return f}return cI[dc](dz,arguments)}dz.version="1.5.2";var b5=/[, ]+/,b7={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},b9=/\{(\d+)\}/g,c6="prototype",c2="hasOwnProperty",de=document,dr=window,bL={was:Object[c6][c2].call(dr,"Raphael"),is:dr.Raphael},dg=function(){this.customAttributes={}},b,cc="appendChild",dc="apply",bX="concat",ci="createTouch" in de,ds="",dA=" ",da=String,cC="split",cp="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[cC](dA),b6={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},dk="join",bK="length",c1=da[c6].toLowerCase,cT=Math,bQ=cT.max,cg=cT.min,cR=cT.abs,cb=cT.pow,dv=cT.PI,dC="number",c4="string",dK="array",dR="toString",dN="fill",dn=Object[c6][dR],b1={},bS="push",bV=/^url\(['"]?([^\)]+?)['"]?\)$/i,cF=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,cS={"NaN":1,"Infinity":1,"-Infinity":1},b2=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,c8=cT.round,cK="setAttribute",cY=parseFloat,cn=parseInt,dM=" progid:DXImageTransform.Microsoft",b8=da[c6].toUpperCase,bM={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},cV={along:"along",blur:dC,"clip-rect":"csv",cx:dC,cy:dC,fill:"colour","fill-opacity":dC,"font-size":dC,height:dC,opacity:dC,path:"path",r:dC,rotation:"csv",rx:dC,ry:dC,scale:"csv",stroke:"colour","stroke-opacity":dC,"stroke-width":dC,translation:"csv",width:dC,x:dC,y:dC},b3="replace",cm=/^(from|to|\d+%?)$/,cq=/\s*,\s*/,bP={hs:1,rg:1},cv=/,?([achlmqrstvxz]),?/gi,dq=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,dB=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,dt=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,ca=function(a,c){return a.key-c.key};dz.type=(dr.SVGAngle||de.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(dz.type=="VML"){var cG=de.createElement("div"),dG;cG.innerHTML='<v:shape adj="1"/>';dG=cG.firstChild;dG.style.behavior="url(#default#VML)";if(!(dG&&typeof dG.adj=="object")){return dz.type=null}cG=null}dz.svg=!(dz.vml=dz.type=="VML");dg[c6]=dz[c6];b=dg[c6];dz._id=0;dz._oid=0;dz.fn={};dz.is=function(c,a){a=c1.call(a);if(a=="finite"){return !cS[c2](+c)}return(a=="null"&&c===null)||(a==typeof c)||(a=="object"&&c===Object(c))||(a=="array"&&Array.isArray&&Array.isArray(c))||dn.call(c).slice(8,-1).toLowerCase()==a};dz.angle=function(g,c,j,f,k,h){if(k==null){var a=g-j,l=c-f;if(!a&&!l){return 0}return((a<0)*180+cT.atan(-l/-a)*180/dv+360)%360}else{return dz.angle(g,c,k,h)-dz.angle(j,f,k,h)}};dz.rad=function(a){return a%360*dv/180};dz.deg=function(a){return a*180/dv%360};dz.snapTo=function(h,f,a){a=dz.is(a,"finite")?a:10;if(dz.is(h,dK)){var g=h.length;while(g--){if(cR(h[g]-f)<=a){return h[g]}}}else{h=+h;var c=f%h;if(c<a){return f-c}if(c>h-a){return f-c+h}}return f};function bT(){var c=[],a=0;for(;a<32;a++){c[a]=(~~(cT.random()*16))[dR](16)}c[12]=4;c[16]=((c[16]&3)|8)[dR](16);return"r-"+c[dk]("")}dz.setWindow=function(a){dr=a;de=dr.document};var cx=function(h){if(dz.vml){var c=/^\s+|\s+$/g;var f;try{var a=new ActiveXObject("htmlfile");a.write("<body>");a.close();f=a.body}catch(k){f=createPopup().document.body}var j=f.createTextRange();cx=dH(function(n){try{f.style.color=da(n)[b3](c,ds);var m=j.queryCommandValue("ForeColor");m=((m&255)<<16)|(m&65280)|((m&16711680)>>>16);return"#"+("000000"+m[dR](16)).slice(-6)}catch(l){return"none"}})}else{var g=de.createElement("i");g.title="Rapha\xebl Colour Picker";g.style.display="none";de.body[cc](g);cx=dH(function(l){g.style.color=l;return de.defaultView.getComputedStyle(g,ds).getPropertyValue("color")})}return cx(h)},dF=function(){return"hsb("+[this.h,this.s,this.b]+")"},cy=function(){return"hsl("+[this.h,this.s,this.l]+")"},cP=function(){return this.hex};dz.hsb2rgb=function(c,f,g,a){if(dz.is(c,"object")&&"h" in c&&"s" in c&&"b" in c){g=c.b;f=c.s;c=c.h;a=c.o}return dz.hsl2rgb(c,f,g/2,a)};dz.hsl2rgb=function(p,c,q,m){if(dz.is(p,"object")&&"h" in p&&"s" in p&&"l" in p){q=p.l;c=p.s;p=p.h}if(p>1||c>1||q>1){p/=360;c/=100;q/=100}var h={},l=["r","g","b"],o,j,a,n,k,g;if(!c){h={r:q,g:q,b:q}}else{if(q<0.5){o=q*(1+c)}else{o=q+c-q*c}j=2*q-o;for(var f=0;f<3;f++){a=p+1/3*-(f-1);a<0&&a++;a>1&&a--;if(a*6<1){h[l[f]]=j+(o-j)*6*a}else{if(a*2<1){h[l[f]]=o}else{if(a*3<2){h[l[f]]=j+(o-j)*(2/3-a)*6}else{h[l[f]]=j}}}}}h.r*=255;h.g*=255;h.b*=255;h.hex="#"+(16777216|h.b|(h.g<<8)|(h.r<<16)).toString(16).slice(1);dz.is(m,"finite")&&(h.opacity=m);h.toString=cP;return h};dz.rgb2hsb=function(m,k,j){if(k==null&&dz.is(m,"object")&&"r" in m&&"g" in m&&"b" in m){j=m.b;k=m.g;m=m.r}if(k==null&&dz.is(m,c4)){var f=dz.getRGB(m);m=f.r;k=f.g;j=f.b}if(m>1||k>1||j>1){m/=255;k/=255;j/=255}var l=bQ(m,k,j),h=cg(m,k,j),c,n,a=l;if(h==l){return{h:0,s:0,b:l,toString:dF}}else{var g=(l-h);n=g/l;if(m==l){c=(k-j)/g}else{if(k==l){c=2+((j-m)/g)}else{c=4+((m-k)/g)}}c/=6;c<0&&c++;c>1&&c--}return{h:c,s:n,b:a,toString:dF}};dz.rgb2hsl=function(l,j,m){if(j==null&&dz.is(l,"object")&&"r" in l&&"g" in l&&"b" in l){m=l.b;j=l.g;l=l.r}if(j==null&&dz.is(l,c4)){var f=dz.getRGB(l);l=f.r;j=f.g;m=f.b}if(l>1||j>1||m>1){l/=255;j/=255;m/=255}var a=bQ(l,j,m),o=cg(l,j,m),c,g,n=(a+o)/2,h;if(o==a){h={h:0,s:0,l:n}}else{var k=a-o;g=n<0.5?k/(a+o):k/(2-a-o);if(l==a){c=(j-m)/k}else{if(j==a){c=2+(m-l)/k}else{c=4+(l-j)/k}}c/=6;c<0&&c++;c>1&&c--;h={h:c,s:g,l:n}}h.toString=cy;return h};dz._path2string=function(){return this.join(",")[b3](cv,"$1")};function dH(c,g,a){function f(){var k=Array[c6].slice.call(arguments,0),h=k[dk]("\u25ba"),j=f.cache=f.cache||{},l=f.count=f.count||[];if(j[c2](h)){return a?a(j[h]):j[h]}l[bK]>=1000&&delete j[l.shift()];l[bS](h);j[h]=c[dc](g,k);return a?a(j[h]):j[h]}return f}dz.getRGB=dH(function(l){if(!l||!!((l=da(l)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1}}if(l=="none"){return{r:-1,g:-1,b:-1,hex:"none"}}!(bP[c2](l.toLowerCase().substring(0,2))||l.charAt()=="#")&&(l=cx(l));var c,j,g,k,m,f,h,a=l.match(cF);if(a){if(a[2]){k=cn(a[2].substring(5),16);g=cn(a[2].substring(3,5),16);j=cn(a[2].substring(1,3),16)}if(a[3]){k=cn((f=a[3].charAt(3))+f,16);g=cn((f=a[3].charAt(2))+f,16);j=cn((f=a[3].charAt(1))+f,16)}if(a[4]){h=a[4][cC](cq);j=cY(h[0]);h[0].slice(-1)=="%"&&(j*=2.55);g=cY(h[1]);h[1].slice(-1)=="%"&&(g*=2.55);k=cY(h[2]);h[2].slice(-1)=="%"&&(k*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(m=cY(h[3]));h[3]&&h[3].slice(-1)=="%"&&(m/=100)}if(a[5]){h=a[5][cC](cq);j=cY(h[0]);h[0].slice(-1)=="%"&&(j*=2.55);g=cY(h[1]);h[1].slice(-1)=="%"&&(g*=2.55);k=cY(h[2]);h[2].slice(-1)=="%"&&(k*=2.55);(h[0].slice(-3)=="deg"||h[0].slice(-1)=="\xb0")&&(j/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(m=cY(h[3]));h[3]&&h[3].slice(-1)=="%"&&(m/=100);return dz.hsb2rgb(j,g,k,m)}if(a[6]){h=a[6][cC](cq);j=cY(h[0]);h[0].slice(-1)=="%"&&(j*=2.55);g=cY(h[1]);h[1].slice(-1)=="%"&&(g*=2.55);k=cY(h[2]);h[2].slice(-1)=="%"&&(k*=2.55);(h[0].slice(-3)=="deg"||h[0].slice(-1)=="\xb0")&&(j/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(m=cY(h[3]));h[3]&&h[3].slice(-1)=="%"&&(m/=100);return dz.hsl2rgb(j,g,k,m)}a={r:j,g:g,b:k};a.hex="#"+(16777216|k|(g<<8)|(j<<16)).toString(16).slice(1);dz.is(m,"finite")&&(a.opacity=m);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},dz);dz.getColor=function(f){var c=this.getColor.start=this.getColor.start||{h:0,s:1,b:f||0.75},a=this.hsb2rgb(c.h,c.s,c.b);c.h+=0.075;if(c.h>1){c.h=0;c.s-=0.2;c.s<=0&&(this.getColor.start={h:0,s:1,b:c.b})}return a.hex};dz.getColor.reset=function(){delete this.start};dz.parsePathString=dH(function(a){if(!a){return null}var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},f=[];if(dz.is(a,dK)&&dz.is(a[0],dK)){f=dp(a)}if(!f[bK]){da(a)[b3](dq,function(j,k,l){var g=[],h=c1.call(k);l[b3](dB,function(m,n){n&&g[bS](+n)});if(h=="m"&&g[bK]>2){f[bS]([k][bX](g.splice(0,2)));h="l";k=k=="m"?"l":"L"}while(g[bK]>=c[h]){f[bS]([k][bX](g.splice(0,c[h])));if(!c[h]){break}}})}f[dR]=dz._path2string;return f});dz.findDotsAtSegment=function(y,z,f,j,w,c,u,v,n){var p=1-n,q=cb(p,3)*y+cb(p,2)*3*n*f+p*3*n*n*w+cb(n,3)*u,t=cb(p,3)*z+cb(p,2)*3*n*j+p*3*n*n*c+cb(n,3)*v,l=y+2*n*(f-y)+n*n*(w-2*f+y),m=z+2*n*(j-z)+n*n*(c-2*j+z),g=f+2*n*(w-f)+n*n*(u-2*w+f),k=j+2*n*(c-j)+n*n*(v-2*c+j),o=(1-n)*y+n*f,s=(1-n)*z+n*j,h=(1-n)*w+n*u,x=(1-n)*c+n*v,a=(90-cT.atan((l-g)/(m-k))*180/dv);(l>g||m<k)&&(a+=180);return{x:q,y:t,m:{x:l,y:m},n:{x:g,y:k},start:{x:o,y:s},end:{x:h,y:x},alpha:a}};var cZ=dH(function(f){if(!f){return{x:0,y:0,width:0,height:0}}f=ck(f);var k=0,m=0,o=[],l=[],j;for(var c=0,g=f[bK];c<g;c++){j=f[c];if(j[0]=="M"){k=j[1];m=j[2];o[bS](k);l[bS](m)}else{var a=dL(k,m,j[1],j[2],j[3],j[4],j[5],j[6]);o=o[bX](a.min.x,a.max.x);l=l[bX](a.min.y,a.max.y);k=j[5];m=j[6]}}var n=cg[dc](0,o),h=cg[dc](0,l);return{x:n,y:h,width:bQ[dc](0,o)-n,height:bQ[dc](0,l)-h}}),dp=function(c){var h=[];if(!dz.is(c,dK)||!dz.is(c&&c[0],dK)){c=dz.parsePathString(c)}for(var j=0,g=c[bK];j<g;j++){h[j]=[];for(var a=0,f=c[j][bK];a<f;a++){h[j][a]=c[j][a]}}h[dR]=dz._path2string;return h},cL=dH(function(u){if(!dz.is(u,dK)||!dz.is(u&&u[0],dK)){u=dz.parsePathString(u)}var m=[],k=0,l=0,c=0,g=0,o=0;if(u[0][0]=="M"){k=u[0][1];l=u[0][2];c=k;g=l;o++;m[bS](["M",k,l])}for(var s=o,a=u[bK];s<a;s++){var t=m[s]=[],j=u[s];if(j[0]!=c1.call(j[0])){t[0]=c1.call(j[0]);switch(t[0]){case"a":t[1]=j[1];t[2]=j[2];t[3]=j[3];t[4]=j[4];t[5]=j[5];t[6]=+(j[6]-k).toFixed(3);t[7]=+(j[7]-l).toFixed(3);break;case"v":t[1]=+(j[1]-l).toFixed(3);break;case"m":c=j[1];g=j[2];default:for(var f=1,q=j[bK];f<q;f++){t[f]=+(j[f]-((f%2)?k:l)).toFixed(3)}}}else{t=m[s]=[];if(j[0]=="m"){c=j[1]+k;g=j[2]+l}for(var h=0,p=j[bK];h<p;h++){m[s][h]=j[h]}}var n=m[s][bK];switch(m[s][0]){case"z":k=c;l=g;break;case"h":k+=+m[s][n-1];break;case"v":l+=+m[s][n-1];break;default:k+=+m[s][n-2];l+=+m[s][n-1]}}m[dR]=dz._path2string;return m},0,dp),e=dH(function(t){if(!dz.is(t,dK)||!dz.is(t&&t[0],dK)){t=dz.parsePathString(t)}var m=[],k=0,l=0,f=0,h=0,n=0;if(t[0][0]=="M"){k=+t[0][1];l=+t[0][2];f=k;h=l;n++;m[0]=["M",k,l]}for(var q=n,a=t[bK];q<a;q++){var s=m[q]=[],j=t[q];if(j[0]!=b8.call(j[0])){s[0]=b8.call(j[0]);switch(s[0]){case"A":s[1]=j[1];s[2]=j[2];s[3]=j[3];s[4]=j[4];s[5]=j[5];s[6]=+(j[6]+k);s[7]=+(j[7]+l);break;case"V":s[1]=+j[1]+l;break;case"H":s[1]=+j[1]+k;break;case"M":f=+j[1]+k;h=+j[2]+l;default:for(var c=1,p=j[bK];c<p;c++){s[c]=+j[c]+((c%2)?k:l)}}}else{for(var g=0,o=j[bK];g<o;g++){m[q][g]=j[g]}}switch(s[0]){case"Z":k=f;l=h;break;case"H":k=s[1];break;case"V":l=s[1];break;case"M":f=m[q][m[q][bK]-2];h=m[q][m[q][bK]-1];default:k=m[q][m[q][bK]-2];l=m[q][m[q][bK]-1]}}m[dR]=dz._path2string;return m},null,dp),c7=function(g,c,a,f){return[g,c,a,f,a,f]},ce=function(k,h,c,g,a,j){var f=1/3,l=2/3;return[f*k+l*c,f*h+l*g,f*a+l*c,f*j+l*g,a,j]},df=function(p,L,a,f,o,v,y,q,M,n){var g=dv*120/180,ab=dv/180*(+o||0),H=[],K,P=dH(function(ag,ad,ac){var ae=ag*cT.cos(ac)-ad*cT.sin(ac),af=ag*cT.sin(ac)+ad*cT.cos(ac);return{x:ae,y:af}});if(!n){K=P(p,L,-ab);p=K.x;L=K.y;K=P(q,M,-ab);q=K.x;M=K.y;var aa=cT.cos(dv/180*o),t=cT.sin(dv/180*o),F=(p-q)/2,G=(L-M)/2;var T=(F*F)/(a*a)+(G*G)/(f*f);if(T>1){T=cT.sqrt(T);a=T*a;f=T*f}var Z=a*a,B=f*f,Y=(v==y?-1:1)*cT.sqrt(cR((Z*B-Z*G*G-B*F*F)/(Z*G*G+B*F*F))),j=Y*a*G/f+(p+q)/2,l=Y*-f*F/a+(L+M)/2,w=cT.asin(((L-l)/f).toFixed(9)),x=cT.asin(((M-l)/f).toFixed(9));w=p<j?dv-w:w;x=q<j?dv-x:x;w<0&&(w=dv*2+w);x<0&&(x=dv*2+x);if(y&&w>x){w=w-dv*2}if(!y&&x>w){x=x-dv*2}}else{w=n[0];x=n[1];j=n[2];l=n[3]}var s=x-w;if(cR(s)>g){var h=x,c=q,u=M;x=w+g*(y&&x>w?1:-1);q=j+a*cT.cos(x);M=l+f*cT.sin(x);H=df(q,M,a,f,o,0,y,c,u,[x,h,j,l])}s=x-w;var k=cT.cos(w),N=cT.sin(w),m=cT.cos(x),O=cT.sin(x),D=cT.tan(s/4),z=4/3*a*D,C=4/3*f*D,Q=[p,L],U=[p+z*N,L-C*k],V=[q+z*O,M-C*m],X=[q,M];U[0]=2*Q[0]-U[0];U[1]=2*Q[1]-U[1];if(n){return[U,V,X][bX](H)}else{H=[U,V,X][bX](H)[dk]()[cC](",");var J=[];for(var W=0,I=H[bK];W<I;W++){J[W]=W%2?P(H[W-1],H[W],ab).y:P(H[W],H[W+1],ab).x}return J}},c9=function(k,m,n,h,g,j,l,a,f){var c=1-f;return{x:cb(c,3)*k+cb(c,2)*3*f*n+c*3*f*f*g+cb(f,3)*l,y:cb(c,3)*m+cb(c,2)*3*f*h+c*3*f*f*j+cb(f,3)*a}},dL=dH(function(u,s,h,j,a,c,k,n){var f=(a-2*h+u)-(k-2*a+h),l=2*(h-u)-2*(a-h),p=u-h,q=(-l+cT.sqrt(l*l-4*f*p))/2/f,t=(-l-cT.sqrt(l*l-4*f*p))/2/f,m=[s,n],g=[u,k],o;cR(q)>"1e12"&&(q=0.5);cR(t)>"1e12"&&(t=0.5);if(q>0&&q<1){o=c9(u,s,h,j,a,c,k,n,q);g[bS](o.x);m[bS](o.y)}if(t>0&&t<1){o=c9(u,s,h,j,a,c,k,n,t);g[bS](o.x);m[bS](o.y)}f=(c-2*j+s)-(n-2*c+j);l=2*(j-s)-2*(c-j);p=s-j;q=(-l+cT.sqrt(l*l-4*f*p))/2/f;t=(-l-cT.sqrt(l*l-4*f*p))/2/f;cR(q)>"1e12"&&(q=0.5);cR(t)>"1e12"&&(t=0.5);if(q>0&&q<1){o=c9(u,s,h,j,a,c,k,n,q);g[bS](o.x);m[bS](o.y)}if(t>0&&t<1){o=c9(u,s,h,j,a,c,k,n,t);g[bS](o.x);m[bS](o.y)}return{min:{x:cg[dc](0,g),y:cg[dc](0,m)},max:{x:bQ[dc](0,g),y:bQ[dc](0,m)}}}),ck=dH(function(a,l){var t=e(a),k=l&&e(l),j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f=function(v,u){var w,x;if(!v){return["C",u.x,u.y,u.x,u.y,u.x,u.y]}!(v[0] in {T:1,Q:1})&&(u.qx=u.qy=null);switch(v[0]){case"M":u.X=v[1];u.Y=v[2];break;case"A":v=["C"][bX](df[dc](0,[u.x,u.y][bX](v.slice(1))));break;case"S":w=u.x+(u.x-(u.bx||u.x));x=u.y+(u.y-(u.by||u.y));v=["C",w,x][bX](v.slice(1));break;case"T":u.qx=u.x+(u.x-(u.qx||u.x));u.qy=u.y+(u.y-(u.qy||u.y));v=["C"][bX](ce(u.x,u.y,u.qx,u.qy,v[1],v[2]));break;case"Q":u.qx=v[1];u.qy=v[2];v=["C"][bX](ce(u.x,u.y,v[1],v[2],v[3],v[4]));break;case"L":v=["C"][bX](c7(u.x,u.y,v[1],v[2]));break;case"H":v=["C"][bX](c7(u.x,u.y,v[1],u.y));break;case"V":v=["C"][bX](c7(u.x,u.y,u.x,v[1]));break;case"Z":v=["C"][bX](c7(u.x,u.y,u.X,u.Y));break}return v},p=function(w,v){if(w[v][bK]>7){w[v].shift();var u=w[v];while(u[bK]){w.splice(v++,0,["C"][bX](u.splice(0,6)))}w.splice(v,1);h=bQ(t[bK],k&&k[bK]||0)}},n=function(x,y,v,w,u){if(x&&y&&x[u][0]=="M"&&y[u][0]!="M"){y.splice(u,0,["M",w.x,w.y]);v.bx=0;v.by=0;v.x=x[u][1];v.y=x[u][2];h=bQ(t[bK],k&&k[bK]||0)}};for(var o=0,h=bQ(t[bK],k&&k[bK]||0);o<h;o++){t[o]=f(t[o],j);p(t,o);k&&(k[o]=f(k[o],s));k&&p(k,o);n(t,k,j,s,o);n(k,t,s,j,o);var q=t[o],c=k&&k[o],g=q[bK],m=k&&c[bK];j.x=q[g-2];j.y=q[g-1];j.bx=cY(q[g-4])||j.x;j.by=cY(q[g-3])||j.y;s.bx=k&&(cY(c[m-4])||s.x);s.by=k&&(cY(c[m-3])||s.y);s.x=k&&c[m-2];s.y=k&&c[m-1]}return k?[t,k]:t},null,dp),R=dH(function(g){var h=[];for(var a=0,f=g[bK];a<f;a++){var m={},k=g[a].match(/^([^:]*):?([\d\.]*)/);m.color=dz.getRGB(k[1]);if(m.color.error){return null}m.color=m.color.hex;k[2]&&(m.offset=k[2]+"%");h[bS](m)}for(a=1,f=h[bK]-1;a<f;a++){if(!h[a].offset){var j=cY(h[a-1].offset||0),n=0;for(var c=a+1;c<f;c++){if(h[c].offset){n=h[c].offset;break}}if(!n){n=100;c=f}n=cY(n);var l=(n-j)/(c-a+1);for(;a<c;a++){j+=l;h[a].offset=j+"%"}}}return h}),dy=function(a,c,g,f){var h;if(dz.is(a,c4)||dz.is(a,"object")){h=dz.is(a,c4)?de.getElementById(a):a;if(h.tagName){if(c==null){return{container:h,width:h.style.pixelWidth||h.offsetWidth,height:h.style.pixelHeight||h.offsetHeight}}else{return{container:h,width:c,height:g}}}}else{return{container:1,x:a,y:c,width:g,height:f}}},co=function(a,f){var g=this;for(var c in f){if(f[c2](c)&&!(c in a)){switch(typeof f[c]){case"function":(function(h){a[c]=a===g?h:function(){return h[dc](g,arguments)}})(f[c]);break;case"object":a[c]=a[c]||{};co.call(this,a[c],f[c]);break;default:a[c]=f[c];break}}}},dD=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},cW=function(a,c){if(c.top===a){return}dD(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a},bN=function(a,c){if(c.bottom===a){return}dD(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a},cB=function(f,a,c){dD(f,c);a==c.top&&(c.top=f);a.next&&(a.next.prev=f);f.next=a.next;f.prev=a;a.next=f},dw=function(f,a,c){dD(f,c);a==c.bottom&&(c.bottom=f);a.prev&&(a.prev.next=f);f.prev=a.prev;a.prev=f;f.next=a},d=function(a){return function(){throw new Error("Rapha\xebl: you are calling to method \u201c"+a+"\u201d of removed object")}};dz.pathToRelative=cL;if(dz.svg){b.svgns="http://www.w3.org/2000/svg";b.xlink="http://www.w3.org/1999/xlink";c8=function(a){return +a+(~~a===a)*0.5};var ch=function(c,a){if(a){for(var f in a){if(a[c2](f)){c[cK](f,da(a[f]))}}}else{c=de.createElementNS(b.svgns,c);c.style.webkitTapHighlightColor="rgba(0,0,0,0)";return c}};dz[dR]=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var E=function(a,c){var g=ch("path");c.canvas&&c.canvas[cc](g);var f=new dm(g,c);f.type="path";cU(f,{fill:"none",stroke:"#000",path:a});return f};var bW=function(u,f,t){var l="linear",q=0.5,g=0.5,a=u.style;f=da(f)[b3](dt,function(y,w,x){l="radial";if(w&&x){q=cY(w);g=cY(x);var v=((g>0.5)*2-1);cb(q-0.5,2)+cb(g-0.5,2)>0.25&&(g=cT.sqrt(0.25-cb(q-0.5,2))*v+0.5)&&g!=0.5&&(g=g.toFixed(5)-0.00001*v)}return ds});f=f[cC](/\s*\-\s*/);if(l=="linear"){var s=f.shift();s=-cY(s);if(isNaN(s)){return null}var j=[0,0,cT.cos(s*dv/180),cT.sin(s*dv/180)],h=1/(bQ(cR(j[2]),cR(j[3]))||1);j[2]*=h;j[3]*=h;if(j[2]<0){j[0]=-j[2];j[2]=0}if(j[3]<0){j[1]=-j[3];j[3]=0}}var m=R(f);if(!m){return null}var p=u.getAttribute(dN);p=p.match(/^url\(#(.*)\)$/);p&&t.defs.removeChild(de.getElementById(p[1]));var o=ch(l+"Gradient");o.id=bT();ch(o,l=="radial"?{fx:q,fy:g}:{x1:j[0],y1:j[1],x2:j[2],y2:j[3]});t.defs[cc](o);for(var n=0,c=m[bK];n<c;n++){var k=ch("stop");ch(k,{offset:m[n].offset?m[n].offset:!n?"0%":"100%","stop-color":m[n].color||"#fff"});o[cc](k)}ch(u,{fill:"url(#"+o.id+")",opacity:1,"fill-opacity":1});a.fill=ds;a.opacity=1;a.fillOpacity=1;return 1};var db=function(c){var a=c.getBBox();ch(c.pattern,{patternTransform:dz.format("translate({0},{1})",a.x,a.y)})};var cU=function(s,g){var o={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},m=s.node,q=s.attrs,v=s.rotate(),z=function(J,K){K=o[c1.call(K)];if(K){var G=J.attrs["stroke-width"]||"1",I={round:G,square:G,butt:0}[J.attrs["stroke-linecap"]||g["stroke-linecap"]]||0,F=[];var H=K[bK];while(H--){F[H]=K[H]*G+((H%2)?1:-1)*I}ch(m,{"stroke-dasharray":F[dk](",")})}};g[c2]("rotation")&&(v=g.rotation);var w=da(v)[cC](b5);if(!(w.length-1)){w=null}else{w[1]=+w[1];w[2]=+w[2]}cY(v)&&s.rotate(0,true);for(var n in g){if(g[c2](n)){if(!bM[c2](n)){continue}var p=g[n];q[n]=p;switch(n){case"blur":s.blur(p);break;case"rotation":s.rotate(p,true);break;case"href":case"title":case"target":var j=m.parentNode;if(c1.call(j.tagName)!="a"){var c=ch("a");j.insertBefore(c,m);c[cc](m);j=c}if(n=="target"&&p=="blank"){j.setAttributeNS(s.paper.xlink,"show","new")}else{j.setAttributeNS(s.paper.xlink,n,p)}break;case"cursor":m.style.cursor=p;break;case"clip-rect":var C=da(p)[cC](b5);if(C[bK]>=4){s.clip&&s.clip.parentNode.parentNode.removeChild(s.clip.parentNode);var B=ch("clipPath"),k=ch("rect");B.id=bT();ch(k,{x:C[0],y:C[1],width:C[2],height:C[3],r:C[4]||0,rx:C[4]||0,ry:C[4]||0});B[cc](k);s.paper.defs[cc](B);ch(m,{"clip-path":"url(#"+B.id+")"});s.clip=k}if(!p){var h=de.getElementById(m.getAttribute("clip-path")[b3](/(^url\(#|\)$)/g,ds));h&&h.parentNode.removeChild(h);ch(m,{"clip-path":ds});delete s.clip}break;case"path":if(s.type=="path"){ch(m,{d:p?q.path=e(p):"M0,0"})}break;case"width":m[cK](n,p);if(q.fx){n="x";p=q.x}else{break}case"x":if(q.fx){p=-q.x-(q.width||0)}case"rx":if(n=="rx"&&s.type=="rect"){break}case"cx":w&&(n=="x"||n=="cx")&&(w[1]+=p-q[n]);m[cK](n,p);s.pattern&&db(s);break;case"height":m[cK](n,p);if(q.fy){n="y";p=q.y}else{break}case"y":if(q.fy){p=-q.y-(q.height||0)}case"ry":if(n=="ry"&&s.type=="rect"){break}case"cy":w&&(n=="y"||n=="cy")&&(w[2]+=p-q[n]);m[cK](n,p);s.pattern&&db(s);break;case"r":if(s.type=="rect"){ch(m,{rx:p,ry:p})}else{m[cK](n,p)}break;case"src":if(s.type=="image"){m.setAttributeNS(s.paper.xlink,"href",p)}break;case"stroke-width":m.style.strokeWidth=p;m[cK](n,p);if(q["stroke-dasharray"]){z(s,q["stroke-dasharray"])}break;case"stroke-dasharray":z(s,p);break;case"translation":var y=da(p)[cC](b5);y[0]=+y[0]||0;y[1]=+y[1]||0;if(w){w[1]+=y[0];w[2]+=y[1]}cQ.call(s,y[0],y[1]);break;case"scale":y=da(p)[cC](b5);s.scale(+y[0]||1,+y[1]||+y[0]||1,isNaN(cY(y[2]))?null:+y[2],isNaN(cY(y[3]))?null:+y[3]);break;case dN:var a=da(p).match(bV);if(a){B=ch("pattern");var t=ch("image");B.id=bT();ch(B,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});ch(t,{x:0,y:0});t.setAttributeNS(s.paper.xlink,"href",a[1]);B[cc](t);var f=de.createElement("img");f.style.cssText="position:absolute;left:-9999em;top-9999em";f.onload=function(){ch(B,{width:this.offsetWidth,height:this.offsetHeight});ch(t,{width:this.offsetWidth,height:this.offsetHeight});de.body.removeChild(this);s.paper.safari()};de.body[cc](f);f.src=a[1];s.paper.defs[cc](B);m.style.fill="url(#"+B.id+")";ch(m,{fill:"url(#"+B.id+")"});s.pattern=B;s.pattern&&db(s);break}var l=dz.getRGB(p);if(!l.error){delete g.gradient;delete q.gradient;!dz.is(q.opacity,"undefined")&&dz.is(g.opacity,"undefined")&&ch(m,{opacity:q.opacity});!dz.is(q["fill-opacity"],"undefined")&&dz.is(g["fill-opacity"],"undefined")&&ch(m,{"fill-opacity":q["fill-opacity"]})}else{if((({circle:1,ellipse:1})[c2](s.type)||da(p).charAt()!="r")&&bW(m,p,s.paper)){q.gradient=p;q.fill="none";break}}l[c2]("opacity")&&ch(m,{"fill-opacity":l.opacity>1?l.opacity/100:l.opacity});case"stroke":l=dz.getRGB(p);m[cK](n,l.hex);n=="stroke"&&l[c2]("opacity")&&ch(m,{"stroke-opacity":l.opacity>1?l.opacity/100:l.opacity});break;case"gradient":(({circle:1,ellipse:1})[c2](s.type)||da(p).charAt()!="r")&&bW(m,p,s.paper);break;case"opacity":if(q.gradient&&!q[c2]("stroke-opacity")){ch(m,{"stroke-opacity":p>1?p/100:p})}case"fill-opacity":if(q.gradient){var D=de.getElementById(m.getAttribute(dN)[b3](/^url\(#|\)$/g,ds));if(D){var x=D.getElementsByTagName("stop");x[x[bK]-1][cK]("stop-opacity",p)}break}default:n=="font-size"&&(p=cn(p,10)+"px");var u=n[b3](/(\-.)/g,function(F){return b8.call(F.substring(1))});m.style[u]=p;m[cK](n,p);break}}}ct(s,g);if(w){s.rotate(w.join(dA))}else{cY(v)&&s.rotate(v,true)}};var bO=1.2,ct=function(n,o){if(n.type!="text"||!(o[c2]("text")||o[c2]("font")||o[c2]("font-size")||o[c2]("x")||o[c2]("y"))){return}var h=n.attrs,l=n.node,f=l.firstChild&&l.firstChild.style["font-size"]!==""?cn(de.defaultView.getComputedStyle(l.firstChild,ds).getPropertyValue("font-size"),10):cn(l.style["font-size"],10)||10;if(o[c2]("text")){h.text=o.text;while(l.firstChild){l.removeChild(l.firstChild)}var j=da(o.text)[cC]("\n");for(var c=0,g=j[bK];c<g;c++){if(j[c]){var m=ch("tspan");c&&ch(m,{dy:f*bO,x:h.x});m[cc](de.createTextNode(j[c]));l[cc](m)}}}else{j=l.getElementsByTagName("tspan");for(c=0,g=j[bK];c<g;c++){c&&ch(j[c],{dy:f*bO,x:h.x})}}ch(l,{y:h.y});var a=n.getBBox(),k=h.y-(a.y+a.height/2);k&&dz.is(k,"finite")&&ch(l,{y:h.y+k})},dm=function(g,a){var c=0,f=0;this[0]=g;this.id=dz._oid++;this.node=g;g.raphael=this;this.paper=a;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!a.bottom&&(a.bottom=this);this.prev=a.top;a.top&&(a.top.next=this);a.top=this;this.next=null};var cr=dm[c6];dm[c6].rotate=function(g,a,c){if(this.removed){return this}if(g==null){if(this._.rt.cx){return[this._.rt.deg,this._.rt.cx,this._.rt.cy][dk](dA)}return this._.rt.deg}var f=this.getBBox();g=da(g)[cC](b5);if(g[bK]-1){a=cY(g[1]);c=cY(g[2])}g=cY(g[0]);if(a!=null&&a!==false){this._.rt.deg=g}else{this._.rt.deg+=g}(c==null)&&(a=null);this._.rt.cx=a;this._.rt.cy=c;a=a==null?f.x+f.width/2:a;c=c==null?f.y+f.height/2:c;if(this._.rt.deg){this.transformations[0]=dz.format("rotate({0} {1} {2})",this._.rt.deg,a,c);this.clip&&ch(this.clip,{transform:dz.format("rotate({0} {1} {2})",-this._.rt.deg,a,c)})}else{this.transformations[0]=ds;this.clip&&ch(this.clip,{transform:ds})}ch(this.node,{transform:this.transformations[dk](dA)});return this};dm[c6].hide=function(){!this.removed&&(this.node.style.display="none");return this};dm[c6].show=function(){!this.removed&&(this.node.style.display="");return this};dm[c6].remove=function(){if(this.removed){return}dD(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this){delete this[a]}this.removed=true};dm[c6].getBBox=function(){if(this.removed){return this}if(this.type=="path"){return cZ(this.attrs.path)}if(this.node.style.display=="none"){this.show();var j=true}var c={};try{c=this.node.getBBox()}catch(g){}finally{c=c||{}}if(this.type=="text"){try{c={x:c.x,y:Infinity,width:0,height:0};for(var a=0,h=this.node.getNumberOfChars();a<h;a++){var f=this.node.getExtentOfChar(a);(f.y<c.y)&&(c.y=f.y);(f.y+f.height-c.y>c.height)&&(c.height=f.y+f.height-c.y);(f.x+f.width-c.x>c.width)&&(c.width=f.x+f.width-c.x)}}catch(g){}finally{c=c||{x:c.x,y:Infinity,width:0,height:0}}}j&&this.hide();return c};dm[c6].attr=function(n,j){if(this.removed){return this}if(n==null){var k={};for(var c in this.attrs){if(this.attrs[c2](c)){k[c]=this.attrs[c]}}this._.rt.deg&&(k.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(k.scale=this.scale());k.gradient&&k.fill=="none"&&(k.fill=k.gradient)&&delete k.gradient;return k}if(j==null&&dz.is(n,c4)){if(n=="translation"){return cQ.call(this)}if(n=="rotation"){return this.rotate()}if(n=="scale"){return this.scale()}if(n==dN&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}return this.attrs[n]}if(j==null&&dz.is(n,dK)){var f={};for(var o=0,a=n.length;o<a;o++){f[n[o]]=this.attr(n[o])}return f}if(j!=null){var l={};l[n]=j}else{if(n!=null&&dz.is(n,"object")){l=n}}for(var g in this.paper.customAttributes){if(this.paper.customAttributes[c2](g)&&l[c2](g)&&dz.is(this.paper.customAttributes[g],"function")){var m=this.paper.customAttributes[g].apply(this,[][bX](l[g]));this.attrs[g]=l[g];for(var h in m){if(m[c2](h)){l[h]=m[h]}}}}cU(this,l);return this};dm[c6].toFront=function(){if(this.removed){return this}this.node.parentNode[cc](this.node);var a=this.paper;a.top!=this&&cW(this,a);return this};dm[c6].toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);bN(this,this.paper);var a=this.paper}return this};dm[c6].insertAfter=function(a){if(this.removed){return this}var c=a.node||a[a.length-1].node;if(c.nextSibling){c.parentNode.insertBefore(this.node,c.nextSibling)}else{c.parentNode[cc](this.node)}cB(this,a,this.paper);return this};dm[c6].insertBefore=function(a){if(this.removed){return this}var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,c);dw(this,a,this.paper);return this};dm[c6].blur=function(g){var a=this;if(+g!==0){var f=ch("filter"),c=ch("feGaussianBlur");a.attrs.blur=g;f.id=bT();ch(c,{stdDeviation:+g||1.5});f.appendChild(c);a.paper.defs.appendChild(f);a._blur=f;ch(a.node,{filter:"url(#"+f.id+")"})}else{if(a._blur){a._blur.parentNode.removeChild(a._blur);delete a._blur;delete a.attrs.blur}a.node.removeAttribute("filter")}};var c5=function(j,a,c,f){var g=ch("circle");j.canvas&&j.canvas[cc](g);var h=new dm(g,j);h.attrs={cx:a,cy:c,r:f,fill:"none",stroke:"#000"};h.type="circle";ch(g,h.attrs);return h},cs=function(j,c,l,k,f,a){var g=ch("rect");j.canvas&&j.canvas[cc](g);var h=new dm(g,j);h.attrs={x:c,y:l,width:k,height:f,r:a||0,rx:a||0,ry:a||0,fill:"none",stroke:"#000"};h.type="rect";ch(g,h.attrs);return h},dI=function(k,c,a,f,g){var h=ch("ellipse");k.canvas&&k.canvas[cc](h);var j=new dm(h,k);j.attrs={cx:c,cy:a,rx:f,ry:g,fill:"none",stroke:"#000"};j.type="ellipse";ch(h,j.attrs);return j},S=function(j,c,a,l,k,f){var g=ch("image");ch(g,{x:a,y:l,width:k,height:f,preserveAspectRatio:"none"});g.setAttributeNS(j.xlink,"href",c);j.canvas&&j.canvas[cc](g);var h=new dm(g,j);h.attrs={x:a,y:l,width:k,height:f,src:c};h.type="image";return h},cX=function(j,a,c,f){var g=ch("text");ch(g,{x:a,y:c,"text-anchor":"middle"});j.canvas&&j.canvas[cc](g);var h=new dm(g,j);h.attrs={x:a,y:c,"text-anchor":"middle",text:f,font:bM.font,"font-size":bM["font-size"],stroke:"none",fill:"#000"};h.type="text";cU(h,h.attrs);return h},dd=function(c,a){this.width=c||this.width;this.height=a||this.height;this.canvas[cK]("width",this.width);this.canvas[cK]("height",this.height);return this},cI=function(){var h=dy[dc](0,arguments),j=h&&h.container,k=h.x,c=h.y,g=h.width,a=h.height;if(!j){throw new Error("SVG container not found.")}var f=ch("svg");k=k||0;c=c||0;g=g||512;a=a||342;ch(f,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:g,height:a});if(j==1){f.style.cssText="position:absolute;left:"+k+"px;top:"+c+"px";de.body[cc](f)}else{if(j.firstChild){j.insertBefore(f,j.firstChild)}else{j[cc](f)}}j=new dg;j.width=g;j.height=a;j.canvas=f;co.call(j,j,dz.fn);j.clear();return j};b.clear=function(){var a=this.canvas;while(a.firstChild){a.removeChild(a.firstChild)}this.bottom=this.top=null;this.desc=ch("desc");a[cc](this.desc);a[cc](this.defs=ch("defs"))};b.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=d(a)}}}if(dz.vml){var cw={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},du=/([clmz]),?([^clmz]*)/gi,bU=/ progid:\S+Blur\([^\)]+\)/g,c3=/-?[^,\s-]+/g,dj=1000+dA+1000,a0=10,bJ={path:1,rect:1},cj=function(f){var k=/[ahqstv]/ig,j=e;da(f).match(k)&&(j=ck);k=/[clmz]/g;if(j==e&&!da(f).match(k)){var m=da(f)[b3](du,function(s,p,u){var q=[],v=c1.call(p)=="m",t=cw[p];u[b3](c3,function(w){if(v&&q[bK]==2){t+=q+cw[p=="m"?"l":"L"];q=[]}q[bS](c8(w*a0))});return t+q});return m}var h=j(f),l,n;m=[];for(var c=0,g=h[bK];c<g;c++){l=h[c];n=c1.call(h[c][0]);n=="z"&&(n="x");for(var o=1,a=l[bK];o<a;o++){n+=c8(l[o]*a0)+(o!=a-1?",":ds)}m[bS](n)}return m[dk](dA)};dz[dR]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};E=function(j,k){var f=cE("group");f.style.cssText="position:absolute;left:0;top:0;width:"+k.width+"px;height:"+k.height+"px";f.coordsize=k.coordsize;f.coordorigin=k.coordorigin;var g=cE("shape"),h=g.style;h.width=k.width+"px";h.height=k.height+"px";g.coordsize=dj;g.coordorigin=k.coordorigin;f[cc](g);var c=new dm(g,f,k),a={fill:"none",stroke:"#000"};j&&(a.path=j);c.type="path";c.path=[];c.Path=ds;cU(c,a);k.canvas[cc](f);return c};cU=function(u,m){u.attrs=u.attrs||{};var p=u.node,l=u.attrs,x=p.style,j,n=(m.x!=l.x||m.y!=l.y||m.width!=l.width||m.height!=l.height||m.r!=l.r)&&u.type=="rect",f=u;for(var w in m){if(m[c2](w)){l[w]=m[w]}}if(n){l.path=cN(l.x,l.y,l.width,l.height,l.r);u.X=l.x;u.Y=l.y;u.W=l.width;u.H=l.height}m.href&&(p.href=m.href);m.title&&(p.title=m.title);m.target&&(p.target=m.target);m.cursor&&(x.cursor=m.cursor);"blur" in m&&u.blur(m.blur);if(m.path&&u.type=="path"||n){p.path=cj(l.path)}if(m.rotation!=null){u.rotate(m.rotation,true)}if(m.translation){j=da(m.translation)[cC](b5);cQ.call(u,j[0],j[1]);if(u._.rt.cx!=null){u._.rt.cx+=+j[0];u._.rt.cy+=+j[1];u.setBox(u.attrs,j[0],j[1])}}if(m.scale){j=da(m.scale)[cC](b5);u.scale(+j[0]||1,+j[1]||+j[0]||1,+j[2]||null,+j[3]||null)}if("clip-rect" in m){var B=da(m["clip-rect"])[cC](b5);if(B[bK]>=4){B[2]=+B[2]+(+B[0]);B[3]=+B[3]+(+B[1]);if(!B[4]){B[4]=0}var v=p.clipRect||de.createElement("div"),g=v.style,a=p.parentNode;g.clip=dz.format("rect({1}px {2}px {3}px {0}px)",B);if(!p.clipRect){g.position="absolute";g.top=0;g.left=0;g.width=u.paper.width+"px";g.height=u.paper.height+"px";a.parentNode.insertBefore(v,a);v[cc](a);p.clipRect=v}}if(!m["clip-rect"]){p.clipRect&&(p.clipRect.style.clip=ds)}}if(u.type=="image"&&m.src){p.src=m.src}if(u.type=="image"&&m.opacity){p.filterOpacity=dM+".Alpha(opacity="+(m.opacity*100)+")";x.filter=(p.filterMatrix||ds)+(p.filterOpacity||ds)}m.font&&(x.font=m.font);m["font-family"]&&(x.fontFamily='"'+m["font-family"][cC](",")[0][b3](/^['"]+|['"]+$/g,ds)+'"');m["font-size"]&&(x.fontSize=m["font-size"]);m["font-weight"]&&(x.fontWeight=m["font-weight"]);m["font-style"]&&(x.fontStyle=m["font-style"]);if(m.opacity!=null||m["stroke-width"]!=null||m.fill!=null||m.stroke!=null||m["stroke-width"]!=null||m["stroke-opacity"]!=null||m["fill-opacity"]!=null||m["stroke-dasharray"]!=null||m["stroke-miterlimit"]!=null||m["stroke-linejoin"]!=null||m["stroke-linecap"]!=null){p=u.shape||p;var o=(p.getElementsByTagName(dN)&&p.getElementsByTagName(dN)[0]),k=false;!o&&(k=o=cE(dN));if("fill-opacity" in m||"opacity" in m){var z=((+l["fill-opacity"]+1||2)-1)*((+l.opacity+1||2)-1)*((+dz.getRGB(m.fill).o+1||2)-1);z=cg(bQ(z,0),1);o.opacity=z}m.fill&&(o.on=true);if(o.on==null||m.fill=="none"){o.on=false}if(o.on&&m.fill){var y=m.fill.match(bV);if(y){o.src=y[1];o.type="tile"}else{o.color=dz.getRGB(m.fill).hex;o.src=ds;o.type="solid";if(dz.getRGB(m.fill).error&&(f.type in {circle:1,ellipse:1}||da(m.fill).charAt()!="r")&&bW(f,m.fill)){l.fill="none";l.gradient=m.fill}}}k&&p[cc](o);var c=(p.getElementsByTagName("stroke")&&p.getElementsByTagName("stroke")[0]),h=false;!c&&(h=c=cE("stroke"));if((m.stroke&&m.stroke!="none")||m["stroke-width"]||m["stroke-opacity"]!=null||m["stroke-dasharray"]||m["stroke-miterlimit"]||m["stroke-linejoin"]||m["stroke-linecap"]){c.on=true}(m.stroke=="none"||c.on==null||m.stroke==0||m["stroke-width"]==0)&&(c.on=false);var q=dz.getRGB(m.stroke);c.on&&m.stroke&&(c.color=q.hex);z=((+l["stroke-opacity"]+1||2)-1)*((+l.opacity+1||2)-1)*((+q.o+1||2)-1);var t=(cY(m["stroke-width"])||1)*0.75;z=cg(bQ(z,0),1);m["stroke-width"]==null&&(t=l["stroke-width"]);m["stroke-width"]&&(c.weight=t);t&&t<1&&(z*=t)&&(c.weight=1);c.opacity=z;m["stroke-linejoin"]&&(c.joinstyle=m["stroke-linejoin"]||"miter");c.miterlimit=m["stroke-miterlimit"]||8;m["stroke-linecap"]&&(c.endcap=m["stroke-linecap"]=="butt"?"flat":m["stroke-linecap"]=="square"?"square":"round");if(m["stroke-dasharray"]){var s={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};c.dashstyle=s[c2](m["stroke-dasharray"])?s[m["stroke-dasharray"]]:ds}h&&p[cc](c)}if(f.type=="text"){x=f.paper.span.style;l.font&&(x.font=l.font);l["font-family"]&&(x.fontFamily=l["font-family"]);l["font-size"]&&(x.fontSize=l["font-size"]);l["font-weight"]&&(x.fontWeight=l["font-weight"]);l["font-style"]&&(x.fontStyle=l["font-style"]);f.node.string&&(f.paper.span.innerHTML=da(f.node.string)[b3](/</g,"&#60;")[b3](/&/g,"&#38;")[b3](/\n/g,"<br>"));f.W=l.w=f.paper.span.offsetWidth;f.H=l.h=f.paper.span.offsetHeight;f.X=l.x;f.Y=l.y+c8(f.H/2);switch(l["text-anchor"]){case"start":f.node.style["v-text-align"]="left";f.bbx=c8(f.W/2);break;case"end":f.node.style["v-text-align"]="right";f.bbx=-c8(f.W/2);break;default:f.node.style["v-text-align"]="center";break}}};bW=function(n,m){n.attrs=n.attrs||{};var k=n.attrs,g,c="linear",a=".5 .5";n.attrs.gradient=m;m=da(m)[b3](dt,function(q,p,s){c="radial";if(p&&s){p=cY(p);s=cY(s);cb(p-0.5,2)+cb(s-0.5,2)>0.25&&(s=cT.sqrt(0.25-cb(p-0.5,2))*((s>0.5)*2-1)+0.5);a=p+dA+s}return ds});m=m[cC](/\s*\-\s*/);if(c=="linear"){var l=m.shift();l=-cY(l);if(isNaN(l)){return null}}var o=R(m);if(!o){return null}n=n.shape||n.node;g=n.getElementsByTagName(dN)[0]||cE(dN);!g.parentNode&&n.appendChild(g);if(o[bK]){g.on=true;g.method="none";g.color=o[0].color;g.color2=o[o[bK]-1].color;var f=[];for(var j=0,h=o[bK];j<h;j++){o[j].offset&&f[bS](o[j].offset+dA+o[j].color)}g.colors&&(g.colors.value=f[bK]?f[dk]():"0% "+g.color);if(c=="radial"){g.type="gradientradial";g.focus="100%";g.focussize=a;g.focusposition=a}else{g.type="gradient";g.angle=(270-l)%360}}return 1};dm=function(g,c,a){var f=0,j=0,k=0,h=1;this[0]=g;this.id=dz._oid++;this.node=g;g.raphael=this;this.X=0;this.Y=0;this.attrs={};this.Group=c;this.paper=a;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!a.bottom&&(a.bottom=this);this.prev=a.top;a.top&&(a.top.next=this);a.top=this;this.next=null};cr=dm[c6];cr.rotate=function(f,a,c){if(this.removed){return this}if(f==null){if(this._.rt.cx){return[this._.rt.deg,this._.rt.cx,this._.rt.cy][dk](dA)}return this._.rt.deg}f=da(f)[cC](b5);if(f[bK]-1){a=cY(f[1]);c=cY(f[2])}f=cY(f[0]);if(a!=null){this._.rt.deg=f}else{this._.rt.deg+=f}c==null&&(a=null);this._.rt.cx=a;this._.rt.cy=c;this.setBox(this.attrs,a,c);this.Group.style.rotation=this._.rt.deg;return this};cr.setBox=function(t,g,n){if(this.removed){return this}var s=this.Group.style,f=(this.shape&&this.shape.style)||this.node.style;t=t||{};for(var q in t){if(t[c2](q)){this.attrs[q]=t[q]}}g=g||this._.rt.cx;n=n||this._.rt.cy;var l=this.attrs,h,j,c,m;switch(this.type){case"circle":h=l.cx-l.r;j=l.cy-l.r;c=m=l.r*2;break;case"ellipse":h=l.cx-l.rx;j=l.cy-l.ry;c=l.rx*2;m=l.ry*2;break;case"image":h=+l.x;j=+l.y;c=l.width||0;m=l.height||0;break;case"text":this.textpath.v=["m",c8(l.x),", ",c8(l.y-2),"l",c8(l.x)+1,", ",c8(l.y-2)][dk](ds);h=l.x-c8(this.W/2);j=l.y-this.H/2;c=this.W;m=this.H;break;case"rect":case"path":if(!this.attrs.path){h=0;j=0;c=this.paper.width;m=this.paper.height}else{var p=cZ(this.attrs.path);h=p.x;j=p.y;c=p.width;m=p.height}break;default:h=0;j=0;c=this.paper.width;m=this.paper.height;break}g=(g==null)?h+c/2:g;n=(n==null)?j+m/2:n;var o=g-this.paper.width/2,k=n-this.paper.height/2,a;s.left!=(a=o+"px")&&(s.left=a);s.top!=(a=k+"px")&&(s.top=a);this.X=bJ[c2](this.type)?-o:h;this.Y=bJ[c2](this.type)?-k:j;this.W=c;this.H=m;if(bJ[c2](this.type)){f.left!=(a=-o*a0+"px")&&(f.left=a);f.top!=(a=-k*a0+"px")&&(f.top=a)}else{if(this.type=="text"){f.left!=(a=-o+"px")&&(f.left=a);f.top!=(a=-k+"px")&&(f.top=a)}else{s.width!=(a=this.paper.width+"px")&&(s.width=a);s.height!=(a=this.paper.height+"px")&&(s.height=a);f.left!=(a=h-o+"px")&&(f.left=a);f.top!=(a=j-k+"px")&&(f.top=a);f.width!=(a=c+"px")&&(f.width=a);f.height!=(a=m+"px")&&(f.height=a)}}};cr.hide=function(){!this.removed&&(this.Group.style.display="none");return this};cr.show=function(){!this.removed&&(this.Group.style.display="block");return this};cr.getBBox=function(){if(this.removed){return this}if(bJ[c2](this.type)){return cZ(this.attrs.path)}return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};cr.remove=function(){if(this.removed){return}dD(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){delete this[a]}this.removed=true};cr.attr=function(m,l){if(this.removed){return this}if(m==null){var a={};for(var n in this.attrs){if(this.attrs[c2](n)){a[n]=this.attrs[n]}}this._.rt.deg&&(a.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(a.scale=this.scale());a.gradient&&a.fill=="none"&&(a.fill=a.gradient)&&delete a.gradient;return a}if(l==null&&dz.is(m,"string")){if(m=="translation"){return cQ.call(this)}if(m=="rotation"){return this.rotate()}if(m=="scale"){return this.scale()}if(m==dN&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}return this.attrs[m]}if(this.attrs&&l==null&&dz.is(m,dK)){var f,h={};for(n=0,f=m[bK];n<f;n++){h[m[n]]=this.attr(m[n])}return h}var k;if(l!=null){k={};k[m]=l}l==null&&dz.is(m,"object")&&(k=m);if(k){for(var j in this.paper.customAttributes){if(this.paper.customAttributes[c2](j)&&k[c2](j)&&dz.is(this.paper.customAttributes[j],"function")){var c=this.paper.customAttributes[j].apply(this,[][bX](k[j]));this.attrs[j]=k[j];for(var g in c){if(c[c2](g)){k[g]=c[g]}}}}if(k.text&&this.type=="text"){this.node.string=k.text}cU(this,k);if(k.gradient&&(({circle:1,ellipse:1})[c2](this.type)||da(k.gradient).charAt()!="r")){bW(this,k.gradient)}(!bJ[c2](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this};cr.toFront=function(){!this.removed&&this.Group.parentNode[cc](this.Group);this.paper.top!=this&&cW(this,this.paper);return this};cr.toBack=function(){if(this.removed){return this}if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);bN(this,this.paper)}return this};cr.insertAfter=function(a){if(this.removed){return this}if(a.constructor==c0){a=a[a.length-1]}if(a.Group.nextSibling){a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling)}else{a.Group.parentNode[cc](this.Group)}cB(this,a,this.paper);return this};cr.insertBefore=function(a){if(this.removed){return this}if(a.constructor==c0){a=a[0]}a.Group.parentNode.insertBefore(this.Group,a.Group);dw(this,a,this.paper);return this};cr.blur=function(a){var f=this.node.runtimeStyle,c=f.filter;c=c.replace(bU,ds);if(+a!==0){this.attrs.blur=a;f.filter=c+dA+dM+".Blur(pixelradius="+(+a||1.5)+")";f.margin=dz.format("-{0}px 0 0 -{0}px",c8(+a||1.5))}else{f.filter=c;f.margin=0;delete this.attrs.blur}};c5=function(k,c,l,f){var g=cE("group"),a=cE("oval"),j=a.style;g.style.cssText="position:absolute;left:0;top:0;width:"+k.width+"px;height:"+k.height+"px";g.coordsize=dj;g.coordorigin=k.coordorigin;g[cc](a);var h=new dm(a,g,k);h.type="circle";cU(h,{stroke:"#000",fill:"none"});h.attrs.cx=c;h.attrs.cy=l;h.attrs.r=f;h.setBox({x:c-f,y:l-f,width:f*2,height:f*2});k.canvas[cc](g);return h};function cN(a,c,h,g,f){if(f){return dz.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+f,c,h-f*2,f,-f,g-f*2,f*2-h,f*2-g)}else{return dz.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,h,g,-h)}}cs=function(j,k,c,h,g,l){var f=cN(k,c,h,g,l),m=j.path(f),a=m.attrs;m.X=a.x=k;m.Y=a.y=c;m.W=a.width=h;m.H=a.height=g;a.r=l;a.path=f;m.type="rect";return m};dI=function(l,f,h,g,j){var c=cE("group"),m=cE("oval"),k=m.style;c.style.cssText="position:absolute;left:0;top:0;width:"+l.width+"px;height:"+l.height+"px";c.coordsize=dj;c.coordorigin=l.coordorigin;c[cc](m);var a=new dm(m,c,l);a.type="ellipse";cU(a,{stroke:"#000"});a.attrs.cx=f;a.attrs.cy=h;a.attrs.rx=g;a.attrs.ry=j;a.setBox({x:f-g,y:h-j,width:g*2,height:j*2});l.canvas[cc](c);return a};S=function(j,l,h,k,f,m){var c=cE("group"),g=cE("image");c.style.cssText="position:absolute;left:0;top:0;width:"+j.width+"px;height:"+j.height+"px";c.coordsize=dj;c.coordorigin=j.coordorigin;g.src=l;c[cc](g);var a=new dm(g,c,j);a.type="image";a.attrs.src=l;a.attrs.x=h;a.attrs.y=k;a.attrs.w=f;a.attrs.h=m;a.setBox({x:h,y:k,width:f,height:m});j.canvas[cc](c);return a};cX=function(l,j,k,g){var c=cE("group"),o=cE("shape"),m=o.style,f=cE("path"),n=f.style,h=cE("textpath");c.style.cssText="position:absolute;left:0;top:0;width:"+l.width+"px;height:"+l.height+"px";c.coordsize=dj;c.coordorigin=l.coordorigin;f.v=dz.format("m{0},{1}l{2},{1}",c8(j*10),c8(k*10),c8(j*10)+1);f.textpathok=true;m.width=l.width;m.height=l.height;h.string=da(g);h.on=true;o[cc](h);o[cc](f);c[cc](o);var a=new dm(h,c,l);a.shape=o;a.textpath=f;a.type="text";a.attrs.text=g;a.attrs.x=j;a.attrs.y=k;a.attrs.w=1;a.attrs.h=1;cU(a,{font:bM.font,stroke:"none",fill:"#000"});a.setBox();l.canvas[cc](c);return a};dd=function(c,a){var f=this.canvas.style;c==+c&&(c+="px");a==+a&&(a+="px");f.width=c;f.height=a;f.clip="rect(0 "+c+" "+a+" 0)";return this};var cE;de.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!de.namespaces.rvml&&de.namespaces.add("rvml","urn:schemas-microsoft-com:vml");cE=function(a){return de.createElement("<rvml:"+a+' class="rvml">')}}catch(cH){cE=function(a){return de.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}cI=function(){var h=dy[dc](0,arguments),m=h.container,g=h.height,f,k=h.width,j=h.x,l=h.y;if(!m){throw new Error("VML container not found.")}var c=new dg,a=c.canvas=de.createElement("div"),n=a.style;j=j||0;l=l||0;k=k||512;g=g||342;k==+k&&(k+="px");g==+g&&(g+="px");c.width=1000;c.height=1000;c.coordsize=a0*1000+dA+a0*1000;c.coordorigin="0 0";c.span=de.createElement("span");c.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";a[cc](c.span);n.cssText=dz.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",k,g);if(m==1){de.body[cc](a);n.left=j+"px";n.top=l+"px";n.position="absolute"}else{if(m.firstChild){m.insertBefore(a,m.firstChild)}else{m[cc](a)}}co.call(c,c,dz.fn);return c};b.clear=function(){this.canvas.innerHTML=ds;this.span=de.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas[cc](this.span);this.bottom=this.top=null};b.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=d(a)}return true}}var cl=navigator.userAgent.match(/Version\/(.*?)\s/);if((navigator.vendor=="Apple Computer, Inc.")&&(cl&&cl[1]<4||navigator.platform.slice(0,2)=="iP")){b.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});dr.setTimeout(function(){a.remove()})}}else{b.safari=function(){}}var cu=function(){this.returnValue=false},bZ=function(){return this.originalEvent.preventDefault()},dO=function(){this.cancelBubble=true},dE=function(){return this.originalEvent.stopPropagation()},cJ=(function(){if(de.addEventListener){return function(c,g,h,j){var a=ci&&b6[g]?b6[g]:g;var f=function(l){if(ci&&b6[c2](g)){for(var n=0,m=l.targetTouches&&l.targetTouches.length;n<m;n++){if(l.targetTouches[n].target==c){var k=l;l=l.targetTouches[n];l.originalEvent=k;l.preventDefault=bZ;l.stopPropagation=dE;break}}}return h.call(j,l)};c.addEventListener(a,f,false);return function(){c.removeEventListener(a,f,false);return true}}}else{if(de.attachEvent){return function(c,g,h,j){var f=function(k){k=k||dr.event;k.preventDefault=k.preventDefault||cu;k.stopPropagation=k.stopPropagation||dO;return h.call(j,k)};c.attachEvent("on"+g,f);var a=function(){c.detachEvent("on"+g,f);return true};return a}}}})(),dJ=[],b4=function(a){var h=a.clientX,k=a.clientY,g=de.documentElement.scrollTop||de.body.scrollTop,f=de.documentElement.scrollLeft||de.body.scrollLeft,l,j=dJ.length;while(j--){l=dJ[j];if(ci){var c=a.touches.length,m;while(c--){m=a.touches[c];if(m.identifier==l.el._drag.id){h=m.clientX;k=m.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}}else{a.preventDefault()}h+=f;k+=g;l.move&&l.move.call(l.move_scope||l.el,h-l.el._drag.x,k-l.el._drag.y,h,k,a)}},bY=function(c){dz.unmousemove(b4).unmouseup(bY);var f=dJ.length,a;while(f--){a=dJ[f];a.el._drag={};a.end&&a.end.call(a.end_scope||a.start_scope||a.move_scope||a.el,c)}dJ=[]};for(var cO=cp[bK];cO--;){(function(a){dz[a]=dm[c6][a]=function(c,f){if(dz.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:cJ(this.shape||this.node||de,a,c,f||this)})}return this};dz["un"+a]=dm[c6]["un"+a]=function(c){var f=this.events,g=f[bK];while(g--){if(f[g].name==a&&f[g].f==c){f[g].unbind();f.splice(g,1);!f.length&&delete this.events;return this}}return this}})(cp[cO])}cr.hover=function(c,a,f,g){return this.mouseover(c,f).mouseout(a,g||f)};cr.unhover=function(c,a){return this.unmouseover(c).unmouseout(a)};cr.drag=function(j,c,f,a,h,g){this._drag={};this.mousedown(function(m){(m.originalEvent||m).preventDefault();var k=de.documentElement.scrollTop||de.body.scrollTop,l=de.documentElement.scrollLeft||de.body.scrollLeft;this._drag.x=m.clientX+l;this._drag.y=m.clientY+k;this._drag.id=m.identifier;c&&c.call(h||a||this,m.clientX+l,m.clientY+k,m);!dJ.length&&dz.mousemove(b4).mouseup(bY);dJ.push({el:this,move:j,end:f,move_scope:a,start_scope:h,end_scope:g})});return this};cr.undrag=function(a,c,f){var g=dJ.length;while(g--){dJ[g].el==this&&(dJ[g].move==a&&dJ[g].end==f)&&dJ.splice(g++,1)}!dJ.length&&dz.unmousemove(b4).unmouseup(bY)};b.circle=function(a,c,f){return c5(this,a||0,c||0,f||0)};b.rect=function(a,c,h,g,f){return cs(this,a||0,c||0,h||0,g||0,f||0)};b.ellipse=function(a,c,f,g){return dI(this,a||0,c||0,f||0,g||0)};b.path=function(a){a&&!dz.is(a,c4)&&!dz.is(a[0],dK)&&(a+=ds);return E(dz.format[dc](dz,arguments),this)};b.image=function(f,a,c,h,g){return S(this,f||"about:blank",a||0,c||0,h||0,g||0)};b.text=function(a,c,f){return cX(this,a||0,c||0,da(f))};b.set=function(a){arguments[bK]>1&&(a=Array[c6].splice.call(arguments,0,arguments[bK]));return new c0(a)};b.setSize=dd;b.top=b.bottom=null;b.raphael=dz;function cM(){return this.x+dA+this.y}cr.resetScale=function(){if(this.removed){return this}this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};cr.scale=function(J,K,n,p){if(this.removed){return this}if(J==null&&K==null){return{x:this._.sx,y:this._.sy,toString:cM}}K=K||J;!+K&&(K=J);var Q,T,z,B,M=this.attrs;if(J!=0){var L=this.getBBox(),y=L.x+L.width/2,P=L.y+L.height/2,D=cR(J/this._.sx),F=cR(K/this._.sy);n=(+n||n==0)?n:y;p=(+p||p==0)?p:P;var v=this._.sx>0,w=this._.sy>0,o=~~(J/cR(J)),q=~~(K/cR(K)),k=D*o,m=F*q,I=this.node.style,a=n+cR(y-n)*k*(y>n==v?1:-1),c=p+cR(P-p)*m*(P>p==w?1:-1),h=(J*o>K*q?F:D);switch(this.type){case"rect":case"image":var t=M.width*D,g=M.height*F;this.attr({height:g,r:M.r*h,width:t,x:a-t/2,y:c-g/2});break;case"circle":case"ellipse":this.attr({rx:M.rx*D,ry:M.ry*F,r:M.r*h,cx:a,cy:c});break;case"text":this.attr({x:a,y:c});break;case"path":var G=cL(M.path),u=true,j=v?k:D,l=w?m:F;for(var N=0,f=G[bK];N<f;N++){var C=G[N],s=b8.call(C[0]);if(s=="M"&&u){continue}else{u=false}if(s=="A"){C[G[N][bK]-2]*=j;C[G[N][bK]-1]*=l;C[1]*=D;C[2]*=F;C[5]=+(o+q?!!+C[5]:!+C[5])}else{if(s=="H"){for(var O=1,x=C[bK];O<x;O++){C[O]*=j}}else{if(s=="V"){for(O=1,x=C[bK];O<x;O++){C[O]*=l}}else{for(O=1,x=C[bK];O<x;O++){C[O]*=(O%2)?j:l}}}}}var H=cZ(G);Q=a-H.x-H.width/2;T=c-H.y-H.height/2;G[0][1]+=Q;G[0][2]+=T;this.attr({path:G});break}if(this.type in {text:1,image:1}&&(o!=1||q!=1)){if(this.transformations){this.transformations[2]="scale("[bX](o,",",q,")");this.node[cK]("transform",this.transformations[dk](dA));Q=(o==-1)?-M.x-(t||0):M.x;T=(q==-1)?-M.y-(g||0):M.y;this.attr({x:Q,y:T});M.fx=o-1;M.fy=q-1}else{this.node.filterMatrix=dM+".Matrix(M11="[bX](o,", M12=0, M21=0, M22=",q,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");I.filter=(this.node.filterMatrix||ds)+(this.node.filterOpacity||ds)}}else{if(this.transformations){this.transformations[2]=ds;this.node[cK]("transform",this.transformations[dk](dA));M.fx=0;M.fy=0}else{this.node.filterMatrix=ds;I.filter=(this.node.filterMatrix||ds)+(this.node.filterOpacity||ds)}}M.scale=[J,K,n,p][dk](dA);this._.sx=J;this._.sy=K}return this};cr.clone=function(){if(this.removed){return null}var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};var dP={},bR=function(j,s,p,q,a,c,f,k,h){var l=0,m=100,v=[j,s,p,q,a,c,f,k].join(),u=dP[v],t,o;!u&&(dP[v]=u={data:[]});u.timer&&clearTimeout(u.timer);u.timer=setTimeout(function(){delete dP[v]},2000);if(h!=null){var g=bR(j,s,p,q,a,c,f,k);m=~~g*10}for(var n=0;n<m+1;n++){if(u.data[h]>n){o=u.data[n*m]}else{o=dz.findDotsAtSegment(j,s,p,q,a,c,f,k,n/m);u.data[n]=o}n&&(l+=cb(cb(t.x-o.x,2)+cb(t.y-o.y,2),0.5));if(h!=null&&l>=h){return o}t=o}if(h==null){return l}},dQ=function(a,c){return function(f,k,h){f=ck(f);var m,n,p,s,t="",g={},l,o=0;for(var q=0,j=f.length;q<j;q++){p=f[q];if(p[0]=="M"){m=+p[1];n=+p[2]}else{s=bR(m,n,p[1],p[2],p[3],p[4],p[5],p[6]);if(o+s>k){if(c&&!g.start){l=bR(m,n,p[1],p[2],p[3],p[4],p[5],p[6],k-o);t+=["C",l.start.x,l.start.y,l.m.x,l.m.y,l.x,l.y];if(h){return t}g.start=t;t=["M",l.x,l.y+"C",l.n.x,l.n.y,l.end.x,l.end.y,p[5],p[6]][dk]();o+=s;m=+p[5];n=+p[6];continue}if(!a&&!c){l=bR(m,n,p[1],p[2],p[3],p[4],p[5],p[6],k-o);return{x:l.x,y:l.y,alpha:l.alpha}}}o+=s;m=+p[5];n=+p[6]}t+=p}g.end=t;l=a?o:c?g:dz.findDotsAtSegment(m,n,p[1],p[2],p[3],p[4],p[5],p[6],1);l.alpha&&(l={x:l.x,y:l.y,alpha:l.alpha});return l}};var dx=dQ(1),cz=dQ(),cd=dQ(0,1);cr.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return dx(this.attrs.path)};cr.getPointAtLength=function(a){if(this.type!="path"){return}return cz(this.attrs.path,a)};cr.getSubpath=function(c,f){if(this.type!="path"){return}if(cR(this.getTotalLength()-f)<"1e-6"){return cd(this.attrs.path,c).end}var a=cd(this.attrs.path,f,1);return c?cd(a,c).end:a};dz.easing_formulas={linear:function(a){return a},"<":function(a){return cb(a,3)},">":function(a){return cb(a-1,3)+1},"<>":function(a){a=a*2;if(a<1){return cb(a,3)/2}a-=2;return(cb(a,3)+2)/2},backIn:function(c){var a=1.70158;return c*c*((a+1)*c-a)},backOut:function(c){c=c-1;var a=1.70158;return c*c*((a+1)*c+a)+1},elastic:function(c){if(c==0||c==1){return c}var f=0.3,a=f/4;return cb(2,-10*c)*cT.sin((c-a)*(2*dv)/f)+1},bounce:function(c){var g=7.5625,f=2.75,a;if(c<(1/f)){a=g*c*c}else{if(c<(2/f)){c-=(1.5/f);a=g*c*c+0.75}else{if(c<(2.5/f)){c-=(2.25/f);a=g*c*c+0.9375}else{c-=(2.625/f);a=g*c*c+0.984375}}}return a}};var cf=[],b0=function(){var y=+new Date;for(var m=0;m<cf[bK];m++){var f=cf[m];if(f.stop||f.el.removed){continue}var c=y-f.start,p=f.ms,q=f.easing,k=f.from,t=f.diff,B=f.to,u=f.t,z=f.el,s={},C;if(c<p){var l=q(c/p);for(var o in k){if(k[c2](o)){switch(cV[o]){case"along":C=l*p*t[o];B.back&&(C=B.len-C);var n=cz(B[o],C);z.translate(t.sx-t.x||0,t.sy-t.y||0);t.x=n.x;t.y=n.y;z.translate(n.x-t.sx,n.y-t.sy);B.rot&&z.rotate(t.r+n.alpha,n.x,n.y);break;case dC:C=+k[o]+l*p*t[o];break;case"colour":C="rgb("+[cA(c8(k[o].r+l*p*t[o].r)),cA(c8(k[o].g+l*p*t[o].g)),cA(c8(k[o].b+l*p*t[o].b))][dk](",")+")";break;case"path":C=[];for(var h=0,v=k[o][bK];h<v;h++){C[h]=[k[o][h][0]];for(var j=1,g=k[o][h][bK];j<g;j++){C[h][j]=+k[o][h][j]+l*p*t[o][h][j]}C[h]=C[h][dk](dA)}C=C[dk](dA);break;case"csv":switch(o){case"translation":var w=l*p*t[o][0]-u.x,x=l*p*t[o][1]-u.y;u.x+=w;u.y+=x;C=w+dA+x;break;case"rotation":C=+k[o][0]+l*p*t[o][0];k[o][1]&&(C+=","+k[o][1]+","+k[o][2]);break;case"scale":C=[+k[o][0]+l*p*t[o][0],+k[o][1]+l*p*t[o][1],(2 in B[o]?B[o][2]:ds),(3 in B[o]?B[o][3]:ds)][dk](dA);break;case"clip-rect":C=[];h=4;while(h--){C[h]=+k[o][h]+l*p*t[o][h]}break}break;default:var a=[].concat(k[o]);C=[];h=z.paper.customAttributes[o].length;while(h--){C[h]=+a[h]+l*p*t[o][h]}break}s[o]=C}}z.attr(s);z._run&&z._run.call(z)}else{if(B.along){n=cz(B.along,B.len*!B.back);z.translate(t.sx-(t.x||0)+n.x-t.sx,t.sy-(t.y||0)+n.y-t.sy);B.rot&&z.rotate(t.r+n.alpha,n.x,n.y)}(u.x||u.y)&&z.translate(-u.x,-u.y);B.scale&&(B.scale+=ds);z.attr(B);cf.splice(m--,1)}}dz.svg&&z&&z.paper&&z.paper.safari();cf[bK]&&setTimeout(b0)},dh=function(a,h,c,f,g){var j=c-f;h.timeouts.push(setTimeout(function(){dz.is(g,"function")&&g.call(h);h.animate(a,j,a.easing)},f))},cA=function(a){return bQ(cg(a,255),0)},cQ=function(a,c){if(a==null){return{x:this._.tx,y:this._.ty,toString:cM}}this._.tx+=+a;this._.ty+=+c;switch(this.type){case"circle":case"ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+a+this.attrs.x,y:+c+this.attrs.y});break;case"path":var f=cL(this.attrs.path);f[0][1]+=+a;f[0][2]+=+c;this.attr({path:f});break}return this};cr.animateWith=function(j,g,c,a,f){for(var k=0,h=cf.length;k<h;k++){if(cf[k].el.id==j.id){g.start=cf[k].start}}return this.animate(g,c,a,f)};cr.animateAlong=dl();cr.animateAlongBack=dl(1);function dl(a){return function(g,h,j,c){var f={back:a};dz.is(j,"function")?(c=j):(f.rot=j);g&&g.constructor==dm&&(g=g.attrs.path);g&&(f.along=g);return this.animate(f,h,c)}}function di(f,t,p,h,j,o){var n=3*t,k=3*(h-t)-n,s=1-n-k,q=3*p,l=3*(j-p)-q,a=1-q-l;function c(u){return((s*u+k)*u+n)*u}function m(w,u){var v=g(w,u);return((a*v+l)*v+q)*v}function g(w,x){var y,z,C,v,B,u;for(C=w,u=0;u<8;u++){v=c(C)-w;if(cR(v)<x){return C}B=(3*s*C+2*k)*C+n;if(cR(B)<0.000001){break}C=C-v/B}y=0;z=1;C=w;if(C<y){return y}if(C>z){return z}while(y<z){v=c(C);if(cR(v-w)<x){return C}if(w>v){y=C}else{z=C}C=(z-y)/2+y}return C}return m(f,1/(200*o))}cr.onAnimation=function(a){this._run=a||0;return this};cr.animate=function(g,t,u,c){var G=this;G.timeouts=G.timeouts||[];if(dz.is(u,"function")||!u){c=u||null}if(G.removed){c&&c.call(G);return G}var n={},F={},a=false,y={};for(var s in g){if(g[c2](s)){if(cV[c2](s)||G.paper.customAttributes[c2](s)){a=true;n[s]=G.attr(s);(n[s]==null)&&(n[s]=bM[s]);F[s]=g[s];switch(cV[s]){case"along":var j=dx(g[s]);var q=cz(g[s],j*!!g.back);var D=G.getBBox();y[s]=j/t;y.tx=D.x;y.ty=D.y;y.sx=q.x;y.sy=q.y;F.rot=g.rot;F.back=g.back;F.len=j;g.rot&&(y.r=cY(G.rotate())||0);break;case dC:y[s]=(F[s]-n[s])/t;break;case"colour":n[s]=dz.getRGB(n[s]);var p=dz.getRGB(F[s]);y[s]={r:(p.r-n[s].r)/t,g:(p.g-n[s].g)/t,b:(p.b-n[s].b)/t};break;case"path":var C=ck(n[s],F[s]);n[s]=C[0];var w=C[1];y[s]=[];for(var k=0,z=n[s][bK];k<z;k++){y[s][k]=[0];for(var l=1,h=n[s][k][bK];l<h;l++){y[s][k][l]=(w[k][l]-n[s][k][l])/t}}break;case"csv":var H=da(g[s])[cC](b5),B=da(n[s])[cC](b5);switch(s){case"translation":n[s]=[0,0];y[s]=[H[0]/t,H[1]/t];break;case"rotation":n[s]=(B[1]==H[1]&&B[2]==H[2])?B:[0,H[1],H[2]];y[s]=[(H[0]-n[s][0])/t,0,0];break;case"scale":g[s]=H;n[s]=da(n[s])[cC](b5);y[s]=[(H[0]-n[s][0])/t,(H[1]-n[s][1])/t,0,0];break;case"clip-rect":n[s]=da(n[s])[cC](b5);y[s]=[];k=4;while(k--){y[s][k]=(H[k]-n[s][k])/t}break}F[s]=H;break;default:H=[].concat(g[s]);B=[].concat(n[s]);y[s]=[];k=G.paper.customAttributes[s][bK];while(k--){y[s][k]=((H[k]||0)-(B[k]||0))/t}break}}}}if(!a){var v=[],o;for(var f in g){if(g[c2](f)&&cm.test(f)){s={value:g[f]};f=="from"&&(f=0);f=="to"&&(f=100);s.key=cn(f,10);v.push(s)}}v.sort(ca);if(v[0].key){v.unshift({key:0,value:G.attrs})}for(k=0,z=v[bK];k<z;k++){dh(v[k].value,G,t/100*v[k].key,t/100*(v[k-1]&&v[k-1].key||0),v[k-1]&&v[k-1].value.callback)}o=v[v[bK]-1].value.callback;if(o){G.timeouts.push(setTimeout(function(){o.call(G)},t))}}else{var m=dz.easing_formulas[u];if(!m){m=da(u).match(b2);if(m&&m[bK]==5){var x=m;m=function(I){return di(I,+x[1],+x[2],+x[3],+x[4],t)}}else{m=function(I){return I}}}cf.push({start:g.start||+new Date,ms:t,easing:m,from:n,diff:y,to:F,el:G,t:{x:0,y:0}});dz.is(c,"function")&&(G._ac=setTimeout(function(){c.call(G)},t));cf[bK]==1&&setTimeout(b0)}return this};cr.stop=function(){for(var a=0;a<cf.length;a++){cf[a].el.id==this.id&&cf.splice(a--,1)}for(a=0,ii=this.timeouts&&this.timeouts.length;a<ii;a++){clearTimeout(this.timeouts[a])}this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};cr.translate=function(a,c){return this.attr({translation:a+" "+c})};cr[dR]=function(){return"Rapha\xebl\u2019s object"};dz.ae=cf;var c0=function(a){this.items=[];this[bK]=0;this.type="set";if(a){for(var f=0,c=a[bK];f<c;f++){if(a[f]&&(a[f].constructor==dm||a[f].constructor==c0)){this[this.items[bK]]=this.items[this.items[bK]]=a[f];this[bK]++}}}};c0[c6][bS]=function(){var c,a;for(var g=0,f=arguments[bK];g<f;g++){c=arguments[g];if(c&&(c.constructor==dm||c.constructor==c0)){a=this.items[bK];this[a]=this.items[a]=c;this[bK]++}}return this};c0[c6].pop=function(){delete this[this[bK]--];return this.items.pop()};for(var cD in cr){if(cr[c2](cD)){c0[c6][cD]=(function(a){return function(){for(var f=0,c=this.items[bK];f<c;f++){this.items[f][a][dc](this.items[f],arguments)}return this}})(cD)}}c0[c6].attr=function(j,c){if(j&&dz.is(j,dK)&&dz.is(j[0],"object")){for(var a=0,f=j[bK];a<f;a++){this.items[a].attr(j[a])}}else{for(var h=0,g=this.items[bK];h<g;h++){this.items[h].attr(j,c)}}return this};c0[c6].animate=function(j,l,a,h){(dz.is(a,"function")||!a)&&(h=a||null);var c=this.items[bK],g=c,f,k=this,m;h&&(m=function(){!--c&&h.call(k)});a=dz.is(a,c4)?a:m;f=this.items[--g].animate(j,l,a,m);while(g--){this.items[g]&&!this.items[g].removed&&this.items[g].animateWith(f,j,l,a,m)}return this};c0[c6].insertAfter=function(c){var a=this.items[bK];while(a--){this.items[a].insertAfter(c)}return this};c0[c6].getBBox=function(){var a=[],c=[],j=[],g=[];for(var h=this.items[bK];h--;){var f=this.items[h].getBBox();a[bS](f.x);c[bS](f.y);j[bS](f.x+f.width);g[bS](f.y+f.height)}a=cg[dc](0,a);c=cg[dc](0,c);return{x:a,y:c,width:bQ[dc](0,j)-a,height:bQ[dc](0,g)-c}};c0[c6].clone=function(c){c=new c0;for(var a=0,f=this.items[bK];a<f;a++){c[bS](this.items[a].clone())}return c};dz.registerFont=function(k){if(!k.face){return k}this.fonts=this.fonts||{};var h={w:k.w,face:{},glyphs:{}},j=k.face["font-family"];for(var c in k.face){if(k.face[c2](c)){h.face[c]=k.face[c]}}if(this.fonts[j]){this.fonts[j][bS](h)}else{this.fonts[j]=[h]}if(!k.svg){h.face["units-per-em"]=cn(k.face["units-per-em"],10);for(var g in k.glyphs){if(k.glyphs[c2](g)){var f=k.glyphs[g];h.glyphs[g]={w:f.w,k:{},d:f.d&&"M"+f.d[b3](/[mlcxtrv]/g,function(l){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[l]||"M"})+"z"};if(f.k){for(var a in f.k){if(f[c2](a)){h.glyphs[g].k[a]=f.k[a]}}}}}}return k};b.getFont=function(j,g,k,n){n=n||"normal";k=k||"normal";g=+g||{normal:400,bold:700,lighter:300,bolder:800}[g]||400;if(!dz.fonts){return}var c=dz.fonts[j];if(!c){var h=new RegExp("(^|\\s)"+j[b3](/[^\w\d\s+!~.:_-]/g,ds)+"(\\s|$)","i");for(var m in dz.fonts){if(dz.fonts[c2](m)){if(h.test(m)){c=dz.fonts[m];break}}}}var a;if(c){for(var l=0,f=c[bK];l<f;l++){a=c[l];if(a.face["font-weight"]==g&&(a.face["font-style"]==k||!a.face["font-style"])&&a.face["font-stretch"]==n){break}}}return a};b.print=function(c,f,x,t,s,h,w){h=h||"middle";w=bQ(cg(w||0,1),-1);var m=this.set(),j=da(x)[cC](ds),l=0,o=ds,g;dz.is(t,x)&&(t=this.getFont(t));if(t){g=(s||16)/t.face["units-per-em"];var v=t.face.bbox.split(b5),u=+v[0],q=+v[1]+(h=="baseline"?v[3]-v[1]+(+t.face.descent):(v[3]-v[1])/2);for(var n=0,a=j[bK];n<a;n++){var p=n&&t.glyphs[j[n-1]]||{},k=t.glyphs[j[n]];l+=n?(p.w||t.w)+(p.k&&p.k[j[n]]||0)+(t.w*w):0;k&&k.d&&m[bS](this.path(k.d).attr({fill:"#000",stroke:"none",translation:[l,0]}))}m.scale(g,g,u,q).translate(c-u,f-q)}return m};dz.format=function(f,c){var a=dz.is(c,dK)?[0][bX](c):arguments;f&&dz.is(f,c4)&&a[bK]-1&&(f=f[b3](b9,function(g,h){return a[++h]==null?ds:a[h]}));return f||ds};dz.ninja=function(){bL.was?(dr.Raphael=bL.is):delete Raphael;return dz};dz.el=cr;dz.st=c0[c6];bL.was?(dr.Raphael=dz):(Raphael=dz)})();if(CW.isApp()&&window.parent){try{window.open=window.parent.open;device=window.parent.device;navigator.geolocationPhonegap=window.parent.navigator.geolocation;navigator.connection=window.parent.navigator.connection;navigator.compass=window.parent.navigator.compass;navigator.accelerometer=window.parent.navigator.accelerometer;navigator.contacts=window.parent.navigator.contacts;Contact=window.parent.Contact;ContactFindOptions=window.parent.ContactFindOptions;ContactAddress=window.parent.ContactAddress;ContactError=window.parent.ContactError;ContactName=window.parent.ContactName;ContactOrganization=window.parent.ContactOrganization;LocalFileSystem=window.parent.LocalFileSystem;requestFileSystem=window.parent.requestFileSystem}catch(ex){SC.error(ex)}}else{navigator.geolocationPhonegap=navigator.geolocation}try{if(CW.isApp()&&window.parent&&window.parent.datePicker){datePicker=window.parent.datePicker}}catch(ex){SC.error(ex)}try{if(CW.isApp()&&window.parent&&window.parent.navigator&&window.parent.navigator.fileSystem){navigator.fileSystem=window.parent.navigator.fileSystem}}catch(ex){SC.error(ex)}if(!navigator.fileSystem){navigator.fileSystem=SC.Object.create({allkeys:["workflow.store","chat.store"],getPlatform:function(){var a="browser";return a},writeFile:function(m){var a=m.filename,g=m.data,b=m.callBackForSuc,k=m.callBackForFail;var f=new Date().getTime();SC.debug("writeFile,filename:%@".fmt(a));var c=this.getPlatform();SC.debug("platform:%@".fmt(c));switch(c){case"shell":var d=function(o){var n=new Date().getTime();SC.debug("writeFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(a,o?o:"",n-f));if(k){k()}appshell.fs.writeFile(a,"","utf8");SC.debug("%@".fmt(a))};if(!appshell.fs){d("");return}try{var l=appshell.app.getApplicationSupportDirectory();a="%@/%@.json".fmt(l,a);appshell.fs.writeFile(a,g,"utf8",function(p){SC.debug("writeFile complete,state:%@".fmt(p));var o={11:"ERR_BROWSER_NOT_INSTALLED",4:"ERR_CANT_READ",6:"ERR_CANT_WRITE",10:"ERR_FILE_EXISTS",2:"ERR_INVALID_PARAMS",9:"ERR_NOT_DIRECTORY",8:"ERR_NOT_FILE",3:"ERR_NOT_FOUND",7:"ERR_OUT_OF_SPACE",1:"ERR_UNKNOWN",5:"ERR_UNSUPPORTED_ENCODING",0:"NO_ERROR"};if(p==0){var n=new Date().getTime();SC.debug("writeFile suc,filename:%@,speedTime:%@ms".fmt(a,n-f));if(b){b()}}else{d(o[p])}})}catch(j){d(j)}break;case"phonegap":var d=function(o,p){var n=new Date().getTime();SC.debug("writeFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(a,o?o:"",n-f));SC.debug(o);if(k){k(o)}if(p){p.write("");SC.debug("%@".fmt(a))}};if(!window.requestFileSystem){d("");return}try{window.requestFileSystem(LocalFileSystem.PERSISTENT,0,e,d);function e(n){n.root.getFile("%@.json".fmt(a),{create:true,exclusive:false},function(o){o.createWriter(function(p){p.onerror=function(q){d(p.error,p)};p.onwrite=function(q){var s=new Date().getTime();SC.debug("writeFile suc,filename:%@,speedTime:%@ms".fmt(a,s-f));if(b){b(q)}};p.write(g)},d)},d)}}catch(j){d(j)}break;default:try{localStorage.setItem(a,g);var h=new Date().getTime();SC.debug("writeFile suc,filename:%@,speedTime:%@ms".fmt(a,h-f));if(b){b()}}catch(j){var h=new Date().getTime();SC.debug("writeFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(a,j,h-f));if(k){k(j)}localStorage.setItem(a,"");SC.debug("%@".fmt(a))}break}},readFile:function(m){var b=m.filename,c=m.callBackForSuc,k=m.callBackForFail;var g=new Date().getTime();SC.debug("readFile,filename:%@".fmt(b));var d=this.getPlatform();SC.debug("platform:%@".fmt(d));switch(d){case"shell":var e=function(o){var n=new Date().getTime();SC.debug("readFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(b,o?o:"",n-g));if(k){k(o)}};if(!appshell.fs){e("");return}try{var l=appshell.app.getApplicationSupportDirectory();b="%@/%@.json".fmt(l,b);appshell.fs.readFile(b,"utf8",function(q,n){SC.debug("readFile complete,state:%@".fmt(q));var p={11:"ERR_BROWSER_NOT_INSTALLED",4:"ERR_CANT_READ",6:"ERR_CANT_WRITE",10:"ERR_FILE_EXISTS",2:"ERR_INVALID_PARAMS",9:"ERR_NOT_DIRECTORY",8:"ERR_NOT_FILE",3:"ERR_NOT_FOUND",7:"ERR_OUT_OF_SPACE",1:"ERR_UNKNOWN",5:"ERR_UNSUPPORTED_ENCODING",0:"NO_ERROR"};if(q==0){var o=new Date().getTime();SC.debug("readFile suc,filename:%@,speedTime:%@ms".fmt(b,o-g));if(c){c(n)}}else{e(p[q])}})}catch(j){e(j)}break;case"phonegap":var e=function(o){var n=new Date().getTime();SC.debug("readFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(b,o?o:"",n-g));SC.debug(o);if(k){k(o)}};if(!window.requestFileSystem){e("");return}try{window.requestFileSystem(LocalFileSystem.PERSISTENT,0,f,e);function f(n){n.root.getFile("%@.json".fmt(b),null,function(o){o.file(function(q){var p=new FileReader();p.onerror=function(s){e(p.error)};p.onload=function(s){var t=new Date().getTime();SC.debug("readFile suc,filename:%@,speedTime:%@ms".fmt(b,t-g));if(c){c(s.target.result)}};p.onloadend=function(s){};p.readAsText(q)},e)},e)}}catch(j){e(j)}break;default:try{var a=localStorage.getItem(b);var h=new Date().getTime();SC.debug("readFile suc,filename:%@,speedTime:%@ms".fmt(b,h-g));if(c){c(a)}}catch(j){var h=new Date().getTime();SC.debug("readFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(b,j,h-g));if(k){k(j)}}break}},clear:function(){SC.debug("navigator.fileSystem.clear");var a=this.allkeys;a.forEach(function(b){this.writeFile({filename:b,data:""})},this)}})}try{if(CW.isApp()&&window.parent&&window.parent.navigator&&window.parent.navigator.notification){navigator.notification=window.parent.navigator.notification}}catch(ex){SC.error(ex)}if(!navigator.notification){navigator.notification=SC.Object.create({alert:function(b,c,e,a){var d={};if(!e){e="Alert"}if(!a){a="OK"}d.message=e;d.description=b;d.rightButton={title:a,action:function(){this.get("pane").remove();this.get("pane").destroy();c()}};var f=CW.Alert.create(d);f.append();return f},confirm:function(a,f,d,b){var c={};if(!d){d="Confirm"}if(!b){b=["OK","Cancel"]}c.message=d;c.description=a;if(!(b instanceof Array)){b=[b]}if(b.length==1){c.rightButton={title:b[0],action:function(){this.get("pane").remove();this.get("pane").destroy();f()}}}else{if(b.length==2){c.leftButton={title:b[1],action:function(){this.get("pane").remove();this.get("pane").destroy();f(2)}};c.rightButton={title:b[0],action:function(){this.get("pane").remove();this.get("pane").destroy();f(1)}}}else{if(b.length==3){c.leftButton={title:b[2],action:function(){this.get("pane").remove();this.get("pane").destroy();f(3)}};c.middleButton={title:b[1],action:function(){this.get("pane").remove();this.get("pane").destroy();f(2)}};c.rightButton={title:b[0],action:function(){this.get("pane").remove();this.get("pane").destroy();f(1)}}}else{alert("Can not show more than 3 buttons.")}}}var e=CW.Alert.create(c);e.append();return e},prompt:function(b,c,f,d,a){var e={};if(!f){f="Prompt"}if(!d){d=["OK","Cancel"]}if(!a){a=""}e.message=f;e.description=b;e.defaultText=a;if(!(d instanceof Array)){d=[d]}if(d.length==1){e.rightButton={title:d[0],action:function(){var j={};var h=this.getPath("pane.childViews.firstObject.promptView.value");j.input1=h?h:"";this.get("pane").remove();this.get("pane").destroy();c(j)}}}else{if(d.length==2){e.leftButton={title:d[1],action:function(){var j={};var h=this.getPath("pane.childViews.firstObject.promptView.value");j.buttonIndex=2;j.input1=h?h:"";this.get("pane").remove();this.get("pane").destroy();c(j)}};e.rightButton={title:d[0],action:function(){var j={};var h=this.getPath("pane.childViews.firstObject.promptView.value");j.buttonIndex=1;j.input1=h?h:"";this.get("pane").remove();this.get("pane").destroy();c(j)}}}else{if(d.length==3){e.leftButton={title:d[2],action:function(){var j={};var h=this.getPath("pane.childViews.firstObject.promptView.value");j.buttonIndex=3;j.input1=h?h:"";this.get("pane").remove();this.get("pane").destroy();c(j)}};e.middleButton={title:d[1],action:function(){var j={};var h=this.getPath("pane.childViews.firstObject.promptView.value");j.buttonIndex=2;j.input1=h?h:"";this.get("pane").remove();this.get("pane").destroy();c(j)}};e.rightButton={title:d[0],action:function(){var j={};var h=this.getPath("pane.childViews.firstObject.promptView.value");j.buttonIndex=1;j.input1=h?h:"";this.get("pane").remove();this.get("pane").destroy();c(j)}}}else{alert("Can not show more than 3 buttons.")}}}var g=CW.Prompt.create(e);g.append();return g}})}CK=SC.Object.create({NAMESPACE:"CK",VERSION:"1.0.0",LOAD_REASON_USER_CLICK:1,LOAD_REASON_LOCATION_HASH:2,LOAD_REASON_APP_SWITCH:3,LOAD_REASON_NOTIFICATION:4,LOAD_REASON_RELOAD:5,EXIT_NON_FATAL:0,EXIT_FATAL_ERROR:1,EXIT_STARTUP_ERROR:2,currentApplication:null,isLoadedBySteedOS:!!CW.getUrlParameters().isLoadedBySteedOS,isBeta:window.location.hostname==="beta.steedos.com"?YES:NO,isDeveloper:window.location.hostname==="developer.steedos.com"?YES:NO,init:function(){SC.ready(this.redirectToSteedOSIfNeeded)},redirectToSteedOSIfNeeded:function(){if(!CK.currentApplication){return}var c=window.location.pathname,d;if(window===window.top&&SC.buildMode==="production"&&c!=="/"){d=c.match(/\/applications\/(.*?)\//);if(d&&d[1]){window.location="https://"+window.location.hostname+"/#"+d[1]}}},queryParamsToOmitForStartupCaching:["clientId","clientBuildNumber"],startupUrlsAreEqual:function(c,d){return this.removeQueryParamsToOmitForStartupCaching(c)===this.removeQueryParamsToOmitForStartupCaching(d)},removeQueryParamsToOmitForStartupCaching:function(k){if(!k){return k}var h=URI(k),j=CK.queryParamsToOmitForStartupCaching,f,g;for(f=0,g=j.length;f<g;f++){h.removeSearch(j[f])}return h.toString()}});CK.CJK_UNICODE_RANGES=[[4352,4607],[11904,12031],[12032,12255],[12288,12351],[12352,12447],[12544,12591],[12592,12687],[12688,12703],[12704,12735],[12800,13055],[13056,13311],[13312,19893],[19968,40959],[40960,42127],[42128,42191],[44032,55203],[63744,64255],[65072,65103]];CK.mixin({getCurrentLocaleInISOFormat:function(){var c=String.preferredLanguage,d=null;if(c){d=c.substr(0,2).toLowerCase()+"_"+c.substr(3,5).toUpperCase()}return d},characterCodeIsCJK:function(h){var k=CK.CJK_UNICODE_RANGES,j;if(SC.none(h)){return NO}for(var f=0,g=k.length;f<g;++f){j=k[f];if(h>=j[0]&&h<=j[1]){return YES}}return NO},stringIsCJK:function(f){f=f.trim();if(SC.empty(f)){return NO}var d=0,e=f.length-1;while(d<=e){if(!this.characterCodeIsCJK(f.charCodeAt(d++))||!this.characterCodeIsCJK(f.charCodeAt(e--))){return NO}}return YES},displayNameFor:function(l,g,j,k,h){var m;if(l&&g){if(this.stringIsCJK(l)&&this.stringIsCJK(g)){m=g+l}else{m="Name.Display.FirstAndFamilyNames".loc({firstName:l,familyName:g})}}else{if(l){m=l}else{if(g){m=g}else{if(k){m=k}else{if(h){m=h}}}}}if(!m){m=j||""}return m},readCookie:function(j,h){var m=document.cookie,g,k,l;if(m.length>0){if(h){l=m.match(new RegExp("("+j+")="));if(l){j=l[1]}}g=m.indexOf(j+"=");if(g!==-1){g=g+j.length+1;k=m.indexOf(";",g);if(k===-1){k=m.length}return window.unescape(m.substring(g,k))}}return null},writeCookie:function(t,q,k,o,n,l){var m,p,s;if(!t){return undefined}if(q===undefined||q===null){q="";p="expires=Thu, 01-Jan-1970 00:00:01 GMT;"}if(n){s=n*1000*60*60;p="expires="+new Date(new Date().getTime()+(s))}if(l){p+=";Secure"}if(!k){k="/"}if(!o){o="."+window.location.hostname}m=document.cookie=t+"="+q+";path="+k+";domain="+o+";"+p;if(!m){SC.info('Not able to set cookie "%@" with "%@"',t,q)}return m},formatNumberWithLocale:function(b){return CW.formatNumber(b,"Numbers.ThousandsSeparator".loc(),"Numbers.DecimalSeparator".loc())},getLegacyLprojNameForLocale:function(e){var d={"en-us":"us","zh-cn":"cn"};var f=d[e];if(!f){f="us"}return f},openHelp:function(c,h,j){var g=this.getLegacyLprojNameForLocale(String.preferredLanguage);var k="http://steedos.com/%@/help/".fmt(g);if(SteedOS.displayApps&&SteedOS.displayApps.length==1){k=k+SteedOS.displayApps[0].name+"/"}else{if(SteedOS.appInstance&&SteedOS.appInstance.name){k=k+SteedOS.appInstance.name+"/"}}window.open(k,"guide","EnableViewPortScale=yes,location=0,status=0,scrollbars=0, width=980,height=600")},hasLocalizedStringForKey:function(b){if(b&&b.loc()!==b){return YES}return NO}});SC.mixin(CK,{OFFLINE_TYPE_SESSION_STORAGE:"SessionStorage",OFFLINE_TYPE_LOCAL_STORAGE:"LocalStorage",OFFLINE_TYPE_SQL_DATABASE:"SQLDatabase",OFFLINE_REASON_NETWORKING_ERROR:"NetworkingError",OFFLINE_REASON_TIMEOUT:"Timeout",OFFLINE_REASON_SERVER_ERROR:"ServerError",OFFLINE_REASON_STARTUP_WAIT:"StartupWait"});CK.offlineController=SC.Object.create({isOfflineEnabled:NO,offlineType:null,isOffline:function(){var d=NO,c;if(this.get("isOfflineEnabled")&&this.get("offlineType")){c=this.get("offlineReasons");if(c&&c.get("length")>0){d=YES}}return d}.property("isOfflineEnabled","offlineType","offlineReasons").cacheable(),offlineReason:function(){var c="",d;if(this.get("isOfflineEnabled")&&this.get("offlineType")){d=this.get("offlineReasons");if(d&&d.get("length")>0){if(d.contains(CK.OFFLINE_REASON_NETWORKING_ERROR)){c="NetworkingError"}else{if(d.contains(CK.OFFLINE_REASON_TIMEOUT)){c="Timeout"}else{if(d.contains(CK.OFFLINE_REASON_SERVER_ERROR)){c="ServerError"}else{c=d.get("firstObject")}}}c=(("Dock."+c).loc()!==("Dock."+c))?c:""}}return c}.property("offlineReasons").cacheable(),offlineReasons:null,addOfflineReason:function(d){var c=this.get("offlineReasons");if(!c){c=SC.Set.create([d]);this.set("offlineReasons",c);c.addObserver("[]",this,this.offlineReasonsContentDidChange)}else{c.add(d)}},removeOfflineReason:function(d){var c=this.get("offlineReasons");if(c&&c.contains(d)){c.remove(d)}},hasOfflineReasonOtherThan:function(d){if(!this.get("isOffline")){return NO}var c=this.get("offlineReasons");if(c.contains(d)){return !(c.get("length")===1)}else{return(c.get("length")>=1)}},offlineReasonsContentDidChange:function(){this.notifyPropertyChange("isOffline");this.notifyPropertyChange("offlineReason")},deviceStateDidChange:function(){var d=SC.device.get("isOffline"),c=CK.OFFLINE_REASON_NETWORKING_ERROR;if(d){this.addOfflineReason(c)}else{this.removeOfflineReason(c)}}.observes("SC.device.isOffline"),init:function(){this.deviceStateDidChange()},toString:function(){var b=arguments.callee.base.apply(this,arguments);if(b){b="Offline controller ("+b+")"}return b}});CK.RequestDelegate={isCKRequestDelegate:YES,getUrlForServiceName:function(b){return null},didReceiveSpecialResponse:function(d,f,e){}};sc_require("mixins/request_delegate");CK.servicesController=SC.Object.create({getServiceInfoFor:function(d){if(!d){SC.warn("getServiceInfoFor():  A service name must be specified")}var c=this._servicesInfo;return c?c[d]:null},getServiceUrlFor:function(k,j){var h=this.getServiceInfoFor(k),f=null,g;if(h){f=h.get("url")||null;if(!f){g="getServiceUrlFor():  Could not find the URL for %@".fmt(k)}}else{g="getServiceUrlFor():  Could not find service information for %@".fmt(k)}if(g){if(j){CW.fatalError(g)}else{SC.error(g)}}return f},getServiceStatusFor:function(k,j){var h=this.getServiceInfoFor(k),f=null,g;if(h){f=h.get("status")||null;if(!f){g="getServiceStatusFor():  Could not find the status for %@".fmt(k)}}else{g="getServiceStatusFor():  Could not find service information for %@".fmt(k)}if(g){if(j){CW.fatalError(g)}else{SC.error(g)}}return f},servicesInfoHasBeenReceived:function(){return(this._servicesInfo!==null)}.property("_servicesInfo"),_setupFromBag:function(k){if(!k){CW.fatalError("_parseInformationFromBag():  The bag must be supplied")}var g=k.webservices,j,f,h;if(g){j={};for(f in g){h=SC.clone(g[f],YES);h.name=f;j[f]=CK.ServiceInfo.create(h)}this.set("_servicesInfo",j)}else{SC.error("CK.servicesController:  The bag does not contain any services information")}},_servicesInfo:null});CK.mixin({persistAfterLogoutSuffix:".persist",getValueFromSessionStorage:function(b){return this._getValueFromStorage(window.sessionStorage,b)},setValueInSessionStorage:function(d,c){return this._setValueInStorage(window.sessionStorage,d,c)},getKeysInSessionStorage:function(){return this._getKeysInStorage(window.sessionStorage)},clearSessionStorage:function(){return this._clearStorage(window.sessionStorage)},getValueFromLocalStorage:function(c,d){return this._getValueFromStorage(window.localStorage,c,d)},setValueInLocalStorage:function(d,f,e){return this._setValueInStorage(window.localStorage,d,f,e)},getKeysInLocalStorage:function(){return this._getKeysInStorage(window.localStorage)},clearLocalStorage:function(){return this._clearStorage(window.localStorage,YES)},_getValueFromStorage:function(j,m,h){var g=null,l,k;if(j&&j.getItem){k=CK.currentApplication;l=k?k.get("name"):"SteedOS";if(l){m=l+"."+m}if(h){m+=this.get("persistAfterLogoutSuffix")}g=j.getItem(m)}return g},_setValueInStorage:function(l,q,o,k){var e=NO,p,m;if(l&&l.setItem){m=CK.currentApplication;p=m?m.get("name"):"SteedOS";if(p){q=p+"."+q}if(k){q+=this.get("persistAfterLogoutSuffix")}try{l.setItem(q,o);e=YES}catch(n){}}return e},_getKeysInStorage:function(j){var h=[],k,m,l,g;if(j){k=CK.currentApplication;m=k?k.get("name"):"SteedOS";if(m){m+="."}l=m?m.length:0;for(g in j){if(g.indexOf(m)===0){h.push(g.substring(l))}}}return h},_clearStorage:function(z,t){var w=YES,D,e,C,E,y,q,B;if(t){try{D={};e=this.get("persistAfterLogoutSuffix");C=e.length;for(E=0,y=z.length;E<y;++E){try{q=z.key(E);B=q.indexOf(e);if(B!==-1){if(B===(q.length-C)){D[q]=z.getItem(q)}}}catch(x){}if(z.length!==y){D={};E=-1;y=z.length}}}catch(s){}}if(z){if(!z.clear){w=NO}else{try{z.clear()}catch(u){w=NO}}}if(t){try{for(q in D){z.setItem(q,D[q])}}catch(v){}}return w}});CK.AccountPreferences=SC.Object.extend({hasInitialized:NO,timeZone:"Asia/Shanghai",timezoneName:"City.Beijing - China",locale:String.preferredLanguage,viewPushNotifications:{}});CK.ServiceInfo=SC.Object.extend({name:undefined,url:undefined,isEnabled:undefined});CK.User=SC.Object.extend({statusCode:null,firstName:null,lastName:null,primaryEmail:null,primaryEmailIsVerified:function(){return this.get("primaryEmailVerified")}.property(),displayName:function(){var d=this.get("firstName"),e=this.get("lastName"),f=this.get("steedosId");return CK.displayNameFor(d,e,f)}.property("firstName","lastName","steedosId"),userIsBetaQualified:function(){return YES},userIsDeveloperQualified:function(){return this._auth_bag.dsInfo.isDeveloper},steedosId:null,steedosIdAlias:null,SteedOSIdAlias2:null,displaySteedOSId:function(){var k=this.get("steedosId"),j=this.get("steedosIdAlias"),h=this.get("steedosIdAlias2");if(!j&&!h){return k}var o=[k,j,h],n=["@steedos.com"],l,m;for(m=0;m<n.length;m++){for(l=0;l<o.length;l++){if(o[l].search(n[m])!==-1){return o[l]}}}return k}.property("steedosId","steedosIdAlias","SteedOSIdAlias2"),dsid:null,preferences:function(){SC.warn("This is a deprecated method. Make sure to use SteedOS.getAccountPreferences() instead if you are inside an app, or authController if within SteedOS.");if(CK.currentApplication){return SteedOS.getAccountPreferences(CK.currentApplication)}else{return SteedOS.authController.get("accountPreferences")}}.property(),_auth_bag:null,destroy:function(){var b=this._preferences_cache;if(b){b.destroy()}this._preferences_cache=null;return arguments.callee.base.apply(this,arguments)}});CK.User.mixin({PAID_LAPSED:-3,PAID_NOT_CREATED_YET:-2,FREE_NOT_CREATED_YET:-1,INACTIVE:0,PAID_ACTIVE:1,FREE_QUALIFIED:2,FREE_NOT_QUALIFIED:3});CK.errorCatcher=SC.Object.create({enabledInDevMode:NO,bubbleErrorsToSteedOS:YES,exceptionCallback:null,namespacesToSymbolicate:null,isReporting:NO,init:function(){arguments.callee.base.apply(this,arguments);if(this.get("enabledInDevMode")||(SC.buildMode==="production")){this.set("enabled",YES);SC.ExceptionHandler=this}else{SC.ExceptionHandler=null}},reportBadRequest:function(b){if(!b){b={}}b.origin="client";b.type="bad request";return this._handleError(b)},reportServerError:function(b){if(!b){b={}}b.origin="server";b.type="error";return this._handleError(b)},handleException:function(c){try{c.recordedStack=c.recordedStack||CW.recordStack(YES,YES)}catch(d){}return this._handleError({exception:c,isFatal:YES,origin:"client",type:"exception"})},_handleError:function(s){if(!s){SC.error("Warning: No parameters were specified in _handleError");return YES}if(this.get("isReporting")){return YES}SC.debug("CloudKit: ErrorCatcher dialog invoked.");var v=CK.currentApplication,e=v?v.get("name"):"steedos",m,o;if(!s.applicationName){s.applicationName=e}if(!s.appStatechart){var q=v?v.get("statechartPath"):SteedOS.get("statechartPath"),n;if(q&&(n=SC.getPath(q))&&n.toStringWithDetails){s.appStatechart=n.toStringWithDetails()}}m=s.exception;if(m){o=this._hashForException(m);s=SC.mixin(o,s)}if(s.isFatal&&v&&this.get("bubbleErrorsToSteedOS")===YES&&SteedOS&&!SteedOS.isSimulator){var p=SC.Logger.stringifyRecordedLogMessages(),u=this.get("exceptionCallback");s.applicationBuildNumber=SC.buildNumber;if(u){try{u.call(this,s)}catch(t){}}SteedOS.handleApplicationCrash(s,p);return NO}else{if(s.exception){SC.RunLoop.kill()}else{SC.RunLoop.end()}s.exception=null;SC.Module.loadModule("cloudkit/error_catcher","CK.errorCatcher","moduleDidLoad",s);this.set("isReporting",YES)}return YES},_hashForException:function(w){var j={},H=null,J,E,x,v,I,L,G,y,K,z,e,D,F;if(w){H=w.message?w.message:w.toString()}j.error=H;j.file=w.fileName||w.sourceURL||"Unknown";j.line=w.lineNumber||w.line||"Unknown";var B=CW.invertArray(["message","fileName","sourceURL","lineNumber","line","stack","recordedStack"]);var C=function(){if(typeof w==="string"){return w}var a="";for(e in w){if(B[e]){continue}D=w[e];if(D===undefined){F="(undefined)"}else{if(D===null){F="(null)"}else{F=e+":  "+D.toString()}}a+="   "+F+"\n"}return a}();if(C.trim().length>0){j.exceptionInfo=C}J=w.stack;if(J){j.stack=J.toString()}J=w.recordedStack;if(J){E="";for(x=0,v=J.length;x<v;++x){I=J[x];if(typeof(I)==="string"){E+=I+"\n";break}else{E+=I.func+"\n";L=I.args;if(L){E+="  >  args:  ";for(y=0,G=L.length;y<G;++y){K=L[y];z=this._prettyValue(K);if(y>0){E+=",  "}E+=z}E+="\n"}}}j.mostRecentStack=E}return j},_prettyValue:function(d){var c;if(d===undefined){c="undefined"}else{if(d===null){c="null"}else{if(d instanceof Function){c=d.displayName;if(!c){c=d.name}}if(!c){c=d.toString()}}}return c}});CK.keyResponder=SC.Object.create({performKeyEquivalent:function(b){if(!window.SteedOS||SteedOS.isSteedOSClient){return NO}return SteedOS.relayKeyboardShortcut(b)}});SC.ready(function(){CW.installKeyResponder();CW.keyResponders.unshift(CK.keyResponder)});SC.RootResponder.reopen({mousemove:function(c,d){if(window.SteedOS){SteedOS.relayMouseMove(d.clientX,d.clientY)}return c(d)}.enhance()});CK.Request=CW.Request.extend(SC.DelegateSupport,{serviceName:null,useCrossDomain:YES,withCredentials:YES,attachIdentifyingHeaders:NO,contentType:undefined,delegate:null,requestDelegate:function(){var b=this.get("delegate")||window.SteedOS;if(!b){CW.fatalError("A CK.Request must have a delegate",{target:this})}return b}.property("delegate").cacheable(),addressPrefix:function(){var h=null,f,e,g;if(this.get("useCrossDomain")){f=this.get("requestDelegate");e=this.get("address")||"";g=this._getServiceName();if(e.toLowerCase().indexOf("http")<0){h=f.getUrlForServiceName(g,NO);if(h){if(h[h.length-1]==="/"){if(e[0]==="/"){h=h.slice(0,-1)}}else{if(e[0]!=="/"){h+="/"}}}}}return h}.property("useCrossDomain"),COPY_KEYS:CW.Request.prototype.COPY_KEYS.concat(["serviceName","delegate"]),init:function(){var l,q,n,m,o,k;arguments.callee.base.apply(this,arguments);if(!this.get("source")){if(this.get("useCrossDomain")){l=this.get("contentType");if(l===undefined){l="text/plain";this.set("contentType",l)}}if(!l){l=this.get("contentType")}if(l){this.header("Content-Type",l)}q=this._specialResponseStatuses;if(q){k=this._specialResponseWasReceived;for(n=0,m=q.length;n<m;++n){o=q[n];this.notify(o,this,k)}}var s=window.SteedOS&&!SteedOS.isSteedOSClient;var p=s?SteedOS.getUser():COS.authController.get("user"),t=p?p.get("dsid"):null;if(t){this.queryParameter("dsid",t)}this._attachId();this.queryParameter("clientId",s&&SteedOS.getClientId?SteedOS.getClientId():COS.CLIENT_ID);this.queryParameter("clientBuildNumber",SC.buildNumber)}},_attachId:function(){var d=window.SteedOS&&!SteedOS.isSteedOSClient?SteedOS.getUser():COS.authController.get("user");if(!d){return}var c=window.SteedOS&&!SteedOS.isSteedOSClient?SteedOS.getId():COS.authController.generateId(d.get("steedosId"));if(c){this.queryParameter("id",c)}},_specialResponseStatuses:[330,401,403,406,503],_specialResponseWasReceived:function(K){SC.debug("Received special response:  %@",K);var E=this.get("requestDelegate"),x=K.get("status"),H=K.get("request"),D=H._getServiceName(),v=H.get("overallTimeout"),z=K.get("addedToOutgoingQueueTimestamp"),F=YES,I=NO,u=NO,C=K.get("body"),e,B,L,J,G;if(SC.typeOf(C)===SC.T_STRING){try{var y=SC.json.decode(C);C=y}catch(w){}}if(x===330){if(D&&D!=="keyvalue"){SC.Request.manager.suspendService(D)}else{SC.error("We received a response with status 330 but the request (%@) was not annotated with a service name",H)}I=YES}else{if(x===403){G=NO;for(e in C){if(e.match(/^auth[ _\-]?mismatch$/i)){G=YES;break}}if(!G){F=NO}}else{if(x===406){F=YES;I=YES}else{if(x===503){if(C){for(e in C){if(e.match(/^retry[ _\-]?after$/i)){B=C[e];break}}}if(B){B=parseInt(B,10)}if(B){B*=1000;if(v&&z){L=new Date()-z;SC.debug("The server is telling us to retry after %@ms, it has been %@ms, and our overall timeout is %@ms",B,L,v);if((L+B+5000)<v){SC.debug("  -  it looks like we can make it so automatically retrying request %@",H);I=YES;F=NO}else{SC.debug("  -  it doesnt look like we can make it so not automatically retrying request %@",H);I=NO;F=YES;J={retryAfter:(B/1000)}}}}}}}}if(I){if(v&&z){L=new Date()-z;if(L<v){H=H.copy()._prep();H.set("overallTimeout",v-L)}}H.resend(K);u=YES}if(F){E.didReceiveSpecialResponse(x,K.get("encodedBody"),J)}return u},resend:function(){this._attachId();return arguments.callee.base.apply(this,arguments)},_getServiceName:function(){var d=this.get("serviceName"),c;if(!d){c=CK.currentApplication;d=c?c.get("primaryServiceName")||c.get("name"):null}return d}});SC.Request.manager.mixin({serviceIsSuspended:function(d){if(!d){CW.fatalError("serviceIsSuspended():  A service name must be specified",{target:this})}var c=this._suspendedServices;return(c&&c[d])},suspendService:function(d){if(!d){CW.fatalError("suspendService():  A service name must be specified",{target:this})}var c=this._suspendedServices;if(!c){c=this._suspendedServices={}}if(!c[d]){SC.debug("Suspending requests to %@ service",d)}c[d]=YES},resumeService:function(d){if(!d){CW.fatalError("resumeService():  A service name must be specified",{target:this})}var c=this._suspendedServices;if(c){if(c[d]){SC.debug("Resuming requests to %@ service",d)}delete c[d]}SC.Request.manager.fireRequestIfNeeded()},resumeAllServices:function(){var c=this._suspendedServices,d;if(c){for(d in c){if(c[d]){this.resumeService(d)}}}SC.Request.manager.fireRequestIfNeeded()},_suspendedServices:null});SC.Request.manager.mixin({shouldFireRequest:function(e){if(!e){CW.fatalError("shouldFireRequest():  A response must be specified",{target:this})}var f=e.get("request"),d=f._getServiceName?f._getServiceName():null;if(!d){return YES}else{return !SC.Request.manager.serviceIsSuspended(d)}}});CK.SteedOSGetterSupport={getUser:function(){var g=this.get("appInstance");var h=g._cloudOSState.authBag;if(!g._cos_user_cache&&h){SC.debug("Creating local CK.User object");var e=g._cloudOSState.authBag.dsInfo,f;g._cos_user_cache=f=CK.User.create(e);f._auth_bag=h}else{if(!h){SC.warn("Cannot getUser() before auth bag has been fetched.")}}return g._cos_user_cache},getAccountPreferences:function(){var c=this.get("appInstance");if(!c._cos_account_preferences_cache){SC.debug("Creating local CK.AccountPreferences object");var d=c._cloudOSState.accountPreferences;c._cos_account_preferences_cache=CK.AccountPreferences.create(d)}return c._cos_account_preferences_cache},getUrlForServiceName:function(e,d){var f=this.get("appInstance");e=SC.typeOf(e)===SC.T_STRING?e:f.get("name");return CK.servicesController.getServiceUrlFor(e,!!d)},getStatusForServiceName:function(e,d){var f=this.get("appInstance");e=SC.typeOf(e)===SC.T_STRING?e:f.get("name");return CK.servicesController.getServiceStatusFor(e,!!d)},getAppLoadReason:function(){return this.get("loadReason")},getCurrentlyActiveApplication:function(){var b=this.get("appInstance");return b._cloudOSState.currentlyActiveApplication},getRoute:function(){var b=this.get("appInstance");return b._cloudOSState.route},getAppPreferences:function(d){var c=this.get("appInstance");d=d?d:c.get("name");return c._cloudOSState.appPreferences[d]},getRequestedStartupUrl:function(){var b=this.get("appInstance");return b._cloudOSState.requestedStartupUrl},getEnvironment:function(){var b=this.get("appInstance");return b._cloudOSState.environment},getActiveXFileVersion:function(){var b=this.get("appInstance");return b._cloudOSState.activeXFileVersion},getId:function(){var b=this.get("appInstance");return b._cloudOSState.id},getClientId:function(){var b=this.get("appInstance");return b._cloudOSState.clientId},sessionIsExtendedLogin:function(){var b=this.get("appInstance");return b._cloudOSState.authBag.isExtendedLogin},getHostname:function(){var b=this.get("appInstance");return b._cloudOSState.hostname},getValidateToken:function(){return CK.readCookie("X-STEEDOS-WEBAUTH-VALIDATE")},mailTo:function(n,s,v,y,u){var t=this.get("appInstance"),z="",o,p;var w={to:n?n:"",subject:s?s:"",body:v?v:"",cc:y?y:"",bcc:u?u:""};for(o in w){p=w[o];if(!p){continue}if(z){z+="&"}z+=o+"="+encodeURIComponent(w[o])}var x=!(CK.isBeta||CK.isDeveloper);if(x&&CK.servicesController.getServiceInfoFor("mail")){var q=CW.UUID();window.open("https://%@/mail/message/%@/?windowInstanceId=%@#compose?%@".fmt(window.location.hostname,String.preferredLanguage,q,z),"","width=810,height=677,status=no,toolbar=no");t.registerWindowApplicationMessage("populateFields",w,q)}else{SteedOS.redirectTo("mailto:%@?%@".fmt(n,z))}},showHelp:function(f,e){var d=this.get("appInstance");CK.openHelp((d&&d.get("name")),f,e)},windowApplicationHasInitialized:function(l,g,m){var k=this.get("appInstance"),h=k.get("name"),j=CK.currentApplication;CK.currentApplication.windowApplication[m]=g;j.set("windowApplicationHost",l);j.passWindowApplicationMessage("_applicationShouldInvokeMain",m,SteedOS._cloudOSAPIMethodNames,k._cloudOSState);j.passPendingWindowApplicationMessages(m)},windowApplicationWillClose:function(b){CK.currentApplication.windowApplication[b]=null}};CK.StyleSheet={styles:null,styleSheet:null,setStyleString:function(h){if(h){var e=h.join("");this.styles=h;if(this.styleSheet.styleSheet){this.styleSheet.styleSheet.cssText=e}else{var f=this.styleSheet.childNodes[0];var g=document.createTextNode(e);if(!f){this.styleSheet.appendChild(g)}else{this.styleSheet.replaceChild(g,f)}}}return this.styles}};SC.mixin(CK.StyleSheet,{create:function(h){var g=SC.beget(CK.StyleSheet);var f=document.getElementsByTagName("head")[0];var e=document.createElement("style");e.type="text/css";f.appendChild(e);g.styleSheet=e;g.setStyleString((h)?h:[]);return g}});CK.ActiveXView=SC.View.extend({classNames:["activex"],fileTypes:"",maxImageSize:1000,maxFileSizeBytes:500000,classId:"82E5DF24-51E8-47CD-864A-F4BD5005AA73",imageTypes:"jpg;bmp;png;gif",fileVersion:function(){return CK.currentApplication?SteedOS.getActiveXFileVersion():SteedOS.ACTIVE_X_FILE_VERSION}.property(),delegate:null,isInitialized:NO,isVisible:NO,init:function(){arguments.callee.base.apply(this,arguments);if(!CK.ActiveXView.needsActiveX()){return}this.set("isVisible",YES),SC.RootResponder.responder.listenFor("mouseenter mouseleave".w(),SC.$("body")[0],this),CK.ActiveXView.currentView=this,this.onStart(),CK.ActiveXView.removeEventsOnDropTargets()},destroy:function(){this._timer&&this._timer.invalidate(),this._timer=null,arguments.callee.base.apply(this,arguments)},render:function(b,a){if(a&&CK.ActiveXView.needsActiveX()){var c;SC.buildMode==="debug"?c="../../../../system/steedos/4330/cloudkit/runtime/4330/en-us/resources/iCloud.cab":c="../../../../system/iCloud.cab",b.push('<object id="YachtV2" classid="CLSID:%@" codebase="%@#version=%@" width="100%" height="100%" style="position:absolute;top:0px;left:0px;"></object>'.fmt(this.get("classId"),c,this.get("fileVersion")))}},isVisibleDidChange:function(){if(!CK.ActiveXView.needsActiveX()||!this.get("isInitialized")){return}this.get("isVisible")?CK.ActiveXView.removeEventsOnDropTargets():CK.ActiveXView.reinstateEventsOnDropTargets()}.observes("isVisible"),mouseMoved:function(a){return this.set("isVisible",NO),NO},mouseleave:function(b){if(!this.get("isInitialized")){return}var a=this;SC.run(function(){a.set("isVisible",YES)})},mouseenter:function(b){var a=this;SC.run(function(){a._isDragging||a.set("isVisible",NO)})},onStart:function(){if(this._didStart){return}var b;try{b=window.YachtV2.getVersion}catch(a){SC.warn("ActiveX: onStart called but YachtV2 is undefined")}if(!b){this._timer||(this._timer=SC.Timer.schedule({target:this,action:"onStart",interval:1000,repeats:YES,until:Date.now()+1200000}));return}YachtV2.fileTypes=this.get("fileTypes"),YachtV2.imageTypes=this.get("imageTypes"),YachtV2.maxImageSize=this.get("maxImageSize"),YachtV2.maxFileSizeBytes=this.get("maxFileSizeBytes"),YachtV2.attachEvent("onDragEnter",function(h,f,j,g,d){SC.run(function(){CK.ActiveXView.currentView.onDragEnter(h,f,j,g,d)})}),YachtV2.attachEvent("onDragOver",function(h,f,j,g,d){SC.run(function(){CK.ActiveXView.currentView.onDragOver(h,f,j,g,d)})}),YachtV2.attachEvent("onDragLeave",function(){SC.run(function(){CK.ActiveXView.currentView.onDragLeave()})}),YachtV2.attachEvent("onInvalidFileDropped",function(g,d,h,f){SC.run(function(){CK.ActiveXView.currentView.onInvalidFileDropped(g,d,h,f)})}),YachtV2.attachEvent("onFileDropped",function(j,f,k,h,d,g){SC.run(function(){CK.ActiveXView.currentView.onFileDropped(j,f,k,h,d,g)})}),YachtV2.attachEvent("onEnd",function(){SC.run(function(){CK.ActiveXView.currentView.onEnd()})}),this.set("isInitialized",YES);var c=this.get("delegate");c&&c.tryToPerform("onStart",this),SC.debug("ActiveX: Component properly initialized, version %@.",b),this.set("isVisible",YES),this._timer&&(this._timer.invalidate(),this._timer=null),this._didStart=YES},onEnd:function(){this.set("isInitialized",NO);var a=this.get("delegate");a&&a.tryToPerform("onEnd",this)},onFileDropped:function(g,c,j,f,b,d){var h=this.get("delegate"),a;h&&(a={fileName:g,fileType:c,fileData:j,x:f,y:b,fileSize:d},h.tryToPerform("onFileDropped",this,a)),this.set("isVisible",NO),CK.ActiveXView._dragEndedOnDropTargets()},onInvalidFileDropped:function(f,b,g,d){var a=this.get("delegate"),c;a&&(c={fileName:f,errorCode:d,x:b,y:g},a.tryToPerform("onInvalidFileDropped",this,c)),this.set("isVisible",NO),CK.ActiveXView._dragEndedOnDropTargets()},onDragEnter:function(g,c,j,f,b){var d=this.get("delegate"),h;d&&(h={fileName:g,fileType:c,x:j,y:f,fileSize:b},d.tryToPerform("onDragEnter",this,h)),this._isDragging=YES;var a={pageX:j,pageY:f};CK.ActiveXView._getDragOperation(a,this)},onDragOver:function(f,b,h,d,a){var c=this.get("delegate"),g;c&&(g={fileName:f,fileType:b,x:h,y:d,fileSize:a},c.tryToPerform("onDragOver",this,g)),this.set("currentDragX",h),this.set("currentDragY",d)},onDragLeave:function(){var a=this.get("delegate");a&&a.tryToPerform("onDragLeave",this),this._isDragging=NO,CK.ActiveXView._dragEndedOnDropTargets()}}),CK.ActiveXView.mixin({currentView:null,needsActiveX:function(){return SC.browser.isIE9OrLower},_dragOperation:null,_getDragOperation:function(c,a){var d=CK.ActiveXView._dragOperation;if(d){return d}var b=SC.Drag.start({event:c,source:a,ghost:NO,slideBack:NO,sourceIsDraggable:NO});return CK.ActiveXView._dragOperation=b,b},_dragEndedOnDropTargets:function(){var d=CK.ActiveXView._dragOperation;if(!d){return}var b=d._dropTargets(),f,c,a;for(f=0,c=b.length;f<c;f++){a=b[f],a.tryToPerform("dragEnded",this,d.event),a&&a.get("acceptsFileDrags")&&(a._isCurrentlyHovered=NO)}CK.ActiveXView._dragOperation=null},_dropTargetEvents:"dragenter dragover dragleave drop".w(),removeEventsOnDropTargets:function(){CK.ActiveXView._eventOnDropTarget(SC.Event.remove)},reinstateEventsOnDropTargets:function(){CK.ActiveXView._eventOnDropTarget(SC.Event.add)},_eventOnDropTarget:function(g){var k=SC.Drag._dropTargets,d=CK.ActiveXView._dropTargetEvents,b,f,l,c,j,h;for(l in k){c=k[l];for(b=0,f=d.length;b<f;b++){j=d[b],h=c[j],h&&g(document,j,c,c[j])}}}});CK.AddDeleteButton=SC.ButtonView.extend({layout:{left:0,height:30,centerY:0,width:28},acceptsFirstResponder:NO,displayProperties:["buttonType"],buttonType:"delete",themeName:"addDelete",render:function(b){arguments.callee.base.apply(this,arguments);b.setClass("delete-icon",this.get("buttonType")==="delete");b.setClass("add-row",this.get("buttonType")==="add")},action:"buttonClicked",titleMinWidth:20,isEmpty:YES});CK.AddDeleteButton.Theme=SC.BaseTheme.create({name:"addDelete"});SC.Theme.addTheme(CK.AddDeleteButton.Theme);CK.Statechart={EVT_ENTER_SIG:"enter",EVT_EXIT_SIG:"exit",EVT_INIT_SIG:"defaultTransition"};SC.mixin(CK.Statechart,{EVT_ENTER:{sig:CK.Statechart.EVT_ENTER_SIG},EVT_EXIT:{sig:CK.Statechart.EVT_EXIT_SIG},EVT_INIT:{sig:CK.Statechart.EVT_INIT_SIG},EVT_IGNORED_RES:"cloudkit-statechart-evt-ignored-res",EVT_HANDLED_RES:"cloudkit-statechart-evt-handled-res",EVT_TRANSITION_RES:"cloudkit-statechart-evt-transition-res",EVT_TERMINATE_RES:"cloudkit-statechart-evt-terminate-res",STATE_CHART_TRACE_ENABLED:NO});SC.mixin(CK.Statechart,{handled:function(){return CK.Statechart.EVT_HANDLED_RES},terminate:function(){return CK.Statechart.EVT_TERMINATE_RES}});SC.mixin(Function.prototype,{state:function(b){this.superstateKey=b;this.isState=YES;return this}});CK.Statechart._DISPATCH_PATH=[];SC.mixin(SC.Object.prototype,{stateKey:"state",dispatch:function(o){if(this._isDispatching){if(this.shouldTrace()){SC.debug('%@ ignored event "%@": already dispatching an event',this,o.sig)}return NO}this._isDispatching=YES;var w=this.get("stateKey");var n=CK.Statechart._DISPATCH_PATH;var u,t,v,s,z,q,p,x;n.length=0;u=this[w];if(!u){this._isDispatching=NO;return NO}this._ck_statechart_dispatch(o);var y=this._ck_state_depth;q=this._ck_statechart_event(this[w],o,y);if(!q){s=this[u].superstateKey;while(s){q=this._ck_statechart_event(s,o,--y);if(q){v=s;break}else{s=this[s].superstateKey}}}if(!q){this._isDispatching=NO;return NO}else{if(q===CK.Statechart.EVT_TRANSITION_RES){t=this[w];n[0]=this[t].superstateKey;if(v&&u!=this[v]){this._ck_statechart_exit(u);s=this[u].superstateKey;while(s&&s!==v){this._ck_statechart_exit(s);s=this[s].superstateKey}}if(v){u=v}figureOutWhatToDo:do{if(u===t){this._ck_statechart_exit(u);p=0;break figureOutWhatToDo}if(this[t].superstateKey===u){p=0;break figureOutWhatToDo}if(this[u].superstateKey===this[t].superstateKey){this._ck_statechart_exit(u);p=0;break figureOutWhatToDo}if(this[u].superstateKey===t){this._ck_statechart_exit(u);p=-1;break figureOutWhatToDo}p=1;s=n[1]=this[t].superstateKey;if(s){s=this[s].superstateKey}while(s!==undefined){n[++p]=s;if(s===u){--p;break figureOutWhatToDo}else{s=this[s].superstateKey}}this._ck_statechart_exit(u);v=this[u].superstateKey;if(!v){break figureOutWhatToDo}else{u=v;x=p;do{z=n[x];if(z&&u===z){p=x-1;break figureOutWhatToDo}else{--x}}while(x>0)}for(;;){this._ck_statechart_exit(v);v=this[u].superstateKey;if(!v){p=0;break figureOutWhatToDo}else{u=v;var x=p;do{z=n[x];if(z&&u===z){p=x-1;break figureOutWhatToDo}else{s=this[u].superstateKey;u=s||null;--x;if(!u){p=-1;break}}}while(x>=0)}if(!u){p=-1;break}}}while(NO);if(p>0){do{this._ck_statechart_enter(n[p])}while((--p)>0)}if(p===0){this._ck_statechart_enter(this[w])}u=this[w];while(this._ck_statechart_init(this[w])===CK.Statechart.EVT_TRANSITION_RES){t=this[w];p=0;if(t!==u){t=n[++p]=this[t].superstateKey;if(t!==u){while(t!==u){t=n[++p]=this[t].superstateKey}}--p}if(p>0){do{this._ck_statechart_enter(n[p])}while((--p)>0)}if(p===0){this._ck_statechart_enter(this[w]);u=this[w]}}this.notifyPropertyChange(w);this._isDispatching=NO;return YES}else{this._isDispatching=NO;return YES}}},_ck_statechart_dispatch:function(b){},_ck_statechart_enter:function(b){return this[b](CK.Statechart.EVT_ENTER)},_ck_statechart_exit:function(b){return this[b](CK.Statechart.EVT_EXIT)},_ck_statechart_init:function(b){return this[b](CK.Statechart.EVT_INIT)},_ck_statechart_event:function(d,e,f){return this[d](e)}});SC.mixin(SC.Object.prototype,{_object_init:function(k){var f,g=(k)?k.length:0;for(f=0;f<g;f++){SC._object_extend(this,k[f])}SC.generateGuid(this);this.init();var h=this.initMixin;g=(h)?h.length:0;for(f=0;f<g;f++){h[f].call(this)}if(this.initial&&this.initStatechart){var j=this;if(!SC.isReady){SC.ready(function(){j.initStatechart()})}else{this.initStatechart()}}return this},initialStateKey:"initial",initStatechart:function(){var u=this.get("initialStateKey");var t=this.get("stateKey");var l=CK.Statechart._DISPATCH_PATH;var p,v,s,q,o,m,n;p=this[u];if(!p||!this[p]||!this[p].isState){return this}this[t]=p;this.hasStatechart=YES;this._ck_state_depth=0;this._ck_statechart_initStatechart();q=this[p].superstateKey;if(q!==undefined){m=0;while(q){l[++m]=q;q=this[q].superstateKey}do{this._ck_statechart_enter(l[m])}while((--m)>0)}this._ck_statechart_enter(this[t]);while(this._ck_statechart_init(this[t])===CK.Statechart.EVT_TRANSITION_RES){v=this[t];m=0;while(p!==v){q=this[v].superstateKey;if(q===undefined){break}else{v=l[++m]=q}}--m;if(m!==0){do{this._ck_statechart_enter(l[m])}while((--m)>0)}if(m===0){this._ck_statechart_enter(this[t])}p=this[t]}return this},shouldTrace:function(){var b=this.get("trace");return SC.none(b)?CK.Statechart.STATE_CHART_TRACE_ENABLED:b},destroyStatechart:function(){},_ck_statechart_initStatechart:function(){}});SC.mixin(SC.Object.prototype,{addStatechartObserver:function(d,f){var e=function(a,c,b,h){this.dispatch({sig:"propertyChanged",target:a,key:c,revision:h})};this.addObserver(d,f,e);return e},removeStatechartObserver:function(d,f,e){if(this.hasObserverFor(d)){this.removeObserver(d,f,e)}return this}});sc_require("system/init");sc_require("system/dispatch");CK.LOG_MOUSE_EVENTS=NO;var _ck_log=function(b){SC.debug(b)};var _ck_alert=function(b){SC.warn(b);alert(b)};SC.mixin(SC.Object.prototype,{_ck_statechart_initStatechart:function(){if(this.shouldTrace()){var b=this.get("ck_singleStep")?_ck_alert:_ck_log;b.call(this,"%@:initStatechart()".fmt(this))}},_ck_statechart_dispatch:function(d){if(this.shouldTrace()){var f=d.sig;if(!CK.LOG_MOUSE_EVENTS&&f.match(/^mouse+/)){return}var e=this.get("ck_singleStep")?_ck_alert:_ck_log;e.call(this,"%@:dispatch('%@')".fmt(this,f))}},_ck_statechart_enter:function(n){var k=this._ck_state_depth++;var l="";while(--k>=0){l=l+"  "}if(this.shouldTrace()){var j=this.get("ck_singleStep")?_ck_alert:_ck_log;j.call(this,l+'-> entering "'+n+'"')}var m=this[this.stateKey];var o=this[n](CK.Statechart.EVT_ENTER),h;if(this[this.stateKey]!==m){h='\nENTER STATE INVARIANT FAILURE\nYou MUST NOT CALL ck_transition() during the \'enter\' event. Your "%@" state\'s \'enter\' handler (or code somewhere else) called ck_transition("%@") while transitioning to "%@".';throw h.fmt(n,this[this.stateKey],m)}else{if(o!==CK.Statechart.EVT_HANDLED_RES&&o!==undefined){h="\nENTER STATE INVARIANT FAILURE\nThe only valid response from the 'enter' event is: \"return ck_handled() ;\" (or nothing at all). Your \"%@\" state's 'enter' handler returned: %@";throw h.fmt(n,o)}else{return o}}},_ck_statechart_exit:function(n){var k=this._ck_state_depth--;var l="";while(--k>0){l=l+"  "}if(this.shouldTrace()){var j=this.get("ck_singleStep")?_ck_alert:_ck_log;j.call(this,l+'<- leaving  "'+n+'"')}var m=this[this.stateKey];var o=this[n](CK.Statechart.EVT_EXIT),h;if(this[this.stateKey]!==m){h='\nEXIT STATE INVARIANT FAILURE\nYou MUST NOT CALL ck_transition() during the \'exit\' event. Your "%@" state\'s \'exit\' handler (or code somewhere else) called ck_transition("%@") while transitioning to "%@".';throw h.fmt(n,this[this.stateKey],m)}else{if(o!==CK.Statechart.EVT_HANDLED_RES&&o!==undefined){h="\nEXIT STATE INVARIANT FAILURE\nThe only valid response from the 'exit' event is: \"return ck_handled() ;\" (or nothing at all). Your \"%@\" state's 'exit' handler returned: %@";throw h.fmt(n,o)}else{return o}}},_ck_statechart_init:function(m){var k=this._ck_state_depth;var l="";while(--k>0){l=l+"  "}var g=this[m](CK.Statechart.EVT_INIT),j=this.get("stateKey");if(this.shouldTrace()&&g===CK.Statechart.EVT_TRANSITION_RES){var h=this.get("ck_singleStep")?_ck_alert:_ck_log;h.call(this,l+'  (taking default transition to "'+this[j]+'")')}return g},_ck_statechart_event:function(t,l,p){if(l.sig.match(/^mouse(Down|Dragged|Up|Over|Out|Moved)/)&&!CK.LOG_MOUSE_EVENTS){return}var s="";while(--p>0){s=s+"  "}var n=this[t](l),o=this.get("stateKey");if(this.shouldTrace()){var m=this.get("ck_singleStep")?_ck_alert:_ck_log;var q;var k=(l.sig==="keyDown"&&(q=l.getCharString()))?"%@(%@)".fmt(l.sig,q):l.sig;if(n){if(n===CK.Statechart.EVT_HANDLED_RES){m.call(this,s+'"'+t+"\" handled event '"+k+"' (no transition)")}else{if(n===CK.Statechart.EVT_TRANSITION_RES){m.call(this,s+'"'+t+"\" handled event '"+k+"' with a transition to \""+this[o]+'"')}}}else{m.call(this,s+'"'+t+"\" ignored event '"+k+"'")}}return n}});SC.mixin(SC.Object.prototype,{tryToPerform:function(e,g,f){var h;if(this.hasStatechart){if(g&&g instanceof SC.Event){g.sig=e;h=this.dispatch(g)}else{h=this.dispatch({sig:e,arg1:g,arg2:f})}}if(!h&&this.respondsTo(e)){h=this[e](g,f)!==NO}return h}});CK.Application=SC.Application.extend(SC.DelegateSupport,{isCloudKitApplication:YES,name:null,primaryServiceName:null,statechartPath:null,postMessageTargetOrigin:function(){var a="*";return a}.property(),steedOSWindow:function(){return window.parent}.property(),capitalizedName:function(){var a=this.get("name");return a&&(a.charAt(0)!=="i"?a=a.capitalize():a="i"+a.substring(1).capitalize()),a}.property("name").cacheable(),isReadyToTerminate:YES,isReadyToTerminateDidChange:function(){SteedOS.isReadyToTerminateDidChange(this.get("isReadyToTerminate"))}.observes("isReadyToTerminate"),delegate:null,init:function(){arguments.callee.base.apply(this,arguments),SC.Logger.set("outputMessagePrefix",this.get("capitalizedName")+":  "),CK.currentApplication=this;SC.suppressMain=YES;SC.Event.add(window,"message",this,"_messageWasReceived",null,!0)},setupBeforeUnloadHandler:function(){SC.Event.add(window,"beforeunload",this,function(){SteedOS.appWillUnload()})},_messageWasReceived:function(g){var k=g.originalEvent.data,d;try{d=SC.typeOf(k)!==SC.T_STRING?k:SC.json.decode(k)}catch(b){SC.warn(b);return}if(g.isProxyMessage){this.passMessage(d);return}if(!d.isSteedOSMessage){return}var f=URI(g.origin);if(f.protocol()!=="https"||f.domain()!=="steedos.com"){}var l=d.args||[],c=[this.get("delegate"),d.methodName],j,h;for(j=0,h=l.length;j<h;j++){c.push(l[j])}this.invokeDelegateMethod.apply(this,c)},applicationWillBecomeActive:function(){SC.debug("APPLICATION: Received applicationWillBecomeActive")},applicationDidBecomeActive:function(a){SC.debug("APPLICATION: Received applicationDidBecomeActive")},applicationWillSuspend:function(){SC.debug("APPLICATION: Received applicationWillSuspend")},applicationDidSuspend:function(){SC.debug("APPLICATION: Received applicationDidSuspend")},secondaryAuthDidSucceed:function(){SC.debug("APPLICATION: Received secondaryAuthDidSucceed")},secondaryAuthDidFail:function(){SC.debug("APPLICATION: Received secondaryAuthDidFail")},didFetchStartup:function(b,a,c){SC.debug("APPLICATION: Received didFetchStartup")},didReceiveNotification:function(a){SC.debug("APPLICATION: Received didReceiveNotification")},didLaunchWithNotification:function(a){SC.debug("APPLICATION: Received didLaunchWithNotification")},applicationShouldRefresh:function(a){SC.debug("APPLICATION: Received applicationShouldRefresh")},accountPreferencesDidChange:function(){SC.debug("APPLICATION: Received accountPreferencesDidChange")},userDidRevalidate:function(){SC.Request.manager.resumeAllServices()},routeDidChange:function(a){SC.debug("APPLICATION: Received routeDidChange")},_applicationShouldInvokeMain:function(g,k,d,b){!g&&!CK.currentApplication?CW.fatalError("No methodNames, we cannot continue."):g||(g=[]);var f=this,l,c,j;this._cloudOSState=k,CK.servicesController._setupFromBag(k.authBag);var h=window.SteedOS||SC.Object.create({isSteedOSProxy:YES});h.mixin(CK.SteedOSGetterSupport),h.set("appInstance",this),h.set("loadReason",d),h.isBeta=k.isBeta,h.isDeveloper=k.isDeveloper,h._SteedOSAPIMethodNames=g,window.SteedOS||(window.SteedOS=h);for(l=0,c=g.length;l<c;l++){j=g[l];if(window.SteedOS[j]!==undefined){continue}window.SteedOS[j]=function(){var a=j;return function(){var e=SC.$A(arguments);return f.invokeMethodOnSteedOS(a,e)}}()}this.setupBeforeUnloadHandler(),window.main(d,b)},invokeMethodOnSteedOS:function(d,b){var f={isSteedOSMessage:!0,methodName:d,appName:this.get("name"),args:b},c;try{c=JSON.stringify(f)}catch(a){SC.warn("There was a problem stringifying the message when sending message %@, %@",d,a);if(d!=="handleApplicationCrash"){return undefined}f.args=null,c=JSON.stringify(f)}return this.passMessage(c)},passMessage:function(a){window.parent.postMessage(a,"*")},_cloudOSStateChange:function(g){var c=g.authBag,j=g.accountPreferences,f=g.appPreferences,b=g.route;c&&(CK.servicesController._setupFromBag(c),this._cos_user_cache&&this._cos_user_cache.mixin(c.dsInfo)),j&&this._cos_account_preferences_cache&&this._cos_account_preferences_cache.mixin(j);if(f){var d=this._cloudOSState.appPreferences,h=d?d:{},a;for(a in f){h[a]=f[a]}this._cloudOSState.appPreferences=h}b!==undefined&&(this._cloudOSState.route=b)},_sleepCount:0,_sleep:function(){var a=this._sleepCount++;a===0&&(CW.Request.suspendResponses(),SC.backgroundTaskQueue.suspend(),SC.Module.suspend())},_wake:function(){var a=--this._sleepCount;a<0?(SC.warn("CK.Application._wake() was called without a paired _sleep() invocation; ignoring"),this._sleepCount=0):a===0&&(SC.Module.resume(),SC.backgroundTaskQueue.resume(),CW.Request.resumeResponses())},_hasReceivedFocus:function(){var b=window.$('[role="button"]');try{var a=b[0];a&&(a.setAttribute("tabindex","0"),a.blur(),a.focus())}catch(c){SC.info("_hasReceivedFocus(): Could not find a button on the page to focus: %@",c)}},_mouseMove:function(a){a.allowDefault=function(){},a.stopPropagation=function(){},SC.RootResponder.responder.mousemove(SC.Event.create(a))},_mouseUp:function(a){a.allowDefault=function(){},a.stopPropagation=function(){},SC.RootResponder.responder.mouseup(SC.Event.create(a))},windowApplication:{},windowApplicationMessages:{},passWindowApplicationMessage:function(g,c){var j=this.get("windowApplicationHost");if(!j){SC.warn("Cannot post a message to a CK.WindowApplication without a reference");return}var f=this.windowApplication[c],b=SC.$A(arguments);b=b.slice(2,b.length);var d=this.get("name"),h={isSteedOSMessage:!0,methodName:g,args:b,isWindowApplicationMessage:!0};try{f.CK.currentApplication._windowMessageWasReceived(SC.clone(h))}catch(a){SC.warn('postMessage: Window not properly loaded from "%@" for "%@"?',f?f.href:null,d),SC.warn(a)}},passPendingWindowApplicationMessages:function(d){var b=this.get("windowApplicationMessages")[d],f,c,a;if(!b){return}while(a=b.shift()){this.passWindowApplicationMessage(a.method,d,a.args)}},registerWindowApplicationMessage:function(d,b,f){var c=this.get("windowApplicationMessages"),a=c[f];a||(a=[],c[f]=a),a.push({method:d,args:b})}});CK.WindowApplication=CK.Application.extend({isWindowApplication:YES,windowInstanceId:CW.getUrlParameters().windowInstanceId||CW.UUID(),init:function(){arguments.callee.base.apply(this,arguments);var b=this;SC.ready(function(){var a=window.location.protocol+"//"+window.location.host;b.get("steedOSWindow").SteedOS.windowApplicationHasInitialized(a,window,b.get("windowInstanceId"))})},setupBeforeUnloadHandler:function(){var b=this;SC.Event.add(window,"beforeunload",this,function(){try{var d=b.get("windowInstanceId");b.get("steedOSWindow").SteedOS.windowApplicationWillClose(d);SteedOS.appWillUnload(YES,d)}catch(a){SC.warn("beforeunload handler could not call parent, maybe it is gone?");SC.warn(a)}})},steedOSWindow:function(){return window.opener}.property(),passMessage:function(h){var f=this.get("steedOSWindow"),g=SC.json.decode(h),e=g.methodName;this.invokeLast(function(){try{f.CK.currentApplication.passMessage(h)}catch(a){SC.warn("DOMWindow for SteedOS is gone? Cant deliver %@",e);SC.warn(a)}})},_windowMessageWasReceived:function(c){SC.RunLoop.end();var d={originalEvent:{data:c},origin:function(){var a=window.location.protocol+"//"+window.location.host;return a}};SC.run(function(){this._messageWasReceived(d)},this)},populateFields:function(b){},applicationWillBecomeActive:function(){},applicationDidBecomeActive:function(b){},applicationWillSuspend:function(){},applicationDidSuspend:function(){}});COS=SC.Object.create({NAMESPACE:"COS",VERSION:"1.0.0",CLIENT_ID:CW.upperCaseUUID(),REFRESH_WEB_AUTH_INTERVAL:25*60,PUSH_RETRY_WAIT:10,getCredentialsFromQueryParameters:function(){var j=CW.getUrlParameters(),f=null,h=j.user||j.username,g=j.pass||j.password,k=j.extended||j.extendedLogin;k=!!k;if(h&&g){if(SC.buildMode==="production"&&!CK.readCookie("ALLOW_CREDENTIALS")){SC.warn("Ignoring username/password in URL");return f}f={username:h,password:g,extendedLogin:k}}return f},handleApplicationCrash:function(b){CK.errorCatcher._handleError(b)},cloudOSStateForApp:function(f){var g=SteedOS.appManagerFor(f),h=SteedOS.authController.get("accountPreferences");var e={authBag:SteedOS.authController._auth_bag,accountPreferences:h?h.prefsHash():null,appPreferences:COS.prefsController.allAppPreferencesHash(),requestedStartupUrl:COS.appsController.getAppInfoFor(f).get("requestedStartupUrl"),id:COS.authController.generateId(COS.authController.getPath("user.steedosId")),environment:COS.authController.get("environment"),route:g.get("route"),currentlyActiveApplication:f,activeXFileVersion:SteedOS.ACTIVE_X_FILE_VERSION,hostname:SteedOS.get("hostname"),clientId:this.CLIENT_ID,isBeta:CK.isBeta,isDeveloper:CK.isDeveloper};return e}});COS.CloudOSLite=SC.Object.extend(SC.DelegateSupport,{isCloudOSLite:YES,userIsAuthenticated:NO,init:function(){arguments.callee.base.apply(this,arguments);var d=CK.currentApplication,b=CK.currentApplication.get("name");COS.apps[b]||(COS.appsController.createAppInfo(b,{}),COS.apps[b]={});var f=SC.Logger,c=f.get("outputMessagePrefix"),a;c&&c===CK.currentApplication.get("capitalizedName")+":  "&&SC.Logger.set("outputMessagePrefix",null);if(d.get("usesAuth")){SC.debug("CloudOSLite: setting the authController delegate to %@",this),COS.authController=a=COS.AuthController.create({delegate:this});if(!a.get("isLoadedFromSiteURL")){SC.error('CloudOSLite: Application was NOT loaded from "%@". Exiting here.',a.get("siteDomain"));return}}},setAppPreferences:function(b){var a=CK.currentApplication,c=a.get("name");COS.prefsController.savePreferences(c,b)},refreshAppPreferences:function(){var b=CK.currentApplication,a=b.get("name");COS.prefsController.getPreferences(a)},getStartupUrl:function(){var b=CK.currentApplication,a=b.get("name");return COS.startupController.getStartupUrl(a)},requestStartup:function(){var a=CK.currentApplication;return a&&COS.startupController.requestStartup(a.get("name")),this},setStartupUrl:function(b){var a=CK.currentApplication,c=a.get("name");COS.startupController.setStartupUrl(c,b)},setTitle:function(a){window.document.title=a},reload:function(){CK.reloadWithReason("call to reload")},exit:function(a){CK.errorCatcher.reportServerError({isFatal:!!a,error:"CloudOSLite exit()"})},setRoute:function(a){a&&(window.location.hash=a)},showSecondaryAuth:function(){},showHelp:function(a){COS.openHelp(CK.currentApplication,a)},showAppSwitcher:function(){},meCardUpdated:function(){},applicationIsReady:function(){var b=CK.currentApplication,a=b.get("name");SC.debug("CloudOSLite: applicationIsReady() called from %@",a);if(!b.isCloudKitApplication){throw"Application passed to applicationIsReady is not a CK.Application"}COS.appsController.getAppInfoFor(a).set("isReady",YES);var c=b.get("delegate");SC.debug("CloudOSLite: Invoking applicationWillBecomeActive and applicationDidBecomeActive"),b.invokeDelegateMethod(c,"applicationWillBecomeActive"),b.invokeDelegateMethod(c,"applicationDidBecomeActive")},startupDataIsLoaded:function(){},didReceiveSpecialResponse:function(b,a,c){},showLocalNotification:function(){},setBadgeCount:function(){},recordStat:function(c,a){var d=CK.currentApplication,b=d.get("name");COS.statsController.recordStat(b,c,a)},beginStat:function(c,a){var d=CK.currentApplication,b=d.get("name");COS.statsController.beginStat(b,c,a)},endStat:function(c,a){var d=CK.currentApplication,b=d.get("name");COS.statsController.endStat(b,c,a)},requestSent:function(){this._outstandingRequests===undefined&&(this._outstandingRequests=0),this._outstandingRequests++},requestReceived:function(b){this._outstandingRequests--;var a=CK.currentApplication,c=a.get("name");COS.statsController.recordLocationStat(c,"RequestInfo",b)},appWillUnload:function(){},isReadyToTerminateDidChange:function(a){},relayKeyboardShortcut:function(b,a,c){return CW.LOG_KEYBOARD_SHORTCUTS&&SC.info("CloudOSLite: Ignoring keyboard shortcut %@",c),NO},relayMouseMove:function(b,a){},loginUser:function(b,a,c){COS.authController.loginUser(b,a,c,function(){CloudOS.userDidAuthenticate(YES)})},logoutUser:function(a){COS.authController.logoutUser(a,YES,YES)},showAuth:function(){this._createAuthState()},userIsMobileMe:function(){this.loginDidFail()},userIsNotSignedUp:function(){this.loginDidFail()},userIsNotBetaQualified:function(){this.loginDidFail()},userIsNotDeveloperQualified:function(){this.loginDidFail()},userIsNotVerified:function(){this.loginDidFail()},userIsUnqualified:function(){this.loginDidFail()},loginDidSucceed:function(a){this.set("userIsAuthenticated",YES)},loginDidFail:function(a){this.set("userIsAuthenticated",NO)},validateDidSucceed:function(a){this.set("userIsAuthenticated",YES)},validateDidFail:function(a){this.set("userIsAuthenticated",NO),this.userDidNotAuthenticate()},logoutDidSucceed:function(){this.set("userIsAuthenticated",NO)},logoutDidFail:function(){this.set("userIsAuthenticated",NO)},userDidLogout:function(){this.set("userIsAuthenticated",NO)},userDidNotAuthenticate:function(a){this._initializeApp(NO)},userDidAuthenticate:function(f){var b=CK.currentApplication,h=b.get("name"),d=COS.appsController._appsInfo[h];if(this.get("userIsAuthenticated")){var a=d?d.get("requestedStartupUrl"):null,c=COS.authController.get("user"),g;COS.startupController.requestStartup(h),d&&COS.startupController.notifyStartup(d,YES),b.get("usesPush")&&(g=d?d.pushTopic:null,g?window.setTimeout(function(){SC.run(function(){COS.PushController.initiatePushConnection(CloudOS,g)})},3000):this._initActiveAppTimer())}this._initializeApp(YES)},_initializeApp:function(b){var a=CK.currentApplication,c=COS.cloudOSStateForApp(a.get("name"));if(b||!b&&!a.get("requiresAuth")){a._didInvokeMain?a._cloudOSStateChange(c):(a.invokeDelegateMethod(a,"_applicationShouldInvokeMain",null,c,CK.LOAD_REASON_USER_CLICK),a._didInvokeMain=YES)}!this._didCreateAuthState&&!b&&a.get("requiresAuth")&&a.get("supportsAuthUI")?this._createAuthState():this._didCreateAuthState&&b&&(AuthUI.authPane.hide(),COS.statechart=null,this._didCreateAuthState=null)},_createAuthState:function(){this._didCreateAuthState=YES,COS.statechart=SC.Statechart.create({trace:YES,monitorIsActive:NO,name:"cos-statechart",rootState:COS.AuthUIState.design()}),COS.AuthUIController.create({init:function(){arguments.callee.base.apply(this,arguments),CW.notificationCenter.subscribeToNotification("authModuleDidLoad",this,"authModuleDidLoad")},authModuleDidLoad:function(){AuthUI.authPane.show()},userDidCompleteFirstRun:function(){CloudOS.userDidAuthenticate(YES)}}),COS.statechart.initStatechart()},_initActiveAppTimer:function(){var a=SC.Timer.schedule({action:function(){var c=CK.currentApplication,b=c.get("delegate");c.invokeDelegateMethod(b,"applicationShouldRefresh")},interval:15000,repeats:YES});this.set("activeAppTimer",a)},handlePushNotification:function(b,a){var c=CK.currentApplication;c.invokeDelegateMethod(c,"didReceiveNotification",b)},handleApplicationCrash:function(b){var a=CK.currentApplication,c=a?a.get("name"):"cloudos";b=b?SC.clone(b,NO):{},c&&(b.applicationName=c),COS.handleApplicationCrash(b)},passMessageToAllApps:function(c,a,d){var b=CK.currentApplication;b.invokeDelegateMethod(b.get("delegate"),c,a,d)}});sc_require("core");COS.appsAll={workflow:{path:"workflow/",hasPreferences:YES,requiredServices:["keyvalue","uuflow","push"],pushTopic:"workflow",hasPushUI:YES},creator:{path:"creator/",hasPreferences:YES,requiredServices:["keyvalue","creator","push"],pushTopic:"creator",hasPushUI:YES},chat:{path:"chat/",hasPreferences:YES,requiredServices:["keyvalue","chat","push"],pushTopic:"chat",hasPushUI:YES},tasks:{path:"tasks/",hasPreferences:YES,requiredServices:["keyvalue"],pushTopic:"tasks",hasPushUI:YES},admin:{path:"admin/",hasPreferences:YES,requiredServices:["keyvalue","admin"],pushTopic:"admin",},bight:{path:"bight/",hasPreferences:YES,requiredServices:["ubiquity"],}};var urlQuery=window.URI.parseQuery(window.URI().query());var urlApps;if(urlQuery.apps){COS.apps={};urlApps=urlQuery.apps.split(",");for(app in COS.appsAll){if(urlApps.contains(app)){COS.apps[app]=COS.appsAll[app]}}}else{COS.apps=COS.appsAll}COS.AppInfo=SC.Object.extend({name:null,capitalizedName:function(){var b=this.get("name");if(b){if(b.charAt(0)!=="i"){b=b.capitalize()}else{b="i"+b.substring(1).capitalize()}}return b}.property("name").cacheable(),path:null,hasPreferences:NO,preferences:null,preferencesVersion:"",isReady:NO,isDisabled:NO,isUnqualified:NO,isRamped:NO,requiredServices:null,isQualifiedForBeta:YES,isQualifiedForDeveloper:YES,pushTopic:null,hasPushUI:NO,requestedStartupUrl:null,startupResponse:null,hasAccessToRequiredServices:function(){var f=this.get("requiredServices");if(!f){return YES}var d,e;for(d=0,e=f.length;d<e;d++){if(!CK.servicesController.getServiceInfoFor(f[d])){return NO}}return YES}.property("requiredServices").cacheable()});sc_require("system/apps.js");sc_require("models/app_info_model.js");COS.appsController=SC.Object.create({getAppInfoFor:function(d){if(!d){CW.fatalError("getAppInfoFor():  An application name must be specified")}var c=this._appsInfo;return c[d]||null},init:function(){var f=arguments.callee.base.apply(this,arguments),h=COS.apps,j={},g,k;for(g in h){k=h[g];if(k){k=SC.clone(k,YES);k.name=g;j[g]=COS.AppInfo.create(k)}else{SC.warn("COS.appsController:  Ignoring application %@ because it has no hash information in COS.apps",g)}}this._appsInfo=j;return f},_appsInfo:null});COS.AuthController=SC.Object.extend(SC.DelegateSupport,{delegate:null,isAuthenticated:NO,isAuthenticating:NO,instance:null,siteDomain:"steedos.com",isLoadedFromSiteURL:null,setupServer:"setup.steedos.com",validateURL:"https://setup.steedos.com/setup/ws/1/validate",loginURL:"https://setup.steedos.com/setup/ws/1/login",logoutURL:function(){var b=CK.servicesController;if(b.get("servicesInfoHasBeenReceived")){return b.getServiceUrlFor("account")+"/setup/ws/1/logout"}else{return"https://"+this.get("setupServer")+"/setup/ws/1/logout"}}.property(),environment:"PROD",_auth_bag:null,_user_cache:null,init:function(){var a=URI(window.location.href).domain();this.set("isLoadedFromSiteURL",(a===this.get("siteDomain")?YES:NO));if(!this.get("isLoadedFromSiteURL")){this.set("setupServer","setup.steedos.com")}else{var b=URI(window.location.href).subdomain();if(b===""||b==="www"){this.set("setupServer","setup.steedos.com")}else{if(b==="beta"){this.set("setupServer","setup-beta.steedos.com")}else{if(b==="developer"){this.set("setupServer","setup-developer.steedos.com")}}}}queryObject=window.URI.parseQuery(window.URI().query());if(queryObject.setup_server){this.set("setupServer",queryObject.setup_server)}this.set("validateURL","https://"+this.get("setupServer")+"/setup/ws/1/validate");this.set("loginURL","https://"+this.get("setupServer")+"/setup/ws/1/login")},user:function(){var c=this._auth_bag,d=this._user_cache||(this._user_cache=!c?null:CK.User.create(c.dsInfo));if(d&&!d._auth_bag){d._auth_bag=c}return d}.property(),accountPreferences:function(){return this._account_preferences_cache||(this._account_preferences_cache=!this._auth_bag?null:COS.AccountPreferences.create({user:this.get("user")}))}.property(),authBagApps:function(){var b=this._auth_bag;if(b){return b.apps}}.property(),clearUserState:function(){var b=this._user_cache;if(b){b.destroy()}this._auth_bag=null;this._user_cache=null;this._account_preferences_cache=null;CK.setValueInSessionStorage("pushToken","");CK.tryToPerform("clearLocalStorage")},validateUser:function(k,l){var j=this.get("delegate"),h=CK.readCookie("X-STEEDOS-WEBAUTH-RELOAD-HOST"),m=this,o,n;if(h){o=h.replace(/['"]/g,"")+"/setup/ws/1/validate"}else{o=this.get("validateURL")}n=COS.Request.postUrl(o,null);n.notify(200,this,function(e){var f=e.get("body"),c=m._parseAndDecodeBag(f),d,a;if(!c||!c.dsInfo||!c.webservices){SC.debug("Missing critial information in bag: %@",f);SC.debug("CloudKit: invoking validateDidFail");m.invokeDelegateMethod(j,"validateDidFail",e,c);return YES}d=c.dsInfo;if(!d.dsid){d.dsid=d.dsPrsID;delete d.dsPrsID}var b=SC.clone(m._auth_bag);m._auth_bag=c;m.notifyPropertyChange("user");m.set("isAuthenticating",NO);m.set("isAuthenticated",YES);if(c&&c.instance){m.set("instance",c.instance)}m._authCompleted(c,k,e,n,NO);SC.debug("COS: invoking validateDidSucceed with body %@",c);m.invokeDelegateMethod(j,"validateDidSucceed",c,b,l);return YES});n.notify(0,this,function(c){var a=c.get("body"),b=m._parseAndDecodeBag(a);m.set("isAuthenticating",NO);m.set("isAuthenticated",NO);if(b&&b.instance){m.set("instance",b.instance)}SC.debug("COS: invoking validateDidFail");m.invokeDelegateMethod(j,"validateDidFail",c,b,l);return YES});this.set("isAuthenticating",YES);SC.debug("COS: Sending validate POST request to %@",o);this.invokeDelegateMethod(j,"validateRequestWillBeSent");n.send()},loginUser:function(x,p,v,n,s,w){if(w){x=p=v=s=null}var z=this.get("loginURL"),q=COS.Request.postUrl(z,null),o=this.get("delegate"),t=this,y=NO;if(!s){q.queryParameter("dsid",null)}q.notify(200,this,function(d){var a=d.get("body"),b=t._parseAndDecodeBag(a),c;if(!b||!b.dsInfo||!b.webservices){SC.debug("Missing critial information in bag:  %@",a);SC.debug("COS: invoking loginDidFail");t.invokeDelegateMethod(o,"loginDidFail",d,b);return YES}c=b.dsInfo;if(!c.dsid){c.dsid=c.dsPrsID;delete c.dsPrsID}t._auth_bag=b;t.notifyPropertyChange("user");if(b&&b.instance){t.set("instance",b.instance)}t.set("isAuthenticating",NO);t.set("isAuthenticated",YES);t._authCompleted(b,n,d,q,YES);SC.debug("COS: invoking loginDidSucceed");t.invokeDelegateMethod(o,"loginDidSucceed",b);if(s){t.set("secondaryLoginAttemptsCount",0)}return YES});q.notify(0,this,function(c){var a=c.get("body"),b=t._parseAndDecodeBag(a);t.set("isAuthenticating",NO);if(!s){t.set("isAuthenticated",NO);SC.debug("COS: invoking loginDidFail");t.invokeDelegateMethod(o,"loginDidFail",c,b)}else{if(t.secondaryLoginAttemptsCount>=3){SC.info("CloudKit: More than three invalid secondary auth attempts, make sure we log out");t.logoutUser(function(){window.location.reload()},YES,YES)}else{if(s){if(n instanceof Function){n(c)}}else{SteedOS.statechart.sendAction("authDidNotValidate")}}}return YES});t.set("isAuthenticating",YES);var u=w||{username:x,password:p,id:this.generateId(x)};if(!SC.none(v)){u.extended_login=v}this.set("isAuthenticating",YES);SC.debug("CloudKit: Sending login POST request to %@",z);this.invokeDelegateMethod(o,"loginRequestWillBeSent");q.send(SC.json.encode(u))},generateId:function(c){var d=this.get("instance");if(!d||!c){return}return SHA1.hex_sha1(c+d)},logoutUser:function(g,f,h){if(h||(!h&&!SC.browser.msie)){if(h){var e=this;COS.pushController.unInitializePush(function(){e.sendLogoutRequest(g,f,h)})}else{this.sendLogoutRequest(g,f,h)}}this.clearUserState()},sendLogoutRequest:function(k,h,l){var o=this.get("logoutURL"),j=this.get("delegate"),m=this,n;if(!l){o+="?onunload=true"}this.set("hasLoggedOut",YES);n=COS.Request.postUrl(o,null);if(h===NO){n.set("isAsynchronous",h)}n.set("timeout",null);n.notify(200,this,function(a){m.set("isAuthenticating",NO);m.set("isAuthenticated",NO);SC.debug("CloudKit: invoking logoutDidSucceed");m.invokeDelegateMethod(j,"logoutDidSucceed");if(k instanceof Function){k(a)}return YES});n.notify(0,this,function(a){m.set("isAuthenticating",NO);m.set("isAuthenticated",NO);SC.debug("CloudKit: invoking logoutDidFail");m.invokeDelegateMethod(j,"logoutDidFail",a);if(k instanceof Function){k(a)}return YES});SC.debug("CloudKit: Sending logout POST request to %@",o);this.invokeDelegateMethod(j,"logoutRequestWillBeSent");n.send()},secondaryLoginAttemptsCount:0,secondaryLogin:function(h,k,f,g,j){this.secondaryLoginAttemptsCount++;this.loginUser(h,k,f,function(c){if(j instanceof Function){j(c);return}if(!g){return}var a=c&&c.get("status")===200?"secondaryAuthDidSucceed":"secondaryAuthDidFail",d;var b=CK.currentApplication;if(b){d=b.get("delegate");b.invokeDelegateMethod(d||b,a)}else{SteedOS.appManagerFor(g).passMessage(a)}},YES)},_authCompleted:function(U,Q,V,R,H){CK.servicesController._setupFromBag(U);var y=this.get("user"),S=y.get("statusCode"),N=this.get("delegate");if(CK.get("isBeta")&&!y.userIsBetaQualified()){SC.debug("The user is not beta qualified. Invoking delegate userIsNotBetaQualified()");this.invokeDelegateMethod(N,"userIsNotBetaQualified");this.clearUserState();return}else{if(CK.get("isDeveloper")&&!y.userIsDeveloperQualified()){SC.debug("The user is not developer qualified. Invoking delegate userIsNotDeveloperQualified()");this.invokeDelegateMethod(N,"userIsNotDeveloperQualified");this.clearUserState();return}else{if(y.get("statusCode")===CK.User.PAID_ACTIVE){SC.debug("The user is a MobileMe user, %@. Invoking delegate userIsMobileMe()",S);this.invokeDelegateMethod(N,"userIsMobileMe");this.clearUserState();return}else{if(y.get("statusCode")!==CK.User.FREE_QUALIFIED){SC.debug("The user is not signed up to SteedOS, %@. Invoking delegate userIsNotSignedUp()",S);this.invokeDelegateMethod(N,"userIsNotSignedUp");this.clearUserState();return}else{if(!y.get("primaryEmailIsVerified")){SC.debug("The user primary email is not verified. Invoking delegate userIsNotVerified()");this.invokeDelegateMethod(N,"userIsNotVerified");this.clearUserState();return}}}}}var T=COS.appsController._appsInfo,G=NO,L=YES,D=NO,P=this.get("authBagApps"),E,I,K,F,J,M,z,C,B;for(E in T){I=T[E];B=P[E];if(B){for(C in B){I.set(C,B[C])}}J=I.get("requiredServices");if(!J){continue}for(K=0,F=J.length;K<F;K++){M=J[K];if(!(z=CK.servicesController.getServiceInfoFor(M))){SC.debug("Auth bag did not contain service %@, disabling app %@",M,E);I.set("isDisabled",YES);if(!L&&E!=="find"){I.set("isUnqualified",YES);D=YES}}else{if(z.status==="inactive:ramped"){G=YES;I.set("isDisabled",YES);I.set("isRamped",YES)}}}}if(!L&&D){this.invokeDelegateMethod(N,"userIsUnqualified")}else{if(G){this.invokeDelegateMethod(N,"userIsRamped")}}this.set("isUserRamped",G);this.set("isUserUnqualified",!L&&D);if(G&&!CK.servicesController.getServiceInfoFor("mail")){T.mail.set("isDisabled",YES);T.mail.set("isRamped",YES)}var O=R._crossDomainMethod;if(O&&O!=="cors"){this._enqueIFrameLogoutRequest()}this.invokeDelegateMethod(N,"userHasAuthenticated");if(!COS.authController.getPath("accountPreferences.hasInitialized")){COS.prefsController.getPreferences(null,Q)}else{if(Q instanceof Function){Q(V,H)}}},_enqueIFrameLogoutRequest:function(){var o=SC.Request.manager,l=o.get("crossDomainIFrames"),h=this.get("logoutURL"),j=COS.Request.postUrl(h,null),k=j.get("destinationDomain"),m,n;m=function(){var a={url:j.getFullAddress(),type:j.get("type"),headers:j.get("headers"),body:j.get("body"),sendOnlyAtClose:YES};this.contentWindow.postMessage(SC.json.encode(a),k)};n=l?l[k]:null;if(n){m.call(n)}else{o._createCrossDomainIFrame(k,j.get("iFrameScriptLocation"));l=o.get("crossDomainIFrames");n=l[k];if(!n){CW.fatalError("We expected the logout iframe to be created by now")}n.onload=n.onreadystatechange=function(){if(!n.loaded&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){n.loaded=true;m.call(this)}}}},_parseAndDecodeBag:function(f){var e;try{e=SC.json.decode(f)}catch(d){SC.warn("Could not decode JSON: %@",d.message)}if(e){this.set("environment",e.environment||"PROD")}return e}});sc_require("controllers/auth_controller");COS.Request=CW.Request.extend({useCrossDomain:YES,withCredentials:YES,attachIdentifyingHeaders:NO,contentType:undefined,queryParametersOrder:["dsid"],init:function(){var j;arguments.callee.base.apply(this,arguments);if(this.get("useCrossDomain")){j=this.get("contentType");if(j===undefined){j="text/plain";this.set("contentType",j)}}if(!j){j=this.get("contentType")}if(j){this.header("Content-Type",j)}var g=COS.authController;var l=g.getPath("user.dsid"),f=this.get("address");if(l&&(!f||f.indexOf("dsid=")===-1)){this.queryParameter("dsid",l)}var k=g.generateId(g.getPath("user.steedosId"));if(k){this.queryParameter("id",k)}var h=g.getPath("user.steedosId");if(h){this.queryParameter("steedosId",h)}this.queryParameter("clientId",COS.CLIENT_ID);this.queryParameter("clientBuildNumber",SC.buildNumber)},willSend:function(){var b=arguments.callee.base.apply(this,arguments);if(window.SteedOS){SteedOS.requestSent()}return b},willReceive:function(){var b=arguments.callee.base.apply(this,arguments);if(window.SteedOS){SteedOS.requestReceived()}return b}});sc_require("system/request");COS.prefsController=SC.Object.create(SC.DelegateSupport,{delegate:null,_lastKnownAccountPrefs:{},getPreferences:function(l,f){var q=[],m=COS.apps,p;if(l){q.push({"app-id":l,"registry-version":""})}else{q.push({"app-id":"account","registry-version":""});for(p in m){if(m[p].hasPreferences){q.push({"app-id":p,"registry-version":""})}}}var s=CK.servicesController.getServiceUrlFor("keyvalue",YES)+"/json/sync";var n=COS.Request.create({type:"POST",address:s,isJSON:YES,applicationName:l,COPY_KEYS:COS.Request.prototype.COPY_KEYS.concat(["applicationName"])});var o={"service-id":"prefs",apps:q};n.notify(200,this,this.getPreferencesDidSucceed,f);n.notify(0,this,this.getPreferencesDidFail,f);SC.debug("CloudKit: requesting preferences");var h=this.get("delegate");this.invokeDelegateMethod(h,"getPreferencesRequestWillBeSent");n.send(o)},getPreferencesDidSucceed:function(E,t){var p=E.get("body"),v=COS.appsController,B,q,x,u,w,D,C,z,s,y;if(!p||p.status!==0){this.getPreferencesDidFail(E);return}for(w=0,D=p.apps.length;w<D;w++){q=p.apps[w];B=q["app-id"];s=q.keys;y=q["registry-version"];if(B){x=v.getAppInfoFor(B);if(x){z={};if(s){s.forEach(function(a){z[a.name]=a.data})}x.set("preferences",z);x.set("preferencesVersion",y)}else{if(B==="account"){C=COS.authController.get("accountPreferences");if(C&&s){C.set("preferencesVersion",y);s.forEach(function(a){C.set(a.name,a.data)});this._lastKnownAccountPrefs=C.prefsHash();C.set("hasInitialized",YES)}}else{SC.error("COS:  Cannot find application information for %@",B)}}}}SC.debug("COS:  Successfully retrieved the preferences");if(t instanceof Function){t.call(this,E)}return YES},getPreferencesDidFail:function(f,h){var j=f.getPath("request.applicationName"),k=f.get("body"),g=k?k.status:null;SC.debug("COS:  There was an error getting the preferences, status %@, body %@, preferencesStatus '%@'",f.get("status"),f.get("body"),g);if(h instanceof Function){h.call(this,f)}return YES},savePreferences:function(C,I,G){if(SC.typeOf(I)!==SC.T_HASH){SC.debug("CloudKit: preferences to save is not hash");return}var v=COS.appsController,z=v.getAppInfoFor(C),F=this.get("delegate"),L,E,H;if(z){E=z.get("preferences");L=z.get("preferencesVersion");if(CW.valuesAreEqual(I,E)){SC.debug("CloudKit: Preferences did not change for %@, so will not send to server.",C);return}else{this.invokeDelegateMethod(F,"passMessageToAllApps","_cloudOSStateChange",{appPreferences:function(){var a={};a[C]=I;return a}()})}}else{if(C==="account"){E=COS.authController.get("accountPreferences");L=E&&E.get("preferencesVersion");if(!E){CW.fatalError("CloudKit: Account Preferences object not found!")}var w=E.get("prefsList"),y=0,B,x,u,e;for(B=0,x=w.length;B<x;B++){u=w[B];if(this._lastKnownAccountPrefs[u]===I[u]){I[u]=undefined}else{y++;this._lastKnownAccountPrefs[u]=I[u]}}if(y===0){SC.debug("CloudKit: No account preferences changed");return}else{this.invokeDelegateMethod(F,"passMessageToAllApps","_cloudOSStateChange",{accountPreferences:I})}}else{SC.debug("CloudKit: cannot save preferences for unknown app %@",C);return}}var K=CK.servicesController.getServiceUrlFor("keyvalue",YES)+"/json/sync";var J=COS.Request.create({type:"POST",address:K,applicationName:C,COPY_KEYS:COS.Request.prototype.COPY_KEYS.concat(["applicationName","newPrefs"])});H=this.hashToPrefKeys(I);var D={"service-id":"prefs",apps:[{"app-id":C,"registry-version":L||"",keys:H}]};J.set("body",D);J.notify(200,this,this.savePreferencesDidSucceed,G);J.notify(0,this,this.savePreferencesDidFail,G);SC.debug("COS:  Saving preferences for %@",C);this.invokeDelegateMethod(F,"savePreferencesRequestWillBeSent");J.send(SC.json.encode(D));if(z){z.set("preferences",I)}},clearPreferences:function(n){var u=COS.Request.create({type:"POST",address:"/json/wipe"});var o=COS.appsController,s,q,m,v,x;var w={"service-id":"prefs",apps:[]};w.apps.push("account");for(x in COS.apps){if(COS.apps.hasOwnProperty(x)&&COS.apps[x].hasPreferences){w.apps.push(x)}}var p=u.get("address"),t=CK.servicesController.getServiceUrlFor("keyvalue",YES);u.set("address",t+p);u.set("body",w);u.notify(200,this,this.clearPreferencesDidSucceed,n);u.notify(0,this,this.clearPreferencesDidFail,n);SC.debug("COS: Clearing all preferences...");u.send(SC.json.encode(w))},clearPreferencesDidSucceed:function(o,k){var j=SC.json.decode(o.get("body")),m=COS.appsController,l,n,h;if(!j.status||j.status!==0){this.clearPreferencesDidFail(o,k);return}if((h=COS.authController.get("user"))){h.set("preferences",{})}for(l in COS.apps){n=m.getAppInfoFor(l);if(n){n.set("preferences",{})}}},clearPreferencesDidFail:function(d,c){SC.error("COS:  There was an error clearing all preferences, status %@",d.get("status"));if(c instanceof Function){c()}return YES},savePreferencesDidSucceed:function(w,p){var s=w.getPath("request.applicationName"),x=w.get("body"),n,v,t,q,o,u=NO;if(!x){return this.savePreferencesDidFail(w)}var m=SC.json.decode(x);if(!m||m.status!==0){return this.savePreferencesDidFail(w,p)}t=m.apps[0]["registry-version"];o=m.apps[0]["keys"];o.forEach(function(a){q=a["update-status"];if(q!==undefined&&q!==0){SC.debug("CloudKit: error updating preferences key %@, update-status is %@",a.name,q);u=YES}});if(u){return this.savePreferencesDidFail(w)}n=COS.appsController.getAppInfoFor(s);if(n){v=n.get("preferences");n.set("preferencesVersion",t)}else{if(s==="account"){v=COS.authController.get("accountPreferences");v.set("preferencesVersion",t)}}if(!v){return this.savePreferencesDidFail(w)}if(p instanceof Function){p()}SC.debug("CloudKit: successfully saved preferences for %@",s);return YES},savePreferencesDidFail:function(e,f){var d=e.getPath("request.applicationName");SC.error("COS:  There was an error saving the preferences for %@, status %@",d,e.get("status"));if(f instanceof Function){f()}this.getPreferences();return YES},hashToPrefKeys:function(h){var f=[],e,g;for(e in h){g=h[e];if(g!==undefined){f.push({name:e,data:g})}}return f},allAppPreferencesHash:function(){var f={},h=COS.appsController,e,g;for(g in COS.apps){if(COS.apps.hasOwnProperty(g)&&COS.apps[g].hasPreferences){e=h.getAppInfoFor(g);if(e){f[g]=e.get("preferences")}}}return f},notifyAccountPreferencesDidChange:function(){var b=this.get("delegate");this.invokeDelegateMethod(b,"passMessageToAllApps","accountPreferencesDidChange")}});COS.PushController=SC.Object.extend({webCourierURL:null,pushToken:null,delegate:null,cosPushTopics:[],hasPushConnection:null,registeredPushTopics:null,pushTTL:600,appsMissingPushTopic:null,missingPushTopics:null,init:function(){var g=COS.appsController._appsInfo,e=[],h=[],f;for(f in g){if(g[f].get("pushTopic")){e.push(f)}else{h.push(f)}}this.set("appsMissingPushTopic",h);this.set("pushApps",e);return arguments.callee.base.apply(this,arguments)},pushTopics:function(){var j=COS.appsController._appsInfo,h=SC.clone(this.get("cosPushTopics")),f,k,g;for(g in j){k=j[g];f=k.get("pushTopic");if(f&&k.get("hasAccessToRequiredServices")){h.push(f)}}return h}.property().cacheable(),pushApps:null,isRegisteredToAllTopics:function(){var g=this.get("pushTopics"),h=this.get("registeredPushTopics"),e,f;if(!h||!this.get("pushToken")){return NO}for(e=0,f=g.length;e<f;e++){if(h.indexOf(g[e])===-1){return NO}}return YES}.property("registeredPushTopics","pushToken"),registerPhoneGapPushConnection:function(){var b=this;if(!window.cordova||!window.cordova.exec||!window.plugins||!window.plugins.pushNotification||!window.plugins.pushNotification.register){this.invokeLater(function(){b.registerPhoneGapPushConnection()},1000);return}if(CW.isiOSApp()){SC.info("Push: Registering ios device ...");var a=window.plugins.pushNotification;a.register(this.registerPhoneGapPushConnectionSuccess,this.registerPhoneGapPushConnectionFailed,{badge:"true",sound:"true",alert:"true",ecb:"COS.pushController.onNotificationAPN"})}else{if(CW.isAndroidApp()){SC.info("Push: Registering android device ...");var a=window.plugins.pushNotification;a.register(this.registerPhoneGapPushConnectionSuccess,this.registerPhoneGapPushConnectionFailed,{senderID:"355450467200",ecb:"COS.pushController.onNotificationGCM"})}}},registerPhoneGapPushConnectionSuccess:function(a){SC.info("Push: Registered success:"+JSON.stringify(a));if(CW.isiOSApp()){COS.pushController.set("pushToken",a);COS.pushController.set("missingPushTopics",COS.pushController.get("pushTopics"));COS.pushController.registerMissingTopics()}},registerPhoneGapPushConnectionFailed:function(a){SC.error("Push: Registering failed:"+JSON.stringify(a))},onNotificationAPN:function(b){SC.info("APN Push: received "+JSON.stringify(b));var c=COS.pushController.get("delegate");if(c){var a=JSON.stringify(b);c.invokeDelegateMethod(c,"handlePushNotification",a)}if(b.badge){window.plugins.pushNotification.setApplicationIconBadgeNumber(function(){},function(){},b.badge)}},onNotificationGCM:function(b){SC.info("GCM Push: received "+JSON.stringify(b));switch(b.event){case"registered":if(b.regid.length>0){SC.info("GCM Push: registered, regID = "+b.regid);COS.pushController.set("pushToken",b.regid);COS.pushController.set("missingPushTopics",COS.pushController.get("pushTopics"));COS.pushController.registerMissingTopics()}break;case"message":if(b.foreground){SC.info("GCM Push: foreground notification.")}else{if(b.coldstart){SC.info("GCM Push: coldstart notification.")}else{SC.info("GCM Push: background notification.")}}if(b.payload.message){SC.info("GCM Push: message: "+b.payload.message)}if(b.payload.msgcnt){SC.info("GCM Push: message count: "+b.payload.msgcnt);window.plugins.pushNotification.setApplicationIconBadgeNumber(function(){},function(){},b.payload.msgcnt)}var c=COS.pushController.get("delegate");if(c){var a=(b.payload);if(a.message){a.alert=b.payload.message}if(b.payload.msgcnt){a.badge=b.payload.msgcnt}if(b.payload.soundname){a.sound=b.payload.soundname}c.invokeDelegateMethod(c,"handlePushNotification",a)}break;case"error":SC.error("GCM Push: error: "+b.msg);break;default:SC.error("GCM Push: Unknown, an event was received and we do not know what it is");break}},initiatePushConnection:function(c,d){if(c){this.set("delegate",c)}if(CW.isiOSApp()||CW.isAndroidApp()){this.registerPhoneGapPushConnection()}else{var e=CK.getValueFromSessionStorage("pushToken");if(e){SC.debug("initializePush(): Found pushToken from existing session");this.set("pushToken",e);this.set("missingPushTopics",this.get("pushTopics"));this.registerMissingTopics();return}if(!this.get("pushToken")){this.initializePush(d);this.startRefreshWebAuthTimer()}else{this.parkConnectionIfAppropriate()}}},increaseAttemptCount:function(f){var g="_attemptCount_"+f,h=this[g],e;this[g]=e=!h?1:h+1;SC.info("COS.pushController: Attempt #%@ for '%@'",e,f);return e},resetAttemptCount:function(d){var c="_attemptCount_"+d;this[c]=0},scheduleAttempt:function(g){var m="_attemptCount_"+g,k=this[m];if(!k){this[m]=k=1}var l="_attemptTimer_"+g,j=this[l];if(j){SC.warn("COS.pushController: There is already an attemptTimer for %@",g);return}var h=COS.PUSH_RETRY_WAIT;SC.debug("COS.pushController: Scheduling '%@' in %@ seconds",g,h);this[l]=this.invokeLater(function(){this[l]=null;this[g]()},h*1000)},parkConnectionIfAppropriate:function(){var d=this.get("pushToken"),c=this;if(!d){SC.info("COS.pushController: Missing pushToken, cannot park a connection without it")}else{if(this.get("hasPushConnection")===YES){SC.info("COS.pushController: A connection is already parked with pushToken=%@",d);return}}if(!window.SteedOS||!SteedOS.isSteedOSClient){this.invokeLater(function(){COS.pushController.parkConnection()},500);return}SteedOS.runWhenReady(function(){c.invokeLater(function(){COS.pushController.parkConnection()},1000)})},initializePush:function(l){if(this.get("hasPushConnection")===YES&&this.get("pushToken")){SC.warn("We already have an established push connection");return}if(this._isInitiatingPushConnection){SC.warn("Already initiating push connection");return}var m=CK.servicesController.getServiceUrlFor("push",NO)+"/getToken",g=this.get("pushTTL"),k=this.increaseAttemptCount("initializePush"),h;var j=COS.Request.create({type:"POST",address:m,isJSON:YES});j.notify(200,this,function(v){var w=v.get("body"),e=w.pushToken,x=w.pushTokenTTL,d=w.errors,a=this.get("delegate"),u=w.registeredTopics,c,t,f,y;if(d){var b=this.get("missingPushTopics")||[];for(c=0,t=d.length;c<t;c++){f=d[c];y=f.pushTopic;SC.info("COS.pushController: initializePush error - "+f.errorMessage+" - "+y);if(u&&u.indexOf(y)!==-1){continue}if(b&&b.indexOf(y)===-1){b.push(y)}}this.set("missingPushTopics",b);if(b.length>0){this.scheduleAttempt("registerMissingTopics")}}SC.debug("Push token acquired: %@",e);this.set("pushToken",e);this.set("webCourierURL",w.webCourierURL);if(x){this.set("pushTTL",x)}CK.setValueInSessionStorage("pushToken",e);if(a){a.invokeDelegateMethod(a,"didInitializePush",w)}this.set("registeredPushTopics",u);this._isInitiatingPushConnection=NO;this.parkConnectionIfAppropriate();return YES});j.notify(400,this,function(a){SC.debug("%@ received from pushws. Reverting to polling for this session.",a.get("status"));this._isInitiatingPushConnection=NO;return YES});j.notify(0,this,function(a){SC.debug("Failed to aquire push token.");this.set("hasPushConnection",NO);this.set("pushToken",null);this._isInitiatingPushConnection=NO;this.scheduleAttempt("initializePush");return YES});j.queryParameter("attempt",k);h={pushTopics:l?[l]:this.get("pushTopics"),pushTokenTTL:g};this._isInitiatingPushConnection=YES;j.send(h)},parkConnection:function(g){if(SC.browser.isIE){return}if(CW.isiOSApp()||CW.isAndroidApp()){return}if(this.get("hasPushConnection")===YES&&!g){SC.warn("We already have an established push connection");return}var f=this.get("webCourierURL")+"?tok=%@&ttl=%@".fmt(this.get("pushToken"),this.get("pushTTL")),h=COS.Request.postUrl(f),e=this.increaseAttemptCount("parkConnection");h.set("timeout",this.get("pushTTL")*1000);h.set("withCredentials",NO);h.willSend=null;h.willReceive=null;h.notify(200,this,function(b){var a=b.get("body"),c=this.get("delegate");SC.debug("Received push notification: %@",a);if(c){c.invokeDelegateMethod(c,"handlePushNotification",a)}this.resetAttemptCount("parkConnection");this.invokeLater(function(){COS.pushController.parkConnection(YES)},500);return YES});h.notify(408,this,function(a){SC.debug("409: Request Time-out");this.set("hasPushConnection",NO);this.scheduleAttempt("parkConnection");return YES});h.notify(409,this,function(a){SC.debug("409: Re-parked multiple connections with the same pushToken");this.set("hasPushConnection",NO);this.scheduleAttempt("parkConnection");return YES});h.notify(403,this,function(b){SC.debug("403: The pushToken has expired");var a=this;SC.info("Unregistering the topics before trying again...");this.unInitializePush(function(){a.scheduleAttempt("initializePush")});CK.errorCatcher.reportServerError({title:"APNS 403 response",log:"(omitted)",showDialog:NO});this.set("hasPushConnection",NO);this.set("pushToken",null);return YES});h.notify(0,this,function(a){SC.debug("Unknown error: The park push connection closed unexpectedly");this.set("hasPushConnection",NO);this.scheduleAttempt("parkConnection");return YES});h.clearQueryParameters();h.send();this._pushConnection=h;this.set("hasPushConnection",YES)},registerMissingTopics:function(){var o=this.get("missingPushTopics"),m=this.get("pushToken");if(!o||o.length===0){SC.info("COS.pushController: No missing pushTopics found.");return}if(!m){SC.warn("COS.pushController: You need a pushToken before you can call registerMissingTopics");this.scheduleAttempt("initializePush");return}var n=CK.servicesController.getServiceUrlFor("push",NO)+"/registerTopics",h=this.get("pushTTL"),l=this.increaseAttemptCount("registerMissingTopics"),j;if(CW.isiOSApp()){n=CK.servicesController.getServiceUrlFor("push",NO)+"/registerAPNS"}if(CW.isAndroidApp()){n=CK.servicesController.getServiceUrlFor("push",NO)+"/registerGCM"}var k=COS.Request.create({type:"POST",address:n,isJSON:YES});k.notify(200,this,function(t){var v=t.get("body"),c=v.errors,u=v.registeredTopics,a=this.get("missingPushTopics")||[],b,g,d,e,w;if(c){for(b=0,g=c.length;b<g;b++){e=c[b];w=e.pushTopic;SC.info("COS.pushController: registerTopics error - "+e.errorMessage+" - "+w);if(!a){this.set("missingPushTopics",[w])}else{if(a&&a.indexOf(w)===-1){a.push(w)}}}this.set("missingPushTopics",a)}if(u){for(b=0,g=u.length;b<g;b++){w=u[b];d=a.indexOf(w);if(a&&d!==-1){a.splice(d,1)}var f=this.get("registeredPushTopics");if(!f){this.set("registeredPushTopics",[w])}else{if(f.indexOf(w)===-1){f.push(w)}}}}if(a.length>0){this.scheduleAttempt("registerMissingTopics")}else{this.resetAttemptCount("registerMissingTopics")}this.set("webCourierURL",v.webCourierURL);this.parkConnectionIfAppropriate();return YES});k.notify(400,this,function(a){SC.debug("%@: Failed to register topics, backing off, %@",a.get("status"),o);return YES});k.notify(0,this,function(a){SC.debug("Unknown error: Failed to register topics, %@",o);this.scheduleAttempt("registerMissingTopics");return YES});SC.debug("Registering push topics, %@",o);j={pushToken:m,pushTopics:o,pushTokenTTL:h};k.queryParameter("attempt",l);k.send(j)},refreshWebAuth:function(){var d=CK.servicesController.getServiceUrlFor("push",NO)+"/refreshWebAuth";var c=COS.Request.create({type:"GET",address:d,isJSON:YES});c.notify(0,this,function(a){return YES});c.send()},startRefreshWebAuthTimer:function(){if(this.get("refreshWebAuthTimer")){return}var b=SC.Timer.schedule({target:this,action:"refreshWebAuth",interval:(COS.REFRESH_WEB_AUTH_INTERVAL*1000),repeats:YES});SC.debug("Started refreshWebAuthTimer");this.set("refreshWebAuthTimer",b)},stopRefreshWebAuthTimer:function(){var b=this.get("refreshWebAuthTimer");if(!b){return}b.invalidate();this.set("refreshWebAuthTimer",null);SC.debug("Stopped refreshWebAuthTimer")},unInitializePush:function(h){var k=this.get("pushToken");if(this.get("hasPushConnection")!==YES&&!k){if(h instanceof Function){h()}return}var f=CK.servicesController.getServiceUrlFor("push",NO)+"/unregisterTopics";if(CW.isiOSApp()){j=CK.servicesController.getServiceUrlFor("push",NO)+"/unregisterAPNS"}if(CW.isAndroidApp()){j=CK.servicesController.getServiceUrlFor("push",NO)+"/unregisterGCM"}var g={pushToken:k,pushTopics:this.get("pushTopics")};var j=COS.Request.create({type:"POST",address:f,isJSON:YES});j.notify(200,this,function(a){SC.info("COS.pushController: Successfully uninitialized push");if(h instanceof Function){h(a)}return YES});j.notify(0,this,function(a){SC.debug("COS.pushController: Failed to uninitialize push.");if(h instanceof Function){h(a)}return YES});j.send(g)}});COS.PushController.mixin({initiatePushConnection:function(c,d){if(!COS.pushController){COS.pushController=COS.PushController.create()}COS.pushController.initiatePushConnection(c,d)}});sc_require("system/request");COS.startupController=SC.Object.create({getStartupUrl:function(e){var f=COS.authController.get("accountPreferences"),d;if(f){d=f.get("startupUrls");if(d){return d[e]}}},setStartupUrl:function(g,f){var j=COS.authController.get("accountPreferences"),k,h;if(j){k=j.get("startupUrls");h=(k&&SC.typeOf(k)===SC.T_HASH)?k:{};if(f&&!this._isValidStartupUrl(f)){SC.warn("Startup url %@ for %@ is not valid",f,g);return}f=CK.removeQueryParamsToOmitForStartupCaching(f);if(h[g]!==f){SC.debug("Storing new startup url %@ for %@",f,g);h[g]=f;j.set("startupUrls",h);j.commitStartupUrls()}}},requestStartup:function(g){var k=COS.appsController.getAppInfoFor(g),h;if(!k){SC.error("COS: Cannot find application information for application %@",g)}var f=this.getStartupUrl(g);if(this._isValidStartupUrl(f)){this.setStartupUrl(g,f);var j=COS.Request.create({type:"GET",applicationName:g,COPY_KEYS:COS.Request.prototype.COPY_KEYS.concat(["applicationName"]),address:f,timeout:30000});j.notify(200,this,this.fetchStartupDidSucceed,g);j.notify(0,this,this.fetchStartupDidFail,g);j.send();SC.debug("COS: Requesting startup for %@ with url %@",g,f);k.set("requestedStartupUrl",f)}},_isValidStartupUrl:function(d){if(!d){return NO}var c=URI(d);if(d&&c.protocol()==="https"&&c.domain()==="steedos.com"){return YES}else{return NO}},fetchStartupDidSucceed:function(d,e){var f=COS.appsController.getAppInfoFor(e);if(!f){SC.error("COS: No application info found for application %@".fmt(applicationName))}f.set("startupResponse",d);this.notifyStartup(f);return YES},fetchStartupDidFail:function(c,d){SC.warn("COS: There was an error request startup URL for application %@".fmt(d));this.setStartupUrl(d,null);return YES},notifyStartup:function(o,l){var n=o.get("startupResponse"),h,m,j;if(n){m=n.get("body");j=n.get("status");var k=CK.currentApplication;if(k){k.invokeDelegateMethod(k.get("delegate"),"didFetchStartup",m,j)}else{h=SteedOS.appManagerFor(o.get("name"));if(!h||!h.get("isLoaded")){SC.debug("COS: We received a response to 'startup' for %@ but cannot notify it yet, as were waiting for it to be running",o.get("name"));return}h.passMessage("didFetchStartup",m,j,h.benchmarks())}SC.debug("COS: Gave startup response to the app");o.set("startupResponse",null)}}});COS.AccountPreferences=CK.AccountPreferences.extend({preferencesVersion:"",startupUrls:null,prefsList:["locale","timeZone","timezoneName","lastDismissedMotm","viewPushNotifications"],prefsOmittedFromNotification:["locale","lastDismissedMotm"],prefsHash:function(){var h=this.get("prefsList"),j={},k,f,g;for(f=0,g=h.length;f<g;f++){k=h[f];if(this.get(k)!==null&&this.get(k)!==undefined){j[k]=this.get(k)}}return j},commit:function(b){if(this._commitTimer){this._commitTimer.invalidate()}this._commitTimer=null;COS.prefsController.savePreferences("account",this.prefsHash(),b)},commitLater:function(d,c){if(this._commitTimer){this._commitTimer.invalidate()}this._commitTimer=this.invokeLater("commit",d,c)},commitStartupUrls:function(c){var d={startupUrls:this.get("startupUrls")};COS.prefsController.savePreferences("account",d,c)},set:function(d,c){if(this.get("hasInitialized")&&this.prefsOmittedFromNotification.indexOf(d)===-1&&this.prefsList.indexOf(d)!==-1&&this[d]!==c){COS.prefsController.invokeOnce(COS.prefsController.notifyAccountPreferencesDidChange)}return arguments.callee.base.apply(this,arguments)}});SC.stringsFor("English",{"SC.Date.Era.AD.Abbreviated":"AD","SC.Date.Era.AD.Full":"Anno Domini","SC.Date.Era.AD.Letter":"A","SC.Date.Era.BC.Abbreviated":"BC","SC.Date.Era.BC.Full":"Before Christ","SC.Date.Era.BC.Letter":"B","SC.Date.Quarter.Q1.Abbreviated":"Q1","SC.Date.Quarter.Q1.Full":"1st quarter","SC.Date.Quarter.StandAlone.Q1.Abbreviated":"Q1","SC.Date.Quarter.StandAlone.Q1.Full":"1st Quarter","SC.Date.Quarter.Q2.Abbreviated":"Q2","SC.Date.Quarter.Q2.Full":"2nd quarter","SC.Date.Quarter.StandAlone.Q2.Abbreviated":"Q2","SC.Date.Quarter.StandAlone.Q2.Full":"2nd Quarter","SC.Date.Quarter.Q3.Abbreviated":"Q3","SC.Date.Quarter.Q3.Full":"3rd quarter","SC.Date.Quarter.StandAlone.Q3.Abbreviated":"Q3","SC.Date.Quarter.StandAlone.Q3.Full":"3rd Quarter","SC.Date.Quarter.Q4.Abbreviated":"Q4","SC.Date.Quarter.Q4.Full":"4th quarter","SC.Date.Quarter.StandAlone.Q4.Abbreviated":"Q4","SC.Date.Quarter.StandAlone.Q4.Full":"4th Quarter","SC.Date.Month.January.Abbreviated":"Jan","SC.Date.Month.January.Full":"January","SC.Date.Month.January.Letter":"J","SC.Date.Month.StandAlone.January.Abbreviated":"Jan","SC.Date.Month.StandAlone.January.Full":"January","SC.Date.Month.StandAlone.January.Letter":"J","SC.Date.Month.February.Abbreviated":"Feb","SC.Date.Month.February.Full":"February","SC.Date.Month.February.Letter":"F","SC.Date.Month.StandAlone.February.Abbreviated":"Feb","SC.Date.Month.StandAlone.February.Full":"February","SC.Date.Month.StandAlone.February.Letter":"F","SC.Date.Month.March.Abbreviated":"Mar","SC.Date.Month.March.Full":"March","SC.Date.Month.March.Letter":"M","SC.Date.Month.StandAlone.March.Abbreviated":"Mar","SC.Date.Month.StandAlone.March.Full":"March","SC.Date.Month.StandAlone.March.Letter":"M","SC.Date.Month.April.Abbreviated":"Apr","SC.Date.Month.April.Full":"April","SC.Date.Month.April.Letter":"A","SC.Date.Month.StandAlone.April.Abbreviated":"Apr","SC.Date.Month.StandAlone.April.Full":"April","SC.Date.Month.StandAlone.April.Letter":"A","SC.Date.Month.May.Abbreviated":"May","SC.Date.Month.May.Full":"May","SC.Date.Month.May.Letter":"M","SC.Date.Month.StandAlone.May.Abbreviated":"May","SC.Date.Month.StandAlone.May.Full":"May","SC.Date.Month.StandAlone.May.Letter":"M","SC.Date.Month.June.Abbreviated":"Jun","SC.Date.Month.June.Full":"June","SC.Date.Month.June.Letter":"J","SC.Date.Month.StandAlone.June.Abbreviated":"Jun","SC.Date.Month.StandAlone.June.Full":"June","SC.Date.Month.StandAlone.June.Letter":"J","SC.Date.Month.July.Abbreviated":"Jul","SC.Date.Month.July.Full":"July","SC.Date.Month.July.Letter":"J","SC.Date.Month.StandAlone.July.Abbreviated":"Jul","SC.Date.Month.StandAlone.July.Full":"July","SC.Date.Month.StandAlone.July.Letter":"J","SC.Date.Month.August.Abbreviated":"Aug","SC.Date.Month.August.Full":"August","SC.Date.Month.August.Letter":"A","SC.Date.Month.StandAlone.August.Abbreviated":"Aug","SC.Date.Month.StandAlone.August.Full":"August","SC.Date.Month.StandAlone.August.Letter":"A","SC.Date.Month.September.Abbreviated":"Sep","SC.Date.Month.September.Full":"September","SC.Date.Month.September.Letter":"S","SC.Date.Month.StandAlone.September.Abbreviated":"Sep","SC.Date.Month.StandAlone.September.Full":"September","SC.Date.Month.StandAlone.September.Letter":"S","SC.Date.Month.October.Abbreviated":"Oct","SC.Date.Month.October.Full":"October","SC.Date.Month.October.Letter":"O","SC.Date.Month.StandAlone.October.Abbreviated":"Oct","SC.Date.Month.StandAlone.October.Full":"October","SC.Date.Month.StandAlone.October.Letter":"O","SC.Date.Month.November.Abbreviated":"Nov","SC.Date.Month.November.Full":"November","SC.Date.Month.November.Letter":"N","SC.Date.Month.StandAlone.November.Abbreviated":"Nov","SC.Date.Month.StandAlone.November.Full":"November","SC.Date.Month.StandAlone.November.Letter":"N","SC.Date.Month.December.Abbreviated":"Dec","SC.Date.Month.December.Full":"December","SC.Date.Month.December.Letter":"D","SC.Date.Month.StandAlone.December.Abbreviated":"Dec","SC.Date.Month.StandAlone.December.Full":"December","SC.Date.Month.StandAlone.December.Letter":"D","SC.Date.Day.Monday.Abbreviated":"Mon","SC.Date.Day.Monday.Full":"Monday","SC.Date.Day.Monday.Letter":"M","SC.Date.Day.StandAlone.Monday.Abbreviated":"Mon","SC.Date.Day.StandAlone.Monday.Full":"Monday","SC.Date.Day.StandAlone.Monday.Letter":"M","SC.Date.Day.Tuesday.Abbreviated":"Tue","SC.Date.Day.Tuesday.Full":"Tuesday","SC.Date.Day.Tuesday.Letter":"T","SC.Date.Day.StandAlone.Tuesday.Abbreviated":"Tue","SC.Date.Day.StandAlone.Tuesday.Full":"Tuesday","SC.Date.Day.StandAlone.Tuesday.Letter":"T","SC.Date.Day.Wednesday.Abbreviated":"Wed","SC.Date.Day.Wednesday.Full":"Wednesday","SC.Date.Day.Wednesday.Letter":"W","SC.Date.Day.StandAlone.Wednesday.Abbreviated":"Wed","SC.Date.Day.StandAlone.Wednesday.Full":"Wednesday","SC.Date.Day.StandAlone.Wednesday.Letter":"W","SC.Date.Day.Thursday.Abbreviated":"Thu","SC.Date.Day.Thursday.Full":"Thursday","SC.Date.Day.Thursday.Letter":"R","SC.Date.Day.StandAlone.Thursday.Abbreviated":"Thu","SC.Date.Day.StandAlone.Thursday.Full":"Thursday","SC.Date.Day.StandAlone.Thursday.Letter":"R","SC.Date.Day.Friday.Abbreviated":"Fri","SC.Date.Day.Friday.Full":"Friday","SC.Date.Day.Friday.Letter":"F","SC.Date.Day.StandAlone.Friday.Abbreviated":"Fri","SC.Date.Day.StandAlone.Friday.Full":"Friday","SC.Date.Day.StandAlone.Friday.Letter":"F","SC.Date.Day.Saturday.Abbreviated":"Sat","SC.Date.Day.Saturday.Full":"Saturday","SC.Date.Day.Saturday.Letter":"S","SC.Date.Day.StandAlone.Saturday.Abbreviated":"Sat","SC.Date.Day.StandAlone.Saturday.Full":"Saturday","SC.Date.Day.StandAlone.Saturday.Letter":"S","SC.Date.Day.Sunday.Abbreviated":"Sun","SC.Date.Day.Sunday.Full":"Sunday","SC.Date.Day.Sunday.Letter":"S","SC.Date.Day.StandAlone.Sunday.Abbreviated":"Sun","SC.Date.Day.StandAlone.Sunday.Full":"Sunday","SC.Date.Day.StandAlone.Sunday.Letter":"S","SC.Date.Period.AM":"AM","SC.Date.Period.PM":"PM"});SC.DateFormatter=function(c,e){if(!c){throw"No date passed to date formatter."}else{if(!c.getFullYear){throw"Object passed to date formatter was not a date!"}}if(!e){throw"No formatting string passed to date formatter. Date: "+c}var b=e.length,g=e[0],a;for(a=1;a<b;a++){if(e[a]!==g){throw"Invalid format string for a date; all characters must be the same: "+e+"; date: "+c}}var d=SC.DateFormatter[g];if(!d){throw"No formatter `"+g+"` exists for date: "+c}return d(c,b)};SC.DateFormatter.G=function(b,c){var a="SC.Date.Era.";a+=b.getFullYear()>=0?"AD":"BC";if(c<=3){return(a+".Abbreviated").loc()}else{if(c===4){return(a+".Full").loc()}else{if(c===5){return(a+".Letter").loc()}else{throw"Invalid era format: expected at most 5 digits; found "+c+"."}}}};SC.DateFormatter.y=function(a,c){var b=Math.abs(a.getFullYear()).toString();while(b.length<c){b="0"+b}b=b.substr(b.length-c);return b};SC.DateFormatter.Y=function(a,b){return SC.DateFormatter.y(a,b)};SC.DateFormatter.u=function(a,d){var b=a.getFullYear()<0;var c=Math.abs(a.getFullYear()).toString();while(c.length<d){c="0"+c}c=c.substr(c.length-d);return(b?"-":"")+c};SC.DateFormatter.Q=function(b,d,c){var e=b.getMonth(),a=Math.floor(e/3)+1,f="SC.Date.Quarter."+(c?"StandAlone.":"")+"Q"+a;if(d===1){return""+a}else{if(d===2){return"0"+a}else{if(d===3){return(f+".Abbreviated").loc()}else{if(d==4){return(f+".Full").loc()}else{throw"Unrecognized number of characters for quarter: "+d}}}}};SC.DateFormatter.q=function(a,b){return SC.DateFormatter.Q(a,b,YES)};SC.DateFormatter.ENGLISH_MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"];SC.DateFormatter.M=function(c,e,d){var f=c.getMonth(),b=""+(f+1),a="SC.Date.Month."+(d?"StandAlone.":"")+SC.DateFormatter.ENGLISH_MONTH_NAMES[f];if(e===1){return b}else{if(e===2){if(b.length<2){b="0"+b}return b}else{if(e===3){return(a+".Abbreviated").loc()}else{if(e===4){return(a+".Full").loc()}else{if(e===5){return(a+".Letter").loc()}else{throw"The number of Ms or Ls must be from 1 to 5. Supplied: "+e}}}}}};SC.DateFormatter.L=function(a,b){return SC.DateFormatter.M(a,b,YES)};SC.DateFormatter.l=function(){throw"`l` date formatter not implemented."};SC.DateFormatter.w=function(a,b){throw"Week number currently not supported for date formatting."};SC.DateFormatter.W=function(a,b){throw"Week number currently not supported for date formatting."};SC.DateFormatter.d=function(a,b){var c=""+a.getDate();if(b>c.length){c="0"+c}return c};SC.DateFormatter.D=function(b,c){var a=new Date(b.getFullYear(),0,1),d=a.getTime(),e=b.getTime()-d,f=Math.floor(e/(24*60*60*1000))+1;f=""+f;while(f.length<c){f="0"+f}return f};SC.DateFormatter.F=function(a,b){throw"Day of week in month (F) is not supported in date formatting"};SC.DateFormatter.g=function(a,b){throw"Julian day not supported in date formatting."};SC.DateFormatter.ENGLISH_DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];SC.DateFormatter.E=function(a,b){if(b<3){b=3}return SC.DateFormatter.e(a,b)};SC.DateFormatter.e=function(c,e,d){var b=c.getDay(),f=""+(b+1),a="SC.Date.Day."+(d?"StandAlone.":"")+SC.DateFormatter.ENGLISH_DAY_NAMES[b];if(e===1){return f}else{if(e===2){f="0"+f;return f}else{if(e===3){return(a+".Abbreviated").loc()}else{if(e===4){return(a+".Full").loc()}else{if(e===5){return(a+".Letter").loc()}else{throw"Unrecognized number of `e`s, `c`s, or `E`s in date format string."}}}}}};SC.DateFormatter.c=function(a,b){return SC.DateFormatter.e(a,b,YES)};SC.DateFormatter.a=function(b,c){if(c!==1){throw"`a` can only be included in a date format string once."}var a="SC.Date.Period."+(b.getHours()>11?"PM":"AM");return a.loc()};SC.DateFormatter._h=function(c,d,f,e){var b=c.getHours();if(!f){b=b%12}if(e){if(!f){if(b===0){b=12}}else{if(b===0){b=24}}}var a=""+b;if(a.length<d){a="0"+a}return a};SC.DateFormatter.h=function(a,b){return SC.DateFormatter._h(a,b,NO,1)};SC.DateFormatter.H=function(a,b){return SC.DateFormatter._h(a,b,YES,0)};SC.DateFormatter.K=function(a,b){return SC.DateFormatter._h(a,b,NO,0)};SC.DateFormatter.k=function(a,b){return SC.DateFormatter._h(a,b,YES,1)};SC.DateFormatter.m=function(a,b){var c=""+a.getMinutes();if(c.length<b){c="0"+c}return c};SC.DateFormatter.s=function(a,b){var c=""+a.getSeconds();if(c.length<b){c="0"+c}return c};SC.DateFormatter.S=function(a,c){var b=a.getMilliseconds()/1000,d=Math.pow(10,c);b=Math.round(b*d);b=""+b;while(b.length<c){b="0"+b}return b};SC.DateFormatter.A=function(a,c){var d=new Date(a.getFullYear(),a.getMonth(),a.getDay()).getTime();var b=a.getTime()-d;b=""+b;while(b.length<c){b="0"+b}return b};SC.DateFormatter.z=SC.DateFormatter.Z=SC.DateFormatter.v=SC.DateFormatter.V=function(a,b){throw"Timezone not supported in date format strings."};SC.SplitChild={isSplitDivider:NO,minimumSize:100,maximumSize:undefined,size:undefined,position:0,positionOffset:SC.propertyFromRenderDelegate("splitPositionOffset",0),sizeOffset:SC.propertyFromRenderDelegate("splitSizeOffset",0),canCollapse:NO,collapseAtSize:undefined,autoResizeStyle:undefined,compensatesForMovement:YES,allowsIndirectAdjustments:YES,_scsvc_positionOrSizeDidChange:function(){this.invokeOnce("splitChildLayoutDidChange")}.observes("position","size"),splitChildLayoutDidChange:function(){var c=this.get("splitView");if(!c){return}var a=this.get("position")+this.get("positionOffset"),b=this.get("size")+this.get("sizeOffset");if(c.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){this.set("layout",{left:a,width:b,top:0,bottom:0})}else{this.set("layout",{top:a,height:b,right:0,left:0})}},splitView:function(){var a=this.get("parentView");while(a&&!a.isSplitView){a=a.get("parentView")}return a}.property("parentView").cacheable(),splitViewLayoutDirection:null,splitViewLayoutDirectionBinding:SC.Binding.oneWay("*splitView.layoutDirection"),splitViewLayoutDirectionDidChange:function(){this.invokeOnce("splitChildLayoutDidChange")}.observes("splitViewLayoutDirection")};SC.MOVES_AUTOMATIC_CHILD="moves-automatic-child";SC.MOVES_CHILD="moves-child";SC.MOVES_PREVIOUS_CHILD="moves-previous-child";SC.MOVES_NEXT_CHILD="moves-next-child";SC.SplitThumb={movesChild:function(){var a=this,d,c=this.get("splitView"),b=this.get("movesSibling");while(a&&a!==c){d=a;a=a.get("parentView")}if(b===SC.MOVES_NEXT_CHILD){return d.nextView}if(b===SC.MOVES_PREVIOUS_CHILD){return d.previousView}if(b===SC.MOVES_AUTOMATIC_CHILD){if(!d.nextView){return d.previousView}if(!d.previousView){return d.nextView}}return d}.property("splitView","movesSibling").cacheable(),movesSibling:SC.MOVES_AUTOMATIC_CHILD,splitView:function(){var a=this;while(a&&!a.isSplitView){a=a.get("parentView")}return a}.property("parentView").cacheable(),splitViewLayoutDirection:null,splitViewLayoutDirectionBinding:SC.Binding.oneWay("*splitView.layoutDirection"),splitCursorStyle:function(){if(this.get("splitViewLayoutDirection")===SC.LAYOUT_HORIZONTAL){return"ew-resize"}else{return"ns-resize"}}.property("splitViewLayoutDirection").cacheable(),splitCursorStyleDidChange:function(){if(this._isDragging){this.get("splitView").set("splitChildCursorStyle",this.get("splitCursorStyle"))}this.$().css("cursor",this.get("splitCursorStyle"))}.observes("splitCursorStyle"),renderMixin:function(a){a.css("cursor",this.get("splitCursorStyle"))},touchStart:function(b){this._isDragging=YES;var a=this.get("splitView");a.beginLiveResize();this._scst_mouseStartPosition=a.get("layoutDirection")===SC.LAYOUT_HORIZONTAL?b.pageX:b.pageY;this._scst_childStartPosition=a.getPositionForChild(this.get("movesChild"));return YES},touchesDragged:function(a){var b=this.get("splitView");var e=b.get("layoutDirection")===SC.LAYOUT_HORIZONTAL?a.pageX:a.pageY;var c=e-this._scst_mouseStartPosition,d=this._scst_childStartPosition;b.adjustPositionForChild(this.get("movesChild"),d+c);return YES},touchEnd:function(e){this._isDragging=NO;var a=this.get("splitView");var d=a.get("layoutDirection")===SC.LAYOUT_HORIZONTAL?e.pageX:e.pageY;var b=d-this._scst_mouseStartPosition,c=this._scst_childStartPosition;a.adjustPositionForChild(this.get("movesChild"),c+b);a.set("splitChildCursorStyle",null);a.endLiveResize();return YES},mouseDown:function(a){var b=this.get("splitView");b.set("splitChildCursorStyle",this.get("splitCursorStyle"));return this.touchStart(a)},mouseDragged:function(a){return this.touchesDragged(a)},mouseUp:function(a){this.get("splitView").set("splitChildCursorStyle",null);return this.touchEnd(a)}};SC.BaseTheme.splitRenderDelegate=SC.RenderDelegate.create({className:"split",render:function(b,a){a.addClass(b.get("layoutDirection"))},update:function(b,a){a.addClass(b.get("layoutDirection"))}});SC.BaseTheme.splitDividerRenderDelegate=SC.RenderDelegate.create({className:"split-divider",dividerSize:1,splitPositionOffset:-5,splitSizeOffset:10,render:function(b,a){this.addSizeClassName(b,a);a.push("<div class='line'></div>")},update:function(b,a){this.updateSizeClassName(b,a)}});sc_require("mixins/split_child");sc_require("mixins/split_thumb");SC.SplitDividerView=SC.View.extend(SC.SplitChild,SC.SplitThumb,{classNames:["sc-split-divider-view"],isSplitDivider:YES,autoResizeStyle:"sc-fixed-size",movesSibling:SC.MOVES_CHILD,size:SC.propertyFromRenderDelegate("dividerSize",10),renderDelegateName:"splitDividerRenderDelegate"});sc_require("views/split_divider");SC.FIXED_SIZE="sc-fixed-size";SC.RESIZE_MANUAL="sc-manual-size";SC.RESIZE_AUTOMATIC="sc-automatic-resize";SC.SplitView=SC.View.extend({classNames:["sc-split-view"],childViews:["topLeftView","bottomRightView"],isSplitView:YES,splitDividerView:SC.SplitDividerView,layoutDirection:SC.LAYOUT_HORIZONTAL,shouldResizeChildrenToFit:YES,splitChildCursorStyle:null,_scsv_splitChildCursorDidChange:function(){this.get("cursor").set("cursorStyle",this.get("splitChildCursorStyle"))}.observes("splitChildCursorStyle"),init:function(){this.cursor=SC.Cursor.create();arguments.callee.base.apply(this,arguments)},displayProperties:["layoutDirection"],renderDelegateName:"splitRenderDelegate",_frameSize:function(){if(this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){return this.get("frame").width}else{return this.get("frame").height}}.property("frame","layoutDirection").cacheable(),viewDidResize:function(a){this.scheduleTiling();a()}.enhance(),layoutDirectionDidChange:function(){this.scheduleTiling()}.observes("layoutDirection"),adjustPositionForChild:function(b,a){return this.invokeDelegateMethod(this.get("delegate"),"splitViewAdjustPositionForChild",this,b,a)},getPositionForChild:function(a){return this.invokeDelegateMethod(this.get("delegate"),"splitViewGetPositionForChild",this,a)},didAddChild:function(){if(this._scsv_settingUpChildViews){return}this._scsv_settingUpChildViews=YES;this.invokeOnce("_scsv_setupChildViews");this._scsv_settingUpChildViews=NO},didRemoveChild:function(){if(this._scsv_settingUpChildViews){return}this._scsv_settingUpChildViews=YES;this.invokeOnce("_scsv_setupChildViews");this._scsv_settingUpChildViews=NO},createChildViews:function(){arguments.callee.base.apply(this,arguments);if(this._scsv_settingUpChildViews){return}this._scsv_settingUpChildViews=YES;this.invokeOnce("_scsv_setupChildViews");this._scsv_settingUpChildViews=NO},_scsv_setupChildViews:function(){var l=this.get("delegate"),d=this.get("childViews").copy(),g=d.length,k,c,a,e,j=this._scsv_dividers||{},b={},f,h;for(k=0;k<g;k++){c=d[k];if(!c.get("autoResizeStyle")){if(c.get("size")!==undefined){c.set("autoResizeStyle",SC.RESIZE_MANUAL)}else{c.set("autoResizeStyle",SC.RESIZE_AUTOMATIC)}}var m=this.invokeDelegateMethod(l,"splitViewGetSizeForChild",this,c);m=this.invokeDelegateMethod(l,"splitViewConstrainSizeForChild",this,c,m);this.invokeDelegateMethod(l,"splitViewSetSizeForChild",this,c,m);c.previousView=a;c.nextView=undefined;c.viewIndex=k;if(a){a.nextView=c}if(e&&!c.isSplitDivider){h=SC.guidFor(e)+"-"+SC.guidFor(c);f=j[h];if(!f&&!a.isSplitDivider){f=this.invokeDelegateMethod(l,"splitViewDividerBetween",this,e,c)}if(f){f.isSplitDivider=YES;b[h]=f;if(j[h]){delete j[h]}else{this.insertBefore(f,c)}}}a=c;if(!c.isSplitDivider){e=c}}for(h in j){j[h].destroy()}this._scsv_dividers=b;this._scsv_tile()},needsTiling:YES,scheduleTiling:function(){this.set("needsTiling",YES);this.invokeOnce("_scsv_tile")},tileIfNeeded:function(){if(!this.get("needsTiling")){return}this._scsv_tile()},_scsv_tile:function(){var a=this.get("delegate");var c,b=this.get("_frameSize");c=this.invokeDelegateMethod(a,"splitViewLayoutChildren",this);if(this.get("shouldResizeChildrenToFit")&&c!==b){this.invokeDelegateMethod(a,"splitViewResizeChildrenToFit",this,c);c=this.invokeDelegateMethod(a,"splitViewLayoutChildren",this)}if(!this.get("shouldResizeChildrenToFit")){if(this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){this.adjust("width",c)}else{this.adjust("height",c)}}this.set("needsTiling",NO)},splitViewLayoutChildren:function(e){var c=this.get("delegate");var d=this.get("childViews"),b=d.length,a,g,f=0;for(a=0;a<b;a++){g=d[a];this.invokeDelegateMethod(c,"splitViewSetPositionForChild",this,d[a],f);f+=this.invokeDelegateMethod(c,"splitViewGetSizeForChild",this,d[a])}return f},splitViewResizeChildrenToFit:function(h,d){var m=this.get("delegate");var g=this.get("_frameSize");var e=this.get("childViews"),j=e.length,l,c,a=0,f=0,k;for(l=0;l<j;l++){c=e[l];k=this.invokeDelegateMethod(m,"splitViewGetSizeForChild",this,c);if(this.invokeDelegateMethod(m,"splitViewShouldResizeChildToFit",this,c)){a+=k}else{f+=k}}var b=d;b=this._resizeChildrenForSize(b,g,YES,a);b=this._resizeChildrenForSize(b,g,YES,-1);b=this._resizeChildrenForSize(b,g,NO,f);b=this._resizeChildrenForSize(b,g,NO,-1)},_resizeChildrenForSize:function(d,e,f,h){var m=this.get("delegate");var c=this.get("childViews"),k,g=c.length,b;var j=e-d;for(k=0;k<g;k++){b=c[k];var l=this.invokeDelegateMethod(m,"splitViewGetSizeForChild",this,b),n=l;var a=this.invokeDelegateMethod(m,"splitViewShouldResizeChildToFit",this,b);if(a===f){if(h===-1){n+=j}else{n+=(n/h)*j}n=Math.round(n);n=this.invokeDelegateMethod(m,"splitViewConstrainSizeForChild",this,b,n);this.invokeDelegateMethod(m,"splitViewSetSizeForChild",this,b,n);if(h!==-1){h-=l}}d-=l;d+=n;j=e-d}return d},splitViewShouldResizeChildToFit:function(a,b){return(this.get("shouldResizeChildrenToFit")&&b.get("autoResizeStyle")===SC.RESIZE_AUTOMATIC)},splitViewAdjustPositionForChild:function(d,f,a){var b=this.get("delegate");var e=this._scsv_createPlan();var c=this._scsv_adjustPositionForChildInPlan(e,f,a,f);this._scsv_commitPlan(e);return c},_scsv_createPlan:function(){var c=this.get("delegate"),g=[],f=this.get("childViews"),b,a=f.length,h,e,d;for(b=0;b<a;b++){h=f[b];e=this.invokeDelegateMethod(c,"splitViewGetPositionForChild",this,h);d=this.invokeDelegateMethod(c,"splitViewGetSizeForChild",this,h);g[b]={child:h,originalPosition:e,position:e,originalSize:d,size:d}}return g},_scsv_resetPlanRange:function(c,d,b){for(var a=d;a<=b;a++){c[a].position=c[a].originalPosition;c[a].size=c[a].originalSize}},_scsv_commitPlan:function(f){var d=this.get("delegate"),b=f.length,a,e,c=0;for(a=0;a<b;a++){e=f[a];if(e.size!==e.originalSize){this.invokeDelegateMethod(d,"splitViewSetSizeForChild",this,e.child,e.size)}if(e.position!==e.originalPosition){this.invokeDelegateMethod(d,"splitViewSetPositionForChild",this,e.child,e.position)}c=e.position+e.size}if(!this.get("shouldResizeChildrenToFit")){if(this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){this.adjust("width",c)}else{this.adjust("height",c)}}},_scsv_adjustPositionForChildInPlan:function(j,d,f,a){var k=this.get("delegate");if(!d.get("allowsIndirectAdjustments")&&a!==d&&a!==d.previousView){return j[d.viewIndex].position}if(d._splitViewIsAdjusting){return j[d.viewIndex].position}d._splitViewIsAdjusting=YES;var g=d.previousView,b=d.nextView,c,l,h,e,m=j[d.viewIndex].size;if(g&&!g._splitViewIsAdjusting){c=j[g.viewIndex].position;l=f-c;l=this._scsv_adjustSizeForChildInPlan(j,g,l,a);f=c+l}else{if(!g){f=0}}if(b&&b._splitViewIsAdjusting){d._splitViewIsAdjusting=NO;j[d.viewIndex].position=f;return f}if(d.get("compensatesForMovement")&&b){h=j[b.viewIndex].position;m=this._scsv_adjustSizeForChildInPlan(j,d,h-f)}else{if(!b&&this.get("shouldResizeChildrenToFit")){h=this.get("_frameSize");m=this._scsv_adjustSizeForChildInPlan(j,d,h-f);f=h-m}}if(b){h=f+m;h=this._scsv_adjustPositionForChildInPlan(j,b,h,a)}if(h&&f!==h-m){f=h-m;if(g&&!g._splitViewIsAdjusting){this._scsv_resetPlanRange(j,0,g.viewIndex);l=f-j[g.viewIndex].position;this._scsv_adjustSizeForChildInPlan(j,g,l,d)}}j[d.viewIndex].position=f;d._splitViewIsAdjusting=NO;return f},_scsv_adjustSizeForChildInPlan:function(f,b,j,a){var g=this.get("delegate");if(a&&!b.get("allowsIndirectAdjustments")&&a!==b&&a!==b.nextView&&a!==b.previousView){return f[b.viewIndex].size}var h=this.invokeDelegateMethod(g,"splitViewConstrainSizeForChild",this,b,j);f[b.viewIndex].size=h;if(j===h){return j}var c=f[b.viewIndex].position,d=c+j-h;var e=this._scsv_adjustPositionForChildInPlan(f,b,d,a);return e+h-c},splitViewDividerBetween:function(c,b,a){if(!this.get("splitDividerView")){return null}return this.get("splitDividerView").create()},splitViewGetPositionForChild:function(a,b){return b.get("position")},splitViewSetPositionForChild:function(b,c,a){c.set("position",a)},splitViewGetSizeForChild:function(b,c){var a=c.get("size");if(SC.none(a)){return 100}return a},splitViewSetSizeForChild:function(b,c,a){c.set("size",a)},splitViewConstrainSizeForChild:function(c,f,a){if(f.get("autoResizeStyle")===SC.FIXED_SIZE){return this.invokeDelegateMethod(this.get("delegate"),"splitViewGetSizeForChild",this,f)}if(f.get("canCollapse")){var b=f.get("collapseAtSize");if(b&&a<b){return 0}}var d=f.get("minimumSize")||0;if(d!==undefined&&d!==null){a=Math.max(d,a)}var e=f.get("maximumSize");if(e!==undefined&&e!==null){a=Math.min(e,a)}return a}});SC.ThumbView=SC.View.extend(SC.SplitThumb,{classNames:["sc-thumb-view"],init:function(){arguments.callee.base.apply(this,arguments);console.warn("SC.ThumbView is deprecated. Please use a normal view and mix in SC.SplitThumb instead.")}});SC.warn("SC.Animatable is deprecated and will be removed in the next release.  Animation can be achieved by using the .animate method on SC.View.");SC.Animatable={isAnimatable:YES,transitions:{},concatenatedProperties:["transitions"],style:{},_cssTransitionFor:{left:"left",top:"top",right:"right",bottom:"bottom",width:"width",height:"height",opacity:"opacity",transform:(SC.platform.supportsCSSTransforms?"-"+SC.platform.cssPrefix+"-transform":"transform")},_styleProperties:["display","transform"],_layoutStyles:SC.String.w("width height top bottom marginLeft marginTop left right zIndex minWidth maxWidth minHeight maxHeight centerX centerY opacity border borderTop borderRight borderBottom borderLeft"),_animationsToStart:{},_animationOrder:["top","left","bottom","right","width","height","centerX","centerY","opacity","display","transform"],initMixin:function(){this._animatable_original_didCreateLayer=this.didCreateLayer||function(){};this.didCreateLayer=this._animatable_didCreateLayer;this._animatable_original_willDestroyLayer=this.willDestroyLayer||function(){};this.willDestroyLayer=this._animatable_willDestroyLayer;this._animatable_original_willRemoveFromParent=this.willRemoveFromParent||function(){};this.willRemoveFromParent=this._animatable_will_remove_from_parent;this._animatable_original_hasAcceleratedLayer=this.hasAcceleratedLayer||function(){};this.hasAcceleratedLayer=this._animatable_hasAcceleratedLayer;this._animatable_original_animate=this.animate||function(){};this.animate=this._animatable_animate;this.addObserver("style",this,"styleDidChange");this._animateTickPixel.displayName="animate-tick";var b;if(SC.isArray(this.transitions)){var a={};for(b=0;b<this.transitions.length;b++){SC.mixin(a,this.transitions[b])}this.transitions=a}for(b in this.transitions){if(typeof this.transitions[b]=="number"){this.transitions[b]={duration:this.transitions[b]}}}this._animatableCurrentStyle=null;this._animators={};this._animatableSetCSS="";this._last_transition_css="";if(this._disableAnimation===undefined){this._disableAnimation=0}this._transitionCallbacks={};if(!SC.none(this.get("layer"))){var c=this._animatable_original_didCreateLayer;this._animatable_original_didCreateLayer=function(){};this.didCreateLayer();this._animatable_original_didCreateLayer=c}},_animatable_didCreateLayer:function(){this.resetAnimation();SC.Event.add(this.get("layer"),SC.platform.cssPrefix+"TransitionEnd",this,this.transitionEnd);SC.Event.add(this.get("layer"),"transitionend",this,this.transitionEnd);return this._animatable_original_didCreateLayer()},_animatable_willDestroyLayer:function(){SC.Event.remove(this.get("layer"),SC.platform.cssPrefix+"TransitionEnd",this,this.transitionEnd);SC.Event.remove(this.get("layer"),"transitionend",this,this.transitionEnd);return this._animatable_original_willDestroyLayer()},_animatable_will_remove_from_parent:function(){this.resetAnimation()},disableAnimation:function(){if(this._disableAnimation<1){this.updateStyle();this._disableAnimation=1;this.updateStyle()}else{this._disableAnimation++}},enableAnimation:function(){if(this._disableAnimation<=1){this.updateStyle();this._disableAnimation=0;this.updateStyle()}else{this._disableAnimation--}},adjust:function(k,l){if(!SC.none(l)){var m=k;k={};k[m]=l}else{k=SC.clone(k)}var a=SC.clone(this.get("style")),c=NO,g=SC.clone(this.get("layout")),b=NO;var n=this._styleProperties;for(var e in k){var h=NO;var j=(n.indexOf(e)>=0)?a:g;var d=j[e],f=k[e];if(f!==undefined&&d!==f){if(f===null){if(d!==undefined){h=YES}delete j[e]}else{j[e]=f;h=YES}}if(h){if(j===a){c=YES}else{b=YES}}}if(c){this.set("style",a)}if(b){this.set("layout",g)}return this},_animatable_animate:function(){this.disableAnimation();var a=this._animatable_original_animate.apply(this,arguments);this.enableAnimation();return a},transitionEnd:function(a){SC.run(function(){var b=a.originalEvent.propertyName,c=this._transitionCallbacks[b];if(c&&this._disableAnimation<=0){SC.Animatable.runCallback(c)}},this)},getCurrentJavaScriptStyles:function(){return this._animatableCurrentStyle},resetAnimation:function(){this._animatableCurrentStyle=null;this._stopJavaScriptAnimations();this.disableAnimation();this.updateStyle();this.enableAnimation();this.updateStyle()},_stopJavaScriptAnimations:function(){for(var a in this._animators){if(this._animators[a]&&this._animators[a].isQueued){SC.Animatable.removeTimer(this._animators[a])}}},_getStartStyleHash:function(h,g){var e=this.layout;this.layout=h;var d=this.computeParentDimensions();var c=this.computeFrameWithParentFrame(d);this.layout=e;var a={};for(var b in g){if(c){if(b=="left"){a[b]=c.x;continue}else{if(b=="top"){a[b]=c.y;continue}else{if(b=="right"){a[b]=d.width-c.x-c.width;continue}else{if(b=="bottom"){a[b]=d.height-c.y-c.height;continue}else{if(b=="width"){a[b]=c.width;continue}else{if(b=="height"){a[b]=c.height;continue}else{if(b=="centerX"){a[b]=c.x+(c.width/2)-(d.width/2);continue}else{if(b=="centerY"){a[b]=c.y+(c.height/2)-(d.height/2);continue}}}}}}}}}if(SC.none(a[b])){if(!SC.none(h[b])){a[b]=h[b]}else{a[b]=g[b]}}}return a},_TMP_CSS_TRANSITIONS:[],cssTimingStringFor:function(c){var b="linear";if(c.timing||SC.Animatable.defaultTimingFunction){var a=c.timing||SC.Animatable.defaultTimingFunction;if(SC.typeOf(a)!=SC.T_STRING){b="cubic-bezier("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}else{b=a}}return b},styleDidChange:function(){this.invokeLast("updateStyle")},_animatable_hasAcceleratedLayer:function(){var b=this.transitions.left&&this.transitions.left.duration,a=this.transitions.top&&this.transitions.top.duration;if(b!==a){return NO}else{if((a||b)&&!SC.platform.supportsCSSTransitions){return NO}else{return this._animatable_original_hasAcceleratedLayer()}}}.property("wantsAcceleratedLayer","transitions"),updateStyle:function(){var G=this.get("layer");var q=this.get("style");var n=NO,f="";if(this.get("hasAcceleratedLayer")){var u=q.top,b=q.bottom,C=q.height,B=q.left,w=q.right,p=q.width;if((SC.empty(u)||(!SC.isPercentage(u)&&!SC.empty(C)))&&(SC.empty(B)||(!SC.isPercentage(B)&&!SC.empty(p)))&&(this.transitions&&(this.transitions.top||this.transitions.left))){n=YES;this._useSpecialCaseTransform=YES}else{this._useSpecialCaseTransform=NO}}var z;if(!this._animatableCurrentStyle||this._disableAnimation>0||!G){this._animatableSetCSS="";this._animatableCurrentStyle={};for(z in q){if(z[0]!="_"){this._animatableCurrentStyle[z]=q[z]}}if(G){this._animatableApplyStyles(G,q)}return this}if(!G){return}var e=this._getStartStyleHash(this._animatableCurrentStyle,q);var g={};var s;var h=this._TMP_CSS_TRANSITIONS;if(SC.platform.supportsCSSTransitions){var m;if(n){var F=this.transitions.left||this.transitions.top;m=this.cssTimingStringFor(F);h.push("-"+SC.platform.cssPrefix+"-transform "+F.duration+"s "+m)}for(z in this.transitions){if(!this._cssTransitionFor[z]){continue}if(n&&(z=="left"||z=="top")){if(this.transitions.left.action){this._transitionCallbacks["-"+SC.platform.cssPrefix+"-transform"]={source:this,target:(this.transitions.left.target||this),action:this.transitions.left.action}}if(this.transitions.top.action){this._transitionCallbacks["-"+SC.platform.cssPrefix+"-transform"]={source:this,target:(this.transitions.top.target||this),action:this.transitions.top.action}}continue}m=this.cssTimingStringFor(this.transitions[z]);h.push(this._cssTransitionFor[z]+" "+this.transitions[z].duration+"s "+m)}}for(z in q){if(z[0]=="_"){continue}var d=!this.transitions[z]||q[z]==e[z];if(z=="display"&&q[z]!="none"){d=true}if(d){e[z]=q[z];var E=this._animators[z];if(E){E.endValue=q[z];E.end=0}continue}if(SC.platform.supportsCSSTransitions&&this._cssTransitionFor[z]){g[z]=q[z];if(this.transitions[z].action){this._transitionCallbacks[this._cssTransitionFor[z]]={source:this,target:(this.transitions[z].target||this),action:this.transitions[z].action}}continue}var y=this._animateTickPixel,c=z,o=e[z],k=q[z];if(c=="centerX"||c=="centerY"){y=this._animateTickCenter}else{if(c=="opacity"){y=this._animateTickNumber}else{if(c=="display"){y=this._animateTickDisplay}}}if(!this._animators[z]){this._animators[z]={}}var D=this._animators[z];D.start=null;D.duration=Math.floor(this.transitions[z].duration*1000);D.startValue=o;D.endValue=k;D.layer=G;D.property=c;D.action=y;D.style=G.style;D.holder=this;if(this.transitions[z].action){D.callback={source:this,target:(this.transitions[z].target||this),action:this.transitions[z].action}}s=this.transitions[z].timing||SC.Animatable.defaultTimingFunction;if(s&&SC.typeOf(s)!=SC.T_STRING){D.timingFunction=s}if(!D.going){this._animationsToStart[z]=D}}var t=this._animationOrder,v=this._animationOrder.length;for(z=0;z<v;z++){var x=t[z];if(this._animationsToStart[x]){SC.Animatable.addTimer(this._animationsToStart[x]);delete this._animationsToStart[x]}}var j=h.join(",");h.length="";this._animatableSetCSS=j;this._animatableApplyStyles(G,e,g);return this},_animatableApplyStyles:function(b,c,a){if(!b){return}var e=NO;if(c.display&&b.style.display!==c.display){b.style.display=c.display;e=YES}if(this._animatableSetCSS!=this._last_transition_css){b.style[SC.platform.domCSSPrefix+"Transition"]=this._animatableSetCSS;this._last_transition_css=this._animatableSetCSS;e=YES}if(!this._animators["display-styles"]){this._animators["display-styles"]={}}var d=this._animators["display-styles"];d.holder=this;d.action=this._animatableApplyNonDisplayStylesFromTimer;d.inLoopAction=this._animatableApplyNonDisplayStyles;d.layer=b;d.styles=c;d.delayed=a;this._animatableCurrentStyle=c;if(this._disableAnimation>0||!e){d.inLoopAction()}else{SC.Animatable.addTimer(d)}},_animatableApplyNonDisplayStylesFromTimer:function(){SC.run(function(){this.inLoopAction()},this)},_animatableApplyNonDisplayStyles:function(){var g=this.layer,k=this.holder._animatableCurrentStyle;var d={};var h={},l=NO,a=g.style;var b="";for(var f in k){if(f=="display"){continue}if(this.holder._layoutStyles.indexOf(f)>=0){h[f]=k[f];l=YES;continue}else{if(f=="transform"){b+=" "+k[f]}else{if(d[f]){d[f](a,f,k)}else{a[f]=k[f]}}}}if(!SC.empty(b)){a[SC.platform.cssPrefix+"Transform"]=b}if(l){var c=this.holder.layout;this.holder.layout=h;this.holder.notifyPropertyChange("layoutStyle");var e=this.holder.get("layoutStyle");for(var j in e){if(SC.none(e[j])){a[j]=""}else{if(a[j]!=e[j]){a[j]=e[j]}}}this.holder.layout=c}if(this.delayed){SC.mixin(this.holder._animatableCurrentStyle,this.delayed);this.styles=this.delayed;this.delayed=undefined;if(this._disableAnimation>0){this.inLoopAction()}else{SC.Animatable.addTimer(this)}}},updateLayout:function(c,a){var b=SC.clone(this.get("style"));var g=this.get("layout");var d=0,e=this._layoutStyles,h=e.length,f=NO;for(d=0;d<h;d++){var j=e[d];if(b[j]!==g[j]){if(SC.none(g[j])){b[j]=undefined}else{b[j]=g[j]}f=YES}}if(f){this.style=b;this.updateStyle()}return this},_solveBezierForT:function(b,p,m,l,f,d,n,e){var o=1/(200*e);var k,j,h,c,a,g;for(h=n,g=0;g<8;g++){c=((b*h+m)*h+f)*h-n;if(Math.abs(c)<o){return h}a=(3*b*h+2*m)*h+f;if(Math.abs(a)<Math.pow(10,-6)){break}h=h-c/a}k=0;j=1;h=n;if(h<k){return k}if(h>j){return j}while(k<j){c=((b*h+m)*h+f)*h;if(Math.abs(c-n)<o){return h}if(n>c){k=h}else{j=h}h=(j-k)*0.5+k}return h},_solveBezier:function(c,b,k,j,l,e){var f=3*c;var h=3*(k-c)-f;var a=1-f-h;var d=3*b;var g=3*(j-b)-d;var n=1-d-g;var m=this._solveBezierForT(a,n,h,g,f,d,l,e);return((n*m+g)*m+d)*m},_animateTickPixel:function(n){if(SC.none(this.start)){this.start=n;this.end=this.start+this.duration}var o=this.start,g=this.end;var m=this.startValue,k=this.endValue;var h=g-o;var b=k-m;var j=n-o;var f=Math.min(j/h,1);if(this.timingFunction){var a=this.timingFunction;f=this.holder._solveBezier(a[0],a[1],a[2],a[3],f,h)}var l=Math.floor(m+(b*f));this.holder._animatableCurrentStyle[this.property]=l;this.style[this.property]=l+"px";if(n<g){SC.Animatable.addTimer(this)}else{this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null}},_animateTickDisplay:function(a){if(SC.none(this.start)){this.start=a;this.end=this.start+this.duration}var b=this.end;if(a<b){SC.Animatable.addTimer(this);return}this.holder._animatableCurrentStyle[this.property]=this.endValue;this.style[this.property]=this.endValue;this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null},_animateTickNumber:function(n){if(SC.none(this.start)){this.start=n;this.end=this.start+this.duration}var o=this.start,g=this.end;var m=this.startValue,k=this.endValue;var h=g-o;var b=k-m;var j=n-o;var f=Math.min(j/h,1);if(this.timingFunction){var a=this.timingFunction;f=this.holder._solveBezier(a[0],a[1],a[2],a[3],f,h)}var l=Math.round((m+(b*f))*100)/100;this.holder._animatableCurrentStyle[this.property]=l;this.style[this.property]=l;if(this.property=="opacity"){this.style.zoom=1}if(n<g){SC.Animatable.addTimer(this)}else{this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null}},_animateTickCenter:function(p){if(SC.none(this.start)){this.start=p;this.end=this.start+this.duration}var q=this.start,h=this.end;var o=this.startValue,l=this.endValue;var j=h-q;var f=l-o;var k=p-q;var g=Math.min(k/j,1);if(this.timingFunction){var b=this.timingFunction;g=this.holder._solveBezier(b[0],b[1],b[2],b[3],g,j)}var n=o+(f*g);this.holder._animatableCurrentStyle[this.property]=n;var m,a;if(this.property=="centerX"){m="width";a="marginLeft"}else{m="height";a="marginTop"}this.style[a]=Math.round(n-(this.holder._animatableCurrentStyle[m]/2))+"px";if(p<h){SC.Animatable.addTimer(this)}else{this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null}}};SC.mixin(SC.Animatable,{NAMESPACE:"SC.Animatable",VERSION:"0.1.0",TRANSITION_NONE:"linear",TRANSITION_CSS_EASE:"ease",TRANSITION_CSS_EASE_IN:"ease-in",TRANSITION_CSS_EASE_OUT:"ease-out",TRANSITION_CSS_EASE_IN_OUT:"ease-in-out",TRANSITION_EASE:[0.25,0.1,0.25,1],TRANSITION_LINEAR:[0,0,1,1],TRANSITION_EASE_IN:[0.42,0,1,1],TRANSITION_EASE_OUT:[0,0,0.58,1],TRANSITION_EASE_IN_OUT:[0.42,0,0.58,1],defaultTimingFunction:null,baseTimer:{next:null},going:false,_ticks:0,_timer_start_time:null,interval:10,currentTime:new Date().getTime(),stats:SC.Object.create({lastFPS:0}),addTimer:function(a){if(a.isQueued){return}a.prev=SC.Animatable.baseTimer;a.next=SC.Animatable.baseTimer.next;if(SC.Animatable.baseTimer.next){SC.Animatable.baseTimer.next.prev=a}SC.Animatable.baseTimer.next=a;a.isQueued=true;if(!SC.Animatable.going){SC.Animatable.start()}},removeTimer:function(a){if(!a.isQueued){return}if(a.next){a.next.prev=a.prev}a.prev.next=a.next;a.isQueued=false},start:function(){SC.Animatable._ticks=0;SC.Animatable._timer_start_time=new Date().getTime();SC.Animatable.going=true;setTimeout(function(){SC.Animatable.timeout()},SC.Animatable.interval)},timeout:function(){SC.Animatable.currentTime=new Date().getTime();var g=SC.Animatable.currentTime;var e=SC.Animatable.baseTimer.next;SC.Animatable.baseTimer.next=null;var d=0;while(e){var c=e.next;e.isQueued=false;e.next=null;e.prev=null;e.action.call(e,g);e=c;d++}if(SC.Animatable._ticks<1000000){SC.Animatable._ticks++}var b=new Date().getTime();var a=b-g;if(SC.Animatable.baseTimer.next){setTimeout(function(){SC.Animatable.timeout()},Math.max(0,SC.Animatable.interval-a))}else{SC.Animatable.going=false;var f=b-SC.Animatable._timer_start_time;SC.run(function(){SC.Animatable.stats.set("lastFPS",SC.Animatable._ticks/(f/1000))})}},runCallback:function(f){var a=SC.typeOf(f.action);if(a==SC.T_FUNCTION){f.action.call(f.target,f.source)}else{if(a===SC.T_STRING){if(f.action.indexOf(".")>=0){var e=f.action.split(".");var c=e.pop();var d=SC.objectForPropertyPath(e,window);var b=d.get?d.get(c):d[c];if(b&&SC.typeOf(b)==SC.T_FUNCTION){b.call(d,f.source)}else{throw"SC.Animator could not find a function at %@".fmt(f.action)}}else{SC.RootResponder.responder.sendAction(f.action,f.target,f.source,f.source.get("pane"),null,f.source)}}}}});(function(){var k=Date,f=k.prototype,j=k.CultureInfo,g=[],h=function(a,b){if(!b){b=2}return("000"+a).slice(b*-1)};k.normalizeFormat=function(a){g=[];var b=new Date().$format(a);return g.join("")};k.strftime=function(a,b){return new Date(b*1000).$format(a)};k.strtotime=function(b){var a=k.parse(b);a.addMinutes(a.getTimezoneOffset()*-1);return Math.round(k.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())/1000)};f.$format=function(b){var d=this,a,c=function(e){g.push(e);return d.toString(e)};return b?b.replace(/(%|\\)?.|%%/g,function(m){if(m.charAt(0)==="\\"||m.substring(0,2)==="%%"){return m.replace("\\","").replace("%%","%")}switch(m){case"d":case"%d":return c("dd");case"D":case"%a":return c("ddd");case"j":case"%e":return c("d");case"l":case"%A":return c("dddd");case"N":case"%u":return d.getDay()+1;case"S":return c("S");case"w":case"%w":return d.getDay();case"z":return d.getOrdinalNumber();case"%j":return h(d.getOrdinalNumber(),3);case"%U":var p=d.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),q=d.clone().addDays(1).moveToDayOfWeek(0,-1);return(q<p)?"00":h((q.getOrdinalNumber()-p.getOrdinalNumber())/7+1);case"W":case"%V":return d.getISOWeek();case"%W":return h(d.getWeek());case"F":case"%B":return c("MMMM");case"m":case"%m":return c("MM");case"M":case"%b":case"%h":return c("MMM");case"n":return c("M");case"t":return k.getDaysInMonth(d.getFullYear(),d.getMonth());case"L":return(k.isLeapYear(d.getFullYear()))?1:0;case"o":case"%G":return d.setWeek(d.getISOWeek()).toString("yyyy");case"%g":return d.$format("%G").slice(-2);case"Y":case"%Y":return c("yyyy");case"y":case"%y":return c("yy");case"a":case"%p":return c("tt").toLowerCase();case"A":return c("tt").toUpperCase();case"g":case"%I":return c("h");case"G":return c("H");case"h":return c("hh");case"H":case"%H":return c("HH");case"i":case"%M":return c("mm");case"s":case"%S":return c("ss");case"u":return h(d.getMilliseconds(),3);case"I":return(d.isDaylightSavingTime())?1:0;case"O":return d.getUTCOffset();case"P":a=d.getUTCOffset();return a.substring(0,a.length-2)+":"+a.substring(a.length-2);case"e":case"T":case"%z":case"%Z":return d.getTimezone();case"Z":return d.getTimezoneOffset()*-60;case"B":var e=new Date();return Math.floor(((e.getHours()*3600)+(e.getMinutes()*60)+e.getSeconds()+(e.getTimezoneOffset()+60)*60)/86.4);case"c":return d.toISOString().replace(/\"/g,"");case"U":return k.strtotime("now");case"%c":return c("d")+" "+c("t");case"%C":return Math.floor(d.getFullYear()/100+1);case"%D":return c("MM/dd/yy");case"%n":return"\\n";case"%t":return"\\t";case"%r":return c("hh:mm tt");case"%R":return c("H:mm");case"%T":return c("H:mm:ss");case"%x":return c("d");case"%X":return c("t");default:g.push(m);return m}}):this._toString()};if(!f.format){f.format=f.$format}}());
/*! @license Copyright (c) 2006-2007, Coolite Inc. (http://www.coolite.com/). All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

See also:
	http://www.datejs.com/license/
	http://www.datejs.com/

*/
Date.CultureInfo={name:"zh-CN",englishName:"Chinese (People's Republic of China)",nativeName:"()",dayNames:["","","","","","",""],abbreviatedDayNames:["","","","","","",""],shortestDayNames:["","","","","","",""],firstLetterDayNames:["","","","","","",""],monthNames:["","","","","","","","","","","",""],abbreviatedMonthNames:["","","","","","","","","","","",""],amDesignator:"",pmDesignator:"",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"ymd",formatPatterns:{shortDate:"yyyy/M/d",longDate:"yyyy''M''d''",shortTime:"H:mm",longTime:"H:mm:ss",fullDateTime:"yyyy''M''d'' H:mm:ss",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"M''d''",yearMonth:"yyyy''M''"},regexPatterns:{jan:/^/i,feb:/^/i,mar:/^/i,apr:/^/i,may:/^/i,jun:/^/i,jul:/^/i,aug:/^/i,sep:/^/i,oct:/^/i,nov:/^/i,dec:/^/i,sun:/^/i,mon:/^/i,tue:/^/i,wed:/^/i,thu:/^/i,fri:/^/i,sat:/^/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}};(function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var k=Date.Parsing;var q=k.Operators={rtoken:function(a){return function(c){var b=c.match(a);if(b){return([b[0],c.substring(b[0].length)])}else{throw new k.Exception(c)}}},token:function(a){return function(b){return q.rtoken(new RegExp("^s*"+b+"s*"))(b)}},stoken:function(a){return q.rtoken(new RegExp("^"+a))},until:function(a){return function(d){var c=[],e=null;while(d.length){try{e=a.call(this,d)}catch(b){c.push(e[0]);d=e[1];continue}break}return[c,d]}},many:function(a){return function(d){var e=[],c=null;while(d.length){try{c=a.call(this,d)}catch(b){return[e,d]}e.push(c[0]);d=c[1]}return[e,d]}},optional:function(a){return function(d){var c=null;try{c=a.call(this,d)}catch(b){return[null,d]}return[c[0],c[1]]}},not:function(a){return function(c){try{a.call(this,c)}catch(b){return[null,c]}throw new k.Exception(c)}},ignore:function(a){return a?function(c){var b=null;b=a.call(this,c);return[null,b[1]]}:null},product:function(){var c=arguments[0],b=Array.prototype.slice.call(arguments,1),a=[];for(var d=0;d<c.length;d++){a.push(q.each(c[d],b))}return a},cache:function(a){var c={},b=null;return function(d){try{b=c[d]=(c[d]||a.call(this,d))}catch(e){b=c[d]=e}if(b instanceof k.Exception){throw b}else{return b}}},any:function(){var a=arguments;return function(c){var b=null;for(var d=0;d<a.length;d++){if(a[d]==null){continue}try{b=(a[d].call(this,c))}catch(e){b=null}if(b){return b}}throw new k.Exception(c)}},each:function(){var a=arguments;return function(c){var e=[],b=null;for(var d=0;d<a.length;d++){if(a[d]==null){continue}try{b=(a[d].call(this,c))}catch(f){throw new k.Exception(c)}e.push(b[0]);c=b[1]}return[e,c]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,b,a){b=b||q.rtoken(/^\s*/);a=a||null;if(c.length==1){return c[0]}return function(s){var h=null,g=null;var e=[];for(var x=0;x<c.length;x++){try{h=c[x].call(this,s)}catch(f){break}e.push(h[0]);try{g=b.call(this,h[1])}catch(y){g=null;break}s=g[1]}if(!h){throw new k.Exception(s)}if(g){throw new k.Exception(g[1])}if(a){try{h=a.call(this,h[1])}catch(d){throw new k.Exception(h[1])}}return[e,(h?h[1]:s)]}},between:function(c,b,d){d=d||c;var a=q.each(q.ignore(c),b,q.ignore(d));return function(f){var e=a.call(this,f);return[[e[0][0],r[0][2]],e[1]]}},list:function(c,b,a){b=b||q.rtoken(/^\s*/);a=a||null;return(c instanceof Array?q.each(q.product(c.slice(0,-1),q.ignore(b)),c.slice(-1),q.ignore(a)):q.each(q.many(q.each(c,q.ignore(b))),px,q.ignore(a)))},set:function(c,b,a){b=b||q.rtoken(/^\s*/);a=a||null;return function(d){var s=null,g=null,h=null,K=null,J=[[],d],e=false;for(var H=0;H<c.length;H++){h=null;g=null;s=null;e=(c.length==1);try{s=c[H].call(this,d)}catch(E){continue}K=[[s[0]],s[1]];if(s[1].length>0&&!e){try{h=b.call(this,s[1])}catch(f){e=true}}else{e=true}if(!e&&h[1].length===0){e=true}if(!e){var G=[];for(var I=0;I<c.length;I++){if(H!=I){G.push(c[I])}}g=q.set(G,b).call(this,h[1]);if(g[0].length>0){K[0]=K[0].concat(g[0]);K[1]=g[1]}}if(K[1].length<J[1].length){J=K}if(J[1].length===0){break}}if(J[0].length===0){return J}if(a){try{h=a.call(this,J[1])}catch(F){throw new k.Exception(J[1])}J[1]=h[1]}return J}},forward:function(b,a){return function(c){return b[a].call(this,c)}},replace:function(a,b){return function(d){var c=a.call(this,d);return[b,c[1]]}},process:function(a,b){return function(d){var c=a.call(this,d);return[b.call(this,c[0]),c[1]]}},min:function(b,a){return function(d){var c=a.call(this,d);if(c[0].length<b){throw new k.Exception(d)}return c}}};var l=function(a){return function(){var d=null,e=[];if(arguments.length>1){d=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){d=arguments[0]}}if(d){for(var b=0,c=d.shift();b<c.length;b++){d.unshift(c[b]);e.push(a.apply(null,d));d.shift();return e}}else{return a.apply(null,arguments)}}};var m="optional not ignore cache".split(/\s/);for(var p=0;p<m.length;p++){q[m[p]]=l(q[m[p]])}var n=function(a){return function(){if(arguments[0] instanceof Array){return a.apply(null,arguments[0])}else{return a.apply(null,arguments)}}};var o="each any all".split(/\s/);for(var j=0;j<o.length;j++){q[o[j]]=n(q[o[j]])}}());(function(){var w=Date,g=w.prototype,v=w.CultureInfo;var t=1604;var u=function(c){var b=[];for(var a=0;a<c.length;a++){if(c[a] instanceof Array){b=b.concat(u(c[a]))}else{if(c[a]){b.push(c[a])}}}return b};w.Grammar={};w.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");if(b.length){this.timezoneOffset=Number(b)}else{this.timezone=a.toLowerCase()}}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=(a.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=((a.length>2)?b:(b+(((b+2000)<v.twoDigitYearMax)?2000:1900)))}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(b){b=(b instanceof Array)?b:[b];for(var c=0;c<b.length;c++){if(b[c]){b[c].call(this)}}var d=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=d.getDate()}if(!this.year){this.year=d.getFullYear()}if(!this.month&&this.month!==0){this.month=d.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.day>w.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var a=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){a.set({timezone:this.timezone})}else{if(this.timezoneOffset){a.set({timezoneOffset:this.timezoneOffset})}}return a},finish:function(f){f=(f instanceof Array)?u(f):[f];if(f.length===0){return null}for(var c=0;c<f.length;c++){if(typeof f[c]=="function"){f[c].call(this)}}var h=w.today();if(this.now&&!this.unit&&!this.operator){return new Date()}else{if(this.now){h=new Date()}}if(Date.allowYearless){h.setFullYear(t)}var b=!!(this.days&&this.days!==null||this.orient||this.operator);var a,d,e;e=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){h.setTimeToNow()}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;b=true}}if(!b&&this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate();if(!this.month){this.month=j.getMonth()}this.year=Date.allowYearless?t:j.getFullYear()}if(b&&this.weekday&&this.unit!="month"){this.unit="day";a=(w.getDayNumberFromName(this.weekday)-h.getDay());d=7;this.days=a?((a+(e*d))%d):(e*d)}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){h.set({day:this.value*1});if(!b){this.day=this.value*1}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;b=true}if(b&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";a=(this.month-h.getMonth());d=12;this.months=a?((a+(e*d))%d):(e*d);this.month=null}if(!this.unit){this.unit="day"}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*e}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*e}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate();if(j.getMonth()!==h.getMonth()){this.month=j.getMonth()}}if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(b&&this.timezone&&this.day&&this.days){this.day=this.days}return(b)?h.add(this):h.set(this)}};var s=w.Parsing.Operators,x=w.Grammar,p=w.Translator,z;x.datePartDelimiter=s.rtoken(/^(\s*(de(l)?|||)\s*|[\s\-\.\,\/\x27]+)/);x.timePartDelimiter=s.stoken(":");x.whiteSpace=s.rtoken(/^\s*/);x.generalDelimiter=s.rtoken(/^(([\s\,]|at|@|on)+)/);var B={};x.ctoken=function(b){var c=B[b];if(!c){var a=v.regexPatterns;var e=b.split(/\s+/),f=[];for(var d=0;d<e.length;d++){f.push(s.replace(s.rtoken(a[e[d]]),e[d]))}c=B[b]=s.any.apply(null,f)}return c};x.ctoken2=function(a){return s.rtoken(v.regexPatterns[a])};x.h=s.cache(s.process(s.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),p.hour));x.hh=s.cache(s.process(s.rtoken(/^(0[0-9]|1[0-2])/),p.hour));x.H=s.cache(s.process(s.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),p.hour));x.HH=s.cache(s.process(s.rtoken(/^([0-1][0-9]|2[0-3])/),p.hour));x.m=s.cache(s.process(s.rtoken(/^([0-5][0-9]|[0-9])/),p.minute));x.mm=s.cache(s.process(s.rtoken(/^[0-5][0-9]/),p.minute));x.s=s.cache(s.process(s.rtoken(/^([0-5][0-9]|[0-9])/),p.second));x.ss=s.cache(s.process(s.rtoken(/^[0-5][0-9]/),p.second));x.hms=s.cache(s.sequence([x.H,x.m,x.s],x.timePartDelimiter));x.t=s.cache(s.process(x.ctoken2("shortMeridian"),p.meridian));x.tt=s.cache(s.process(x.ctoken2("longMeridian"),p.meridian));x.z=s.cache(s.process(s.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),p.timezone));x.zz=s.cache(s.process(s.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),p.timezone));x.zzz=s.cache(s.process(x.ctoken2("timezone"),p.timezone));x.timeSuffix=s.each(s.ignore(x.whiteSpace),s.set([x.tt,x.zzz]));x.time=s.each(s.optional(s.ignore(s.stoken("T"))),x.hms,x.timeSuffix);x.d=s.cache(s.process(s.each(s.rtoken(/^([0-2]\d|3[0-1]|\d)/),s.optional(x.ctoken2("ordinalSuffix"))),p.day));x.dd=s.cache(s.process(s.each(s.rtoken(/^([0-2]\d|3[0-1])/),s.optional(x.ctoken2("ordinalSuffix"))),p.day));x.ddd=x.dddd=s.cache(s.process(x.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}}));x.M=s.cache(s.process(s.rtoken(/^(1[0-2]|0\d|\d)/),p.month));x.MM=s.cache(s.process(s.rtoken(/^(1[0-2]|0\d)/),p.month));x.MMM=x.MMMM=s.cache(s.process(x.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),p.month));x.y=s.cache(s.process(s.rtoken(/^(\d\d?)/),p.year));x.yy=s.cache(s.process(s.rtoken(/^(\d\d)/),p.year));x.yyy=s.cache(s.process(s.rtoken(/^(\d\d?\d?\d?)/),p.year));x.yyyy=s.cache(s.process(s.rtoken(/^(\d\d\d\d)/),p.year));z=function(){return s.each(s.any.apply(null,arguments),s.not(x.ctoken2("timeContext")))};x.day=z(x.d,x.dd);x.month=z(x.M,x.MMM);x.year=z(x.yyyy,x.yy);x.orientation=s.process(x.ctoken("past future"),function(a){return function(){this.orient=a}});x.operator=s.process(x.ctoken("add subtract"),function(a){return function(){this.operator=a}});x.rday=s.process(x.ctoken("yesterday tomorrow today now"),p.rday);x.unit=s.process(x.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}});x.value=s.process(s.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}});x.expression=s.set([x.rday,x.operator,x.value,x.unit,x.orientation,x.ddd,x.MMM]);z=function(){return s.set(arguments,x.datePartDelimiter)};x.mdy=z(x.ddd,x.month,x.day,x.year);x.ymd=z(x.ddd,x.year,x.month,x.day);x.dmy=z(x.ddd,x.day,x.month,x.year);x.date=function(a){return((x[v.dateElementOrder]||x.mdy).call(this,a))};x.format=s.process(s.many(s.any(s.process(s.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(a){if(x[a]){return x[a]}else{throw w.Parsing.Exception(a)}}),s.process(s.rtoken(/^[^dMyhHmstz]+/),function(a){return s.ignore(s.stoken(a))}))),function(a){return s.process(s.each.apply(null,a),p.finishExact)});var q={};var y=function(a){return q[a]=(q[a]||x.format(a)[0])};x.formats=function(c){if(c instanceof Array){var b=[];for(var a=0;a<c.length;a++){b.push(y(c[a]))}return s.any.apply(null,b)}else{return y(c)}};var C=['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","yyyyMMMMd","MMMMd","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy.MM.dd.","yyyy.MM.d.","yyyy.M.dd.","yyyy.M.d.","MM.dd.","MM.d.","M.dd.","M.d.","yyyy","Mdyy","dMyy","d"];x.changeDateArr=function(b){if(v.dateElementOrder==="dmy"&&b.indexOf("d/M")===-1){var a=b.indexOf("M/d");b.insertAt(a,"d/M")}return b};C=x.changeDateArr(C);x._formats=x.formats(C);x._start=s.process(s.set([x.date,x.time,x.expression],x.generalDelimiter,x.whiteSpace),p.finish);x.start=function(a){try{var c=x._formats.call({},a);if(c[1].length===0){return c}}catch(b){}return x._start.call({},a)};w._parse=w.parse;w.parse=function(a){var c=null;if(!a){return null}if(a instanceof Date){return a}try{c=w.Grammar.start.call({},a.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(b){return null}return((c[1].length===0)?c[0]:null)};w.getParseFunction=function(b){var a=w.Grammar.formats(b);return function(e){var d=null;try{d=a.call({},e)}catch(c){return null}return((d[1].length===0)?d[0]:null)}};w.parseExact=function(a,b){return w.getParseFunction(b)(a)}}());(function(){var C=Date,M=C.prototype,B=C.CultureInfo,I=Number.prototype;M._orient=+1;M._nth=null;M._is=false;M._same=false;M._isSecond=false;I._dateElement="day";M.next=function(){this._orient=+1;return this};C.next=function(){return C.today().next()};M.last=M.prev=M.previous=function(){this._orient=-1;return this};C.last=C.prev=C.previous=function(){return C.today().last()};M.is=function(){this._is=true;return this};M.same=function(){this._same=true;this._isSecond=false;return this};M.today=function(){return this.same().day()};M.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun())}return false};M.at=function(a){return(typeof a==="string")?C.parse(this.toString("d")+" "+a):this.set(a)};I.fromNow=I.after=function(b){var a={};a[this._dateElement]=this;return((!b)?new Date():b.clone()).add(a)};I.ago=I.before=function(b){var a={};a[this._dateElement]=this*-1;return((!b)?new Date():b.clone()).add(a)};var O=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),L=("january february march april may june july august september october november december").split(/\s/),J=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),H=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),R=("final first second third fourth fifth").split(/\s/),k;M.toObject=function(){var a={};for(var b=0;b<J.length;b++){a[J[b].toLowerCase()]=this["get"+H[b]]()}return a};C.fromObject=function(a){a.week=null;return Date.today().set(a)};var l=function(a){return function(){if(this._is){this._is=false;return this.getDay()==a}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1)}this._isSecond=false;var b=this._nth;this._nth=null;var c=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(a,b);if(this>c){throw new RangeError(C.getDayName(a)+" does not occur "+b+" times in the month of "+C.getMonthName(c.getMonth())+" "+c.getFullYear()+".")}return this}return this.moveToDayOfWeek(a,this._orient)}};var N=function(a){return function(){var b=C.today(),c=a-b.getDay();if(a===0&&B.firstDayOfWeek===1&&b.getDay()!==0){c=c+7}return b.addDays(c)}};for(var D=0;D<O.length;D++){C[O[D].toUpperCase()]=C[O[D].toUpperCase().substring(0,3)]=D;C[O[D]]=C[O[D].substring(0,3)]=N(D);M[O[D]]=M[O[D].substring(0,3)]=l(D)}var j=function(a){return function(){if(this._is){this._is=false;return this.getMonth()===a}return this.moveToMonth(a,this._orient)}};var K=function(a){return function(){return C.today().set({month:a,day:1})}};for(var E=0;E<L.length;E++){C[L[E].toUpperCase()]=C[L[E].toUpperCase().substring(0,3)]=E;C[L[E]]=C[L[E].substring(0,3)]=K(E);M[L[E]]=M[L[E].substring(0,3)]=j(E)}var Q=function(a){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var d=this.toObject(),e=(arguments[0]||new Date()).toObject(),f="",b=a.toLowerCase();for(var c=(J.length-1);c>-1;c--){f=J[c].toLowerCase();if(d[f]!=e[f]){return false}if(b==f){break}}return true}if(a.substring(a.length-1)!="s"){a+="s"}return this["add"+a](this._orient)}};var P=function(a){return function(){this._dateElement=a;return this}};for(var F=0;F<J.length;F++){k=J[F].toLowerCase();M[k]=M[k+"s"]=Q(J[F]);I[k]=I[k+"s"]=P(k)}M._ss=Q("Second");var S=function(a){return function(b){if(this._same){return this._ss(arguments[0])}if(b||b===0){return this.moveToNthOccurrence(b,a)}this._nth=a;if(a===2&&(b===undefined||b===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var G=0;G<R.length;G++){M[R[G]]=(G===0)?S(-1):S(G)}}());var TimeSpan=function(n,s,v,q,w){var o="days hours minutes seconds milliseconds".split(/\s+/);var x=function(a){return function(){return this[a]}};var p=function(a){return function(b){this[a]=b;return this}};for(var t=0;t<o.length;t++){var y=o[t],z=y.slice(0,1).toUpperCase()+y.slice(1);TimeSpan.prototype[y]=0;TimeSpan.prototype["get"+z]=x(y);TimeSpan.prototype["set"+z]=p(y)}if(arguments.length==4){this.setDays(n);this.setHours(s);this.setMinutes(v);this.setSeconds(q)}else{if(arguments.length==5){this.setDays(n);this.setHours(s);this.setMinutes(v);this.setSeconds(q);this.setMilliseconds(w)}else{if(arguments.length==1&&typeof n=="number"){var u=(n<0)?-1:+1;this.setMilliseconds(Math.abs(n));this.setDays(Math.floor(this.getMilliseconds()/86400000)*u);this.setMilliseconds(this.getMilliseconds()%86400000);this.setHours(Math.floor(this.getMilliseconds()/3600000)*u);this.setMilliseconds(this.getMilliseconds()%3600000);this.setMinutes(Math.floor(this.getMilliseconds()/60000)*u);this.setMilliseconds(this.getMilliseconds()%60000);this.setSeconds(Math.floor(this.getMilliseconds()/1000)*u);this.setMilliseconds(this.getMilliseconds()%1000);this.setMilliseconds(this.getMilliseconds()*u)}}}this.getTotalMilliseconds=function(){return(this.getDays()*86400000)+(this.getHours()*3600000)+(this.getMinutes()*60000)+(this.getSeconds()*1000)};this.compareTo=function(a){var b=new Date(1970,1,1,this.getHours(),this.getMinutes(),this.getSeconds()),c;if(a===null){c=new Date(1970,1,1,0,0,0)}else{c=new Date(1970,1,1,a.getHours(),a.getMinutes(),a.getSeconds())}return(b<c)?-1:(b>c)?1:0};this.equals=function(a){return(this.compareTo(a)===0)};this.add=function(a){return(a===null)?this:this.addSeconds(a.getTotalMilliseconds()/1000)};this.subtract=function(a){return(a===null)?this:this.addSeconds(-a.getTotalMilliseconds()/1000)};this.addDays=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*86400000))};this.addHours=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*3600000))};this.addMinutes=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*60000))};this.addSeconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*1000))};this.addMilliseconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+a)};this.get12HourHour=function(){return(this.getHours()>12)?this.getHours()-12:(this.getHours()===0)?12:this.getHours()};this.getDesignator=function(){return(this.getHours()<12)?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator};this.toString=function(a){this._toString=function(){if(this.getDays()!==null&&this.getDays()>0){return this.getDays()+"."+this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())}else{return this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())}};this.p=function(c){return(c.toString().length<2)?"0"+c:c};var b=this;return a?a.replace(/dd?|HH?|hh?|mm?|ss?|tt?/g,function(c){switch(c){case"d":return b.getDays();case"dd":return b.p(b.getDays());case"H":return b.getHours();case"HH":return b.p(b.getHours());case"h":return b.get12HourHour();case"hh":return b.p(b.get12HourHour());case"m":return b.getMinutes();case"mm":return b.p(b.getMinutes());case"s":return b.getSeconds();case"ss":return b.p(b.getSeconds());case"t":return((b.getHours()<12)?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return(b.getHours()<12)?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()};return this};Date.prototype.getTimeOfDay=function(){return new TimeSpan(0,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};var TimePeriod=function(C,J,K,y,B,F,I){var D="years months days hours minutes seconds milliseconds".split(/\s+/);var G=function(a){return function(){return this[a]}};var N=function(a){return function(b){this[a]=b;return this}};for(var z=0;z<D.length;z++){var L=D[z],M=L.slice(0,1).toUpperCase()+L.slice(1);TimePeriod.prototype[L]=0;TimePeriod.prototype["get"+M]=G(L);TimePeriod.prototype["set"+M]=N(L)}if(arguments.length==7){this.years=C;this.months=J;this.setDays(K);this.setHours(y);this.setMinutes(B);this.setSeconds(F);this.setMilliseconds(I)}else{if(arguments.length==2&&arguments[0] instanceof Date&&arguments[1] instanceof Date){var v=C.clone();var w=J.clone();var x=v.clone();var H=(v>w)?-1:+1;this.years=w.getFullYear()-v.getFullYear();x.addYears(this.years);if(H==+1){if(x>w){if(this.years!==0){this.years--}}}else{if(x<w){if(this.years!==0){this.years++}}}v.addYears(this.years);if(H==+1){while(v<w&&v.clone().addDays(Date.getDaysInMonth(v.getYear(),v.getMonth()))<w){v.addMonths(1);this.months++}}else{while(v>w&&v.clone().addDays(-v.getDaysInMonth())>w){v.addMonths(-1);this.months--}}var E=w-v;if(E!==0){var O=new TimeSpan(E);this.setDays(O.getDays());this.setHours(O.getHours());this.setMinutes(O.getMinutes());this.setSeconds(O.getSeconds());this.setMilliseconds(O.getMilliseconds())}}}return this};(function(){var j=Date,k=j.prototype,p=j.CultureInfo,m=function(a,b){if(!b){b=2}return("000"+a).slice(b*-1)};k.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};k.setTimeToNow=function(){var a=new Date();this.setHours(a.getHours());this.setMinutes(a.getMinutes());this.setSeconds(a.getSeconds());this.setMilliseconds(a.getMilliseconds());return this};j.today=function(){return new Date().clearTime()};j.compare=function(a,b){if(isNaN(a)||isNaN(b)){throw new Error(a+" - "+b)}else{if(a instanceof Date&&b instanceof Date){return(a<b)?-1:(a>b)?1:0}else{throw new TypeError(a+" - "+b)}}};j.equals=function(a,b){return(a.compareTo(b)===0)};j.getDayNumberFromName=function(b){var d=p.dayNames,c=p.abbreviatedDayNames,e=p.shortestDayNames,f=b.toLowerCase();for(var a=0;a<d.length;a++){if(d[a].toLowerCase()==f||c[a].toLowerCase()==f||e[a].toLowerCase()==f){return a}}return -1};j.getMonthNumberFromName=function(b){var d=p.monthNames,c=p.abbreviatedMonthNames,e=b.toLowerCase();for(var a=0;a<d.length;a++){if(d[a].toLowerCase()==e||c[a].toLowerCase()==e){return a}}return -1};j.isLeapYear=function(a){return((a%4===0&&a%100!==0)||a%400===0)};j.getDaysInMonth=function(b,a){return[31,(j.isLeapYear(b)?29:28),31,30,31,30,31,31,30,31,30,31][a]};j.getTimezoneAbbreviation=function(a){var b=p.timezones,c;for(var d=0;d<b.length;d++){if(b[d].offset===a){return b[d].name}}return null};j.getTimezoneOffset=function(d){var a=p.timezones,b;for(var c=0;c<a.length;c++){if(a[c].name===d.toUpperCase()){return a[c].offset}}return null};k.clone=function(){return new Date(this.getTime())};k.compareTo=function(a){return Date.compare(this,a)};k.equals=function(a){return Date.equals(this,a||new Date())};k.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()};k.isAfter=function(a){return this.compareTo(a||new Date())===1};k.isBefore=function(a){return(this.compareTo(a||new Date())===-1)};k.isToday=k.isSameDay=function(a){return this.clone().clearTime().equals((a||new Date()).clone().clearTime())};k.addMilliseconds=function(a){this.setMilliseconds(this.getMilliseconds()+a*1);return this};k.addSeconds=function(a){return this.addMilliseconds(a*1000)};k.addMinutes=function(a){return this.addMilliseconds(a*60000)};k.addHours=function(a){return this.addMilliseconds(a*3600000)};k.addDays=function(a){this.setDate(this.getDate()+a*1);return this};k.addWeeks=function(a){return this.addDays(a*7)};k.addMonths=function(b){var a=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+b*1);this.setDate(Math.min(a,j.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};k.addYears=function(a){return this.addMonths(a*12)};k.add=function(a){if(typeof a=="number"){this._orient=a;return this}var b=a;if(b.milliseconds){this.addMilliseconds(b.milliseconds)}if(b.seconds){this.addSeconds(b.seconds)}if(b.minutes){this.addMinutes(b.minutes)}if(b.hours){this.addHours(b.hours)}if(b.weeks){this.addWeeks(b.weeks)}if(b.months){this.addMonths(b.months)}if(b.years){this.addYears(b.years)}if(b.days){this.addDays(b.days)}return this};var o,n,q;k.getWeek=function(){var w,a,b,c,d,e,f,g,h,s;o=(!o)?this.getFullYear():o;n=(!n)?this.getMonth()+1:n;q=(!q)?this.getDate():q;if(n<=2){w=o-1;a=(w/4|0)-(w/100|0)+(w/400|0);b=((w-1)/4|0)-((w-1)/100|0)+((w-1)/400|0);h=a-b;d=0;e=q-1+(31*(n-1))}else{w=o;a=(w/4|0)-(w/100|0)+(w/400|0);b=((w-1)/4|0)-((w-1)/100|0)+((w-1)/400|0);h=a-b;d=h+1;e=q+((153*(n-3)+2)/5)+58+h}f=(w+a)%7;c=(e+f-d)%7;g=(e+3-c)|0;if(g<0){s=53-((f-h)/5|0)}else{if(g>364+h){s=1}else{s=(g/7|0)+1}}o=n=q=null;return s};k.getISOWeek=function(){o=this.getUTCFullYear();n=this.getUTCMonth()+1;q=this.getUTCDate();return m(this.getWeek())};k.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())};var l=function(a,b,d,c){if(typeof a=="undefined"){return false}else{if(typeof a!="number"){throw new TypeError(a+" is not a Number.")}else{if(a<b||a>d){throw new RangeError(a+" is not a valid value for "+c+".")}}}return true};j.validateMillisecond=function(a){return l(a,0,999,"millisecond")};j.validateSecond=function(a){return l(a,0,59,"second")};j.validateMinute=function(a){return l(a,0,59,"minute")};j.validateHour=function(a){return l(a,0,23,"hour")};j.validateDay=function(b,c,a){return l(b,1,j.getDaysInMonth(c,a),"day")};j.validateMonth=function(a){return l(a,0,11,"month")};j.validateYear=function(a){return l(a,0,9999,"year")};k.set=function(a){if(j.validateMillisecond(a.millisecond)){this.addMilliseconds(a.millisecond-this.getMilliseconds())}if(j.validateSecond(a.second)){this.addSeconds(a.second-this.getSeconds())}if(j.validateMinute(a.minute)){this.addMinutes(a.minute-this.getMinutes())}if(j.validateHour(a.hour)){this.addHours(a.hour-this.getHours())}if(j.validateMonth(a.month)){this.addMonths(a.month-this.getMonth())}if(j.validateYear(a.year)){this.addYears(a.year-this.getFullYear())}if(j.validateDay(a.day,this.getFullYear(),this.getMonth())){this.addDays(a.day-this.getDate())}if(a.timezone){this.setTimezone(a.timezone)}if(a.timezoneOffset){this.setTimezoneOffset(a.timezoneOffset)}if(a.week&&l(a.week,0,53,"week")){this.setWeek(a.week)}return this};k.moveToFirstDayOfMonth=function(){return this.set({day:1})};k.moveToLastDayOfMonth=function(){return this.set({day:j.getDaysInMonth(this.getFullYear(),this.getMonth())})};k.moveToNthOccurrence=function(b,a){var c=0;if(a>0){c=a-1}else{if(a===-1){this.moveToLastDayOfMonth();if(this.getDay()!==b){this.moveToDayOfWeek(b,-1)}return this}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(b,+1).addWeeks(c)};k.moveToDayOfWeek=function(c,b){var a=(c-this.getDay()+7*(b||+1))%7;return this.addDays((a===0)?a+=7*(b||+1):a)};k.moveToMonth=function(a,c){var b=(a-this.getMonth()+12*(c||+1))%12;return this.addMonths((b===0)?b+=12*(c||+1):b)};k.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1};k.getTimezone=function(){return j.getTimezoneAbbreviation(this.getUTCOffset())};k.setTimezoneOffset=function(a){var c=this.getTimezoneOffset(),b=Number(a)*-6/10;return this.addMinutes(b-c)};k.setTimezone=function(a){return this.setTimezoneOffset(j.getTimezoneOffset(a))};k.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset())};k.isDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!=this.getTimezoneOffset()};k.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6,b;if(a<0){b=(a-10000).toString();return b.charAt(0)+b.substr(2)}else{b=(a+10000).toString();return"+"+b.substr(1)}};k.getElapsed=function(a){return(a||new Date())-this};if(!k.toISOString){k.toISOString=function(){function a(b){return b<10?"0"+b:b}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'}}k._toString=k.toString;k.toString=function(b){var d=this;if(b&&b.length==1){var a=p.formatPatterns;d.t=d.toString;switch(b){case"d":return d.t(a.shortDate);case"D":return d.t(a.longDate);case"F":return d.t(a.fullDateTime);case"m":return d.t(a.monthDay);case"r":return d.t(a.rfc1123);case"s":return d.t(a.sortableDateTime);case"t":return d.t(a.shortTime);case"T":return d.t(a.longTime);case"u":return d.t(a.universalSortableDateTime);case"y":return d.t(a.yearMonth)}}var c=function(e){switch(e*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return b?b.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(e){if(e.charAt(0)==="\\"){return e.replace("\\","")}d.h=d.getHours;switch(e){case"hh":return m(d.h()<13?(d.h()===0?12:d.h()):(d.h()-12));case"h":return d.h()<13?(d.h()===0?12:d.h()):(d.h()-12);case"HH":return m(d.h());case"H":return d.h();case"mm":return m(d.getMinutes());case"m":return d.getMinutes();case"ss":return m(d.getSeconds());case"s":return d.getSeconds();case"yyyy":return m(d.getFullYear(),4);case"yy":return m(d.getFullYear());case"dddd":return p.dayNames[d.getDay()];case"ddd":return p.abbreviatedDayNames[d.getDay()];case"dd":return m(d.getDate());case"d":return d.getDate();case"MMMM":return p.monthNames[d.getMonth()];case"MMM":return p.abbreviatedMonthNames[d.getMonth()];case"MM":return m((d.getMonth()+1));case"M":return d.getMonth()+1;case"t":return d.h()<12?p.amDesignator.substring(0,1):p.pmDesignator.substring(0,1);case"tt":return d.h()<12?p.amDesignator:p.pmDesignator;case"S":return c(d.getDate());default:return e}}):this._toString()}}());CW.MergeDelegate={shouldMergeOutdatedChangesWhenCommitting:NO,parentStoreRecordPropertyDidChange:function(f,j,h,g,k){},mergeConflictDuringCommit:function(o,m,l,j,k,n,h){return NO},mergeConflictDuringNotify:function(o,m,l,j,k,n,h){return NO}};sc_require("mixins/merge_delegate");CW.AutoMergingNestedStoreDelegate=SC.Object.extend(CW.MergeDelegate,{shouldMergeOutdatedChangesWhenCommitting:YES,parentStoreRecordPropertyDidChange:function(j,o,m,k,p){if(k){o.propagateStatusIfAppropriateFromStore(j,m);return}var l=j.recordTypeFor(m),q,n;if(!l){SC.warn("%@:  Cannot determine the record type for storeKey=%@, which was changed in our parent store (%@)",this,m,j);return}q=p?"'"+p+"'":"all keys";SC.debug("%@:  Our parent store (%@) changed %@ of storeKey %@, which is a record of type %@.  Merging data",o,j,q,m,l);n=l.propertyMergeGroups;o.propagateStatusIfAppropriateFromStore(j,m);o.mergeDataFromStore(j,m,p,undefined,n)},mergeConflictDuringCommit:function(o,m,l,q,k,n,s){this._reportMergeConflict(m,o,l,k,n,s);var t=o.recordTypeFor(l),p=t.typeString||t.toString();SC.warn("Merge conflict for storeKey %@ (%@) during commit:  %@",l,p,k);return YES},mergeConflictDuringNotify:function(o,m,l,q,k,n,s){var t=o.recordTypeFor(l),p=t.typeString||t.toString();SC.warn("Merge conflict for storeKey %@ (%@) during notify:  %@",l,p,k);return YES},_reportMergeConflict:function(v,o,m,l,n,q){var u=CW.StorageCycleAction,t=CW.errorController,s;if(!t){return}if(!n){n=u.ERROR_CONFLICT}if(!q){q=u.STORAGE_OPERATION_UPDATE}s=u.create({name:"Merging storeKey %@ from %@ to %@".fmt(m,v,o,this),type:u.TYPE_UPDATE,storageOperation:q,storeKeys:[m],status:u.STATUS_ERROR,error:n});var p=this.getPath("storageManager.errorController");if(p){p.addActions([s])}}});CW.HashAttributeCommon={isOrphan:NO,parent:null,parentKey:null,store:function(){var a=this.get("parent");return(a?a.get("store"):undefined)}.property("parent").cacheable(),parentIsRecord:function(){var b=this.get("parent");return(b?b.kindOf(SC.Record):NO)}.property("parent").cacheable(),readAttribute:function(c){var d=this.peekAttributes();return d?d[c]:undefined},attributes:function(){if(this.get("isOrphan")){SC.warn("%@:  Requesting 'attributes' on orphaned instance",this);return null}var f=this.get("parent"),d=this.get("parentKey"),e;if(!f){CW.fatalError("Cannot access 'attributes' because there is no parent",{hashAttributeOrArray:this})}if(SC.none(d)){CW.fatalError("Cannot access 'attributes' because there is no parentKey",{hashAttributeOrArray:this})}if(this.get("parentIsRecord")){e=f.get("store").readEditableDataHash(f.get("storeKey"))}else{e=f.get("attributes")}return(e?e[d]:null)}.property("parent","isOrphan"),hashAttributeDidChange:function(d,e,f){this.childHashDidChange(d,e,f)},destroy:function(){var f=this.get("parent"),d,e;if(f){d=this.get("parentKey");if(!d){CW.fatalError("There is a parent but no parentKey",{target:this,parent:f})}e=f.get("attributes");if(e){delete e[d];this.hashAttributeDidChange();this.orphan()}}arguments.callee.base.apply(this,arguments)},getAncestorRecord:function(){var c=this.get("parent"),d;if(c){if(this.get("parentIsRecord")){d=c}else{d=c.getAncestorRecord()}}return d},orphan:function(){var a=this.parent;if(a.indexOf&&a.indexOf(this)){return}if(this._orphan){this._orphan()}this.beginPropertyChanges();this.set("isOrphan",YES);this.set("parent",null);if(this.parentDidChange){this.parentDidChange()}this.set("parentKey",null);this.destroy();this.allPropertiesDidChange();this.endPropertyChanges()},peekAttributes:function(h){var g=this.get("parent"),e=this.get("parentKey"),f;if(g&&!SC.none(e)){f=g.readAttribute(e)}return f}};CW.HashAttributeSupport={hashAttributeFor:function(h){var e=this._hashAttributes,f=null,g;if(e){g=e[h];if(g){f=g}}return f},childHashDidChange:function(k,f,h){if(!f){if(k){this.notifyPropertyChange(k)}else{this.allPropertiesDidChange()}}var j=this.get("parent");var g=this.get("parentKey");this._ignoreChangePropogation=YES;j.childHashDidChange(g,YES,h);this._ignoreChangePropogation=NO},attributeIsDefault:function(h){var f=this[h],g=this.readAttribute(h),e;if(!f||!f.isRecordAttribute){return g===undefined}e=f.get("defaultValue");if(SC.typeOf(e)===SC.T_FUNCTION){e=e(this,h,f)}return g===e||(SC.none(e)&&SC.none(g))},normalize:function(j,s){var u={},t,q,g,m,p,c,b,a,e,v,f,o=this.get("attributes");for(t in this){q=this[t];if(q){g=q.typeClass;if(g){v=q.get("key")||t;f=g.call(q);m=undefined;u[v]=YES;b=SC.typeOf(g.call(q))===SC.T_CLASS;a=q.isNestedRecordTransform||f.isHashAttribute;if(!b&&!a){m=o[v]}else{if(a){p=this.get(t);if(p){if(p.normalize){p.normalize(j,s)}if(!s&&p.isEmpty&&p.isEmpty()){m=null}else{if(p.get("attributes")){m=p.get("attributes")}else{if(p instanceof SC.ChildArray){m=o[v]}}}}}else{if(b){p=this.get(t);if(p){m=o[v]}}}}if(m===undefined){e=q.get("defaultValue");if(SC.typeOf(e)===SC.T_FUNCTION){m=e(this,t,e)}else{m=e}}if(m!==undefined&&(m!==null||j)){o[v]=m}else{if(!j){delete o[v]}}if(p){if(p.isHashAttribute){p.underlyingContentDidChange()}else{if(p.isHashAttributeArray){p.recordPropertyDidChange()}}}}}}for(t in o){if(!u[t]){SC.debug("%@:  Deleting key from underlying data hash due to normalization:  %@",this,t);delete o[t]}}return this},registerHashAttribute:function(k,h){var f=this._hashAttributes,j,g;if(!f){f=this._hashAttributes={}}j=h.get("parent");g=h.get("parentKey");if(this!==j){CW.fatalError("registerChildHashAttribute():  The specified child hash attribute does not have the proper parent",{key:k,target:this,parent:j})}if(k!==g){CW.fatalError("registerChildHashAttribute():  The specified child hash attribute does not have the proper parentKey",{target:this,key:k,parentKey:g})}f[k]=h},unregisterHashAttribute:function(e,h){var f=this._hashAttributes,g;if(!f){CW.fatalError("unregisterChildHashAttribute():  There is no child hash attributes structure",{target:this})}g=f[e];if(!g){CW.fatalError("unregisterChildHashAttribute():  There is no registered child hash attribute for the specified key",{target:this,key:e})}delete f[e]},_hashAttributes:null};CW.MergeSupport={extendedLogging:YES,propagateStatusIfAppropriateFromStore:function(l,k){var g=SC.Record,h=l.peekStatus(k),j=this.peekStatus(k),m;if(h!==j){if(h===g.ERROR){SC.debug("%@:  Propagating ERROR status for storeKey %@ from %@",this,k,l);m=g.ERROR}else{if(h&g.DESTROYED){if(j===g.READY_NEW){SC.debug("%@:  Propagating destroyed status for storeKey %@ from %@ (it was READY_NEW, so marking it as DESTROYED_CLEAN)",this,k,l);m=g.DESTROYED_CLEAN}else{if(j===g.READY_CLEAN){SC.debug("%@:  Propagating destroyed status for storeKey %@ from %@ (it was READY_CLEAN, so marking it as DESTROYED_CLEAN)",this,k,l);m=g.DESTROYED_CLEAN}else{SC.debug("%@:  Propagating destroyed status for storeKey %@ from %@ (it was not READY_CLEAN, so marking as DESTROYED_DIRTY)",this,k,l);m=g.DESTROYED_DIRTY}}}else{if(j===g.ERROR){if(h===g.READY_CLEAN||h===g.DESTROYED_CLEAN){SC.debug("%@:  Propagating status %@ to override our ERROR status for storeKey %@ from %@",this,h,k,l);m=h}}}}}if(m){this.writeStatus(k,m);this.dataHashDidChange(k,null,true)}},mergeDataFromStore:function(N,P,L,O,B){var w=N.readDataHash(P),H=this.readDataHash(P),I=N.previousDataHashesForNotify[P],J=SC.Record,F,E,D,x,M,z,Q,G;if(!N){CW.fatalError("mergeDataFromStore():  A store must be specified",{target:this,storeKey:P})}if(!P){CW.fatalError("mergeDataFromStore():  A storeKey must be specified",{target:this,mergeFromStore:N})}if(!w&&!H){CW.fatalError("mergeDataFromStore():  There is no data for the specified storeKey in either the lower-level store or the nested store.  Merge should never be triggered in this scenario.",{mergeFromStore:N,target:this,storeKey:P})}else{if(!w){F=this.peekStatus(P);if(F===J.READY_NEW){F=J.DESTROYED_CLEAN}else{F=J.DESTROYED_DIRTY}this.writeStatus(P,F);SC.debug("There is no data for storeKey %@ in the lower-level store (%@) but there is in the nested store (%@).  Marking it as destroyed.",P,N,this);return}else{if(!H){CW.fatalError("mergeDataFromStore():  There is data for the specified storeKey in the lower-level store but not in the nested store.  Merge should never be triggered in this scenario.",{mergeFromStore:N,target:this,storeKey:P})}else{if(!I){SC.warn("There is no original data for storeKey %@ in the lower-level store (%@).  We cannot merge without this information.  (This usually means that dataHashDidChange is being called unnecessarily.)",P,N);return}}}}if(L){if(B){for(E=0,D=B.length;E<D;++E){x=B[E];if(x.indexOf(L)!==-1){SC.debug("Merging '%@' for storeKey %@ from %@ up to %@, but since its defined as part of a merge group (%@), merging all properties from %@",L,P,N,this,x,N);M=YES;break}}}if(!M){SC.debug("Merging '%@' for storeKey %@ from %@ up to %@",L,P,N,this);if(O&&O.indexOf(L)!==-1){SC.debug("  >  We were requested to ignore this property.  Skipping merge");return}G=this.mergePropertyAsPossible(L,w,H,I,YES,N.get("name"),this.get("name"));if(G.changed){z=[L]}if(G.mergeConflict){Q=[L]}}}if(!G){if(!O){SC.debug("Merging all properties for %@ with storeKey %@ from %@ up to %@",N.materializeRecord(P).get("shortTypeString"),P,N,this)}else{SC.debug("Merging all properties except %@ for %@ with storeKey %@ from %@ up to %@",O,N.materializeRecord(P).get("shortTypeString"),P,N,this)}G=this.mergeHashesAsPossible(w,H,I,B,YES,N.get("name"),this.get("name"),O);z=G.changedKeys.concat(G.addedKeys,G.removedKeys);Q=G.mergeConflictKeys}if(z&&z.length>0){this.dataHashDidChange(P,null,NO)}else{var y=SC.Store.generateStoreKey();this.revisions[P]=y}if(Q&&Q.length>0){var K=NO;var C=this.get("delegate");if(C){K=this.invokeDelegateMethod(C,"mergeConflictDuringNotify",N,this,P,z,Q)}if(!K){throw SC.Store.CHAIN_CONFLICT_ERROR}}this._updateLock(P)},mergePropertyAsPossible:function(L,F,Q,I,Z,T,O){var W=this.get("extendedLogging"),G,Y,N,C,aa,J,R,E,D,X,H,S,K,P;G=Y=false;if(!T){T="mergeFrom"}if(!O){O="mergeTo"}if(Z){N=F;aa=T;C=Q;J=O}else{N=Q;aa=O;C=F;J=T}R=F[L];E=Q[L];D=I[L];var U=CW.getSimpleTypes();X=(R===D);if(!X){K=SC.typeOf(R);P=SC.typeOf(D);if(U[K]){X=false}else{X=CW.valuesAreEqual(R,D,K,P)}}H=(E===D);if(!H){S=SC.typeOf(E);if(U[S]){H=false}else{H=CW.valuesAreEqual(E,D,S,P)}}if(H){if(X){if(W){SC.debug("  >  no need to merge '%@' ('%@'), since it hasnt changed in any hash",L,R)}}else{SC.debug("  >  taking value from %@ for '%@' ('%@'), since it didnt change in %@ (it was '%@')",T,L,R,O,E);Y=true}}else{if(X){SC.debug("  >  preserving current value for '%@' ('%@') in %@, since it didnt change in %@",L,E,O,T);G=false;Y=false}else{var M=N[L],V=C[L];if(CW.valuesAreEqual(F[L],Q[L])){SC.debug("  >  no need to merge '%@' ('%@'), even though it changed in both, since both changed it to the same value",L,M)}else{SC.debug("  >  Merge conflict for '%@' (both changed the value).  Preferring value '%@' from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@, and the original value was '%@')",L,M,aa,V,J,!!Z,I[L]);G=true;if(Z){Y=true}}}}if(Y){Q[L]=F[L]}return{mergeConflict:G,changed:Y}},mergeHashesAsPossible:function(a8,be,az,bk,bb,bj,aw,ba){if(a8===be){CW.fatalError("'mergeFrom' and 'mergeTo' are both the same hash, which is not allowed",{mergeFrom:a8,original:az})}if(a8===az){CW.fatalError("'mergeFrom' and 'original' are both the same hash, which is not allowed",{mergeFrom:a8,mergeTo:be})}if(be===az){CW.fatalError("'mergeTo' and 'original' are both the same hash, which is not allowed",{mergeFrom:a8,mergeTo:be})}var bf=this.get("extendedLogging"),aB=[],bh=[],ax=[],a5=[],aQ={},aI,aq,aC,a6,aM,a9;if(!bj){bj="mergeFrom"}if(!aw){aw="mergeTo"}if(bb){aI=a8;aC=bj;aq=be;a6=aw}else{aI=be;aC=aw;aq=a8;a6=bj}aM=CW.hashDifferencesBreakdown(a8,az,ba);a9=CW.hashDifferencesBreakdown(be,az,ba);var aG=aM.equal,aY=a9.equal,bm=aM.different,aW=a9.different,aZ=aM.firstHashOnly,aS=a9.firstHashOnly,a7=aM.secondHashOnly,aF=a9.secondHashOnly,ao=CW.invertArray(aG),at=CW.invertArray(aY),av=CW.invertArray(bm),aK=CW.invertArray(aW),aP=CW.invertArray(aZ),j=CW.invertArray(aS),an=CW.invertArray(a7),aA=CW.invertArray(aF);var a0=bm.concat(aZ).concat(a7),ay=aW.concat(aS).concat(aF);var aE=CW.invertArray(a0),aD=CW.invertArray(ay),ar=CW.combineHashes(aE,aD),a1;for(a1 in aE){ar[a1]=true}for(a1 in aD){ar[a1]=true}var aR=CW.invertHash(ar);var aJ,bi,bl,aL,au,bc=SC.clone(ar,YES),bd=[],aV;if(bk){for(aJ=0,bi=bk.length;aJ<bi;++aJ){aV=[];bl=bk[aJ];for(aL=0,au=bl.length;aL<au;++aL){a1=bl[aL];aV.push(a1);delete bc[a1]}bd.push(aV)}}for(a1 in bc){bd.push(a1);delete bc[a1]}var ap,aX,aO,aU,aN,a3,aH,a4;for(aJ=0,bi=bd.length;aJ<bi;++aJ){aV=bd[aJ];aX=aO=null;ap=!(aV instanceof Array);if(ap){a1=aV;aX=aE[a1]?a1:null;aO=aD[a1]?a1:null;if(aX||aO){aU=CW.valuesAreEqual(a8[a1],be[a1]);aX=(aX&&!aU)?a1:null;aO=(aO&&!aU)?a1:null}}else{for(aL=0,au=aV.length;aL<au;++aL){a1=aV[aL];if(aE[a1]){if(aD[a1]){if(!CW.valuesAreEqual(a8[a1],be[a1])){if(aX){aX.push(a1)}else{aX=[a1]}if(aO){aO.push(a1)}else{aO=[a1]}}else{}}else{if(aX){aX.push(a1)}else{aX=[a1]}}}else{if(aD[a1]){if(aO){aO.push(a1)}else{aO=[a1]}}}}}if(aX&&aO){if(ap){if(aB.indexOf(a1)===-1){aB.push(a1)}aN=aI[a1];a3=aq[a1];if(av[a1]&&aK[a1]){SC.debug("  >  Merge conflict for '%@' (both changed the value).  Preferring value '%@' from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@, and the original value was '%@')",a1,aN,aC,a3,a6,!!bb,az[a1]);if(bb){bh.push(a1)}}else{if(aP[a1]&&j[a1]){SC.debug("  >  Merge conflict for '%@' (both added a value for this key, but they do not match).  Preferring value '%@' from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@)",a1,aN,aC,a3,a6,!!bb);if(bb){bh.push(a1)}}else{if(av[a1]&&aA[a1]){if(bb){SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring value '%@' from %@ over removal from %@ (preferMergeFromIfConflict=%@)",a1,bj,aw,aN,aC,a6,!!bb);ax.push(a1)}else{SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring removal from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@)",a1,bj,aw,aC,a3,a6,!!bb)}}else{if(an[a1]&&aK[a1]){if(bb){SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring removal from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@)",a1,aw,bj,aC,a3,a6,!!bb);a5.push(a1)}else{SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring value '%@' from %@ over removal from %@ (preferMergeFromIfConflict=%@)",a1,aw,bj,aN,aC,a6,!!bb)}}else{CW.fatalError("Bad merge state:  Were claiming that theres a merge conflict for a single key, but the combination doesnt make sense",{key:a1,mergeFrom:bj,mergeFromValue:a8[a1],changedInMergeFrom:av[a1],addedInMergeFrom:aP[a1],removedInMergeFrom:an[a1],mergeTo:aw,mergeToValue:be[a1],changedInMergeTo:aK[a1],addedInMergeTo:j[a1],removedInMergeTo:aA[a1]})}}}}}else{SC.debug("  >  Merge conflict for grouped properties [%@]:  dirty in %@: [%@],  dirty in %@: [%@]",aV,bj,aX,aw,aO);if(bb){SC.debug("  >  Will prefer all values for this group as they are in %@",bj);for(aL=0,au=aV.length;aL<au;++aL){a1=aV[aL];if(!ao[a1]&&aB.indexOf(a1)===-1){aB.push(a1)}aH=a8[a1];a4=be[a1];if(a4===undefined){if(aH!==undefined){SC.debug("       -  adding '%@' ('%@') from %@, since its not in %@",a1,aH,bj,aw);ax.push(a1)}else{}}else{if(aH===undefined){SC.debug("       -  removing '%@' ('%@') from %@, since its not in %@",a1,a4,aw,bj);a5.push(a1)}else{if(!CW.valuesAreEqual(aH,a4)){SC.debug("       -  taking '%@' ('%@') from %@, which will overwrite %@s previous value ('%@')",a1,aH,bj,aw,a4);bh.push(a1)}}}}}else{SC.debug("  >  Will prefer all values for this group as they are in %@",aw);for(aL=0,au=aV.length;aL<au;++aL){a1=aV[aL];if(!ao[a1]&&aB.indexOf(a1)===-1){aB.push(a1)}}}}}else{if(ap){aH=a8[a1];a4=be[a1];if(av[a1]){if(aK[a1]){SC.debug("  >  no need to merge '%@' ('%@'), even though it changed in both, since both changed it to the same value",a1,aH)}else{SC.debug("  >  taking value from %@ for '%@' ('%@'), since it didnt change in %@ (it was '%@')",bj,a1,aH,aw,a4);bh.push(a1)}}else{if(aP[a1]){if(j[a1]){SC.debug("  >  no need to merge '%@' ('%@'), even though it was added to both, since both added the same value",a1,aH)}else{SC.debug("  >  taking value from %@ for '%@' ('%@'), since it was only added there",bj,a1,aH);ax.push(a1)}}else{if(an[a1]){if(aA[a1]){SC.debug("  >  no need to merge '%@' ('%@'), because it was removed from both",a1,aH)}else{SC.debug("  >  removing value for '%@' ('%@') from %@, since it was removed from %@",a1,a4,aw,bj);a5.push(a1)}}}}}else{if(bf){SC.debug("  >  Considering group of keys [%@]",aV)}for(aL=0,au=aV.length;aL<au;++aL){a1=aV[aL];aH=a8[a1];a4=be[a1];if(av[a1]){SC.debug("       -  taking '%@' ('%@') from %@, which will overwrite %@s previous value ('%@')",a1,aH,bj,aw,a4);bh.push(a1)}else{if(aP[a1]){SC.debug("       -  adding '%@' ('%@') from %@, since its not in %@",a1,aH,bj,aw);ax.push(a1)}else{if(an[a1]){SC.debug("       -  removing '%@' ('%@') from %@, since its not in %@",a1,a4,aw,bj);a5.push(a1)}else{if(bf){SC.debug("       -  no need to take '%@' ('%@') from %@, since its the same value in %@",a1,aH,bj,aw)}}}}}}}}var aT=bh.concat(ax),a2;for(aJ=0,a2=aT.length;aJ<a2;++aJ){a1=aT[aJ];be[a1]=SC.clone(a8[a1],YES)}for(aJ=0,a2=a5.length;aJ<a2;++aJ){a1=a5[aJ];delete be[a1]}return{mergeConflictKeys:aB,changedKeys:bh,addedKeys:ax,removedKeys:a5}},_updateLock:function(h){var e=this.locks,f,g;if(!e){CW.fatalError("Store has no locks defined, and we expected the specified storeKey to be locked during the merge.",{target:this,storeKey:h})}if(!e[h]){CW.fatalError("Store has no lock for the specified storeKey, and we expected it to be locked during the merge.",{target:this,storeKey:h})}f=this.revisions[h];e[h]=f||1}};CW.StoreCommon={delegate:null,chain:function(d,c){if(!c){c=CW.NestedStore}return arguments.callee.base.call(this,d,c)},storageManager:null,getCurrentCommitCycle:function(){var c=null,d=this.getPath("storageManager.currentCycle");if(d&&d.get("type")===CW.StorageCycle.COMMIT_CYCLE){c=d}return c},commitAgentsFor:function(c){var d=this.commitAgents;return(d?d[c]:null)},lastCommitAgentWithParam:function(n,l){var o=this.commitAgents,q=null,p,k,j,m;if(o){o=o[n];if(o){for(k=o.length,p=(k-1);p>=0;--p){j=o[p];m=j.get("params");if(m&&m.hasOwnProperty(l)){q=j;break}}}}return q},notifyCommitAgents:function(n,l,o){var p=this.commitAgentsFor(n),j,k,q,m;if(p){for(j=0,k=p.length;j<k;++j){q=p[j];if(q){m=q[l];if(m){m.call(null,n,o)}}}}},previousDataHashesForNotify:null,commitAgents:null,_notifyRecordPropertyChange:function(s,C,t){var G=this.records,z=this.get("nestedStores"),x=SC.Store,E,F,B,u,v,D,q;B=z?z.length:0;for(u=0;u<B;u++){v=z[u];D=v.peekStatus(s);F=v.storeKeyEditState(s);if(F===x.INHERITED){v._notifyRecordPropertyChange(s,C,t)}else{if(D&SC.Record.BUSY){if(v.get("hasChanges")){throw x.CHAIN_CONFLICT_ERROR}v.reset()}else{if(!v._isCommitting){var y=v.get("delegate");if(y){v.invokeDelegateMethod(y,"parentStoreRecordPropertyDidChange",this,v,s,C,t)}else{SC.warn("%@:  Record with storeKey %@ changed underneath us, but since we have no merge delegate set, we wont inherit the changes",v,s)}}}}if(!C&&!this.get("parentStore")){delete this.previousDataHashesForNotify[s];this._savePreviousDataHashForNotify(s)}}var w=this.recordPropertyChanges;if(!w){w=this.recordPropertyChanges={storeKeys:SC.CoreSet.create(),records:SC.CoreSet.create(),hasDataChanges:SC.CoreSet.create(),propertyForStoreKeys:{}}}w.storeKeys.add(s);if(G&&(E=G[s])){w.records.push(s);if(!C){w.hasDataChanges.push(s)}if(t){if(!(q=w.propertyForStoreKeys[s])){q=w.propertyForStoreKeys[s]=SC.CoreSet.create()}if(q!=="*"){q.add(t)}}else{w.propertyForStoreKeys[s]="*"}}this.invokeOnce(this.flush);return this},_verifyLockRevisions:function(ah,ai,U){var ap=this._mergedProperties,an=this._mergedDataHashes;var Y=!!U.getPath("delegate.shouldMergeOutdatedChangesWhenCommitting"),aa,S,O,R;var am=ah.length,al=this.revisions,Q,P,ax,ac;if(ai&&al){for(Q=0;Q<am;Q++){P=ah[Q];ax=ai[P]||1;ac=al[P]||1;var ag=NO;if(ax<ac){var av=SC.Store.recordTypeFor(P);SC.debug("Potential conflict while committing from %@ down to %@:  storeKey %@, of type %@:",U,this,P,av);var at=SC.Record,K=CW.StorageCycleAction,aq=U.peekStatus(P),ar=this.peekStatus(P),ad=SC.Record.DESTROYED,V=SC.Record.READY_NEW,X=(aq&ad)?K.STORAGE_OPERATION_DESTROY:K.STORAGE_OPERATION_UPDATE,ab=NO,aw,ae,Z;if(Y){SC.debug("  >  lock=%@,  current revision=%@",ax,ac);SC.debug("Version in %@:",U);SC.debug("%@",U.materializeRecord(P));SC.debug("Version in %@:",this);SC.debug("%@",this.materializeRecord(P));var au,W,aj;if(ar&ad){if(aq&ad){SC.debug("This record was destroyed in both stores, so ignoring it in the commit")}else{ae=K.ERROR_NOT_FOUND}}else{if(aq&ad){ae=K.ERROR_CONFLICT}else{if((aq===V)&&!(ar===V)){U.writeStatus(P,SC.Record.READY_DIRTY)}var af=U.previousDataHashesForCommit[P];if(!af){CW.fatalError("The nested store does not have a record of the original values of its data hash for a particular storeKey, which we need in order to commit.",{target:this,nestedStore:U,storeKey:P,recordType:av})}S=SC.clone(this.readDataHash(P),YES);aa=U.readDataHash(P);var ak=this.mergeHashesAsPossible;if(ak){SC.debug("Merging data for storeKey %@ from %@ down into %@",P,U,this);aj=ak.call(this,aa,S,af,av.propertyMergeGroups,NO,U.get("name"),this.get("name"));au=aj.changedKeys.concat(aj.addedKeys,aj.removedKeys);W=aj.mergeConflictKeys;ap[P]=au;an[P]=S;if(au.length===0){SC.debug("The merge for storeKey %@ resulted in there being no actual changes in %@",P,this.get("name"))}if(W.length===0){ab=YES}}}}if(ae||(W&&W.length>0)){var ao=U.get("delegate"),T=NO;if(ao){T=U.invokeDelegateMethod(ao,"mergeConflictDuringCommit",this,U,P,au,W,ae,X)}if(!T){ag=YES}}}else{throw SC.Store.CHAIN_CONFLICT_ERROR}if(!ab){SC.debug("Removing this commit from %@s changelog",this.get("name"));Z=U.changelog;if(Z){Z.remove(P)}Z=U.chainedChanges;if(Z){Z.remove(P)}O=this.getCurrentCommitCycle();if(O){R=O.get("changelog");if(R){R.remove(P)}}this.notifyCommitAgents(P,"commitWasUnnecessaryAtStore")}}if(ag){throw SC.Store.CHAIN_CONFLICT_ERROR}}}return this}};sc_require("mixins/hash_attribute_common");sc_require("mixins/hash_attribute_support");CW.HashAttribute=SC.Object.extend(CW.HashAttributeCommon,CW.HashAttributeSupport,{allPropertiesDidChange:function(){var b=this.relationships,a=b?b.length:0;while(--a>=0){if(b[a] instanceof CW.HashAttributeArray){b[a].recordPropertyDidChange()}else{b[a].allPropertiesDidChange()}}return arguments.callee.base.apply(this,arguments)},isHashAttribute:YES,normalize:function(m,n,k){if(this.get("isOrphan")){CW.fatalError("normalize():  Cannot write to an orphan hash attribute",{target:this})}var h=this.get("attributes"),l,o,j;if(!h){if(!this._neverHadAHash){CW.fatalError("normalize():  We once had a hash but no longer do",{target:this})}l=this.get("parent");o=this.get("parentKey");if(!l){CW.fatalError("normalize():  There is no parent",{target:this})}else{if(!o){CW.fatalError("normalize():  There is no parentKey",{target:this,parent:l})}else{if(l.isHashAttributeArray){CW.fatalError("normalize():  There are no attributes but the parent is a hash attribute array",{target:this,parent:l})}}}h={};l.writeAttribute(o,h);this._neverHadAHash=NO}m(n,k)}.enhance(),_checkedKeys:SC.CoreSet.create(),isEmpty:function(){var j,g,h,k=this._checkedKeys.clear();for(j in this){g=this[j];if(!g||!g.isRecordAttribute){continue}h=this.get("key");if((h&&h.isEmpty&&h.isEmpty())||!this.attributeIsDefault(j)){return NO}k.add(j)}var f=this.get("attributes");for(j in f){if(!k.contains(j)){return NO}}return YES},beginEditing:function(){this._editLevel++;return this},endEditing:function(b){if(--this._editLevel<=0){this._editLevel=0;this.hashAttributeDidChange(b)}return this},writeAttribute:function(n,k,l){if(this.get("isOrphan")){SC.debug("writeAttribute():  Cannot write to an orphan hash attribute");return this}var h=this.get("attributes"),m,o,j;if(!h){if(!this._neverHadAHash){CW.fatalError("writeAttribute():  We once had a hash but no longer do",{target:this})}m=this.get("parent");o=this.get("parentKey");if(!m){CW.fatalError("writeAttribute():  There is no parent",{target:this})}else{if(!o){CW.fatalError("writeAttribute():  There is no parentKey",{target:this,parent:m})}else{if(m.isHashAttributeArray){CW.fatalError("writeAttribute():  There are no attributes but the parent is a hash attribute array",{target:this,parent:m})}}}h={};h[n]=k;m.writeAttribute(o,h);this._neverHadAHash=NO}else{if(k!==h[n]){if(!l){this.beginEditing()}h[n]=k;if(!l){this.endEditing(n)}}}return this},storeDidChangeProperties:function(f,e){if(e){this.beginPropertyChanges();e.forEach(function(a){this.notifyPropertyChange(a)},this);this.endPropertyChanges()}else{this.allPropertiesDidChange()}var h=this.relationships,g=h?h.length:0;while(--g>=0){h[g].recordPropertyDidChange(e)}},unknownProperty:function(d,f){var e;if(f!==undefined){e=this.constructor;if(e.ignoreUnknownProperties===YES){this[d]=f}else{this.writeAttribute(d,f)}return f}else{return this.readAttribute(d)}},toString:function(){var c=arguments.callee.base.apply(this,arguments),d=this.peekAttributes();c+="  "+SC.inspect(d);return c},parentDidChange:function(){var f=this._previousParent,h=this.get("parent"),e=this.get("parentKey"),g;if(SC.none(e)){return}if(f!==h){g=this.underlyingContentDidChange;if(f){if(f.unregisterHashAttribute){f.unregisterHashAttribute(e,this)}f.removeObserver(e,this,g)}if(h){if(h.registerHashAttribute){h.registerHashAttribute(e,this)}h.addObserver(e,this,g)}this._previousParent=h;g.call(this)}}.observes("parent"),underlyingContentDidChange:function(){if(this._ignoreChangePropogation){this._ignoreChangePropogation=NO;return}if(this.get("isOrphan")){return}if(!this._neverHadAHash&&!this.peekAttributes()){this.orphan()}else{this.allPropertiesDidChange()}},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("parent");if(!b){CW.fatalError("A hash attribute must have a parent",{hashAttribute:this})}if(!b.isRecord&&!b.isHashAttribute&&!b.isHashAttributeArray){CW.fatalError("A hash attribute arrays parent must either be a record, a hash attribute, or a hash attribute array",{hashAttribute:this,parent:b})}if(!this.peekAttributes()){this._neverHadAHash=YES}this.parentDidChange()},_editLevel:0,_neverHadAHash:NO});CW.HashAttribute.mixin({instantiateHashAttribute:function(e,f,d){if(!SC.kindOf(e,CW.HashAttribute)){CW.fatalError("%@ is not a kind of CW.HashAttribute".fmt(e))}return e.create({parent:f,parentKey:d})},isComplex:YES,isHashAttribute:YES});SC.RecordAttribute.registerTransform(CW.HashAttribute,{to:function(j,g,h,k,l){var m;if(!k){CW.fatalError("Error during transform:  A parent must be specified")}else{if(!k.kindOf(CW.Record)&&!k.kindOf(CW.HashAttribute)){CW.fatalError("The parent must be either an instance of subclass of either CW.Record or CW.HashAttribute",{parent:k,parentKey:l})}else{m=k.hashAttributeFor(l);if(!m){m=CW.HashAttribute.instantiateHashAttribute(h,k,l)}}}return m},from:function(b){if(b&&b.isHashAttribute){CW.fatalError("You should never set a hash attribute directly",{target:this,instance:b})}}});sc_require("mixins/hash_attribute_common");sc_require("mixins/hash_attribute_support");CW.HashAttributeArray=SC.Object.extend(CW.HashAttributeCommon,CW.HashAttributeSupport,SC.Enumerable,SC.Array,{isHashAttributeArray:YES,objectType:null,manyAttribute:null,normalize:function(g,l){var j=this._getReadOnlyUnderlyingArray(),h=j?j.get("length"):0,m,k;for(m=0;m<h;m++){k=this.objectAt(m);k.normalize(g,l)}return this},length:function(){var b=this._getReadOnlyUnderlyingArray();return(b?b.length:0)}.property("parent","parentKey"),objectAt:function(h){var l=this._hashAttributes,j,k,g,m;if(l){m=l[h]}if(!m){j=this._getReadOnlyUnderlyingArray();if(j){k=j[h];if(k){if(SC.typeOf(k)!==SC.T_HASH){CW.fatalError("objectAt():  The object in the array is not a hash",{hashAttributeArray:this,index:h})}g=this.get("objectType");m=CW.HashAttribute.instantiateHashAttribute(g,this,h);if(!l){l=this._hashAttributes=[]}l[h]=m}}}return m},replace:function(u,v,s){var t=this._getEditableUnderlyingArray(),n=[],q=s?(s.get?s.get("length"):s.length):0,x,o;this.arrayContentWillChange(u,v,q);for(x=0;x<q;++x){o=s.objectAt(x);if(SC.kindOf(o,CW.HashAttribute)){o=SC.clone(o.get("attributes"),YES)}else{if(SC.typeOf(o)!==SC.T_HASH){CW.fatalError("Illegal type of item specified in replace()",{target:this,index:x,items:s})}}n.push(o)}t.replace(u,v,n);var y=this._hashAttributes;if(y){var w=t?t.length:0;var p=u+v,z=u+q;for(x=u;x<p;++x){o=y[x];if(o){o.orphan()}}y.splice(u,v);for(x=u;x<w;++x){if(x<z){y.splice(x,0,null)}else{if(o=y[x]){o.set("parentKey",x)}}}if(w!==y.length){CW.fatalError("Hash attribute array length is different from underlying array length",{target:this})}}this.arrayContentDidChange(u,v,q);this.enumerableContentDidChange();this.hashAttributeDidChange(null,YES);return this},isEmpty:function(){var b=this._getReadOnlyUnderlyingArray();return !b||b.get("length")===0},_getReadOnlyUnderlyingArray:function(){var c=this.get("parent"),d=this.get("parentKey");if(!c){CW.fatalError("No parent defined")}if(!d){CW.fatalError("No parentKey defined")}return c.readAttribute(d)},_getEditableUnderlyingArray:function(){var g=this.get("parent"),h=this.get("parentKey"),f,e;if(!g){CW.fatalError("No parent defined")}if(!h){CW.fatalError("No parentKey defined")}f=g.get("attributes");e=f[h];if(!e){e=f[h]=[];this.recordPropertyDidChange(SC.Set.create([h]));this.hashAttributeDidChange(null,YES,YES)}return e},recordPropertyDidChange:function(n){if(n&&!n.contains(this.get("parentKey"))){return this}var z=this._previousUnderlyingArray,q=this._getReadOnlyUnderlyingArray();var s=0,v=0;if(z){s=z.get("length")}this._previousUnderlyingArray=q;if(q){v=q.get("length")}var u=Math.max(0,s-v),p=Math.max(0,v-s),x=Math.min(v,s);this.arrayContentWillChange(x,u,p);var w=this._hashAttributes;if(w){var t,o,y=Math.max(s,v);for(t=0;t<y;t++){o=w[t];if(o){if(t<v){o.allPropertiesDidChange()}else{o.orphan()}}}w.length=v}this.arrayContentDidChange(x,u,p);this.enumerableContentDidChange()},_orphan:function(){var h=this._hashAttributes,e,f,g;if(h){for(e=0,f=h.length;e<f;++e){g=h[e];if(g){g.orphan()}}this._hashAttributes=null}},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("parent");if(!b){CW.fatalError("A hash attribute array must have a parent",{hashAttributeArray:this})}if(!b.isRecord&&!b.isHashAttribute){CW.fatalError("A hash attribute arrays parent must either be a record or a hash attribute",{hashAttributeArray:this})}this.recordPropertyDidChange()},_hashAttributes:null,_previousUnderlyingArray:null});CW.HashAttributeArray.mixin({isComplex:YES,isHashAttributeArray:YES});CW.ManyArray=SC.ManyArray.extend({objectAt:function(a){var g=this._records,f=this.get("readOnlyStoreIds"),c=this.get("store"),h=this.get("recordType"),e,d,b;if(!f||!c){return undefined}b=f.objectAt(a);if(g&&(d=g[a])&&d.get("id")==b){return d}if(!g){this._records=g=[]}if(b){e=c.storeKeyFor(h,b);if(c.readStatus(e)===SC.Record.EMPTY){c.retrieveRecord(h,null,e)}g[a]=d=c.materializeRecord(e)}return d},});CW.ManyAttribute=SC.ManyAttribute.extend({toType:function(b,d,f){var e=this.get("typeClass"),h=this.get("key")||d,g=SC.keyFor("__manyArray__",SC.guidFor(this)),c=b[g],a;if(!c){c=CW.ManyArray.create({recordType:e,record:b,propertyName:h,manyAttribute:this});b[g]=c;a=b.get("relationships");if(!a){b.relationships=a=[]}a.push(c)}return c},fromType:function(b,e,f){var c=[];if(!SC.isArray(f)){throw"Expects toMany attribute to be an array"}var a=f.get("length");for(var d=0;d<a;d++){c[d]=f.objectAt(d).get("id")}return c},});CW.ManyHashAttribute=SC.RecordAttribute.extend({toType:function(n,l,o){var p=this.get("typeClass"),t=this.get("key")||l,s=SC.keyFor("__cw__hashAttributeArray__",SC.guidFor(this)),q=n[s],m,k;if(n&&n.isRecord){m=n.get("store");if(m&&!m.isCoreWebStore){CW.fatalError("Hash attribute arrays require the ancestor record to belong to a CoreWeb store rather than an SC.Store",{target:this,parent:n,store:m})}}if(!q){q=CW.HashAttributeArray.create({objectType:p,parent:n,parentKey:t,manyAttribute:this});n[s]=q;k=n.relationships;if(!k){n.relationships=[q]}else{k.push(q);k.enumerableContentDidChange()}}return q},fromType:function(k,l,j){var g=[],m,h;if(!SC.isArray(j)){CW.fatalError("CW.ManyHashAttribute#fromType:  The toMany attribute should be an array")}for(m=0,h=j.get("length");m<h;++m){if(j.objectAt(m) instanceof CW.HashAttribute){g[m]=SC.clone(j.objectAt(m).get("attributes"),YES)}else{g[m]=j.objectAt(m)}}return g}});sc_require("mixins/hash_attribute_support");sc_require("models/hash_attribute");sc_require("models/many_hash_attribute");CW.Record=SC.Record.extend(CW.HashAttributeSupport,{typeString:function(){var e=this.get("store");if(!e){return null}var d=this.get("storeKey");if(!d){return null}var f=e.recordTypeFor(this.get("storeKey"));if(!f){return null}return f.typeString}.property("store","storeKey").cacheable(),childHashDidChange:function(h,e,g){var f=this.get("store");f.recordDidChange(null,null,this.get("storeKey"),h,YES);this.propagateToAggregates();if(!g){f.flush()}},shortTypeString:function(){var e=this.get("store");if(!e){return null}var d=this.get("storeKey");if(!d){return null}var f=e.recordTypeFor(this.get("storeKey"));if(!f){return null}return f.shortTypeString()}.property("store","storeKey").cacheable(),shortString:function(){var d=this.get("shortTypeString"),c;if(d){d=d.toLowerCase();c=this.get("title");if(c){d+=" %@".fmt(c)}else{d+=" with ID %@".fmt(this.get(this.get("primaryKey")))}}else{d=this.toString()}return d},ownerProperty:null,owner:function(){var b=this.get("ownerProperty");return(b?this.get("property"):null)}.property("ownerProperty"),rootOwner:function(){var b=this.get("owner");if(!b){return this}else{return b.get("rootOwner")}}.property("owner"),isAggregate:function(){var d=this.get("ownerProperty"),e=NO,f;if(d){f=this[d];e=(f&&f.aggregate)}return e}.property("ownerProperty"),aggregates:function(){var w=[],t,y,D,H,v,u,j,F,z,E,G,x,C,I,B;for(t in this){y=this[t];if(y){D=y.typeClass;if(D){D=D.call(y);H=SC.typeOf(D)===SC.T_CLASS;if(H){v=y.inverse;if(v){u=D.prototype[v];if(u){j=u.aggregate;if(j){F=this.get(t);if(F){for(z=0,E=F.get("length");z<E;++z){G=F.objectAt(z);w.push(G);x=G.get("aggregates");if(x){for(C=0,I=x.length;C<I;++C){B=x[C];w.push(B)}}}}}}}}}}}return w.length?w:null}.property(),usesHashAttributes:function(){var m=NO,g=this._hashAttributes,k,l,h,j;if(g){if(g.length>0){m=YES}}if(!m){k=this.relationships;if(k){for(l=0,h=k.length;l<h;++l){j=k[l];if(SC.kindOf(j,CW.HashAttributeArray)){m=YES;break}}}}return m}.property().cacheable()});SC.mixin(CW.Record,{toMany:function(c,d){if(SC.kindOf(c,CW.HashAttribute)){return CW.ManyHashAttribute.attr(c,d)}else{if(SC.kindOf(c,CW.Record)){return CW.ManyAttribute.attr(c,d)}else{return SC.Record.toMany(c,d)}}},shortTypeString:function(){var b=this.typeString;if(b){b=b.split(".");b=b[b.length-1]}return b},storeKeyIfValid:function(g,e){if(!g){CW.fatalError("storeKeyIfValid():  You must specify an ID.")}if(!e){CW.fatalError("storeKeyIfValid():  You must specify a store.")}var h=this.storeKeyExists(g),f;if(h){f=e.peekStatus(h);if(f===this.DESTROYED_CLEAN){h=null}}return h}});CW.CommitAgent=SC.Object.extend({storeKeys:null,params:null,recordWasCommittedToStore:function(c,d){},commitWasUnnecessaryAtStore:function(d,e,f){},recordWasCommittedToServer:function(d,c){},commitToServerFailed:function(d,c){}});sc_require("mixins/store_common");CW.NestedStore=SC.NestedStore.extend(CW.StoreCommon,SC.DelegateSupport,{isCoreWebStore:YES,hasChangesInStoreHierarchy:function(){if(this.get("hasChanges")){return YES}var e=this.get("nestedStores"),h,f,g;if(e){for(h=0,f=e.length;h<f;++h){g=e[h];if(g.get("hasChangesInStoreHierarchy")){return YES}}}return NO},commitChanges:function(J,L,H){this._isCommitting=YES;var w=this,z,D,B,C,E,y,e,K,M,x;if(H){D=this.chainedChanges;if(!D){CW.fatalError("Requested to commit a subset of storeKeys but there is no chainedChanges set",{target:this,storeKeys:H})}H.forEach(function(a){if(!D.contains(a)){CW.fatalError("Requested to commit a storeKey that is not in the chainedChanges set",{target:this,storeKeys:H,chainedChanges:D})}});z=this.changelog;if(z){z.removeEach(H)}if(D){D.removeEach(H)}this._dataHashesToRestore={};this._revisionsToRestore={};this._statusesToRestore={};this._locksToRestore={};this._editablesToRestore={};this._previousDataHashesForNotifyToRestore={};this._previousDataHashesForCommitToRestore={};this._commitAgentsToRestore={};C=["dataHashes","revisions","statuses","locks","editables","previousDataHashesForNotify","previousDataHashesForCommit","commitAgents"];E=C.length;D.forEach(function(a){for(y=0;y<E;++y){e=C[y];K=w[e];if(K&&K.hasOwnProperty(a)){M="_"+e+"ToRestore";w[M][a]=K[a]}}});this._changelogAfterCommit=z;this._chainedChangesAfterCommit=D;this.changelog=this.chainedChanges=H}if(L){var I=L.get("storeKeys");if(!I){I=SC.CoreSet.create();D=this.chainedChanges;if(D){I.addEach(D)}}var F=this.commitAgents;if(!F){F=this.commitAgents={}}I.forEach(function(a){var b=F[a];if(!b){b=F[a]=[];b.push(L)}})}var v=arguments.callee.base.apply(this,arguments);if(H){z=this._changelogAfterCommit;D=this._chainedChangesAfterCommit;this._changelogAfterCommit=null;this._chainedChangesAfterCommit=null;if(D.get("length")>0){var G;D.forEach(function(a){for(y=0;y<E;++y){e=C[y];M="_"+e+"ToRestore";K=w[M];if(K.hasOwnProperty(a)){G=w[e];if(!G){G=w[e]={}}G[a]=K[a]}}});this.changelog=z;this.chainedChanges=D;this.set("hasChanges",YES)}}this._isCommitting=NO;return v},reset:function(){var K=this.get("parentStore");if(!K){throw SC.Store.NO_PARENT_STORE_ERROR}var D=this.dataHashes,z=this.statuses;this.dataHashes=SC.beget(K.dataHashes);this.revisions=SC.beget(K.revisions);this.statuses=SC.beget(K.statuses);var I=this.get("nestedStores"),y,x,E;if(I){for(y=0,x=I.length;y<x;++y){E=I[y];if(!E._fixUpProtypeChainsAfterParentReset){CW.fatalError("The nested store is not a CW.NestedStore, and it needs to be for correct behavior.  A critical bugfix we have made for persistent nested stores has not yet made its way into SproutCore.",{target:this,nestedStore:E})}E._fixUpProtypeChainsAfterParentReset()}}this.previousDataHashesForNotify=SC.beget(K.previousDataHashesForNotify);this.previousDataHashesForCommit={};this.commitAgents=null;this.chainedChanges=this.locks=this.editables=null;this.changelog=null;var L={},M={},J;if(D){var u,F,H=this.dataHashes,B=CW.valuesAreEqual;for(J in D){if(!D.hasOwnProperty(J)){continue}u=D[J];F=H[J];if(!B(u,F)){L[J]=YES}}}if(z){var C,w,G=this.statuses;for(J in z){if(!z.hasOwnProperty(J)){continue}C=z[J];w=G[J];if(C!==w){M[J]=YES}}}var v;for(J in M){if(L[J]){v=NO;delete L[J]}else{v=YES}this._notifyRecordPropertyChange(parseInt(J,10),v)}for(J in L){this._notifyRecordPropertyChange(parseInt(J,10),NO)}this.set("hasChanges",NO)},commitChangesFromNestedStore:function(q,p,v){CW.Store.prototype.commitChangesFromNestedStore.apply(this,arguments);var u=this.get("parentStore"),n=u.revisions,t;var l=this.locks,o=this.chainedChanges,s,m;if(!l){l=this.locks=[]}if(!o){o=this.chainedChanges=SC.Set.create()}s=p.length;for(t=0;t<s;t++){m=p[t];if(!l[m]){l[m]=n[m]||1}o.add(m)}this.setIfChanged("hasChanges",o.get("length")>0);this.flush();return this},_isCommitting:NO,previousDataHashesForCommit:null,readEditableDataHash:function(d){var c=this.recordTypeFor(d);this._savePreviousDataHashForNotify(d,c);this._savePreviousDataHashForCommit(d,c);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(d,f,e){if(f){this._savePreviousDataHashForNotify(d);this._savePreviousDataHashForCommit(d)}return arguments.callee.base.apply(this,arguments)},_savePreviousDataHashForNotify:function(e,g){var f=this.get("nestedStores");if(f&&f.length>0){var h=this.previousDataHashesForNotify;if(!h[e]||!h.hasOwnProperty(e)){h[e]=SC.clone(this.dataHashes[e],YES)}}},_savePreviousDataHashForCommit:function(d){var c=this.previousDataHashesForCommit;if(!c[d]||!c.hasOwnProperty(d)){c[d]=SC.clone(this.dataHashes[d],YES)}},_lock:function(m){var n=this.locks,j,l;if(n&&n[m]){return this}if(!n){n=this.locks=[]}l=this.editables;if(l){l[m]=0}var o=this.get("parentStore"),h;while(o&&(h=o.storeKeyEditState(m))===SC.Store.INHERITED){o=o.get("parentStore")}var k=this.recordTypeFor(m);this._savePreviousDataHashForNotify(m,k);this._savePreviousDataHashForCommit(m,k);if(o&&h===SC.Store.EDITABLE){this.dataHashes[m]=SC.clone(o.dataHashes[m],YES);if(!l){l=this.editables=[]}l[m]=1}else{if(o&&h===SC.Store.LOCKED){this.dataHashes[m]=SC.clone(o.dataHashes[m],YES)}else{this.dataHashes[m]=this.dataHashes[m]}}this.statuses[m]=this.statuses[m];j=this.revisions[m]=this.revisions[m];n[m]=j||1;return this},_fixUpProtypeChainsAfterParentReset:function(){var t=this.get("parentStore");if(!t){throw SC.Store.NO_PARENT_STORE_ERROR}var w=this.__fieldsForWhichToFixPrototypes,x,u,q,p,m,n;for(x=0,u=w.length;x<u;++x){q=w[x];p=this[q];m={};for(n in p){if(p.hasOwnProperty(n)){m[n]=p[n]}}var o=SC.beget(t[q]);this[q]=o;for(n in m){o[n]=m[n]}}var v=this.get("nestedStores"),s;if(v){for(x=0,u=v.length;x<u;++x){s=v[x];s._fixUpProtypeChainsAfterParentReset()}}},__fieldsForWhichToFixPrototypes:["dataHashes","revisions","statuses"]});sc_require("system/nested_store");sc_require("mixins/merge_support");CW.ManagedNestedStore=CW.NestedStore.extend(CW.MergeSupport,{storageManager:null,extendedLogging:YES,lockOnRead:NO,commitChanges:function(B,x){var t=this.get("parentStore"),v=this.get("extendedLogging"),s,C,q,u,z,p,w,y;if(!t){CW.fatalError("A managed nested store must have a parent store",{managedNestedStore:this})}if(t.get("parentStore")){CW.fatalError("A managed nested stores parent store must be a root-level store",{managedNestedStore:this})}if(x){s=x.get("storeKeys");if(!s){s=SC.CoreSet.create();C=this.chainedChanges;if(C){s.addEach(C)}}q=this.commitAgents;if(!q){q=this.commitAgents={}}s.forEach(function(a){var b=q[a];if(!b){b=q[a]=[];b.push(x)}})}u=YES;z=CW.StorageCycle.COMMIT_CYCLE;p=this._getStorageManager();if(p.get("currentCycle")){if(v){SC.debug("%@:  The storage manager says theres an ongoing cycle, so we'll enqueue this commit request",this)}var o=p.pendingCycleOfType(z);if(o){if(v){SC.debug("%@:  but there is already a commit cycle pending, so I dont need to schedule another one.",this)}if(B){y=o.get("params");if(!y){y={force:YES};o.set("params",y)}else{y.force=YES;o.notifyPropertyChange("params")}}u=NO}}if(u){w=CW.StorageCycle.createCycle(z,p);if(B){w.set("params",{force:YES})}p.scheduleCycle(w)}return this},commitChangesFromNestedStore:function(d,e,f){arguments.callee.base.apply(this,arguments);if(this.get("extendedLogging")){SC.debug("%@:  Store keys were committed to the managed store:  %@",this,e)}return this.commitChanges(f)},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("delegate");if(b&&SC.typeOf(b)===SC.T_CLASS){this.set("delegate",b.create())}},_getStorageManager:function(){var b=this.get("storageManager");if(!b){CW.fatalError("Managed nested store has no storage manager defined",{target:this})}return b}});CW.StorageCycle=SC.Object.extend({extendedLogging:YES,type:null,storageManager:null,params:null,currentStageIndex:null,currentStage:function(){var b=this.constructor.stages[this.get("currentStageIndex")];if(!b){b="beginning"}return b}.property("currentStageIndex").cacheable(),getManagedStore:function(){return this.getPath("storageManager.managedStore")},getMainStore:function(){return this.getPath("storageManager.mainStore")},actions:null,addNewAction:function(g,f,h,k){var j=CW.StorageCycleAction.create({name:g,type:f,storageOperation:h});if(k){j.addStoreKeys(k)}this.addAction(j);return j},addAction:function(d){var c=this.get("actions");if(!c){c=[d];this.set("actions",c)}else{c.pushObject(d)}},actionsForStoreKey:function(m){var k=this.get("actions"),h=null,o,j,l,n;if(k){for(o=0,j=k.length;o<j;++o){l=k[o];n=l.get("storeKeys");if(n){if(n.indexOf(m)!==-1){if(!h){h=[l]}else{h.push(l)}}}}}return h},actionsForStoreKeyAndStorageOperation:function(n,k){var l=this.actionsForStoreKey(n),h=null;if(l){var o,j,m;for(o=0,j=l.length;o<j;++o){m=l[o];if(m.get("storageOperation")===k){if(!h){h=[m]}else{h.push(m)}}}}return h},lastActionForStoreKeyAndStorageOperation:function(e,f){var d=this.actionsForStoreKeyAndStorageOperation(e,f);if(d){return d[d.length-1]}else{return null}},dataChangeFunctions:null,scheduleDataChange:function(k){var f=this.get("currentStage"),g=this.constructor,h=g.DATA_CHANGE_STAGE,j;if(f===h){k.call()}else{if(g.scheduleOrderForStage(f)>g.scheduleOrderForStage(h)){CW.fatalError("You cannot schedule a data change after the data change stage has already passed")}else{j=this.get("dataChangeFunctions");if(!j){j=[k];this.set("dataChangeFunctions",j)}else{j.pushObject(k)}}}},"data change":function(){var g=this.get("dataChangeFunctions"),e,f,h;if(g){for(e=0,f=g.length;e<f;++e){h=g[e];h.call()}}},_hasEnded:NO,begin:function(){this.advanceToNextStage()},end:function(){if(this.get("_hasEnded")){return}this.set("_hasEnded",YES);this.invokeLater(this._end)},_end:function(){var b=this.get("storageManager");if(!b){throw new "A storage manager must be defined"}b.cycleDidEnd(this)},advanceToNextStage:function(){if(this.get("_hasEnded")){return}var f=CW.StorageCycle,g=this.constructor.stages,e=this.get("currentStageIndex"),h;if(SC.none(e)){h=0}else{h=e+1}if(h>=g.length){this.end()}else{if(this.get("extendedLogging")){SC.debug("Transitioning ongoing %@ cycle from '%@' to '%@' stage",this.get("type"),this.get("currentStage"),g[h])}this.set("currentStageIndex",h);this.currentStageDidChange()}},stageWillBegin:function(b){},init:function(){arguments.callee.base.apply(this,arguments);if(!this.get("type")){CW.fatalError("Every cycle must have a 'type' specified.",{target:this})}},currentStageDidChange:function(){if(this.get("_hasEnded")){return}var o=CW.StorageCycle,n=this.get("currentStage"),p=this.get("extendedLogging"),u,m,t,l,q,v,s;if(!n){CW.fatalError("There is no stage defined",{target:this,currentStageIndex:this.get("currentStageIndex")})}u=this[n];if(!u){CW.fatalError("There is no method defined for the current stage",{target:this,stage:n})}this.stageWillBegin(n);if(u){u.call(this,this.get("params"))}m=CW.RequestManagement.sharedInstance();t=m.pendingRequestsForCycle(this);l=m.outstandingResponsesForCycle(this);q=t?t.length:0;v=l?l.length:0;s=q+v;if(s===0){if(p){SC.debug("We can automatically advance from the '%@' stage to the next stage",n)}this.advanceToNextStage()}else{if(p){if(s===1){SC.debug("We cannot advance from the '%@' stage to the next stage yet, because there is 1 pending/outstanding request",n)}else{SC.debug("We cannot advance from the '%@' stage to the next stage yet, because there are %@ pending/outstanding requests",n,s)}}}},toString:function(){var d=arguments.callee.base.apply(this,arguments),c=this.get("type");if(c){d=c+" cycle ("+d+")"}return d}});CW.StorageCycle.mixin({stages:null,priority:50,isPreemptible:NO,shouldBeCoalesced:NO,shouldLogLifetime:YES,createCycle:function(g){if(!g){CW.fatalError("createCycle():  You must specify a cycle type")}var h=this._typeToClassMapping,e=CW.StorageCycle,f;if(h){f=h[g]}if(!f){CW.fatalError("There is no registered storage cycle class for the specified type",{type:g})}return f.create()},registerClassForCycleType:function(f,e){if(!f){CW.fatalError("registerClassForCycleType():  You must specify a cycle type")}if(!e){CW.fatalError("registerClassForCycleType():  You must specify a storage cycle subclass",{type:f})}if(!e.isClass){CW.fatalError("registerClassForCycleType():  The specified storage cycle subclass is not a class",{type:f,klass:e})}var d=this._typeToClassMapping;if(!d){d=this._typeToClassMapping={}}d[f]=e},scheduleOrderForStage:function(d){if(!d){CW.fatalError("scheduleOrderForStage():  You must specify a stage")}var f=this.stages,e=f.indexOf(d);if(e===-1){CW.fatalError("scheduleOrderForStage():  Invalid stage specified",{stage:d})}return e},COMMIT_CYCLE:"commit",READ_CYCLE:"read",IDLE_CYCLE:"idle",DATA_CHANGE_STAGE:"data change",_typeToClassMapping:null});sc_require("system/storage_cycles/storage_cycle");CW.CommitCycle=CW.StorageCycle.extend({extendedLogging:YES,type:CW.StorageCycle.COMMIT_CYCLE,changelog:null,dataHashesCheckpointBeforeCycle:null,statusesCheckpointBeforeCycle:null,dataHashesCheckpointBeforeCycleStage:null,statusesCheckpointBeforeCycleStage:null,determineChangelog:function(p){var t=SC.Set.create(),u=p.changelog,B={},s={},o={},y=NO,q=this,x=this.get("extendedLogging");if(u){u.forEach(function(b){if(B[b]){return}var j=p.materializeRecord(b),h;if(!j){CW.fatalError("Could not determine data dependencies because there was an error materializing a record",{store:p,storeKey:b})}if(x){SC.debug("Looking at ancestors of storeKey %@:  %@",b,j.shortString())}var g=NO,n,k,e,d;k=n=j;while((k=k.get("owner"))&&!g){if(x){SC.debug("  >  ancestor:  %@",k.shortString())}e=k.storeKey;if(n.get("isAggregate")){if(!u.contains(e)){CW.fatalError("The ancestor is the aggregate of the child record, but is not in the changelog along with the child",{ancestor:k,child:n})}if(x){SC.debug("  >  ancestor %@ is the aggregate of the child %@, so theres no need to consider the child when scheduling",k.shortString(),n.shortString())}o[b]=k;break}if(u.contains(e)&&!B[e]){d=q._operationOrder(k);if(x){SC.debug("  >  Ordering between child %@ and ancestor %@:  %@",j.shortString(),k.shortString(),d)}if(d===-1){if(x){SC.debug("  >  We must handle ancestor %@ before child %@",k.shortString(),n.shortString())}B[b]=YES;g=YES;break}else{if(d===0){}else{if(d===1){if(x){SC.debug("  >  We must handle child %@ before ancestor %@",n.shortString(),k.shortString())}B[e]=YES}else{CW.fatalError("Unexpected ordering for ancestor and child",{ordering:d,storeKey:b,ancestorStoreKey:e})}}}}n=k}if(!g){var c=j.get("rootOwner"),f=YES,m=NO;if(c){m=(c===j);if(m){if(y){if(x){SC.debug("We cannot include %@ in the current commit cycle because a different root ancestor is already being included",j.shortString())}f=NO}}if(f){var a=c.get("id"),l=o[b];if(!l&&s[a]){if(x){SC.debug("We cannot include %@ in the current commit cycle because a different record from the same root ancestor is already being included (%@)",j.shortString(),s[a].shortString())}f=NO}}}if(f){if(m){y=YES}if(x){SC.debug("We can include %@ in the current commit cycle",j.shortString())}if(!l){s[a]=j}t.add(b)}}else{if(x){SC.debug("We cannot include %@ in the current commit cycle because an ancestor must be handled first",j.shortString())}}})}if(x){var v=t.get("length"),C=(v===1)?"record is":"records are",w;SC.debug("%@ %@ being included in this commit cycle:",v,C);t.forEach(function(b){var a="",c=o[b];if(c){a="  [sent as part of parent %@]".fmt(c.shortString())}w=p.materializeRecord(b);SC.debug("  *  %@%@",w.shortString(),a)});var z=SC.Set.create();u.forEach(function(a){if(!t.contains(a)){z.add(a)}});v=z.get("length");if(v>0){C=(v===1)?"record":"records";SC.debug("%@ %@ will have to wait for a later commit cycle:",v,C);z.forEach(function(a){w=p.materializeRecord(a);SC.debug("  *  %@",w.shortString())})}}return t},_operationOrder:function(d){var e=SC.Record,f=d.get("status");switch(f){case e.READY_NEW:return -1;case e.DESTROYED_DIRTY:return 1;default:return 0}},prepareDataCheckpointForCycle:function(){var c,d;c=this.dataHashesCheckpointBeforeCycle={};d=this.statusesCheckpointBeforeCycle={};this._saveDataCheckpoint(c,d)},prepareDataCheckpointForCycleStage:function(){var c,d;c=this.dataHashesCheckpointBeforeCycleStage={};d=this.statusesCheckpointBeforeCycleStage={};this._saveDataCheckpoint(c,d)},resetCheckpointData:function(){this.dataHashesCheckpointBeforeCycle=null;this.statusesCheckpointBeforeCycle=null;this.dataHashesCheckpointBeforeCycleStage=null;this.statusesCheckpointBeforeCycleStage=null},_saveDataCheckpoint:function(g,h){var e=this.get("changelog"),f=this.getMainStore();if(e){e.forEach(function(b){var c=f.readDataHash(b),o,a,d,p,n,q;g[b]=SC.clone(c,YES);h[b]=f.peekStatus(b);o=f.materializeRecord(b);a=o.get("aggregates");if(a){for(d=0,p=a.length;d<p;++d){n=a[d];q=n.storeKey;c=f.readDataHash(q);g[q]=SC.clone(c,YES);h[q]=f.peekStatus(q)}}})}},removeFromStoreChangelog:function(k){var f=this.get("currentStage"),g=CW.StorageCycle;if(g.scheduleOrderForStage(f)>=g.scheduleOrderForStage(CW.CommitCycle.COMMIT_STAGE)){CW.fatalError("You must call removeFromStoreChangelog() before the commit cycles commit stage")}var h=this.getMainStore(),j=h.changelog;if(j){j.remove(k)}},restoreDataToPreCycleCheckpoint:function(g){if(!g){CW.fatalError("You must specify a storeKey")}var h=this.get("changelog"),k,l,m,j;if(!h){CW.fatalError("restoreDataToPreCycleCheckpoint():  There is no changelog defined, so we cannot restore the previous data",{storeKey:g})}if(!h.contains(g)){CW.fatalError("restoreDataToPreCycleCheckpoint():  The changelog does not include the specified storeKey, so we cannot restore the previous data for it",{storeKey:g})}k=this.getMainStore();l=this.get("dataHashesCheckpointBeforeCycle");m=l[g];j=k.recordTypeFor(g);SC.info("Restoring previous data for storeKey %@, which is a record of type %@, as it was at the beginning of this commit cycle",g,j.typeString);if(m){m=SC.clone(m)}k.writeDataHash(g,m);k.dataHashDidChange(g)},begin:function(){var p=this.get("storageManager"),n=p.get("managedStore"),m=n.get("parentStore"),w=this.get("params"),s=w?w.force:NO,u=CW.StorageCycle,v=this.get("extendedLogging"),q,x,t,o;if(v){SC.debug("%@:  Committing data from managed store (%@) down to main store (%@)",this,n,m)}q=n.changelog;if(q){x=this.determineChangelog(n);if(x.get("length")!==q.get("length")){t=u.COMMIT_CYCLE;o=p.pendingCycleOfType(t);if(!o){o=u.createCycle(t,p);p.scheduleCycle(o)}}this.set("changelog",x);this.prepareDataCheckpointForCycle();this.prepareDataCheckpointForCycleStage();CW.NestedStore.prototype.commitChanges.call(n,s,undefined,x)}else{if(n.get("hasChanges")){SC.debug("Simply resetting the managed store because there are 'chainedChanges' but nothing in the changelog.");n.reset()}}arguments.callee.base.apply(this,arguments)},stageWillBegin:function(d){arguments.callee.base.apply(this,arguments);var c=this.getMainStore();c.flush();this.prepareDataCheckpointForCycleStage()},"commit data":function(u){var l=this.getMainStore(),p=this.get("changelog"),o=p?p.get("length"):0,n;if(o>0){var v=SC.Record.ERROR,s,m,t,q;for(s=0;s<o;++s){m=p[s];t=l.peekStatus(m);if(t===v){q=l.materializeRecord(m);CW.fatalError("Trying to call commitRecords on a record that has status ERROR",{recordType:q.get("shortTypeString"),storeKey:m})}}n=l.commitRecords(null,null,p);if(n===NO){SC.debug("No records were committed to the main store.  This usually means that something was in the changelog but was marked as clean.")}}},"data change":function(){arguments.callee.base.apply(this,arguments);var b=this.getPath("storageManager.errorController");if(b){b.addActions(this.get("actions"))}},end:function(){var f=this.getMainStore(),d=f.commitAgents,e;if(d){e=this.get("changelog");if(e){e.forEach(function(a){delete d[a]})}}this.resetCheckpointData();arguments.callee.base.apply(this,arguments)}});CW.CommitCycle.mixin({stages:["commit data",CW.StorageCycle.DATA_CHANGE_STAGE],priority:2,shouldBeCoalesced:YES,COMMIT_STAGE:"commit data"});CW.StorageCycle.registerClassForCycleType(CW.StorageCycle.COMMIT_CYCLE,CW.CommitCycle);sc_require("system/storage_cycles/storage_cycle");CW.IdleCycle=CW.StorageCycle.extend({type:CW.StorageCycle.IDLE_CYCLE,"issue request":function(b){CW.fatalError("idle cycle 'issue request' stage:  You must implement this method")}});CW.IdleCycle.mixin({stages:["issue request",CW.StorageCycle.DATA_CHANGE_STAGE],priority:1,shouldBeCoalesced:YES,isPreemptible:YES});CW.StorageCycle.registerClassForCycleType(CW.StorageCycle.IDLE_CYCLE,CW.IdleCycle);sc_require("system/storage_cycles/storage_cycle");CW.ReadCycle=CW.StorageCycle.extend({type:CW.StorageCycle.READ_CYCLE,requests:null,addRequest:function(d){if(!d){CW.fatalError("addRequest():  You must specify a request")}var c=this.get("requests");this.propertyWillChange("requests");c.push(d);this.propertyDidChange("requests")},removeRequest:function(d){if(!d){CW.fatalError("removeRequest():  You must specify a request")}var f=this.get("requests"),e=f.indexOf(d);if(e!==-1){f.removeAt(e,1)}},"issue requests":function(j){var h=this.get("requests"),f,g,k;for(f=0,g=h.length;f<g;++f){k=h[f];k.set("cycle",this);k.send()}},init:function(){arguments.callee.base.apply(this,arguments);this.set("requests",[])}});CW.ReadCycle.mixin({stages:["issue requests",CW.StorageCycle.DATA_CHANGE_STAGE],priority:10,shouldBeCoalesced:NO});CW.StorageCycle.registerClassForCycleType(CW.StorageCycle.READ_CYCLE,CW.ReadCycle);CW.StorageCycleAction=SC.Object.extend({name:null,type:null,storageOperation:null,status:null,storeKeys:null,responses:null,params:null,error:null,errorHandled:null,addStoreKeys:function(d){var c=this.get("storeKeys");if(!c){c=[];this.set("storeKeys",c)}if(SC.typeOf(d)===SC.T_ARRAY){c=c.concat(d);this.set("storeKeys",c)}else{c.push(d);c.enumerableContentDidChange()}},getSingleStoreKey:function(){var b=this.get("storeKeys");if(b&&b.length===1){return b[0]}else{return null}},addResponse:function(d){var c=this.get("responses");if(!c){c=[d];this.set("responses",c)}else{c.pushObject(d)}},setParam:function(e,d){var f=this.get("params");if(!f){f={};this.set("params",f)}f[e]=d},paramValueForKey:function(e,d){var f=this.get("params");return f?f[e]:undefined},init:function(){if(!this.get("storageOperation")){CW.fatalError("A storage cycle action must have a storage operation")}if(!this.get("status")){this.set("status",CW.StorageCycleAction.STATUS_ONGOING)}},toString:function(){var o="",l=arguments.callee.base.apply(this,arguments),q=["name","type","storageOperation","status","storeKeys","params","responses","error","errorHandled"],t,p,m,u,s,v,n;for(t=0,p=q.length;t<p;++t){m=q[t];if(m){if(m==="params"){n=[];u=this.get("params");for(s in u){n.push(s+"="+u[s])}n="{"+n.join(", ")+"}";o+=m+"="+n}else{o+=m+"='%@'".fmt(this.get(m))}}if(t!==(p-1)){o+=",  "}}o+="  ("+l+")";return o}});CW.StorageCycleAction.mixin({TYPE_CREATE:"CREATE",TYPE_UPDATE:"UPDATE",TYPE_DESTROY:"DESTROY",STORAGE_OPERATION_CREATE:"CREATE",STORAGE_OPERATION_UPDATE:"UPDATE",STORAGE_OPERATION_DESTROY:"DESTROY",STORAGE_OPERATION_RETRIEVE:"RETRIEVE",STORAGE_OPERATION_FETCH:"FETCH",STATUS_ONGOING:"ongoing",STATUS_SUCCESS:"success",STATUS_ERROR:"error",ERROR_CONFLICT:"CONFLICT",ERROR_NOT_FOUND:"NOT_FOUND",ERROR_NOT_ALLOWED:"NOT_ALLOWED",ERROR_EXCEPTION:"EXCEPTION",ERROR_NOT_AUTHORIZED:"NOT_AUTHORIZED",ERROR_QUOTA_EXCEEDED:"QUOTA_EXCEEDED"});CW.StorageManager=SC.Object.extend({extendedLogging:YES,name:null,managedStore:null,mainStore:function(){return this.getPath("managedStore.parentStore")}.property("managedStore").cacheable(),currentCycle:null,pendingCycles:null,cyclesAreSuspended:function(){return(this._suspendCount>0)}.property(),hasOutstandingCommitCycle:function(){var d=this.get("currentCycle"),e=CW.StorageCycle,f;if(d&&(d.get("type")===e.COMMIT_CYCLE)){return YES}f=this.pendingCycleOfType(e.COMMIT_CYCLE);return(f?YES:NO)}.property("currentCycle","*pendingCycles.[]").cacheable(),scheduleCycle:function(K){if(!K){CW.fatalError("scheduleCycle():  You must specify a cycle")}var H=K.get("storageManager"),M=this.get("currentCycle"),E=(this._suspendCount>0),Q=YES,L=K.get("type"),B=K.constructor,F=B.priority,w,y,G,N,O,J,P,D,C,x,I,z;if(H){if(H===this){CW.fatalError("scheduleCycle():  The specified cycle is already registered with this storage manager",{cycle:K,target:this})}else{CW.fatalError("scheduleCycle():  The specified cycle is already registered with a different storage manager",{cycle:K,target:this,storageManager:H})}}K.set("storageManager",this);if(!M&&!E){this.beginCycle(K);Q=NO;w=YES}else{if(E){SC.debug("Enqueuing new %@ cycle because cycles are suspended",L)}else{if(M){y=M.constructor;G=y.isPreemptible;if(G){N=y.priority;if(F>N){SC.debug("Canceling current %@ cycle because a new %@ cycle has been scheduled",M.get("type"),L);O=YES}else{SC.debug("Enqueuing new %@ cycle because there is a %@ cycle in progress",L,M.get("type"))}}}}}if(Q){J=B.shouldBeCoalesced;P=this.get("pendingCycles");C=P.length;x=0;for(D=C-1;D>=0;--D){I=P[D];if(J&&(L===I.get("type"))){SC.debug("Ignoring registration of %@ cycle because we already have a pending %@ cycle in the queue",L,L);x=-1;break}z=I.constructor.priority;if(z<=F){x=D+1;break}}if(x>=0){P.insertAt(x,K);w=YES}else{w=NO}}if(O){this.cancelCycle(M)}return w},pendingCycleOfType:function(l){var g=CW.StorageCycle,k=this.get("pendingCycles"),m,h,j;for(m=0,h=k.length;m<h;++m){j=k[m];if(j.get("type")===l){return j}}return null},beginCycle:function(e){var f=this.get("currentCycle"),g,h;if(f){CW.fatalError("beginCycle():  Cannot begin a new cycle because there is already a cycle in progress.",{target:this,currentCycle:f,newCycle:e})}else{h=e.constructor.shouldLogLifetime;g=this.get("pendingCycles");if(!g||g.length===0){if(h){SC.Logger.debugGroup("Beginning %@  (no pending cycles)",e)}}else{if(h){SC.Logger.debugGroup("Beginning %@  (pending cycles:  %@)",e,g)}}this.set("currentCycle",e);e.begin()}},cancelCycle:function(x){var v=this.get("currentCycle"),t,o,B,p,w,u,y,z,C,q,s;if(v===x){SC.debug("Canceling current %@ and associated pending/outstanding requests",v);t=SC.Request.manager;o=CW.RequestManagement.sharedInstance();B=o.pendingRequestsForCycle(x);p=o.outstandingResponsesForCycle(x);if(B){for(w=0,u=B.length;w<u;++w){y=B[w];SC.debug("  >  canceling pending request %@",y);y.set("isCancelled",YES);o.removePendingRequest(y)}}if(p){for(w=0,u=p.length;w<u;++w){z=p[w];SC.debug("  >  canceling outstanding request %@",z);t.cancel(z);o.removeOutstandingResponse(z)}}window.status=" ";x.end()}else{C=this.get("pendingCycles");for(w=0,u=C.length;w<u;++w){q=C[w];if(q===x){SC.debug("Canceling pending %@ cycle",x.get("type"));C.removeAt(w,1);s=YES;break}}if(!s){CW.fatalError("cancelCycle():  Requested to cancel a cycle that is neither in progress nor in the pending queue",{target:this,cycle:x})}}},suspendCycles:function(){var b=(this._suspendCount>0);++this._suspendCount;if(!b){this.notifyPropertyChange("cyclesAreSuspended");SC.debug("%@:  Cycles are suspended",this)}},resumeCycles:function(){var b=this._suspendCount;--b;if(b<0){SC.warn("CW.StorageManager#resumeCycles was called without a paired suspendCycles invocation; ignoring");this._suspendCount=0}else{this._suspendCount=b;if(b===0){this.notifyPropertyChange("cyclesAreSuspended");SC.debug("%@:  Cycles have been resumed",this);this._beginFirstPendingCycle()}}},init:function(){arguments.callee.base.apply(this,arguments);this.set("pendingCycles",[]);var d=this.get("managedStore"),f;if(!d){CW.fatalError("You must specify a managed store for the storage manager",{target:this})}f=this.get("mainStore");if(!f){CW.fatalError("The storage manager cannot determine the main store",{target:this,managedStore:d})}if(d.get("storageManager")){CW.fatalError("The managed store is already registered to a different storage manager",{target:this,managedStore:d})}if(f.get("storageManager")){CW.fatalError("The main store is already registered to a different storage manager",{target:this,mainStore:f})}d.set("storageManager",this);f.set("storageManager",this);var e=CW.RequestManagement.sharedInstance();e.addObserver("pendingRequests.[]",this,this.outstandingRequestsDidChange);e.addObserver("outstandingResponses.[]",this,this.outstandingRequestsDidChange)},cycleDidEnd:function(c){var d=this.get("currentCycle");if(!d){CW.fatalError("cycleDidEnd() was invoked but there is no current cycle",{target:this,cycle:c})}if(d!==c){CW.fatalError("cycleDidEnd() was invoked on a cycle that is not the current cycle",{target:this,cycle:c,currentCycle:d})}this.set("currentCycle",null);SC.Logger.debugGroupEnd();if(!this._suspendCount){this._beginFirstPendingCycle()}},outstandingRequestsDidChange:function(){var t=this._previousNumberOfPendingOrOutstandingRequests,x=this.get("currentCycle"),p=CW.RequestManagement.sharedInstance(),C=p.get("pendingRequests"),q=p.get("outstandingResponses"),z=this.get("extendedLogging"),E,D,w,s,v,u,y,B;if(x){E=p.pendingRequestsForCycle(x);D=p.outstandingResponsesForCycle(x);w=E?E.length:0;w+=D?D.length:0;if((t!==undefined)&&(t!==w)){if(w===0){if(x.constructor.shouldLogLifetime){SC.debug("%@:  There are no more pending/outstanding requests",x)}}else{s=p.numberOfPendingOrOutstandingReadsForCycle(x);if(w===1){u=(s>0)?"read":"write";if(x.constructor.shouldLogLifetime){SC.debug("%@:  There is 1 pending/outstanding request  (a %@)",x,u)}}else{v=p.numberOfPendingOrOutstandingWritesForCycle(x);SC.debug("%@:  There are %@ pending/outstanding requests (%@ read, %@ write)",x,w,s,v)}if(z){SC.debug("Outstanding responses:");for(y=0;y<w;++y){B=D[y];SC.debug("  [%@]  %@",y,B)}}}if(w===0){if(x.get("_hasEnded")){CW.fatalError("The number of pending/outstanding requests for the current storage cycle unexpectedly changed to 0 after it ended",{target:this,currentCycle:x,previousNumber:t})}if(z){SC.debug("Advancing to next stage (%@+1) because there are no outstanding requests",x.get("currentStage"))}x.invokeLast(function(){x.advanceToNextStage()})}}}this._previousNumberOfPendingOrOutstandingRequests=w},_beginFirstPendingCycle:function(){var e=this.get("pendingCycles"),d,f;if(e){d=e.length;if(d>0){f=e.shift();this.beginCycle(f);this.get("pendingCycles").enumerableContentDidChange()}}},toString:function(){var c=arguments.callee.base.apply(this,arguments),d=this.get("name");if(d){c=d+" ("+c+")"}return c},_suspendCount:0});sc_require("mixins/store_common");CW.Store=SC.Store.extend(CW.StoreCommon,SC.DelegateSupport,{isCoreWebStore:YES,readEditableDataHash:function(b){this._savePreviousDataHashForNotify(b);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(d,f,e){if(f){this._savePreviousDataHashForNotify(d)}return arguments.callee.base.apply(this,arguments)},placeHolderRecord:function(h,j,f){var k=h.storeKeyFor(j),g;g=this.materializeRecord(k);if(k){this.writeDataHash(k,(f?f:{}));this.writeStatus(k,SC.Record.READY_CLEAN);g.allPropertiesDidChange()}return g},pushRetrieve:function(G,J,B,u,v){var x=SC.Record,E;if(u===undefined){u=G.storeKeyFor(J)}E=this.readStatus(u);if(E==x.EMPTY||E==x.ERROR||E==x.READY_CLEAN||E==x.DESTROYED_CLEAN){E=x.READY_CLEAN;if(B===undefined){this.writeStatus(u,x.EMPTY);this.dataHashDidChange(u)}else{var t=this.getCurrentCommitCycle(),C=t?t.get("changelog"):null;if(C&&C.contains(u)){var F=SC.clone(this.readDataHash(u),YES),w=t.dataHashesCheckpointBeforeCycleStage[u],I=this.mergeHashesAsPossible;if(F&&w&&I){SC.debug("pushRetrieve():  Merging newly-loaded data for storeKey %@ into main store",u);var D=I.call(this,B,F,w,G.propertyMergeGroups,YES,"server-retrieved data",this.get("name"));var H=D.changedKeys.concat(D.addedKeys,D.removedKeys),K=D.mergeConflictKeys;if(H.length||K.length){this.writeDataHash(u,F,E);this.dataHashDidChange(u)}if(K.length>0){var y=this.get("delegate"),z=NO;if(y){z=this.invokeDelegateMethod(y,"mergeConflictDuringNotify",this,null,u,H,K)}}}else{this.writeDataHash(u,B,E);this.dataHashDidChange(u)}}else{this.writeDataHash(u,B,E);this.dataHashDidChange(u)}}return u}return NO},_savePreviousDataHashForNotify:function(d,f){var e=this.get("nestedStores");if(e&&e.length>0){if(!this.previousDataHashesForNotify[d]){this.previousDataHashesForNotify[d]=SC.clone(this.dataHashes[d],YES)}}},reset:function(){this.previousDataHashesForNotify={};this.commitAgents=null;return arguments.callee.base.apply(this,arguments)},commitChangesFromNestedStore:function(Q,z,U){var D=Q.commitAgents,F,S,E,P,O,N,H,B;if(D){F=this.commitAgents;if(!F){F=this.commitAgents={}}for(S in D){S=parseInt(S,10);if(z.contains(S)){E=F[S];P=D[S];if(E){E=E.concat(P)}else{F[S]=P}}}}this._mergedProperties={};this._mergedDataHashes={};if(!U){this._verifyLockRevisions(z,Q.locks,Q)}O=this._mergedProperties||{};N=this._mergedDataHashes||{};var I=z.length,K,V,M,T,W,J,G,R;W=this.revisions;V=this.dataHashes;M=this.statuses;T=this.editables;if(!T){T=this.editables=[]}J=Q.dataHashes;R=Q.revisions;G=Q.statuses;for(K=0;K<I;K++){S=z[K];M[S]=G[S];W[S]=R[S];T[S]=0;H=O[S];if(H){B=H.length;if(B===0){this._notifyRecordPropertyChange(S,YES);this.notifyCommitAgents(S,"commitWasUnnecessaryAtStore")}else{if(this._savePreviousDataHashForCommit){this._savePreviousDataHashForCommit(S)}V[S]=N[S];this._notifyRecordPropertyChange(S,NO);this.notifyCommitAgents(S,"recordWasCommittedToStore",this)}}else{if(this._savePreviousDataHashForCommit){this._savePreviousDataHashForCommit(S)}V[S]=J[S];this._notifyRecordPropertyChange(S,NO);this.notifyCommitAgents(S,"recordWasCommittedToStore",this)}}var L=this.changelog,C=Q.changelog;if(C){if(!L){L=this.changelog=SC.CoreSet.create()}L.addEach(C)}this.changelog=L;if(!this.get("parentStore")){this.flush()}return this}});SC.stringsFor("en-us",{"SC.Date.Era.AD.Abbreviated":"AD","SC.Date.Era.AD.Full":"Anno Domini","SC.Date.Era.AD.Letter":"A","SC.Date.Era.BC.Abbreviated":"BC","SC.Date.Era.BC.Full":"Before Christ","SC.Date.Era.BC.Letter":"B","SC.Date.Quarter.Q1.Abbreviated":"Q1","SC.Date.Quarter.Q1.Full":"1st quarter","SC.Date.Quarter.StandAlone.Q1.Abbreviated":"Q1","SC.Date.Quarter.StandAlone.Q1.Full":"1st Quarter","SC.Date.Quarter.Q2.Abbreviated":"Q2","SC.Date.Quarter.Q2.Full":"2nd quarter","SC.Date.Quarter.StandAlone.Q2.Abbreviated":"Q2","SC.Date.Quarter.StandAlone.Q2.Full":"2nd Quarter","SC.Date.Quarter.Q3.Abbreviated":"Q3","SC.Date.Quarter.Q3.Full":"3rd quarter","SC.Date.Quarter.StandAlone.Q3.Abbreviated":"Q3","SC.Date.Quarter.StandAlone.Q3.Full":"3rd Quarter","SC.Date.Quarter.Q4.Abbreviated":"Q4","SC.Date.Quarter.Q4.Full":"4th quarter","SC.Date.Quarter.StandAlone.Q4.Abbreviated":"Q4","SC.Date.Quarter.StandAlone.Q4.Full":"4th Quarter","SC.Date.Month.January.Abbreviated":"Jan","SC.Date.Month.January.Full":"January","SC.Date.Month.January.Letter":"J","SC.Date.Month.StandAlone.January.Abbreviated":"Jan","SC.Date.Month.StandAlone.January.Full":"January","SC.Date.Month.StandAlone.January.Letter":"J","SC.Date.Month.Prepositional.January.Abbreviated":"Jan","SC.Date.Month.Prepositional.January.Full":"January","SC.Date.Month.Prepositional.January.Letter":"J","SC.Date.Month.February.Abbreviated":"Feb","SC.Date.Month.February.Full":"February","SC.Date.Month.February.Letter":"F","SC.Date.Month.StandAlone.February.Abbreviated":"Feb","SC.Date.Month.StandAlone.February.Full":"February","SC.Date.Month.StandAlone.February.Letter":"F","SC.Date.Month.Prepositional.February.Abbreviated":"Feb","SC.Date.Month.Prepositional.February.Full":"February","SC.Date.Month.Prepositional.February.Letter":"F","SC.Date.Month.March.Abbreviated":"Mar","SC.Date.Month.March.Full":"March","SC.Date.Month.March.Letter":"M","SC.Date.Month.StandAlone.March.Abbreviated":"Mar","SC.Date.Month.StandAlone.March.Full":"March","SC.Date.Month.StandAlone.March.Letter":"M","SC.Date.Month.Prepositional.March.Abbreviated":"Mar","SC.Date.Month.Prepositional.March.Full":"March","SC.Date.Month.Prepositional.March.Letter":"M","SC.Date.Month.April.Abbreviated":"Apr","SC.Date.Month.April.Full":"April","SC.Date.Month.April.Letter":"A","SC.Date.Month.StandAlone.April.Abbreviated":"Apr","SC.Date.Month.StandAlone.April.Full":"April","SC.Date.Month.StandAlone.April.Letter":"A","SC.Date.Month.Prepositional.April.Abbreviated":"Apr","SC.Date.Month.Prepositional.April.Full":"April","SC.Date.Month.Prepositional.April.Letter":"A","SC.Date.Month.May.Abbreviated":"May","SC.Date.Month.May.Full":"May","SC.Date.Month.May.Letter":"M","SC.Date.Month.StandAlone.May.Abbreviated":"May","SC.Date.Month.StandAlone.May.Full":"May","SC.Date.Month.StandAlone.May.Letter":"M","SC.Date.Month.Prepositional.May.Abbreviated":"May","SC.Date.Month.Prepositional.May.Full":"May","SC.Date.Month.Prepositional.May.Letter":"M","SC.Date.Month.June.Abbreviated":"Jun","SC.Date.Month.June.Full":"June","SC.Date.Month.June.Letter":"J","SC.Date.Month.StandAlone.June.Abbreviated":"Jun","SC.Date.Month.StandAlone.June.Full":"June","SC.Date.Month.StandAlone.June.Letter":"J","SC.Date.Month.Prepositional.June.Abbreviated":"Jun","SC.Date.Month.Prepositional.June.Full":"June","SC.Date.Month.Prepositional.June.Letter":"J","SC.Date.Month.July.Abbreviated":"Jul","SC.Date.Month.July.Full":"July","SC.Date.Month.July.Letter":"J","SC.Date.Month.StandAlone.July.Abbreviated":"Jul","SC.Date.Month.StandAlone.July.Full":"July","SC.Date.Month.StandAlone.July.Letter":"J","SC.Date.Month.Prepositional.July.Abbreviated":"Jul","SC.Date.Month.Prepositional.July.Full":"July","SC.Date.Month.Prepositional.July.Letter":"J","SC.Date.Month.August.Abbreviated":"Aug","SC.Date.Month.August.Full":"August","SC.Date.Month.August.Letter":"A","SC.Date.Month.StandAlone.August.Abbreviated":"Aug","SC.Date.Month.StandAlone.August.Full":"August","SC.Date.Month.StandAlone.August.Letter":"A","SC.Date.Month.Prepositional.August.Abbreviated":"Aug","SC.Date.Month.Prepositional.August.Full":"August","SC.Date.Month.Prepositional.August.Letter":"A","SC.Date.Month.September.Abbreviated":"Sep","SC.Date.Month.September.Full":"September","SC.Date.Month.September.Letter":"S","SC.Date.Month.StandAlone.September.Abbreviated":"Sep","SC.Date.Month.StandAlone.September.Full":"September","SC.Date.Month.StandAlone.September.Letter":"S","SC.Date.Month.Prepositional.September.Abbreviated":"Sep","SC.Date.Month.Prepositional.September.Full":"September","SC.Date.Month.Prepositional.September.Letter":"S","SC.Date.Month.October.Abbreviated":"Oct","SC.Date.Month.October.Full":"October","SC.Date.Month.October.Letter":"O","SC.Date.Month.StandAlone.October.Abbreviated":"Oct","SC.Date.Month.StandAlone.October.Full":"October","SC.Date.Month.StandAlone.October.Letter":"O","SC.Date.Month.Prepositional.October.Abbreviated":"Oct","SC.Date.Month.Prepositional.October.Full":"October","SC.Date.Month.Prepositional.October.Letter":"O","SC.Date.Month.November.Abbreviated":"Nov","SC.Date.Month.November.Full":"November","SC.Date.Month.November.Letter":"N","SC.Date.Month.StandAlone.November.Abbreviated":"Nov","SC.Date.Month.StandAlone.November.Full":"November","SC.Date.Month.StandAlone.November.Letter":"N","SC.Date.Month.Prepositional.November.Abbreviated":"Nov","SC.Date.Month.Prepositional.November.Full":"November","SC.Date.Month.Prepositional.November.Letter":"N","SC.Date.Month.December.Abbreviated":"Dec","SC.Date.Month.December.Full":"December","SC.Date.Month.December.Letter":"D","SC.Date.Month.StandAlone.December.Abbreviated":"Dec","SC.Date.Month.StandAlone.December.Full":"December","SC.Date.Month.StandAlone.December.Letter":"D","SC.Date.Month.Prepositional.December.Abbreviated":"Dec","SC.Date.Month.Prepositional.December.Full":"December","SC.Date.Month.Prepositional.December.Letter":"D","SC.Date.Day.Monday.Abbreviated":"Mon","SC.Date.Day.Monday.Full":"Monday","SC.Date.Day.Monday.Letter":"M","SC.Date.Day.StandAlone.Monday.Abbreviated":"Mon","SC.Date.Day.StandAlone.Monday.Full":"Monday","SC.Date.Day.StandAlone.Monday.Letter":"M","SC.Date.Day.Tuesday.Abbreviated":"Tue","SC.Date.Day.Tuesday.Full":"Tuesday","SC.Date.Day.Tuesday.Letter":"T","SC.Date.Day.StandAlone.Tuesday.Abbreviated":"Tue","SC.Date.Day.StandAlone.Tuesday.Full":"Tuesday","SC.Date.Day.StandAlone.Tuesday.Letter":"T","SC.Date.Day.Wednesday.Abbreviated":"Wed","SC.Date.Day.Wednesday.Full":"Wednesday","SC.Date.Day.Wednesday.Letter":"W","SC.Date.Day.StandAlone.Wednesday.Abbreviated":"Wed","SC.Date.Day.StandAlone.Wednesday.Full":"Wednesday","SC.Date.Day.StandAlone.Wednesday.Letter":"W","SC.Date.Day.Thursday.Abbreviated":"Thu","SC.Date.Day.Thursday.Full":"Thursday","SC.Date.Day.Thursday.Letter":"R","SC.Date.Day.StandAlone.Thursday.Abbreviated":"Thu","SC.Date.Day.StandAlone.Thursday.Full":"Thursday","SC.Date.Day.StandAlone.Thursday.Letter":"R","SC.Date.Day.Friday.Abbreviated":"Fri","SC.Date.Day.Friday.Full":"Friday","SC.Date.Day.Friday.Letter":"F","SC.Date.Day.StandAlone.Friday.Abbreviated":"Fri","SC.Date.Day.StandAlone.Friday.Full":"Friday","SC.Date.Day.StandAlone.Friday.Letter":"F","SC.Date.Day.Saturday.Abbreviated":"Sat","SC.Date.Day.Saturday.Full":"Saturday","SC.Date.Day.Saturday.Letter":"S","SC.Date.Day.StandAlone.Saturday.Abbreviated":"Sat","SC.Date.Day.StandAlone.Saturday.Full":"Saturday","SC.Date.Day.StandAlone.Saturday.Letter":"S","SC.Date.Day.Sunday.Abbreviated":"Sun","SC.Date.Day.Sunday.Full":"Sunday","SC.Date.Day.Sunday.Letter":"S","SC.Date.Day.StandAlone.Sunday.Abbreviated":"Sun","SC.Date.Day.StandAlone.Sunday.Full":"Sunday","SC.Date.Day.StandAlone.Sunday.Letter":"S","SC.Date.Period.AM":"AM","SC.Date.Period.PM":"PM","MonthCalendar.MonthYear.Long.Format":"%{date:LLLL} %{date:yyyy}","MonthCalendar.MonthYear.Short.Format":"%{date:LLL} %{date:yyyy}",});CW.DateFormatter=function(c,a){var d=c.dateObject(),b=new Date(d.getTime());return d._isUsingUTC&&b.setMinutes(b.getMinutes()+b.getTimezoneOffset()),SC.DateFormatter(b,a)};SC.BaseTheme.steedWindowRenderDelegate=SC.RenderDelegate.create({className:"window",render:function(f,c){var d=f.get("hasTabBar");var b=f.get("hasNavigationBar");if(d){c.addClass("has-tab-bar")}if(b){c.addClass("has-navigation-bar")}var e=c.begin("div").addClass("window-mask");c=c.begin("div").addClass("window-background");this.includeSlices(f,c,SC.NINE_SLICE);c=c.end();e.end();if(b){c=c.begin("div").addClass("navigation-bar");this.includeSlices(f,c,SC.THREE_SLICE);c.end()}if(d){c=c.begin("div").addClass("tab-bar");this.includeSlices(f,c,SC.THREE_SLICE);c.end()}var a=f.get("ariaLabel");c.attr("aria-label",a||"")},update:function(e,c){var a=e.get("ariaLabel");c.attr("aria-label",a||"");var d=e.get("hasTabBar");var b=e.get("hasNavigationBar");if(d){c.addClass("has-tab-bar")}if(b){c.addClass("has-navigation-bar")}}});CW.SteedChatView=SC.View.extend({isMe:true,render:function(a){if(this.get("isMe")){a.addClass("steed-chat-right")}else{a.addClass("steed-chat-left")}a.push('<div class="middle"/><div class="left"/><div class="right"/><div class="top-right"/><div class="bottom-left"/><div class="bottom-right"/><div class="top-left"/><div class="top"/><div class="bottom"/>');arguments.callee.base.apply(this,arguments)}});CW.SteedWindowView=SC.View.extend({classNames:"steed-window".w(),displayProperties:["hasTabBar","hasNavigationBar"],hasTabBar:NO,hasNavigationBar:YES,renderDelegateName:"steedWindowRenderDelegate"});CW.LAYOUT_KEYS=["left","top","width","height","bottom","right","centerX","centerY"],CW.LAYOUT_DOM_KEYS=["left","top","width","height","right","bottom","marginLeft","marginTop","WebkitTransform"],CW.LAYOUT_OPPOSITE_KEYS={left:"right",right:"left",top:"bottom",bottom:"top"},CW.LAYOUT_SIZE_KEYS={left:"width",top:"height",right:"width",bottom:"height",centerX:"width",centerY:"height",width:"width",height:"height"},CW.LAYOUT_DIMENSION_KEYS={width:["left","width","right"],height:["top","height","bottom"]},CW.ComputedLayout={hasComputedLayout:YES,layoutRules:[],layout:{},_cwcl_hasClonedLayout:NO,_sanitizedLayout:null,_cwcl_frame:{x:0,y:0,left:0,top:0,right:0,bottom:0,centerX:0,centerY:0,width:0,height:0},initMixin:function(){this._layout_key=SC.guidFor(this),this._cwcl_frame={x:0,y:0,left:0,top:0,right:0,bottom:0,centerX:0,centerY:0,width:0,height:0},this._cwcl_validateLayout(),this._cwcl_hasSetupRules=NO,this.scheduleLayoutCalculation()},destroyMixin:function(){this._cwcl_teardownRules()},scheduleLayoutCalculation:function(){CW.ComputedLayoutManager.layoutQueue.add(this)},scheduleFrameNotification:function(){CW.ComputedLayoutManager.notificationQueue.add(this)},scheduleLayoutRender:function(){CW.ComputedLayoutManager.renderQueue.add(this)},_cwcl_setupRules:function(){this._cwcl_hasSetupRules=YES;var b=this.layoutRules,a,c=b.length;for(a=0;a<c;a++){b[a].setup(this)}},_cwcl_teardownRules:function(){var b=this.layoutRules,a,c=b.length;for(a=0;a<c;a++){b[a].teardown()}},_cwcl_validateLayout:function(){this.adjust(this.get("layout"))},_cwcl_layoutDidChange:function(){this._cwcl_validateLayout(),this.scheduleLayoutCalculation()}.observes("layout"),adjust:function(f,b){var h=this.get("layout"),d=CW.LAYOUT_KEYS,a,c=d.length,g;this._cwcl_hasClonedLayout||(h=SC.clone(h),this._cwcl_hasClonedLayout=YES);if(typeof f=="string"){b!==undefined&&this._adjust(h,f,b)}else{for(a=0;a<c;a++){g=d[a],b=f[g],b!==undefined&&this._adjust(h,g,f[g])}}this.layout=h,h.right===undefined&&h.centerX===undefined||!!this._cwcl_rightRuleIsEnabled?h.right===undefined&&h.centerX===undefined&&this._cwcl_rightRuleIsEnabled&&(this._cwcl_rightRule.teardown(),this._cwcl_rightRuleIsEnabled=NO):(this._cwcl_rightRule||(this._cwcl_rightRule=CW.LayoutRule._ViewHelper.create("parent.width")),this._cwcl_rightRule.setup(this),this._cwcl_rightRuleIsEnabled=YES),h.bottom===undefined&&h.centerY===undefined||!!this._cwcl_bottomRuleIsEnabled?h.bottom===undefined&&h.centerY===undefined&&this._cwcl_bottomRuleIsEnabled&&(this._cwcl_bottomRule.teardown(),this._cwcl_bottomRuleIsEnabled=NO):(this._cwcl_bottomRule||(this._cwcl_bottomRule=CW.LayoutRule._ViewHelper.create("parent.height")),this._cwcl_bottomRule.setup(this),this._cwcl_bottomRuleIsEnabled=YES),this._cwcl_sanitizeLayout(),this.scheduleLayoutCalculation()},_adjust:function(k,q,d){var b=CW.LAYOUT_OPPOSITE_KEYS,h=CW.LAYOUT_SIZE_KEYS,v=CW.LAYOUT_DIMENSION_KEYS,c,p,m,j=h[q],g=b[q];k[q]=d;if(g&&k[g]!==undefined){delete k[j];return}if(q==="width"||q==="height"){c=v[q],p=c[0],m=c[2],k[p]!==undefined&&k[m]!==undefined&&delete k[m];return}if(q==="centerX"||q==="centerY"){c=v[j],p=c[0],m=c[2],delete k[p],delete k[m]}},_cwcl_sanitizeLayout:function(){var b=this.get("layout"),a=this._sanitizedLayout,c=this.computeParentDimensions();a||(a={}),a.rightFromParent=b.right,a.bottomFromParent=b.bottom,a.left=b.left,a.top=b.top,a.width=b.width,a.height=b.height,a.centerX=b.centerX,a.centerY=b.centerY,a.centerX!==undefined&&(a.left=a.centerX+c.width/2-a.width/2),a.centerY!==undefined&&(a.top=a.centerY+c.height/2-a.height/2),a.rightFromParent!==undefined?a.right=c.width-a.rightFromParent:(a.right=a.left+a.width,a.rightFromParent=c.width-a.right),a.bottomFromParent!==undefined?a.bottom=c.height-a.bottomFromParent:(a.bottom=a.top+a.height,a.bottomFromParent=c.height-a.bottom),a.left===undefined?a.left=a.right-a.width:a.width===undefined&&(a.width=a.right-a.left),a.top===undefined?a.top=a.bottom-a.height:a.height===undefined&&(a.height=a.bottom-a.top),a.centerX=a.left-(c.width/2-a.width/2),a.centerY=a.top-(c.height/2-a.height/2),this._sanitizedLayout=a},frame:function(){return CW.ComputedLayoutManager.flushLayout(),this._cwcl_frame}.property().cacheable(),notifyFrameChange:function(){this.notifyPropertyChange("frame")},computeParentDimensions:function(){var b=this.parentView,a;return b?(!b.hasComputedLayout&&!b._cwcl_frame&&this.parentViewDidResize(),b._cwcl_frame):SC.RootResponder.computeWindowSize()},parentViewDidResize:function(){var d=CW.ComputedLayoutManager,b=this.get("parentView"),f,c;if(!b||!b.hasComputedLayout){b?(c=b.get("frame"),f=b._cwcl_frame,f||(b._cwcl_frame=f={}),f.left=c.x,f.top=c.y,f.width=c.width,f.height=c.height):(f=this.computeParentDimensions(),f.left=0,f.top=0),f.right=f.left+f.width,f.bottom=f.top+f.height;var a=SC.guidFor(b);d.notify(a+":layout/right").notify(a+":layout/bottom").notify(a+":layout/width").notify(a+":layout/height").notify(a+":layout/centerX").notify(a+":layout/centerY")}},_TMP:{},processLayoutRules:function(){this._cwcl_hasSetupRules||this._cwcl_setupRules();var k,q,d=this.layoutRules,b=this._sanitizedLayout,h=this._TMP,v=this._cwcl_frame,c=CW.LAYOUT_KEYS,p,m=this._layout_key,j=CW.ComputedLayoutManager,g=this.computeParentDimensions();q=c.length;for(k=0;k<q;k++){p=c[k],h[p]=b[p]}q=d.length;for(k=0;k<q;k++){d[k].applyTo(h,g)}q=c.length;for(k=0;k<q;k++){p=c[k],v[p]!==h[p]&&(v[p]=h[p],j.notify(m+":layout/"+c[k]))}v.rightFromParent=g.width-v.right,v.bottomFromParent=g.height-v.bottom,v.x=v.left,v.y=v.top,this.scheduleFrameNotification(),this.scheduleLayoutRender()},layoutStyle:function(){var g=this._cwcl_frame,c=this._cl_lastLayout||{},j=this.get("hasAcceleratedLayer"),f="",b,d=CW.LAYOUT_DOM_KEYS,h,a=d.length;b=this._cwcl_layoutStyles,b||(b=this._cwcl_layoutStyles={});for(h=0;h<a;h++){b[d[h]]=undefined}j?(b.left="0px",f+="translateX("+g.left+"px) "):b.left=g.left+"px",b.width=g.width+"px",j?(b.top="0px",f+="translateY("+g.top+"px) "):b.top=g.top+"px",b.height=g.height+"px",b.WebkitTransform=f,c.left=g.left,c.rightFromParent=g.rightFromParent,c.top=g.top,c.bottomFromParent=g.bottomFromParent,c.centerX=g.centerX,c.centerY=g.centerY,this._cl_lastLayout=c;for(h=0;h<a;h++){b[d[h]]===undefined&&(b[d[h]]="")}return b}.property(),updateLayout:function(){var g=CW.LAYOUT_DOM_KEYS,c,j=g.length,f,b=this.get("layer"),d=this._lastLayoutStyle,h=this.layoutStyle(),a;d||(d={});if(b){a=b.style;for(c=0;c<j;c++){f=g[c],h[f]!==d[f]&&(a[f]=h[f])}}this._lastLayoutStyle=d}},CW.ComputedLayoutQueue={create:function(b){var a=SC.beget(this);return a.method=b,a.isAddedKey="_sclm_has_"+b,a.nextItemKey="_sclm_next_"+b,a},isProcessing:NO,processingIsScheduled:NO,method:"",_first:null,_last:null,add:function(b){var a=this.isAddedKey,c=this.nextItemKey;if(b[a]){return}this._last?this._last[c]=b:this._first=b,b[c]=null,b[a]=YES,this._last=b,this.isScheduled||(CW.ComputedLayoutManager.schedule(),this.isScheduled=YES)},process:function(){this.isScheduled=NO;var d=this._first,b=this.method,f,c=this.isAddedKey,a=this.nextItemKey;while(d){f=d[a],d[a]=null,d[c]=NO,d[b](),d=f||d[a]}return this._first=null,this._last=null,NO}},CW.ComputedLayoutManager={layoutQueue:CW.ComputedLayoutQueue.create("processLayoutRules"),notificationQueue:CW.ComputedLayoutQueue.create("notifyFrameChange"),renderQueue:CW.ComputedLayoutQueue.create("updateLayout"),schedule:function(){SC.RunLoop.currentRunLoop.invokeOnce(this,this.flush)},flush:function(c){c=c===YES;var a=this.layoutQueue,d=this.notificationQueue,b=this.renderQueue;while(YES){if(a.process()){continue}if(!c&&d.process()){continue}if(!c&&b.process()){continue}break}},flushLayout:function(){this.flush(YES)},_listeners:{},addListener:function(b,a){var c=this._listeners;c[b]||(c[b]=[]),c[b].push(a)},removeListener:function(b,a){var c=this._listeners;if(!c[b]){return}c[b].removeObject(a),c[b].length<1&&delete c[b]},notify:function(c){var a=this._listeners[c],d,b;if(!a){return this}b=a.length;for(d=0;d<b;d++){a[d].dependentKeyDidChange()}return this}},CW.LayoutRule={isLayoutRule:YES,isEnabled:YES,owner:null,operations:null,_dependentKeys:null,_observing:null,_listening:null,create:function(){var a=SC.beget(this);return a.init.apply(a,arguments),a},init:function(){this.executionCount=0,this._observing=[],this._listening=[],this._dependentKeys=[],this.operations=[]},extend:function(a){return SC.beget(this)._extend(a)},_extend:function(b){var a;for(var c in b){a=b[c],typeof a=="function"&&this[c]&&(a.base=this[c]),this[c]=a}return this},setup:function(c){this.owner=c,this.observeDependentKeys();var a=this.operations,d,b=a.length;for(d=0;d<b;d++){a[d].setup(c)}},teardown:function(){this.ignoreDependentKeys();var b=this.operations,a,c=b.length;for(a=0;a<c;a++){b[a].teardown()}},reset:function(){this.teardown(),this.setup(this.owner)},addOperation:function(a){a.root=this,this.operations.push(a)},perform:function(c){if(!this.isEnabled){return c}var a=this.operations,d,b=a.length;for(d=0;d<b;d++){c=a[d].perform(c)}return c},addOperator:function(b,a,c){c&&(a=a.extend(c)),this[b]=function(){var d=a.create.apply(a,arguments);return this.operations.push(d),d.root=this,this}}},CW.layout=function(b){var a=CW.LayoutRule.create();return a.property=b,a},SC.mixin(CW.LayoutRule,{normalizeKey:function(a){return a.length===0?[]:(a=a.split("."),CW.LAYOUT_KEYS.indexOf(a[0])<0&&a[0]!=="parent"?a[0]==="self"||a[0].length<1?(a.shift(),a):(a.unshift("parent"),a):a)},addDependentKey:function(a){this._dependentKeys.push(a)},observeDependentKeys:function(){var b=this._dependentKeys,a=b.length;for(var c=0;c<a;c++){this.observe(b[c])}},ignoreDependentKeys:function(){var f=this._observing,b=f.length,h=this._reset,d,a;for(var c=0;c<b;c++){f[c++].removeObserver(f[c],this,h)}var g=this._listening;b=g.length;for(c=0;c<b;c++){CW.ComputedLayoutManager.removeListener(g[c],this)}this._observing.length=0,this._listening.length=0},observe:function(d){var b=this.owner,f,c=d.length,a;for(f=0;f<c;f++){if(!b){return}a=d[f],CW.LAYOUT_KEYS.indexOf(a)>-1?this.listen(b,a):(a==="parent"&&(a="parentView"),b.addObserver(a,this,this._reset),this._observing.push(b),this._observing.push(a),b=b.get(a))}},listen:function(b,a){var c=SC.guidFor(b);CW.ComputedLayoutManager.addListener(c+":layout/"+a,this),this._listening.push(c+":layout/"+a)},findProperty:function(d){var b=this.owner,f,c=d.length,a;for(f=0;f<c;f++){if(!b){return}a=d[f];if(CW.LAYOUT_KEYS.indexOf(d[f])>-1){return b._cwcl_frame[a]}a==="parent"&&(a="parentView"),b=b[a]}return undefined}}),CW.AT_LEAST="at_least",CW.AT_MOST="at_most",CW.EXACTLY="exactly",SC.mixin(CW.LayoutRule,{property:null,relation:CW.EXACTLY,shouldResize:NO,movesSide:"top",atLeast:function(a){return this.relation=CW.AT_LEAST,a!==undefined&&this.to(a),this},atMost:function(a){return this.relation=CW.AT_MOST,a!==undefined&&this.to(a),this},resize:function(){return this.shouldResize=YES,this},move:function(){return this.shouldResize=NO,this},moveSide:function(a){return this.movesSide=a,this},applyTo:function(f,b){var g=this.property,d=f[g],a,c=this.relation;a=this.perform(d),c===CW.AT_LEAST?a>d&&(d=a):c===CW.AT_MOST?a<d&&(d=a):d=a,this._adjuster||this._findAdjuster(),this._adjuster(f,d,b)},_findAdjuster:function(){var b=this.property,a=this.shouldResize,c=this.movesSide;b==="width"?(c==="top"&&(c="left"),c==="bottom"&&(c="right")):b==="height"&&(c==="left"&&(c="top"),c==="right"&&(c="bottom")),this.movesSide=c,this._adjuster=this["_adjust_"+b]},_adjust_left:function(b,a,c){b.left=a,this.shouldResize?b.width=b.right-a:b.right=a+b.width,b.centerX=b.left-(c.width/2-b.width/2)},_adjust_right:function(b,a,c){b.right=a,this.shouldResize?b.width=a-b.left:b.left=a-b.width,b.centerX=b.left-(c.width/2-b.width/2)},_adjust_width:function(b,a,c){b.width=a,this.movesSide==="left"?(b.left=b.right-b.width,b.centerX=b.left-(c.width/2-b.width/2)):this.movesSide==="right"?(b.right=b.left+b.width,b.centerX=b.left-(c.width/2-b.width/2)):(b.left=c.width/2-b.width/2+b.centerX,b.right=c.width/2+b.width/2+b.centerX)},_adjust_centerX:function(b,a,c){b.centerX=a,b.left=c.width/2-b.width/2+a,b.right=c.width/2+b.width/2+a},_adjust_top:function(b,a,c){b.top=a,this.shouldResize?b.height=b.bottom-a:b.bottom=a+b.height,b.centerY=b.top-(c.height/2-b.height/2)},_adjust_bottom:function(b,a,c){b.bottom=a,this.shouldResize?b.height=a-b.top:b.top=a-b.height,b.centerY=b.top-(c.height/2-b.height/2)},_adjust_height:function(b,a,c){b.height=a,this.movesSide==="top"?(b.top=b.bottom-b.height,b.centerY=b.top-(c.height/2-b.height/2)):this.movesSide==="bottom"?(b.bottom=b.top+b.height,b.centerY=b.top-(c.height/2-b.height/2)):(b.top=c.height/2-b.height/2+b.centerY,b.bottom=c.height/2+b.height/2+b.centerY)},_adjust_centerY:function(b,a,c){b.centerY=a,b.top=c.height/2-b.height/2+a,b.bottom=c.height/2+b.height/2+a}}),SC.mixin(CW.LayoutRule,{dependentKeyDidChange:function(){this.owner.scheduleLayoutCalculation()}}),CW.LayoutRule._ViewHelper=CW.LayoutRule.extend({init:function(a){arguments.callee.base.apply(this,arguments),a=this.normalizeKey(a),this.addDependentKey(a)},dependentKeyDidChange:function(){this.owner._cwcl_sanitizeLayout(),this.owner.scheduleLayoutCalculation()}}),CW.LayoutRule.Add=CW.LayoutRule.extend({isNegative:NO,_useKey:NO,init:function(a){arguments.callee.base.apply(this,arguments),typeof a=="string"&&(a=this.normalizeKey(a),this.addDependentKey(a),this._usesKey=YES),this.number=a},perform:function(b){var a;return this._usesKey?a=this.findProperty(this.number):a=this.number,this.isNegative?b-a:b+a}}),CW.LayoutRule.addOperator("plus",CW.LayoutRule.Add),CW.LayoutRule.addOperator("minus",CW.LayoutRule.Add,{isNegative:YES}),CW.LayoutRule.To=CW.LayoutRule.extend({init:function(a){arguments.callee.base.apply(this,arguments),typeof a=="string"&&(a=this.normalizeKey(a),this.addDependentKey(a),this._usesKey=YES),this.number=a},perform:function(b){var a;return this._usesKey?a=this.findProperty(this.number):a=this.number,a}}),CW.LayoutRule.addOperator("to",CW.LayoutRule.To);CW.INVALID_LAYOUT_QUALITY=-2;CW.BAD_LAYOUT_QUALITY=-1;CW.OKAY_LAYOUT_QUALITY=0;CW.GOOD_LAYOUT_QUALITY=1;CW.PERFECT_LAYOUT_QUALITY=2;CW.PickerLayout=SC.Object.extend({owner:null,renderDelegateName:"panelRenderDelegate",theme:null,themeBinding:SC.Binding.oneWay("*owner.theme"),controlSize:null,controlSizeBinding:SC.Binding.oneWay("*owner.controlSize"),renderDelegate:function(){var b=this.get("theme");if(b){return b[this.get("renderDelegateName")]}return null}.property("theme","renderDelegateName"),renderDelegateProxy:function(){return this}.property().cacheable(),pointAtRectangle:{left:0,top:0,width:0,height:0},pointAtRectangleBinding:SC.Binding.oneWay("*owner.pointAtRectangle"),pointAtPoint:function(){var b=this.get("pointAtRectangle");return{left:b.left+b.width/2,top:b.top+b.height/2}}.property("pointAtRectangle").cacheable(),availableSpace:{width:0,height:0},availableSpaceBinding:SC.Binding.oneWay("*owner.availableSpace"),desiredSize:{width:320,height:400},desiredSizeBinding:SC.Binding.oneWay("*owner.desiredSize"),minimumSize:{width:320,height:200},minimumSizeBinding:SC.Binding.oneWay("*owner.minimumSize"),layout:{top:0,left:0,width:100,height:100},layoutQuality:CW.INVALID_LAYOUT_QUALITY,layoutNeedsUpdate:NO,reasonsForRelayout:SC.CoreSet.create(),init:function(){arguments.callee.base.apply(this,arguments);this._reasonsForRelayout=SC.CoreSet.create()},scheduleRedraw:function(){if(!this.get("owner")){return}this.get("owner").pickerLayoutNeedsRedraw(this)},layoutDidChange:function(){var c=this.get("layout"),d=this._previousLayout||{};if(c.left!==d.left||c.top!==d.top||c.width!==d.width||c.height!==d.height){this.scheduleRedraw()}this._previousLayout=c}.observes("layout"),scheduleLayout:function(b){this.set("layoutNeedsUpdate",YES);if(!b){return}if(typeof b==="string"){b=[b]}this._reasonsForRelayout.addEach(b)},computeLayout:function(){this.set("reasonsForRelayout",this._reasonsForRelayout);this._reasonsForRelayout=SC.CoreSet.create();this.set("layoutNeedsUpdate",NO)},computeLayoutIfNeeded:function(){if(!this.get("layoutNeedsUpdate")){return}this.computeLayout()},_scpl_layoutNeedsUpdateDidChange:function(){if(!this.get("layoutNeedsUpdate")){return}var b=this.get("owner");if(!b){return}b.pickerLayoutNeedsUpdate(this)}.observes("layoutNeedsUpdate"),render:function(c){var d=this.get("renderDelegate");if(d){c.addClass(d.className);c.addClass(this.get("theme").classNames);d.render(this.get("renderDelegateProxy"),c)}},update:function(c){var d=this.get("renderDelegate");if(d){c.addClass(d.className);c.addClass(this.get("theme").classNames);d.update(this.get("renderDelegateProxy"),c)}},isBetterThanLayout:function(b){return this.get("layoutQuality")>b.get("layoutQuality")}});sc_require("system/picker_layout");CW.LEFT_SIDE="left";CW.RIGHT_SIDE="right";CW.TOP_SIDE="top";CW.BOTTOM_SIDE="bottom";CW.RELAYOUT_FOR_WINDOW="window";CW.RELAYOUT_FOR_TARGET="target";CW.RELAYOUT_FOR_DESIRED_SIZE="desired-size";CW.RELAYOUT_FOR_MINIMUM_SIZE="minimum-size";CW.PickerLayout.OnSide=CW.PickerLayout.extend({renderDelegateName:"cwPickerBackgroundRenderDelegate",pointAtSide:CW.RIGHT_SIDE,pointAtPoint:function(){var h=this.get("pointAtRectangle"),e=this.get("pointAtSide"),f,g;if(e===CW.RIGHT_SIDE||e===CW.LEFT_SIDE){g=Math.round(h.top+h.height/2);f=h.left;if(e===CW.RIGHT_SIDE){f+=h.width}}else{f=Math.round(h.left+h.width/2);g=h.top;if(e===CW.BOTTOM_SIDE){g+=h.height}}return{left:f,top:g}}.property("pointAtSide","pointAtRectangle"),distanceFromRectangle:SC.propertyFromRenderDelegate("pickerDistanceFromRectangle",10),distanceFromEdge:SC.propertyFromRenderDelegate("pickerDistanceFromEdge",15),pointerCanMove:SC.propertyFromRenderDelegate("pointerCanMove",YES),validPointerLayouts:SC.propertyFromRenderDelegate("validPointerLayouts",[]),pointerDistanceFromTop:function(){return this.get("pointAtPoint").top-this.get("layout").top}.property("layout").cacheable(),pointerDistanceFromBottom:function(){return this.get("layout").top+this.get("layout").height-this.get("pointAtPoint").top}.property("layout").cacheable(),pointerDistanceFromLeft:function(){return this.get("pointAtPoint").left-this.get("layout").left}.property("layout").cacheable(),pointerDistanceFromRight:function(){return this.get("layout").left+this.get("layout").width-this.get("pointAtPoint").left}.property("layout").cacheable(),pointerLayout:null,layoutPropertyDidChange:function(d,c){if(c==="availableSpace"){this.scheduleLayout(CW.RELAYOUT_FOR_WINDOW)}else{if(c==="pointAtPoint"){this.scheduleLayout(CW.RELAYOUT_FOR_TARGET)}else{if(c==="desiredSize"){this.scheduleLayout(CW.RELAYOUT_FOR_DESIRED_SIZE)}else{if(c==="minimumSize"){this.scheduleLayout(CW.RELAYOUT_FOR_MINIMUM_SIZE)}else{if(c==="validPointerLayouts"||c==="pointerCanMove"){this.scheduleLayout(CW.RELAYOUT_FOR_TARGET)}}}}}}.observes("availableSpace","pointAtPoint","desiredSize","minimumSize","validPointerLayouts","pointerCanMove"),pointerLayoutPropertyDidChange:function(){this.scheduleRedraw()}.observes("pointerDistanceFromLeft","pointerDistanceFromRight","pointerDistanceFromBottom","pointerDistanceFromTop"),t_pointAtPoint:function(){var c=this.get("pointAtPoint"),d=this.get("pointAtSide");if(d===CW.LEFT_SIDE||d===CW.RIGHT_SIDE){return c}else{return{left:c.top,top:c.left}}}.property("pointAtPoint","pointAtSide"),t_validPointerLayouts:function(){var n=this.get("validPointerLayouts"),o,h=n.length,j,l;var k=this.get("pointAtSide");var m=[];for(o=0;o<h;o++){j=n[o];if(j.top!=null||j.bottom!=null||j.minimumDistanceFromTop!=null||j.minimumDistanceFromBottom!=null||j.maximumDistanceFromTop!=null||j.maximumDistanceFromBottom!=null){if(k!==CW.LEFT_SIDE&&k!==CW.RIGHT_SIDE){continue}if(j.side&&j.side===k){continue}l={name:j.name};if(j.top!=null){l.maximumDistanceFromTop=l.minimumDistanceFromTop=j.top}else{if(j.bottom!=null){l.maximumDistanceFromBottom=l.minimumDistanceFromBottom=j.bottom}else{l.maximumDistanceFromTop=j.maximumDistanceFromTop;l.minimumDistanceFromTop=j.minimumDistanceFromTop;l.maximumDistanceFromBottom=j.maximumDistanceFromBottom;l.minimumDistanceFromBottom=j.minimumDistanceFromBottom}}l.original=j;m.push(l)}else{if(j.left!=null||j.right!=null||j.minimumDistanceFromLeft!=null||j.minimumDistanceFromRight!=null||j.maximumDistanceFromLeft!=null||j.maximumDistanceFromRight!=null){if(k!==CW.TOP_SIDE&&k!==CW.BOTTOM_SIDE){continue}if(j.side&&j.side===k){continue}l={name:j.name};if(j.left!=null){l.maximumDistanceFromTop=l.minimumDistanceFromTop=j.left}else{if(j.right!=null){l.maximumDistanceFromBottom=l.minimumDistanceFromBottom=j.right}else{l.maximumDistanceFromTop=j.maximumDistanceFromLeft;l.minimumDistanceFromTop=j.minimumDistanceFromLeft;l.maximumDistanceFromBottom=j.maximumDistanceFromRight;l.minimumDistanceFromBottom=j.minimumDistanceFromRight}}l.original=j;m.push(l)}}}return m}.property("validPointerLayouts","pointAtSide").cacheable(),t_pointerMinimumDistanceFromTop:function(){var b=this.get("pointAtSide");if(b===CW.LEFT_SIDE||b===CW.RIGHT_SIDE){return this.get("pointerMinimumDistanceFromTop")}else{return this.get("pointerMinimumDistanceFromLeft")}}.property("pointerMinimumDistanceFromTop","pointerMinimumDistanceFromLeft","pointAtSide").cacheable(),t_pointerMinimumDistanceFromBottom:function(){var b=this.get("pointAtSide");if(b===CW.LEFT_SIDE||b===CW.RIGHT_SIDE){return this.get("pointerMinimumDistanceFromBottom")}else{return this.get("pointerMinimumDistanceFromRight")}}.property("pointerMinimumDistanceFromBottom","pointerMinimumDistanceFromRight","pointAtSide"),t_availableSpace:function(){var c=this.get("availableSpace"),d=this.get("pointAtSide");if(d===CW.LEFT_SIDE||d===CW.RIGHT_SIDE){return c}else{return{width:c.height,height:c.width}}}.property("availableSpace","pointAtSide").cacheable(),t_desiredSize:function(){var d=this.get("desiredSize"),c=this.get("pointAtSide");if(c===CW.LEFT_SIDE||c===CW.RIGHT_SIDE){return d}else{return{width:d.height,height:d.width}}}.property("desiredSize","pointAtSide").cacheable(),t_minimumSize:function(){var c=this.get("minimumSize"),d=this.get("pointAtSide");if(d===CW.LEFT_SIDE||d===CW.RIGHT_SIDE){return c}else{return{width:c.height,height:c.width}}}.property("minimumSize","pointAtSide").cacheable(),t_pointAtSide:function(){var b=this.get("pointAtSide");if(b===CW.TOP_SIDE){return CW.LEFT_SIDE}else{if(b===CW.BOTTOM_SIDE){return CW.RIGHT_SIDE}}return b}.property("pointAtSide").cacheable(),computeLayout:function(){this.centerPicker();this.repositionToFit();this.repositionForPointer();this.resizeToFit();this.resizeForPointer();this.resizeSecondaryDimension();this.applyMinimumSize();this.repositionToFit();this.repositionForPointer();this.gradeLayout();var e=this.get("pointAtSide"),d=this.get("t_layout"),f=d.pointerLayout;delete d.pointerLayout;if(e===CW.TOP_SIDE||e===CW.BOTTOM_SIDE){d={left:d.top,top:d.left,width:d.height,height:d.width}}this.set("layout",d);this.set("pointerLayout",f);arguments.callee.base.apply(this,arguments)},centerPicker:function(){var e=this.get("t_pointAtPoint"),f=this.get("t_desiredSize"),g=this.get("distanceFromRectangle"),h={left:e.left,top:Math.round(e.top-f.height/2),width:f.width,height:f.height};if(this.get("t_pointAtSide")===CW.RIGHT_SIDE){h.left+=g}else{h.left=h.left-g-f.width}this.set("t_layout",h)},repositionToFit:function(){if(!this.get("pointerCanMove")){return}var g=this.get("t_layout"),j=this.get("distanceFromEdge"),k=this.get("t_availableSpace"),h=j,f=k.height-j;if(g.top+g.height>f){g.top=f-g.height}if(g.top<h){g.top=h}},repositionForPointer:function(){var C=this.get("t_layout"),s=this.get("t_pointAtPoint").top,q=this.get("t_validPointerLayouts"),B=q.length,w,E,z,u,x=null,D,y;z=null;for(w=0;w<B;w++){E=q[w];D=C.top;var G=E.minimumDistanceFromTop,v=E.maximumDistanceFromTop,t=E.minimumDistanceFromBottom,F=E.maximumDistanceFromBottom;if(G!=null&&D>s-G){D=s-G}if(v!=null&&D<s-v){D=s-v}if(t!=null&&D+C.height<s+t){D=s+t-C.height}if(F!=null&&D+C.height>s+F){D=s+F-C.height}y=Math.abs(D-C.top);if(z==null||y<u){z=D;u=y;x=E.original}}C.pointerLayout=x;if(z!=null){C.top=z}},resizeToFit:function(){if(!this.get("pointerCanMove")){return}var e=this.get("t_layout"),f=this.get("t_availableSpace"),d=f.height-this.get("distanceFromEdge");if(e.top+e.height>d){e.height=d-e.top}},resizeForPointer:function(){var C=this.get("t_layout"),s=this.get("t_pointAtPoint").top,q=this.get("t_validPointerLayouts"),B=q.length,w,D,E,u,x=null,y,z;E=null;for(w=0;w<B;w++){D=q[w];y=C.height;var G=D.minimumDistanceFromTop,v=D.maximumDistanceFromTop,t=D.minimumDistanceFromBottom,F=D.maximumDistanceFromBottom;if(t!=null&&C.top+y<s+t){y=s+t-C.top}if(F!=null&&C.top+y>s+F){y=s+F-C.top}z=Math.abs(y-C.height);if(E==null||z<u){E=y;u=z;x=D.original}}C.pointerLayout=x;if(E!=null){C.height=E}},resizeSecondaryDimension:function(){var m=this.get("t_layout"),k=this.get("t_availableSpace"),l=this.get("distanceFromEdge"),h=l,n=k.width-l,j=this.get("t_pointAtSide");if(j===CW.RIGHT_SIDE){if(m.left+m.width>n){m.width=n-m.left}}else{if(m.left<h){var o=m.left+m.width;m.left=h;m.width=o-h}}},applyMinimumSize:function(){var c=this.get("t_layout"),d=this.get("t_minimumSize");if(c.width<d.width){c.width=d.width}if(c.height<d.height){c.height=d.height}},gradeLayout:function(){var t=CW.PERFECT_LAYOUT_QUALITY;var u=this.get("t_layout"),s=this.get("t_pointAtSide"),p=this.get("t_availableSpace"),v=this.get("distanceFromEdge"),w=this.get("distanceFromRectangle"),o=this.get("t_desiredSize"),x=this.get("t_pointAtPoint").left,m=this.get("t_pointAtPoint").top,q=this.get("t_pointerMinimumDistanceFromTop"),n=this.get("t_pointerMinimumDistanceFromBottom");if(u.top>m-q){t=CW.INVALID_LAYOUT_QUALITY}else{if(u.top+u.height<m-n){t=CW.INVALID_LAYOUT_QUALITY}else{if(s===CW.LEFT_SIDE&&u.left+u.width+w!==x){t=CW.INVALID_LAYOUT_QUALITY}else{if(s===CW.RIGHT_SIDE&&u.left-w!==x){t=CW.INVALID_LAYOUT_QUALITY}else{if(u.top<0||u.left<0){t=CW.BAD_LAYOUT_QUALITY}else{if(u.top+u.height>p.height||u.left+u.width>p.width){t=CW.BAD_LAYOUT_QUALITY}else{if(u.top<v||u.left<v){t=CW.OKAY_LAYOUT_QUALITY}else{if(u.top+u.height>p.height-v||u.left+u.width>p.width-v){t=CW.OKAY_LAYOUT_QUALITY}else{if(u.height<o.height||u.width<o.width){t=CW.GOOD_LAYOUT_QUALITY}}}}}}}}}this.set("layoutQuality",t)},isBetterThanLayout:function(l){var k=this.get("layoutQuality"),m=l.get("layoutQuality");if(k>m){return YES}else{if(k<m){return NO}else{var j=this.get("layout"),g=l.get("layout"),h=this.get("desiredSize");if(h.width-j.width<h.width-g.width){return YES}if(h.height-j.height<h.height-g.height){return YES}return NO}}}});sc_require("picker_layouts/layout_side");CW.PickerLayout.ON_LEFT=CW.PickerLayout.OnSide.extend({pointAtSide:CW.LEFT_SIDE});CW.PickerLayout.ON_RIGHT=CW.PickerLayout.OnSide.extend({pointAtSide:CW.RIGHT_SIDE});CW.PickerLayout.ON_BOTTOM=CW.PickerLayout.OnSide.extend({pointAtSide:CW.BOTTOM_SIDE});CW.PickerLayout.ON_TOP=CW.PickerLayout.OnSide.extend({pointAtSide:CW.TOP_SIDE});sc_require("picker_layouts/layout_side");sc_require("picker_layouts/layout_builtin_sides");CW.PickerPane=SC.PanelPane.extend({classNames:"sc-picker".w(),layouts:"onRight onBottom onLeft onTop".w(),onRight:CW.PickerLayout.ON_RIGHT,onLeft:CW.PickerLayout.ON_LEFT,onTop:CW.PickerLayout.ON_TOP,onBottom:CW.PickerLayout.ON_BOTTOM,shouldLayoutAutomatically:YES,shouldDismissAutomatically:YES,shouldBeStable:NO,dismissAction:null,dismissTarget:null,desiredSize:{width:320,height:400},minimumSize:function(d,c){if(c){this._scpp_setMinimumSize=c}if(this._scpp_setMinimumSize){return this._scpp_setMinimumSize}return this.get("desiredSize")}.property("desiredSize").cacheable(),currentLayout:undefined,pointAtRectangle:{left:0,top:0,width:0,height:0},pointAtView:null,pointAtViewFrame:null,pointAtViewFrameBinding:"*pointAtView.frame",pointAtRectangleForView:function(f){var e=this.get("parentView")||null,h=f.get("parentView"),g=f.get("frame");if(h){return h.convertFrameToView(g,e)}return undefined},_scpv_pointAtViewFrameDidChange:function(){this.recomputePointAtRectangle()}.observes("pointAtViewFrame"),recomputePointAtRectangle:function(){var d=this.get("pointAtView"),c;if(d&&(c=this.pointAtRectangleForView(this.get("pointAtView")))){if(c.left===undefined){c.left=c.x}if(c.top===undefined){c.top=c.y}this.set("pointAtRectangle",c)}},renderDelegateName:"cwPickerRenderDelegate",init:function(){arguments.callee.base.apply(this,arguments);this.set("desiredSize",SC.clone(this.desiredSize));this.createLayouts()},popup:function(d,c){this.recomputePointAtRectangle();if(c){this.set("layouts",c);this.createLayouts()}if(d){if(d.isView){this.set("pointAtView",d)}else{if(d.left!==undefined&&d.top!==undefined&&d.width!==undefined&&d.height!==undefined){this.set("pointAtView",null);this.set("pointAtRectangle",d)}else{if(d.nodeType){}else{throw"Invalid argument supplied to SC.PickerPane#popup: "+d.toString()}}}}this.windowDidResize();this.append()},dismiss:function(){var d=this.get("dismissAction"),f=this.get("dismissTarget")||null,e=this.get("rootResponder");if(d){e.sendAction(d,f,this,this,null,this)}if(this.get("shouldDismissAutomatically")){this.remove()}},adjustDesiredSize:function(d,f){var e=this.get("desiredSize");e={width:e.width,height:e.height};if(typeof d==="object"){SC.mixin(e,d)}else{e[d]=f}this.set("desiredSize",e)},adjustMinimumSize:function(e,f){var d=this.get("minimumSize");d={width:d.width,height:d.height};if(typeof e==="object"){SC.mixin(d,e)}else{d[e]=f}this.set("minimumSize",d)},createLayouts:function(){var j=this.get("layouts"),m=[],k,g,h=j.length,l;for(g=0;g<h;g++){k=j[g];l=undefined;if(typeof k==="string"){l=k;k=this[k]}if(k.isClass){k=k.create({owner:this})}else{k.set("owner",this)}m.push(k);if(l){this.set(l,k)}}this.set("layouts",m);this.computeLayoutIfNeeded()},_cwpp_layoutsDidChange:function(){var b=this.get("layouts");if(b.indexOf(this.get("currentLayout"))<0){this.set("currentLayout",undefined)}}.observes("layouts"),computeLayout:function(){var h=this.get("layouts"),f,g=h.length,k;for(f=0;f<g;f++){k=h[f];k.computeLayoutIfNeeded()}var j=this.pickBestLayout();this.set("currentLayout",j);this.applyLayout(j);this.set("layoutNeedsUpdate",NO)},applyLayout:function(c){var d;if(c){d=c.get("layout")}else{d={left:0,top:0,width:100,height:100}}this.set("layout",d)},pickBestLayout:function(){var h=this.get("layouts"),f,g=h.length,j,k=this.get("shouldBeStable")?this.get("currentLayout"):undefined;for(f=0;f<g;f++){j=h[f];if(!k||j.isBetterThanLayout(k)){k=j}}return k},computeLayoutIfNeeded:function(){if(!this.get("shouldLayoutAutomatically")){return}if(!this.get("layoutNeedsUpdate")){return}this.computeLayout()},pickerLayoutNeedsUpdate:function(){this.set("layoutNeedsUpdate",YES);this.invokeOnce("computeLayoutIfNeeded")},parentViewDidResize:function(){this.notifyPropertyChange("availableSpace")},windowDidResize:function(){this.notifyPropertyChange("availableSpace")},parentDidChange:function(){arguments.callee.base.apply(this,arguments);this.notifyPropertyChange("availableSpace")},availableSpace:function(){if(this.get("parentView")){var c=this.getPath("parentView.frame");return{width:c.width,height:c.height}}else{var d=SC.RootResponder.responder.get("currentWindowSize");return{width:d.width,height:d.height}}}.property().cacheable(),modalPaneDidClick:function(d){var c=this.get("frame");if(this.get("parentView")){c=this.get("parentView").convertFrameToView(c,null)}if(d.pageX>=c.x&&d.pageY>=c.y&&d.pageX<=c.x+c.width&&d.pageY<=c.y+c.height){return NO}this.dismiss();return YES},click:function(b){return this.modalPaneDidClick(b)},displayProperties:"currentLayout".w(),pickerLayoutNeedsRedraw:function(b){if(b!==this.get("currentLayout")){return}this.displayDidChange()},render:function(c){c=c.begin("div").addClass("_scpv_background");var d=this.get("currentLayout");if(d){d.render(c)}this._scpp_lastRenderedLayout=d;c=c.end();if(this.get("renderDelegate")){this.get("renderDelegate").render(this.get("renderDelegateProxy"),c)}},update:function(g){bg=g.find("._scpv_background");var h=bg[0];if(!h){return}var f=this.get("currentLayout");if(!f){return}bg.resetClassNames().addClass("_scpv_background");if(this._scpp_lastRenderedLayout!==f){var e=SC.RenderContext(h);f.render(e);e.update();this._scpp_lastRenderedLayout=f}else{f.update(bg)}if(this.get("renderDelegate")){this.get("renderDelegate").update(this.get("renderDelegateProxy"),g)}}});sc_require("system/picker_layout");sc_require("panes/picker");CW.MenuPane=CW.PickerPane.extend({desiredSize:{width:100,height:100},minimumSize:{width:100,height:0},classNames:["cw-menu"],modalPane:SC.ModalPane,ariaRole:"menu",items:[],controlSize:SC.REGULAR_CONTROL_SIZE,minimumCroppedMenuHeight:SC.propertyFromRenderDelegate("minimumCroppedHeight"),itemHeight:SC.propertyFromRenderDelegate("itemHeight",20),itemSeparatorHeight:SC.propertyFromRenderDelegate("itemSeparatorHeight",9),menuHeight:0,menuHeightPadding:SC.propertyFromRenderDelegate("menuHeightPadding",6),submenuOffsetX:SC.propertyFromRenderDelegate("submenuOffsetX",2),selectedItem:null,exampleView:SC.MenuItemView,anchor:null,isSubMenu:NO,localize:YES,acceptsMenuPane:YES,isContextMenuEnabled:NO,layouts:[CW.PickerLayout.ON_BOTTOM,CW.PickerLayout.ON_TOP],popup:function(f,d){this.beginPropertyChanges();this.adjustDesiredSize("height",this.get("menuHeight"));var e=Math.min(this.get("menuHeight"),this.get("minimumCroppedMenuHeight"));this.adjustMinimumSize("height",e);arguments.callee.base.apply(this,arguments);this.set("defaultResponder",this);this.endPropertyChanges()},remove:function(){var b=this.get("parentMenu");this.set("currentMenuItem",null);this.closeOpenMenus();this.resignMenuPane();if(b){b.becomeMenuPane()}return arguments.callee.base.apply(this,arguments)},itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemValueKey:"value",itemIconKey:"icon",itemHeightKey:"height",itemSubMenuKey:"subMenu",itemSeparatorKey:"separator",itemTargetKey:"target",itemActionKey:"action",itemCheckboxKey:"checkbox",itemShortCutKey:"shortcut",itemKeyEquivalentKey:"keyEquivalent",itemDisableMenuFlashKey:"disableMenuFlash",itemLayerIdKey:"layerId",itemExampleViewKey:"exampleView",menuItemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemSeparatorKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemHeightKey","itemSubMenuKey","itemKeyEquivalentKey","itemTargetKey","itemLayerIdKey"],isModal:YES,_menuView:null,init:function(){return arguments.callee.base.apply(this,arguments)},displayProperties:["controlSize"],renderStyle:"menu",renderDelegateName:"cwMenuRenderDelegate",createChildViews:function(){var d,e,f;d=this.createChildView(SC.MenuScrollView,{borderStyle:SC.BORDER_NONE,controlSize:this.get("controlSize")});e=this._menuView=SC.View.create({parentViewDidResize:function(){this.notifyPropertyChange("frame")},viewDidResize:function(){}});f=this.get("menuItemViews");e.set("layout",{top:0,left:0,height:this.get("menuHeight")});e.replaceAllChildren(f);d.set("contentView",e);this.childViews=[d];return this},paneDidAttach:function(){var b=(this.rootResponder=SC.RootResponder.responder);b.panes.add(this);this.set("currentWindowSize",b.computeWindowSize());this.set("isPaneAttached",YES);this.parentViewDidChange();this._notifyDidAppendToDocument();this.becomeMenuPane();return this},becomeMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(this)}return this},resignMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(null)}return this},menuItemViews:function(){return this.createMenuItemViews()}.property("displayItems","controlSize").cacheable(),createMenuItemViews:function(){var M=[],E=this.get("displayItems"),U=this.get("exampleView"),B,R,J,F,H,O,T,L,D,S,P,I,K,Q,N,G,y,z,C;if(!E){return M}H=this.get("itemHeightKey");O=this.get("itemSeparatorKey");K=this.get("itemExampleViewKey");T=this.get("itemHeight");P=this.get("itemKeyEquivalentKey");L=this.get("itemSeparatorHeight");y=this.get("itemLayerIdKey");S=Math.floor(this.get("menuHeightPadding")/2);D=S,largestItemHeight=0;N=this.menuItemKeys.map(CW._menu_fetchKeys,this);C=E.get("length");for(G=0;G<C;G++){B=E[G];F=B.get(H);if(!F){F=B.get(O)?L:T}z={layout:{height:F,top:D},contentDisplayProperties:N,content:B,parentMenu:this};if(B.get(y)){z.layerId=B.get(y)}Q=B.get(K);if(Q){R=Q}else{R=U}J=this._menuView.createChildView(R,z);M[G]=J;D+=F;largestItemHeight=Math.max(largestItemHeight,F);I=B.get(P);if(I){if(SC.typeOf(I)===SC.T_ARRAY){I.forEach(function(a){this._keyEquivalents[a]=J},this)}else{this._keyEquivalents[I]=J}}}this.set("menuHeight",D+S);this.set("largestItemHeight",largestItemHeight);return M},menuItemViewForContentIndex:function(d){var c=this.get("menuItemViews");if(!c){return undefined}return c.objectAt(d)},_keyEquivalents:{},rootMenu:function(){if(this.get("isSubMenu")){return this.getPath("parentMenu.rootMenu")}return this}.property("isSubMenu").cacheable(),windowSizeDidChange:function(c,d){this.remove();return arguments.callee.base.apply(this,arguments)},displayItems:function(){var p=this.get("items"),q=this.get("localize"),l=this.get("itemHeight"),j,o=[],k,n,m;if(!p){return null}j=p.get("length");for(k=0;k<j;k++){n=p.objectAt(k);if(!n){continue}m=SC.typeOf(n);if(m===SC.T_STRING){n=SC.Object.create({title:n,value:n,isEnabled:YES})}else{if(m===SC.T_HASH){n=SC.Object.create(n)}else{if(m===SC.T_ARRAY){n=this.convertArrayMenuItemToObject(n)}}}n.contentIndex=k;o.push(n)}return o}.property("items").cacheable(),_sc_menu_itemsDidChange:function(){var b=this.get("menuItemViews");this._menuView.replaceAllChildren(b);this._menuView.adjust("height",this.get("menuHeight"))}.observes("menuItemViews"),convertArrayMenuItemToObject:function(n){SC.Logger.warn("Support for Array-based menu items has been deprecated.  Please update your menus to use a hash.");var o,q=CW._menu_fetchKeys,j=CW._menu_fetchItem,l,p=SC.Object.create(),k,m;o=this.menuItemKeys.map(q,this);p[o[0]]=n[0];p[o[1]]=n[1];p[o[2]]=n[2];p[o[3]]=n[3];p[o[4]]=n[4];p[o[5]]=n[5];p[o[6]]=n[6];p[o[7]]=n[7];p[o[8]]=n[8];p[o[9]]=n[9];p[o[10]]=n[10];p[o[11]]=n[11];p[o[12]]=n[12];return p},currentMenuItem:function(d,c){if(c!==undefined){if(this._currentMenuItem!==null){this.set("previousMenuItem",this._currentMenuItem)}this._currentMenuItem=c;this.setPath("rootMenu.targetMenuItem",c);return c}return this._currentMenuItem}.property().cacheable(),_sc_menu_currentMenuItemDidChange:function(){var d=this.get("currentMenuItem"),c=this.get("previousMenuItem");if(c){if(c.get("hasSubMenu")&&d===null){}else{c.resignFirstResponder();this.closeOpenMenusFor(c)}}if(d&&d.get("isEnabled")){d.scrollToVisible()}}.observes("currentMenuItem"),closeOpenMenusFor:function(d){if(!d){return}var c=d.get("parentMenu");while(c&&d){c=d.get("subMenu");if(c){c.remove();d.resignFirstResponder();d=c.get("previousMenuItem")}}},closeOpenMenus:function(){this.closeOpenMenusFor(this.get("previousMenuItem"))},mouseDown:function(b){this.modalPaneDidClick(b);return YES},mouseEntered:function(b){this.set("mouseHasEntered",YES)},keyUp:function(d){var c=this.interpretKeyEvents(d);return !c?NO:c},moveUp:function(){var k=this.get("currentMenuItem"),j=this.get("menuItemViews"),f,h,g;if(!k){g=j.get("length")-1}else{f=k.getPath("content.contentIndex");if(f===0){return YES}g=f-1}while(g>=0){if(j[g].get("isEnabled")){this.set("currentMenuItem",j[g]);j[g].becomeFirstResponder();break}g--}return YES},moveDown:function(){var l=this.get("currentMenuItem"),k=this.get("menuItemViews"),g=k.get("length"),m,j,h;if(!l){h=0}else{m=l.getPath("content.contentIndex");if(m===g){return YES}h=m+1}while(h<g){if(k[h].get("isEnabled")){this.set("currentMenuItem",k[h]);k[h].becomeFirstResponder();break}h++}return YES},insertText:function(e,f){var g=this._timer,h=this._keyBuffer;if(g){g.invalidate()}g=this._timer=SC.Timer.schedule({target:this,action:"clearKeyBuffer",interval:500,isPooled:NO});h=h||"";h+=e.toUpperCase();this.selectMenuItemForString(h);this._keyBuffer=h;return YES},performKeyEquivalent:function(g,f,e){if(!e&&!this.get("isVisibleInWindow")){return NO}var h=this._keyEquivalents[g];if(h){h.performAction(YES);return YES}if(g==="escape"||g==="return"){this.remove();return YES}return NO},selectMenuItemForString:function(o){var n=this.get("menuItemViews"),l,k,h,j,m;if(!n){return}m=o.length;j=n.get("length");for(h=0;h<j;h++){l=n.objectAt(h);k=l.get("title");if(!k){continue}k=k.replace(/ /g,"").substr(0,m).toUpperCase();if(k===o){this.set("currentMenuItem",l);l.becomeFirstResponder();break}}},clearKeyBuffer:function(){this._keyBuffer=""},modalPaneDidClick:function(b){this.remove();return YES}});CW._menu_fetchKeys=function(b){return this.get(b)};CW._menu_fetchItem=function(b){if(!b){return null}return this.get?this.get(b):this[b]};CW.AutoResizingMenuItemView=SC.MenuItemView.extend(SC.AutoResize,{supportsAutoResize:YES,shouldAutoResize:NO,shouldMeasureSize:NO,autoResizePadding:0,autoResizeText:function(){return this.get("title")}.property("title"),autoResizeLayer:function(){return this.$(".value")[0]}.property("layer").cacheable(),batchResizeId:function(){return"menu-"+SC.guidFor(this.parentMenu)}.property().cacheable(),didUpdateLayer:function(){this.notifyPropertyChange("autoResizeLayer");this.scheduleMeasurement()}});sc_require("panes/menu");sc_require("views/auto_resizing_menu_item");CW.AutoResizingMenuPane=CW.MenuPane.extend({shouldAutoResize:YES,exampleView:CW.AutoResizingMenuItemView,minimumMenuWidth:SC.propertyFromRenderDelegate("minimumMenuWidth",0),menuWidthPadding:SC.propertyFromRenderDelegate("menuWidthPadding",0),init:function(){arguments.callee.base.apply(this,arguments);if(this.get("shouldAutoResize")){this.invokeOnce("_updateMenuWidth")}},createMenuItemViews:function(){var g=arguments.callee.base.apply(this,arguments);var e,f=g.length,h;if(this.get("shouldAutoResize")){for(e=0;e<f;e++){h=g[e];h.set("shouldMeasureSize",YES);h.addObserver("measuredSize",this,this._menuItemMeasuredSizeDidChange)}}return g},_menuItemViewsDidChange:function(){if(this.get("shouldAutoResize")){this.invokeOnce("_updateMenuWidth")}}.observes("menuItemViews"),_menuItemMeasuredSizeDidChange:function(b){this.invokeOnce("_updateMenuWidth")},_menuMinimumMenuWidthDidChange:function(){this.invokeOnce("_updateMenuWidth")}.observes("minimumMenuWidth"),_updateMenuWidth:function(){var h=this.get("menuItemViews");if(!h){return}var f=h.length,g,k,j=this.get("minimumMenuWidth");for(g=0;g<f;g++){k=h[g];j=Math.max(j,k.get("measuredSize").width+this.get("menuWidthPadding"))}this.adjustDesiredSize("width",j)}});sc_require("panes/picker");CW.CalloutPicker=CW.PickerPane.extend(CW.Animatability,CW.PaneFadingSupport,{desiredSize:{width:215,height:43},minimumSize:{width:150,height:43},renderStyle:"iOS.callout",layouts:[CW.PickerLayout.ON_TOP],titleValue:"Callout title",detailValue:"Callout detail",escapeTitle:YES,escapeDetail:YES,target:"",action:"",preferType:SC.PICKER_POINTER,acceptsKeyPane:NO,acceptsFirstResponder:NO,isModal:NO,repositionOnWindowResize:NO,contentView:SC.View.extend({childViews:["title","detail","button"],title:SC.LabelView.extend({layout:{top:0,height:25,left:9,right:35},classNames:"title",escapeHTMLBinding:"*parentView.parentView.escapeTitle",valueBinding:"*parentView.parentView.titleValue"}),detail:SC.LabelView.extend({layout:{top:24,left:9,height:15},classNames:"detail",escapeHTMLBinding:"*parentView.parentView.escapeDetail",valueBinding:"*parentView.parentView.detailValue"}),button:SC.ImageButtonView.extend({layout:{top:7,height:30,right:5,width:30},image:"info_button",targetBinding:"*parentView.parentView.target",actionBinding:"*parentView.parentView.action"})}),didCreateLayer:function(){this.invokeLater(this.recomputeDesiredSize,0)},recomputeDesiredSize:function(){var k=this.$(".title")[0],g=this.$(".detail")[0];if(SC.none(k)||SC.none(g)){return}var h=SC.metricsForString(this.get("titleValue"),k,null,NO),f=SC.metricsForString(this.get("detailValue"),g,null,NO),j=(h.width>f.width?h.width:f.width)+55;j=(j%2?j-1:j);this.adjustDesiredSize({width:Math.max(this.get("minimumSize").width,j)})},showCalloutInContainer:function(b){this._hideOverflow();this.appendTo(b)},valuesObserver:function(){this.recomputeDesiredSize()}.observes("detailValue","titleValue","layer"),modalPaneDidClick:function(){return NO}});CW.ErrorCalloutPicker=CW.PickerPane.extend({themeName:"errorCallout",renderStyle:"errorCallout",desiredSize:function(){return{width:this.get("errorWidth"),height:27}}.property("errorWidth").cacheable(),minimumSize:{width:120,height:27},errorText:"Please fill in required info",errorWidth:120,layouts:["onTop","onBottom"],acceptsFirstResponder:NO,acceptsKeyPane:NO,isModal:NO,contentView:SC.LabelView.extend({classNames:["error-picker-label"],valueBinding:".parentView.errorText"})});SC.BaseTheme.cwPickerRenderDelegate=SC.RenderDelegate.create({className:"cw-picker",render:function(c,d){d=d.begin("div").addClass("cw-picker-highlight");this.includeSlices(c,d,SC.THREE_SLICE);d.end()},update:function(){}});sc_require("render_delegates/picker");SC.BaseTheme.cwMenuRenderDelegate=SC.BaseTheme.cwPickerRenderDelegate.create({className:"cw-menu",render:function(c,d){this.addSizeClassName(c,d)},update:function(c,d){this.updateSizeClassName(c,d)},minimumCroppedHeight:200,itemHeight:22,itemSeparatorHeight:9,menuHeightPadding:0,menuWidthPadding:50,minimumMenuWidth:50,submenuOffsetX:2,verticalOffset:23,"sc-tiny-size":{itemHeight:10,itemSeparatorHeight:2,menuHeightPadding:0,submenuOffsetX:0},"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:0,submenuOffsetX:2},"sc-large-size":{itemHeight:31,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4},"sc-huge-size":{itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:0,submenuOffsetX:0}});sc_require("render_delegates/menu");SC.BaseTheme.cwSelectMenuRenderDelegate=SC.BaseTheme.cwMenuRenderDelegate.create({menuLeftOffset:-15,menuTopOffset:0,menuMinimumWidthOffset:16,"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:0,submenuOffsetX:2,menuLeftOffset:-16},"sc-large-size":{itemHeight:31,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4,menuTopOffset:-2}});sc_require("system/picker_layout");CW.SelectMenuLayout={Aligned:CW.PickerLayout.extend({renderDelegateName:"cwPickerBackgroundRenderDelegate",distanceFromEdge:SC.propertyFromRenderDelegate("distanceFromEdge",15),desiredPosition:{left:0,top:0},desiredPositionBinding:SC.Binding.oneWay("*owner.desiredPosition"),layoutPropertyDidChange:function(d,c){if(c==="availableSpace"){this.scheduleLayout(CW.RELAYOUT_FOR_WINDOW)}else{if(c==="pointAtPoint"){this.scheduleLayout(CW.RELAYOUT_FOR_TARGET)}else{if(c==="desiredSize"){this.scheduleLayout(CW.RELAYOUT_FOR_DESIRED_SIZE)}else{if(c==="minimumSize"){this.scheduleLayout(CW.RELAYOUT_FOR_MINIMUM_SIZE)}}}}}.observes("availableSpace","desiredSize","minimumSize","desiredPosition"),computeLayout:function(){var m=this.get("desiredPosition"),h=this.get("desiredSize"),g=this.get("minimumSize"),j=this.get("availableSpace"),k=this.get("distanceFromEdge"),l={top:m.top,left:m.left,width:h.width,height:h.height};if(l.top<k){l.height=l.height-(k-l.top);l.top=k}if(l.top+l.height>j.height-k){l.height=j.height-k-l.top}if(l.height<g.height){l.height=g.height}if(l.top+l.height>j.height-k){l.top=j.height-k-l.height}if(l.left<k){l.left=k}if(l.left+l.width>j.width-k){l.left=j.width-k-l.width}if(l.left<k){l.left=k;l.width=j.width-l.left-k}this.set("layout",l);arguments.callee.base.apply(this,arguments)}})};sc_require("render_delegates/select_menu");sc_require("picker_layouts/layout_select_menu");sc_require("panes/auto_resizing_menu");sc_require("views/auto_resizing_menu_item");CW.SelectViewMenuPane=CW.AutoResizingMenuPane.extend({desiredPosition:{top:20,left:20},layouts:[CW.SelectMenuLayout.Aligned],selectView:null,value:null,valueBinding:".selectView.value",renderDelegateName:"cwSelectMenuRenderDelegate",renderStyle:"menu.cw-no-pointers",theme:"menu.cw-no-pointers",shouldDropDown:SC.propertyFromRenderDelegate("shouldDropDown",NO),valueDidChange:function(){var h=this.get("menuItemViews"),e,f=h.length,g;for(e=0;e<f;e++){g=h[e];if(g._lastIsChecked){g.notifyPropertyChange("isChecked")}if(g.get("isChecked")){g.notifyPropertyChange("isChecked")}}}.observes("value"),_svm_selectedMenuItemView:function(){var h=this.get("menuItemViews"),g=this.get("value"),e,f;if(!h){return undefined}f=h.length;for(e=0;e<f;e++){if(g===h[e].get("content").get(this.get("itemValueKey"))){return h[e]}}return undefined}.property("value","menuItemViews").cacheable(),exampleView:CW.AutoResizingMenuItemView.extend({isChecked:function(){this._lastIsChecked=this.getContentProperty("itemValueKey")===this.getPath("parentMenu.rootMenu.value");return this._lastIsChecked}.property(),displayProperties:["isChecked"]}),desiredPosition:function(){var b=this.get("pointAtRectangle");if(this.get("shouldDropDown")){return{left:b.left+this.get("menuLeftOffset"),top:b.top+b.height+this.get("menuTopOffset")}}else{return{left:b.left+this.get("menuLeftOffset"),top:b.top-this._svm_positionForValue(this.get("value"))+this.get("menuTopOffset")}}}.property("pointAtRectangle","value","menuItemViews","isDropDown"),_svm_positionForValue:function(c){var d=this.get("_svm_selectedMenuItemView");if(!d){return 0}return d.get("layout").top},menuLeftOffset:SC.propertyFromRenderDelegate("menuLeftOffset",0),menuTopOffset:SC.propertyFromRenderDelegate("menuTopOffset",0),menuMinimumWidthOffset:SC.propertyFromRenderDelegate("menuMinimumWidthOffset",0),minimumMenuWidth:function(){var b=this.get("pointAtRectangle");return b.width+this.get("menuMinimumWidthOffset")}.property("pointAtRectangle","menuMinimumWidthOffset").cacheable(),applyLayout:function(){arguments.callee.base.apply(this,arguments);var b=this.get("_svm_selectedMenuItemView");if(b){b.scrollToVisible()}},_svm_theme:null,_svm_themeBinding:"*selectView.theme",baseTheme:function(){return this.get("_svm_theme")||arguments.callee.base.apply(this,arguments)}.property("_svm_theme").cacheable(),_svm_bindToProperties:["items","itemTitleKey","itemIsEnabledKey","itemValueKey","itemIconKey","itemHeightKey","itemSubMenuKey","itemSeparatorKey","itemTargetKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemKeyEquivalentKey","itemDisableMenuFlashKey","controlSize"],_svm_setupBindings:function(){var k=this.get("selectView");if(!k){return}var h=this._svm_bindToProperties,f,g=h.length,j;for(f=0;f<g;f++){j=h[f];this[j+"Binding"]=this.bind(j,k,j)}this._svm_isBoundTo=k},_svm_clearBindings:function(){var h=this._svm_isBoundTo;if(!h){return}var j=this._svm_bindToProperties,f,g=j.length,k;for(f=0;f<g;f++){k=j[f];this[k+"Binding"].disconnect()}},_svm_selectViewDidChange:function(){this._svm_clearBindings();this._svm_setupBindings()}.observes("selectView"),initMixin:function(){this._svm_setupBindings()},destroyMixin:function(){this._svm_clearBindings()}});SC.BaseTheme.cwPickerBackgroundRenderDelegate=SC.RenderDelegate.create({className:"cw-picker-background",pickerDistanceFromRectangle:16,validPointerLayouts:[{name:"left-or-right-position",classNames:"calculated-pointer",minimumDistanceFromTop:60,minimumDistanceFromBottom:60,needsGap:YES},{name:"top-or-bottom-position",classNames:"calculated-pointer",minimumDistanceFromLeft:60,minimumDistanceFromRight:60,needsGap:YES},{classNames:"bottom-left-corner-pointer corner-pointer".w(),name:"point-left-on-bottom",bottom:20,needsGap:NO,side:CW.LEFT_SIDE},{classNames:"top-left-corner-pointer corner-pointer".w(),name:"point-left-on-top",top:20,needsGap:NO,side:CW.LEFT_SIDE},{classNames:"top-left-corner-pointer corner-pointer".w(),name:"point-up-on-left",left:20,needsGap:NO,side:CW.TOP_SIDE},{classNames:"top-right-corner-pointer corner-pointer".w(),name:"point-up-on-right",right:20,needsGap:NO,side:CW.TOP_SIDE},{classNames:"bottom-left-corner-pointer corner-pointer".w(),name:"point-down-on-left",left:20,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"bottom-right-corner-pointer corner-pointer".w(),name:"point-down-on-right",right:20,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"bottom-right-corner-pointer corner-pointer".w(),name:"point-right-on-bottom",bottom:20,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"top-right-corner-pointer corner-pointer".w(),name:"point-right-on-top",top:20,needsGap:NO,side:CW.BOTTOM_SIDE}],render:function(H,F){var v=["top-left","bottom-left","top-right","bottom-right","middle"];this.addSizeClassName(H,F);var y=H.get("pointAtSide")||"right",s=H.get("pointerLayout"),E=s?s.needsGap:NO,x,B,G=H.get("pointerDistanceFromTop")||0,D=H.get("pointerDistanceFromBottom")||0,z=H.get("pointerDistanceFromLeft")||0,t=H.get("pointerDistanceFromRight")||0,C,I,u,w;if(y==="right"){C="top";I="bottom";u=G;w=D;B="left";v.push("right");v.push("top");v.push("bottom");x="sc-point-left"}else{if(y==="left"){C="top";I="bottom";u=G;w=D;B="right";v.push("left");v.push("top");v.push("bottom");x="sc-point-right"}else{if(y==="top"){C="left";I="right";u=z;w=t;B="bottom";v.push("top");v.push("left");v.push("right");x="sc-point-down"}else{C="left";I="right";u=z;w=t;B="top";v.push("bottom");v.push("left");v.push("right");x="sc-point-up"}}}if(s&&s.classNames){F.addClass(s.classNames)}if(s&&s.name){F.addClass(s.name)}F.setClass("needs-gap",E);this.includeSlices(H,F,v);F.begin("div").addClass("sc-pointer").addClass(x).css(C,u).end();F.begin("div").addClass(B).addClass("sc-before-pointer").css(I,E?w:null).end();F.begin("div").addClass(B).addClass("sc-after-pointer").css(C,E?u:null).end()},update:function(B,v){this.updateSizeClassName(B,v);var t=B.get("pointAtSide"),z=B.get("pointerDistanceFromTop"),x=B.get("pointerDistanceFromBottom"),u=B.get("pointerDistanceFromLeft"),p=B.get("pointerDistanceFromRight"),w,C,q,s,o=B.get("pointerLayout"),y=o?o.needsGap:NO;if(t==="right"||t==="left"){w="top";C="bottom";q=z;s=x}else{w="left";C="right";q=u;s=p}v.find(".sc-pointer").css(w,q);v.find(".sc-before-pointer").css(C,y?s:null);v.find(".sc-after-pointer").css(w,y?q:null);if(o&&o.classNames){v.addClass(o.classNames)}if(o&&o.name){v.addClass(o.name)}v.setClass("needs-gap",y)}});sc_require("render_delegates/picker_background");SC.BaseTheme.Callout=SC.BaseTheme.create({name:"callout"});SC.BaseTheme.addTheme(SC.BaseTheme.Callout);SC.BaseTheme.Callout.cwPickerBackgroundRenderDelegate=SC.BaseTheme.cwPickerBackgroundRenderDelegate.create({validPointerLayouts:[{name:"top-position",classNames:"calculated-pointer",minimumDistanceFromLeft:30,minimumDistanceFromRight:30,needsGap:YES}]});sc_require("render_delegates/picker_background");SC.BaseTheme.Menu=SC.BaseTheme.create({name:"menu"});SC.BaseTheme.addTheme(SC.BaseTheme.Menu);SC.BaseTheme.Menu.cwPickerBackgroundRenderDelegate=SC.BaseTheme.cwPickerBackgroundRenderDelegate.create({"sc-small-size":{pickerDistanceFromRectangle:8},"sc-regular-size":{pickerDistanceFromRectangle:12},"sc-large-size":{pickerDistanceFromRectangle:16},validPointerLayouts:[{name:"top-or-bottom-position",classNames:"calculated-pointer",minimumDistanceFromLeft:20,minimumDistanceFromRight:20,needsGap:NO},{classNames:"top-left-corner-pointer corner-pointer".w(),name:"point-up-on-left",left:15,needsGap:NO,side:CW.TOP_SIDE},{classNames:"top-right-corner-pointer corner-pointer".w(),name:"point-up-on-right",right:15,needsGap:NO,side:CW.TOP_SIDE},{classNames:"bottom-left-corner-pointer corner-pointer".w(),name:"point-down-on-left",left:15,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"bottom-right-corner-pointer corner-pointer".w(),name:"point-down-on-right",right:15,needsGap:NO,side:CW.BOTTOM_SIDE}]});SC.BaseTheme.cwMenuPickerBackgroundRenderDelegate=SC.BaseTheme.Menu.cwPickerBackgroundRenderDelegate;sc_require("render_delegates/menu_background");SC.BaseTheme.NoPointers=SC.BaseTheme.Menu.create({name:"cw-no-pointers"});SC.BaseTheme.addTheme(SC.BaseTheme.NoPointers);SC.BaseTheme.NoPointers.cwPickerBackgroundRenderDelegate=SC.RenderDelegate.create({className:"cw-picker-background",distanceFromEdge:20,render:function(c,d){this.addSizeClassName(c,d);this.includeSlices(c,d,SC.NINE_SLICE)},update:function(c,d){this.updateSizeClassName(c,d)},});sc_require("render_delegates/menu");sc_require("render_delegates/picker_nopointer_background");SC.BaseTheme.DropDown=SC.BaseTheme.create({name:"dropdown"});SC.BaseTheme.addTheme(SC.BaseTheme.DropDown);SC.BaseTheme.DropDown.cwMenuRenderDelegate=SC.BaseTheme.cwMenuRenderDelegate.create({menuLeftOffset:-3,menuTopOffset:7,menuMinimumWidthOffset:-18,shouldDropDown:YES});SC.BaseTheme.DropDown.cwPickerBackgroundRenderDelegate=SC.BaseTheme.NoPointers.cwPickerBackgroundRenderDelegate;SC.BaseTheme.ErrorCallout=SC.BaseTheme.create({name:"errorCallout"});SC.BaseTheme.ErrorCallout.cwPickerBackgroundRenderDelegate=SC.BaseTheme.cwPickerBackgroundRenderDelegate.create({pickerDistanceFromRectangle:10,validPointerLayouts:[{name:"top-position",classNames:"calculated-pointer",minimumDistanceFromLeft:30,minimumDistanceFromRight:30,needsGap:NO}]});sc_require("render_delegates/menu");sc_require("render_delegates/picker_nopointer_background");SC.BaseTheme.PopUp=SC.BaseTheme.create({name:"popup"});SC.BaseTheme.addTheme(SC.BaseTheme.PopUp);SC.BaseTheme.PopUp.cwMenuRenderDelegate=SC.BaseTheme.cwMenuRenderDelegate.create({shouldDropDown:NO});SC.BaseTheme.PopUp.cwPickerBackgroundRenderDelegate=SC.BaseTheme.NoPointers.cwPickerBackgroundRenderDelegate;SC.BaseTheme.cwPopupButtonRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({render:function(c,d){d.attr("aria-haspopup","true");arguments.callee.base.apply(this,arguments)},update:function(c,d){arguments.callee.base.apply(this,arguments)}});SC.BaseTheme.cwSelectRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({});CW.PopupButtonView=SC.ButtonView.extend({renderDelegateName:"cwPopupButtonRenderDelegate",menu:CW.MenuPane,shouldLoadInBackground:NO,_menuIsLoaded:NO,isActive:NO,acceptsFirstResponder:YES,init:function(){arguments.callee.base.apply(this,arguments);this._currentMenu=null;this.invokeOnce("scheduleMenuSetupIfNeeded")},scheduleMenuSetupIfNeeded:function(){var b=this.get("menu");if(b&&b.isClass&&this.get("shouldLoadInBackground")){SC.backgroundTaskQueue.push(CW.PopupButtonView.InstantiateMenuTask.create({popupButton:this}))}},menuDidChange:function(){var b=this.get("menu");if(b===this._currentMenu){return}this.invokeOnce("scheduleMenuSetupIfNeeded")}.observes("menu"),setupMenu:function(){var b=this.get("menu");if(b===this._currentMenu){return}if(this._currentMenu){this.isActiveBinding.disconnect();this._currentMenu.destroy();this._currentMenu=null}if(b&&b.isClass){b=this.createMenu(b)}this._currentMenu=b;this.set("menu",b);b.set("owner",this);this.isActiveBinding=this.bind("isActive",b,"isVisibleInWindow")},createMenu:function(b){return b.create()},showMenu:function(){this.setupMenu();this.invokeLast("_showMenu")},hideMenu:function(){var b=this.get("menu");if(b&&!b.isClass){b.remove()}},_showMenu:function(){var b=this.get("menu");b.popup(this)},mouseDown:function(d){if(!this.get("isEnabled")){return YES}this.set("_mouseDown",YES);this.showMenu();this._mouseDownTimestamp=null;var c=this;c._mouseDownTimestamp=0;setTimeout(function(){c._mouseDownTimestamp=Date.now()},1);this.becomeFirstResponder();return YES},mouseUp:function(e){var g=this.get("menu"),f,h;if(g&&this.get("_mouseDown")){f=g.getPath("rootMenu.targetMenuItem");if(this._mouseDownTimestamp===0){this._mouseDownTimestamp=Date.now()}if(e.timeStamp-this._mouseDownTimestamp>400){if(f&&g.get("mouseHasEntered")&&this._mouseDownTimestamp){if(!f.performAction()){g.remove()}}else{g.remove()}}}this._mouseDownTimestamp=undefined;return YES},keyDown:function(b){if(b.which==13){this.showMenu();return YES}return arguments.callee.base.apply(this,arguments)}});CW.PopupButtonView.InstantiateMenuTask=SC.Task.extend({popupButton:null,run:function(b){this.popupButton.setupMenu()}});sc_require("views/popup_button");sc_require("panes/select_view_menu");sc_require("panes/menu");sc_require("render_delegates/select");CW.SelectView=CW.PopupButtonView.extend({themeName:"popup",renderDelegateName:"cwSelectRenderDelegate",items:null,itemsBindingDefault:SC.Binding.multiple(),itemTitleKey:"title",itemSortKey:null,itemValueKey:"value",itemIconKey:"icon",itemSeparatorKey:"separator",itemIsEnabledKey:"isEnabled",menu:CW.SelectViewMenuPane,selectedItem:null,selectedItemBinding:"*menu.rootMenu.selectedItem",supportsFocusRing:YES,init:function(){arguments.callee.base.apply(this,arguments);this._scsv_updateTitle();this._scsv_valueDidChange()},_scsv_getValueForMenuItem:function(c){var d=this.get("itemValueKey")||"value";if(SC.typeOf(c)===SC.T_STRING){return c}else{if(c.get){return c.get(d)}else{return c[d]}}},_scsv_selectedItemDidChange:function(){var g=this.get("selectedItem"),h=this._scsv_lastSelection,f=this.get("itemTitleKey")||"title",e=this.get("itemValueKey")||"value";if(g){this.setIfChanged("value",this._scsv_getValueForMenuItem(g))}if(h&&h.addObserver&&g!==h){h.removeObserver(f,this,this._scsv_selectedItemPropertyDidChange);h.removeObserver(e,this,this._scsv_selectedItemPropertyDidChange)}if(g&&g.addObserver&&g!==h){g.addObserver(f,this,this._scsv_selectedItemPropertyDidChange);g.addObserver(e,this,this._scsv_selectedItemPropertyDidChange)}this._scsv_lastSelection=g}.observes("selectedItem"),_scsv_selectedItemPropertyDidChange:function(b){this._scsv_updateTitle();this.set("value",b.get(this.get("itemValueKey")||"value"))},defaultTitle:"",_scsv_updateTitle:function(){var d=this.get("selectedItem"),f,e;if(!d){f=this.get("defaultTitle")}else{if(d.get){f=d.get(this.get("itemTitleKey")||"title");e=d.get(this.get("itemIconKey")||"icon")}else{if(SC.typeOf(d)==SC.T_HASH){f=d[this.get("itemTitleKey")||"title"];e=d[this.get("itemIconKey")||"icon"]}else{f=d}}}if(f){this.set("title",f)}this.set("icon",e)}.observes("selectedItem"),_scsv_valueDidChange:function(){var h=this.get("value");if(!this.get("items")){return}var k=this.get("items"),f=k.get?k.get("length"):k.length,g,j;for(g=0;g<f;g++){j=k.objectAt?k.objectAt(g):k[g];if(this._scsv_getValueForMenuItem(j)===h){this.setIfChanged("selectedItem",j);return}}this.setIfChanged("selectedItem",null)}.observes("value"),_scsv_itemsDidChange:function(){this._scsv_valueDidChange()}.observes("items","items.[]"),createMenu:function(d){var c={selectView:this,selectedItem:this.get("selectedItem")};return d.create(c)},keyDown:function(b){if(this.interpretKeyEvents(b)){return YES}else{arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(b){if(b){if((b.keyCode===38||b.keyCode===40)){this.showMenu();return YES}else{if(b.keyCode===27){this.resignFirstResponder();return YES}}}return arguments.callee.base.apply(this,arguments)},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled").cacheable()});if(!window.CW){CW=SC.Object.create()}SC.REGULAR_BUTTON_HEIGHT=27;CW.CANVAS_BUTTON_HEIGHT=26;CW.TOOLBAR_BUTTON_HEIGHT=26;CW.SQUARE_BUTTON_LARGE_HEIGHT=30;CW.SQUARE_BUTTON_REGULAR_HEIGHT=27;CW.SELECT_BUTTON_REGULAR_HEIGHT=27;CW.POPUP_BUTTON_REGULAR_HEIGHT=27;CW.SQUARE_BUTTON_REGULAR_MIN_WIDTH=68;CW.SQUARE_BUTTON_SMALL_MIN_WIDTH=56;CW.SQUARE_BUTTON_TINY_MIN_WIDTH=52;CW.HELP_BUTTON_REGULAR_MIN_WIDTH=26;CW.HELP_BUTTON_SMALL_MIN_WIDTH=22;CW.HELP_BUTTON_TINY_MIN_WIDTH=18;SteedOSTheme=SC.BaseTheme.create({name:"htv3",description:"A HotLong theme by Jack Zhuang and contributors. Only supports browsers that implement CSS3."});SC.Theme.addTheme(SteedOSTheme);SteedOSTheme.PointLeft=SteedOSTheme.subtheme("point-left","point-left");SteedOSTheme.PointRight=SteedOSTheme.subtheme("point-right","point-right");SteedOSTheme.Capsule=SteedOSTheme.subtheme("capsule","capsule");SteedOSTheme.Dark=SteedOSTheme.subtheme("dark");SC.defaultTheme="htv3";SteedOSTheme.iOS=SteedOSTheme.subtheme("iOS");SteedOSTheme.iOS.blue=SteedOSTheme.iOS.subtheme("iOSBlue");if(SteedOSTheme.ErrorCallout){SteedOSTheme.addTheme(SteedOSTheme.ErrorCallout)}sc_require("theme");if(SteedOSTheme.iOS.cwPickerBackgroundRenderDelegate){SteedOSTheme.iOS.cwPickerBackgroundRenderDelegate=SteedOSTheme.iOS.cwPickerBackgroundRenderDelegate.create({validPointerLayouts:[{name:"left-or-right-position",classNames:"calculated-pointer",minimumDistanceFromLeft:60,minimumDistanceFromRight:60,needsGap:YES},{name:"top-or-bottom-position",classNames:"calculated-pointer",minimumDistanceFromTop:60,minimumDistanceFromBottom:60,needsGap:YES}]})}sc_require("theme");SteedOSTheme.mainBackgroundRenderDelegate=SC.RenderDelegate.create({className:"cw-main-background",render:function(c,d){this.includeSlices(c,d,SC.NINE_SLICE)}});SteedOSTheme.menuRenderDelegate=SC.BaseTheme.menuRenderDelegate.create({itemHeight:22,itemSeparatorHeight:7,menuHeightPadding:6,"sc-small-size":{itemHeight:18,itemSeparatorHeight:7,menuHeightPadding:6,submenuOffsetX:2},"sc-large-size":{itemHeight:31,itemSeparatorHeight:9,menuHeightPadding:8,submenuOffsetX:4}});CW.SQUARE_MENU_ITEM_HEIGHT=31;CW.SQUARE_MENU_ITEM_SEPARATOR_HEIGHT=7;CW.SQUARE_MENU_HEIGHT_PADDING=6;(function(){var a="steedos/auth_ui";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:["cloudkit/photo"],styles:["../../../../system/steedos/4330/steedos/auth_ui/4330/en-us/stylesheet.css"],styles2x:["../../../../system/steedos/4330/steedos/auth_ui/4330/en-us/stylesheet@2x.css"],scriptURL:"../../../../system/steedos/4330/steedos/auth_ui/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/steedos/auth_ui/4330/en-us/javascript-strings.js",isPrefetched:YES})})();(function(){var a="steedos/alarms";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:[],styles2x:[],scriptURL:"../../../../system/steedos/4330/steedos/alarms/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/steedos/alarms/4330/en-us/javascript-strings.js",isPrefetched:YES})})();(function(){var a="steedos/language";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:[],styles2x:[],scriptURL:"../../../../system/steedos/4330/steedos/language/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/steedos/language/4330/en-us/javascript-strings.js",isPrefetched:YES})})();(function(){var a="cloudkit/error_catcher";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:[],styles2x:[],scriptURL:"../../../../system/steedos/4330/cloudkit/error_catcher/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/cloudkit/error_catcher/4330/en-us/javascript-strings.js",isPrefetched:YES})})();(function(){var a="steedos/account";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:["coreweb/timezone_picker","cloudkit/photo"],styles:["../../../../system/steedos/4330/steedos/account/4330/en-us/stylesheet.css"],styles2x:["../../../../system/steedos/4330/steedos/account/4330/en-us/stylesheet@2x.css"],scriptURL:"../../../../system/steedos/4330/steedos/account/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/steedos/account/4330/en-us/javascript-strings.js",isPrefetched:YES})})();(function(){var a="coresteed/account";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:["../../../../system/steedos/4330/coresteed/account/4330/en-us/stylesheet.css"],styles2x:["../../../../system/steedos/4330/coresteed/account/4330/en-us/stylesheet@2x.css"],scriptURL:"../../../../system/steedos/4330/coresteed/account/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/coresteed/account/4330/en-us/javascript-strings.js",isPrefetched:YES})})();(function(){var a="cloudkit/photo";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:[],styles2x:[],scriptURL:"../../../../system/steedos/4330/cloudkit/photo/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/cloudkit/photo/4330/en-us/javascript-strings.js"})})();(function(){var a="coreweb/timezone_picker";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:["../../../../system/steedos/4330/coreweb/timezone_picker/4330/en-us/stylesheet.css"],styles2x:["../../../../system/steedos/4330/coreweb/timezone_picker/4330/en-us/stylesheet.css"],scriptURL:"../../../../system/steedos/4330/coreweb/timezone_picker/4330/en-us/javascript.js",stringURL:"../../../../system/steedos/4330/coreweb/timezone_picker/4330/en-us/javascript-strings.js"})})();SC.stringsFor("en-us",{});sc_require("bootstrap");CW.installKeyResponder();window.devicePixelRatio=window.devicePixelRatio||1;SteedOS=SC.Application.create(SC.DelegateSupport,{NAMESPACE:"SteedOS",VERSION:"2.0.0",isSteedOSClient:YES,hostname:window.location.hostname,TOPBAR_HEIGHT:40,NOTIFICATION_CENTER_WIDTH:300,MIN_WIDTH:950,MIN_HEIGHT:550,APP_LOAD_TIMEOUT:300*1000,APP_POST_READY_DELAY:500,ACTIVE_IDLE_INTERVAL:30,INACTIVE_IDLE_INTERVAL:600,INACTIVE_THRESHOLD:120,REFRESH_VALIDATE_TOKEN_INTERVAL:60*60*23,AUTO_UPDATE_INTERVAL:60*15,AUTO_UPDATE_DELAYED_FORCE_WAIT:120*60,MAX_NOTIFICATION_DISMISSAL_WAIT:10,ACTIVE_X_FILE_VERSION:"1,0,24,0",NOWHERE:0,AUTH:1,APP:2,SPRINGBOARD:3,HAS_SHOWN_PRE_AUTH_INFO:CK.getValueFromLocalStorage("ispi",true),supportedLocales:window.supportedLocales,delegate:null,isMobile:function(){return SC.browser.isiPhone||SC.browser.isAndroid},shouldShowPreInfo:function(){return NO}(),statechartPath:"SteedOS.statechart",init:function(){arguments.callee.base.apply(this,arguments);var e=SC.Logger,f=SC.LOGGER_LEVEL_DEBUG,h=(SC.buildMode==="debug")?f:SC.LOGGER_LEVEL_INFO;e.set("logOutputLevel",h);e.set("logRecordingLevel",f);CW.set("requestLoggingLevel",f);SC.Logger.set("outputMessagePrefix","SteedOS:  ");if(CK.isDeveloper){this.APP_LOAD_TIMEOUT=120*1000}var g=this;window.onbeforeunload=function(){var a=SteedOS.appController.get("currentApp"),b;if(a&&!a.get("isReadyToTerminate")){b="Dialog.UnsavedChanges.Text.Leave".loc(a.get("displayName"))}else{SteedOS._receivedBeforeUnload=YES}return b};window.onhashchange=function(){var c=SteedOS.appController.getAppFromHash(),b=SteedOS.appController.getAppRouteFromHash(),a=SteedOS.appManagerFor(c);if(a&&b!==a.get("route")){a.set("route",b)}SteedOS.openApp(c)}},run:function(){if(this._hasRunRun===(this._hasRunRun=YES)){SC.warn("SteedOS.run() has been called, but has already been called once. Perhaps there is some logic error in the machinery that calls this function.");return}SteedOS.loadLocalizedStrings();SteedOS.localizationController.relocalizeIfNeeded("SteedOS.run() wants the initial relocalize call");SteedOS.appController.initializeAppManagers();SteedOS.statechart.initStatechart();var d=SC.RootResponder.responder,c=SteedOS.workspaceController;d.set("defaultResponder",SteedOS.statechart);d.listenFor("resize".w(),window,c);c.updateTitle();COS.prefsController.set("delegate",SteedOS);SC.Event.add(window,"message",this,"_messageWasReceived",null,true);if(CW.isiOSApp()){document.addEventListener("pause",this.phonegapAppPause,false);document.addEventListener("resume",this.phonegapAppResume,false)}},phonegapAppPause:function(){var a=SteedOS.appController.currentApp;if(a){a.sleep()}},phonegapAppResume:function(){var a=SteedOS.appController.currentApp;if(a){a.wake()}},startWindowCount:function(){this.incrementWindowRefCount();var b=this;window.onunload=function(){b.decrementWindowRefCount(YES)}},_messageWasReceived:function(m){var t=URI(m.origin);if(t.protocol()!=="https"||t.domain()!=="steedos.com"){}var u=m.originalEvent,s=u.data,e;try{e=SC.typeOf(s)!==SC.T_STRING?s:SC.json.decode(s)}catch(q){SC.warn(q);return}if(!e.isSteedOSMessage){return}var o=e.appName,v=SteedOS.appManagerFor(o),n=e.methodName,p=e.args||[];if(!v){SC.warn("Could not find an appManager for %@",o);return}p.unshift(u);p.unshift(v);if(this.respondsTo(n)){this[n].apply(this,p)}},_windowMessageWasReceived:function(b){SC.RunLoop.end();SC.run(function(){this._messageWasReceived(b)},this)},passMessageToAllApps:function(m,l,g){var k=SteedOS.appController.get("apps"),h,j;for(h in k){j=k[h];j.passMessage(m,l,g)}},focus:function(){try{window.focus()}catch(b){SC.debug("Failed to focus SteedOS client window. Exception text: "+b)}},incrementWindowRefCount:function(){var c=parseInt(CK.readCookie("COS_REFCOUNT"),10),d=isNaN(c)||SC.typeOf(c)!==SC.T_NUMBER?1:++c;CK.writeCookie("COS_REFCOUNT",d);CK.writeCookie("SEND_REQUESTS_ON_CLOSE",0,"/",".steedos.com")},decrementWindowRefCount:function(h){var g=parseInt(CK.readCookie("COS_REFCOUNT"),10),e=isNaN(g)||SC.typeOf(g)!==SC.T_NUMBER?0:--g,f=SteedOS.authController;if(e<0){e=0}CK.writeCookie("COS_REFCOUNT",e);if(e===0&&!f.get("isExtendedLogin")){if(!f.get("hasLoggedOut")){CK.writeCookie("SEND_REQUESTS_ON_CLOSE",1,"/",".steedos.com");SteedOS.authController.logoutUser(null,NO,NO)}}},localeDidLoad:window.localeDidLoad,_ldl:window.localeDidLoad,localeDidLoadDidChange:function(){if(!this.get("localeDidLoad")||!this.get("mainHasCompleted")){return}SC.debug("Got localized strings back AFTER app is loaded and SteedOS.main() has run. Running SteedOS.run() now, because SteedOS.localeDidLoad changed from "+this._ldl+" to "+this.localeDidLoad);SteedOS.run()}.observes("localeDidLoad"),loadLocalizedStrings:function(){SC.debug("Loading localized strings and metrics");var f=window.localizedStrings,d=window.localizedMetrics,e;for(e in f){SC.stringsFor(e,f[e])}for(e in d){SC.metricsFor(e,d[e])}},appManagerFor:function(f){var d=arguments.callee.apps||(arguments.callee.apps=SteedOS.appController.get("apps"));var e=arguments.callee.appsList||(arguments.callee.appsList=SteedOS.appController.get("appList"));if(typeof f==="number"){return e&&e[f]}if(typeof f==="string"){return d&&d[f]}if(f&&f.isAppManager){return f}if(!f){return}return d&&d[f.get("name")]},appManagersForPushTopic:function(k){var j=SteedOS.appController.get("apps"),h,g,f=[];for(g in j){h=j[g];if(h.getPath("appInfo.pushTopic")===k){f.push(h)}}return f},openApp:function(c){var d=SteedOS.workspaceController.get("nowShowing");if(d===SteedOS.AUTH||d===SteedOS.NOWHERE){return}if(!c){SteedOS.statechart.gotoState("active.springboard")}else{SteedOS.appController.set("pendingApp",c=SteedOS.appManagerFor(c));SteedOS.statechart.sendAction("globalAppSwitchWasRequested")}},_userInputBlocked:0,blockUserInput:function(){if(!this._userInputBlocked){SteedOS.blockInputController.block()}this._userInputBlocked++},unblockUserInput:function(){if(this._userInputBlocked<=0){SC.warn("User input already unblocked. unblockUserInput has no effect.");return}this._userInputBlocked--;if(this._userInputBlocked===0){SteedOS.blockInputController.unblock()}},isPhotoPickerOpen:function(){if(SteedOS.statechart){var b=SteedOS.statechart.get("currentStates").getEach("name");return b.indexOf("photoPickerLoadedInitialState")!==-1||b.indexOf("photoPickerLoadedUploadedState")!==-1}else{return NO}},shouldAppHaveFocus:function(){if(SteedOS.workspaceController.nowShowing!==SteedOS.APP){return NO}return SteedOS._numberDialogsAboveApp===0},_numberDialogsAboveApp:0,notifyDialogAboveApp:function(){SteedOS._numberDialogsAboveApp++},notifyRemovalOfDialogAboveApp:function(){SteedOS._numberDialogsAboveApp--;if(SteedOS._numberDialogsAboveApp<0){SteedOS._numberDialogsAboveApp=0}},lockedAlertDescription:function(d,e,f){if(SC.none(e)){d+="NoETA"}else{if(e<=60){d+="Minute"}else{if(e<3600){d+="Minutes"}else{d+="HourOrMore"}}}return d.loc({appName:f,minutes:Math.ceil(e/60)})},getCurrentYear:function(){var c=new Date(),d=c.getFullYear();return d},runWhenReady:function(d,f){var e=this._readyQueue;if(f===undefined){f=d;d=null}else{if(SC.typeOf(f)===SC.T_STRING){f=d[f]}}if(this._isReady){f.call(d)}else{if(!e){this._readyQueue=[]}this._readyQueue.push(function(){f.call(d)})}return this},_executeReadyQueue:function(){if(SteedOS._outstandingRequests>0){if(this._invokeLaterTimer){this._invokeLaterTimer.invalidate()}this._invokeLaterTimer=this.invokeLater(function(){SteedOS._executeReadyQueue()},1000);return}this._isReady=YES;var f=this._readyQueue,d,e;if(f){SC.info("Executing SteedOS readyQueue");for(d=0,e=f.length;d<e;d++){f[d].call()}this._readyQueue=null}},showRegister:function(){if(SteedOS.get("isAccountModuleReady")){CS.AccountCenter.loadRegister()}},showForgotPassword:function(){if(SteedOS.get("isAccountModuleReady")){CS.AccountCenter.loadForgotPassword()}},showQuickGuide:function(){if(SteedOS.get("isAccountModuleReady")){CS.AccountCenter.loadQuickGuide()}},showGoogleSSO:function(){if(SteedOS.get("isAccountModuleReady")){CS.AccountCenter.loadGoogleSSO()}},});(function(){var f=parseFloat(SC.browser.webkit||"",0)||0,d=parseInt(SC.browser.msie||"",10)||0,e=parseInt(SC.browser.chrome||"",10)||0;SteedOS.ENABLE_TRANSFORM_ANIMATIONS=d>=10||(SC.platform.supportsAcceleratedLayers&&(f>=534.51||!SC.browser.isWindows));SteedOS.ENABLE_SCALE_ANIMATION=SteedOS.ENABLE_TRANSFORM_ANIMATIONS&&((f<534||f>=534.51)&&!(e<22));SteedOS.ENABLE_APP_ANIMATION=SteedOS.ENABLE_TRANSFORM_ANIMATIONS;SteedOS.ANIMATE_SPRINGBOARD_LAYOUT=SC.browser.safari&&(f>=534.51||SC.browser.isMac);SteedOS.ANIMATE_SPRINGBOARD_SCALE=!!f||!!SC.browser.mozilla;CW.Animator.ENABLE_OLD_IE=NO;if(SC.browser.isAndroid){SteedOS.ENABLE_TRANSFORM_ANIMATIONS=NO;SteedOS.ENABLE_SCALE_ANIMATION=NO;SteedOS.ENABLE_APP_ANIMATION=NO}})();SteedOS.NotificationSupport={hasNotificationSupport:YES,initMixin:function(){var k=this.get("subscribesTo"),h=k&&k.length,m,g,j,l;if(!h){return}for(m=0;m<h;m++){j=k[m];l="__notifier"+m+"__";g=function(){var b=arguments.callee,a=b.__path__,c=b.__previous__,d=b.__owner__;if(c){d.unsubscribeFrom(c)}d.subscribeTo(b.__previous__=d.get(a))};g.__path__=l;g.__owner__=this;this.addObserver(l,g);this.bind(l,j);this[l]=SC.objectForPropertyPath(j);g()}},subscribeTo:function(b){if(!b){return}if(b&&!b.hasNotificationSupport){SC.warn("Warning: "+this+" is attempting to subscribe to "+b+", which lacks NotificationSupport. Ignoring call.");return}b.addSubscriber(this);return this},unsubscribeFrom:function(b){if(!b||!b.hasNotificationSupport){return}b.removeSubscriber(this);return this},addSubscriber:function(f){var d=this._subscribers||(this._subscribers=[]),e=SC.guidFor(f);if(!isNaN(d[e])){return}d[e]=d.length;d.push(f)},removeSubscriber:function(g){var h=this._subscribers;if(!h||!g){return}var e=SC.guidFor(g),f=h[e];if(isNaN(f)){return}delete h[e];h[f]=undefined;h.__holes__=(h.__holes__||0)+1;if(h.__holes__>=10){this._coalesceSubscriberList()}},notifySubscribers:function(j){var l=this._subscribers,g=undefined;if(l){if(arguments.length>1){g=SC.$A(arguments);g.splice(0,1)}for(var m=0,h=l.length,k;m<h;m++){if((k=l[m])&&k[j] instanceof Function){if(!g){k[j].call(k)}else{k[j].apply(k,g)}}if(k.didReceiveNotification instanceof Function){k.didReceiveNotification(j,this)}}}this.didSendNotification(j)},didReceiveNotification:function(d,c){},didSendNotification:function(b){},_coalesceSubscriberList:function(){var f=this._subscribers;if(!f||!f.length){return}var e=f.length,d;for(d=0;d<e;d++){if(!f[d]){f.splice(d,1)}else{f[SC.guidFor(f[d])]=d}d--;e--}}};require("mixins/notification_support");SteedOS.AppManager=SC.Object.extend(SteedOS.NotificationSupport,{subscribesTo:"SteedOS.localizationController".w(),isAppManager:YES,appInfo:null,nameBinding:".appInfo.name",isReadyBinding:".appInfo.isReady",isDisabledBinding:".appInfo.isDisabled",isRampedBinding:".appInfo.isRamped",isUnqualifiedBinding:".appInfo.isUnqualified",pushTopicBinding:".appInfo.pushTopic",hasPushUIBinding:".appInfo.hasPushUI",isQualifiedForBetaBinding:".appInfo.isQualifiedForBeta",isQualifiedForDeveloperBinding:".appInfo.isQualifiedForDeveloper",requiresMailAndIsMissing:function(){var b=this.getPath("appInfo.requiredServices");if(!b||b.indexOf("mail")===-1){return NO}if(!CK.servicesController.getServiceInfoFor("mail")){return YES}else{return NO}},shouldUseBeta:function(){if(this.get("isBeta")){return YES}return NO}.property("isQualifiedForBeta","isBeta").cacheable(),shouldUseDeveloper:function(){if(this.get("isDeveloper")){return YES}return NO}.property("isQualifiedForDeveloper","isDeveloper").cacheable(),badgeCount:0,path:function(){var h=COS.authController.get("accountPreferences"),a=h&&h.get("locale");var j=CW.getUrlParameters();if(j.locale){a=j.locale}if(!a||SteedOS.supportedLocales.indexOf(a)===-1){SC.warn("Locale %@ is not supported, so using en-us",a);a="en-us"}var f=this.getPath("appInfo.path"),b=CK.get("isBeta"),m=CK.get("isDeveloper"),g;var l="localhost.steedos.com";queryObject=window.URI.parseQuery(window.URI().query());if(queryObject.sc_server){l=queryObject.sc_server}if(queryObject.sc_server||(m&&this.get("shouldUseDeveloper"))){g="http://"+l+":4020/"+f+a+"/current/"}else{if(SC.buildMode==="debug"){g="/"+f+"current/"+a+"/"}else{if(f.indexOf("https://")===0){g=f}else{var k="cations/";g="../../../../appli"+k+f+"current/"+a+"/";if(b&&this.get("shouldUseBeta")){g="https://beta.steedos.com"+g}else{g=g+"index.html"}}}}return g}.property("appInfo.path"),locationHash:function(){var c=this.get("name"),d=this.get("route");if(d){c+="/%@".fmt(d)}return c}.property("route"),route:null,routeDidChange:function(){var b=this.get("route");this.passMessage("_cloudOSStateChange",{route:b});this.passMessage("routeDidChange",b)}.observes("route"),contentWindow:function(){var b=this.get("view");if(b){return b.get("contentWindow")}else{return null}}.property("view"),isFailed:NO,isActive:NO,isWaiting:NO,isLoaded:NO,startupDataHasBeenLoaded:NO,loadInBackground:NO,isHidden:NO,isReadyToTerminate:YES,title:null,displayName:null,view:null,_hasLoaded:NO,loadReason:null,preDisplayAction:null,preDisplayActionArgs:null,postDisplayAction:null,postLoadAction:null,getReady:function(){if(this._view){return}var d=this.get("name");SC.debug("Beginning to load %@",d);COS.startupController.requestStartup(d);var c=SteedOS.AppFrameView.create({app:this});this.set("view",this._view=c);SteedOS.getPath("mainPage.mainPane.appsView").addAppFrame(c);this.set("isWaiting",YES);this._checkLoadFailureTimer=this.invokeLater("_checkLoadFailure",SteedOS.APP_LOAD_TIMEOUT);this._iframeWasCreated=YES},getReadyInBackground:function(){this.set("loadInBackground",YES);this.getReady()},relocalize:function(c){this.teardown();var d="AppTitle.%@".fmt(this.get("name")).loc();this.set("displayName",d)},teardown:function(){if(!this._iframeWasCreated){return}SC.debug("Ensuring that %@ is torn down.",this.get("name"));var d=this.get("view");if(d){d.destroy()}this.set("view",this._view=null);if(this._checkLoadFailureTimer){this._checkLoadFailureTimer.invalidate()}if(this.get("isFailed")){this.set("hasFailedOnce",YES)}this.set("isFailed",NO);this.set("isWaiting",NO);this.set("isActive",NO);this.set("loadReason",null);this.set("isLoaded",NO);this._hasLoaded=NO;var c=this.get("appInfo");if(c){c.set("startupResponse",null);c.set("isReady",NO)}this.set("isReady",NO)},_checkLoadFailure:function(){if(!this.get("isReady")){this._didFailToBecomeReady()}},_didFailToBecomeReady:function(){this.set("isWaiting",NO);if(SteedOS.appController.get("pendingApp")===this){SteedOS.statechart.sendAction("applicationDidFailToBecomeReady")}SteedOS.getPath("mainPage.mainPane.appsView").removeAppFrame(this._view)},didBecomeReady:function(){var f=SC.Benchmark,e=this.get("name");f.end("Waiting for application to become visible",e);if(!this.get("isLoaded")){SC.debug("Received didBecomeReady for "+this.get("name")+", which is no longer loaded. Ignoring call.");return}if(this.get("isFailed")){return}COS.startupController.notifyStartup(this.get("appInfo"),YES);window[e.substr(0,2)]=this.get("contentWindow");var d=function(){var a=SteedOS.appController;if(!this.get("isLoaded")){SC.debug("Finishing didBecomeReady for "+this.get("name")+", which was unloaded since didBecomeReady was called. Aborting.");return}this.set("isReady",YES);this.set("isWaiting",NO);if(a.get("pendingApp")===this&&!this.get("loadInBackground")){SteedOS.statechart.sendAction("applicationDidBecomeReady")}var b=this.get("postLoadAction");if(b){b.apply(this)}this.set("postLoadAction",null);a.set("loadingApp",null)};if(SteedOS.APP_POST_READY_DELAY){this.invokeLater(d,SteedOS.APP_POST_READY_DELAY)}else{d.call(this)}},startupDataDidLoad:function(){this.set("startupDataHasBeenLoaded",YES);if(!this.get("isWaiting")){SC.Benchmark.end("Waiting for startup data",this.get("name"))}},show:function(b){if(!this.get("isReady")){return}this.notifyPropertyChange("title");SteedOS.getPath("mainPage.mainPane.appsView").showApp(this,b)},hide:function(b){if(!this.get("isReady")){return}SteedOS.getPath("mainPage.mainPane.appsView").hideApp(this,b)},iconElement:null,iconDidLoad:function(){this.set("iconElement",this._iconAssetVessel)},prepareIcon:function(){var d=this.get("icon");if(this._lastIcon===(this._lastIcon=d)||!d){return}var f=this,e;e=this._iconAssetVessel=new Image();e._onload=function(){if(f._iconAssetVessel===this){try{f.iconDidLoad()}catch(a){SC.error("Exception while attempting to handle newly loaded icon image for "+f.get("name")+". Exception text: "+a)}}};e.onload=function(){this._isDownloaded=YES;this._onload()};setTimeout(function(){if(!e._isDownloaded){e._onload()}},4000);e.src=d}.observes("icon"),init:function(){arguments.callee.base.apply(this,arguments);this.prepareIcon()},benchmarks:function(){var b=SC.Benchmark._statFor(this.get("name"));return b&&b._times&&b._times[0]?b._times[0]._subStats:null},focus:function(){var b=this.get("view");if(!b){return}b.focus()},passMessage:function(q){var e=this.get("contentWindow"),k=this.get("name");if(!e){return}var p=SC.$A(arguments);p.shift();var m={isSteedOSMessage:true,methodName:q,args:p};var o=this.getPath("view.layer.src"),n=URI(o);try{e.postMessage(SC.json.encode(m),"*")}catch(l){SC.warn('passMessage: iFrame not properly loaded from "%@" for "%@"?',o,k)}},sleep:function(){this.passMessage("_sleep")},wake:function(){this.passMessage("_wake")},ensureWillSuspend:function(){this.ensureDidBecomeActive();if(this._messageState!==this._DID_BECOME_ACTIVE){return}this._messageState=this._WILL_SUSPEND;this.passMessage("applicationWillSuspend")},ensureDidSuspend:function(){if(this._messageState!==this._WILL_SUSPEND){return}this._messageState=this._DID_SUSPEND;this.passMessage("applicationDidSuspend")},ensureWillBecomeActive:function(){this.ensureDidSuspend();if(this._messageState!==this._DID_SUSPEND){return}this._messageState=this._WILL_BECOME_ACTIVE;if(this._hasLoaded){this.passMessage("applicationShouldRefresh",NO)}this.passMessage("applicationWillBecomeActive");this.sleep()},ensureDidBecomeActive:function(){if(this._messageState!==this._WILL_BECOME_ACTIVE){return}this._messageState=this._DID_BECOME_ACTIVE;this.wake();this._hasLoaded=YES;if(this.get("wantsSecondaryAuth")){this.set("wantsSecondaryAuth",NO);SteedOS.statechart.invokeLater("sendAction",100,"showSecondaryAuth")}this.passMessage("applicationDidBecomeActive",this.benchmarks());var b=this.get("postDisplayAction");this.set("postDisplayAction",undefined);if(b){b.apply(this)}},_DID_SUSPEND:1,_WILL_SUSPEND:2,_DID_BECOME_ACTIVE:3,_WILL_BECOME_ACTIVE:4,_messageState:1});sc_require("controllers/app_manager");SteedOS.appController=SC.Object.create({initializeAppManagers:function(){var z={},w=this.getAppFromHash(),o=this.getAppRouteFromHash(),u=[],t,y,q,n,p,v,x,s;for(p=0,v=SteedOS.displayApps.length;p<v;p++){n=SteedOS.displayApps[p];t=n.name;q=COS.appsController.getAppInfoFor(t);x=t===w?o:null;u.push(z[t]=SteedOS.AppManager.create(n,{appInfo:q,index:u.length,route:x}))}this.set("appList",u);this.set("apps",z)},reloadApplication:function(j){var h=SteedOS.appController,f=SteedOS.appManagerFor(j),k=this,g=h.get("currentApp");if(!f){SC.warn("reloadApplication():  Application %@ does not exist",j);return}if(g&&g.get("name")===j){SteedOS.statechart.sendAction("appMustReload",function(){f.teardown();k.invokeLater(function(){h.set("pendingApp",f);f.set("loadReason",CK.LOAD_REASON_RELOAD);SteedOS.statechart.sendAction("userDidChooseApp")},500)})}else{f.teardown()}},exitApplication:function(n,o,q){var m=SteedOS.appController,p=SteedOS.appManagerFor(n),j=NO;if(!p){SC.warn("application %@ does not exist".fmt(n));return}p.set("isFailed",YES);if(o===CK.EXIT_FATAL_ERROR){j=YES}var k=m.get("currentApp"),l=m.get("pendingApp");if((k&&k.get("name")===n)||(l&&l.get("name")===n)){SteedOS.statechart.sendAction("appMustExit",o,q)}else{p.teardown();if(j){this.showErrorReporter(k,q)}}},exitApplicationSilently:function(c){SteedOS.statechart.sendAction("appMustExitSilently");var d=SteedOS.appManagerFor(c);if(d){d.teardown()}},switchToApplicationWithNotification:function(f,e,g){var h=SteedOS.appManagerFor(f);if(this.get("currentApp")===h&&h.get("isReady")){SC.debug("Handing notification off to active app %@ immediately",f);h.passMessage("didReceiveNotification",e);if(g){g.dismiss()}}else{SteedOS.appController.set("pendingApp",h);if(g){g.set("automaticallyDismiss",NO)}h.set("postDisplayAction",function(){if(g){g.dismiss()}h.passMessage("didLaunchWithNotification",e)});SteedOS.statechart.sendAction("appCalledSwitchToApplication")}},reset:function(){var d=this.get("apps"),f,e;for(e in d){f=d[e];f.teardown();f.set("badgeCount",0)}},currentApp:null,pendingApp:null,activateCurrentApp:function(d){var c=this.get("currentApp");if(!c){SC.debug("No app is ready to be activated yet, waiting for it to call back when ready");return}c.set("isActive",YES);c.show(d)},deactivateCurrentApp:function(){var b=this.get("currentApp");if(!b){SC.debug("No app is ready to be deactivated yet.");return}CK.currentApplication=null;this.set("currentApp",null);b.set("isActive",NO)},isAuthenticatedBinding:"SteedOS.authController.isAuthenticated",isAuthenticatedDidChange:function(){if(!this.get("isAuthenticated")){var b=this;setTimeout(function(){SC.run(function(){(function(){var a=this.get("apps");for(var d in a){a[d].teardown()}}).apply(b)})},100)}}.observes("isAuthenticated"),userDidRevalidate:function(){var d=this.get("apps"),e,f;for(e in d){f=d[e];f.passMessage("userDidRevalidate")}SC.Request.manager.resumeAllServices()},getDefaultApp:function(){var h=this.getAppFromHash(),e=SteedOS.authController.get("accountPreferences"),f;if(h){f=h;SC.debug("Found user's preferred app from location.hash: %@",f)}if(!f){return null}var g=SteedOS.appManagerFor(f);if(g&&!g.get("isDisabled")){return g}},getAppFromHash:function(){var h=window.location.hash,e=h.indexOf("/"),f,g;g=h.substring(1,(e!==-1?e:h.length));if(COS.apps[g]){f=g}return f},getAppRouteFromHash:function(){var c=window.location.hash,d=c.indexOf("/");if(d===-1){return}return c.substring(d+1,c.length)},showErrorReporter:function(h,e,g){var f=h.get("name");g=g===NO?NO:YES;CK.errorCatcher.reportServerError({isFatal:g,applicationName:f,title:"Error.AppLoading.Title".loc("AppTitle.%@".fmt(f).loc()),message:"Error.AppLoading.Description".loc(),log:e})}});SteedOS.workspaceController=SC.Object.create(SteedOS.NotificationSupport,{nowShowing:SteedOS.NOWHERE,nextShowDelayTime:0,applicationIsFullwindow:NO,applicationIsOnscreen:NO,notificationIsOnscreen:NO,topbarIsOnscreen:YES,isGPUEnabled:undefined,toggleGPU:function(){var b=this.get("isGPUEnabled");if(this._lastGPUEnabled===(this._lastGPUEnabled=b)){return}$(document.body).setClass("gpu-disabled",!b)}.observes("isGPUEnabled"),layoutChanger:function(){var d=this.get("applicationIsFullwindow"),e=this.get("applicationIsOnscreen");var f=!d&&!(this._usingMin&&e);if(this._usingMin!==(this._usingMin=f)){this.notifySubscribers(f?"activateMinimumSize":"deactivateMinimumSize")}this.set("topbarIsOnscreen",!this.get("applicationIsFullwindow"))}.observes("applicationIsOnscreen","applicationIsFullwindow"),_usingMin:YES,updateTitle:function(){var h=SteedOS.appController.get("currentApp"),g=h?h.get("name"):null,k=g?("AppTitle."+g).loc():null,j=h?h.get("title"):null,f;if(!h||!h.get("isActive")){if(CK.isBeta){f="TitleBar.Beta".loc()}else{if(CK.isDeveloper){f="TitleBar.Developer".loc()}else{f="TitleBar.Production".loc()}}}else{if(j){f=j}else{f=("AppTitleBar."+g).loc()}}this.set("title",f);return f}.observes("SteedOS.appController*currentApp.title","SteedOS.appController*currentApp.isActive"),updateHash:function(){var b=SteedOS.appController.get("currentApp");this.set("hash",(b&&b.get("isActive"))?b.get("locationHash"):"")}.observes("SteedOS.appController*currentApp","SteedOS.appController*currentApp.route","SteedOS.appController*currentApp.isActive"),title:null,titleDidChange:function(){window.document.title=this.get("title")}.observes("title"),hash:null,hashDidChange:function(){var b=this.get("hash");if(window.location.hash!==("#"+b)){window.location.hash=b}}.observes("hash"),removeRHTMLSpinner:function(){if(window._removeRHTMLSpinner){window._removeRHTMLSpinner()}},set:function(d,f){if(d==="nowShowing"){this.beginPropertyChanges();var e=arguments.callee.base.apply(this,arguments);this.chooseDelayFromNowShowing();this.endPropertyChanges();return e}else{return arguments.callee.base.apply(this,arguments)}},chooseDelayFromNowShowing:function(){var c=this.get("nowShowing");var d=this._previousNowShowing;this._previousNowShowing=c;this.set("nextShowDelayTime",this.get("nowShowingDelays")[d||0][c||0])},nowShowingDelays:[[0,0,500,500],[0,0,0,500],[0,500,0,0],[0,500,0,0]],springboardVisualCenterY:0,accountSignoutHelpProtrusion:0,checkZoomLevel:function(){var d=this._zoomLevelAlert,c=this.isZoomed();if(c&&!d){this._createZoomLevelAlert()}else{if(!c&&d){d.remove();this._zoomLevelAlert=null}}},isZoomed:function(){var f=NO,e=1;if(SC.browser.webkit){if(window.devicePixelRatio){e=window.devicePixelRatio}var d=(window.outerWidth*e-8)/window.innerWidth;if(d<=0.92||d>1.1){f=YES}}else{if(SC.browser.msie&&(screen.deviceXDPI/screen.logicalXDPI)!==1){f=YES}}return f},_createZoomLevelAlert:function(){if(this._zoomLevelAlert){return this._zoomLevelAlert}this._zoomLevelAlert=CW.Alert.show({message:"ZoomLevel.Title".loc(),description:"ZoomLevel.Description".loc(),rightButton:"Button.OK".loc()});return this._zoomLevelAlert},resize:function(){}});sc_require("mixins/notification_support");sc_require("controllers/workspace");SteedOS.authController=COS.AuthController.create(SteedOS.NotificationSupport,{isSpinning:NO,areFieldsEditable:YES,registerEnabled:YES,subscribesTo:"SteedOS.localizationController".w(),validateTokenTimer:null,relocalize:function(){var b=this.get("user");if(b){b.notifyPropertyChange("displayName")}},needSimpleAccountUI:function(){var b=CK.servicesController.getServiceInfoFor("contacts");return !b||b.status!=="active"}.property("isUserRamped","isUserUnqualified"),init:function(){arguments.callee.base.apply(this,arguments);if(CW.isiOSApp()){this.set("registerEnabled",NO)}SteedOS._authController=this;COS.authController=this;var m=this,h=this.checkPreferences;this.checkPreferences=function(){return h.apply(m,arguments)};var g=SteedOS.appController.getAppRouteFromHash(),k,j;if(!j&&g){k=CW.getUrlParameters(g);if(k.username){j=k.username;SteedOS.workspaceController.set("hash","")}}if(!j){j=CK.getValueFromLocalStorage("username")}if(j){this.set("loginUsername",j)}SC.Timer.schedule({target:this,action:function(){var c=SteedOS.authController.get("user");if(!c){return}var b=CK.readCookie("X-STEEDOS-WEB-ID"),a=c.get("steedosId"),d=c.get("steedosIdAlias");if(!m.get("isAuthenticating")&&a&&parseInt(CK.readCookie("COS_REFCOUNT"),10)>1&&b!==a&&b!==d){window.location.hash="#showlogin";window.location.reload()}},interval:1000,repeats:YES});var l=SC.Timer.schedule({target:this,action:"shouldRefreshValidateToken",interval:(SteedOS.REFRESH_VALIDATE_TOKEN_INTERVAL*1000),repeats:YES});this.set("validateTokenTimer",l)},loginUsername:"",loginPassword:"",isExtendedLogin:YES,cloudOSAuthCompleted:function(a){CK.writeCookie("X-STEEDOS-WEB-ID",this.get("loginUsername"),null,".steedos.com",(this.get("isExtendedLogin")?24*14:null),YES)},validateDidSucceed:function(d,f){var e=COS.getCredentialsFromQueryParameters();if(e&&e.username!==d.dsInfo.steedosId){SC.warn("Username provided in URL is NOT the same as the one that was validated, logging in...");this.clearUserState();SC.Request.manager.cancelAll();SteedOS.statechart.sendAction("authDidNotConnect");this.loginUser(e.username,e.password,e.extendedLogin,this.checkPreferences);return}if(f&&d.dsInfo.dsid!==f.dsInfo.dsid){window.location.hash="#showlogin";window.location.reload();return}if(SteedOS.displayApps.length==1){window.location.hash=SteedOS.displayApps[0].name}this.set("loginUsername",SteedOS.authController.getPath("user.steedosId"));this.set("isExtendedLogin",d.isExtendedLogin);this.cloudOSAuthCompleted(d);if(!this._didIncrementCount){SteedOS.startWindowCount();this._didIncrementCount=YES}},validateDidFail:function(f,h,g){if(g){return}var e=COS.getCredentialsFromQueryParameters();if(e){this.loginUser(e.username,e.password,e.extendedLogin,this.checkPreferences);return}if(f.status===401){SteedOS.statechart.sendAction("authDidNotValidate")}else{navigator.notification.confirm("Error.AuthDidNotConnect.Description".loc(),function(a){if(a===1){SteedOS.statechart.gotoState("validatingAuth")}else{SteedOS.statechart.sendAction("authDidNotConnect")}},"Error.AuthDidNotConnect.Title".loc(),["Error.Button.TryAgain".loc(),"Button.Cancel".loc()])}},logoutDidSucceed:function(){SteedOS.hasLoggedOut=YES},loginDidSucceed:function(d){if(SteedOS.displayApps.length==1){window.location.hash=SteedOS.displayApps[0].name}this.set("isExtendedLogin",d.isExtendedLogin);this.cloudOSAuthCompleted(d);var c=SteedOS.authController.getPath("user.steedosId");this.set("loginUsername",c);CK.setValueInLocalStorage("username",c);if(!this._didIncrementCount){SteedOS.startWindowCount();this._didIncrementCount=YES}},loginDidFail:function(e,d){this.set("loginPassword","");SteedOS.appController.reset();var f=d?d.error:null;if(d&&e.status===401){if(f===12||f===13){if(f===12){this.set("securityQuestionText",d.securityQuestion);this.set("securityQuestionDSID",d.dsid)}SteedOS.statechart.sendAction("authDidNotValidateSecurityQuestionRequired")}else{if(f===1){SteedOS.statechart.sendAction("authDidNotValidate")}else{if(f===11){SC.info("Login id sent does not match, sending validate before re-sending login");this.validateUser(function(){e.get("request").resend(e)},YES)}else{SC.warn("Auth: 401 response but no recognized error code");SteedOS.statechart.sendAction("authDidNotConnect")}}}}else{if(e.status===403){if(f===14){SteedOS.statechart.sendAction("authDidNotValidateExpiredPassword")}else{if(f===10){SteedOS.statechart.sendAction("authDidNotValidateAccountClosed")}else{if(f===9){SteedOS.statechart.sendAction("authDidNotValidateSupportLocked")}else{if(f===8){SteedOS.statechart.sendAction("authDidNotValidateLocked")}else{if(f===7){SteedOS.statechart.sendAction("authDidNotValidateLocked")}else{if(f===6){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")}else{if(f===5){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")}else{if(f===4){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")}else{if(f===3){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")}else{if(f===2){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")}else{SC.warn("Auth: 403 response but no recognized error code");SteedOS.statechart.sendAction("authDidNotConnect")}}}}}}}}}}}else{if(e.status===406){SC.info("Login id sent does not match, sending validate before re-sending login");this.validateUser(function(){e.get("request").resend(e)},YES)}else{if(e.status===503){this.handle503(e)}else{if(SC.device.get("isOffline")){SteedOS.statechart.sendAction("authDidNotValidateOffline")}else{SC.warn("Auth: No auth bag or recognized status code");SteedOS.statechart.sendAction("authDidNotConnect")}}}}}},userIsMobileMe:function(){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")},userIsNotSignedUp:function(){SteedOS.statechart.sendAction("authDidNotValidateNotSteedOSUser")},userIsNotBetaQualified:function(){SteedOS.statechart.sendAction("authDidNotValidateNotBetaQualified")},userIsNotDeveloperQualified:function(){SteedOS.statechart.sendAction("authDidNotValidateNotDeveloperQualified")},userIsNotVerified:function(){SteedOS.statechart.sendAction("authDidNotValidateNotVerified")},userIsRamped:function(){this.set("userRequiresRampNotification",YES)},userIsUnqualified:function(){this.set("userRequiresUnqualifiedNotification",YES)},userHasAuthenticated:function(){SteedOS.pushController=SteedOS.PushController.create();COS.PushController.initiatePushConnection(SteedOS.pushController);SteedOS.pushController.getBadgeState()},handle503:function(k){var g,h,f;try{g=SC.json.decode(k.get("body"))}catch(j){SC.error("Cannot read DR response")}if(g){for(h in g){if(h.match(/^retry[ _\-]?after$/i)){f=g[h];break}}}if(f){f=parseInt(f,10)}SteedOS.statechart.sendAction("authDRLocked",{retryAfter:f})},checkPreferences:function(g,m){var j=g?g.get("body"):null,k=YES;if(g&&g.get("status")===503){this.handle503(g);k=NO}else{if(j&&j.status!==0){SC.warn("Status of KVS response was not 0")}else{if(!g||g.get("status")!==200){SC.warn("KVS returned invalid response.")}}}if(!k){this.clearUserState();SteedOS.authController.logoutUser(null,YES,YES);return}var l=this.get("accountPreferences"),h=CW.getUrlParameters();if(h.clearprefs){if(confirm("Are you sure you want to clear all preferences?")){COS.prefsController.clearPreferences(function(){document.location=document.location.href.replace("clearprefs","firstrun")})}else{SteedOS.statechart.sendAction("authDidValidate")}}else{if(this.shouldShowFirstRun(l,h)){SteedOS.statechart.sendAction("showFirstRun")}else{SC.debug("Account preferences look good, moving on...");SteedOS.statechart.sendAction("authDidValidate")}}},shouldShowFirstRun:function(c,d){if(CK.get("isDeveloper")){return NO}else{if(!c||!c.get("locale")||(!this.get("isUserRamped")&&!this.get("isUserUnqualified")&&!c.get("timeZone"))){SC.debug("Missing account preferences; let's show first run");return YES}else{if(d.firstrun){SC.debug("First run flag is on, let's show it");return YES}}}return NO},detectRedJello:function(l,j,m){var g=l?l.dsInfo:null,k=g?g.steedosId:null,h=g?g.steedosIdAlias:null;if(j&&!this.steedosIdsAreEqual(j,k,h)){SC.info(SC.json.encode(l));CK.errorCatcher.reportServerError({showDialog:NO,error:'RedJello: %@: client="%@", bag="%@", alias="%@"'.fmt(m,j,k,h)})}},steedosIdsAreEqual:function(f,j,h){f=f?f.toLowerCase():"";j=j?j.toLowerCase():"";h=h?h.toLowerCase():"";var k=f===j||f===h,g;if(!k&&/@(me|mac)\.com$/.test(f)){g=f.replace(/@.*$/,"");k=g===j.replace(/@.*$/,"")||g===h.replace(/@.*$/,"")}return k},clearUserState:function(){var b=arguments.callee.base.apply(this,arguments);CW.notificationCenter.postNotification("willClearUserState");SteedOS.meCardController.reset();this.set("loginPassword","");CK.writeCookie("X-STEEDOS-WEB-ID",null,null,".steedos.com",null,YES);SteedOS.appController.reset();return b},shouldRefreshValidateToken:function(){SteedOS.authController.validateUser(function(){SC.debug("Successfully refreshed the validate token")})},submitSecurityQuestion:function(){this.loginUser(null,null,null,null,false,{dsid:this.get("securityQuestionDSID"),securityQuestion:this.get("securityQuestionText"),securityQuestionAnswer:this.get("securityQuestionAnswer")})}});SteedOS.autoUpdateController=SC.Object.create({init:function(){if(CW.isApp()){this.checkVersion()}this.startAutoUpdateTimer();return arguments.callee.base.apply(this,arguments)},autoUpdateTimer:null,startAutoUpdateTimer:function(){if(this.get("autoUpdateTimer")){return}var b=SC.Timer.schedule({target:this,action:"checkVersion",interval:(SteedOS.AUTO_UPDATE_INTERVAL*1000),repeats:YES});this.set("autoUpdateTimer",b)},checkVersion:function(g){var f=new Date().getTime(),e=CW.getUrlParameters();if(g!==YES&&this._lastCheck+((SteedOS.AUTO_UPDATE_INTERVAL-10)*1000)>f){SC.info("autoUpdate: Already checked %@ms ago, ignoring",(f-this._lastCheck));return}this._lastCheck=f;var h=SC.Request.getUrl("https://steedos.com/system/version.json").json();if(CK.get("isBeta")){h=SC.Request.getUrl("https://beta.steedos.com/system/version.json").json()}if(CK.get("isDeveloper")){h=SC.Request.getUrl("https://developer.steedos.com/system/version.json").json()}h.notify(0,this,function(a){if(e.autoUpdate){SC.warn("autoUpdate: Will simulate response since autoUpdate flag is set.");this.handleVersionResponse("override",parseInt(e.autoUpdate,10));return YES}else{if(a.get("status")!==200){SC.warn("autoUpdate: Could not fetch version.json");return YES}}var d=a.get("body"),c,b;if(d){c=d.buildNumber;b=d.autoUpdate;if(d.registerEnabled){SteedOS.authController.set("registerEnabled",d.registerEnabled)}if(!SC.none(c)&&!SC.none(b)){this.handleVersionResponse(c,parseInt(b,10))}}return YES});h.send()},handleVersionResponse:function(e,c){if(c===SteedOS.UPDATE_IGNORE){SC.debug("autoUpdate: Update flag for %@ is UPDATE_IGNORE",e);return}if(SC.buildNumber===e){SC.debug("autoUpdate: Running latest build, %@",e);return}if(SC.buildNumber>e){SC.debug("autoUpdate: Running newer build than %@",e);return}var f=this;if(c===SteedOS.UPDATE_PROMPT){SC.debug("autoUpdate: Prompt the user to reload to %@",e);if(this._reloadPane&&this._reloadPane.get("isVisibleInWindow")){SC.info("autoUpdate: There is already an auto update alert pane showing, so ignoring request for a second one.");return}this._reloadPane=CW.Alert.show({message:"AutoUpdate.Title".loc(),description:"AutoUpdate.Description".loc(),image:"me-icon-alert-68",rightButton:{title:"AutoUpdate.Reload".loc(),action:function(){f.reloadToBuildNumber(e)}},middleButton:{title:"AutoUpdate.Later".loc(),action:function(){this.get("pane").remove()}}})}if(c===SteedOS.UPDATE_FORCE){SC.debug("autoUpdate: Force the user to reload to %@",e);f.reloadToBuildNumber(e)}if(c===SteedOS.UPDATE_DELAYED_FORCE){SC.debug("autoUpdate: Delay force the user to reload to %@",e);this.reloadIfAppropriate(e);this.invokeLater(function(){this.reloadToBuildNumber(e)},SteedOS.AUTO_UPDATE_DELAYED_FORCE_WAIT*1000)}},reloadIfAppropriate:function(e){var f=SteedOS._lastMouseMoveEpoch,d=(new Date().getTime()-SteedOS._lastMouseMoveEpoch);if(!f||d>60*1000){this.reloadToBuildNumber(e)}else{this.invokeLater(function(){this.reloadIfAppropriate(e)},60*1000)}},reloadToBuildNumber:function(b){CK.setValueInLocalStorage("didReloadToBuild",b,YES);if(CW.isApp()){window.location="https://www.steedos.com"+window.location.search+window.location.hash}else{window.location.reload()}}});SteedOS.mixin({UPDATE_IGNORE:0,UPDATE_PROMPT:1,UPDATE_FORCE:2,UPDATE_DELAYED_FORCE:3});SteedOS.blockInputController=SC.Object.create({showFeedbackAfter:1000,shouldShowFeedback:NO,_userInputWasBlockedAt:0,block:function(){this.set("shouldShowFeedback",NO);this._userInputWasBlockedAt=Date.now();SteedOS.blockInputModalPane.get("modalPane").append();this.invokeLater("showFeedback",this.get("showFeedbackAfter"))},unblock:function(){this._userInputWasBlockedAt=0;SteedOS.blockInputModalPane.get("modalPane").remove()},showFeedback:function(){var b=this._userInputWasBlockedAt;if(b>0&&(this.get("showFeedbackAfter")+b<=Date.now())){this._userInputWasBlockedAt=0;this.set("shouldShowFeedback",YES)}}});require("mixins/notification_support");SteedOS.localizationController=SC.Object.create(SteedOS.NotificationSupport,{_lastPreferredLanguage:null,relocalizeIfNeeded:function(c,d){c=c||"unknown reason"+(d?" that was forced":"");(this._reasons||(this._reasons=[])).push(c);this.invokeOnce(d?"_forceReloc":"_relocalizeIfNeeded")},_forceReloc:function(){this._relocalizeIfNeeded(true)},_relocalizeIfNeeded:function(d){var f=this._reasons.join(", ")||"no reasons known";this._reasons.length=0;var e=d||(String.preferredLanguage!==this._lastPreferredLanguage);SC.debug("Language check: "+this._lastPreferredLanguage+" -> "+String.preferredLanguage+". We "+(e?"WILL":"WILL NOT")+" relocalize.");if(!e){return}this._lastPreferredLanguage=String.preferredLanguage;this.notifySubscribers("relocalize",(d?"FORCED: ":"")+f)}});SteedOS.meCardController=SC.Object.create({NO_PHOTO_SRC:window.devicePixelRatio===2?"../../../../system/steedos/4330/en-us/source/resources/images/no_photo@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/no_photo.png",NO_PHOTO_SMALL_SRC:window.devicePixelRatio===2?"../../../../system/steedos/4330/en-us/source/resources/images/no_photo_small@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/no_photo_small.png",photoChanged:NO,meCardUrl:function(){var b=CK.servicesController.getServiceUrlFor("contacts")+"/co/mecard/";return b}.property(),meCard:null,meCardRequirementSatisfied:NO,imgLoadError:NO,getMeCard:function(g){if(!CK.servicesController.getServiceInfoFor("contacts")){SC.debug("meCardController: not requesting me-card since contacts is disabled.");this.set("meCardRequirementSatisfied",YES);if(g instanceof Function){g(1)}return}var f=this.get("meCardUrl"),h=COS.Request.getUrl(f,null),e=this;h.notify(200,this,function(a){var b=SC.json.decode(a.get("body"));if(!b.contacts){SC.debug("no me-card is set");this.notifyPropertyChange("meCard")}else{SC.debug("me-card received");e.set("meCard",b.contacts[0])}if(g instanceof Function){g(0)}e.set("meCardRequirementSatisfied",YES);return YES});h.notify(0,this,function(a){SC.debug("problem receiving me-card");if(g instanceof Function){g(1)}e.set("meCardRequirementSatisfied",YES);return YES});SC.debug("Sending me card GET request to %@",f);h.send()},storeMeCard:function(v,o){var w=this.get("meCard");if(!CK.servicesController.getServiceInfoFor("contacts")){SC.debug("meCardController: not storing me-card since contacts is disabled.");return}var x=!w,z=x?"POST":"PUT",y=this.get("meCardUrl")+"?method="+z,q=COS.Request.postUrl(y,null),s=this,t,p;t=w?w:{};if(v){for(p in v){if(!v.hasOwnProperty(p)){continue}t[p]=v[p]}}q.notify(200,this,function(a){var b=SC.json.decode(a.get("body"));if(!b.contacts){SC.debug("no me-card is set")}else{SC.debug("me-card received");this.set("meCard",b.contacts[0])}if(o instanceof Function){o(0)}return YES});q.notify(0,this,function(a){SC.debug("problem storing me-card");if(o instanceof Function){o(1)}return YES});if(x){t.contactId=CW.upperCaseUUID();var n=SteedOS.authController.get("user");t.firstName=n.get("firstName");t.lastName=n.get("lastName");t.emailAddresses=[{field:n.get("primaryEmail"),label:"home"}]}var u={contacts:[t]};SC.debug("Sending me card GET request to %@",y);q.send(SC.json.encode(u))},completePhotoPicker:function(c){var d={url:c.photoUrl,crop:c.photoCrop,signature:(c.photoUrl.indexOf("contactsws.steedos.com")===-1?null:this.get("photoSignature"))};this.set("photo",d);if(SC.browser.isIE8OrLower){this.storeMeCard({photo:d},this.meCardPosted);this.set("photoChanged",NO)}else{this.set("photoChanged",YES)}},meCardPosted:function(){SteedOS.meCardController.getMeCard()},validate:function(b){return b&&!b.match(new RegExp("https://contactsws.steedos.com"))&&b.indexOf("data:image/jpeg;base64,")!==0?null:b},photoUrl:function(d,f){if(f!==undefined){var e=this.get("photo");e.url=f}else{return this.validate(this.getPath("photo.url"))||null}}.property("photo"),photoCrop:function(d,f){if(f!==undefined){var e=this.get("photo");e.crop=f}else{return this.getPath("photo.crop")||null}}.property("photo"),photoSignature:function(d,f){if(f!==undefined){var e=this.get("photo");e.signature=f}else{return this.getPath("photo.signature")}}.property("photo"),photo:function(d,f){if(f!==undefined){var e=this.get("meCard");if(e){e.photo=f}else{this._photo=f}}else{return this.getPath("meCard.photo")||this._photo||{}}}.property("meCard"),isPhotoUrlValid:function(){return !this.get("imgLoadError")&&!!this.get("photoUrl")}.property("photoUrl","imgLoadError"),deletePhoto:function(){this.set("photo",null);this.set("photoChanged",YES)},reset:function(){this.set("meCard",null);this.set("meCardRequirementSatisfied",NO);this.set("photoChanged",NO);this.set("currentPhoto",null)},setCurrentPhoto:function(){this.set("currentPhoto",this.get("photo"))},currentPhoto:function(d,c){if(c!==undefined){this._currentPhoto=c}else{return this.get("photoChanged")?this._currentPhoto:this.get("photo")}}.property("photo"),currentPhotoUrl:function(d,f){if(f!==undefined){var e=this.get("currentPhoto");e.url=f}else{return this.validate(this.getPath("currentPhoto.url"))||null}}.property("currentPhoto"),currentPhotoCrop:function(d,f){if(f!==undefined){var e=this.get("currentPhoto");e.crop=f}else{return this.getPath("currentPhoto.crop")||null}}.property("currentPhoto"),resetPhoto:function(){var b=this.get("currentPhoto");if(b){this.set("photo",b);this.set("currentPhoto",null);this.set("photoChanged",NO)}}});SteedOS.motmController=SC.Object.create(SteedOS.NotificationSupport,{IS_DISABLED:NO,subscribesTo:"SteedOS.localizationController".w(),baseUrl:"https://www.steedos.com/user_news/current/",hasFetchedOneMotm:NO,relocalize:function(){if(!this.get("hasFetchedOneMotm")){return}var b=SteedOS.authController.get("accountPreferences");if(b){b.set("lastDismissedMotm",0)}this.invokeLater("fetchMotm",500)},fetchMotmIfFirst:function(){if(!this.get("hasFetchedOneMotm")){this.fetchMotm()}},fetchMotm:function(){if(this.IS_DISABLED){return}if(!SteedOS.authController.get("user")){return}this.set("hasFetchedOneMotm",YES);SC.Request.getUrl(this.get("baseUrl")+CK.getCurrentLocaleInISOFormat()+".json").set("isJSON",YES).notify(this,"didReceiveMotm").send()},didReceiveMotm:function(c){if(c.isError){return}var d=c.get("body");if(d){this._ensureMotmGuid(d);this._motm=d;this.notifySubscribers("performOrScheduleMotmDisplay")}},displayMotm:function(){if(SteedOS.authController.getPath("accountPreferences.lastDismissedMotm")===this._motm.guid){SC.debug("The MOTM with guid="+this._motm.guid+" has already been dismissed. Aborting display of this MOTM.");return}var d=this._showingView;if(d&&d._referenceMotm.guid===this._motm.guid){return}var c=this._createView();this._showingView=c;if(d){d.removeFromParent()}c.append()},_createView:function(){return SteedOS.UserNewsView.create({title:this._motm.title,description:this._motm.description,icon:this.get("baseUrl")+this._motm.imageName,ownerController:this,_referenceMotm:this._motm,didDismiss:function(){this.ownerController.didDismissMotm()}})},didDismissMotm:function(){this._showingView=null;var b=SteedOS.authController.get("accountPreferences");if(b){SC.debug("Recording to preferences as dismissed the MOTM with guid="+this._motm.guid);b.set("lastDismissedMotm",this._motm.guid);b.commit()}},_ensureMotmGuid:function(b){if(!b.guid){b.guid=this._stringTotal(b.title)+this._stringTotal(b.description)+this._stringTotal(b.imageName)}},_stringTotal:function(h){var j=0;h=h.toString();for(var f=0,k,g=h.length;f<g;f++){k=h.charCodeAt(f);if(!isNaN(k)){j+=k*(1+f%4)}}j+=h.length;return j}});SteedOS.notificationCenterDisplayController=SC.Object.create({desiredWidth:SteedOS.NOTIFICATION_CENTER_WIDTH,shouldAnimate:YES,isShowing:NO,duration:function(){return this.get("shouldAnimate")?300:1}.property("shouldAnimate").cacheable(),hide:function(){this.set("desiredWidth",0);this.update()},show:function(){this.set("desiredWidth",SteedOS.NOTIFICATION_CENTER_WIDTH);this.update()},update:function(){}});SteedOS.PushController=SC.Object.extend(SC.DelegateSupport,{getBadgeState:function(){var d=CK.servicesController.getServiceUrlFor("push",NO)+"/getState",e;var f=COS.Request.create({type:"POST",address:d,isJSON:YES});f.notify(200,this,function(q){var s=q.get("body"),a=s?s.states:null;if(!a||a.length===0){SC.warn("There was a problem reading the badge state response.");return}var p,t,u,c,b,n;for(b=0,n=a.length;b<n;b++){t=a[b];p=t.pushTopic;u=SteedOS.appManagersForPushTopic(p)[0];if(!u){continue}c=t.data?t.data.badge:null;if(u&&SC.typeOf(c)===SC.T_NUMBER&&c>-1){u.set("badgeCount",c)}if(t.messages!=null){var o;for(o=0;o<t.messages.length;o++){var v=t.messages[o];CS.store.createRecord(CS.PushMessage,{alertTitle:v.alertTitle,alert:v.alert,appName:u.name})}}}return YES});f.notify(0,this,function(a){SC.warn("%@ received from pushws. Will not retry.",a.get("status"));return YES});e={pushTopics:COS.pushController.get("pushTopics")};f.send(e)},didInitializePush:function(b){},handlePushNotification:function(j,l){var k,h;if(SC.typeOf(j)===SC.T_HASH){k=j}else{try{k=SC.json.decode(j)}catch(g){SC.warn("handlePushNotification(): Exception parsing push notification");return}}if(!k||!(h=k.pushTopic)){SC.warn("Push notification has missing body or topic: %@",j);return}var m=SteedOS.appManagersForPushTopic(h);m.forEach(function(a){this.handlePushNotificationForAppManager(k,j,a,l)},this);if(m.length===0){SC.warn("Push notification has unknown topic: %@",j)}CW.notificationCenter.postNotification("didReceivePushNotification",m.getEach("name"),j)},handlePushNotificationForAppManager:function(w,n,x,s){var q=x.get("name"),t,u,v,p,m;w.omitWhenActive=NO;p=w.badge;if(SC.typeOf(p)===SC.T_NUMBER&&p>-1){x.set("badgeCount",p)}if((!x.get("isActive")||w.omitWhenActive===NO)&&w.alert){u=w.alert;v=w.alertTitle;m=w.sound;if(u||v){this.displayNotification(x,w)}if(!x.get("isActive")&&m){m="push.wav";this.playSound(m)}}if(s){return}if(x.get("isReady")){SC.debug("Handing notification off to %@: %@",q,n);x.passMessage("didReceiveNotification",n)}else{if(!x.get("isReady")){if(x.get("hasPushUI")){if(x.get("isDisabled")){SC.info("Cannot start app %@ since it's disabled",q);return}SC.debug("Starting application %@ as it might need to create a local notification",q);x.set("loadReason",CK.LOAD_REASON_NOTIFICATION);var o=x.get("notificationQueue")||[];o.push(n);x.set("notificationQueue",o);x.set("postDisplayAction",function(){o.forEach(function(a){x.passMessage("didReceiveNotification",n)})});x.invokeLast("getReadyInBackground")}else{SC.debug("Ignoring push for %@",q)}}}},shouldDisplayNotification:function(d){if(CW.isMobile()){return NO}var c=SteedOS.authController.getPath("accountPreferences.viewPushNotifications");if(c&&c[d]===NO){return NO}else{return YES}},displayNotification:function(u,s){var n=u.get("name"),v="Notification.PlaceholderDescription.",o=NO,m,t,q,l;if(!this.shouldDisplayNotification(n)){SC.info("Skipping visual notification for %@ as determined from account preferences",n);return}q=s.alert;if(SC.typeOf(q)===SC.T_HASH){t=q["loc-args"];if(!t||SC.typeOf(t)!==SC.T_ARRAY){SC.warn("loc-args array is missing or malformed: %@",t);return}m=("PushNotification."+n+"."+q["loc-key"]).loc(t[0],t[1],t[2])}else{if(!q&&CK.hasLocalizedStringForKey(v+n)){m=(v+n).loc();o=YES}else{m=q}}l=s.alertTitle||u.get("displayName");var p=CW.iOSNotification.create({message:SC.RenderContext.escapeHTML(l),description:SC.RenderContext.escapeHTML(m),isDismissable:NO,icon:u.get("notificationIcon"),classNames:function(){if(o){return["placeholder-description"]}else{return[]}}(),action:function(a){SteedOS.appController.switchToApplicationWithNotification(n,s,a);a.invokeLater(function(){a.dismiss()},SteedOS.MAX_NOTIFICATION_DISMISSAL_WAIT*1000)}});this.createHTML5NotificationIfAppropriate(null,l,m);SteedOS.iOSNotificationForSpringboard.enqueue(p);return p},createHTML5NotificationIfAppropriate:function(f,e,b){return},requestHTML5NotificationPermission:function(){return},playSound:function(c){if(SC.browser.isIE&&SC.browser.msie<9){SC.warn("audio tag is not supported in IE8");return}var d="../../../../system/steedos/4330/en-us/resources/sounds/push.wav".replace("push.wav",c);SC.info("Inserting audio tag for %@",d);SC.$("body").append('<audio class="notification" src="%@" onended="$(\'audio.notification\').remove()" onstalled="SC.warn(\'Not able to play audio file\');$(\'audio.notification\').remove()" autoplay></audio>'.fmt(d))},activeAppTimer:null,inactiveAppTimer:null,hasPushConnectionBinding:"COS.pushController.hasPushConnection",isRegisteredToAllTopicsBinding:"COS.pushController.isRegisteredToAllTopics",appsMissingPushTopicBinding:"COS.pushController.appsMissingPushTopic",pushTopicsOrHasConnectionDidChange:function(){var b=this.get("hasPushConnection");if(b===YES&&this.get("isRegisteredToAllTopics")&&this.get("appsMissingPushTopic").length===0){this.stopIdleTimers()}else{this.startIdleTimers()}}.observes("hasPushConnection","isRegisteredToAllTopics","appsMissingPushTopic"),startIdleTimers:function(){if(this.get("activeAppTimer")){return}var c=SC.Timer.schedule({target:this,action:"activeAppShouldRefresh",interval:(SteedOS.ACTIVE_IDLE_INTERVAL*1000),repeats:YES});this.set("activeAppTimer",c);var d=SC.Timer.schedule({target:this,action:"inActiveAppsShouldRefresh",interval:(SteedOS.INACTIVE_IDLE_INTERVAL*1000),repeats:YES});SC.debug("Started idle timers");this.set("inactiveAppTimer",d)},stopIdleTimers:function(){var c=this.get("activeAppTimer"),d=this.get("inactiveAppTimer");if(!c&&!d){return}if(c){c.invalidate();this.set("activeAppTimer",null)}if(d){d.invalidate();this.set("inactiveAppTimer",null)}SC.debug("Stopped idle timers")},pushIsActiveForApp:function(c){var d=COS.pushController.get("registeredPushTopics");if(!this.get("hasPushConnection")||!d||d.indexOf(c.get("pushTopic"))===-1){return NO}else{return YES}},activeAppShouldRefresh:function(){var b=SteedOS.appController.getPath("currentApp");if(b&&!this.pushIsActiveForApp(b)){b.passMessage("applicationShouldRefresh",NO)}},inActiveAppsShouldRefresh:function(){var f=SteedOS.appController.get("apps"),e,d;for(e in f){d=f[e];if(d.get("isActive")||this.pushIsActiveForApp(d)){continue}d.passMessage("applicationShouldRefresh",NO)}}});sc_require("core");SteedOS.API={requestStartup:function(){var b=arguments[0];if(b){COS.startupController.requestStartup(b.get("name"))}return this},getCurrentlyActiveApplication:function(){},userIsAuthenticated:function(){return SteedOS.authController.get("isAuthenticated")},sessionIsExtendedLogin:function(){},getUser:function(){},getUrlForServiceName:function(d,c){},getStatusForServiceName:function(d,c){},applicationIsReady:function(){var b=arguments[0];b.didBecomeReady()},startupDataIsLoaded:function(){var b=arguments[0];b.startupDataDidLoad()},showAppSwitcher:function(){SteedOS.statechart.sendAction("appCalledShowAppSwitcher")},showSecondaryAuth:function(){var b=arguments[0];b=SteedOS.appManagerFor(b);if(!b){return}if(!b.get("isActive")){b.set("wantsSecondaryAuth",YES);return}SteedOS.statechart.sendAction("showSecondaryAuth")},performSecondaryAuth:function(h){var g=arguments[0],e=g.get("name");h=arguments[2];var f=SteedOS.authController;f.secondaryLogin(f.get("loginUsername"),h,null,e)},performLogout:function(){SteedOS.authController.logoutUser(function(){window.location.reload()},YES,YES)},redirectTo:function(b){b=arguments[2];window.location.href=b},showHelp:function(c,d){},switchToApplication:function(g,e){var h=arguments[0],f=SteedOS.appManagerFor(arguments[2]);e=arguments[3];if(!h||!h.get("isActive")){SC.debug("%@ is not allowed to switch to a different app while in background",h.get("name"));return}else{if(!f){SC.debug("Cannot switch to unknown app %@",g);return}}f.set("route",e);f.set("loadReason",CK.LOAD_REASON_APP_SWITCH);SteedOS.appController.set("pendingApp",f);SteedOS.statechart.sendAction("appCalledSwitchToApplication")},getAppLoadReason:function(){},mailTo:function(h,k,g,j,f){},setRoute:function(d){var c=arguments[0];d=arguments[2];if(!c){return}c.set("route",d)},getRoute:function(){},getAccountPreferences:function(){},setAccountPreferences:function(a){var b=COS.authController.get("accountPreferences");if(!b){SC.warn("No account preferences object exists when trying to store prefs!");return}if(a.locale){b.set("locale",a.locale)}if(a.timeZone){b.set("timeZone",a.timeZone)}if(a.timezoneName){b.set("timezoneName",a.timezoneName)}b.commit()},getAppPreferences:function(b){},setAppPreferences:function(h,g){var e=arguments[0],f=e.get("name");h=SC.clone(arguments[2],YES);g=arguments[3];COS.prefsController.savePreferences(f,h,g)},refreshAppPreferences:function(f){var d=arguments[0],e=d.get("name");COS.prefsController.getPreferences(e,f)},setStartupUrl:function(d){var f=arguments[0],e=f.get("name");d=arguments[2];if(!d){CW.fatalError("SteedOS.setStartupUrl():  You need to provide a url to set")}COS.startupController.setStartupUrl(e,d)},getRequestedStartupUrl:function(){},getEnvironment:function(){},getValidateToken:function(){},setTitle:function(c){var d=arguments[0];c=arguments[2];if(d){d.set("title",c)}},reload:function(){var b=arguments[0];SteedOS.appController.reloadApplication(b.get("name"))},exit:function(f,d){var e=arguments[0];f=arguments[2];d=arguments[3];if(f===undefined){SC.warn("statusCode must be provided for exit()");return}this.invokeLast(function(){SteedOS.appController.exitApplication(e.get("name"),f,d)})},showLocalNotification:function(s){var t=arguments[0],k=t.get("pushTopic"),p,o,q,n,l,m;s=arguments[2];if(SC.typeOf(s)===SC.T_STRING){p=arguments[2];o=arguments[3];q=arguments[4];n=arguments[5];l=arguments[6];m=YES}else{p=s.alertTitle;o=s.alert;q=s.actionPayload;n=s.badgeCount;l=s.soundPath;m=s.omitWhenActive!==undefined?s.omitWhenActive:YES}SteedOS.pushController.handlePushNotification({pushTopic:k,alert:o,alertTitle:p,badge:n,sound:l,steedos:q,omitWhenActive:m},YES)},setBadgeCount:function(d){var c=arguments[0];d=arguments[2];if(SC.typeOf(d)===SC.T_NUMBER&&d>-1){c.set("badgeCount",d)}},handleApplicationCrash:function(g,h){var e=arguments[0],f=e.get("name");g=arguments[2];h=arguments[3];g=g?SC.clone(g,NO):{};g.applicationName=f;if(h){g.log=h}COS.handleApplicationCrash(g)},didReceiveSpecialResponse:function(h,g,c){if(SC.typeOf(h)!==SC.T_NUMBER){h=arguments[2];g=arguments[3];c=arguments[4]}var e;switch(h){case 330:SteedOS.authController.validateUser(function(){SteedOS.appController.userDidRevalidate()});break;case 401:try{e=SC.json.decode(ret)}catch(j){}if(e&&e.error===11){SteedOS.authController.validateUser(function(){SteedOS.appController.userDidRevalidate()})}else{SteedOS.authController.logoutUser(function(){window.location.reload()},YES,YES)}break;case 403:window.location.hash="#showlogin";window.location.reload();break;case 503:SteedOS.statechart.sendAction("showServiceLocked",c);break}},requestSent:function(){if(this._outstandingRequests===undefined){this._outstandingRequests=0}this._outstandingRequests++},requestReceived:function(){this._outstandingRequests--},relayKeyboardShortcut:function(e,f,d){CW.performKeyEquivalent(d)},relayMouseMove:function(f,d,e){SteedOS._lastMouseMoveEpoch=new Date().getTime()},meCardUpdated:function(){SC.debug("meCardUpdated(), will grab latest version...");SteedOS.meCardController.getMeCard()},getActiveXFileVersion:function(){},getId:function(){return COS.authController.generateId(COS.authController.get("user"))},getClientId:function(){},isReadyToTerminateDidChange:function(){},windowApplicationHasInitialized:function(){},appWillUnload:function(d){var c=arguments[0];d=arguments[2];if(d){SC.info("appWillUnload: CK.WindowApplication for %@ was closed",c.get("name"));c.set("windowApplication",null);return}if(!SteedOS._receivedBeforeUnload){if(SteedOS.appController.get("currentApp")===c){SC.info("appWillUnload: Reloading application, most likely because user chose to Reload Frame");SteedOS.appController.reloadApplication(c.get("name"))}else{SC.error("appWillUnload: Application is in background, and this should NOT be happening");c.teardown()}}}};SteedOS._cloudOSAPIMethodNames=function(){var d=[],c;for(c in SteedOS.API){if(SteedOS.API.hasOwnProperty(c)){d.push(c)}}return d}();SteedOS.mixin(SteedOS.API);SteedOS.mixin(CK.SteedOSGetterSupport);sc_require("steedos_api");(function(){var g,k,l,j,n;if(CK.isDeveloper||SC.buildMode==="debug"){SteedOS.displayAppsAll=[{name:"workflow",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon_notification.png"},{name:"chat",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon_notification.png"},{name:"creator",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/database_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/database_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/database_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/database_icon_notification.png"},{name:"tasks",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/tasks_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/tasks_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/tasks_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/tasks_icon_notification.png"},{name:"admin",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon.png",}]}else{if(CK.isBeta){SteedOS.displayAppsAll=[{name:"workflow",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon_notification.png"},{name:"creator",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/database_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/database_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/database_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/database_icon_notification.png"},{name:"chat",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon_notification.png"},{name:"admin",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon_notification.png"}]}else{SteedOS.displayAppsAll=[{name:"workflow",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/workflow_icon_notification.png"},{name:"creator",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/database_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/database_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/database_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/database_icon_notification.png"},{name:"chat",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/chat_icon_notification.png"},{name:"admin",icon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon.png",notificationIcon:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon_notification@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/admin_icon_notification.png"}]}}var m=window.URI.parseQuery(window.URI().query());var h;if(m.apps){SteedOS.displayApps=[];h=m.apps.split(",");for(i=0;app=SteedOS.displayAppsAll[i];i++){if(h.contains(app.name)){SteedOS.displayApps.push(app)}}}else{SteedOS.displayApps=SteedOS.displayAppsAll}var o={maskAsset:SC.browser.isIE8OrLower?"../../../../system/steedos/4330/en-us/source/resources/images/mask_ie8.png":"../../../../system/steedos/4330/en-us/source/resources/images/mask.png",warningArrowAsset:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/warning_arrow@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/warning_arrow.png",shadowAsset:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/shadow@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/shadow.png",focusAsset:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/app_icon_ring@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/app_icon_ring.png",spinnerAsset:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/spinner@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/spinner.png",decorShadowAsset:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/decor_shadow@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/decor_shadow.png",minWidth:1,minHeight:1,isQualifiedForDeveloper:YES,isQualifiedForBeta:YES,isDeveloper:YES,};SteedOS.defaultAppOptions=o;for(n in o){for(l=0;k=SteedOS.displayApps[l];l++){if(!k.hasOwnProperty(n)){k[n]=o[n]}}}if(!SC.browser.msie||SC.browser.msie>=9){SC.mixin(g,{_appendCanvas:!!SC.browser.msie,init:function(){this.staticIcon="_Springboard.CalendarTileStatic.Asset".loc();this.icon="_Springboard.CalendarTile.Asset".loc();arguments.callee.base.apply(this,arguments)},relocalize:function(){arguments.callee.base.apply(this,arguments);this.staticIcon="_Springboard.CalendarTileStatic.Asset".loc();this.set("icon","_Springboard.CalendarTile.Asset".loc())},iconDidLoad:function(){var b=this._iconAssetVessel,a=this._iconCanvas||(this._iconCanvas=document.createElement("canvas")),c=this._iconContext||(this._iconContext=a.getContext("2d"));a.width=a.height=(142*window.devicePixelRatio);if(this._appendCanvas&&this.get("iconElement")!==a){this.set("iconElement",a)}this._paintIconAndSchedule(true)},_paintIconAndSchedule:function(b){try{this._ensureIconHasPaintedToday(undefined,b);var f=new Date()*1,c=new Date().getTimezoneOffset()*60000,e=Math.ceil((f-c)/86400000)*86400000-(f-c),d=this;if(this._daySwitchTimeout){clearTimeout(this._daySwitchTimeout)}this._daySwitchTimeout=setTimeout(function(){d._paintIconAndSchedule(false,true)},e+1)}catch(a){this._revertToStaticIcon()}},_revertToStaticIcon:function(){var a=new Image();a.src=this.get("staticIcon");this.set("iconElement",a);if(this._iconCanvas.parentNode){this._iconCanvas.parentNode.removeChild(this._iconCanvas)}},_ensureIconHasPaintedToday:function(x,y){var d;window.cb=this;if(!x){x=new Date()}var a,v;if(typeof x==="number"){a=0;v=x.toString()}else{a=x.getDay();v=x.getDate().toString()}if(!y&&this._lastPaintedDow===(this._lastPaintedDow=a)&&this._lastPaintedDate===(this._lastPaintedDate=v)){return}var u=this._iconAssetVessel,z=this._iconCanvas,w=this._iconContext;if(!u._isDownloaded||!u.width||!u.height){SC.debug(d="Calendar tile sprite is not downloaded. Reverting to static sprite.");throw d}z.width=0+z.width;this.drawBase();this.drawDayOfWeek(a);this.drawDayNumber(v);if(!this._appendCanvas){var f=this.get("iconElement");if(!f){f=new Image();f.owner=this;f.onload=function(){this.owner.set("iconElement",this)}}f.src=z.toDataURL()}else{if(z.toDataURL().length<5*1024){var e=5,c=50,B="_triesFor_"+a+"_"+tensDigit+onesDigit,b=this[B]||(this[B]=e+1);this[B]--;if(!b){SC.debug(d="Calendar tile sprite drawing resulted in a blank, transparent canvas in _appendCanvas mode. No retries remaining. Now reverting to static sprite.");throw d}else{SC.debug("Calendar tile sprite drawing resulted in a blank, transparent canvas in _appendCanvas mode. Trying again. Retries remaining: "+b);this.invokeLater("_paintIconAndSchedule",c,true,true)}}}},drawBase:function(){var a=0,b=100*window.devicePixelRatio,d=142*window.devicePixelRatio,c=d;this._iconContext.drawImage(this._iconAssetVessel,a,b,d,c,0,0,d,c)},drawDayOfWeek:function(a){var b=216*window.devicePixelRatio,c=(117*window.devicePixelRatio)+(30*window.devicePixelRatio*a),e=142*window.devicePixelRatio,d=30*window.devicePixelRatio;this._iconContext.drawImage(this._iconAssetVessel,b,c,e,d,0,5*window.devicePixelRatio,e,d)},drawDayNumber:function(x){var F=this.get("_iconNumeralMetrics"),B=this._iconNumeralTop,a=this._iconNumeralBottom,w=this._iconNumeralOffsets,y=x.length===2,C=parseInt(x.charAt(x.length-1),10),c=y?parseInt(x.charAt(0),10):"0",e=F[C][1]-F[C][0],D=y?F[c][1]-F[c][0]:0,d=(e+D),b=y?this._iconNumeralKern:0,f=Math.round((72*window.devicePixelRatio)-d/2)+w[c],z=f+D+b*window.devicePixelRatio,E=a-B;this._iconContext.drawImage(this._iconAssetVessel,F[C][0],B,e,E,z,56*window.devicePixelRatio,e,E);if(y){this._iconContext.drawImage(this._iconAssetVessel,F[c][0],B,D,E,f,56*window.devicePixelRatio,D,E)}},_iconNumeralMetrics:function(){var a=[[20,68],[74,115],[123,170],[177,225],[231,280],[287,335],[341,389],[395,445],[451,500],[506,554]];return a.map(function(b){return[b[0]*window.devicePixelRatio,b[1]*window.devicePixelRatio]})}.property().cacheable(),_iconNumeralKern:6,_iconNumeralTop:14*window.devicePixelRatio,_iconNumeralBottom:89*window.devicePixelRatio,_iconNumeralOffsets:[0,-4,-2,-2,0,0,0,0,0,0]})}else{SC.mixin(g,{init:function(){this.icon="_Springboard.CalendarTileStatic.Asset".loc();arguments.callee.base.apply(this,arguments)},relocalize:function(){arguments.callee.base.apply(this,arguments);this.set("icon","_Springboard.CalendarTileStatic.Asset".loc())}})}})();sc_require("core");SteedOS.moduleLocalizer={localizedModules:["cloudkit/error_catcher","cloudkit/photo","cloudkit/photo/photoPicker","coreweb/timezone_picker","steedos/account","steedos/language","steedos/alarms"],_defaultLocale:String.preferredLanguage,_locale:"en-us",_previousLocale:null,setLocale:function(d){if(!d){if(CW.getUrlParameters().locale){d=String.preferredLanguage}else{d=SteedOS.authController.getPath("accountPreferences.locale")}if(SteedOS.supportedLocales.indexOf(d)===-1){SC.debug("%@ is not in the set of supported locales, reverting to en-us.",d);d="en-us"}}if(this._locale===d||!d){return NO}this._previousLocale=this._locale;this._locale=d;String.preferredLanguage=d;var c=this._monkeyPatchModules();SC.Locale.createCurrentLocale();$(document.body).removeClass(this._defaultLocale).removeClass(this._previousLocale).addClass(this._locale);return c},_monkeyPatchModules:function(){var m=SC.MODULE_INFO,o=this.localizedModules,j,k=o.length,p,n,q,l=NO;for(j=0;j<k;j++){p=o[j];n=SC.MODULE_INFO[p];if(!n){continue}q=this._updateURL(n.stringURL);if(q!==n.stringURL){n.stringURL=q;n.scriptURL=this._updateURL(n.scriptURL);this._unloadModule(p,n);l=YES}}return l},_unloadModule:function(d,f){f.isLoaded=NO;f.isReady=NO;f.isWaitingForRunLoop=NO;f.source=undefined;if(f.isPrefetched){var e=SC.Module.PrefetchModuleTask.create({prefetchedModuleName:d});SC.backgroundTaskQueue.push(e)}},_updateURL:function(b){return b.replace(this._defaultLocale,this._locale).replace(this._previousLocale,this._locale)}};SteedOS.RegisterUIState=SC.State.extend({initialSubstate:"downloadingAccountCenterModule",downloadingAccountCenterModule:SC.State.design({enterState:function(b){SC.Module.loadModule("coresteed/account",this,"moduleDidBecomeReady",b)},moduleDidBecomeReady:function(a,b){CS.AccountCenter.loadRegister()}})});SteedOS.WaitingForAppState=SC.State.extend({succeededState:"active.application",disabledState:"active.desiredAppDisabled",failedState:"active.appLoadFailure",abortedState:"active.springboard",shouldForceDelegateMethods:NO,enterState:function(){var d=SteedOS.appController.get("loadingApp"),f=SteedOS.appController.get("pendingApp"),e;if(f&&d===f){SC.info("We are already waiting for %@ to load",f.get("name"));return}if(d){SteedOS.appController.loadingApp.teardown()}this._app=f;if(f&&f.requiresMailAndIsMissing()){e=f.get("name");CW.Alert.show({message:"Error.MailNotEnabled.%@.Title".fmt(e).loc(),description:"Error.MailNotEnabled.%@.Description".fmt(e).loc(),rightButton:"Button.OK".loc()});this.gotoState(this.abortedState);return}if(!f||f.get("isDisabled")){this.gotoState(this.disabledState);return}if(f.get("isFailed")){this.applicationDidFailToBecomeReady();return}if(f.get("isReady")){this.applicationDidBecomeReady(true)}else{SteedOS.appController.set("loadingApp",f);f.invokeLast("getReady")}},abortLoad:function(){if(SteedOS.appController.get("loadingApp")){SteedOS.appController.loadingApp.teardown()}this.gotoState(this.abortedState)},exitState:function(){},applicationDidFailToBecomeReady:function(){SteedOS.appController.set("loadingApp",null);this.gotoState(this.failedState)},applicationDidBecomeReady:function(b){SteedOS.appController.set("loadingApp",null);SteedOS.appController.set("currentApp",this._app);SteedOS.appController.activateCurrentApp(this.get("shouldForceDelegateMethods"));return this.gotoState(this.succeededState)},gotoState:function(){if(this._gotoStateTimer){this._gotoStateTimer.invalidate()}this._gotoStateTimer=null;return arguments.callee.base.apply(this,arguments)},appMustExit:function(m,n){var k=this._app;if(m===CK.EXIT_NON_FATAL){this.gotoState(this.abortedState);k.teardown();return}if(k&&k.get("loadInBackground")){SC.info("Not showing error dialog since app would load in background");k.teardown();return}var j=k.get("name"),l="AppTitle.%@".fmt(j).loc(),o,h;if(m===CK.EXIT_STARTUP_ERROR){o="Error.AppNotLoading.Title".loc(l);h="Error.AppNotLoading.Description".loc()}else{o="Error.AppCrashed.Title".loc(l);h="Error.AppCrashed.Description".loc()}this.gotoState(this.abortedState);CW.Alert.show({message:o,description:h,middleButton:{title:"Error.Button.Report".loc(),action:function(){this.getPath("pane.modalPane").set("paneFadeOutDuration",0);this.get("pane").remove();SteedOS.appController.showErrorReporter(k,n)}},rightButton:{title:"Button.OK".loc(),action:function(){this.getPath("pane.modalPane").set("hideDelay",10);this.get("pane").remove();k.teardown()}}})},showServiceLocked:function(b){this.gotoState("serviceLocked",b)},init:function(){var g="appCalledShowAppSwitcher appCalledSwitchToApplication appMustReload appMustExit appMustExitSilently showSecondaryAuth".w(),h,f,e;for(f=0;h=g[f];f++){e=function(){var a=arguments.callee.state._app;if(!a){return}a.set("preDisplayAction",arguments.callee.actionName);a.set("preDisplayActionArgs",SC.$A(arguments))};e.actionName=h;e.state=this;if(!this[h]){this[h]=e}}arguments.callee.base.apply(this,arguments)}});SteedOS.WaitingForDefaultAppState=SteedOS.WaitingForAppState.extend({disabledState:"active.allAppsDisabled"});sc_require("states/register_ui");sc_require("states/waiting_for_app");SteedOS.statechart=SC.Statechart.create({trace:YES,monitorIsActive:NO,name:"steedos-statechart",rootState:SC.State.design({initialSubstate:"loading",loading:SC.State.design({enterState:function(){var b=function(){CK.writeCookie("COS_BOOTSTRAP_COOKIE_TEST","1");return CK.readCookie("COS_BOOTSTRAP_COOKIE_TEST")==="1"};if(!navigator.cookieEnabled&&!b()){this.gotoState("cookiesDisabled")}else{if(!SteedOSBootstrap.isBrowserVersionAtLeast({safari:5,mobilesafari:0,firefox:5,chrome:12,ie:9,otherwise:true})){this.gotoState("browserWarning")}else{this.gotoState("validatingAuth")}}}}),cookiesDisabled:SC.State.design({enterState:function(){window.location="http://www.steedos.com/enable_cookies"}}),browserWarning:SC.State.design({enterState:function(){var b=CK.getValueFromLocalStorage("skipBrowserReminder");if(!b){SteedOS.workspaceController.removeRHTMLSpinner();CW.Alert.show({message:"Error.UnsupportedBrowser.Title".loc(),description:"Error.UnsupportedBrowser.Description".loc(),middleButton:{title:"Error.UnsupportedBrowser.Ignore".loc(),action:function(){this.get("pane").remove();CK.setValueInLocalStorage("skipBrowserReminder",true);SteedOS.statechart.gotoState("validatingAuth")}},rightButton:{title:"Error.UnsupportedBrowser.LearnMore".loc(),action:function(){this.get("pane").remove();window.open("Error.UnsupportedBrowser.LearnMore.URL".loc());SteedOS.statechart.gotoState("validatingAuth")}}})}else{this.gotoState("validatingAuth")}}}),validatingAuth:SC.State.design({initialSubstate:"gettingReply",gettingReply:SC.State.design({enterState:function(){if(window.location.hash==="#showlogin"){this.gotoState("active.authUI");window.location.hash="";return}else{if(window.location.hash==="#register"){this.gotoState("active.registerUI");window.location.hash="";return}}var b=SteedOS.authController;b.validateUser(b.checkPreferences)},authDidValidate:function(){SteedOS.moduleLocalizer.setLocale();SC.Module.loadModule("steedos/language",this,"languageDidLoad");SteedOS.runWhenReady(function(){if(CK.isDeveloper){return}SteedOS.statechart.sendAction("loadAlarms")})},languageDidLoad:function(){SteedOS.localizationController.relocalizeIfNeeded("Validated Auth and Received Language");SteedOS.runWhenReady(SteedOS.motmController,"fetchMotmIfFirst");var b=SteedOS.appController.getDefaultApp();if(!b||window.location.hash==="#springboard"){this.gotoState("active.springboard")}else{b.set("loadReason",CK.LOAD_REASON_LOCATION_HASH);SteedOS.appController.set("pendingApp",b);this.gotoState("validatingAuth.waitingForApp")}},authDidNotValidate:function(){this.gotoState("active.authUI")},authDidNotValidateLocked:function(){this.gotoState("active.authUI")},authDidNotValidateSupportLocked:function(){this.gotoState("active.authUI")},authDidNotValidateNotSteedOSUser:function(){this.gotoState("active.authUI")},authDidNotValidateNotVerified:function(){this.gotoState("active.authUI")},authDidNotValidateNotBetaQualified:function(){this.gotoState("active.authUI")},authDidNotValidateNotDeveloperQualified:function(){this.gotoState("active.authUI")},authDidNotValidateAccountClosed:function(){this.gotoState("active.authUI")},authDidNotValidateExpiredPassword:function(){this.gotoState("active.authUI")},authDidNotValidateOffline:function(){this.gotoState("active.authUI")},authDidNotConnect:function(){this.gotoState("active.authUI")},authDRLocked:function(){this.gotoState("active.authUI")},showFirstRun:function(){this.gotoState("active.authUI.downloadingAuthModule",{loadFirstRun:YES})}}),waitingForApp:SteedOS.WaitingForDefaultAppState.design({})}),active:SC.State.design({initialSubstate:"authUI",authUI:SC.State.plugin("SteedOS.AuthUIState"),registerUI:SC.State.plugin("SteedOS.RegisterUIState"),application:SC.State.plugin("SteedOS.ApplicationState"),springboard:SC.State.plugin("SteedOS.SpringboardState"),secondaryAuth:SC.State.plugin("SteedOS.SecondaryAuthState"),showSecondaryAuth:function(b){this.gotoState("active.secondaryAuth",b)},allAppsDisabled:SC.State.design({enterState:function(){this.gotoState("active.springboard")}}),desiredAppDisabled:SC.State.design({enterState:function(){var f=SteedOS.appController.get("pendingApp");if(f){var e="AppTitle.%@".fmt(f.get("name")).loc();if(f.get("isUnqualified")){var d=f.get("name")==="mail"?"Error.AppUnqualified.Description.mail".loc():"Error.AppUnqualified.Description.others".loc(e);CW.Alert.show({message:("Error.AppUnqualified.Title").loc(e),description:d,rightButton:"Button.OK".loc()})}else{if(f.get("isRamped")){CW.Alert.show({message:("Error.AppRamped.Title").loc(e),description:"Error.AppRamped.Description".loc(),rightButton:"Button.OK".loc()})}}}this.gotoState("active.springboard")}}),appLoadFailure:SC.State.design({enterState:function(){this.gotoState("active.springboard");var h=SteedOS.appController.get("pendingApp"),g=h.get("name");var j="AppTitle.%@".fmt(g).loc();h.set("isWaiting",NO);var f=h.get("postDisplayAction");h.set("postDisplayAction",undefined);if(f){f.apply(this)}if(h.get("loadInBackground")){SC.info("Not showing error dialog since app would load in background");h.teardown();return}var k="Error.AppNotLoading.Title".loc(j);if(CK.stringIsCJK(j)){k=k.replace(/ /g,"")}CW.Alert.show({message:k,description:"Error.AppNotLoading.Description".loc(),middleButton:{title:"Error.Button.Report".loc(),action:function(){this.getPath("pane.modalPane").set("paneFadeOutDuration",0);this.get("pane").remove();SteedOS.appController.showErrorReporter(h,null,NO);h.teardown()}},rightButton:{title:"Button.OK".loc(),action:function(){this.getPath("pane.modalPane").set("hideDelay",10);this.get("pane").remove();h.teardown()}}})}}),reloadApp:function(){this.gotoState("active.springboard.waitingForApp")}})})});SteedOS.SecondaryAuthState=SC.State.design({enterState:function(d){var f=this,e=SteedOS.appController.getPath("currentApp.name")||null;this._options=d||null;SteedOS.notifyDialogAboveApp();this.authAlert=CW.iOSAlert.show({message:"Auth.Secondary.Title".loc(),description:SteedOS.authController.getPath("user.steedosId"),alertPaneDidDismiss:function(){SteedOS.notifyRemovalOfDialogAboveApp()},extraView:SC.TextFieldView.extend({paneDidChange:function(){this.becomeFirstResponder()}.observes("pane"),classNames:["secondary-auth"],layout:{height:30},isPassword:YES,hint:"Auth.Secondary.Hint".loc(),hintOnFocus:YES,didCreateLayer:function(){this.invokeLater(function(){try{this.$input()[0].focus()}catch(a){}},50)}}),extraViewPaddingTop:6,extraViewPaddingBottom:6,buttons:[{title:"Button.Cancel".loc(),action:function(){this.get("pane").dismiss();f.userDidCancel()},isCancel:YES},{title:"Button.OK".loc(),isDefault:YES,action:function(){var b=this.get("pane").$("input")[0],a=b.value;var c=SteedOS.authController;c.secondaryLogin(c.get("loginUsername"),a,c.get("isExtendedLogin"),e,function(k){var j=k.get("status")===200?"authDidValidate":"authDidNotValidate";SteedOS.statechart.sendAction(j)});b.value="";this.get("pane").dismiss()}}]})},appCalledShowAppSwitcher:function(){if(this.authAlert){this.authAlert.get("pane").dismiss()}if(this.validationAlert){this.validationAlert.get("pane").dismiss()}if(this.connectionAlert){this.connectionAlert.get("pane").dismiss()}this.gotoState("active.springboard")},authDidValidate:function(){var c=this._options,d=c?c.successState:this.successState;if(d){SteedOS.statechart.gotoState(d)}if(c&&c.successCallback){c.successCallback.apply(c.target)}},userDidCancel:function(){var c=this._options,d=c?c.cancelState:this.cancelState;if(d){SteedOS.statechart.gotoState(d)}if(c&&c.cancelCallback){c.cancelCallback.apply(c.target)}},authDidNotValidate:function(){var b=this;this.validationAlert=CW.iOSAlert.show({message:"Error.AuthDidNotValidate.Title".loc(),description:"Error.AuthDidNotValidate.Description".loc(),buttons:[{title:"Error.AuthDidNotValidate.iForgot".loc(),action:"iForgot"},{title:"Button.OK".loc(),action:function(){b.gotoState(b,b._options);this.get("pane").dismiss()},isDefault:YES,isCancel:YES}],iForgot:function(){window.open("Error.AuthDidNotValidate.iForgot.URL".loc())}})},authNotValidEvents:function(){SteedOS.authController.logoutUser(function(){window.location.reload()},YES,YES)}.handleEvents("authDidNotValidateNotSteedOSUser","authDidNotValidateLocked","authDidNotValidateNotBetaQualified","authDidNotValidateNotVerified","authDRLocked"),authDidNotConnect:function(){var b=this;this.connectionAlert=CW.iOSAlert.show({message:"Error.AuthDidNotConnect.Title".loc(),description:"Error.AuthDidNotConnect.Description".loc(),buttons:[{title:"Error.AuthDidNotConnect.Support".loc(),action:"support"},{title:"Button.OK".loc(),action:function(){b.gotoState(b,b._options);this.get("pane").dismiss()},isDefault:YES,isCancel:YES}],support:function(){window.open("Error.AuthDidNotValidate.iForgot.URL".loc())}})}});sc_require("states/waiting_for_app");sc_require("states/auth_secondary");SteedOS.ApplicationState=SC.State.extend({initialSubstate:"displayingCurrentApp",isReentering:NO,enterState:function(){SteedOS.notificationCenterDisplayController.hide();SteedOS.workspaceController.notifySubscribers("springboardMayProceed");SteedOS.workspaceController.removeRHTMLSpinner();SteedOS.workspaceController.set("nowShowing",SteedOS.APP)},displayingCurrentApp:SC.State.design({enterState:function(){this.get("parentState").set("isReentering",NO);var e=SteedOS.appController.get("currentApp");if(!e){SC.info("currentApp is not set! Return to springboard.");this.gotoState("active.springboard");return}var d=e.get("preDisplayAction"),f=e.get("preDisplayActionArgs");e.set("preDisplayAction",undefined);e.set("preDisplayActionArgs",undefined);if(d){this[d].apply(this,f)}SteedOS._executeReadyQueue()},appCalledShowAppSwitcher:function(){this.invokeLater(function(){SteedOS.autoUpdateController.checkVersion()},1000);this.gotoState("active.springboard")},appCalledSwitchToApplication:function(){this.gotoState("active.application.waitingForNewApp")},globalAppSwitchWasRequested:function(){if(SteedOS.appController.get("currentApp")===SteedOS.appController.get("pendingApp")){SC.info("Already waiting for app to load");return}this.gotoState("active.application.waitingForNewApp")},appMustReload:function(b){this.gotoState("active.springboard",b)},appMustExit:function(n,o){if(this._exitPane&&this._exitPane.get("isVisibleInWindow")){SC.warn("There is already an app exit alert pane showing, so ignoring request for a second one.");return}var p=SteedOS.appController.get("currentApp");if(n===CK.EXIT_NON_FATAL){this.gotoState("active.springboard");p.teardown();return}if(p&&p.get("loadInBackground")){SC.info("Not showing error dialog since app would load in background");p.teardown();return}var k=p.get("name"),l=this,m="AppTitle.%@".fmt(k).loc(),q,j;if(n===CK.EXIT_STARTUP_ERROR){q="Error.AppNotLoading.Title".loc(m);j="Error.AppNotLoading.Description".loc()}else{q="Error.AppCrashed.Title".loc(m);j="Error.AppCrashed.Description".loc()}this._exitPane=CW.Alert.show({message:q,description:j,middleButton:{title:"Error.Button.Report".loc(),action:function(){this.getPath("pane.modalPane").set("paneFadeOutDuration",0);this.get("pane").remove();SteedOS.appController.showErrorReporter(p,o)}},rightButton:{title:"Button.OK".loc(m),action:function(){this.getPath("pane.modalPane").set("hideDelay",10);this.get("pane").remove();l.gotoState("active.springboard");p.teardown()}}})},appMustExitSilently:function(){this.gotoState("active.springboard")},showSecondaryAuth:function(){this.gotoState("active.application.secondaryAuth")},showServiceLocked:function(b){this.gotoState("serviceLocked",b)},}),waitingForNewApp:SteedOS.WaitingForAppState.design({shouldForceDelegateMethods:YES,enterState:function(){arguments.callee.base.apply(this,arguments);SteedOS.blockUserInput()},appCalledSwitchToApplication:function(){this.gotoState("active.application.waitingForNewApp")},globalAppSwitchWasRequested:function(){if(SteedOS.appController.get("pendingApp")===this._app){SC.info("Already waiting for app to load");return}this.gotoState("active.application.waitingForNewApp")},appCalledShowAppSwitcher:function(){this.gotoState("active.springboard")},exitState:function(){arguments.callee.base.apply(this,arguments);this.get("parentState").set("isReentering",YES);SteedOS.unblockUserInput()}}),secondaryAuth:SC.State.plugin("SteedOS.SecondaryAuthState",{successState:"active.application.displayingCurrentApp",cancelState:"active.springboard"}),serviceLocked:SC.State.plugin("SteedOS.ServiceLockedState"),exitState:function(){if(!this.get("isReentering")){SteedOS.appController.deactivateCurrentApp()}SteedOS.focus()}});sc_require("states/waiting_for_app");SteedOS.AuthUIState=SC.State.extend({initialSubstate:"downloadingAuthModule",downloadingAuthModule:SC.State.design({enterState:function(b){SC.Module.loadModule("steedos/auth_ui",this,"authDidBecomeReady",b);SC.Module.loadModule("coresteed/account",this,"accountDidBecomeReady",b)},accountDidBecomeReady:function(a,b){SteedOS.set("isAccountModuleReady",YES)},authDidBecomeReady:function(j,k){var g=SteedOS.authController;g.set("isAuthenticated",NO);var f=this.statechart.getState("firstRun");if(f){var h=f.get("substates").getEach("name");if(h.indexOf("accountPhotoPicker")===-1){f.addSubstate("accountPhotoPicker",CK.Photo.photoPicker)}}else{SC.error("first Run State not found")}SteedOS.workspaceController.set("nowShowing",SteedOS.AUTH);if(k&&k.loadFirstRun){g.set("isAuthenticating",YES);this.invokeLater(function(){this.gotoState("firstRun")},50)}else{this.gotoState("fieldsEditable")}}}),fieldsEditable:SC.State.design({enterState:function(){SteedOS.authController.set("isSpinning",NO);SteedOS.authController.set("areFieldsEditable",YES);SteedOS.authController.invokeLater("notifySubscribers",300,"focusCorrectField");SteedOS.authController.notifySubscribers("cancelSecurityQuestion")},userDidSubmit:function(){var b=SteedOS.authController;b.loginUser(b.get("loginUsername"),b.get("loginPassword"),b.get("isExtendedLogin"),b.checkPreferences);b.set("isSpinning",YES);SteedOS.authController.set("areFieldsEditable",NO);this.gotoState("attemptIsSubmitted")},firstRun:function(){}}),securityQuestionEditable:SC.State.design({enterState:function(){SteedOS.authController.notifySubscribers("showSecurityQuestion")},userDidSubmit:function(){SteedOS.authController.submitSecurityQuestion();this.gotoState("attemptIsSubmitted")}}),attemptIsSubmitted:SC.State.design({authDidValidate:function(){SteedOS.moduleLocalizer.setLocale();SC.Module.loadModule("steedos/language",this,"languageDidLoad");SteedOS.runWhenReady(function(){if(CK.isDeveloper){return}SteedOS.statechart.sendAction("loadAlarms")})},languageDidLoad:function(){SteedOS.localizationController.relocalizeIfNeeded("Signin Submission Succeeded and Language Loaded");SteedOS.runWhenReady(SteedOS.motmController,"fetchMotmIfFirst");var b=SteedOS.appController.getDefaultApp();if(!b){this.gotoState("active.springboard")}else{SteedOS.appController.set("pendingApp",b);this.gotoState("active.authUI.waitingForApp")}},authDidNotValidate:function(){SteedOS.authController.set("isSpinning",NO);this.gotoState("fieldsEditable");SteedOS.authController.invokeLater("notifySubscribers",20,"showIForgotDialog");SteedOS.authController.invokeLater("notifySubscribers",20,"shake")},authDidNotValidateSecurityQuestionRequired:function(){SteedOS.authController.set("isSpinning",NO);this.gotoState("securityQuestionEditable")},authDidNotValidateNotSteedOSUser:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateNotSteedOSUser.Title".loc(),description:"Error.AuthDidNotValidateNotSteedOSUser.Description".loc(),middleButton:"Button.Close".loc(),rightButton:{title:"Error.AuthDidNotValidateNotSteedOSUser.LearnMore".loc(),action:"move"},fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},move:function(){window.open("Error.AuthDidNotValidateNotSteedOSUser.LearnMore.URL".loc())}})},authDidNotValidateNotBetaQualified:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateNotBetaQualified.Title".loc(),description:"Error.AuthDidNotValidateNotBetaQualified.Description".loc(),middleButton:"Button.Close".loc(),rightButton:{title:"Error.AuthDidNotValidateNotBetaQualified.LearnMore".loc(),action:"learnMore"},fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},learnMore:function(){window.open("Error.AuthDidNotValidateNotBetaQualified.LearnMore.URL".loc())}})},authDidNotValidateNotDeveloperQualified:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateNotDeveloperQualified.Title".loc(),description:"Error.AuthDidNotValidateNotDeveloperQualified.Description".loc(),middleButton:"Button.Close".loc(),rightButton:{title:"Error.AuthDidNotValidateNotDeveloperQualified.LearnMore".loc(),action:"learnMore"},fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},learnMore:function(){window.open("Error.AuthDidNotValidateNotDeveloperQualified.LearnMore.URL".loc())}})},authDidNotValidateLocked:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateLocked.Title".loc(),description:"Error.AuthDidNotValidateLocked.Description".loc(),middleButton:{title:"Error.AuthDidNotValidateLocked.Reset".loc(),action:"reset"},rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},reset:function(){window.open("Error.AuthDidNotValidateLocked.Reset.URL".loc())}})},authDidNotValidateSupportLocked:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateSupportLocked.Title".loc(),description:"Error.AuthDidNotValidateSupportLocked.Description".loc(),middleButton:{title:"Error.AuthDidNotValidateSupportLocked.Support".loc(),action:"support"},rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},support:function(){window.open("Error.AuthDidNotValidateSupportLocked.URL".loc())}})},authDidNotValidateNotVerified:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateNotVerified.Title".loc(),description:"Error.AuthDidNotValidateNotVerified.Description".loc(SteedOS.authController.getPath("user.primaryEmail")),rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")}})},authDidNotValidateExpiredPassword:function(b){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateExpiredPassword.Title".loc(),description:"Error.AuthDidNotValidateExpiredPassword.Description".loc(),middleButton:{title:"Error.AuthDidNotValidateExpiredPassword.Support".loc(),action:"support"},rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},support:function(){window.open("Error.AuthDidNotValidateExpiredPassword.Support.URL".loc())}})},authDidNotValidateAccountClosed:function(b){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateAccountClosed.Title".loc(),description:"Error.AuthDidNotValidateAccountClosed.Description".loc(),rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")}})},authDidNotValidateOffline:function(b){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotValidateOffline.Title".loc(),description:"Error.AuthDidNotValidateOffline.Description".loc(),rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")}})},authDidNotConnect:function(){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Error.AuthDidNotConnect.Title".loc(),description:"Error.AuthDidNotConnect.Description".loc(),middleButton:{title:"Error.AuthDidNotConnect.Support".loc(),action:"support"},rightButton:"Button.OK".loc(),leftButton:{title:"Error.Button.Report".loc(),action:function(){this.getPath("pane.modalPane").set("paneFadeOutDuration",0);this.get("pane").remove();CK.errorCatcher.reportServerError({applicationName:"steedos",error:"authDidNotConnect"})}},fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")},support:function(){window.open("Error.AuthDidNotConnect.Support.URL".loc())}})},authDRLocked:function(b){SteedOS.authController.set("isSpinning",NO);CW.Alert.show({message:"Auth.Locked.Title".loc(),description:SteedOS.lockedAlertDescription("Auth.Locked.Description.",b.retryAfter),rightButton:"Button.OK".loc(),fromState:this,remove:function(){arguments.callee.base.apply(this,arguments);this.fromState.gotoState("fieldsEditable")}})},showFirstRun:function(){this.gotoState("active.authUI.firstRun")}}),firstRun:SC.State.design({substatesAreConcurrent:YES,enterState:function(){SteedOS.authController.notifySubscribers("hideSecurityQuestion");if(CK.ActiveXView.needsActiveX()){var b=AuthUI.ActiveXView.create();b.createLayer();document.body.appendChild(b.get("layer"));this._activeX=b}},exitState:function(){if(this._activeX){document.body.removeChild(this._activeX.get("layer"))}},defaultState:SC.State.design({enterState:function(){SC.Module.loadModule("steedos/account",this,"moduleDidBecomeReady")},moduleDidBecomeReady:function(){SteedOS.authController.set("isSpinning",NO);SteedOS.AccountSettings.loadFirstRunView()},userDidSubmit:function(){SteedOS.AccountSettings.submitPrefsAndMeCard();SteedOS.moduleLocalizer.setLocale();SC.Module.loadModule("steedos/language",this,"languageDidLoad")},languageDidLoad:function(){SteedOS.localizationController.relocalizeIfNeeded("User Changed Language during FirstRun and Language Loaded");SteedOS.runWhenReady(SteedOS.motmController,"fetchMotmIfFirst");this.gotoState("active.springboard")},deletePhoto:function(){SteedOS.meCardController.deletePhoto()},activeXFileDropped:function(b){CW.notificationCenter.postNotification("activeXFileDropped",b)},activeXFileDragged:function(b){CW.notificationCenter.postNotification("activeXFileDragged",b)},activeXFileDragEnded:function(){CW.notificationCenter.postNotification("activeXFileDragEnded")}})}),waitingForApp:SteedOS.WaitingForDefaultAppState.design({}),exitState:function(){SteedOS.authController.invokeLater("set",1000,"isSpinning",NO);SteedOS.authController.invokeLater("set",1000,"loginPassword","")}});SteedOS.ForgotPasswordUIState=SC.State.extend({initialSubstate:"downloadingAccountCenterModule",downloadingAccountCenterModule:SC.State.design({enterState:function(b){SC.Module.loadModule("coresteed/account",this,"moduleDidBecomeReady",b)},moduleDidBecomeReady:function(a,b){CS.AccountCenter.loadForgotPassword()}})});SteedOS.ServiceLockedState=SC.State.design({enterState:function(t){var q=this,p=t?t.retryAfter:null,l=SteedOS.appController,s=l.get("currentApp")||l.get("pendingApp"),n=s.get("name"),o=("AppTitle."+n).loc(),k="Service.Locked.Title".loc({appName:o}),m=SteedOS.lockedAlertDescription("Service.Locked.Description.",p,o);SteedOS.notifyDialogAboveApp();this.gotoState("active.springboard");s.teardown();CW.Alert.show({message:k,description:m,rightButton:{title:"Button.OK".loc(),action:function(){this.get("pane").remove();SteedOS.notifyRemovalOfDialogAboveApp();s.set("isDisabled",YES);if(p){s.invokeLater(function(){this.set("isDisabled",NO)},p*1000)}}}})}});sc_require("states/waiting_for_app");SteedOS.SpringboardState=SC.State.extend({initialSubstate:"displayingSpringboard",enterState:function(b){SteedOS.notificationCenterDisplayController.hide();SteedOS.workspaceController.set("nowShowing",SteedOS.SPRINGBOARD);SteedOS.workspaceController.notifySubscribers("springboardMayProceed");SteedOS._executeReadyQueue();SteedOS.workspaceController.set("hash","");if(b instanceof Function){b()}},displayingSpringboard:SC.State.design({initialSubstate:"springboard",springboard:SC.State.design({userDidChooseApp:function(){SteedOS.appController.get("pendingApp").set("loadInBackground",NO);this.gotoState("active.springboard.waitingForApp")},globalAppSwitchWasRequested:function(){this.gotoState("active.springboard.waitingForApp")},appCalledSwitchToApplication:function(){this.gotoState("active.springboard.waitingForApp")},showAccountSettings:function(){SteedOS.blockUserInput();SC.Module.loadModule("steedos/auth_ui",this,"accountSettingsCanNowLoad")},accountSettingsCanNowLoad:function(){SC.Module.loadModule("steedos/account",this,"loadAccountSettingsAndUnblock")},loadAccountSettingsAndUnblock:function(){var d=this.statechart.getState("AccountSettingsOpen");if(d){var c=d.get("substates").getEach("name");if(c.indexOf("accountPhotoPicker")===-1){d.addSubstate("accountPhotoPicker",CK.Photo.photoPicker)}}else{SC.error("Unable to locate Account Settings State")}SteedOS.AccountSettings.loadAccountSettings();SteedOS.unblockUserInput()},loadAlarms:function(){},logout:function(){try{CK.clearSessionStorage();SteedOS.authController.logoutUser(function(){var a=window.location.toString();if(a.indexOf("#")===a.length-1){window.location=a.substring(0,a.length-1)}else{window.location.reload()}},YES,YES);SteedOS.blockUserInput()}catch(b){SC.Logger.error("Error during Signout: "+b)}},accountSettingsOpen:function(){this.gotoState("AccountSettingsOpen")}}),AccountSettingsOpen:SC.State.design({substatesAreConcurrent:YES,enterState:function(){if(CK.ActiveXView.needsActiveX()){var b=AuthUI.ActiveXView.create();b.createLayer();document.body.appendChild(b.get("layer"));this._activeX=b}SteedOS.meCardController.setCurrentPhoto()},exitState:function(){if(this._activeX){document.body.removeChild(this._activeX.get("layer"))}},defaultState:SC.State.design({removePaneWithoutSaving:function(){SteedOS.AccountSettings.removePaneWithoutSaving();this.gotoState("springboard")},removePane:function(c,d){SteedOS.AccountSettings.removePane();this.gotoState("springboard")},help:function(){SteedOS.showHelp(true)},deletePhoto:function(){SteedOS.meCardController.deletePhoto()},activeXFileDropped:function(b){CW.notificationCenter.postNotification("activeXFileDropped",b)},activeXFileDragged:function(b){CW.notificationCenter.postNotification("activeXFileDragged",b)},activeXFileDragEnded:function(){CW.notificationCenter.postNotification("activeXFileDragEnded")}})})}),waitingForApp:SteedOS.WaitingForAppState.design({userDidChooseApp:function(){SteedOS.appController.get("pendingApp").set("loadInBackground",NO);this.gotoState("active.springboard.waitingForApp")},globalAppSwitchWasRequested:function(){if(SteedOS.appController.get("pendingApp")===this._app){SC.info("Already waiting for app to load");return}this.gotoState("active.springboard.waitingForApp")},appCalledSwitchToApplication:function(){this.gotoState("active.springboard.waitingForApp")},logout:function(){this.abortLoad();SteedOS.statechart.sendAction("logout")},showAccountSettings:function(){this.abortLoad();SteedOS.statechart.sendAction("showAccountSettings")}}),exitState:function(){}});SteedOS.IsShowingSupport={firstIsShowing:NO,displayKeys:null,nowShowing:null,_isShowingSupport_nowShowingObserver:function(){for(var j=NO,m=this.get("displayKeys"),l=this.get("nowShowing"),n=0,o;o=m[n];n++){if(l===o){j=YES}}var k=this._lastIsShowing;if(k===undefined){k=this.get("firstIsShowing")}if(j===k){return}this._lastIsShowing=j;if(!j){this.set("isShowing",NO);if(this._showTimer){this._showTimer.invalidate();this._showTimer=null}this.hide()}else{var h=SteedOS.workspaceController.get("nextShowDelayTime");if(!h){this.set("isShowing",YES);this.show()}else{this._showTimer=this.invokeLater(function(){this.set("isShowing",YES);this.show()},h)}SteedOS.workspaceController.set("nextShowDelayTime",0)}}.observes("nowShowing"),initMixin:function(){if(this.displayKey){this.displayKeys=[this.displayKey]}this.isShowing=this.firstIsShowing;if(!this.show){this.show=this._default_isShowing_show}if(!this.hide){this.hide=this._default_isShowing_hide}},_default_isShowing_show:function(){this.set("isVisible",YES)},_default_isShowing_hide:function(){this.set("isVisible",NO)}};SteedOS.keyResponder=SC.Object.create(CW.KeyResponder,{keyboardShortcuts:{shift_escape:"showAppSwitcher",ctrl_shift_l:"reloadCurrentApplication",ctrl_shift_p:"refreshCurrentApplication",ctrl_shift_w:"exitCurrentApplication",ctrl_shift_1:"open1",ctrl_shift_2:"open2",ctrl_shift_3:"open3",ctrl_shift_4:"open4",ctrl_shift_5:"open5"},showAppSwitcher:function(){SteedOS.showAppSwitcher()},reloadCurrentApplication:function(){var b=SteedOS.appController.get("currentApp");if(b){SteedOS.appController.reloadApplication(b.get("name"))}},exitCurrentApplication:function(){var b=SteedOS.appController.get("currentApp");if(b){SteedOS.appController.exitApplication(b.get("name"),CK.EXIT_NON_FATAL)}},refreshCurrentApplication:function(){var b=SteedOS.appController.get("currentApp");if(b){b.passMessage("applicationShouldRefresh",YES)}},open1:function(){SteedOS.openApp(1-1)},open2:function(){SteedOS.openApp(2-1)},open3:function(){SteedOS.openApp(3-1)},open4:function(){SteedOS.openApp(4-1)},open5:function(){SteedOS.openApp(5-1)}});SteedOS.Paneness={isPaneAttached:YES,init:function(){arguments.callee.base.apply(this,arguments);this.invokeOnce("_paneness_checkInitialState")},_paneness_checkInitialState:function(){var f=this.get("parentView"),d=this.get("usualParent"),e=this.get("isPaneAttached");if(!f){this.set("isPaneAttached",e=NO)}if(!d&&f){this.set("usualParent",d=f)}if(!e&&f){f.removeChild(this)}if(e&&d&&d!==f){if(f){f.removeChild(this)}d.appendChild(this)}},append:function(){var f=this.get("parentView"),d=this.get("usualParent");if(!d){return}if(f===d){return}if(f&&f!==d){this.removeFromParent()}var e=d.appendChild(this);this.set("isPaneAttached",YES);return e},appendTo:SC.RunLoop.wrapFunction(function(b){this.set("usualParent",b);return this.append()}),remove:function(){var b=this.removeFromParent();this.set("isPaneAttached",NO);return b}};SC.RootResponder.reopen({focus:function(e){SC.debug("SteedOS window received focus event");if(!this.get("hasFocus")){SC.$("body").addClass("sc-focus").removeClass("sc-blur");if(!SC.TABBING_ONLY_INSIDE_DOCUMENT&&SC.browser.isIE8OrLower){var f=SC.RootResponder.responder.get("keyPane");if(f){var g=f.get("nextValidKeyView");if(g){f.makeFirstResponder(g)}}}SC.run(function(){this.set("hasFocus",YES)},this)}if(SteedOS.shouldAppHaveFocus()){var h=SteedOS.appController.get("currentApp");if(h){SC.debug("Active app "+h.get("name")+" focusing")}}else{SteedOS.workspaceController.notifySubscribers("windowDidFocus")}return YES},blur:function(b){SteedOS.workspaceController.notifySubscribers("windowDidBlur");return YES}});var accountRenderDelegate={render:function(){},update:function(){}};SteedOS.AccountSignoutHelpView=SC.View.extend({layout:{right:5,top:15-9,centerY:0,height:28,zIndex:100},childViews:function(){var a="signOut help".w();if(!CK.isDeveloper&&!SteedOS.isMobile()){a.unshift("account")}return a}(),classNames:"account-signout-help".w(),render:function(a){if(CK.isDeveloper||SteedOS.isMobile()){return}a.push('<div class="separator"></div>')},didCreateLayer:function(){this.update()},update:function(){var a=this.get("layer");var d=this.$(".separator");this._seps=d},performLayout:function(){if(!this._seps||CK.isDeveloper||SteedOS.isMobile()){return}var e=this.signOut.get("calculatedWidth")||200;var f=this.signOut.get("layout").right||0;var a=e+f+11;this._seps[0].style.right=a+"px";this.account.adjust("right",e+f+25);this.invokeLast("calculateWidth")}.observes(".signOut.calculatedWidth"),calculateWidth:function(){var a=this.account.get("layout");if(!a||!a.width||!a.right){return}this.adjust("width",a.right+a.width||200)}.observes(".account.calculatedWidth"),account:SC.ButtonView.extend(SC.AutoResize,{renderDelegate:accountRenderDelegate,layout:{height:28,top:0},classNames:"account-button".w(),titleBinding:"SteedOS.authController*user.displayName",autoResizeLayer:function(){return this.$(".title")[0]}.property("layer"),autoResizeText:function(){return this.get("title")}.property("title"),supportsAutoResize:YES,displayProperties:"photoUrl photoCrop".w(),photoUrlBinding:"SteedOS.meCardController.currentPhotoUrl",photoCropBinding:"SteedOS.meCardController.currentPhotoCrop",init:function(){arguments.callee.base.apply(this,arguments);CW.notificationCenter.subscribeToNotification("willClearUserState",this,"disconnectDisplayProperties")},disconnectDisplayProperties:function(){this.get("photoUrlBinding").disconnect();this.get("photoCropBinding").disconnect()},autoResizePadding:{width:37,height:0},renderDelegate:{render:function(a,c){c.push('<div class="title"></div><div class="photo-frame"></div><div class="photo-container"></div>')},update:function(j,h){if(CK.isDeveloper||SteedOS.isMobile()){return}h.find(".title")[0].innerHTML=j.get("title");var l=h.find("img")[0],a=h.find(".photo-container")[0],m=j.get("photoUrl"),k=j.get("photoCrop");if(l&&l._src!==m){if(l.parentNode){l.parentNode.removeChild(l)}l=null}if(!l&&m){l=new Image();l.onerror=function(){jQuery(a).addClass("no-photo")};l.onload=function(){jQuery(a).removeClass("no-photo");if(!l.parentNode){a.appendChild(l)}if(!k){l.style.cssText="position:absolute; left:0px; top:0px; width:22px; height:22px;"}else{l.style.cssText="position:absolute; left:"+Math.round(-k.x*22/k.width)+"px; top:"+Math.round(-(l.height-k.y-k.height)*22/k.height)+"px; width:"+Math.round(l.width*22/k.width)+"px; height:"+Math.round(l.height*22/k.height)+"px;"}};l._src=m;l.src=m}if(!l&&!m){jQuery(a).addClass("no-photo")}}},action:function(){}}),signOut:SC.ButtonView.extend(SC.AutoResize,SteedOS.NotificationSupport,{layout:{right:28,height:28,top:0},init:function(){window.signout=this;arguments.callee.base.apply(this,arguments)},classNames:"signout-button".w(),subscribesTo:"SteedOS.localizationController".w(),relocalize:function(){this.set("title","Springboard.AccountAlert.SignOut".loc());this.renderDelegate.update(this,this.$())},autoResizeLayer:function(){return this.get("layer")}.property("layer"),autoResizeText:function(){return this.get("title")}.property("title"),supportsAutoResize:YES,renderDelegate:{render:function(a,c){},update:function(d,f){var a=f&&f[0];if(!a){return}a.innerHTML=d.get("title")}},action:function(){SteedOS.showAppSwitcher();this.invokeLater(function(){SteedOS.statechart.sendAction("logout")})}}),help:SC.ImageButtonView.extend(SteedOS.NotificationSupport,{isVisible:!(CW.isiOSApp()),layout:{right:0,top:0,width:28,height:28},classNames:"help-button".w(),subscribesTo:"SteedOS.localizationController".w(),relocalize:function(){this.set("toolTip","AuthFooter.Help.Text".loc())},action:function(){SteedOS.showHelp(true)}}),});SteedOS.AppsContainerView=SC.View.extend(CW.Animatability,{layout:{zIndex:100,left:0,right:0},classNames:"apps-container-view overflow-visible".w(),isOnscreen:NO,isOnscreenBinding:"SteedOS.workspaceController.applicationIsOnscreen",notificationIsOnscreenBinding:"SteedOS.workspaceController.notificationIsOnscreen",wantsAcceleratedLayer:NO,displayProperties:["isOnscreen"],update:function(){window.appsView=this;var j=this.get("isOnscreen"),k=document,h=k.body,l=k.documentElement,c=window.innerWidth||l.clientWidth||h.clientWidth,m=window.innerHeight||l.clientHeight||h.clientHeight,n;if(j){this.set("layout",{top:0,bottom:0,zIndex:100})}else{this.set("layout",{top:-10000,height:m,zIndex:100})}if(j){this.layoutAppForShow()}},didCreateLayer:function(){this.update()},layoutAppForShow:function(g){var e,d;if(!(g||(g=this._currentApp))||!(e=g.get("view"))){return}if(!(d=e.get("layer"))){return}var f=0;d.style.cssText="top:"+f+"px; width:100%; height:100%; z-index:10; position:absolute;";d.setAttribute("height","100%")},layoutAppForHide:function(l){var q,p;if(!(q=l.isAppFrameView?l:l.get("view"))){return}if(!(p=q.get("layer"))){return}var m=document,k=m.body,n=m.documentElement,h=window.innerWidth||n.clientWidth||k.clientWidth,o=window.innerHeight||n.clientHeight||k.clientHeight;p.style.cssText="top:-10000px; width:"+h+"px; height:"+o+"px; z-index:10; position:absolute;";p.setAttribute("width","");p.setAttribute("height","")},addAppFrame:function(b){this.appendChild(b);this.invokeLater(function(){this.layoutAppForHide(b)})},removeAppFrame:function(b){if(b&&b.get("parentView")===this){this.removeChild(b)}if(b===this._currentView){this._currentApp=this._currentView=null}},showApp:function(c,d){if(c===true&&d===undefined){d=true;c=undefined}if(!c&&!(c=this._currentApp)){return}if(this._currentApp!==c){this.hideApp(d);this._currentApp=c;if(d){this._currentApp.ensureWillBecomeActive()}this._currentView=c.get("view");if(d){this._currentApp.ensureDidBecomeActive()}if(d){this._currentApp.focus()}}this.layoutAppForShow();this._currentApp.focus()},hideApp:function(c,d){if(c===true&&d===undefined){d=true;c=undefined}if(!c&&!(c=this._currentApp)){return}if(d){c.ensureWillSuspend()}this.layoutAppForHide(c);if(c===this._currentApp){this._currentApp=null;this._currentView=null}if(d){c.ensureDidSuspend()}},show:function(){var c={opacity:{from:0,to:1}},d=SteedOS.workspaceController.get("isGPUEnabled");if(d&&SteedOS.ENABLE_TRANSFORM_ANIMATIONS&&SteedOS.ENABLE_SCALE_ANIMATION){c.scale={to:1,from:0}}this.set("isOnscreen",YES);this.invokeLast(function(){this.animate(c,this.gpuLayerFunctions,{duration:800*SteedOS.ENABLE_APP_ANIMATION*d,onstart:function(){this.view.showAnimationDidBegin()},onfinish:function(){this.view.showAnimationDidComplete()}})})},hide:function(){var c={opacity:0},d=SteedOS.workspaceController.get("isGPUEnabled");if(d&&SteedOS.ENABLE_TRANSFORM_ANIMATIONS&&SteedOS.ENABLE_SCALE_ANIMATION){c.scale=0}this.animate(c,this.gpuLayerFunctions,{duration:600*SteedOS.ENABLE_APP_ANIMATION*d,onstart:function(){this.view.hideAnimationDidBegin()},onfinish:function(){this.view.hideAnimationDidComplete();this.view.set("isOnscreen",NO)}})},gpuLayerFunctions:(SteedOS.ENABLE_TRANSFORM_ANIMATIONS&&SteedOS.ENABLE_APP_ANIMATION)?{addLayer:function(){this.view.set("wantsAcceleratedLayer",YES&&SteedOS.workspaceController.get("isGPUEnabled"))}.listens("start"),removeLayer:function(){this.view.set("wantsAcceleratedLayer",NO)}.listens("finish")}:{},showAnimationDidComplete:function(){if(this._currentApp){this._currentApp.ensureDidBecomeActive();this._currentApp.focus()}SteedOS.workspaceController.set("applicationIsFullwindow",YES)},showAnimationDidBegin:function(){if(this._currentApp){this._currentApp.ensureWillBecomeActive()}},hideAnimationDidComplete:function(){if(this._currentApp){this._currentApp.ensureDidSuspend()}this.hideApp()},hideAnimationDidBegin:function(){if(this._currentApp){this._currentApp.ensureWillSuspend()}SteedOS.workspaceController.set("applicationIsFullwindow",NO)}});SteedOS.AppFrameView=SC.View.extend({tagName:"iframe",classNames:["app-frame"],useStaticLayout:YES,isAppFrameView:YES,minWidth:0,minHeight:0,app:null,render:function(g){var j=this.get("app"),h=j.get("route"),l=h?"#"+h:"",m=window.location.search,k;m=URI(m||"?").addSearch("isLoadedBySteedOS","true");if(CK.isDeveloper){m=m.addSearch(Math.random()+"","0")}k=j.get("path")+m+l;g.attr("src",k);g.attr("title",j.get("displayName"));g.attr("name",j.get("name"));g.attr("tabindex","-1");g.attr("frameBorder",0);SC.debug("Created iframe for %@",k)},update:function(){},didCreateLayer:function(){var b=this.getPath("app.name");SC.Benchmark.start(b);SC.Benchmark.start("Waiting for iframe to load",b);SC.Event.add(this.get("layer"),"load",this,this._iframeDidLoad)},_iframeDidLoad:function(){var k=this.get("contentWindow"),j=this.get("app"),f=j.get("name"),g=j.get("loadReason"),h;if(k){SC.Benchmark.end("Waiting for iframe to load",f);SC.Benchmark.start("Waiting for application to become visible",f);j.set("isLoaded",YES);j.passMessage("_applicationShouldInvokeMain",SteedOS._cloudOSAPIMethodNames,COS.cloudOSStateForApp(f),g,j.benchmarks());SC.Benchmark.start("Waiting for startup data",f);if(j.get("startupDataHasBeenLoaded")){SC.Benchmark.end("Waiting for startup data",f)}}else{SC.warn("contentWindow was not found no the iframe for %@",f);j.set("isFailed",YES);SteedOS.statechart.sendAction("applicationDidFailToBecomeReady")}},contentWindow:function(){var b=this.get("layer");if(b){return b.contentWindow}else{return null}}.property().cacheable(),destroy:function(){if(this.get("layer")){this.get("layer").src="about:blank;"}return arguments.callee.base.apply(this,arguments)},focus:function(){var g=this.get("contentWindow"),e=this.get("app"),f=e.get("name");if(!g){return}try{SC.debug("Now focusing %@ for application %@",g,f);g.focus();e.passMessage("_hasReceivedFocus")}catch(h){SC.error("Focusing failed for %@.  Exception text: %@",f,h)}}});SteedOS.BackgroundViewAbstract=SC.View.extend({layout:{left:0,top:0,right:0,bottom:0,minHeight:SteedOS.MIN_HEIGHT,minWidth:SteedOS.MIN_WIDTH,zIndex:1},width:null,height:null,srcs:null,html:"<img>",classNames:"background-view".w(),fade:YES,persistOnGPU:NO,ariaHidden:YES,init:function(){window.bg=this;arguments.callee.base.apply(this,arguments)},render:function(b){b.push(this.html)},update:function(){},initialCSS:function(){var c=this._element,d=c.style;d.position="absolute";d.zIndex=50;d.left=d.top="50%";d.marginLeft=Math.round(this.width/-2)+"px";d.marginTop=Math.round(this.height/-2)+"px";d.width=this.width+"px";d.height=this.height+"px";if(this.fade){d.webkitTransform="translate3d(0,0,0)";CW.Anim.setOpacity(c,0)}else{if(!SC.browser.msie||SC.browser.msie>=9){d.display="none"}}if(this.customCSS){this.customCSS(c)}},didCreateLayer:function(){this._layer=this.get("layer");this._element=this._layer.childNodes[0];this.preloadImages();if(this.initialRendering){this.initialRendering()}this.initialCSS();this.update()},preloadImages:function(){var n=this.srcs,k={},l,o=this,m=SC.browser.msie&&SC.browser.msie<=8;this._srcCount=0;var h=function(){o.imageDidLoad(this)};for(var j in n){if(!n.hasOwnProperty(j)){continue}this._srcCount++;l=this.mainSrc===j?this._element:new Image();if(!m){l.onload=h}l.key=j;l.src=l._src_=n[j];k[j]=l}if(m){for(j in k){if(!k.hasOwnProperty(j)){continue}h.apply(k[j])}}},imageDidLoad:function(f){var d=this.assets;if(!d){this.assets=d={}}d[f.key]=f;this._srcCount--;var e=this;if(this._srcCount===0){SC.run(function(){e.allImagesDidLoad()})}},allImagesDidLoad:function(){if(this.willBecomeVisible){this.willBecomeVisible()}if(this.fade){return CW.Anim.Fader.create({element:this._element,owner:this,to:1,duration:SC.browser.msie?0:1000,killGPULayer:this.persistOnGPU?null:function(){this.element.style.webkitTransform=""}.listens("finish"),tellDone:function(){if(this.owner.didBecomeVisible){this.owner.didBecomeVisible()}}.listens("finish")}).start()}else{this._element.style.display="";if(this.didBecomeVisible){this.didBecomeVisible()}}},removeGPULayerOnInvisible:function(){if(!this.fade||!this.persistOnGPU||this.get("isVisibleInWindow")){return}this._element.style.webkitTransform=""}.observes("isVisibleInWindow")});if(true){SteedOS.BackgroundView=SteedOS.BackgroundViewAbstract.extend({width:1792,height:1280,fade:!SC.browser.isIE8OrLower,html:"<div></div>",backgroundColor:"#0A0A0A",srcs:{tile:window.devicePixelRatio===2?"../../../../system/steedos/4330/en-us/source/resources/images/bg_wood@2x.jpg":"../../../../system/steedos/4330/en-us/source/resources/images/bg_wood.jpg",radial:window.devicePixelRatio===2?"../../../../system/steedos/4330/en-us/source/resources/images/bg_radial@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/bg_radial.png"},willBecomeVisible:function(){this._element.style.background="url("+this.srcs.tile+")";if(this.assets&&this.assets.radial&&!this.assets.radial.parentNode){this._element.appendChild(this.assets.radial);this.assets.radial.style.cssText="position:absolute; z-index:10; left:0px; width:"+this.width+"px; height:"+this.height+"px; top:0px;"}}})}else{SteedOS.BackgroundView=SteedOS.BackgroundViewAbstract.extend(SteedOS.NotificationSupport,{width:1792,height:1280,tileWidth:493,tileHeight:138,backgroundColor:"#0A0A0A",srcs:{tile:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/bg_wood@2x.jpg":"../../../../system/steedos/4330/en-us/source/resources/images/bg_wood.jpg"},FALLBACK_RADIAL_ASSET:window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/bg_radial@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/bg_radial.png",pixelRatio:window.devicePixelRatio>1?2:1,html:SC.browser.webkit?'<div style="background:-webkit-canvas(canvasbg);"></div>':"<canvas></canvas>",initialRendering:function(){var c=this._element,d=SC.browser.webkit?document.getCSSCanvasContext("2d","canvasbg",this.width*this.pixelRatio,this.height*this.pixelRatio):c.getContext("2d");this.can=c;this.con=d;c.style.backgroundSize=(this.width)+"px "+(this.height)+"px";c.style.width=(c.width=this.width)+"px";c.style.height=(c.height=this.height)+"px"},subscribesTo:"SteedOS.workspaceController".w(),willBecomeVisible:function(){try{var e=this.assets.tile,G=this.can,L=this.con,g=this.tileWidth,K=this.tileHeight,E=this.width,y=this.height,J=0,M=new Date*1,N=this.pixelRatio,F,H;g*=N;K*=N;E*=N;y*=N;var B=document.createElement("canvas"),D=B.getContext("2d"),I=g*1,C=K*5;B.width=I;B.height=C;for(F=0;F<I;F+=g){for(H=0;H<C;H+=K){D.drawImage(e,F,H,g,K);J++}}for(F=0;F<E;F+=I){for(H=0;H<y;H+=C){L.drawImage(B,F,H,I,C);J++}}B=document.createElement("canvas");B.width=E;B.height=y;B.style.width="100%";B.style.height="100%";D=B.getContext("2d");D.save();D.scale(1,y/E);var x=D.createRadialGradient(E/2,E/2,0,E/2,E/2,E/2);x.addColorStop(0,"transparent");x.addColorStop(0.2,"transparent");x.addColorStop(1,"#0a0a0a");D.fillStyle=x;D.fillRect(0,0,E,E);D.restore();D.globalCompositeOperation="destination-out";D.save();D.translate(-(650/600-1)*E/2,0);D.scale(650/600,1);x=D.createRadialGradient(E/2,y/2,0,E/2,y/2,600/2);x.addColorStop(0,"#0a0a0a");x.addColorStop(1,"transparent");D.fillStyle=x;D.fillRect(E/2-600/2,y/2-600/2,600,600);D.restore();L.drawImage(B,0,0);this._hasPainted=YES;SC.debug("Spent "+(new Date()*1-M)+"ms painting the background canvas, which, in addition to the radial gradient, required "+J+" drawImage calls for the tiles.")}catch(w){SC.debug("Exception while attempting to painting background image in canvas: falling back to two-piece image-tag radial with tiling background-image. Exception: "+w);if(this._layer){var h=this.can.style.cssText;this.can.width=this.can.height=1;this._layer.innerHTML='<img src="'+this.FALLBACK_RADIAL_ASSET+'">';this._element=this._layer.firstChild;this.initialCSS();this._element.style.background="url("+this.srcs.tile+")"}}}})}SteedOS.BadgeContainerView=SC.ContainerView.extend(SteedOS.Paneness).extend(CW.Animatability,CW.SpritePreloadEnforcement,CW.PaneAnimationSupport,{layout:{centerX:-2,centerY:50,width:508,height:528},contentLayout:{left:94,width:326,top:44,height:340,zIndex:5},classNames:"badge-container-view".w(),centerY:0,contentView:null,contentViewChanged:function(){this.setContentLayout()}.observes("contentView"),setContentLayout:function(){var b=this.get("contentView");if(!b){return}b.set("layout",this.get("contentLayout"))},render:function(b){this.setContentLayout();b.push('<div class="background-lighting" aria-hidden="true"></div><div class="background" aria-hidden="true"></div>')},didCreateLayer:function(){this._bgLighting=this.$(".background-lighting")[0]},update:function(){},isFront:YES,wantsFlip:NO,shouldFlip:function(){return this.get("wantsFlip")&&SteedOS.ENABLE_TRANSFORM_ANIMATIONS}.property("wantsFlip").cacheable(),showDuration:function(){return this.get("shouldFlip")?1000:1500}.property(),hideDuration:function(){return this.get("shouldFlip")?1000:350}.property(),showingState:function(){return this.get("shouldFlip")?{rotateY:0}:{opacity:1}}.property(),hiddenState:function(){var c=179.99;var d=this.get("shouldFlip")?{rotateY:this._animatingShow?(this.isFront?c:-c):(this.isFront?-c:c)}:{opacity:0};return d}.property(),paneWillShow:function(){this._isShowing=YES;if(this.get("shouldFlip")){this._hiddenForShow=YES;this.set("isVisible",NO)}},paneDidHide:function(){this._isShowing=NO},showDidFrame:function(b){if(!this.get("shouldFlip")||!this._hiddenForShow){return}if(!b.rotateY||b.rotateY.tweenedProgress>=0.5){this._hiddenForShow=NO;this.set("isVisible",YES)}},hideDidFrame:function(b){if(this._isFinishing){return}this._isFinishing=true;if(this.get("shouldFlip")&&b.rotateY&&b.rotateY.tweenedProgress>=0.5){b.finish()}this._isFinishing=false},flipFlipSwitchTo:function(b){if(!SteedOS.ENABLE_TRANSFORM_ANIMATIONS){return}if(b!==undefined){this.set("wantsFlip",b)}else{b=this.get("shouldFlip")}if(this._isShowing){return}if(b){this.adjust("opacity",1);this.adjust(this.get("hiddenState"))}else{this.adjust(this.get("hiddenState"));this.adjust("rotateY",0)}}});SteedOS.blockInputModalPane=SC.Page.design({modalPane:SC.Pane.design({layout:{zIndex:100000},childViews:"feedback".w(),shouldShowFeedback:NO,shouldShowFeedbackBinding:"SteedOS.blockInputController.shouldShowFeedback",shouldShowFeedbackDidChange:function(){var d=this.get("shouldShowFeedback"),e=this.get("feedback");var f=d?250:0;e.animate({opacity:d?1:0,duration:f});e.set("isVisible",d)}.observes("shouldShowFeedback"),feedback:SC.View.design(CW.Animatability,{layout:{opacity:0},isVisible:NO,classNames:"block-input-feedback",childViews:"spinner".w(),spinner:CW.SpinnerView.design({layout:{centerX:0,centerY:0}})})})});SteedOS.ButtonView=SC.ButtonView.extend(CW.Animatability,{isDown:NO,classNames:"auth-button-view custom-button".w(),renderDelegate:null,renderDelegateName:null,displayProperties:"isEnabled".w(),mouseDown:function(){this.set("isDown",YES);return arguments.callee.base.apply(this,arguments)},mouseUp:function(){this.set("isDown",NO);return arguments.callee.base.apply(this,arguments)},render:function(b){b.push('<div class="bg normal"><div class="left"></div><div class="middle"></div><div class="right"></div></div><div class="bg active"><div class="left"></div><div class="middle"></div><div class="right"></div></div><div class="text"></div>');b.attr("tabindex","0")},didCreateLayer:function(){this._layer=this.get("layer");this._bg=this.$(".bg.normal")[0];this._bgActive=this.$(".bg.active")[0];this._text=this.$(".text")[0];CW.Anim.setOpacity(this._bgActive,0);this.update()},update:function(){if(!this._layer){return}if(this.didChangeFor("update","isActive")){var c=this.get("isActive");this._activeFader=CW.Anim.Fader.create({element:this._bgActive,to:0+c,duration:(300-c*250)*(!this.get("isAnimatingWithParent"))}).start()}if(this.didChangeFor("update","isEnabled")){var d=this.get("isEnabled");this.animate("opacity",0.5+0.5*d,{duration:300*(!this.get("isAnimatingWithParent"))})}if(this.didChangeFor("update","displayTitle")){this._text.innerHTML=this.get("displayTitle")}},finisher:function(){if(!this.get("isAnimatingWithParent")){return}this.finishAnimation();if(this._activeFader){this._activeFader.finish()}}.observes("isAnimatingWithParent")});SteedOS.environmentSashPane=SC.Pane.create({layout:{right:0,bottom:0,width:124,height:124},classNames:"sb-environment-sash",displayProperties:["environment"],render:function(d,c){d.push("<div>",this.get("environment")," - "+SC.buildNumber+"</div>")},environmentBinding:"COS.authController.environment",currentAppBinding:"SteedOS.appController.currentApp",environmentDidChange:function(){var b=this.get("environment");if(b==="PROD"&&this.get("layer")){this.remove()}else{if(b!=="PROD"){this.append()}}}.observes("environment"),currentAppDidChange:function(){if(this.get("currentApp")){this.set("isVisible",NO)}else{this.set("isVisible",YES)}}.observes("currentApp"),mouseDown:function(){this.remove();return NO}});SteedOS.iOSNotificationForSpringboard=CW.iOSNotification.extend({parentElement:function(){return SteedOS.getPath("mainPage.mainPane.springboardView.layer")}.property(),minimumSideClearanceBinding:SC.Binding.transform(function(b){return b-29}).from("SteedOS.workspaceController.accountSignoutHelpProtrusion")});sc_require("views/sb_ios_notification");SteedOS.iOSAlarm=SteedOS.iOSNotificationForSpringboard.extend({isDismissable:YES,contentView:SC.ButtonView.design({classNames:"snooze".w(),layout:{width:90,height:26,right:6,centerY:0},title:"Notification.Button.Snooze",localize:YES,icon:"alarm-glyph"})});SteedOS.NotificationCenterView=SC.View.extend(CW.Animatability,{layout:{right:0,width:0,top:SteedOS.TOPBAR_HEIGHT,opacity:1,zIndex:100000,},classNames:["notification_center"],isAuthenticatedBinding:"SteedOS.authController.isAuthenticated",});require("mixins/notification_support");SteedOS.SpringboardView=SC.View.extend(CW.Animatability,SteedOS.NotificationSupport,{ALL_FOUR_EDGE_SPACING:0,TOP_INSET:SteedOS.TOPBAR_HEIGHT,BOTTOM_INSET:0,LEFT_INSET:0,RIGHT_INSET:0,MIN_INTER_BUTTON_SPACING:CW.isMobile()?10:35,layout:{left:0,top:0,right:0,height:0,zIndex:50},classNames:["springboard-view"],wantsAcceleratedLayer:NO,wantsAcceleratedLayerBinding:SteedOS.ENABLE_TRANSFORM_ANIMATIONS?"SteedOS.workspaceController.isGPUEnabled":"SteedOS.workspaceController._nonexistentProperty_",notificationIsOnscreenBinding:"SteedOS.workspaceController.notificationIsOnscreen",topbarIsOnscreenBinding:"SteedOS.workspaceController.topbarIsOnscreen",displayProperties:"frame isOnscreen notificationIsOnscreen isAnimating".w(),isVisible:YES,isOnscreen:NO,acceptsFirstResponder:YES,isDecorativeDimmed:NO,subscribesTo:"SteedOS.workspaceController".w(),_requiredSRCs:[SteedOS.defaultAppOptions.shadowAsset,SteedOS.defaultAppOptions.decorShadowAsset],childViews:"buttonsContainer".w(),buttonsContainer:SC.View.extend(CW.Animatability,{layout:{left:0,top:0,right:0,bottom:0,zIndex:1}}),apps:undefined,isReadyToShow:NO,init:function(){arguments.callee.base.apply(this,arguments);this._buttons=[];window.sv=this;this.sizeToParent(true);this.handleOnscreen()},show:function(){if(!this.get("isReadyToShow")){this._pendingShow=YES;return}this.becomeFirstResponder();this._pendingShow=NO;this._showing=YES;SteedOS.workspaceController.removeRHTMLSpinner();var b=SteedOS.workspaceController.get("isGPUEnabled");if(this.get("isDecorativeDimmed")){return this.showDecorative()}if(SteedOS.ENABLE_TRANSFORM_ANIMATIONS&&b){return this.showViaIconSlide()}this.set("isOnscreen",YES);this.animate("opacity",{from:0,to:1,duration:800*SteedOS.ENABLE_APP_ANIMATION*b},{doneShowing:function(){this.view.didShow()}.listens("stop")})},didShow:function(){this.establishFocusForScreenReader()},hide:function(){this._pendingShow=NO;if(!this._showing){return}this.resignFirstResponder();this._showing=NO;var b=SteedOS.workspaceController.get("isGPUEnabled");if(this.get("isDecorativeDimmed")){return this.hideDecorative()}if(SteedOS.ENABLE_TRANSFORM_ANIMATIONS&&b){return this.hideViaIconSlide()}this.animate("opacity",{to:0,duration:800*SteedOS.ENABLE_APP_ANIMATION*b},{doneHiding:function(){this.view.set("isOnscreen",NO);this.view.didHide()}.listens("stop")})},didHide:function(){},showWhenReady:function(){var b=this.get("isReadyToShow");if(this._lastIsReadyToShow===(this._lastIsReadyToShow=b)){return}if(b&&this._pendingShow){this.show()}}.observes("isReadyToShow"),IconSlideAnim:CW.Animation.extend({duration:800,TRAVEL:1,update:function(){var t=this.view,D=t._buttonCenters,v=t._buttons,E=this._frame,F=this.TRAVEL*(1-this.current),q=t._layoutBounds,B=q.centerX,C=q.centerY;for(var z=0,s,u,y,w,x,G;(G=D[z])&&(y=v[z]);z++){w=G.x;x=G.y;if(w===B&&x===C&&z!==0){w=D[z-1].x;x=D[z-1].y}s=G.x+F*(w-B);u=G.y+F*(x-C);y.setCenter(s,u)}this._layer.style.opacity=this.current;this.view.adjust("opacity",this.current)},onstop:function(){this.view.decrementAnimationCount()},onfinish:function(){if(this.to===0){this.view.set("isOnscreen",NO);this.view.didHide()}if(this.to===1){this.view.didShow()}},onstart:function(){if(this.to!==0){this.view.handleOnscreen();this.view.set("isOnscreen",YES);this.view.sizeToParent(true);this.view.update()}this._frame=this.view.get("frame");this._layer=this.view.get("layer");this.view.incrementAnimationCount()}}),showViaIconSlide:function(){var b=this._iconSlideAnim||(this._iconSlideAnim=this.IconSlideAnim.create({from:0,to:1,view:this}));b.duration=600;b.redirectTo(1);b.start()},hideViaIconSlide:function(){var b=this._iconSlideAnim||(this._iconSlideAnim=this.IconSlideAnim.create({from:1,to:0,view:this}));b.duration=800;b.redirectTo(0);b.start()},showDecorative:function(){this.animate("opacity",{from:0,to:1,duration:1500*SteedOS.workspaceController.get("isGPUEnabled")},{onstop:function(){this.view.adjust("opacity",1);this.view.didShow()}});this.set("isOnscreen",YES)},hideDecorative:function(){this.set("isOnscreen",NO);this.didHide();this.finishAnimation("scale")},__lastDim__:NO,handleDecorativeDimming:function(){var b=this.get("isDecorativeDimmed");if(this.__lastDim__===(this.__lastDim__=b)){return}if(b){this.stopAnimation("scale");this.buttonsContainer.adjust("scale",0.95);this.didDim()}else{if(!this.get("isShowing")){this.buttonsContainer.adjust("scale",1);this.didUndim()}else{this.buttonsContainer.animate("scale",1,{duration:500*SteedOS.ANIMATE_SPRINGBOARD_SCALE,tween:CW.Anim.tweens.make("linearInterpolation",[0,3,10,22,43,79,141,227,292,329,346,354,355,351,345,336,326,313,300,283,268,251,245].map(function(a){return a/245})),onstop:function(){this.view.owner.didUndim()}})}}}.observes("isDecorativeDimmed"),establishFocusForScreenReader:function(){if(this.nowShowing!==SteedOS.SPRINGBOARD){return}var b=$(".steedos-text");if(b.length&&b[0].style.display!=="none"){b[0].focus()}}.observes("isDecorativeDimmed","isShowing"),didDim:function(){},didUndim:function(){},sizeToParent:function(g){var e=this.getPath("parentView.frame");if(g!==true&&!this.get("isOnscreen")){return}if(!e){return}var f=this._lastPFWidth!==(this._lastPFWidth=e.width);var h=this._lastPFHeight!==(this._lastPFHeight=e.height);if(!f&&!h&&!this.didChangeFor("sizeToParent","isOnscreen")){return}this.adjust({width:e.width,height:e.height})}.observes("*parentView.frame","isOnscreen"),handleOnscreen:function(){var b=this.get("isOnscreen");if(SteedOS.workspaceController.topbarIsOnscreen){this.adjust({top:-20000*(!b),})}else{this.adjust({top:-20000*(!b),})}}.observes("isOnscreen","topbarIsOnscreen"),update:function(){var q=this.getPath("pane.currentWindowSize");if(this.get("isAnimating")&&this._lastWinSizeHash===(this._lastWinSizeHash=q.width+","+q.height)){return}var u=this.didChangeFor("update","isOnscreen");if(!this._buttons.length){return}this._decideButtonLocations();var o=this._buttonCenters.hClearance,w=this._buttonCenters.vClearance;var p=o,n=w*SteedOS.SpringboardButtonView.prototype.ASPECT_RATIO;var v=p/n;var m;if(v>1){m=Math.ceil(n)}else{m=Math.ceil(p)}m=Math.min(142,m);this._buttonSize=m;for(var t=0,s,x;(x=this._buttonCenters[t])&&(s=this._buttons[t]);t++){if(u||!SteedOS.ANIMATE_SPRINGBOARD_LAYOUT){s.stopAnimation();s.setCenter(x.x,x.y,m)}else{s.animateCenter(x.x,x.y,m)}}},appsObserver:function(){this._buttons.length=0;this.createButtons();this.update()}.observes("apps"),_globalVertOffsetsByColumnQuantity:[0-5,-16-5,-15-5,-11-5,-13-5,function(d,c){return -18-5+Math.max(0,Math.min(18,(300-c)*18/(300-192)))},function(d,c){return -18-5+Math.max(0,Math.min(18,(300-c)*18/(300-192)))}],maxSpreadDimensionsByColumnQuantity:[[Infinity,Infinity],[Infinity,1500],[767,1188],[1320,900],[1320,900],[1500,Infinity],[1500,Infinity],[1500,Infinity],[1500,Infinity]],_decideButtonLocations:function(){var aA=this.get("frame");var aC=aA.width-this.ALL_FOUR_EDGE_SPACING*2-this.LEFT_INSET-this.RIGHT_INSET;if(this.get("notificationIsOnscreen")){aC=aC-SteedOS.NOTIFICATION_CENTER_WIDTH}var az=aA.height-this.ALL_FOUR_EDGE_SPACING*2-this.TOP_INSET-this.BOTTOM_INSET;var ao=aC/az;var Q=this._buttons.length;this._gridInfo=this._gridInfo||[];this._gridInfo.length=0;var ap=1,T,al,ai,R;for(var U=1;U<20;U++){ap=U;ai=Math.ceil(Q/ap);R=Math.ceil(Q/ai);al=(aC/(R+1))/(az/(ai+1));this._gridInfo[U]=al/SteedOS.SpringboardButtonView.prototype.ASPECT_RATIO}al=Infinity;var ad;ap=-1;for(U=0;U<this._gridInfo.length;U++){ad=this._gridInfo[U];if(ad<1){ad=1/ad}if(ad<al){al=ad;ap=U}}if(ap===-1){ap=3}T=Math.ceil(Q/ap);ap=Math.ceil(Q/T);this._rows=T;this._cols=ap;var ab=this.maxSpreadDimensionsByColumnQuantity[ap][0]||Infinity;var at=this.maxSpreadDimensionsByColumnQuantity[ap][1]||Infinity;var ax=aC;var am=az;aC=Math.min(ax,ab);az=Math.min(am,at);var aj=this._globalVertOffsetsByColumnQuantity[ap]||0;if(aj instanceof Function){aj=aj.call(this,ax,am)}var aw,av,aq,au;var Y=(this._buttonCenters||(this._buttonCenters=[])),an,aB;var u=this.ALL_FOUR_EDGE_SPACING+this.LEFT_INSET+(ax-aC)/2;var ac=this.ALL_FOUR_EDGE_SPACING+this.TOP_INSET+(am-az)/2+aj;for(U=0;an=this._buttons[U];U++){aq=Math.floor(U/ap);au=Math.floor(U%ap);aw=(au+1)*aC/(ap+1);av=(aq+1)*az/(T+1);aw=Math.ceil(aw+u);av=Math.ceil(av+ac);aB=(Y[U]||(Y[U]={}));aB.x=aw;aB.y=av}var ah=this._layoutBounds;if(!ah){this.set("layoutBounds",ah=this._layoutBounds={});var ar=YES}ah.centerX=Math.ceil(0.5*aC+u);ah.centerY=Math.ceil(0.5*az+ac);ah.top=Math.ceil(ac);ah.bottom=Math.ceil(az+ac);ah.height=ah.bottom-ah.top;ah.left=Math.ceil(u);ah.right=Math.ceil(aC+u);ah.width=ah.right-ah.left;ah.fullWidth=ax;ah.fullHeight=am;var X=this._animatedLayoutBounds;if(!X){var ak=SteedOS.ANIMATE_SPRINGBOARD_LAYOUT?15:Infinity;this.set("animatedLayoutBounds",X=this._animatedLayoutBounds=CW.Animation.create({freevars:"left top width height".w(),view:this,left:{from:ah.left,to:ah.left,inertia:3,speed:ak,headStart:0},width:{from:ah.width/ax,to:ah.width/ax,inertia:3,speed:ak,headStart:0},top:{from:ah.top,to:ah.top,inertia:3,speed:ak,headStart:0},height:{from:ah.height/am,to:ah.height/am,inertia:3,speed:ak,headStart:0},update:function(){this.view.notifySubscribers("update","reposition")}}));var ay=YES}X.left.redirectTo(ah.left);X.width.redirectTo(ah.width/ax);X.top.redirectTo(ah.top);X.height.redirectTo(ah.height/am);X.start();var ag=(ah.centerY-aA.height/2);this.set("visualCenterY",ag);SteedOS.workspaceController.set("springboardVisualCenterY",ag);var S=Math.max(0.95,(0.95+7/1440)+(1440-ah.width)*16/490/100);for(U=0;aB=Y[U];U++){aB.x=(aB.x-ah.centerX)*S+ah.centerX;aB.y=(aB.y-ah.centerY)*S+ah.centerY}if(ar){for(var af=0,Z;Z=this._buttons[af];af++){Z.layoutBoundsCacher()}}if(ay){for(var aa=0,ae;ae=this._buttons[aa];aa++){ae.animatedLayoutBoundsCacher()}}var V=1/(ap+1)*aC,W=1/(T+1)*az;this._buttonCenters.hClearance=V-this.MIN_INTER_BUTTON_SPACING;this._buttonCenters.vClearance=W-this.MIN_INTER_BUTTON_SPACING},_numberPiecesReady:0,_numberPieces:0,createButtons:function(){if(this._buttons.length){return true}var l=this.get("apps");this._apps=l;if(!l){return}for(var m=0,j,g;j=l[m];m++){if(!j.get("isHidden")){this._numberPieces++}}var k,h;for(m=0;k=this._requiredSRCs[m];m++){h=new Image();h.onload=function(){this.owner._pieceDidBecomeReady()};h.owner=this;h.src=k;this._numberPieces++}this._numberPieces++;for(m=0;j=l[m];m++){if(j.get("isHidden")){continue}this._buttons.push(g=SteedOS.SpringboardButtonView.create({springboardView:this,app:j,init:function(){arguments.callee.base.apply(this,arguments);this.notifyParentWhenReady()},notifyParentWhenReady:function(){if(this._notifiedParent||!this.get("iconElement")){return}this._notifiedParent=YES;this.get("springboardView")._pieceDidBecomeReady()}.observes("iconElement")}));this.buttonsContainer.appendChild(g)}this.invokeLater("set",4000,"isReadyToShow",YES);return true},_pieceDidBecomeReady:function(){this._numberPiecesReady++;if(this._numberPiecesReady===this._numberPieces){this.set("isReadyToShow",YES)}},springboardMayProceed:function(){if(this._receivedGreenlight===(this._receivedGreenlight=YES)){return}this._pieceDidBecomeReady()},keyDown:function(e){if(!this.get("isShowing")){return}var f=SC.FUNCTION_KEYS,d=SC.FUNCTION_KEYS[e.which]||SC.PRINTABLE_KEYS[e.which];if(d==="right"){this.focusRight()}if(d==="left"){this.focusLeft()}if(d==="up"){this.focusUp()}if(d==="down"){this.focusDown()}if(d==="return"||d===" "){this.activateFocusedButton()}e.allowDefault();return NO},currentFocus:NaN,_lastCurrentFocus:NaN,focusNone:function(){this.set("currentFocus",NaN)},focusRight:function(){var b=this.get("currentFocus");if(isNaN(b)||b>=this._buttons.length-1){return this.set("currentFocus",0)}return this.set("currentFocus",b+1)},focusLeft:function(){var b=this.get("currentFocus");if(isNaN(b)||b<=0){return this.set("currentFocus",this._buttons.length-1)}return this.set("currentFocus",b-1)},focusUp:function(){var b=this.get("currentFocus");if(b<this._cols){return}if(isNaN(b)){return this.set("currentFocus",this._buttons.length-1)}return this.set("currentFocus",(b-this._cols+this._buttons.length)%this._buttons.length)},focusDown:function(){var b=this.get("currentFocus");if(b>=(this._rows-1)*this._cols||b+this._cols>=this._buttons.length){return}if(isNaN(b)){return this.set("currentFocus",0)}return this.set("currentFocus",(b+this._cols)%this._buttons.length)},currentFocusObserver:function(){var c=this.get("currentFocus"),d=this._lastCurrentFocus;if(d===(this._lastCurrentFocus=c)){return}if(!isNaN(d)){this._buttons[d].set("isFocused",NO)}if(!isNaN(c)){this._buttons[c].set("isFocused",YES)}}.observes("currentFocus"),activateFocusedButton:function(){var c=this.get("currentFocus");if(isNaN(c)){return}var d=this._buttons[c];if(!d){return}d.mouseEntered("keyboard");d.mouseDown("keyboard");d.invokeLater(function(){this.mouseUp("keyboard");this.mouseExited("keyboard")},100)},click:function(){SteedOS.notificationCenterDisplayController.hide()}});require("mixins/notification_support");SteedOS.SpringboardButtonView=SC.View.extend(CW.Animatability,SteedOS.NotificationSupport,{subscribesTo:".springboardView SteedOS.localizationController".w(),tagName:"a",_ARROW_WIDTH_MULTIPLE:71/142,_ARROW_HEIGHT_MULTIPLE:70/142,_ARROW_LEFT_MULTIPLE:73/142,_ARROW_TOP_MULTIPLE:73/142,_SHADOW_SIZE_MULTIPLE:328/142,_SHADOW_DROP_RATIO:50/142,_FOCUS_SIZE_MULTIPLE:172/142,_SPINNER_SIZE_MULTIPLE:42/142,_TITLE_SIZE_MULTIPLE:19/142,_TITLE_TOP_MULTIPLE:161/142,_ERROR_SIZE_MULTIPLE:15/142,_ERROR_TOP_MULTIPLE:1.3+1/142,_BETA_SASH_SIZE_MULTIPLE:51/142,ASPECT_RATIO:1/1.35,_DECOR_SHADOW_SIZE_MULTIPLE:180/142,_DECOR_SHADOW_DROP_RATIO:7/142,_useTransformScaling:NO,_useExternalShadow:SC.browser.msie||SC.browser.opera,layout:{zIndex:15},classNames:"springboard-button-view".w(),ariaRole:"button",displayProperties:"isDark size displayName isFocused x y isSpinning errorText isDarkTo app isUnclickable isShowingWarning isAnimatingWithParent iconElement titleIntensity isDecorativeDimmed badgeCount".w(),action:function(){var b=this.get("app");if(!b){return}b.set("loadReason",CK.LOAD_REASON_USER_CLICK);SteedOS.appController.set("pendingApp",b);SteedOS.statechart.sendAction("userDidChooseApp")},size:142,x:300,y:300,isWaitingBinding:".app.isWaiting",loadInBackgroundBinding:".app.loadInBackground",displayNameBinding:".app.displayName",isFocused:NO,_lastIsFocused:NO,isActive:NO,badgeCountBinding:".app.badgeCount",shouldUseBetaBinding:".app.shouldUseBeta",iconElementBinding:".app.iconElement",layoutBoundsCacher:function(){this._layoutBounds=this.getPath("springboardView.layoutBounds")||SteedOS.SpringboardButtonView.prototype._layoutBounds},_layoutBounds:{top:0,centerY:1,bottom:2,left:0,centerX:1,right:2},animatedLayoutBoundsCacher:function(){this._animatedLayoutBounds=this.getPath("springboardView.animatedLayoutBounds")},app:null,mouseDown:function(b){if(b.metaKey||b.button===2||b.which==3){b.allowDefault();return NO}this.set("isDown",YES);this.set("isActive",YES)},touchStart:function(b){this.mouseEntered(b);return this.mouseDown(b)},mouseUp:function(f){var e=this.get("isActive")&&!this.get("isUnclickable");this.set("isActive",NO);this.set("isDown",NO);if(!e){return}this.action();if(f!=="keyboard"){var d=this.get("springboardView");if(d&&d.focusNone){d.focusNone()}}},touchEnd:function(b){this.mouseUp(b);return this.mouseExited(b)},mouseMoved:function(f){if(!this._useExternalShadow){return}if(!this.convertPointToView(f)){return}var g=this._pt_.x,h=this._pt_.y,k=this.get("frame"),j=g>=0&&g<=k.width&&h>=0&&h<=k.height;if(this._lastIsOver!==j){this.set("isOver",this._lastIsOver=j)}},mouseEntered:function(b){if(this.get("isDown")){this.set("isActive",YES)}if(this._useExternalShadow){return}this.set("isOver",this._lastIsOver=YES)},touchEntered:function(b){return this.mouseEntered(b)},mouseExited:function(){this.set("isActive",NO);this.set("isOver",this._lastIsOver=NO)},touchExited:function(b){return this.mouseExited(b)},isDecorativeDimmedBinding:"*springboardView.isDecorativeDimmed",isSpinning:function(){return this.get("isWaiting")&&!this.get("loadInBackground")&&!this.get("isDecorativeDimmed")}.property("isWaiting","loadInBackground","isDecorativeDimmed"),isDark:function(){return(this.get("isActive")&&this.get("isDown"))||this.get("isSpinning")}.property("isActive","isDown","isOver","isSpinning","isUnclickable").cacheable(),isFailedBinding:"*app.isFailed",isDisabled:function(){var b=this.get("app");if(b&&b.requiresMailAndIsMissing()){return NO}else{return this.getPath("app.isDisabled")}}.property("app"),isDisabledObserver:function(){this.notifyPropertyChange("isDisabled")}.observes("*app.isDisabled"),isRampedBinding:"*app.isRamped",isUnqualifiedBinding:"*app.isUnqualified",isDimmed:function(){if(this.get("isDecorativeDimmed")){return NO}return this.get("isRamped")||this.get("isUnqualified")}.property("isRamped","isUnqualified","isDecorativeDimmed").cacheable(),isUnclickable:function(){if(this.get("isDecorativeDimmed")){return YES}if(this.get("isDimmed")){return NO}return this.getPath("app.isFailed")||this.get("isDisabled")}.property("isFailed","isDisabled","isDimmed","isDecorativeDimmed"),isShowingWarning:function(){if(this.get("isDecorativeDimmed")){return NO}if(this.get("isDimmed")){return NO}return this.getPath("app.isFailed")||this.get("isDisabled")}.property("isFailed","isDisabled","isDimmed","isDecorativeDimmed"),isDarkTo:function(){if(this.get("isDecorativeDimmed")){return 0}var e=this.get("isDark");var g=this.get("isUnclickable");var h=this.get("isDimmed");var f;if(!e&&!g&&!h){f=0}if(e&&!g&&!h){f=0.4}if(!e&&g&&!h){f=0.75}if(e&&g&&!h){f=0.75}if(!e&&!g&&h){f=0.75}if(e&&!g&&h){f=0.8}if(!e&&g&&h){f=0.75}if(e&&g&&h){f=0.75}return f}.property("isDark","isUnclickable","isDimmed","isDecorativeDimmed"),titleIntensity:function(){var b=this.get("isDimmed");if(b){return 0.25}return 1}.property("isDimmed"),_setWarningArrowSrc:function(){this.invokeLast(function(){if(!this.get("isUnclickable")){return}var d=this._warningArrow,c=this.getPath("app.warningArrowAsset");if(!d||!c){return}d.src=c})}.observes("isUnclickable"),_forceDisableChangeObserver:function(){this.invokeLast(function(){if(this.get("isDarkTo")===0.75){this.update()}})}.observes("isDarkTo"),errorText:function(){if(!this.get("isUnclickable")){return""}if(this.get("isDisabled")){return this.getPath("app.isDisabledForMaintenance")?"Springboard.Icon.Maintenance".loc():"Springboard.Icon.Offline".loc()}return""}.property("isUnclickable","isDisabled","isFailed"),setCenter:function(f,g,e){this.beginPropertyChanges();var h=this._layoutBounds;this.set("x",(f-h.left)/(h.right-h.left));this.set("y",(g-h.top)/(h.bottom-h.top));if(e!==undefined){this.set("size",e)}this.endPropertyChanges()},animateCenter:function(g,h,k){if(this.get("isAnimatingWithParent")){return this.setCenter(g,h,k)}var j=this._layoutBounds;var f={x:(g-j.left)/j.width,y:(h-j.top)/j.height};if(k!==undefined){f.size=k}this.animateProperties(f,{speed:23,headStart:0.002,inertia:8,ticked:2})},getPxX:function(){var d=this._animatedLayoutBounds,c=this._layoutBounds;return d.left.current+this.x*d.width.current*c.fullWidth},getPxY:function(){var d=this._animatedLayoutBounds,c=this._layoutBounds;return d.top.current+this.y*d.height.current*c.fullHeight},finishAllAnimationExceptSpinner:function(){if(!this.get("isAnimatingWithParent")){return}this.finishAnimation();if(this._maskFader){this._maskFader.finish()}if(this._focusFader){this._focusFader.finish()}if(this._arrowFader){this._arrowFader.finish()}if(this._errorTextFader){this._errorTextFader.finish()}this._maskFader=this._focusFader=this._arrowFader=this._errorTextFader=null}.observes("isAnimatingWithParent"),render:function(c){window.tb=this;var d=window.devicePixelRatio>1?"../../../../system/steedos/4330/en-us/source/resources/images/beta_sash_app@2x.png":"../../../../system/steedos/4330/en-us/source/resources/images/beta_sash_app.png";c.push('<div class="sb-spinner sb-el"><img class="sb-spinner-image sb-el"></div><div class="sb-badge sb-el"><div class="icon"></div><div class="mask"></div></div><img class="sb-mask sb-el"><img class="sb-beta sb-el" src="'+d+'"><img class="sb-focus sb-el"><div class="sb-title sb-el '+SC.guidFor(this)+'-label"></div><div class="sb-error-text sb-el"></div><img class="sb-arrow sb-el"></img>'+(this._useExternalShadow?"":'<img class="sb-shadow sb-el">'));c.attr("tabindex","0");c.attr("href","#"+this.getPath("app.name"))},parentViewDidResize:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this.update("reposition")})},update:function(T){var ac=this,o=NO,P=this.get("isAnimatingWithParent"),ag=NO,O,ad,V,H,Z,I,J,ai,L,R,Q,aa,ah,N,W,ab,ae,M,X,aj,U,Y;this.$().attr("aria-labelledby",SC.guidFor(this)+"-label");if(!(M=this.get("iconElement"))){return}if(M.parentNode!==this._layer){o=YES;if(this._lastIconElement&&this._lastIconElement!==M&&this._lastIconElement.parentNode===this._layer){this._layer.removeChild(this._lastIconElement)}this._lastIconElement=M;jQuery(M).addClass("sb-icon").addClass("sb-el");if(SC.browser.isiOS){jQuery(M).css("border-radius","100px")}if(M.parentNode){M.parentNode.removeChild(M)}this._layer.appendChild(M)}if(this._useExternalShadow){if(!(I=this._externalShadow)){I=new Image();this._externalShadow=I;I.className="sb-external-shadow";I.setAttribute("aria-hidden","true")}if(!I.parentNode&&this._layer.parentNode){this._layer.parentNode.appendChild(I)}}if(this.didChangeFor("update","isDecorativeDimmed")&&(ab=this.get("app"))){Y=this.get("isDecorativeDimmed");if(!SC.browser.isIE8OrLower){this._titleFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._title,to:1-Y,duration:Y?0:500}).start()}else{this._title.style.display=Y?"none":"block"}this._shadowFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._shadow||this._externalShadow,to:1-Y,duration:Y?0:500}).start();if(!(!this._decorShadow&&!Y)){if(!this._decorShadow){this._decorShadow=function(){ag=YES;var a=new Image();a.className="sb-el sb-decor-shadow";a.src=ab.get("decorShadowAsset");ac._layer.appendChild(a);return a}()}this._decorShadowFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._decorShadow,to:0+Y,duration:Y?0:500}).start()}}if(ag||o||(O=this.didChangeFor("update","size"))||(ad=this.didChangeFor("update","isSpinning"))){(H=M.style).width=H.height=(H=this._mask.style).width=H.height=Math.round(V=this._useTransformScaling?142:this.get("size"))+"px";if((H=this._shadow&&this._shadow.style)){H.width=H.height=Math.round(J=(V*this._SHADOW_SIZE_MULTIPLE))+"px";H.left=Math.round(ai=Math.floor((V-J)/2))+"px";H.top=Math.round(ai+V*this._SHADOW_DROP_RATIO)+"px"}(H=this._warningArrow.style).width=Math.round(V*this._ARROW_WIDTH_MULTIPLE)+"px";H.height=Math.round(V*this._ARROW_HEIGHT_MULTIPLE)+"px";H.left=Math.round(V*this._ARROW_LEFT_MULTIPLE)+"px";H.top=Math.round(V*this._ARROW_TOP_MULTIPLE)+"px";(H=this._focus.style).width=H.height=Math.round(L=Math.ceil(0.5*Math.round(2*V*this._FOCUS_SIZE_MULTIPLE)))+"px";H.left=Math.round(R=Math.floor((V-L)/2))+"px";H.top=Math.round(R)+"px";(H=this._title.style).width=Math.round(V+60)+"px";H.height=Math.ceil(1.3*this._TITLE_SIZE_MULTIPLE*V)+"px";H.top=Math.round(this._TITLE_TOP_MULTIPLE*V)+"px";H.fontSize=Math.round(this._TITLE_SIZE_MULTIPLE*V)+"px";(H=this._errorText.style).width=Math.round(V)+"px";H.height=Math.ceil(1.3*this._ERROR_SIZE_MULTIPLE*V)+"px";H.top=Math.round(this._ERROR_TOP_MULTIPLE*V)+"px";H.fontSize=Math.round(this._ERROR_SIZE_MULTIPLE*V)+"px";(H=this._beta.style).width=H.height=Math.round(this._BETA_SASH_SIZE_MULTIPLE*V)+"px";if((H=this._decorShadow)){(H=H.style).width=H.height=Math.ceil(J=(V*this._DECOR_SHADOW_SIZE_MULTIPLE))+"px";H.left=Math.ceil(ai=Math.floor((V-J)/2))+"px";H.top=Math.ceil(ai+V*this._DECOR_SHADOW_DROP_RATIO)+"px"}if(this.get("isSpinning")){(H=this._spinner.style).width=H.height=(this._spinnerSize=Q=Math.round(this._SPINNER_SIZE_MULTIPLE*V))+"px";H.left=H.top=Math.round(V-Q)/2+"px";(H=this._spinnerImage.style).width=Q+"px";H.height=Q*12+"px"}if(this._useTransformScaling){this.adjust("scale",this.get("size")/142)}}if(T==="reposition"||O||this.didChangeFor("update","x","y")){this.adjust(Z={top:Math.round(this.getPxY()-(W=Math.round((V=this._useTransformScaling?142:this.get("size"))/2))),left:Math.round(this.getPxX()-W),width:Math.round(V),height:Math.round(V)});if(this._useExternalShadow){(H=this._externalShadow.style).width=H.height=(J=(V*this._SHADOW_SIZE_MULTIPLE))+"px";H.left=(ai=Math.floor((V-J)/2))+Z.left+"px";H.top=ai+V*this._SHADOW_DROP_RATIO+Z.top+"px"}}if(this.didChangeFor("update","app")&&(ab||(ab=this.get("app")))){this._mask.src=ab.get("maskAsset");this._warningArrow.src="data:image/gif;base64,R0lGODlhAQABAJAAAP///wAAACH5BAUQAAAALAAAAAABAAEAAAICBAEAOw==";this._focus.src=ab.get("focusAsset");this._spinnerImage.src=ab.get("spinnerAsset");if(this._shadow){this._shadow.src=ab.get("shadowAsset")}if(this._externalShadow){this._externalShadow.src=ab.get("shadowAsset")}}if(this.didChangeFor("update","displayName")&&(ae=this.get("displayName"))){this._title.innerHTML=ae}if(this.didChangeFor("update","errorText")||T==="relocalization"){this._errorText.innerHTML=this.get("errorText")}if((X=this._lastIsDarkTo)!==(this._lastIsDarkTo=this.get("isDarkTo"))){this._maskFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{owner:this,element:this._mask,to:N=this.get("isDarkTo"),duration:!P?(((X===0&&N===0.4)||(X===0.75&&N===0.8))?0:180):0,renderBadgeOpacityAlso:function(){var a=this.owner._badgeMask;if(!a){return}CW.Anim.setOpacity(a,this.current)}.listens("frame")}).start()}if(this.didChangeFor("update","shouldUseBeta")){CW.Anim.setOpacity(this._beta,this.get("shouldUseBeta")?1:0)}if(this.didChangeFor("update","isFocused")&&this._lastIsFocused!==(this._lastIsFocused=this.get("isFocused"))){this.$()[0].focus();this._focusFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._focus,to:0+(isFocused=this.get("isFocused")),duration:!P?(isFocused?100:180):0}).start()}if(this.didChangeFor("update","isShowingWarning")&&this._lastisShowingWarning!==(this._lastisShowingWarning=this.get("isShowingWarning"))){this._arrowFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._warningArrow,to:0+(U=this.get("isShowingWarning")),duration:!P?(U?300:300):0}).start();this._errorTextFader=CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._errorText,to:0+(U=this.get("isShowingWarning")),duration:!P?(U?300:300):0}).start()}if(this.didChangeFor("update","titleIntensity")){if(SC.browser.isIE8OrLower){CW.Anim.setOpacity(this._title,this.get("titleIntensity"))}else{var S=this.get("titleIntensity");this._title.style.color="rgba(255,255,255,"+S+")";if(!SC.browser.msie||SC.browser.msie>=10){this._title.style.textShadow="0px 7px 12px rgba(0,0,0,"+(((S+2)/3)*0.4)+")"}}}if(this.didChangeFor("update","badgeCount")){var K=this.get("badgeCount"),af=K>9999?"five-digit":K>999?"four-digit":K>99?"three-digit":K>9?"two-digit":K>0?"one-digit":"";this._badgeIcon.innerHTML=K<1?"":K>9999?"9999+":K;this._badge.className="sb-badge sb-el "+af}if(ad||this.didChangeFor("update","isAnimatingWithParent")){if((aa=this.get("isSpinning"))&&!P){if(!this._spinnerAnim){this._spinnerAnim=CW.Animation.create({view:this,signal:function(a){return Math.round(a*12)%12},speed:1,name:"spinnerAnim"+this.toString(),update:function(){var a=-this.current*this.view._spinnerSize+"px";if(this._lastTop===a){return}this._lastTop=a;this.view._spinnerImage.style.top=a},onstart:function(){this.view._spinner.style.display="block";this.spinFader=CW.Fader.create({element:this.view._spinner,to:1,duration:0,name:"spinnerAnim"+this.toString()}).start()},fadeStop:function(){this.spinFader=CW.Fader.create({element:this.view._spinner,to:0,duration:500,owner:this,onfinish:function(){this.owner.stop()}}).start()},onstop:function(){this.view._spinner.style.display="none";if(this.spinFader){this.spinFader.stop()}CW.Anim.setOpacity(this.view._spinner,0)}})}this._spinnerAnim.start()}else{if(this._spinnerAnim){if(!aa&&!P){this._spinnerAnim.fadeStop()}if(P){this._spinnerAnim.stop()}}}}},relocalize:function(){this.update("relocalization")},didCreateLayer:function(){this._getPointers();this._doInitialInlineCSS();this.update()},_getPointers:function(){this._layer=this.get("layer");this._spinner=this.$(".sb-spinner")[0];this._spinnerImage=this.$(".sb-spinner-image")[0];this._focus=this.$(".sb-focus")[0];this._mask=this.$(".sb-mask")[0];this._warningArrow=this.$(".sb-arrow")[0];this._errorText=this.$(".sb-error-text")[0];this._title=this.$(".sb-title")[0];this._badge=this.$(".sb-badge")[0];this._badgeIcon=this.$(".sb-badge .icon")[0];this._badgeMask=this.$(".sb-badge .mask")[0];this._beta=this.$(".sb-beta")[0];this._shadow=(this._shadow=this.$(".sb-shadow"))&&this._shadow[0]},_doInitialInlineCSS:function(){this._layer.style.overflow="visible";this._spinner.style.display="none";CW.Anim.setOpacity(this._mask,0);CW.Anim.setOpacity(this._beta,0);CW.Anim.setOpacity(this._focus,0);CW.Anim.setOpacity(this._spinner,0);CW.Anim.setOpacity(this._warningArrow,0);CW.Anim.setOpacity(this._errorText,0)},willRemoveFromParent:function(){if(this._externalShadow&&this._externalShadow.parentNode){this._externalShadow.parentNode.removeChild(this._externalShadow)}},getLayerPositionInWindow:function(){var d=this._layerPos||(this._layerPos_={});var c=this.get("frame");d.x=c.x;d.y=c.y;return d},convertPointToView:function(f,g){var h,e;if(!this.getLayerPositionInWindow()){return}if(typeof f==="object"&&g===undefined){if(typeof f.clientX==="number"){g=f.clientY;f=f.clientX}else{g=f.y;f=f.x}}(h=this._pt_||(this._pt_={})).x=f-(e=this._layerPos_).x;h.y=g-e.y;return h}});SteedOS.TopBarView=SC.View.extend(CW.Animatability,{layout:{right:0,top:0,height:SteedOS.TOPBAR_HEIGHT,},classNames:["topbar"],isVisibleBinding:"SteedOS.authController.isAuthenticated",childViews:["logoView","accountSignoutHelp"],logoView:SC.ButtonView.design(CW.Animatability,SC.AutoResize,SteedOS.NotificationSupport,{layout:{left:10,height:28,centerY:0,zIndex:100,},classNames:["steedos-logo"],autoResizeLayer:function(){return this.get("layer")}.property("layer"),autoResizeText:function(){return this.calculatedTitle()}.property("title"),supportsAutoResize:YES,calculatedTitle:function(){var a=SteedOS.appController.getAppFromHash();if(!a){return"AppTitle.steedos".loc()}else{return("AppTitleBar."+a).loc()}},subscribesTo:"SteedOS.localizationController".w(),relocalize:function(){this.set("title",this.calculatedTitle());this.renderDelegate.update(this,this.$())},renderDelegate:{render:function(a,d){var c="";if(CK.isBeta){c=" beta"}if(CK.isDeveloper){c=" developer"}d.push('<div class="title'+c+'" aria-label="SteedOS" tabindex="-1">'+a._view.calculatedTitle()+"</div>")},update:function(b,a){a.find(".title")[0].innerHTML=b.get("title")}},action:function(){if(window.location.search.indexOf("debug=1")>=0){navigator.notification.prompt("Please input javascript to evaluate",function(result){try{eval(result.input1)}catch(ex){SC.error(ex)}},"Debug")}SteedOS.showAppSwitcher()}}),accountSignoutHelp:SteedOS.AccountSignoutHelpView.design(CW.Animatability,{protrusionBinding:"SteedOS.workspaceController.accountSignoutHelpProtrusion",frameObserver:function(){this.set("protrusion",this.getPath("frame.width")||0+this.getPath("layout.right")||0)}.observes("frame"),})});SteedOS.UserNewsView=SC.View.extend(SteedOS.Paneness).extend(CW.Animatability,CW.SpritePreloadEnforcement,CW.PaneAnimationSupport,{classNames:"user-news-view".w(),title:null,description:null,icon:null,layout:{left:20,right:20,bottom:20,height:50,zIndex:1},hiddenState:SC.browser.webkit?{opacity:0,scale:0.95}:{opacity:0},showingState:SC.browser.webkit?{opacity:1,scale:1}:{opacity:1},paneWillShow:function(){this.set("hasForcedAcceleratedLayer",YES)},paneDidShow:function(){this.set("hasForcedAcceleratedLayer",NO)},paneWillHide:function(){this.set("hasForcedAcceleratedLayer",YES)},paneDidHide:function(){this.set("hasForcedAcceleratedLayer",NO)},applyAcceleration:SC.browser.webkit?function(){var d=this.get("layer");if(!d){return}var e=this.get("hasForcedAcceleratedLayer"),f=d.style;f.webkitBackfaceVisibility=e?"hidden":"";f.webkitTransformOrigin=e?"50% -100px":"";f.webkitPerspective=e?"1000":""}.observes("layer","hasForcedAcceleratedLayer"):undefined,childViews:"closeButtonView".w(),init:function(){this.usualParent=SteedOS.getPath("mainPage.mainPane.springboardView");if(this.icon){(this.extraRequiredSrcs||(this.extraRequiredSrcs={})).icon=this.icon}return arguments.callee.base.apply(this,arguments)},render:function(d){for(var e=0,f="";e<9;e++){f+='<div class="'+SC.NINE_SLICE[e]+'"></div>'}d.push('<div class="text"><span style="font-weight:bold;">'+this.get("title")+"</span><br>"+this._adornLinkWithArrowIfNeeded(this.get("description"),"link-arrow")+"</div>"+(this.icon?'<img src="'+this.icon+'" alt="" aria-hidden="true" width=32 height=32>':"")+'<div class="background" aria-hidden=true>'+f+"</div>")},didCreateLayer:function(){this._iconElement=this.$("img")[0];this._textElement=this.$(".text")[0]},doLayout:function(){this.invokeLast("_doLayout")}.observes("isVisibleInWindow","layer"),_doLayout:function(){var c;if(!this.isVisibleInWindow||!this._textElement){return}var d=this._iconElement;this.adjust("height",this._textElement.offsetHeight+8+8);if(SC.browser.isIE8OrLower||(this.extraRequiredImages&&this.extraRequiredImages.icon)){this._textElement.style.left=10+((d&&d.width)||0)+10+"px"}else{if(d&&d.parentNode){d.parentNode.removeChild(d)}}},update:function(){},closeButtonView:SC.ImageButtonView.design({classNames:"dismiss".w(),layout:{width:18,height:20,right:6,centerY:-1},init:function(){this.set("toolTip","Button.Close".loc());arguments.callee.base.apply(this,arguments)},action:function(){this.parentView&&this.parentView.dismiss()}}),dismiss:function(){this.didDismiss&&this.didDismiss();return this.remove()},_adornLinkWithArrowIfNeeded:function(c,d){if(!c){return""}d||(d="link-arrow");if(c.substring(c.length-4)==="</a>"){c=c.substring(0,c.length-4)+'<div class="'+d+'"></div></a>'}if(c.substring(c.length-5)==="</a>."){c=c.substring(0,c.length-5)+'.<div class="'+d+'"></div></a>'}return c}});require("views/background_view");SteedOS.mainPage=SC.Page.design({mainPane:SC.MainPane.design(SteedOS.NotificationSupport,CW.DropTarget,{layout:{left:0,right:0,top:0,bottom:0,zIndex:2},orientationBinding:"SC.device.orientation",adjustHeight:function(){if(CW.isiOSApp()){this.adjust("height",window.innerHeight)}}.observes("orientation"),init:function(){if(CW.isiOSApp()){this.layout={left:0,right:0,top:0,height:window.innerHeight,zIndex:2}}arguments.callee.base.apply(this,arguments)},subscribesTo:"SteedOS.workspaceController".w(),isShowingObserver:function(){if(SteedOS.workspaceController.get("nowShowing")===SteedOS.AUTH){this.$(".springboard-button-view").attr("tabindex","-1");this.$().attr("aria-hidden","true")}else{this.$(".springboard-button-view").attr("tabindex","0");this.$().removeAttr("aria-hidden")}}.observes("SteedOS.workspaceController.nowShowing"),toggleGPU:function(){var b=this.get("currentWindowSize");if(!b||this._lastGPUEnabled===(this._lastGPUEnabled=(b.width<1983&&b.height<1983))){return}this.invokeLast(function(){SteedOS.workspaceController.set("isGPUEnabled",this._lastGPUEnabled)})}.observes("currentWindowSize"),activateMinimumSize:function(){this.invokeLast(function(){if(typeof this._prevScrollTop==="number"){document.body.scrollTop=this._prevScrollTop;this._prevScrollTop=undefined}if(typeof this._prevScrollLeft==="number"){document.body.scrollLeft=this._prevScrollLeft;this._prevScrollLeft=undefined}})},deactivateMinimumSize:function(){this._prevScrollTop=document.body.scrollTop;this._prevScrollLeft=document.body.scrollLeft;this.setBodyOverflowIfNeeded(true)},classNames:"overflow-visible".w(),childViews:"appsView springboardView backgroundView".w(),backgroundView:SteedOS.BackgroundView.design(SC.browser.isIE8OrLower?{isVisible:YES}:{isVisible:YES}),appsView:SteedOS.AppsContainerView.design(SteedOS.IsShowingSupport,{displayKey:SteedOS.APP,nowShowingBinding:"SteedOS.workspaceController.nowShowing"}),springboardView:SteedOS.SpringboardView.design(SteedOS.IsShowingSupport,{displayKeys:[SteedOS.SPRINGBOARD,SteedOS.AUTH],nowShowingBinding:"SteedOS.workspaceController.nowShowing",isVisible:function(){if(CW.isiOSApp()){return NO}if(this.get("nowShowing")===SteedOS.AUTH){return NO}else{return YES}}.property("nowShowing").cacheable(),subscribesTo:SteedOS.SpringboardView.prototype.subscribesTo.concat("SteedOS.motmController".w()),visualCenterYBinding:"SteedOS.workspaceController.springboardVisualCenterY",childViews:SteedOS.SpringboardView.prototype.childViews.concat("topBarView".w()),topBarView:SteedOS.TopBarView.extend({}),isOffscreen:YES,mouseEntered:function(b){if(this._requestedNotificationPermission||!SteedOS.pushController){return}SteedOS.pushController.requestHTML5NotificationPermission();this._requestedNotificationPermission=YES},isDecorativeDimmed:function(){return this.get("nowShowing")===SteedOS.AUTH||!!this.get("wantsDD")}.property("nowShowing","wantsDD"),_setWantsDD:function(){var b=this.get("nowShowing")===SteedOS.AUTH;if(b){this.set("wantsDD",YES);if(this._ddSetter){this._ddSetter.invalidate()}this._ddSetter=null}else{this._ddSetter=this.invokeLater(function(){this.set("wantsDD",NO)},200)}}.observes("nowShowing"),appsSetterHackInsteadOfBindingFail:function(){this.set("apps",SteedOS.appController.get("appList"))}.observes("SteedOS.appController.appList"),__lastToggleChromeDim__:NO,didShow:function(){this.showNotificationsIfNeeded()},didUndim:function(){this.showNotificationsIfNeeded()},showNotificationsIfNeeded:function(){this.notifyRampedOrUnqualified();if(this._hasPendingMotm){this.performOrScheduleMotmDisplay()}},notifyRampedOrUnqualified:function(){if(!this._hasNotifiedUnqualified&&SteedOS.authController.get("userRequiresUnqualifiedNotification")){SteedOS.iOSNotificationForSpringboard.enqueue(SteedOS.NotificationSupport,{message:"Auth.Notification.Unqualified.Title".loc(),description:"Auth.Notification.Unqualified.Description".loc(),icon:"steedos-tile",subscribesTo:"SteedOS.localizationController".w(),relocalize:function(){this.set("message","Auth.Notification.Unqualified.Title".loc());this.set("description","Auth.Notification.Unqualified.Description".loc())}});this._hasNotifiedUnqualified=YES}if(!this._hasNotifiedRamped&&SteedOS.authController.get("userRequiresRampNotification")){SteedOS.iOSNotificationForSpringboard.enqueue(SteedOS.NotificationSupport,{message:"Auth.Notification.Ramped.Title".loc(),description:"Auth.Notification.Ramped.Description".loc(),icon:"steedos-tile",subscribesTo:"SteedOS.localizationController".w(),relocalize:function(){this.set("message","Auth.Notification.Ramped.Title".loc());this.set("description","Auth.Notification.Ramped.Description".loc())}});this._hasNotifiedRamped=YES}},performOrScheduleMotmDisplay:function(){if(this.get("isDecorativeDimmed")||!this.get("isShowing")){this._hasPendingMotm=YES;return}this._hasPendingMotm=NO;SteedOS.motmController.displayMotm()}})})});SteedOS.main=function main(){var b=SteedOS.get("delegate");SteedOS.invokeDelegateMethod(b,"applicationWillStart");SteedOS.workspaceController.set("isGPUEnabled",(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<1983&&(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)<1983);CW.addKeyResponder(SteedOS.keyResponder);jQuery(document).mousemove(function(e){var a=SteedOS.appController.getPath("currentApp"),h={clientX:e.clientX,clientY:e.clientY},g;if(!a||!a.get("contentWindow")){return NO}a.passMessage("_mouseMove",h);return YES});jQuery(document).mouseup(function(e){var a=SteedOS.appController.getPath("currentApp"),h={clientX:e.clientX,clientY:e.clientY},g;if(!a||!a.get("contentWindow")){return NO}a.passMessage("_mouseUp",h);return YES});SteedOS.moduleLocalizer.setLocale(String.preferredLanguage);SteedOS.getPath("mainPage.mainPane").append();if(window.localeDidLoad){SC.debug("SteedOS.main() already has localized strings, proceeding to run SteedOS.run() now.");SteedOS.run()}else{SC.debug("SteedOS.main() missing localized strings, waiting for them...")}SteedOS.invokeDelegateMethod(b,"applicationDidStart");SteedOS.set("mainHasCompleted",YES)};function main(){SteedOS.main()};
