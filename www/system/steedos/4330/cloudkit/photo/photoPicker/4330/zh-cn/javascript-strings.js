SC.MODULE_INFO['cloudkit/photo/photoPicker'].source = "PhotoPicker=SC.Object.create({username:null,password:null,alertIconHash:{value:\"me-icon-alert-68\",width:68,height:65},setupPicker:function(E){var F=PhotoPicker.photoUploadController,s=E.evt,B=s.photoUrl,w=s.photoCrop,z=s.newImage,A=s.statechart,y=s.target,D=s.action,t=s.pickerOffset,G=s.alertIconHash,x=s.photoSignature,u=s.maximumUploadFileSize,v=s.errorCode,C=E.evt.sender;if(!A||!y||!D){throw SC.Error(\"one of the following attributes [statechart, target, action, username, password] are not provided to setup the Photo Picker\")}this.set(\"statechart\",A);if(G){this.set(\"alertIconHash\",G)}F.set(\"target\",y);F.set(\"action\",D);var q=B;if(x){F.set(\"photoSignature\",x)}F.set(\"photoUrl\",q);F.set(\"origPhotoUrl\",q);F.set(\"photoCrop\",w);F.set(\"previousUrl\",q);F.set(\"currentUrl\",q);if(u){F.set(\"maximumUploadFileSize\",u)}F._imgPicker=PhotoPicker.page.get(\"picker\");if(C){F._imgPicker.popup(C,[(CW.get(\"isiPad\")||CW.get(\"isMobile\")||CW.get(\"isAndroidApp\")?CW.PickerLayout.ON_TOP:CW.PickerLayout.ON_RIGHT)],[1,4,3]);if(v!==CK.Photo.PHOTO_NO_ERROR){F.set(\"isInErrorState\",YES);CK.Photo.displayUploaderErrors(v,G)}else{F.set(\"isInErrorState\",NO)}}else{throw SC.Error(\" No view was passed to attach the photo picker to\")}if(z){if(!CK.ActiveXView.needsActiveX()){PhotoPicker.photoUploadController.set(\"newImage\",z)}else{A.sendEvent(\"activeXFileDropped\",{fileData:z})}}},isIEAndActiveXInstalled:function(){var b=CK.ActiveXView.currentView;return CK.ActiveXView.needsActiveX()?b&&b.get(\"isInitialized\"):YES}.property(\"CK.ActiveXView.currentView\")});PhotoPicker.photoUploadController=CW.Uploader.create({maximumUploadFileSize:10485760,maximumFileSize:98304-2048,imgHeight:CK.Photo.CONTACT_PHOTO_HEIGHT,imgWidth:CK.Photo.CONTACT_PHOTO_WIDTH,imgOrientation:1,photoUrl:null,photoCrop:null,photoSignature:null,origPhotoUrl:null,sliderValue:0,imgMoved:NO,loadingTempPhotoFromServer:NO,imageDragged:NO,initialSize:null,newImage:null,tempImgUploadError:NO,zoomValueChanged:NO,imageOrientationChanged:NO,allowedFileTypes:[\"png\",\"jpeg\",\"bmp\",\"gif\",\"x-png\"],uploadURL:function(){this.get(\"photoUrl\")}.property(),imgValue:function(d,c){if(c!==undefined){this.set(\"photoUrl\",c)}else{return this.get(\"photoUrl\")}}.property(\"photoUrl\").cacheable(),isInErrorState:NO,makeHoverViewsVisible:NO,errorCode:CK.Photo.PHOTO_NO_ERROR,makeChooseButtonInErrorStateVisible:function(){var c=this.get(\"errorCode\"),d=(c!==CK.Photo.PHOTO_INSTALL_PLUGIN&&c!==CK.Photo.PHOTO_NO_ERROR)?YES:NO;return d}.property(\"errorCode\").cacheable(),makeInstallPluginButtonVisible:function(){var c=this.get(\"errorCode\"),d=c===CK.Photo.PHOTO_INSTALL_PLUGIN?YES:NO;return d}.property(\"errorCode\").cacheable(),chooseButtonFlag:YES,makeRotateButtonVisible:NO,isDoneButtonEnabled:function(){var d=this.get(\"isInErrorState\"),c=this.get(\"imgValue\");return c&&!d}.property(\"imgValue\",\"isInErrorState\").cacheable(),isIEAndActiveXInstalledBinding:\"PhotoPicker.isIEAndActiveXInstalled\",makeChooseButtonVisible:function(){if(!this.get(\"photoUrl\")&&!this.get(\"isInErrorState\")&&this.get(\"chooseButtonFlag\")){return YES}else{return NO}}.property(\"photoUrl\",\"isInErrorState\",\"chooseButtonFlag\").cacheable(),photoPickerErrorTitle:function(){var b=this.get(\"errorCode\");switch(b){case CK.Photo.PHOTO_INVALID_FORMAT:return\"PhotoPicker.InvalidFormat.Title\".loc();case CK.Photo.PHOTO_SIZE_TOO_BIG:return\"PhotoPicker.PhotoTooBig.Title\".loc();case CK.Photo.PHOTO_SERVER_ERROR:return\"PhotoPicker.ServerError.Title\".loc();case CK.Photo.PHOTO_INSTALL_PLUGIN:return\"PhotoPicker.PluginRequired.Title\".loc();case CK.Photo.PHOTO_LOAD_ERROR:return\"PhotoPicker.PhotoLoadingFailed\".loc()}}.property(\"errorCode\").cacheable(),photoPickerErrorMessage:function(){var b=this.get(\"errorCode\");switch(b){case CK.Photo.PHOTO_INVALID_FORMAT:return\"PhotoPicker.InvalidFormat.Message\".loc();case CK.Photo.PHOTO_SIZE_TOO_BIG:return\"PhotoPicker.PhotoTooBig.Message\".loc();case CK.Photo.PHOTO_SERVER_ERROR:return\"PhotoPicker.PhotoLoadError.Message\".loc();case CK.Photo.PHOTO_INSTALL_PLUGIN:return\"PhotoPicker.PluginRequired.Message\".loc();case CK.Photo.PHOTO_LOAD_ERROR:return\"PhotoPicker.PhotoLoadError.Message\".loc()}}.property(\"errorCode\").cacheable(),setErrorViewsAndHoverViewsVisibility:function(e,f,d){this.set(\"isInErrorState\",e);this.set(\"makeHoverViewsVisible\",f);this.set(\"errorCode\",d)},readFiles:function(g){var d=this.get(\"newImage\");if(!g){if(d){g=d;this.set(\"newImage\",null)}else{return}}this.set(\"imageDragged\",YES);var h=g.type.indexOf(\"/\")!==-1?g.type.split(\"/\")[1]:g.type,b=g.fileSize||g.size;if(!h||this.get(\"allowedFileTypes\").indexOf(h)===-1){this._errorForFile(CW.UPLOADER_INCOMPATIBLE_FILE_TYPE);return}else{if(b>this.get(\"maximumUploadFileSize\")){PhotoPicker.statechart.sendEvent(\"photoIsTooBig\");return}else{this.set(\"initialSize\",b)}}this.storeTemporaryPhoto(g,YES)},activeXImageDropped:function(b){b=b.replace(/(\\r\\n|\\n|\\r)/gm,\"\");this.set(\"imageDragged\",YES);this.storeTemporaryPhoto(\"data:image/jpeg;base64,\"+b)},storeTemporaryPhoto:function(h,b){var e=h.name;if(e.indexOf(\"%\")>-1){e=e.replace(/%/g,\" \")}if(e.indexOf(\"+\")>-1){e=e.replace(/\\+/g,\"_\")}var c=partKey=e,g=SteedOS.getUser().dsid,d=CS.Attachment.getContentType(e);this.set(\"loadingTempPhotoFromServer\",YES);var j=function(k){var a=\"https://s3-ap-southeast-1.amazonaws.com/prod-steedos-assets/users/%@/%@/%@?versionId=%@\".fmt(g,SteedOS.appInstance.name,encodeURI(c),k),l=PhotoPicker.photoUploadController;l.set(\"photoCrop\",null);l.set(\"photoSignature\",null);l.set(\"initialSize\",h.size);l.set(\"imgOrientation\",1);l.set(\"currentUrl\",a);PhotoPicker.photoUploadController.set(\"imgValue\",a)};var f=function(){var a=PhotoPicker.photoUploadController;a.set(\"tempImgUploadError\",YES);a.set(\"loadingTempPhotoFromServer\",NO);return YES};CS.Attachment.user_profilePhoto_upload(g,partKey,d,h,j,f)},isImageAltered:function(){var e=this.get(\"imgValue\")===this.get(\"origPhotoUrl\"),h=this.get(\"imgMoved\"),g=this.get(\"zoomValueChanged\"),f=this.get(\"imageOrientationChanged\");return !e||h||g||f}.property(\"imgValue\",\"imgMoved\",\"zoomValueChanged\",\"imageOrientationChanged\"),imageIsSmallerThenCanvas:NO,fileDropped:function(g){var h=this._imgPicker,f=g.x?SC.pointInRect({x:g.x,y:g.y},h.get(\"frame\")):YES,e=PhotoPicker.photoUploadController;if(f){if(g.errorCode){CK.Photo.displayUploaderErrors(g.errorCode,PhotoPicker.alertIconHash)}else{if(!g.fileType||g.fileType.indexOf(\"image\")===0){e.activeXImageDropped(g.fileData)}else{e._errorForFile(CW.UPLOADER_INCOMPATIBLE_FILE_TYPE)}}}},uploadNewPhoto:function(){if(!CK.ActiveXView.needsActiveX()){return}var e=CK.ActiveXView.currentView,d=NO;if(e&&e.get(\"isInitialized\")){try{YachtV2.openSelectFileDialogWithExtensions(\"*\");d=YES}catch(f){SC.warn(\"ActiveX control not found\")}}if(!d){CW.Alert.show({image:PhotoPicker.alertIconHash,message:\"Dialog.PhotoPicker.ActiveXRequired.Title\".loc(),description:\"Dialog.PhotoPicker.ActiveXRequired.Text\".loc(),rightButton:\"Dialog.PhotoPicker.Button.OK\".loc(),middleButton:{title:\"Dialog.PhotoPicker.Button.LearnMore\".loc(),action:function(){window.open(\"Dialog.PhotoPicker.ActiveXRequired.LearnMore.URL\".loc())}}})}},cleanup:function(){if(this._imgPicker){this._imgPicker.remove();this._imgPicker=null}this.set(\"imageDragged\",NO);this.set(\"imgHeight\",CK.Photo.CONTACT_PHOTO_HEIGHT);this.set(\"imgWidth\",CK.Photo.CONTACT_PHOTO_WIDTH);this.set(\"imgOrientation\",1);this.set(\"sliderValue\",0);this.set(\"imgMoved\",NO);this.set(\"target\",null);this.set(\"action\",null);this.set(\"photoUrl\",undefined);this.set(\"photoCrop\",undefined);this.set(\"photoSignature\",null);this.set(\"origPhotoUrl\",null);this.set(\"tempImgUploadError\",NO);this.set(\"initialSize\",null);this.set(\"zoomValueChanged\",NO);this.set(\"isInErrorState\",NO);this.set(\"errorCode\",CK.Photo.PHOTO_NO_ERROR);this.set(\"chooseButtonFlag\",YES);this.set(\"imageOrientationChanged\",NO)},callExitAction:function(){var h=PhotoPicker.photoUploadController,k=this.get(\"target\"),l=this.get(\"action\"),m=this.get(\"photoUrl\"),j=m,g=this.get(\"photoCrop\");if(k&&l&&j){k.tryToPerform(l,{photoUrl:h.get(\"currentUrl\"),photoCrop:g})}},_errorForFile:function(b){switch(b){case CW.UPLOADER_INCOMPATIBLE_FILE_TYPE:PhotoPicker.statechart.sendEvent(\"invalidFormat\")}},inverseWidthAndHeight:function(){var b=this.get(\"imgWidth\");this.set(\"imgWidth\",this.get(\"imgHeight\"));this.set(\"imgHeight\",b)},savePhoto:function(d,b,f,g){if(this.get(\"isDoneButtonEnabled\")){var c,e,a;c=\"%@/am/users\".fmt(SteedOS.getUrlForServiceName(\"admin\")),e=CS.Request.putUrl(c);if(b){if(f&&g){a={Users:[{photoUrl:b,photoCrop:d,userId:SteedOS.getUser().dsid,height:f,width:g}]}}else{a={Users:[{photoUrl:b,photoCrop:d,userId:SteedOS.getUser().dsid}]}}}else{a={Users:[{photoCrop:d,userId:SteedOS.getUser().dsid}]}}e.set(\"body\",a),e.notify(200,this,this._savePhotoSuccess),e.notify(0,this,this._savePhotoError),e.send()}},_savePhotoSuccess:function(b){var a=b.get(\"body\");if(a){if(a.errors){this._savePhotoError(b)}else{var d=PhotoPicker.photoUploadController.get(\"previousUrl\");if(d&&d!=\"\"&&d!=this.get(\"currentUrl\")){var e=function(){};var c=function(){};CS.Attachment.deleteUserPhoto(d,e,c)}}}return YES},_savePhotoError:function(a){return YES}});if(!window.console){window.console={};window.console.log=function(b){};window.console.dir=function(b){}}if(!Array.indexOf){Array.prototype.indexOf=function(c){for(var d=0;d<this.length;d++){if(this[d]==c){return d}}return -1}}SC.metricsFor(\"en-us\",{\"PhotoPicker.picker.height\":261});SC.stringsFor(\"en-us\",{\"PhotoPicker.DragPhoto\":\"Drag\\nPhoto\\nHere\",\"Button.ImagePicker.UploadNewPhoto\":\"Choose Photo...\",\"Button.ImagePicker.InstallPlugin\":\"Install Plugin...\",\"Button.ImagePicker.Cancel\":\"Cancel\",\"Button.ImagePicker.Done\":\"Done\",\"PhotoPicker.InvalidFormat.Title\":\"Invalid Format\",\"PhotoPicker.InvalidFormat.Message\":\"Make sure your photo is a JPEG, GIF, PNG or BMP and try again.\",\"PhotoPicker.PhotoTooBig.Title\":\"Photo Is Too Big\",\"PhotoPicker.PhotoTooBig.Message\":\"Make sure your photo is under 10MB, and then try again.\",\"PhotoPicker.PluginRequired.Title\":\"Plugin Required\",\"PhotoPicker.PluginRequired.Message\":'Adding or Editing a photo requires the SteedOS Web App Plugin. \\n<a target=\"_BLANK\" href=\"http://help.steedos.com/\">Learn more...</a>',\"PhotoPicker.ServerError.Title\":\"Server Error\",\"PhotoPicker.PhotoLoadError.Message\":\"Your photo couldn't be uploaded at this time. Try again later.\",\"PhotoPicker.PhotoLoadingFailed\":\"Could Not Load Photo\",\"PhotoPicker.UploadingPhoto\":\"Uploading Photo\",\"Dialog.PhotoPicker.ActiveXRequired.Title\":\"Browser Add-on Required\",\"Dialog.PhotoPicker.ActiveXRequired.Text\":\"To Save photos, SteedOS Extras for Internet Explorer must be installed.\",\"Dialog.PhotoPicker.ActiveXRequired.LearnMore.URL\":\"http://help.steedos.com/\",\"Dialog.PhotoPicker.Button.LearnMore\":\"Learn More\",\"Dialog.PhotoPicker.Button.OK\":\"OK\",\"PhotoPicker.ActiveXNotInstalled.MessageLabel\":\"Browser\\nAdd-on\\nRequired\"});(function(){this.canvg=function(o,a,u){if(o==null&&a==null&&u==null){var s=document.getElementsByTagName(\"svg\");for(var q=0;q<s.length;q++){var r=s[q];var n=document.createElement(\"canvas\");n.width=r.clientWidth;n.height=r.clientHeight;r.parentNode.insertBefore(n,r);r.parentNode.removeChild(r);var t=document.createElement(\"div\");t.appendChild(r);canvg(n,t.innerHTML)}return}if(typeof o==\"string\"){o=document.getElementById(o)}var p;if(o.svg==null){p=b();o.svg=p}else{p=o.svg;p.stop()}p.opts=u;var c=o.getContext(\"2d\");if(typeof(a.documentElement)!=\"undefined\"){p.loadXmlDoc(c,a)}else{if(a.substr(0,1)==\"<\"){p.loadXml(c,a)}else{p.load(c,a)}}};function b(){var a={};a.FRAMERATE=30;a.MAX_VIRTUAL_PIXELS=30000;a.init=function(d){a.Definitions={};a.Styles={};a.Animations=[];a.Images=[];a.ctx=d;a.readyToConvertToDataURL=false;a.ViewPort=new (function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(c,f){this.viewPorts.push({width:c,height:f})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(c){if(c!=null&&typeof(c)==\"number\"){return c}if(c==\"x\"){return this.width()}if(c==\"y\"){return this.height()}return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}})};a.init();a.ImagesLoaded=function(){for(var d=0;d<a.Images.length;d++){if(!a.Images[d].loaded){return false}}return true};a.trim=function(d){return d.replace(/^\\s+|\\s+$/g,\"\")};a.compressSpaces=function(d){return d.replace(/[\\s\\r\\t\\n]+/gm,\" \")};a.ajax=function(e){var f;if(window.XMLHttpRequest){f=new XMLHttpRequest()}else{f=new ActiveXObject(\"Microsoft.XMLHTTP\")}if(f){f.open(\"GET\",e,false);f.send(null);return f.responseText}return null};a.parseXml=function(h){if(window.DOMParser){var f=new DOMParser();return f.parseFromString(h,\"text/xml\")}else{h=h.replace(/<!DOCTYPE svg[^>]*>/,\"\");var g=new ActiveXObject(\"Microsoft.XMLDOM\");g.async=\"false\";g.loadXML(h);return g}};a.Property=function(h,f){this.name=h;this.value=f;this.hasValue=function(){return(this.value!=null&&this.value!=\"\")};this.numValue=function(){if(!this.hasValue()){return 0}var c=parseFloat(this.value);if((this.value+\"\").match(/%$/)){c=c/100}return c};this.valueOrDefault=function(c){if(this.hasValue()){return this.value}return c};this.numValueOrDefault=function(c){if(this.hasValue()){return this.numValue()}return c};var g=this;this.Color={addOpacity:function(d){var c=g.value;if(d!=null&&d!=\"\"){var e=new RGBColor(g.value);if(e.ok){c=\"rgba(\"+e.r+\", \"+e.g+\", \"+e.b+\", \"+d+\")\"}}return new a.Property(g.name,c)}};this.Definition={getDefinition:function(){var c=g.value.replace(/^(url\\()?#([^\\)]+)\\)?$/,\"$2\");return a.Definitions[c]},isUrl:function(){return g.value.indexOf(\"url(\")==0},getFillStyle:function(c){var d=this.getDefinition();if(d!=null&&d.createGradient){return d.createGradient(a.ctx,c)}if(d!=null&&d.createPattern){return d.createPattern(a.ctx,c)}return null}};this.Length={DPI:function(c){return 96},EM:function(c){var e=12;var d=new a.Property(\"fontSize\",a.Font.Parse(a.ctx.font).fontSize);if(d.hasValue()){e=d.Length.toPixels(c)}return e},toPixels:function(c){if(!g.hasValue()){return 0}var d=g.value+\"\";if(d.match(/em$/)){return g.numValue()*this.EM(c)}if(d.match(/ex$/)){return g.numValue()*this.EM(c)/2}if(d.match(/px$/)){return g.numValue()}if(d.match(/pt$/)){return g.numValue()*1.25}if(d.match(/pc$/)){return g.numValue()*15}if(d.match(/cm$/)){return g.numValue()*this.DPI(c)/2.54}if(d.match(/mm$/)){return g.numValue()*this.DPI(c)/25.4}if(d.match(/in$/)){return g.numValue()*this.DPI(c)}if(d.match(/%$/)){return g.numValue()*a.ViewPort.ComputeSize(c)}return g.numValue()}};this.Time={toMilliseconds:function(){if(!g.hasValue()){return 0}var c=g.value+\"\";if(c.match(/s$/)){return g.numValue()*1000}if(c.match(/ms$/)){return g.numValue()}return g.numValue()}};this.Angle={toRadians:function(){if(!g.hasValue()){return 0}var c=g.value+\"\";if(c.match(/deg$/)){return g.numValue()*(Math.PI/180)}if(c.match(/grad$/)){return g.numValue()*(Math.PI/200)}if(c.match(/rad$/)){return g.numValue()}return g.numValue()*(Math.PI/180)}}};a.Font=new (function(){this.Styles=[\"normal\",\"italic\",\"oblique\",\"inherit\"];this.Variants=[\"normal\",\"small-caps\",\"inherit\"];this.Weights=[\"normal\",\"bold\",\"bolder\",\"lighter\",\"100\",\"200\",\"300\",\"400\",\"500\",\"600\",\"700\",\"800\",\"900\",\"inherit\"];this.CreateFont=function(c,n,p,f,q,o){var m=o!=null?this.Parse(o):this.CreateFont(\"\",\"\",\"\",\"\",\"\",a.ctx.font);return{fontFamily:q||m.fontFamily,fontSize:f||m.fontSize,fontStyle:c||m.fontStyle,fontWeight:p||m.fontWeight,fontVariant:n||m.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(\" \")}}};var d=this;this.Parse=function(n){var m={};var f=a.trim(a.compressSpaces(n||\"\")).split(\" \");var c={fontSize:false,fontStyle:false,fontWeight:false,fontVariant:false};var p=\"\";for(var o=0;o<f.length;o++){if(!c.fontStyle&&d.Styles.indexOf(f[o])!=-1){if(f[o]!=\"inherit\"){m.fontStyle=f[o]}c.fontStyle=true}else{if(!c.fontVariant&&d.Variants.indexOf(f[o])!=-1){if(f[o]!=\"inherit\"){m.fontVariant=f[o]}c.fontStyle=c.fontVariant=true}else{if(!c.fontWeight&&d.Weights.indexOf(f[o])!=-1){if(f[o]!=\"inherit\"){m.fontWeight=f[o]}c.fontStyle=c.fontVariant=c.fontWeight=true}else{if(!c.fontSize){if(f[o]!=\"inherit\"){m.fontSize=f[o].split(\"/\")[0]}c.fontStyle=c.fontVariant=c.fontWeight=c.fontSize=true}else{if(f[o]!=\"inherit\"){p+=f[o]}}}}}}if(p!=\"\"){m.fontFamily=p}return m}});a.ToNumberArray=function(f){var h=a.trim(a.compressSpaces((f||\"\").replace(/,/g,\" \"))).split(\" \");for(var g=0;g<h.length;g++){h[g]=parseFloat(h[g])}return h};a.Point=function(f,e){this.x=f;this.y=e;this.angleTo=function(c){return Math.atan2(c.y-this.y,c.x-this.x)};this.applyTransform=function(h){var d=this.x*h[0]+this.y*h[2]+h[4];var c=this.x*h[1]+this.y*h[3]+h[5];this.x=d;this.y=c}};a.CreatePoint=function(e){var f=a.ToNumberArray(e);return new a.Point(f[0],f[1])};a.CreatePath=function(h){var k=a.ToNumberArray(h);var g=[];for(var j=0;j<k.length;j+=2){g.push(new a.Point(k[j],k[j+1]))}return g};a.BoundingBox=function(j,g,k,h){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(d,c){if(d!=null){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=d;this.x2=d}if(d<this.x1){this.x1=d}if(d>this.x2){this.x2=d}}if(c!=null){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=c;this.y2=c}if(c<this.y1){this.y1=c}if(c>this.y2){this.y2=c}}};this.addX=function(c){this.addPoint(c,null)};this.addY=function(c){this.addPoint(null,c)};this.addBoundingBox=function(c){this.addPoint(c.x1,c.y1);this.addPoint(c.x2,c.y2)};this.addQuadraticCurve=function(r,s,v,w,e,f){var t=r+2/3*(v-r);var u=s+2/3*(w-s);var c=t+1/3*(e-r);var d=u+1/3*(f-s);this.addBezierCurve(r,s,t,c,u,d,e,f)};this.addBezierCurve=function(t,C,M,O,G,J,e,f){var L=[t,C],N=[M,O],P=[G,J],Q=[e,f];this.addPoint(L[0],L[1]);this.addPoint(Q[0],Q[1]);for(i=0;i<=1;i++){var d=function(l){return Math.pow(1-l,3)*L[i]+3*Math.pow(1-l,2)*l*N[i]+3*(1-l)*Math.pow(l,2)*P[i]+Math.pow(l,3)*Q[i]};var I=6*L[i]-12*N[i]+6*P[i];var F=-3*L[i]+9*N[i]-9*P[i]+3*Q[i];var c=3*N[i]-3*L[i];if(F==0){if(I==0){continue}var D=-c/I;if(0<D&&D<1){if(i==0){this.addX(d(D))}if(i==1){this.addY(d(D))}}continue}var K=Math.pow(I,2)-4*c*F;if(K<0){continue}var E=(-I+Math.sqrt(K))/(2*F);if(0<E&&E<1){if(i==0){this.addX(d(E))}if(i==1){this.addY(d(E))}}var H=(-I-Math.sqrt(K))/(2*F);if(0<H&&H<1){if(i==0){this.addX(d(H))}if(i==1){this.addY(d(H))}}}};this.isPointInBox=function(d,c){return(this.x1<=d&&d<=this.x2&&this.y1<=c&&c<=this.y2)};this.addPoint(j,g);this.addPoint(k,h)};a.Transform=function(q){var l=this;this.Type={};this.Type.translate=function(c){this.p=a.CreatePoint(c);this.apply=function(d){d.translate(this.p.x||0,this.p.y||0)};this.applyToPoint=function(d){d.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(c){var d=a.ToNumberArray(c);this.angle=new a.Property(\"angle\",d[0]);this.cx=d[1]||0;this.cy=d[2]||0;this.apply=function(e){e.translate(this.cx,this.cy);e.rotate(this.angle.Angle.toRadians());e.translate(-this.cx,-this.cy)};this.applyToPoint=function(f){var e=this.angle.Angle.toRadians();f.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);f.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]);f.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(c){this.p=a.CreatePoint(c);this.apply=function(d){d.scale(this.p.x||1,this.p.y||this.p.x||1)};this.applyToPoint=function(d){d.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(c){this.m=a.ToNumberArray(c);this.apply=function(d){d.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.applyToPoint=function(d){d.applyTransform(this.m)}};this.Type.SkewBase=function(c){this.base=l.Type.matrix;this.base(c);this.angle=new a.Property(\"angle\",c)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(c){this.base=l.Type.SkewBase;this.base(c);this.m=[1,0,Math.tan(this.angle.Angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(c){this.base=l.Type.SkewBase;this.base(c);this.m=[1,Math.tan(this.angle.Angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(d){for(var c=0;c<this.transforms.length;c++){this.transforms[c].apply(d)}};this.applyToPoint=function(c){for(var d=0;d<this.transforms.length;d++){this.transforms[d].applyToPoint(c)}};var k=a.trim(a.compressSpaces(q)).split(/\\s(?=[a-z])/);for(var o=0;o<k.length;o++){if(k[o]===\"\"){continue}var m=k[o].split(\"(\")[0];var n=k[o].split(\"(\")[1].replace(\")\",\"\");var p=new this.Type[m](n);this.transforms.push(p)}};a.AspectRatio=function(I,u,G,A,t,H,D,E,v,w){u=a.compressSpaces(u);u=u.replace(/^defer\\s/,\"\");var B=u.split(\" \")[0]||\"xMidYMid\";var F=u.split(\" \")[1]||\"meet\";var x=G/A;var y=t/H;var C=Math.min(x,y);var z=Math.max(x,y);if(F==\"meet\"){A*=C;H*=C}if(F==\"slice\"){A*=z;H*=z}v=new a.Property(\"refX\",v);w=new a.Property(\"refY\",w);if(v.hasValue()&&w.hasValue()){I.translate(-C*v.Length.toPixels(\"x\"),-C*w.Length.toPixels(\"y\"))}else{if(B.match(/^xMid/)&&((F==\"meet\"&&C==y)||(F==\"slice\"&&z==y))){I.translate(G/2-A/2,0)}if(B.match(/YMid$/)&&((F==\"meet\"&&C==x)||(F==\"slice\"&&z==x))){I.translate(0,t/2-H/2)}if(B.match(/^xMax/)&&((F==\"meet\"&&C==y)||(F==\"slice\"&&z==y))){I.translate(G-A,0)}if(B.match(/YMax$/)&&((F==\"meet\"&&C==x)||(F==\"slice\"&&z==x))){I.translate(0,t-H)}}if(B==\"none\"){I.scale(x,y)}else{if(F==\"meet\"){I.scale(C,C)}else{if(F==\"slice\"){I.scale(z,z)}}}I.translate(D==null?0:-D,E==null?0:-E)};a.Element={};a.Element.ElementBase=function(s){this.attributes={};this.styles={};this.children=[];this.attribute=function(e,d){var c=this.attributes[e];if(c!=null){return c}c=new a.Property(e,\"\");if(d==true){this.attributes[e]=c}return c};this.style=function(h,d){var g=this.styles[h];if(g!=null){return g}var c=this.attribute(h);if(c!=null&&c.hasValue()){return c}var f=this.parent;if(f!=null){var e=f.style(h);if(e!=null&&e.hasValue()){return e}}g=new a.Property(h,\"\");if(d==true){this.styles[h]=g}return g};this.render=function(d){if(this.attribute(\"display\").value==\"none\"){return}if(this.attribute(\"visibility\").value==\"hidden\"){return}d.save();this.setContext(d);if(this.attribute(\"mask\").hasValue()){var c=this.attribute(\"mask\").Definition.getDefinition();if(c!=null){c.apply(d,this)}}else{this.renderChildren(d)}this.clearContext(d);d.restore()};this.setContext=function(c){};this.clearContext=function(c){};this.renderChildren=function(c){for(var d=0;d<this.children.length;d++){this.children[d].render(c)}};this.addChild=function(e,c){var d=e;if(c){d=a.CreateElement(e)}d.parent=this;this.children.push(d)};if(s!=null&&s.nodeType==1){for(var p=0;p<s.childNodes.length;p++){var w=s.childNodes[p];if(w.nodeType==1){this.addChild(w,true)}}for(var p=0;p<s.attributes.length;p++){var t=s.attributes[p];this.attributes[t.nodeName]=new a.Property(t.nodeName,t.nodeValue)}var j=a.Styles[s.nodeName];if(j!=null){for(var u in j){this.styles[u]=j[u]}}if(this.attribute(\"class\").hasValue()){var r=a.compressSpaces(this.attribute(\"class\").value).split(\" \");for(var q=0;q<r.length;q++){j=a.Styles[\".\"+r[q]];if(j!=null){for(var u in j){this.styles[u]=j[u]}}j=a.Styles[s.nodeName+\".\"+r[q]];if(j!=null){for(var u in j){this.styles[u]=j[u]}}}}if(this.attribute(\"style\").hasValue()){var j=this.attribute(\"style\").value.split(\";\");for(var p=0;p<j.length;p++){if(a.trim(j[p])!=\"\"){var v=j[p].split(\":\");var u=a.trim(v[0]);var o=a.trim(v[1]);this.styles[u]=new a.Property(u,o)}}}if(this.attribute(\"id\").hasValue()){if(a.Definitions[this.attribute(\"id\").value]==null){a.Definitions[this.attribute(\"id\").value]=this}}}};a.Element.RenderedElementBase=function(d){this.base=a.Element.ElementBase;this.base(d);this.setContext=function(n){if(this.style(\"fill\").Definition.isUrl()){var o=this.style(\"fill\").Definition.getFillStyle(this);if(o!=null){n.fillStyle=o}}else{if(this.style(\"fill\").hasValue()){var m=this.style(\"fill\");if(this.style(\"fill-opacity\").hasValue()){m=m.Color.addOpacity(this.style(\"fill-opacity\").value)}n.fillStyle=(m.value==\"none\"?\"rgba(0,0,0,0)\":m.value)}}if(this.style(\"stroke\").Definition.isUrl()){var o=this.style(\"stroke\").Definition.getFillStyle(this);if(o!=null){n.strokeStyle=o}}else{if(this.style(\"stroke\").hasValue()){var c=this.style(\"stroke\");if(this.style(\"stroke-opacity\").hasValue()){c=c.Color.addOpacity(this.style(\"stroke-opacity\").value)}n.strokeStyle=(c.value==\"none\"?\"rgba(0,0,0,0)\":c.value)}}if(this.style(\"stroke-width\").hasValue()){n.lineWidth=this.style(\"stroke-width\").Length.toPixels()}if(this.style(\"stroke-linecap\").hasValue()){n.lineCap=this.style(\"stroke-linecap\").value}if(this.style(\"stroke-linejoin\").hasValue()){n.lineJoin=this.style(\"stroke-linejoin\").value}if(this.style(\"stroke-miterlimit\").hasValue()){n.miterLimit=this.style(\"stroke-miterlimit\").value}if(typeof(n.font)!=\"undefined\"){n.font=a.Font.CreateFont(this.style(\"font-style\").value,this.style(\"font-variant\").value,this.style(\"font-weight\").value,this.style(\"font-size\").hasValue()?this.style(\"font-size\").Length.toPixels()+\"px\":\"\",this.style(\"font-family\").value).toString()}if(this.attribute(\"transform\").hasValue()){var l=new a.Transform(this.attribute(\"transform\").value);l.apply(n)}if(this.attribute(\"clip-path\").hasValue()){var k=this.attribute(\"clip-path\").Definition.getDefinition();if(k!=null){k.apply(n)}}if(this.style(\"opacity\").hasValue()){n.globalAlpha=this.style(\"opacity\").numValue()}}};a.Element.RenderedElementBase.prototype=new a.Element.ElementBase;a.Element.PathElementBase=function(d){this.base=a.Element.RenderedElementBase;this.base(d);this.path=function(c){if(c!=null){c.beginPath()}return new a.BoundingBox()};this.renderChildren=function(j){this.path(j);a.Mouse.checkPath(this,j);if(j.fillStyle!=\"\"){j.fill()}if(j.strokeStyle!=\"\"){j.stroke()}var c=this.getMarkers();if(c!=null){if(this.attribute(\"marker-start\").Definition.isUrl()){var k=this.attribute(\"marker-start\").Definition.getDefinition();k.render(j,c[0][0],c[0][1])}if(this.attribute(\"marker-mid\").Definition.isUrl()){var k=this.attribute(\"marker-mid\").Definition.getDefinition();for(var h=1;h<c.length-1;h++){k.render(j,c[h][0],c[h][1])}}if(this.attribute(\"marker-end\").Definition.isUrl()){var k=this.attribute(\"marker-end\").Definition.getDefinition();k.render(j,c[c.length-1][0],c[c.length-1][1])}}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase;a.Element.svg=function(d){this.base=a.Element.RenderedElementBase;this.base(d);this.baseClearContext=this.clearContext;this.clearContext=function(c){this.baseClearContext(c);a.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(p){p.strokeStyle=\"rgba(0,0,0,0)\";p.lineCap=\"butt\";p.lineJoin=\"miter\";p.miterLimit=4;this.baseSetContext(p);if(this.attribute(\"x\").hasValue()&&this.attribute(\"y\").hasValue()){p.translate(this.attribute(\"x\").Length.toPixels(\"x\"),this.attribute(\"y\").Length.toPixels(\"y\"))}var o=a.ViewPort.width();var q=a.ViewPort.height();if(typeof(this.root)==\"undefined\"&&this.attribute(\"width\").hasValue()&&this.attribute(\"height\").hasValue()){o=this.attribute(\"width\").Length.toPixels(\"x\");q=this.attribute(\"height\").Length.toPixels(\"y\");var r=0;var c=0;if(this.attribute(\"refX\").hasValue()&&this.attribute(\"refY\").hasValue()){r=-this.attribute(\"refX\").Length.toPixels(\"x\");c=-this.attribute(\"refY\").Length.toPixels(\"y\")}p.beginPath();p.moveTo(r,c);p.lineTo(o,c);p.lineTo(o,q);p.lineTo(r,q);p.closePath();p.clip()}a.ViewPort.SetCurrent(o,q);if(this.attribute(\"viewBox\").hasValue()){var n=a.ToNumberArray(this.attribute(\"viewBox\").value);var s=n[0];var m=n[1];o=n[2];q=n[3];a.AspectRatio(p,this.attribute(\"preserveAspectRatio\").value,a.ViewPort.width(),o,a.ViewPort.height(),q,s,m,this.attribute(\"refX\").value,this.attribute(\"refY\").value);a.ViewPort.RemoveCurrent();a.ViewPort.SetCurrent(n[2],n[3])}}};a.Element.svg.prototype=new a.Element.RenderedElementBase;a.Element.rect=function(d){this.base=a.Element.PathElementBase;this.base(d);this.path=function(o){var p=this.attribute(\"x\").Length.toPixels(\"x\");var c=this.attribute(\"y\").Length.toPixels(\"y\");var n=this.attribute(\"width\").Length.toPixels(\"x\");var q=this.attribute(\"height\").Length.toPixels(\"y\");var l=this.attribute(\"rx\").Length.toPixels(\"x\");var m=this.attribute(\"ry\").Length.toPixels(\"y\");if(this.attribute(\"rx\").hasValue()&&!this.attribute(\"ry\").hasValue()){m=l}if(this.attribute(\"ry\").hasValue()&&!this.attribute(\"rx\").hasValue()){l=m}if(o!=null){o.beginPath();o.moveTo(p+l,c);o.lineTo(p+n-l,c);o.quadraticCurveTo(p+n,c,p+n,c+m);o.lineTo(p+n,c+q-m);o.quadraticCurveTo(p+n,c+q,p+n-l,c+q);o.lineTo(p+l,c+q);o.quadraticCurveTo(p,c+q,p,c+q-m);o.lineTo(p,c+m);o.quadraticCurveTo(p,c,p+l,c);o.closePath()}return new a.BoundingBox(p,c,p+n,c+q)}};a.Element.rect.prototype=new a.Element.PathElementBase;a.Element.circle=function(d){this.base=a.Element.PathElementBase;this.base(d);this.path=function(j){var k=this.attribute(\"cx\").Length.toPixels(\"x\");var c=this.attribute(\"cy\").Length.toPixels(\"y\");var h=this.attribute(\"r\").Length.toPixels();if(j!=null){j.beginPath();j.arc(k,c,h,0,Math.PI*2,true);j.closePath()}return new a.BoundingBox(k-h,c-h,k+h,c+h)}};a.Element.circle.prototype=new a.Element.PathElementBase;a.Element.ellipse=function(d){this.base=a.Element.PathElementBase;this.base(d);this.path=function(n){var l=4*((Math.sqrt(2)-1)/3);var k=this.attribute(\"rx\").Length.toPixels(\"x\");var m=this.attribute(\"ry\").Length.toPixels(\"y\");var o=this.attribute(\"cx\").Length.toPixels(\"x\");var c=this.attribute(\"cy\").Length.toPixels(\"y\");if(n!=null){n.beginPath();n.moveTo(o,c-m);n.bezierCurveTo(o+(l*k),c-m,o+k,c-(l*m),o+k,c);n.bezierCurveTo(o+k,c+(l*m),o+(l*k),c+m,o,c+m);n.bezierCurveTo(o-(l*k),c+m,o-k,c+(l*m),o-k,c);n.bezierCurveTo(o-k,c-(l*m),o-(l*k),c-m,o,c-m);n.closePath()}return new a.BoundingBox(o-k,c-m,o+k,c+m)}};a.Element.ellipse.prototype=new a.Element.PathElementBase;a.Element.line=function(d){this.base=a.Element.PathElementBase;this.base(d);this.getPoints=function(){return[new a.Point(this.attribute(\"x1\").Length.toPixels(\"x\"),this.attribute(\"y1\").Length.toPixels(\"y\")),new a.Point(this.attribute(\"x2\").Length.toPixels(\"x\"),this.attribute(\"y2\").Length.toPixels(\"y\"))]};this.path=function(f){var c=this.getPoints();if(f!=null){f.beginPath();f.moveTo(c[0].x,c[0].y);f.lineTo(c[1].x,c[1].y)}return new a.BoundingBox(c[0].x,c[0].y,c[1].x,c[1].y)};this.getMarkers=function(){var c=this.getPoints();var f=c[0].angleTo(c[1]);return[[c[0],f],[c[1],f]]}};a.Element.line.prototype=new a.Element.PathElementBase;a.Element.polyline=function(d){this.base=a.Element.PathElementBase;this.base(d);this.points=a.CreatePath(this.attribute(\"points\").value);this.path=function(h){var c=new a.BoundingBox(this.points[0].x,this.points[0].y);if(h!=null){h.beginPath();h.moveTo(this.points[0].x,this.points[0].y)}for(var g=1;g<this.points.length;g++){c.addPoint(this.points[g].x,this.points[g].y);if(h!=null){h.lineTo(this.points[g].x,this.points[g].y)}}return c};this.getMarkers=function(){var c=[];for(var f=0;f<this.points.length-1;f++){c.push([this.points[f],this.points[f].angleTo(this.points[f+1])])}c.push([this.points[this.points.length-1],c[c.length-1][1]]);return c}};a.Element.polyline.prototype=new a.Element.PathElementBase;a.Element.polygon=function(d){this.base=a.Element.polyline;this.base(d);this.basePath=this.path;this.path=function(f){var c=this.basePath(f);if(f!=null){f.lineTo(this.points[0].x,this.points[0].y);f.closePath()}return c}};a.Element.polygon.prototype=new a.Element.polyline;a.Element.path=function(f){this.base=a.Element.PathElementBase;this.base(f);var d=this.attribute(\"d\").value;d=d.replace(/,/gm,\" \");d=d.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,\"$1 $2\");d=d.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,\"$1 $2\");d=d.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\\s])/gm,\"$1 $2\");d=d.replace(/([^\\s])([MmZzLlHhVvCcSsQqTtAa])/gm,\"$1 $2\");d=d.replace(/([0-9])([+\\-])/gm,\"$1 $2\");d=d.replace(/(\\.[0-9]*)(\\.)/gm,\"$1 $2\");d=d.replace(/([Aa](\\s+[0-9]+){3})\\s+([01])\\s*([01])/gm,\"$1 $3 $4 \");d=a.compressSpaces(d);d=a.trim(d);this.PathParser=new (function(c){this.tokens=c.split(\" \");this.reset=function(){this.i=-1;this.command=\"\";this.previousCommand=\"\";this.start=new a.Point(0,0);this.control=new a.Point(0,0);this.current=new a.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){if(this.isEnd()){return true}return this.tokens[this.i+1].match(/[A-Za-z]/)!=null};this.isRelativeCommand=function(){return this.command==this.command.toLowerCase()};this.getToken=function(){this.i=this.i+1;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var e=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)};this.getAsControlPoint=function(){var e=this.getPoint();this.control=e;return e};this.getAsCurrentPoint=function(){var e=this.getPoint();this.current=e;return e};this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!=\"c\"&&this.previousCommand.toLowerCase()!=\"s\"){return this.current}var e=new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return e};this.makeAbsolute=function(e){if(this.isRelativeCommand()){e.x=this.current.x+e.x;e.y=this.current.y+e.y}return e};this.addMarker=function(h,e){this.addMarkerAngle(h,e==null?null:e.angleTo(h))};this.addMarkerAngle=function(e,h){this.points.push(e);this.angles.push(h)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++){if(this.angles[e]==null){for(var h=e+1;h<this.angles.length;h++){if(this.angles[h]!=null){this.angles[e]=this.angles[h];break}}}}return this.angles}})(d);this.path=function(S){var v=this.PathParser;v.reset();var X=new a.BoundingBox();if(S!=null){S.beginPath()}while(!v.isEnd()){v.nextCommand();switch(v.command.toUpperCase()){case\"M\":var V=v.getAsCurrentPoint();v.addMarker(V);X.addPoint(V.x,V.y);if(S!=null){S.moveTo(V.x,V.y)}v.start=v.current;while(!v.isCommandOrEnd()){var V=v.getAsCurrentPoint();v.addMarker(V);X.addPoint(V.x,V.y);if(S!=null){S.lineTo(V.x,V.y)}}break;case\"L\":while(!v.isCommandOrEnd()){var m=v.current;var V=v.getAsCurrentPoint();v.addMarker(V,m);X.addPoint(V.x,V.y);if(S!=null){S.lineTo(V.x,V.y)}}break;case\"H\":while(!v.isCommandOrEnd()){var ai=new a.Point((v.isRelativeCommand()?v.current.x:0)+v.getScalar(),v.current.y);v.addMarker(ai,v.current);v.current=ai;X.addPoint(v.current.x,v.current.y);if(S!=null){S.lineTo(v.current.x,v.current.y)}}break;case\"V\":while(!v.isCommandOrEnd()){var ai=new a.Point(v.current.x,(v.isRelativeCommand()?v.current.y:0)+v.getScalar());v.addMarker(ai,v.current);v.current=ai;X.addPoint(v.current.x,v.current.y);if(S!=null){S.lineTo(v.current.x,v.current.y)}}break;case\"C\":while(!v.isCommandOrEnd()){var s=v.current;var ag=v.getPoint();var af=v.getAsControlPoint();var R=v.getAsCurrentPoint();v.addMarker(R,af);X.addBezierCurve(s.x,s.y,ag.x,ag.y,af.x,af.y,R.x,R.y);if(S!=null){S.bezierCurveTo(ag.x,ag.y,af.x,af.y,R.x,R.y)}}break;case\"S\":while(!v.isCommandOrEnd()){var s=v.current;var ag=v.getReflectedControlPoint();var af=v.getAsControlPoint();var R=v.getAsCurrentPoint();v.addMarker(R,af);X.addBezierCurve(s.x,s.y,ag.x,ag.y,af.x,af.y,R.x,R.y);if(S!=null){S.bezierCurveTo(ag.x,ag.y,af.x,af.y,R.x,R.y)}}break;case\"Q\":while(!v.isCommandOrEnd()){var s=v.current;var af=v.getAsControlPoint();var R=v.getAsCurrentPoint();v.addMarker(R,af);X.addQuadraticCurve(s.x,s.y,af.x,af.y,R.x,R.y);if(S!=null){S.quadraticCurveTo(af.x,af.y,R.x,R.y)}}break;case\"T\":while(!v.isCommandOrEnd()){var s=v.current;var af=v.getReflectedControlPoint();v.control=af;var R=v.getAsCurrentPoint();v.addMarker(R,af);X.addQuadraticCurve(s.x,s.y,af.x,af.y,R.x,R.y);if(S!=null){S.quadraticCurveTo(af.x,af.y,R.x,R.y)}}break;case\"A\":while(!v.isCommandOrEnd()){var s=v.current;var ab=v.getScalar();var ad=v.getScalar();var aj=v.getScalar()*(Math.PI/180);var T=v.getScalar();var ae=v.getScalar();var R=v.getAsCurrentPoint();var c=new a.Point(Math.cos(aj)*(s.x-R.x)/2+Math.sin(aj)*(s.y-R.y)/2,-Math.sin(aj)*(s.x-R.x)/2+Math.cos(aj)*(s.y-R.y)/2);var Q=Math.pow(c.x,2)/Math.pow(ab,2)+Math.pow(c.y,2)/Math.pow(ad,2);if(Q>1){ab*=Math.sqrt(Q);ad*=Math.sqrt(Q)}var aa=(T==ae?-1:1)*Math.sqrt(((Math.pow(ab,2)*Math.pow(ad,2))-(Math.pow(ab,2)*Math.pow(c.y,2))-(Math.pow(ad,2)*Math.pow(c.x,2)))/(Math.pow(ab,2)*Math.pow(c.y,2)+Math.pow(ad,2)*Math.pow(c.x,2)));if(isNaN(aa)){aa=0}var ac=new a.Point(aa*ab*c.y/ad,aa*-ad*c.x/ab);var ah=new a.Point((s.x+R.x)/2+Math.cos(aj)*ac.x-Math.sin(aj)*ac.y,(s.y+R.y)/2+Math.sin(aj)*ac.x+Math.cos(aj)*ac.y);var U=function(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2))};var Y=function(g,h){return(g[0]*h[0]+g[1]*h[1])/(U(g)*U(h))};var l=function(g,h){return(g[0]*h[1]<g[1]*h[0]?-1:1)*Math.acos(Y(g,h))};var e=l([1,0],[(c.x-ac.x)/ab,(c.y-ac.y)/ad]);var r=[(c.x-ac.x)/ab,(c.y-ac.y)/ad];var u=[(-c.x-ac.x)/ab,(-c.y-ac.y)/ad];var p=l(r,u);if(Y(r,u)<=-1){p=Math.PI}if(Y(r,u)>=1){p=0}if(ae==0&&p>0){p=p-2*Math.PI}if(ae==1&&p<0){p=p+2*Math.PI}var ak=new a.Point(ah.x-ab*Math.cos((e+p)/2),ah.y-ad*Math.sin((e+p)/2));v.addMarkerAngle(ak,(e+p)/2+(ae==0?1:-1)*Math.PI/2);v.addMarkerAngle(R,p+(ae==0?1:-1)*Math.PI/2);X.addPoint(R.x,R.y);if(S!=null){var Y=ab>ad?ab:ad;var W=ab>ad?1:ab/ad;var Z=ab>ad?ad/ab:1;S.translate(ah.x,ah.y);S.rotate(aj);S.scale(W,Z);S.arc(0,0,Y,e,e+p,1-ae);S.scale(1/W,1/Z);S.rotate(-aj);S.translate(-ah.x,-ah.y)}}break;case\"Z\":if(S!=null){S.closePath()}v.current=v.start}}return X};this.getMarkers=function(){var j=this.PathParser.getMarkerPoints();var c=this.PathParser.getMarkerAngles();var e=[];for(var k=0;k<j.length;k++){e.push([j[k],c[k]])}return e}};a.Element.path.prototype=new a.Element.PathElementBase;a.Element.pattern=function(d){this.base=a.Element.ElementBase;this.base(d);this.createPattern=function(k,j){var h=new a.Element.svg();h.attributes.viewBox=new a.Property(\"viewBox\",this.attribute(\"viewBox\").value);h.attributes.x=new a.Property(\"x\",this.attribute(\"x\").value);h.attributes.y=new a.Property(\"y\",this.attribute(\"y\").value);h.attributes.width=new a.Property(\"width\",this.attribute(\"width\").value);h.attributes.height=new a.Property(\"height\",this.attribute(\"height\").value);h.children=this.children;var c=document.createElement(\"canvas\");c.width=this.attribute(\"width\").Length.toPixels();c.height=this.attribute(\"height\").Length.toPixels();h.render(c.getContext(\"2d\"));return k.createPattern(c,\"repeat\")}};a.Element.pattern.prototype=new a.Element.ElementBase;a.Element.marker=function(d){this.base=a.Element.ElementBase;this.base(d);this.baseRender=this.render;this.render=function(j,k,c){j.translate(k.x,k.y);if(this.attribute(\"orient\").valueOrDefault(\"auto\")==\"auto\"){j.rotate(c)}if(this.attribute(\"markerUnits\").valueOrDefault(\"strokeWidth\")==\"strokeWidth\"){j.scale(j.lineWidth,j.lineWidth)}j.save();var h=new a.Element.svg();h.attributes.viewBox=new a.Property(\"viewBox\",this.attribute(\"viewBox\").value);h.attributes.refX=new a.Property(\"refX\",this.attribute(\"refX\").value);h.attributes.refY=new a.Property(\"refY\",this.attribute(\"refY\").value);h.attributes.width=new a.Property(\"width\",this.attribute(\"markerWidth\").value);h.attributes.height=new a.Property(\"height\",this.attribute(\"markerHeight\").value);h.attributes.fill=new a.Property(\"fill\",this.attribute(\"fill\").valueOrDefault(\"black\"));h.attributes.stroke=new a.Property(\"stroke\",this.attribute(\"stroke\").valueOrDefault(\"none\"));h.children=this.children;h.render(j);j.restore();if(this.attribute(\"markerUnits\").valueOrDefault(\"strokeWidth\")==\"strokeWidth\"){j.scale(1/j.lineWidth,1/j.lineWidth)}if(this.attribute(\"orient\").valueOrDefault(\"auto\")==\"auto\"){j.rotate(-c)}j.translate(-k.x,-k.y)}};a.Element.marker.prototype=new a.Element.ElementBase;a.Element.defs=function(d){this.base=a.Element.ElementBase;this.base(d);this.render=function(c){}};a.Element.defs.prototype=new a.Element.ElementBase;a.Element.GradientBase=function(g){this.base=a.Element.ElementBase;this.base(g);this.gradientUnits=this.attribute(\"gradientUnits\").valueOrDefault(\"objectBoundingBox\");this.stops=[];for(var h=0;h<this.children.length;h++){var f=this.children[h];this.stops.push(f)}this.getGradient=function(){};this.createGradient=function(c,y){var d=this;if(this.attribute(\"xlink:href\").hasValue()){d=this.attribute(\"xlink:href\").Definition.getDefinition()}var w=this.getGradient(c,y);for(var x=0;x<d.stops.length;x++){w.addColorStop(d.stops[x].offset,d.stops[x].color)}if(this.attribute(\"gradientTransform\").hasValue()){var u=a.ViewPort.viewPorts[0];var t=new a.Element.rect();t.attributes.x=new a.Property(\"x\",-a.MAX_VIRTUAL_PIXELS/3);t.attributes.y=new a.Property(\"y\",-a.MAX_VIRTUAL_PIXELS/3);t.attributes.width=new a.Property(\"width\",a.MAX_VIRTUAL_PIXELS);t.attributes.height=new a.Property(\"height\",a.MAX_VIRTUAL_PIXELS);var e=new a.Element.g();e.attributes.transform=new a.Property(\"transform\",this.attribute(\"gradientTransform\").value);e.children=[t];var s=new a.Element.svg();s.attributes.x=new a.Property(\"x\",0);s.attributes.y=new a.Property(\"y\",0);s.attributes.width=new a.Property(\"width\",u.width);s.attributes.height=new a.Property(\"height\",u.height);s.children=[e];var v=document.createElement(\"canvas\");v.width=u.width;v.height=u.height;var z=v.getContext(\"2d\");z.fillStyle=w;s.render(z);return z.createPattern(v,\"no-repeat\")}return w}};a.Element.GradientBase.prototype=new a.Element.ElementBase;a.Element.linearGradient=function(d){this.base=a.Element.GradientBase;this.base(d);this.getGradient=function(q,m){var c=m.getBoundingBox();var o=(this.gradientUnits==\"objectBoundingBox\"?c.x()+c.width()*this.attribute(\"x1\").numValue():this.attribute(\"x1\").Length.toPixels(\"x\"));var l=(this.gradientUnits==\"objectBoundingBox\"?c.y()+c.height()*this.attribute(\"y1\").numValue():this.attribute(\"y1\").Length.toPixels(\"y\"));var p=(this.gradientUnits==\"objectBoundingBox\"?c.x()+c.width()*this.attribute(\"x2\").numValue():this.attribute(\"x2\").Length.toPixels(\"x\"));var n=(this.gradientUnits==\"objectBoundingBox\"?c.y()+c.height()*this.attribute(\"y2\").numValue():this.attribute(\"y2\").Length.toPixels(\"y\"));return q.createLinearGradient(o,l,p,n)}};a.Element.linearGradient.prototype=new a.Element.GradientBase;a.Element.radialGradient=function(d){this.base=a.Element.GradientBase;this.base(d);this.getGradient=function(r,q){var m=q.getBoundingBox();var s=(this.gradientUnits==\"objectBoundingBox\"?m.x()+m.width()*this.attribute(\"cx\").numValue():this.attribute(\"cx\").Length.toPixels(\"x\"));var c=(this.gradientUnits==\"objectBoundingBox\"?m.y()+m.height()*this.attribute(\"cy\").numValue():this.attribute(\"cy\").Length.toPixels(\"y\"));var n=s;var p=c;if(this.attribute(\"fx\").hasValue()){n=(this.gradientUnits==\"objectBoundingBox\"?m.x()+m.width()*this.attribute(\"fx\").numValue():this.attribute(\"fx\").Length.toPixels(\"x\"))}if(this.attribute(\"fy\").hasValue()){p=(this.gradientUnits==\"objectBoundingBox\"?m.y()+m.height()*this.attribute(\"fy\").numValue():this.attribute(\"fy\").Length.toPixels(\"y\"))}var o=(this.gradientUnits==\"objectBoundingBox\"?(m.width()+m.height())/2*this.attribute(\"r\").numValue():this.attribute(\"r\").Length.toPixels());return r.createRadialGradient(n,p,0,s,c,o)}};a.Element.radialGradient.prototype=new a.Element.GradientBase;a.Element.stop=function(e){this.base=a.Element.ElementBase;this.base(e);this.offset=this.attribute(\"offset\").numValue();var f=this.style(\"stop-color\");if(this.style(\"stop-opacity\").hasValue()){f=f.Color.addOpacity(this.style(\"stop-opacity\").value)}this.color=f.value};a.Element.stop.prototype=new a.Element.ElementBase;a.Element.AnimateBase=function(d){this.base=a.Element.ElementBase;this.base(d);a.Animations.push(this);this.duration=0;this.begin=this.attribute(\"begin\").Time.toMilliseconds();this.maxDuration=this.begin+this.attribute(\"dur\").Time.toMilliseconds();this.getProperty=function(){var c=this.attribute(\"attributeType\").value;var f=this.attribute(\"attributeName\").value;if(c==\"CSS\"){return this.parent.style(f,true)}return this.parent.attribute(f,true)};this.initialValue=null;this.removed=false;this.calcValue=function(){return\"\"};this.update=function(c){if(this.initialValue==null){this.initialValue=this.getProperty().value}if(this.duration>this.maxDuration){if(this.attribute(\"repeatCount\").value==\"indefinite\"){this.duration=0}else{if(this.attribute(\"fill\").valueOrDefault(\"remove\")==\"remove\"&&!this.removed){this.removed=true;this.getProperty().value=this.initialValue;return true}else{return false}}}this.duration=this.duration+c;var k=false;if(this.begin<this.duration){var h=this.calcValue();if(this.attribute(\"type\").hasValue()){var j=this.attribute(\"type\").value;h=j+\"(\"+h+\")\"}this.getProperty().value=h;k=true}return k};this.progress=function(){return((this.duration-this.begin)/(this.maxDuration-this.begin))}};a.Element.AnimateBase.prototype=new a.Element.ElementBase;a.Element.animate=function(d){this.base=a.Element.AnimateBase;this.base(d);this.calcValue=function(){var c=this.attribute(\"from\").numValue();var f=this.attribute(\"to\").numValue();return c+(f-c)*this.progress()}};a.Element.animate.prototype=new a.Element.AnimateBase;a.Element.animateColor=function(d){this.base=a.Element.AnimateBase;this.base(d);this.calcValue=function(){var c=new RGBColor(this.attribute(\"from\").value);var g=new RGBColor(this.attribute(\"to\").value);if(c.ok&&g.ok){var k=c.r+(g.r-c.r)*this.progress();var l=c.g+(g.g-c.g)*this.progress();var m=c.b+(g.b-c.b)*this.progress();return\"rgb(\"+parseInt(k,10)+\",\"+parseInt(l,10)+\",\"+parseInt(m,10)+\")\"}return this.attribute(\"from\").value}};a.Element.animateColor.prototype=new a.Element.AnimateBase;a.Element.animateTransform=function(d){this.base=a.Element.animate;this.base(d)};a.Element.animateTransform.prototype=new a.Element.animate;a.Element.font=function(g){this.base=a.Element.ElementBase;this.base(g);this.horizAdvX=this.attribute(\"horiz-adv-x\").numValue();this.isRTL=false;this.isArabic=false;this.fontFace=null;this.missingGlyph=null;this.glyphs=[];for(var h=0;h<this.children.length;h++){var f=this.children[h];if(f.type==\"font-face\"){this.fontFace=f;if(f.style(\"font-family\").hasValue()){a.Definitions[f.style(\"font-family\").value]=this}}else{if(f.type==\"missing-glyph\"){this.missingGlyph=f}else{if(f.type==\"glyph\"){if(f.arabicForm!=\"\"){this.isRTL=true;this.isArabic=true;if(typeof(this.glyphs[f.unicode])==\"undefined\"){this.glyphs[f.unicode]=[]}this.glyphs[f.unicode][f.arabicForm]=f}else{this.glyphs[f.unicode]=f}}}}}};a.Element.font.prototype=new a.Element.ElementBase;a.Element.fontface=function(d){this.base=a.Element.ElementBase;this.base(d);this.ascent=this.attribute(\"ascent\").value;this.descent=this.attribute(\"descent\").value;this.unitsPerEm=this.attribute(\"units-per-em\").numValue()};a.Element.fontface.prototype=new a.Element.ElementBase;a.Element.missingglyph=function(d){this.base=a.Element.path;this.base(d);this.horizAdvX=0};a.Element.missingglyph.prototype=new a.Element.path;a.Element.glyph=function(d){this.base=a.Element.path;this.base(d);this.horizAdvX=this.attribute(\"horiz-adv-x\").numValue();this.unicode=this.attribute(\"unicode\").value;this.arabicForm=this.attribute(\"arabic-form\").value};a.Element.glyph.prototype=new a.Element.path;a.Element.text=function(f){this.base=a.Element.RenderedElementBase;this.base(f);if(f!=null){this.children=[];for(var g=0;g<f.childNodes.length;g++){var h=f.childNodes[g];if(h.nodeType==1){this.addChild(h,true)}else{if(h.nodeType==3){this.addChild(new a.Element.tspan(h),false)}}}}this.baseSetContext=this.setContext;this.setContext=function(c){this.baseSetContext(c);if(this.style(\"text-anchor\").hasValue()){var d=this.style(\"text-anchor\").value;c.textAlign=d==\"middle\"?\"center\":d}if(this.attribute(\"alignment-baseline\").hasValue()){c.textBaseline=this.attribute(\"alignment-baseline\").value}};this.renderChildren=function(l){var m=this.attribute(\"x\").Length.toPixels(\"x\");var c=this.attribute(\"y\").Length.toPixels(\"y\");for(var e=0;e<this.children.length;e++){var d=this.children[e];if(d.attribute(\"x\").hasValue()){d.x=d.attribute(\"x\").Length.toPixels(\"x\")}else{if(d.attribute(\"dx\").hasValue()){m+=d.attribute(\"dx\").Length.toPixels(\"x\")}d.x=m;m+=d.measureText(l)}if(d.attribute(\"y\").hasValue()){d.y=d.attribute(\"y\").Length.toPixels(\"y\")}else{if(d.attribute(\"dy\").hasValue()){c+=d.attribute(\"dy\").Length.toPixels(\"y\")}d.y=c}d.render(l)}}};a.Element.text.prototype=new a.Element.RenderedElementBase;a.Element.TextElementBase=function(d){this.base=a.Element.RenderedElementBase;this.base(d);this.getGlyph=function(o,k,n){var c=k[n];var m=null;if(o.isArabic){var l=\"isolated\";if((n==0||k[n-1]==\" \")&&n<k.length-2&&k[n+1]!=\" \"){l=\"terminal\"}if(n>0&&k[n-1]!=\" \"&&n<k.length-2&&k[n+1]!=\" \"){l=\"medial\"}if(n>0&&k[n-1]!=\" \"&&(n==k.length-1||k[n+1]==\" \")){l=\"initial\"}if(typeof(o.glyphs[c])!=\"undefined\"){m=o.glyphs[c][l];if(m==null&&o.glyphs[c].type==\"glyph\"){m=o.glyphs[c]}}}else{m=o.glyphs[c]}if(m==null){m=o.missingGlyph}return m};this.renderChildren=function(p){var r=this.parent.style(\"font-family\").Definition.getDefinition();if(r!=null){var o=this.parent.style(\"font-size\").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);var u=this.parent.style(\"font-style\").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle);var q=this.getText();if(r.isRTL){q=q.split(\"\").reverse().join(\"\")}if(this.parent.style(\"text-anchor\").value==\"middle\"){this.x=this.x-this.measureText(p)/2}var c=a.ToNumberArray(this.parent.attribute(\"dx\").value);for(var t=0;t<q.length;t++){var s=this.getGlyph(r,q,t);var v=o/r.fontFace.unitsPerEm;p.translate(this.x,this.y);p.scale(v,-v);var w=p.lineWidth;p.lineWidth=p.lineWidth*r.fontFace.unitsPerEm/o;if(u==\"italic\"){p.transform(1,0,0.4,1,0,0)}s.render(p);if(u==\"italic\"){p.transform(1,0,-0.4,1,0,0)}p.lineWidth=w;p.scale(1/v,-1/v);p.translate(-this.x,-this.y);this.x+=o*(s.horizAdvX||r.horizAdvX)/r.fontFace.unitsPerEm;if(typeof(c[t])!=\"undefined\"&&!isNaN(c[t])){this.x+=c[t]}}return}if(p.strokeStyle!=\"\"){p.strokeText(a.compressSpaces(this.getText()),this.x,this.y)}if(p.fillStyle!=\"\"){p.fillText(a.compressSpaces(this.getText()),this.x,this.y)}};this.getText=function(){};this.measureText=function(o){var q=this.parent.style(\"font-family\").Definition.getDefinition();if(q!=null){var n=this.parent.style(\"font-size\").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);var t=0;var p=this.getText();if(q.isRTL){p=p.split(\"\").reverse().join(\"\")}var c=a.ToNumberArray(this.parent.attribute(\"dx\").value);for(var s=0;s<p.length;s++){var r=this.getGlyph(q,p,s);t+=(r.horizAdvX||q.horizAdvX)*n/q.fontFace.unitsPerEm;if(typeof(c[s])!=\"undefined\"&&!isNaN(c[s])){t+=c[s]}}return t}var u=a.compressSpaces(this.getText());if(!o.measureText){return u.length*10}return o.measureText(u).width}};a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase;a.Element.tspan=function(d){this.base=a.Element.TextElementBase;this.base(d);this.text=d.nodeType==3?d.nodeValue:d.childNodes.length>0?d.childNodes[0].nodeValue:d.text;this.getText=function(){return this.text}};a.Element.tspan.prototype=new a.Element.TextElementBase;a.Element.tref=function(d){this.base=a.Element.TextElementBase;this.base(d);this.getText=function(){var c=this.attribute(\"xlink:href\").Definition.getDefinition();if(c!=null){return c.children[0].getText()}}};a.Element.tref.prototype=new a.Element.TextElementBase;a.Element.a=function(e){this.base=a.Element.TextElementBase;this.base(e);this.hasText=true;for(var f=0;f<e.childNodes.length;f++){if(e.childNodes[f].nodeType!=3){this.hasText=false}}this.text=this.hasText?e.childNodes[0].nodeValue:\"\";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(g){if(this.hasText){this.baseRenderChildren(g);var c=new a.Property(\"fontSize\",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-c.Length.toPixels(\"y\"),this.x+this.measureText(g),this.y))}else{var d=new a.Element.g();d.children=this.children;d.parent=this;d.render(g)}};this.onclick=function(){window.open(this.attribute(\"xlink:href\").value)};this.onmousemove=function(){a.ctx.canvas.style.cursor=\"pointer\"}};a.Element.a.prototype=new a.Element.TextElementBase;a.Element.image=function(g){this.base=a.Element.RenderedElementBase;this.base(g);a.Images.push(this);this.img=document.createElement(\"img\");this.loaded=false;var h=this;this.img.onload=function(){h.loaded=true};var f=this.attribute(\"xlink:href\").value||this.attribute(\"href\").value||this.attribute(\"a0:href\").value;if(f!==\"\"){this.img.src=f}else{this.img.loaded=true}this.renderChildren=function(e){var l=this.attribute(\"x\").Length.toPixels(\"x\");var c=this.attribute(\"y\").Length.toPixels(\"y\");var d=this.attribute(\"width\").Length.toPixels(\"x\");var m=this.attribute(\"height\").Length.toPixels(\"y\");if(d==0||m==0){return}e.save();e.translate(l,c);a.AspectRatio(e,this.attribute(\"preserveAspectRatio\").value,d,this.img.width,m,this.img.height,0,0);e.drawImage(this.img,0,0);e.restore()}};a.Element.image.prototype=new a.Element.RenderedElementBase;a.Element.g=function(d){this.base=a.Element.RenderedElementBase;this.base(d);this.getBoundingBox=function(){var c=new a.BoundingBox();for(var f=0;f<this.children.length;f++){c.addBoundingBox(this.children[f].getBoundingBox())}return c}};a.Element.g.prototype=new a.Element.RenderedElementBase;a.Element.symbol=function(d){this.base=a.Element.RenderedElementBase;this.base(d);this.baseSetContext=this.setContext;this.setContext=function(j){this.baseSetContext(j);if(this.attribute(\"viewBox\").hasValue()){var h=a.ToNumberArray(this.attribute(\"viewBox\").value);var k=h[0];var c=h[1];width=h[2];height=h[3];a.AspectRatio(j,this.attribute(\"preserveAspectRatio\").value,this.attribute(\"width\").Length.toPixels(\"x\"),width,this.attribute(\"height\").Length.toPixels(\"y\"),height,k,c);a.ViewPort.SetCurrent(h[2],h[3])}}};a.Element.symbol.prototype=new a.Element.RenderedElementBase;a.Element.style=function(s){this.base=a.Element.ElementBase;this.base(s);var L=s.childNodes[0].nodeValue+(s.childNodes.length>1?s.childNodes[1].nodeValue:\"\");L=L.replace(/(\\/\\*([^*]|[\\r\\n]|(\\*+([^*\\/]|[\\r\\n])))*\\*+\\/)|(^[\\s]*\\/\\/.*)/gm,\"\");L=a.compressSpaces(L);var N=L.split(\"}\");for(var f=0;f<N.length;f++){if(a.trim(N[f])!=\"\"){var J=N[f].split(\"{\");var V=J[0].split(\",\");var Y=J[1].split(\";\");for(var j=0;j<V.length;j++){var Q=a.trim(V[j]);if(Q!=\"\"){var W={};for(var k=0;k<Y.length;k++){var X=Y[k].indexOf(\":\");var H=Y[k].substr(0,X);var F=Y[k].substr(X+1,Y[k].length-X);if(H!=null&&F!=null){W[a.trim(H)]=new a.Property(a.trim(H),a.trim(F))}}a.Styles[Q]=W;if(Q==\"@font-face\"){var M=W[\"font-family\"].value.replace(/\"/g,\"\");var P=W.src.value.split(\",\");for(var I=0;I<P.length;I++){if(P[I].indexOf('format(\"svg\")')>0){var S=P[I].indexOf(\"url\");var T=P[I].indexOf(\")\",S);var U=P[I].substr(S+5,T-S-6);var K=a.parseXml(a.ajax(U));var R=K.getElementsByTagName(\"font\");for(var O=0;O<R.length;O++){var G=a.CreateElement(R[O]);a.Definitions[M]=G}}}}}}}}};a.Element.style.prototype=new a.Element.ElementBase;a.Element.use=function(d){this.base=a.Element.RenderedElementBase;this.base(d);this.baseSetContext=this.setContext;this.setContext=function(c){this.baseSetContext(c);if(this.attribute(\"x\").hasValue()){c.translate(this.attribute(\"x\").Length.toPixels(\"x\"),0)}if(this.attribute(\"y\").hasValue()){c.translate(0,this.attribute(\"y\").Length.toPixels(\"y\"))}};this.getDefinition=function(){var c=this.attribute(\"xlink:href\").Definition.getDefinition();if(this.attribute(\"width\").hasValue()){c.attribute(\"width\",true).value=this.attribute(\"width\").value}if(this.attribute(\"height\").hasValue()){c.attribute(\"height\",true).value=this.attribute(\"height\").value}return c};this.path=function(f){var c=this.getDefinition();if(c!=null){c.path(f)}};this.renderChildren=function(f){var c=this.getDefinition();if(c!=null){c.render(f)}}};a.Element.use.prototype=new a.Element.RenderedElementBase;a.Element.mask=function(d){this.base=a.Element.ElementBase;this.base(d);this.apply=function(q,w){var s=this.attribute(\"x\").Length.toPixels(\"x\");var u=this.attribute(\"y\").Length.toPixels(\"y\");var y=this.attribute(\"width\").Length.toPixels(\"x\");var r=this.attribute(\"height\").Length.toPixels(\"y\");var c=w.attribute(\"mask\").value;w.attribute(\"mask\").value=\"\";var t=document.createElement(\"canvas\");t.width=s+y;t.height=u+r;var p=t.getContext(\"2d\");this.renderChildren(p);var v=document.createElement(\"canvas\");v.width=s+y;v.height=u+r;var x=v.getContext(\"2d\");w.render(x);x.globalCompositeOperation=\"destination-in\";x.fillStyle=p.createPattern(t,\"no-repeat\");x.fillRect(0,0,s+y,u+r);q.fillStyle=x.createPattern(v,\"no-repeat\");q.fillRect(0,0,s+y,u+r);w.attribute(\"mask\").value=c};this.render=function(c){}};a.Element.mask.prototype=new a.Element.ElementBase;a.Element.clipPath=function(d){this.base=a.Element.ElementBase;this.base(d);this.apply=function(f){for(var c=0;c<this.children.length;c++){if(this.children[c].path){this.children[c].path(f);f.clip()}}};this.render=function(c){}};a.Element.clipPath.prototype=new a.Element.ElementBase;a.Element.title=function(d){};a.Element.title.prototype=new a.Element.ElementBase;a.Element.desc=function(d){};a.Element.desc.prototype=new a.Element.ElementBase;a.Element.MISSING=function(d){console.log(\"ERROR: Element '\"+d.nodeName+\"' not yet implemented.\")};a.Element.MISSING.prototype=new a.Element.ElementBase;a.CreateElement=function(g){var h=g.nodeName.replace(/^[^:]+:/,\"\");h=h.replace(/\\-/g,\"\");var e=null;if(typeof(a.Element[h])!=\"undefined\"){e=new a.Element[h](g)}else{e=new a.Element.MISSING(g)}e.type=g.nodeName;return e};a.load=function(f,e){a.loadXml(f,a.ajax(e))};a.loadXml=function(f,e){a.loadXmlDoc(f,a.parseXml(e))};a.loadXmlDoc=function(n,e){a.init(n);var o=function(c){var d=n.canvas;while(d){c.x-=d.offsetLeft;c.y-=d.offsetTop;d=d.offsetParent}if(window.scrollX){c.x+=window.scrollX}if(window.scrollY){c.y+=window.scrollY}return c};if(a.opts==null||a.opts.ignoreMouse!=true){n.canvas.onclick=function(c){var d=o(new a.Point(c!=null?c.clientX:event.clientX,c!=null?c.clientY:event.clientY));a.Mouse.onclick(d.x,d.y)};n.canvas.onmousemove=function(c){var d=o(new a.Point(c!=null?c.clientX:event.clientX,c!=null?c.clientY:event.clientY));a.Mouse.onmousemove(d.x,d.y)}}var l=a.CreateElement(e.documentElement);l.root=true;var m=true;var p=function(){a.ViewPort.Clear();if(n.canvas.parentNode){a.ViewPort.SetCurrent(n.canvas.parentNode.clientWidth,n.canvas.parentNode.clientHeight)}if(a.opts==null||a.opts.ignoreDimensions!=true){if(l.style(\"width\").hasValue()){n.canvas.width=l.style(\"width\").Length.toPixels(\"x\");n.canvas.style.width=n.canvas.width+\"px\"}if(l.style(\"height\").hasValue()){n.canvas.height=l.style(\"height\").Length.toPixels(\"y\");n.canvas.style.height=n.canvas.height+\"px\"}}a.ViewPort.SetCurrent(n.canvas.clientWidth,n.canvas.clientHeight);if(a.opts!=null&&a.opts.offsetX!=null){l.attribute(\"x\",true).value=a.opts.offsetX}if(a.opts!=null&&a.opts.offsetY!=null){l.attribute(\"y\",true).value=a.opts.offsetY}if(a.opts!=null&&a.opts.scaleWidth!=null&&a.opts.scaleHeight!=null){l.attribute(\"width\",true).value=a.opts.scaleWidth;l.attribute(\"height\",true).value=a.opts.scaleHeight;l.attribute(\"viewBox\",true).value=\"0 0 \"+n.canvas.clientWidth+\" \"+n.canvas.clientHeight;l.attribute(\"preserveAspectRatio\",true).value=\"none\"}if(a.opts==null||a.opts.ignoreClear!=true){n.clearRect(0,0,n.canvas.clientWidth,n.canvas.clientHeight)}l.render(n);if(m){m=false;if(a.opts!=null&&typeof(a.opts.renderCallback)==\"function\"){a.opts.renderCallback()}}};var q=true;if(a.ImagesLoaded()){q=false;p();a.readyToConvertToDataURL=true}a.intervalID=setInterval(function(){var c=false;if(q&&a.ImagesLoaded()){q=false;c=true}if(a.opts==null||a.opts.ignoreMouse!=true){c=c|a.Mouse.hasEvents()}if(a.opts==null||a.opts.ignoreAnimation!=true){for(var d=0;d<a.Animations.length;d++){c=c|a.Animations[d].update(1000/a.FRAMERATE)}}if(a.opts!=null&&typeof(a.opts.forceRedraw)==\"function\"){if(a.opts.forceRedraw()==true){c=true}}if(c){p();a.Mouse.runEvents();a.readyToConvertToDataURL=true}},1000/a.FRAMERATE)};a.stop=function(){if(a.intervalID){clearInterval(a.intervalID)}};a.Mouse=new (function(){this.events=[];this.hasEvents=function(){return this.events.length!=0};this.onclick=function(f,e){this.events.push({type:\"onclick\",x:f,y:e,run:function(c){if(c.onclick){c.onclick()}}})};this.onmousemove=function(f,e){this.events.push({type:\"onmousemove\",x:f,y:e,run:function(c){if(c.onmousemove){c.onmousemove()}}})};this.eventElements=[];this.checkPath=function(h,k){for(var j=0;j<this.events.length;j++){var e=this.events[j];if(k.isPointInPath&&k.isPointInPath(e.x,e.y)){this.eventElements[j]=h}}};this.checkBoundingBox=function(j,e){for(var k=0;k<this.events.length;k++){var h=this.events[k];if(e.isPointInBox(h.x,h.y)){this.eventElements[k]=j}}};this.runEvents=function(){a.ctx.canvas.style.cursor=\"\";for(var g=0;g<this.events.length;g++){var e=this.events[g];var h=this.eventElements[g];while(h){e.run(h);h=h.parent}}this.events=[];this.eventElements=[]}});return a}})();if(window.CanvasRenderingContext2D){CanvasRenderingContext2D.prototype.drawSvg=function(j,f,g,k,h){canvg(this.canvas,j,{ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true,offsetX:f,offsetY:g,scaleWidth:k,scaleHeight:h})}}var JpegMeta={};JpegMeta.parseNum=function parseNum(j,l,k,n){var o;var h;var m=(j===\">\");if(k===undefined){k=0}if(n===undefined){n=l.length-k}for(m?o=k:o=k+n-1;m?o<k+n:o>=k;m?o++:o--){h<<=8;h+=l.charCodeAt(o)}return h};JpegMeta.parseSnum=function parseSnum(k,n,m,p){var q;var j;var l;var o=(k===\">\");if(m===undefined){m=0}if(p===undefined){p=n.length-m}for(o?q=m:q=m+p-1;o?q<m+p:q>=m;o?q++:q--){if(l===undefined){l=(n.charCodeAt(q)&128)===128}j<<=8;j+=l?~n.charCodeAt(q)&255:n.charCodeAt(q)}if(l){j+=1;j*=-1}return j};JpegMeta.Rational=function Rational(d,c){this.num=d;this.den=c||1;return this};JpegMeta.Rational.prototype.toString=function toString(){if(this.num===0){return\"\"+this.num}if(this.den===1){return\"\"+this.num}if(this.num===1){return this.num+\" / \"+this.den}return this.num/this.den};JpegMeta.Rational.prototype.asFloat=function asFloat(){return this.num/this.den};JpegMeta.MetaGroup=function MetaGroup(c,d){this.fieldName=c;this.description=d;this.metaProps={};return this};JpegMeta.MetaGroup.prototype._addProperty=function _addProperty(g,f,h){var e=new JpegMeta.MetaProp(g,f,h);this[e.fieldName]=e;this.metaProps[e.fieldName]=e};JpegMeta.MetaGroup.prototype.toString=function toString(){return\"[MetaGroup \"+this.description+\"]\"};JpegMeta.MetaProp=function MetaProp(f,e,d){this.fieldName=f;this.description=e;this.value=d;return this};JpegMeta.MetaProp.prototype.toString=function toString(){return\"\"+this.value};this.JpegMeta.JpegFile=function JpegFile(n,y){var p=this._SOS;this.metaGroups={};this._binary_data=n;this.filename=y;var o=0;var t=0;var w;var r;var x;var s;var v;var u;var q;if(this._binary_data.slice(0,2)!==this._SOI_MARKER){throw new Error(\"Doesn't look like a JPEG file. First two bytes are \"+this._binary_data.charCodeAt(0)+\",\"+this._binary_data.charCodeAt(1)+\".\")}o+=2;while(o<this._binary_data.length){w=this._binary_data.charCodeAt(o++);r=this._binary_data.charCodeAt(o++);t=o;if(w!=this._DELIM){break}if(r===p){break}v=JpegMeta.parseNum(\">\",this._binary_data,o,2);o+=v;while(o<this._binary_data.length){w=this._binary_data.charCodeAt(o++);if(w==this._DELIM){x=this._binary_data.charCodeAt(o++);if(x!=0){o-=2;break}}}s=o-t;if(this._markers[r]){u=this._markers[r][0];q=this._markers[r][1]}else{u=\"UNKN\";q=undefined}if(q){this[q](r,t+2)}}if(this.general===undefined){throw new Error(\"Invalid JPEG file.\")}return this};this.JpegMeta.JpegFile.prototype.toString=function(){return\"[JpegFile \"+this.filename+\" \"+this.general.type+\" \"+this.general.pixelWidth+\"x\"+this.general.pixelHeight+\" Depth: \"+this.general.depth+\"]\"};this.JpegMeta.JpegFile.prototype._SOI_MARKER=\"\\xff\\xd8\";this.JpegMeta.JpegFile.prototype._DELIM=255;this.JpegMeta.JpegFile.prototype._EOI=217;this.JpegMeta.JpegFile.prototype._SOS=218;this.JpegMeta.JpegFile.prototype._sofHandler=function _sofHandler(c,d){if(this.general!==undefined){throw new Error(\"Unexpected multiple-frame image\")}this._addMetaGroup(\"general\",\"General\");this.general._addProperty(\"depth\",\"Depth\",JpegMeta.parseNum(\">\",this._binary_data,d,1));this.general._addProperty(\"pixelHeight\",\"Pixel Height\",JpegMeta.parseNum(\">\",this._binary_data,d+1,2));this.general._addProperty(\"pixelWidth\",\"Pixel Width\",JpegMeta.parseNum(\">\",this._binary_data,d+3,2));this.general._addProperty(\"type\",\"Type\",this._markers[c][2])};this.JpegMeta.JpegFile.prototype._JFIF_IDENT=\"JFIF\\x00\";this.JpegMeta.JpegFile.prototype._JFXX_IDENT=\"JFXX\\x00\";this.JpegMeta.JpegFile.prototype._EXIF_IDENT=\"Exif\\x00\";this.JpegMeta.JpegFile.prototype._types={1:[\"BYTE\",1],2:[\"ASCII\",1],3:[\"SHORT\",2],4:[\"LONG\",4],5:[\"RATIONAL\",8],6:[\"SBYTE\",1],7:[\"UNDEFINED\",1],8:[\"SSHORT\",2],9:[\"SLONG\",4],10:[\"SRATIONAL\",8],11:[\"FLOAT\",4],12:[\"DOUBLE\",8]};this.JpegMeta.JpegFile.prototype._tifftags={256:[\"Image width\",\"ImageWidth\"],257:[\"Image height\",\"ImageLength\"],258:[\"Number of bits per component\",\"BitsPerSample\"],259:[\"Compression scheme\",\"Compression\",{1:\"uncompressed\",6:\"JPEG compression\"}],262:[\"Pixel composition\",\"PhotmetricInerpretation\",{2:\"RGB\",6:\"YCbCr\"}],274:[\"Orientation of image\",\"Orientation\",{1:\"Normal\",2:\"Reverse?\",3:\"Upside-down\",4:\"Upside-down Reverse\",5:\"90 degree CW\",6:\"90 degree CW reverse\",7:\"90 degree CCW\",8:\"90 degree CCW reverse\"}],277:[\"Number of components\",\"SamplesPerPixel\"],284:[\"Image data arrangement\",\"PlanarConfiguration\",{1:\"chunky format\",2:\"planar format\"}],530:[\"Subsampling ratio of Y to C\",\"YCbCrSubSampling\"],531:[\"Y and C positioning\",\"YCbCrPositioning\",{1:\"centered\",2:\"co-sited\"}],282:[\"X Resolution\",\"XResolution\"],283:[\"Y Resolution\",\"YResolution\"],296:[\"Resolution Unit\",\"ResolutionUnit\",{2:\"inches\",3:\"centimeters\"}],273:[\"Image data location\",\"StripOffsets\"],278:[\"Number of rows per strip\",\"RowsPerStrip\"],279:[\"Bytes per compressed strip\",\"StripByteCounts\"],513:[\"Offset to JPEG SOI\",\"JPEGInterchangeFormat\"],514:[\"Bytes of JPEG Data\",\"JPEGInterchangeFormatLength\"],301:[\"Transfer function\",\"TransferFunction\"],318:[\"White point chromaticity\",\"WhitePoint\"],319:[\"Chromaticities of primaries\",\"PrimaryChromaticities\"],529:[\"Color space transformation matrix coefficients\",\"YCbCrCoefficients\"],532:[\"Pair of black and white reference values\",\"ReferenceBlackWhite\"],306:[\"Date and time\",\"DateTime\"],270:[\"Image title\",\"ImageDescription\"],271:[\"Make\",\"Make\"],272:[\"Model\",\"Model\"],305:[\"Software\",\"Software\"],315:[\"Person who created the image\",\"Artist\"],316:[\"Host Computer\",\"HostComputer\"],33432:[\"Copyright holder\",\"Copyright\"],34665:[\"Exif tag\",\"ExifIfdPointer\"],34853:[\"GPS tag\",\"GPSInfoIfdPointer\"]};this.JpegMeta.JpegFile.prototype._exiftags={36864:[\"Exif Version\",\"ExifVersion\"],40960:[\"FlashPix Version\",\"FlashpixVersion\"],40961:[\"Color Space\",\"ColorSpace\"],37121:[\"Meaning of each component\",\"ComponentsConfiguration\"],37122:[\"Compressed Bits Per Pixel\",\"CompressedBitsPerPixel\"],40962:[\"Pixel X Dimension\",\"PixelXDimension\"],40963:[\"Pixel Y Dimension\",\"PixelYDimension\"],37500:[\"Manufacturer notes\",\"MakerNote\"],37510:[\"User comments\",\"UserComment\"],40964:[\"Related audio file\",\"RelatedSoundFile\"],36867:[\"Date Time Original\",\"DateTimeOriginal\"],36868:[\"Date Time Digitized\",\"DateTimeDigitized\"],37520:[\"DateTime subseconds\",\"SubSecTime\"],37521:[\"DateTimeOriginal subseconds\",\"SubSecTimeOriginal\"],37522:[\"DateTimeDigitized subseconds\",\"SubSecTimeDigitized\"],33434:[\"Exposure time\",\"ExposureTime\"],33437:[\"FNumber\",\"FNumber\"],34850:[\"Exposure program\",\"ExposureProgram\"],34852:[\"Spectral sensitivity\",\"SpectralSensitivity\"],34855:[\"ISO Speed Ratings\",\"ISOSpeedRatings\"],34856:[\"Optoelectric coefficient\",\"OECF\"],37377:[\"Shutter Speed\",\"ShutterSpeedValue\"],37378:[\"Aperture Value\",\"ApertureValue\"],37379:[\"Brightness\",\"BrightnessValue\"],37380:[\"Exposure Bias Value\",\"ExposureBiasValue\"],37381:[\"Max Aperture Value\",\"MaxApertureValue\"],37382:[\"Subject Distance\",\"SubjectDistance\"],37383:[\"Metering Mode\",\"MeteringMode\"],37384:[\"Light Source\",\"LightSource\"],37385:[\"Flash\",\"Flash\"],37386:[\"Focal Length\",\"FocalLength\"],37396:[\"Subject Area\",\"SubjectArea\"],41483:[\"Flash Energy\",\"FlashEnergy\"],41484:[\"Spatial Frequency Response\",\"SpatialFrequencyResponse\"],41486:[\"Focal Plane X Resolution\",\"FocalPlaneXResolution\"],41487:[\"Focal Plane Y Resolution\",\"FocalPlaneYResolution\"],41488:[\"Focal Plane Resolution Unit\",\"FocalPlaneResolutionUnit\"],41492:[\"Subject Location\",\"SubjectLocation\"],41493:[\"Exposure Index\",\"ExposureIndex\"],41495:[\"Sensing Method\",\"SensingMethod\"],41728:[\"File Source\",\"FileSource\"],41729:[\"Scene Type\",\"SceneType\"],41730:[\"CFA Pattern\",\"CFAPattern\"],41985:[\"Custom Rendered\",\"CustomRendered\"],41986:[\"Exposure Mode\",\"Exposure Mode\"],41987:[\"White Balance\",\"WhiteBalance\"],41988:[\"Digital Zoom Ratio\",\"DigitalZoomRatio\"],41990:[\"Scene Capture Type\",\"SceneCaptureType\"],41991:[\"Gain Control\",\"GainControl\"],41992:[\"Contrast\",\"Contrast\"],41993:[\"Saturation\",\"Saturation\"],41994:[\"Sharpness\",\"Sharpness\"],41995:[\"Device settings description\",\"DeviceSettingDescription\"],41996:[\"Subject distance range\",\"SubjectDistanceRange\"],42016:[\"Unique image ID\",\"ImageUniqueID\"],40965:[\"Interoperability tag\",\"InteroperabilityIFDPointer\"]};this.JpegMeta.JpegFile.prototype._gpstags={0:[\"GPS tag version\",\"GPSVersionID\"],1:[\"North or South Latitude\",\"GPSLatitudeRef\"],2:[\"Latitude\",\"GPSLatitude\"],3:[\"East or West Longitude\",\"GPSLongitudeRef\"],4:[\"Longitude\",\"GPSLongitude\"],5:[\"Altitude reference\",\"GPSAltitudeRef\"],6:[\"Altitude\",\"GPSAltitude\"],7:[\"GPS time (atomic clock)\",\"GPSTimeStamp\"],8:[\"GPS satellites usedd for measurement\",\"GPSSatellites\"],9:[\"GPS receiver status\",\"GPSStatus\"],10:[\"GPS mesaurement mode\",\"GPSMeasureMode\"],11:[\"Measurement precision\",\"GPSDOP\"],12:[\"Speed unit\",\"GPSSpeedRef\"],13:[\"Speed of GPS receiver\",\"GPSSpeed\"],14:[\"Reference for direction of movement\",\"GPSTrackRef\"],15:[\"Direction of movement\",\"GPSTrack\"],16:[\"Reference for direction of image\",\"GPSImgDirectionRef\"],17:[\"Direction of image\",\"GPSImgDirection\"],18:[\"Geodetic survey data used\",\"GPSMapDatum\"],19:[\"Reference for latitude of destination\",\"GPSDestLatitudeRef\"],20:[\"Latitude of destination\",\"GPSDestLatitude\"],21:[\"Reference for longitude of destination\",\"GPSDestLongitudeRef\"],22:[\"Longitude of destination\",\"GPSDestLongitude\"],23:[\"Reference for bearing of destination\",\"GPSDestBearingRef\"],24:[\"Bearing of destination\",\"GPSDestBearing\"],25:[\"Reference for distance to destination\",\"GPSDestDistanceRef\"],26:[\"Distance to destination\",\"GPSDestDistance\"],27:[\"Name of GPS processing method\",\"GPSProcessingMethod\"],28:[\"Name of GPS area\",\"GPSAreaInformation\"],29:[\"GPS Date\",\"GPSDateStamp\"],30:[\"GPS differential correction\",\"GPSDifferential\"]};this.JpegMeta.JpegFile.prototype._markers={192:[\"SOF0\",\"_sofHandler\",\"Baseline DCT\"],193:[\"SOF1\",\"_sofHandler\",\"Extended sequential DCT\"],194:[\"SOF2\",\"_sofHandler\",\"Progressive DCT\"],195:[\"SOF3\",\"_sofHandler\",\"Lossless (sequential)\"],197:[\"SOF5\",\"_sofHandler\",\"Differential sequential DCT\"],198:[\"SOF6\",\"_sofHandler\",\"Differential progressive DCT\"],199:[\"SOF7\",\"_sofHandler\",\"Differential lossless (sequential)\"],200:[\"JPG\",null,\"Reserved for JPEG extensions\"],201:[\"SOF9\",\"_sofHandler\",\"Extended sequential DCT\"],202:[\"SOF10\",\"_sofHandler\",\"Progressive DCT\"],203:[\"SOF11\",\"_sofHandler\",\"Lossless (sequential)\"],205:[\"SOF13\",\"_sofHandler\",\"Differential sequential DCT\"],206:[\"SOF14\",\"_sofHandler\",\"Differential progressive DCT\"],207:[\"SOF15\",\"_sofHandler\",\"Differential lossless (sequential)\"],196:[\"DHT\",null,\"Define Huffman table(s)\"],204:[\"DAC\",null,\"Define arithmetic coding conditioning(s)\"],208:[\"RST0\",null,\"Restart with modulo 8 count 0\"],209:[\"RST1\",null,\"Restart with modulo 8 count 1\"],210:[\"RST2\",null,\"Restart with modulo 8 count 2\"],211:[\"RST3\",null,\"Restart with modulo 8 count 3\"],212:[\"RST4\",null,\"Restart with modulo 8 count 4\"],213:[\"RST5\",null,\"Restart with modulo 8 count 5\"],214:[\"RST6\",null,\"Restart with modulo 8 count 6\"],215:[\"RST7\",null,\"Restart with modulo 8 count 7\"],216:[\"SOI\",null,\"Start of image\"],217:[\"EOI\",null,\"End of image\"],218:[\"SOS\",null,\"Start of scan\"],219:[\"DQT\",null,\"Define quantization table(s)\"],220:[\"DNL\",null,\"Define number of lines\"],221:[\"DRI\",null,\"Define restart interval\"],222:[\"DHP\",null,\"Define hierarchical progression\"],223:[\"EXP\",null,\"Expand reference component(s)\"],224:[\"APP0\",\"_app0Handler\",\"Reserved for application segments\"],225:[\"APP1\",\"_app1Handler\"],226:[\"APP2\",null],227:[\"APP3\",null],228:[\"APP4\",null],229:[\"APP5\",null],230:[\"APP6\",null],231:[\"APP7\",null],232:[\"APP8\",null],233:[\"APP9\",null],234:[\"APP10\",null],235:[\"APP11\",null],236:[\"APP12\",null],237:[\"APP13\",null],238:[\"APP14\",null],239:[\"APP15\",null],240:[\"JPG0\",null],241:[\"JPG1\",null],242:[\"JPG2\",null],243:[\"JPG3\",null],244:[\"JPG4\",null],245:[\"JPG5\",null],246:[\"JPG6\",null],247:[\"JPG7\",null],248:[\"JPG8\",null],249:[\"JPG9\",null],250:[\"JPG10\",null],251:[\"JPG11\",null],252:[\"JPG12\",null],253:[\"JPG13\",null],254:[\"COM\",null],1:[\"JPG13\",null]};this.JpegMeta.JpegFile.prototype._addMetaGroup=function _addMetaGroup(e,d){var f=new JpegMeta.MetaGroup(e,d);this[f.fieldName]=f;this.metaGroups[f.fieldName]=f;return f};this.JpegMeta.JpegFile.prototype._parseIfd=function _parseIfd(y,D,N,F,G,j,B){var C=JpegMeta.parseNum(y,D,N+F,2);var z,A;var R;var M;var Q,O,H;var P;var I;var E;var S;var K;var L;var J;J=this._addMetaGroup(j,B);for(z=0;z<C;z++){R=N+F+2+(z*12);M=JpegMeta.parseNum(y,D,R,2);O=JpegMeta.parseNum(y,D,R+2,2);P=JpegMeta.parseNum(y,D,R+4,4);I=JpegMeta.parseNum(y,D,R+8,4);if(this._types[O]===undefined){continue}Q=this._types[O][0];H=this._types[O][1];if(H*P<=4){I=R+8}else{I=N+I}if(Q==\"UNDEFINED\"){E=D.slice(I,I+P)}else{if(Q==\"ASCII\"){E=D.slice(I,I+P);E=E.split(\"\\x00\")[0]}else{E=[];for(A=0;A<P;A++,I+=H){if(Q==\"BYTE\"||Q==\"SHORT\"||Q==\"LONG\"){E.push(JpegMeta.parseNum(y,D,I,H))}if(Q==\"SBYTE\"||Q==\"SSHORT\"||Q==\"SLONG\"){E.push(JpegMeta.parseSnum(y,D,I,H))}if(Q==\"RATIONAL\"){K=JpegMeta.parseNum(y,D,I,4);L=JpegMeta.parseNum(y,D,I+4,4);E.push(new JpegMeta.Rational(K,L))}if(Q==\"SRATIONAL\"){K=JpegMeta.parseSnum(y,D,I,4);L=JpegMeta.parseSnum(y,D,I+4,4);E.push(new JpegMeta.Rational(K,L))}E.push()}if(P===1){E=E[0]}}}J._addProperty(G[M][1],G[M][0],E)}};this.JpegMeta.JpegFile.prototype._jfifHandler=function _jfifHandler(c,d){if(this.jfif!==undefined){throw new Error(\"Multiple JFIF segments found\")}this._addMetaGroup(\"jfif\",\"JFIF\");this.jfif._addProperty(\"version_major\",\"Version Major\",this._binary_data.charCodeAt(d+5));this.jfif._addProperty(\"version_minor\",\"Version Minor\",this._binary_data.charCodeAt(d+6));this.jfif._addProperty(\"version\",\"JFIF Version\",this.jfif.version_major.value+\".\"+this.jfif.version_minor.value);this.jfif._addProperty(\"units\",\"Density Unit\",this._binary_data.charCodeAt(d+7));this.jfif._addProperty(\"Xdensity\",\"X density\",JpegMeta.parseNum(\">\",this._binary_data,d+8,2));this.jfif._addProperty(\"Ydensity\",\"Y Density\",JpegMeta.parseNum(\">\",this._binary_data,d+10,2));this.jfif._addProperty(\"Xthumbnail\",\"X Thumbnail\",JpegMeta.parseNum(\">\",this._binary_data,d+12,1));this.jfif._addProperty(\"Ythumbnail\",\"Y Thumbnail\",JpegMeta.parseNum(\">\",this._binary_data,d+13,1))};this.JpegMeta.JpegFile.prototype._app0Handler=function app0Handler(f,d){var e=this._binary_data.slice(d,d+5);if(e==this._JFIF_IDENT){this._jfifHandler(f,d)}else{if(e==this._JFXX_IDENT){}else{}}};this.JpegMeta.JpegFile.prototype._app1Handler=function _app1Handler(f,d){var e=this._binary_data.slice(d,d+5);if(e==this._EXIF_IDENT){this._exifHandler(f,d+6)}else{}};JpegMeta.JpegFile.prototype._exifHandler=function _exifHandler(t,m){if(this.exif!==undefined){throw new Error(\"Multiple JFIF segments found\")}var q;var r;var u;var p,o,s;var v=this._binary_data.slice(m,m+2);if(v===\"II\"){q=\"<\"}else{if(v===\"MM\"){q=\">\"}else{throw new Error(\"Malformed TIFF meta-data. Unknown endianess: \"+v)}}r=JpegMeta.parseNum(q,this._binary_data,m+2,2);if(r!==42){throw new Error(\"Malformed TIFF meta-data. Bad magic: \"+r)}u=JpegMeta.parseNum(q,this._binary_data,m+4,4);this._parseIfd(q,this._binary_data,m,u,this._tifftags,\"tiff\",\"TIFF\");if(this.tiff.ExifIfdPointer){this._parseIfd(q,this._binary_data,m,this.tiff.ExifIfdPointer.value,this._exiftags,\"exif\",\"Exif\")}if(this.tiff.GPSInfoIfdPointer){this._parseIfd(q,this._binary_data,m,this.tiff.GPSInfoIfdPointer.value,this._gpstags,\"gps\",\"GPS\");if(this.gps.GPSLatitude){var n;n=this.gps.GPSLatitude.value[0].asFloat()+(1/60)*this.gps.GPSLatitude.value[1].asFloat()+(1/3600)*this.gps.GPSLatitude.value[2].asFloat();if(this.gps.GPSLatitudeRef.value===\"S\"){n=-n}this.gps._addProperty(\"latitude\",\"Dec. Latitude\",n)}if(this.gps.GPSLongitude){var w;w=this.gps.GPSLongitude.value[0].asFloat()+(1/60)*this.gps.GPSLongitude.value[1].asFloat()+(1/3600)*this.gps.GPSLongitude.value[2].asFloat();if(this.gps.GPSLongitudeRef.value===\"W\"){w=-w}this.gps._addProperty(\"longitude\",\"Dec. Longitude\",w)}}};function RGBColor(m){this.ok=false;if(m.charAt(0)==\"#\"){m=m.substr(1,6)}m=m.replace(/ /g,\"\");m=m.toLowerCase();var k={aliceblue:\"f0f8ff\",antiquewhite:\"faebd7\",aqua:\"00ffff\",aquamarine:\"7fffd4\",azure:\"f0ffff\",beige:\"f5f5dc\",bisque:\"ffe4c4\",black:\"000000\",blanchedalmond:\"ffebcd\",blue:\"0000ff\",blueviolet:\"8a2be2\",brown:\"a52a2a\",burlywood:\"deb887\",cadetblue:\"5f9ea0\",chartreuse:\"7fff00\",chocolate:\"d2691e\",coral:\"ff7f50\",cornflowerblue:\"6495ed\",cornsilk:\"fff8dc\",crimson:\"dc143c\",cyan:\"00ffff\",darkblue:\"00008b\",darkcyan:\"008b8b\",darkgoldenrod:\"b8860b\",darkgray:\"a9a9a9\",darkgreen:\"006400\",darkkhaki:\"bdb76b\",darkmagenta:\"8b008b\",darkolivegreen:\"556b2f\",darkorange:\"ff8c00\",darkorchid:\"9932cc\",darkred:\"8b0000\",darksalmon:\"e9967a\",darkseagreen:\"8fbc8f\",darkslateblue:\"483d8b\",darkslategray:\"2f4f4f\",darkturquoise:\"00ced1\",darkviolet:\"9400d3\",deeppink:\"ff1493\",deepskyblue:\"00bfff\",dimgray:\"696969\",dodgerblue:\"1e90ff\",feldspar:\"d19275\",firebrick:\"b22222\",floralwhite:\"fffaf0\",forestgreen:\"228b22\",fuchsia:\"ff00ff\",gainsboro:\"dcdcdc\",ghostwhite:\"f8f8ff\",gold:\"ffd700\",goldenrod:\"daa520\",gray:\"808080\",green:\"008000\",greenyellow:\"adff2f\",honeydew:\"f0fff0\",hotpink:\"ff69b4\",indianred:\"cd5c5c\",indigo:\"4b0082\",ivory:\"fffff0\",khaki:\"f0e68c\",lavender:\"e6e6fa\",lavenderblush:\"fff0f5\",lawngreen:\"7cfc00\",lemonchiffon:\"fffacd\",lightblue:\"add8e6\",lightcoral:\"f08080\",lightcyan:\"e0ffff\",lightgoldenrodyellow:\"fafad2\",lightgrey:\"d3d3d3\",lightgreen:\"90ee90\",lightpink:\"ffb6c1\",lightsalmon:\"ffa07a\",lightseagreen:\"20b2aa\",lightskyblue:\"87cefa\",lightslateblue:\"8470ff\",lightslategray:\"778899\",lightsteelblue:\"b0c4de\",lightyellow:\"ffffe0\",lime:\"00ff00\",limegreen:\"32cd32\",linen:\"faf0e6\",magenta:\"ff00ff\",maroon:\"800000\",mediumaquamarine:\"66cdaa\",mediumblue:\"0000cd\",mediumorchid:\"ba55d3\",mediumpurple:\"9370d8\",mediumseagreen:\"3cb371\",mediumslateblue:\"7b68ee\",mediumspringgreen:\"00fa9a\",mediumturquoise:\"48d1cc\",mediumvioletred:\"c71585\",midnightblue:\"191970\",mintcream:\"f5fffa\",mistyrose:\"ffe4e1\",moccasin:\"ffe4b5\",navajowhite:\"ffdead\",navy:\"000080\",oldlace:\"fdf5e6\",olive:\"808000\",olivedrab:\"6b8e23\",orange:\"ffa500\",orangered:\"ff4500\",orchid:\"da70d6\",palegoldenrod:\"eee8aa\",palegreen:\"98fb98\",paleturquoise:\"afeeee\",palevioletred:\"d87093\",papayawhip:\"ffefd5\",peachpuff:\"ffdab9\",peru:\"cd853f\",pink:\"ffc0cb\",plum:\"dda0dd\",powderblue:\"b0e0e6\",purple:\"800080\",red:\"ff0000\",rosybrown:\"bc8f8f\",royalblue:\"4169e1\",saddlebrown:\"8b4513\",salmon:\"fa8072\",sandybrown:\"f4a460\",seagreen:\"2e8b57\",seashell:\"fff5ee\",sienna:\"a0522d\",silver:\"c0c0c0\",skyblue:\"87ceeb\",slateblue:\"6a5acd\",slategray:\"708090\",snow:\"fffafa\",springgreen:\"00ff7f\",steelblue:\"4682b4\",tan:\"d2b48c\",teal:\"008080\",thistle:\"d8bfd8\",tomato:\"ff6347\",turquoise:\"40e0d0\",violet:\"ee82ee\",violetred:\"d02090\",wheat:\"f5deb3\",white:\"ffffff\",whitesmoke:\"f5f5f5\",yellow:\"ffff00\",yellowgreen:\"9acd32\"};for(var q in k){if(m==q){m=k[q]}}var l=[{re:/^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,example:[\"rgb(123, 234, 45)\",\"rgb(255,234,245)\"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\\w{2})(\\w{2})(\\w{2})$/,example:[\"#00ff00\",\"336699\"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\\w{1})(\\w{1})(\\w{1})$/,example:[\"#fb0\",\"f0f\"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];for(var j=0;j<l.length;j++){var o=l[j].re;var p=l[j].process;var n=o.exec(m);if(n){channels=p(n);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return\"rgb(\"+this.r+\", \"+this.g+\", \"+this.b+\")\"};this.toHex=function(){var a=this.r.toString(16);var b=this.g.toString(16);var c=this.b.toString(16);if(a.length==1){a=\"0\"+a}if(b.length==1){b=\"0\"+b}if(c.length==1){c=\"0\"+c}return\"#\"+a+b+c};this.getHelpXML=function(){var f=new Array();for(var d=0;d<l.length;d++){var g=l[d].example;for(var e=0;e<g.length;e++){f[f.length]=g[e]}}for(var w in k){f[f.length]=w}var c=document.createElement(\"ul\");c.setAttribute(\"id\",\"rgbcolor-examples\");for(var d=0;d<f.length;d++){try{var b=document.createElement(\"li\");var x=new RGBColor(f[d]);var v=document.createElement(\"div\");v.style.cssText=\"margin: 3px; border: 1px solid black; background:\"+x.toHex()+\"; color:\"+x.toHex();v.appendChild(document.createTextNode(\"test\"));var h=document.createTextNode(\" \"+f[d]+\" -> \"+x.toRGB()+\" -> \"+x.toHex());b.appendChild(v);b.appendChild(h);c.appendChild(b)}catch(a){}}return c}}\n/*!\n * SVG.toDataURL\n * https://github.com/sampula/SVG.toDataURL\n *\n * Licensed with the permissive MIT license, as follows.\n * \n * Copyright (c) 2010 Sampu-mon & Mat-san\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this abandonware notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * Date: Wed Dec 15 19:04:53 2010 -0500\n */\nif(window.SVGElement){SVGElement.prototype.toDataURL=function(r,p,v,t){var q=this;function z(a){SC.info(\"SVG.toDataURL: \"+a)}function o(){var a=x(q);var b=u(a);return b}function x(b){function a(d){var e=\"\";e+=\"<\"+d.nodeName;for(var c=0;c<d.attributes.length;c++){e+=\" \"+d.attributes[c].name+\"='\"+d.attributes[c].value+\"'\"}if(d.hasChildNodes()){e+=\">\\n\";for(var c=0;c<d.childNodes.length;c++){e+=a(d.childNodes[c])}e+=\"</\"+d.nodeName+\">\\n\"}else{e+=\" />\\n\"}return e}if(window.XMLSerializer){z(\"using standard XMLSerializer.serializeToString\");return(new XMLSerializer()).serializeToString(b)}else{z(\"using custom XMLSerializerForIE\");return a(b)}}var s={_keyStr:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",encode:function(b){var d=\"\";var e,g,j,f,h,k,a;var c=0;b=s._utf8_encode(b);while(c<b.length){e=b.charCodeAt(c++);g=b.charCodeAt(c++);j=b.charCodeAt(c++);f=e>>2;h=((e&3)<<4)|(g>>4);k=((g&15)<<2)|(j>>6);a=j&63;if(isNaN(g)){k=a=64}else{if(isNaN(j)){a=64}}d=d+this._keyStr.charAt(f)+this._keyStr.charAt(h)+this._keyStr.charAt(k)+this._keyStr.charAt(a)}return d},decode:function(b){var d=\"\";var e,g,j;var f,h,k,a;var c=0;b=b.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");while(c<b.length){f=this._keyStr.indexOf(b.charAt(c++));h=this._keyStr.indexOf(b.charAt(c++));k=this._keyStr.indexOf(b.charAt(c++));a=this._keyStr.indexOf(b.charAt(c++));e=(f<<2)|(h>>4);g=((h&15)<<4)|(k>>2);j=((k&3)<<6)|a;d=d+String.fromCharCode(e);if(k!=64){d=d+String.fromCharCode(g)}if(a!=64){d=d+String.fromCharCode(j)}}d=s._utf8_decode(d);return d},_utf8_encode:function(c){c=c.replace(/\\r\\n/g,\"\\n\");var d=\"\";for(var a=0;a<c.length;a++){var b=c.charCodeAt(a);if(b<128){d+=String.fromCharCode(b)}else{if((b>127)&&(b<2048)){d+=String.fromCharCode((b>>6)|192);d+=String.fromCharCode((b&63)|128)}else{d+=String.fromCharCode((b>>12)|224);d+=String.fromCharCode(((b>>6)&63)|128);d+=String.fromCharCode((b&63)|128)}}}return d},_utf8_decode:function(d){var c=\"\";var b=0;var a=c1=c2=0;while(b<d.length){a=d.charCodeAt(b);if(a<128){c+=String.fromCharCode(a);b++}else{if((a>191)&&(a<224)){c2=d.charCodeAt(b+1);c+=String.fromCharCode(((a&31)<<6)|(c2&63));b+=2}else{c2=d.charCodeAt(b+1);c3=d.charCodeAt(b+2);c+=String.fromCharCode(((a&15)<<12)|((c2&63)<<6)|(c3&63));b+=3}}}return c}};function u(a){var b=\"data:image/svg+xml;base64,\";if(window.btoa){z(\"using btoa for base64 encoding\");b+=btoa(a)}else{z(\"using custom base64 encoding\");b+=s.encode(a)}return b}function A(){var b=document.createElement(\"canvas\");var d=b.getContext(\"2d\");var c=new Image();var a=x(q);c.src=u(a);c.onload=function(){d.drawImage(c,0,0);var e=b.toDataURL();callback(e)};c.onerror=function(){console.log(\"Can't export! Maybe your browser doesn't support SVG in img element or SVG input for Canvas drawImage?\\nhttp://en.wikipedia.org/wiki/SVG#Native_support\")}}function y(c,b,a){dataURL=c.toDataURL(b,parseFloat(a,0));CW.notificationCenter.postNotification(\"DataUrlIsCalculated\",dataURL);document.body.removeChild(c)}function w(c,a){var d=document.createElement(\"canvas\");var e=d.getContext(\"2d\");d.setAttribute(\"style\",\"display: none;\");document.body.appendChild(d);var b=x(q);canvg(d,b,{ignoreMouse:true,ignoreAnimation:true});if(d.svg.readyToConvertToDataURL){y(d,c,a)}else{this._poll=setInterval(function(){if(d.svg.readyToConvertToDataURL){y(d,c,a);clearInterval(this._poll)}},50)}}if(!r){r=\"image/svg+xml\"}if(t){z(\"keepOutsideViewport NOT supported and will be ignored!\")}if(v){z(\"keepNonSafe is NOT supported and will be ignored!\")}switch(r){case\"image/svg+xml\":return o(this);break;case\"image/png\":case\"image/jpeg\":if(window.canvg){z(\"Using canvg for png exporting\");return w(r,p)}else{z(\"Sorry! You don't have canvg. Using native hack for png exporting, THIS WILL FAIL!\");return A(this)}break;default:z('Sorry! Exporting as \"'+r+'\" is not supported!')}}}PhotoPicker.Theme=SteedOSTheme.create({name:\"photoPicker\"});SC.Theme.addTheme(PhotoPicker.Theme);PhotoPicker.UploadButtonView=SC.ButtonView.extend({classNames:\"upload-button\",render:function(d,c){arguments.callee.base.apply(this,arguments);if(c&&!CK.ActiveXView.needsActiveX()){d.push('<div class=\"upload-drop-target-container\"><input class=\"upload-drop-target-file\" type=\"file\" name=\"file\" ontouchstart=\"this.click()\"></div>')}},didCreateLayer:function(){var d=this.get(\"layer\"),c=this.$(\".upload-drop-target-file\")[0];SC.Event.add(c,\"change\",this,this.getRawFile)},getRawFile:function(d){var c=d.target.files[0];if(c){this.$().find(\".upload-drop-target-file\").val(\"\");PhotoPicker.photoUploadController.readFiles(c)}},mouseDown:function(b){arguments.callee.base.apply(this,arguments);if(!CK.ActiveXView.needsActiveX()){b.allowDefault();return NO}else{return YES}}});sc_require(\"views/upload_button\");PhotoPicker.CanvasImageView=SC.View.extend(CW.DropTarget,CK.Photo.CanvasImage,{acceptsFileDrags:YES,imgHeight:CK.Photo.CANVAS_IMG_HEIGHT,imgWidth:CK.Photo.CANVAS_IMG_WIDTH,initialWidth:CK.Photo.CANVAS_INITIAL_WIDTH,initialHeight:CK.Photo.CANVAS_INITIAL_HEIGHT,dimensions:{width:CK.Photo.CANVAS_DEFAULT_LAYOUT_WIDTH,height:CK.Photo.CANVAS_DEFAULT_LAYOUT_HEIGHT},lastRotation:0,imgHeightBinding:\"PhotoPicker.photoUploadController.imgHeight\",imgWidthBinding:\"PhotoPicker.photoUploadController.imgWidth\",classNames:\"upload-drop-target canvas-image-view\".w(),valueBinding:\"PhotoPicker.photoUploadController.imgValue\",isLoadingBinding:\"PhotoPicker.photoUploadController.loadingTempPhotoFromServer\",photoCropBinding:\"PhotoPicker.photoUploadController.photoCrop\",imageIsSmallerThenCanvasBinding:\"PhotoPicker.photoUploadController.imageIsSmallerThenCanvas\",tempImgUploadErrorBinding:\"PhotoPicker.photoUploadController.tempImgUploadError\",imgOrientationBinding:\"PhotoPicker.photoUploadController.imgOrientation\",finalDataURL:null,imgLoadError:NO,boundaryRadius:8,staticImage:\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/blank.gif\",imgQuality:1,editViewIsVisible:function(){return this.get(\"value\")&&!PhotoPicker.get(\"isIEAndActiveXInstalled\")}.property(\"value\",\"PhotoPicker.isIEAndActiveXInstalled\"),computeDragOperations:function(c,d){return SC.DRAG_DATA},dragStarted:function(k,g){var h=this.get(\"value\"),f=this.get(\"imgLoadError\");var j=h&&!f?\"Photo - Drag\":\"No Photo\";this.setupCanvasViews(j)},dragEntered:function(f,e){var d=this.get(\"currentState\");if(d!==\"Photo - Uploading\"){this.$().addClass(\"drop-target\")}},dragExited:function(c,d){this.$().removeClass(\"drop-target\")},dragEnded:function(o,j){var m=this.get(\"value\"),q=this.get(\"imgLoadError\"),n=m?\"Photo\":\"No Photo\",p=this.get(\"currentState\"),l=this.get(\"innerBoundaryRect\"),k=this.get(\"rect2\");if(p!==\"Photo - Uploading\"){this.setupCanvasViews(n)}},performDragOperation:function(j,h){this.$().removeClass(\"drop-target\");if(j.data&&j.data[0]){this.set(\"tempImgUploadError\",NO);var k=j.data[0],f=this.get(\"img\"),g=PhotoPicker.photoUploadController;if(k.type.indexOf(\"image/\")===0){g.readFiles(k)}else{g._errorForFile(CW.UPLOADER_INCOMPATIBLE_FILE_TYPE)}}},didCreateLayer:function(e){e();var f=this.get(\"frame\");var d=new Raphael(this.$()[0],f.width,f.height);this.set(\"raphael\",d);CW.notificationCenter.subscribeToNotification(\"activeXFileDragStarted\",this,this.dragStarted);CW.notificationCenter.subscribeToNotification(\"activeXFileDragged\",this,this.activeXFileDragged);CW.notificationCenter.subscribeToNotification(\"activeXFileDragHasEnded\",this,this.activeXFileDragEnded);CW.notificationCenter.subscribeToNotification(\"activeXFileDragEnded\",this,this.dragEnded);CW.notificationCenter.subscribeToNotification(\"cleanUpCanvas\",this,this.cleanup)}.enhance(),didRemoveLayer:function(){CW.notificationCenter.unsubscribeFromNotification(\"activeXFileDragStarted\",this,this.dragStarted);CW.notificationCenter.unsubscribeFromNotification(\"activeXFileDragged\",this,this.activeXFileDragged);CW.notificationCenter.unsubscribeFromNotification(\"activeXFileDragHasEnded\",this,this.activeXFileDragEnded);CW.notificationCenter.unsubscribeFromNotification(\"activeXFileDragEnded\",this,this.dragEnded);CW.notificationCenter.unsubscribeFromNotification(\"cleanUpCanvas\",this,this.cleanup)},activeXFileDragged:function(b){if(this.pointInFrame(b)){this.dragEntered()}else{if(!this.pointInFrame(b)){this.dragExited()}}},activeXFileDragEnded:function(b){this.dragExited()},valueObserver:function(){var j=this.get(\"value\"),k=this.get(\"raphael\"),h=this.get(\"frame\"),g=this.get(\"img\"),f=!PhotoPicker.get(\"isIEAndActiveXInstalled\");if(j===undefined){this.set(\"currentState\",null);if(g){g.attr({src:\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/blank.gif\"})}return}if(f){PhotoPicker.statechart.sendEvent(\"activexAddOnRequired\")}this.set(\"imgLoadError\",NO);PhotoPicker.photoUploadController.readFiles();if(j){if(f){j=this.get(\"staticImage\");this.set(\"value\",j)}k.setSize(h.width,h.height);this.setImageWidthAndHeight(j,this,\"afterImageHasLoaded\",\"afterImageLoadingHasFailed\")}else{this.afterImageLoadingHasFailed()}}.observes(\"value\"),turnIsLoadingOff:function(){this.set(\"isLoading\",NO)},afterImageHasLoaded:function(f){this.resizeImage();this.turnIsLoadingOff();var d=this.get(\"imgWidth\"),e=this.get(\"imgHeight\");this.setupInitialDimensions(d,e,YES);this.repositionImage();this.createDragView();this.setupCanvasViews(\"Photo\");this.setupRaphaelView(f,this.get(\"img\"));PhotoPicker.photoUploadController.readFiles()},afterImageLoadingHasFailed:function(g){var f=this.get(\"img\"),h=this.get(\"raphael\"),e=this.get(\"imgLoadError\");this.turnIsLoadingOff();this.repositionImage();this.createDragView();if(e){PhotoPicker.statechart.sendEvent(\"photoLoadError\")}else{this.setupCanvasViews(\"No Photo\");this.setupRaphaelView(g,f)}},setupRaphaelView:function(c,d){if(d){d.attr({cursor:\"pointer\",position:\"absolute\"});this.setupDrag(d)}},setupDrag:function(h){var g=function(){this.dx=0;this.dy=0;this.currImgX=this.attr(\"x\");this.currImgY=this.attr(\"y\")},f=function(n,o){var p=this.attr(\"x\"),a=this.attr(\"y\"),b=p,c=a,d=this.attr(\"width\"),q=this.attr(\"height\");if(p<0&&(p+d)<220){b=d>220?(220-d):0}else{if(p>0&&(p+d)>220){b=d<220?(220-d):0}}if(a<0&&(a+q)<200){c=q>220?(220-q):0}else{if(a>0&&(a+q)>220){c=q<220?(220-q):0}}if(b!==p||c!==a){this.animate({x:b,y:c},500,\">\")}if(Math.round(this.currImgX-b)!==0||Math.round(this.currImgY-c)!==0){PhotoPicker.photoUploadController.set(\"imgMoved\",YES)}},e=function(a,b){this.translate(a-this.dx||0,b-this.dy||0);this.dx=a;this.dy=b};h.drag(e,g,f)},createDragView:function(){var l=this.get(\"raphael\"),n=this.get(\"rect1\"),o=this.get(\"img\"),h=this.get(\"boundaryRadius\"),m=this.get(\"dimensions\");if(!l||n){return}n=l.rect(0,0,220,220);n.attr({fill:\"white\",stroke:\"none\",\"clip-rect\":\"0, 0, %@, %@, %@\".fmt(m.width,m.height,h)});n.node.id=\"rect1\";var j=l.rect(22,22,176,176);j.attr({fill:\"none\",stroke:\"white\",\"stroke-width\":4,\"stroke-dasharray\":\"- \",cursor:\"pointer\",r:20});var k=l.text(PhotoPicker.PHOTOPICKER_DRAGPHOTOTEXT_XPOS,PhotoPicker.PHOTOPICKER_DRAGPHOTOTEXT_YPOS,\"PhotoPicker.DragPhoto\".loc());k.attr({\"font-weight\":\"bold\",\"font-family\":\"Helvetica\",\"font-size\":\"18\",fill:\"white\",\"text-anchor\":\"middle\",color:\"#000000\",opacity:\"30%\"});l.safari();this.set(\"rect1\",n);this.set(\"rect2\",j);this.set(\"text\",k)},loadingObserver:function(){var k=this.get(\"isLoading\"),o=PhotoPicker.page.get(\"loadingView\"),m=this.get(\"value\"),p=this.get(\"imgLoadError\"),n=\"Photo - Uploading\",l=o.get(\"spinnerView\"),q=PhotoPicker.photoUploadController,j=PhotoPicker.statechart;if(k){this._loadingView=o;if(l){if(n===\"Photo - Uploading\"){}else{}}this._loadingView.classNames.push(m&&!p?\"not-empty\":null);this.appendChild(this._loadingView);q.set(\"chooseButtonFlag\",NO);this.setupCanvasViews(n);j.sendEvent(\"uploadingPhoto\")}else{if(this._loadingView){this._loadingView.classNames.removeObject(\"not-empty\");this.removeChild(this._loadingView);this._loadingView=null;n=m?\"Photo\":\"No Photo\";if(this.get(\"tempImgUploadError\")){j.sendEvent(\"serverError\")}else{if(p){j.sendEvent(\"photoLoadError\")}else{this.setupCanvasViews(n);j.sendEvent(\"uploadingPhotoCompleted\")}}}}}.observes(\"isLoading\"),cropPhoto:function(){if(!this.get(\"value\")||this.get(\"imgLoadError\")){PhotoPicker.statechart.sendEvent(\"cancel\");return}if(!this.get(\"img\")){this.dataURLIsCalculated();return}var ag=this.get(\"raphael\"),al=ag.canvas,ao=CK.Photo.PhotoController,N=this.get(\"img\"),ac=this.get(\"rect1\"),L=this.get(\"rect2\"),O=this.get(\"text\"),Q=this.get(\"innerBoundaryRect\"),ak,ap=N.getBBox(),W=ap.x,Y=ap.y,ad=ap.width,am=ap.height,aj=this.get(\"convertToSmallerSizeRatio\"),U=PhotoPicker.photoUploadController,af=U.get(\"imgWidth\"),P=U.get(\"imgHeight\"),ae=U.get(\"isImageAltered\"),S=W<0?Math.round(Math.abs(W*af/ad)):0,V=Y<0?Math.round(Math.abs(Y*P/am)):0,T=(W+ad)>220?Math.round(S+220*((af/ad))):af,X=(Y+am)>220?Math.round(V+220*((P/am))):P,aa=T-S,M=X-V,K=Math.round(P-V-M),Z=U.get(\"initialSize\"),an=U.get(\"maximumFileSize\"),R=this.get(\"currentState\"),ah=this.get(\"editShadeImage\"),aq=U.get(\"photoSignature\");if(ae&&R===\"Photo\"){K=K<0?0:K;U.set(\"photoCrop\",{x:Math.round(S/aj),y:Math.round(K/aj),width:Math.round(aa/aj),height:Math.round(M/aj)});if(!aq){if(SC.browser.isIE8OrLower||(SC.browser.isIE&&this.get(\"imgOrientation\")!==1)){if(U.get(\"imageDragged\")&&!aq){var ab=af>P?P:af;if(aj){ab=Math.round(ab/aj)}var ai=YachtV2.scaleImage(ab)||YachtV2.createDerivative(0,0,af,P);ak=\"data:image/jpeg;base64,\"+ai}else{ak=this.get(\"value\")}}else{if(ac){ac.remove();L.remove();O.remove();Q.remove();if(ah){ah.remove()}this.set(\"rect1\",null);this.set(\"rect2\",null);this.set(\"text\",null);this.set(\"innerBoundaryRect\",null);this.set(\"editShadeImage\",null)}if(al){N.attr({\"clip-rect\":null});if(this.get(\"imgOrientation\")!==1){ag.setSize(af/aj,P/aj);N.attr({x:0,y:0,width:af/aj,height:P/aj});CW.notificationCenter.subscribeToNotification(\"DataUrlIsCalculated\",this,\"dataURLIsCalculated\");al.toDataURL(\"image/jpeg\",this.get(\"imgQuality\"));return}else{ak=this.get(\"finalDataURL\")}}else{CK.warn(\"Could not find canvas element!\")}}}var I=PhotoPicker.photoUploadController.get(\"photoCrop\"),J=PhotoPicker.photoUploadController.get(\"photoUrl\");if(J.indexOf(\"data:image/jpeg;base64,\")!==-1){PhotoPicker.photoUploadController.savePhoto(I)}else{PhotoPicker.photoUploadController.savePhoto(I,J,(U.get(\"imgHeight\")/aj),(U.get(\"imgWidth\")/aj))}this.dataURLIsCalculated(ak)}else{this.dataURLIsCalculated()}},setupCanvasViews:function(x){var p=this.get(\"rect1\"),r=this.get(\"rect2\"),v=this.get(\"img\"),o=this.get(\"text\"),z=this.get(\"innerBoundaryRect\"),w=this.get(\"currentState\"),q=this.get(\"editShadeImage\"),s=PhotoPicker.photoUploadController.get(\"isInErrorState\"),y=PhotoPicker.photoUploadController,u=this.get(\"boundaryRadius\"),A=this.get(\"dimensions\");if(!(p&&r&&v&&o)){return}v.show();if(w&&x===w){if(x===\"Photo\"&&SC.browser.isMozilla){if(s){y.set(\"isInErrorState\",NO);y.set(\"errorCode\",CK.Photo.PHOTO_NO_ERROR);PhotoPicker.statechart.sendEvent(\"uploadingPhotoCompleted\")}}return}var t=w;this.set(\"currentState\",x);switch(x){case\"No Photo\":v.attr({src:\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/blank.gif\"});v.toBack();p.attr({fill:\"white\"});o.attr({text:\"PhotoPicker.DragPhoto\".loc(),fill:\"#bfbfbf\",\"fill-opacity\":1,x:CK.Photo.PHOTOPICKER_DRAGPHOTOTEXT_XPOS,y:CK.Photo.PHOTOPICKER_DRAGPHOTOTEXT_YPOS});o.show();r.attr({stroke:\"#bfbfbf\",\"stroke-opacity\":1});r.show();y.set(\"makeHoverViewsVisible\",NO);break;case\"Photo\":if(SC.browser.isMozilla&&s&&t!==\"Photo - Drag\"){y.set(\"isInErrorState\",NO);y.set(\"errorCode\",CK.Photo.PHOTO_NO_ERROR);PhotoPicker.statechart.sendEvent(\"uploadingPhotoCompleted\")}p.attr({fill:\"90-#d9dade-#cfd1d7\"});p.toBack();o.hide();r.hide();v.toFront();break;case\"No Photo - Uploading Failed\":o.attr({text:\"PhotoPicker.UploadingPhotoFailed\".loc(),fill:\"#bfbfbf\"});v.toBack();r.attr({stroke:\"#bfbfbf\"});r.show();o.show();p.attr({fill:\"white\",\"fill-opacity\":1});break;case\"Photo - Uploading\":p.attr({fill:\"white\",\"fill-opacity\":1});r.hide();o.hide();v.toBack();break;case\"Photo - Uploading Failed\":p.attr({fill:\"black\",\"fill-opacity\":0.4});v.toBack();o.attr({text:\"PhotoPicker.UploadingPhotoFailed\".loc(),fill:\"white\"});o.show();r.attr({stroke:\"white\"});r.show();break;case\"Photo - Drag\":v.toBack();p.attr({fill:\"#ffffff\",\"fill-opacity\":0.9});o.attr({text:\"PhotoPicker.DragPhoto\".loc(),fill:\"#bfbfbf\",\"fill-opacity\":0.5});o.show();r.attr({stroke:\"#bfbfbf\",\"stroke-opacity\":0.5});r.show();this.centreRectWithinRaphael(o,A);break}if(z){z.show();z.toFront()}if(q&&this.get(\"editViewIsVisible\")){q.toFront()}},cleanup:function(){var f=this.get(\"dimensions\"),d=this.get(\"raphael\"),e=this.get(\"img\");d.setSize(f.width,f.height);this.set(\"currentState\",null);this.set(\"convertToSmallerSizeRatio\",null);this.set(\"imgQuality\",1);if(SC.browser.isIE8OrLower){this.removeRaphaelViews()}},resizeImage:function(){var a=PhotoPicker.photoUploadController,j=a.get(\"initialSize\"),C=a.get(\"maximumFileSize\"),G=this.get(\"imgHeight\"),x=this.get(\"imgWidth\"),E=this.get(\"imgOrientation\"),F,w,v=1.1,I=NO,A,o,D,H,z=this._tempCanvas,B,y;if(j&&!SC.browser.isIE8OrLower){SC.Benchmark.start(\"calculateResizing\");if(SC.platform.dpi==2&&parseInt(SC.browser.safari)<536){x/=2;G/=2}this.set(\"imgHeight\",G);this.set(\"imgWidth\",x);this.set(\"finalDataURL\",this.get(\"value\"))}else{if(j&&j>C){D=Math.sqrt(C/j)/2;this.set(\"imgHeight\",Math.round(G*D));this.set(\"imgWidth\",Math.round(x*D))}}},dataURLIsCalculated:function(c){var d=PhotoPicker.photoUploadController;if(c){d.get(\"_imgPicker\").set(\"isVisible\",YES);c=c.replace(/(\\r\\n|\\n|\\r|\\s)/gm,\"\");d.set(\"imgValue\",c)}if(!SC.browser.isIE){CW.notificationCenter.unsubscribeFromNotification(\"DataUrlIsCalculated\",this,\"dataURLIsCalculated\")}this.cleanup();PhotoPicker.statechart.sendEvent(\"closePicker\")},centreRectWithinRaphael:function(d,e){var f=d.getBBox();d.translate((e.width-f.width)/2-f.x,(e.height-f.height)/2-f.y)},isInErrorStateBinding:\"PhotoPicker.photoUploadController.isInErrorState\",isPhotoEnabled:function(){var m=this.get(\"currentState\"),l=this.get(\"initialWidth\"),n=this.get(\"initialHeight\"),o=this.get(\"imgWidth\"),j=this.get(\"imgHeight\"),h=this.get(\"isInErrorState\"),k=!(n===j||l===o);return m&&m===\"Photo\"&&k&&!h}.property(\"currentState\",\"isInErrorState\"),removeRaphaelViews:function(){var m=this.get(\"rect1\"),h=this.get(\"rect2\"),j=this.get(\"text\"),g=this.get(\"img\"),l=this.get(\"editShadeImage\"),k=this.get(\"innerBoundaryRect\");if(m){m.remove();this.set(\"rect1\",null)}if(h){h.remove();this.set(\"rect1\",null)}if(j){j.remove();this.set(\"text\",null)}if(g){g.remove();this.set(\"img\",null)}if(l){l.remove();this.set(\"editShadeImage\",null)}if(k){k.remove();this.set(\"innerBoundaryRect\",null)}},mouseEntered:function(f){var g=this.get(\"currentState\"),h=PhotoPicker.photoUploadController,e=h.get(\"isInErrorState\");if(g===\"Photo\"&&!e){h.set(\"makeHoverViewsVisible\",YES)}return YES},pointInFrame:function(d){var c=this.get(\"parentView\").convertFrameToView(this.get(\"frame\"),null);return SC.pointInRect(d,c)}.property(\"frame\").cacheable(),mouseExited:function(g){var h={x:g.pageX,y:g.pageY},k=PhotoPicker.photoUploadController.get(\"isInErrorState\"),j=this.get(\"currentState\"),f=PhotoPicker.photoUploadController;if(j===\"Photo\"&&this.pointInFrame(h)&&!k){f.set(\"makeHoverViewsVisible\",YES)}else{f.set(\"makeHoverViewsVisible\",NO)}return YES},orientationIndexes:[8,3,6,1,8],rotateImage:function(){var f=this.get(\"orientationIndexes\"),d=f.indexOf(this.get(\"imgOrientation\")),e=PhotoPicker.photoUploadController;this.set(\"imgOrientation\",f[d+1]);this.setupOrientation();e.inverseWidthAndHeight();e.set(\"imageOrientationChanged\",YES);e.set(\"photoSignature\",null)},resizeClipRectsForAllElements:function(m,h,j){var n=this.get(\"img\"),o=this.get(\"rect1\"),l,k=\"0 0 %@ %@ %@\".fmt(m,h,j);n.attr(\"clip-rect\",k);o.attr(\"clip-rect\",k)},childViews:[\"errorStateViews\",\"choosePhoto\",\"installPlugin\"],errorStateViews:SC.View.design({layout:{top:1,left:1,width:218,height:218},classNames:[\"errorstate\"],childViews:[\"errorTitle\",\"errorMessage\"],isVisibleBinding:\"PhotoPicker.photoUploadController.isInErrorState\",render:function(d,c){if(this.get(\"isVisible\")&&this.getPath(\"parentView.img\")){this.getPath(\"parentView.img\").hide()}arguments.callee.base.apply(this,arguments)},errorTitle:SC.LabelView.design({classNames:[\"error-title\"],render:function(g,j){var k=this.get(\"value\"),l=\"font-family:Helvetica;font-size:19px;font-weight:bold\",m=SC.metricsForString(k,l).width,h=SC.metricsForString(k,l).height;this.adjust(\"width\",m);this.adjust(\"height\",h);arguments.callee.base.apply(this,arguments)},layout:{centerX:0,centerY:0,top:50},valueBinding:\"PhotoPicker.photoUploadController.photoPickerErrorTitle\"}),errorMessage:SC.LabelView.design({useStaticLayout:YES,classNames:[\"error-message\"],escapeHTML:NO,layout:{top:86,centerX:0,centerY:0,width:166,height:\"auto\"},valueBinding:\"PhotoPicker.photoUploadController.photoPickerErrorMessage\"})}),choosePhoto:PhotoPicker.UploadButtonView.design({classNames:[\"choose-photo-or-install-plugin\"],layout:{top:161,left:55,height:20,right:50},title:\"Button.ImagePicker.UploadNewPhoto\".loc(),localize:YES,themeName:\"ellipsis\",action:function(){PhotoPicker.photoUploadController.uploadNewPhoto()},isVisibleBinding:\"PhotoPicker.photoUploadController.makeChooseButtonInErrorStateVisible\"}),installPlugin:SC.ButtonView.design({classNames:[\"choose-photo-or-install-plugin\"],layout:{top:170,left:49,height:20,right:50},title:\"Button.ImagePicker.InstallPlugin\".loc(),themeName:\"ellipsis\",action:function(){window.location.reload()},isVisibleBinding:\"PhotoPicker.photoUploadController.makeInstallPluginButtonVisible\"})});sc_require(\"views/canvas_image\");sc_require(\"views/upload_button\");PhotoPicker.ImagePickerContentView=SC.View.extend({classNames:[\"image-picker-content-view\"],layout:{top:0,left:0,right:0,bottom:0},childViews:[\"imageCropper\",\"choosePhoto\",\"bottomContainer\",\"hoverViews\"],imageCropper:PhotoPicker.CanvasImageView.design({editView:{image:SC.platform.dpi>=2?\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/avatar_edit_shade_200x200@2x.png\":\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/avatar_edit_shade_200x200.png\",rect:{x:0,y:0,width:200,height:200}},classNames:[\"crop-image\"],layout:{top:0,height:220,width:220},zoomLevelBinding:\"PhotoPicker.photoUploadController.sliderValue\"}),choosePhoto:PhotoPicker.UploadButtonView.design({classNames:[\"choose-photo-or-install-plugin\"],layout:{top:150,left:55,height:20,right:50},title:\"Button.ImagePicker.UploadNewPhoto\".loc(),localize:YES,themeName:\"ellipsis\",action:function(){PhotoPicker.photoUploadController.uploadNewPhoto()},isVisibleBinding:\"PhotoPicker.photoUploadController.makeChooseButtonVisible\"}),bottomContainer:SC.View.design({childViews:[\"smallImage\",\"slider\",\"largeImage\",\"buttons\"],layout:{bottom:0,height:75,left:0,right:0},smallImage:SC.ImageView.design({valueBinding:SC.Binding.transform(function(e,h){var f=SC.platform.dpi>=2?\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/small_slider_icon@2x.png\":\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/small_slider_icon.png\",g=SC.platform.dpi>=2?\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/small_slider_icon_disabled@2x.png\":\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/small_slider_icon_disabled.png\";return e?f:g}).from(\"*parentView.parentView.imageCropper.isPhotoEnabled\"),classNames:\"small-image\".w(),layout:{top:13,width:9,height:7,left:10},isEnabledBinding:\"*parentView.parentView.imageCropper.isPhotoEnabled\"}),slider:SC.SliderView.design({value:0,classNames:[\"canvas-slider\"],layout:{top:7,left:26,right:38},maximum:100,minimum:0,step:1,valueBinding:\"PhotoPicker.photoUploadController.sliderValue\",isEnabledBinding:\"*parentView.parentView.imageCropper.isPhotoEnabled\",mouseUp:function(c,d){c(d);PhotoPicker.photoUploadController.set(\"zoomValueChanged\",YES)}.enhance()}),largeImage:SC.ImageView.design({valueBinding:SC.Binding.transform(function(e,h){var f=SC.platform.dpi>=2?\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/large_slider_icon@2x.png\":\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/large_slider_icon.png\",g=SC.platform.dpi>=2?\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/large_slider_icon_disabled@2x.png\":\"../../../../system/steedos/4330/cloudkit/photo/photoPicker/4330/zh-cn/source/resources/images/large_slider_icon_disabled.png\";return e?f:g}).from(\"*parentView.parentView.imageCropper.isPhotoEnabled\"),classNames:\"large-image\".w(),layout:{top:10,width:16,height:12,right:10},isEnabledBinding:\"*parentView.parentView.imageCropper.isPhotoEnabled\"}),buttons:SC.View.design({layout:{bottom:8,height:31},classNames:\"buttons\".w(),childViews:[\"cancel\",\"done\"],cancel:SC.ButtonView.design({layout:{left:8,width:96,height:30},title:\"Button.ImagePicker.Cancel\",localize:YES,controlSize:SC.LARGE_CONTROL_SIZE,action:function(){if(PhotoPicker.photoUploadController.isImageAltered()){var b=function(){};var a=function(){};CS.Attachment.deleteUserPhoto(PhotoPicker.photoUploadController.get(\"photoUrl\"),b,a)}PhotoPicker.statechart.sendEvent(\"cancel\")},}),done:SC.ButtonView.design({layout:{right:8,width:96,height:30},title:\"Button.ImagePicker.Done\",localize:YES,controlSize:SC.LARGE_CONTROL_SIZE,action:function(){PhotoPicker.statechart.sendEvent(\"cropPhoto\",this)},isEnabledBinding:\"PhotoPicker.photoUploadController.isDoneButtonEnabled\"})})}),hoverViews:SC.View.design({childViews:[\"deleteButton\",\"choosePhotoButton\",\"rotateButton\"],layout:{top:9,height:22,left:9,right:9},isVisibleBinding:\"PhotoPicker.photoUploadController.makeHoverViewsVisible\",deleteButton:SC.ImageButtonView.design({classNames:[\"deletehover\"],layout:{top:0,left:0,width:22,height:22},action:function(){var b=this.getPath(\"parentView.parentView.imageCropper\");b.set(\"value\",null);this.get(\"parentView\").set(\"isVisible\",NO);PhotoPicker.photoUploadController.set(\"chooseButtonFlag\",YES)}}),choosePhotoButton:PhotoPicker.UploadButtonView.design({classNames:[\"choose-hover\"],layout:{top:0,left:44,height:22,right:44},localize:YES,title:\"Button.ImagePicker.UploadNewPhoto\".loc(),themeName:\"ellipsis\",target:\"PhotoPicker.photoUploadController\",action:\"uploadNewPhoto\"}),rotateButton:SC.ImageButtonView.design({classNames:[\"rotate-hover\"],layout:{top:0,right:0,width:22,height:22},action:function(){this.getPath(\"parentView.parentView.imageCropper\").rotateImage()},isVisibleBinding:\"PhotoPicker.photoUploadController.makeRotateButtonVisible\"})})});sc_require(\"views/image_picker_content_view\");PhotoPicker.page=SC.Page.design({picker:CW.PickerPane.extend({themeName:\"photoPicker\",isModal:YES,modalPane:SC.ModalPane.extend(CW.DropTarget,{classNames:[\"for-sc-panel\",\"photo-picker-modal\"]}),desiredSize:{width:220,height:297},contentView:PhotoPicker.ImagePickerContentView.design({}),defaultResponder:PhotoPicker.statechart,shouldDismissAutomatically:NO,dismissTarget:PhotoPicker.statechart,dismissAction:\"clickedOutside\",pointerOffset:[4,-9,-12,12],keyDown:function(d){var c=this.interpretKeyEvents(d);return !c?NO:c},cancel:function(b){PhotoPicker.statechart.sendEvent(\"cancel\")}}),loadingView:SC.View.design({classNames:[\"photo-uploading-progress-view\"],childViews:[\"spinnerView\",\"textView\"],layout:{centerX:0,centerY:0,width:150,height:150},spinnerView:CW.SpinnerView.design({layout:{centerX:0,centerY:-25},isShowing:YES}),textView:SC.LabelView.design({classNames:[\"loading-text-view\"],textAlign:SC.ALIGN_CENTER,layout:{centerX:0,centerY:20,width:150,height:50},value:\"PhotoPicker.UploadingPhoto\".loc(),controlSize:SC.HUGE_CONTROL_SIZE})})});SC.metricsFor(\"zh-cn\",{\"PhotoPicker.picker.height\":261}),SC.stringsFor(\"zh-cn\",{\"Button.ImagePicker.Cancel\":\"\",\"Button.ImagePicker.Done\":\"\",\"Button.ImagePicker.InstallPlugin\":\"\",\"Button.ImagePicker.UploadNewPhoto\":\"\",\"Dialog.PhotoPicker.ActiveXRequired.LearnMore.URL\":\"http://help.steedos.com/\",\"Dialog.PhotoPicker.ActiveXRequired.Text\":\" SteedOS Extras for Internet Explorer\",\"Dialog.PhotoPicker.ActiveXRequired.Title\":\"\",\"Dialog.PhotoPicker.Button.LearnMore\":\"\",\"Dialog.PhotoPicker.Button.OK\":\"\",\"PhotoPicker.ActiveXNotInstalled.MessageLabel\":\"\\n\\n\",\"PhotoPicker.DragPhoto\":\"\\n\\n\",\"PhotoPicker.InvalidFormat.Message\":\" JPEGGIFPNG  BMP \",\"PhotoPicker.InvalidFormat.Title\":\"\",\"PhotoPicker.PhotoLoadError.Message\":\"\",\"PhotoPicker.PhotoLoadError.Title\":\"\",\"PhotoPicker.PhotoTooBig.Message\":\" 10MB \",\"PhotoPicker.PhotoTooBig.Title\":\"\",\"PhotoPicker.PhotoUploadError.Message\":\"\",\"PhotoPicker.PluginRequired.Message\":' SteedOS Web App \\n<a target=\"_BLANK\" href=\"http://help.steedos.com/\">...</a>',\"PhotoPicker.PluginRequired.Title\":\"\",\"PhotoPicker.ServerError.Title\":\"\",\"PhotoPicker.UploadingPhoto\":\"\",\"PhotoPicker.PhotoLoadingFailed\":\"\",});";
